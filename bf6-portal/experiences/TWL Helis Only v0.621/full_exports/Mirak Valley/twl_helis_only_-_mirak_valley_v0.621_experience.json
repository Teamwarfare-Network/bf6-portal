{"mutators":{"MaxPlayerCount_PerTeam":32,"FriendlyFireAllowed_PerTeam":true,"SquadSpawnMode_PerTeam":[[0,2],[1,3]],"ManDownExperienceType_PerTeam":2,"SquadReviveAllowed_PerTeam":false,"AI_ManDownExperienceType_PerTeam":1,"fPortalExperienceGameTime":60,"EnableClassLockedWeaponLoadouts":true},"assetRestrictions":{"AssaultClass":false,"ReconClass":false,"SupportClass":false,"Portal_WebApp_AR":false,"Portal_WebApp_Carbine":false,"Portal_WebApp_DMR":false,"Portal_WebApp_MG":false,"Portal_WebApp_Pistol":false,"Portal_WebApp_SR":false,"Portal_WebApp_SG":false,"Portal_WebApp_PDW":false,"U_TUGS":false,"U_Gadget_SupplyCrate":false,"U_AdrenalineShot":false,"Portal_WebApp_Explosive":false,"Portal_WebApp_GrenadeLauncher":false,"Portal_WebApp_Gadget_Misc":false,"Portal_WebApp_StrikePackage":false,"Portal_WebApp_Throwable":false,"Portal_WebApp_Armor":false},"name":"TWL Helis Only - Mirak Valley v0.621","description":"Source Code on github and competitive ruleset available on the TWL website.\nAny feedback, questions or issues can be raised on our discord server.\nTeamwarfare . net - Compete in competitive tanks ladders today!","mapRotation":[{"id":"MP_Tungsten-ModBuilderCustom0","spatialAttachment":{"id":"c097d687-f56b-4003-b760-b7f4bada9dec","filename":"MP_TWL_AircraftOnly_Tungsten.spatial.json","metadata":"mapIdx=0","version":"123","isProcessable":true,"processingStatus":2,"attachmentData":{"original":"ew0KICAgICJQb3J0YWxfRHluYW1pYyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiVEVBTV8xX0hRIiwNCiAgICAgICAgICAgICJBbHRUZWFtIjogIlRlYW1OZXV0cmFsIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDEsDQogICAgICAgICAgICAiSW5mYW50cnlTcGF3bnMiOiBbDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMSIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMiIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMyIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfNCINCiAgICAgICAgICAgIF0sDQogICAgICAgICAgICAiSFFBcmVhIjogIlRFQU1fMV9IUS9IUV9UZWFtMSIsDQogICAgICAgICAgICAidHlwZSI6ICJIUV9QbGF5ZXJTcGF3bmVyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC01MDUuNjQxLA0KICAgICAgICAgICAgICAgICJ5IjogODIuNTcxNCwNCiAgICAgICAgICAgICAgICAieiI6IC0zMjkuMDM0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMV9IUSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJIUUFyZWEiLA0KICAgICAgICAgICAgICAgICJJbmZhbnRyeVNwYXducyINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiSFFfVGVhbTEiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8xX0hRL0hRX1RlYW0xIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAwLA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTUwMC42NDEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODcuNTcxNCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzI0LjAzNA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDAuNjQxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg3LjU3MTQsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMzNC4wMzQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNTEwLjY0MSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4Ny41NzE0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMzQuMDM0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTUxMC42NDEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODcuNTcxNCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzI0LjAzNA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8xXzEiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMC4wNDYxODI1LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjk5ODkzMw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuOTk4OTMzLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjA0NjE4MjUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNTA1LjY0MSwNCiAgICAgICAgICAgICAgICAieSI6IDgyLjU3MTQsDQogICAgICAgICAgICAgICAgInoiOiAtMzMyLjAzNA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNwYXduUG9pbnRfMV8yIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNwYXduUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC40NDI5MTUsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogLTAuODk2NTY0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC44OTY1NjQsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC40NDI5MTUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNTAyLjY0MSwNCiAgICAgICAgICAgICAgICAieSI6IDgyLjU3MTQsDQogICAgICAgICAgICAgICAgInoiOiAtMzI5LjAzNA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNwYXduUG9pbnRfMV8zIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNwYXduUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC4zMDQ2MTUsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogLTAuOTUyNDc2DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC45NTI0NzYsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC4zMDQ2MTUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNTA4LjY0MSwNCiAgICAgICAgICAgICAgICAieSI6IDgyLjU3MTQsDQogICAgICAgICAgICAgICAgInoiOiAtMzI5LjAzNA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzMiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNwYXduUG9pbnRfMV80IiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNwYXduUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC42NzU4MzUsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogLTAuNzM3MDUzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC43MzcwNTMsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC42NzU4MzUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNTA1LjY0MSwNCiAgICAgICAgICAgICAgICAieSI6IDgyLjU3MTQsDQogICAgICAgICAgICAgICAgInoiOiAtMzI2LjAzNA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRFQU1fMl9IUSIsDQogICAgICAgICAgICAiVGVhbSI6ICJUZWFtMiIsDQogICAgICAgICAgICAiQWx0VGVhbSI6ICJUZWFtTmV1dHJhbCIsDQogICAgICAgICAgICAiT2JqSWQiOiAyLA0KICAgICAgICAgICAgIkluZmFudHJ5U3Bhd25zIjogWw0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzEiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzIiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzMiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzQiDQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgIkhRQXJlYSI6ICJURUFNXzJfSFEvSFFfVGVhbTIiLA0KICAgICAgICAgICAgInR5cGUiOiAiSFFfUGxheWVyU3Bhd25lciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiA0MjguMzIsDQogICAgICAgICAgICAgICAgInkiOiA4NS4yMTQ2LA0KICAgICAgICAgICAgICAgICJ6IjogLTYxOS4zMzkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8yX0hRIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkhRQXJlYSIsDQogICAgICAgICAgICAgICAgIkluZmFudHJ5U3Bhd25zIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJIUV9UZWFtMiIsDQogICAgICAgICAgICAidHlwZSI6ICJQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzJfSFEvSFFfVGVhbTIiLA0KICAgICAgICAgICAgImhlaWdodCI6IDAsDQogICAgICAgICAgICAicG9pbnRzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA0MzMuMzIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogOTAuMjE0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNjE0LjMzOQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDQzMy4zMiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA5MC4yMTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC02MjQuMzM5DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogNDIzLjMyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDkwLjIxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTYyNC4zMzkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA0MjMuMzIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogOTAuMjE0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNjE0LjMzOQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8yXzEiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjk4MzUyNSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjE4MDc3Nw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjE4MDc3NywNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjk4MzUyNQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDQyOC4zMiwNCiAgICAgICAgICAgICAgICAieSI6IDg1LjIxNDYsDQogICAgICAgICAgICAgICAgInoiOiAtNjIyLjMzOQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNwYXduUG9pbnRfMl8yIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNwYXduUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC45NTEyMTgsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC4zMDg1MTkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMC4zMDg1MTksDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC45NTEyMTgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiA0MzEuMzIsDQogICAgICAgICAgICAgICAgInkiOiA4NS4yMTQ2LA0KICAgICAgICAgICAgICAgICJ6IjogLTYxOS4zMzkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8yX0hRL1NwYXduUG9pbnRfMl8yIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTcGF3blBvaW50XzJfMyIsDQogICAgICAgICAgICAidHlwZSI6ICJTcGF3blBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuOTk3Mzk2LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuMDcyMTI0NA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjA3MjEyNDQsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC45OTczOTYNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiA0MjUuMzIsDQogICAgICAgICAgICAgICAgInkiOiA4NS4yMTQ2LA0KICAgICAgICAgICAgICAgICJ6IjogLTYxOS4zMzkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8yX0hRL1NwYXduUG9pbnRfMl8zIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTcGF3blBvaW50XzJfNCIsDQogICAgICAgICAgICAidHlwZSI6ICJTcGF3blBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuOTkwMzg2LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuMTM4MzI3DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuMTM4MzI3LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuOTkwMzg2DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogNDI4LjMyLA0KICAgICAgICAgICAgICAgICJ5IjogODUuMjE0NiwNCiAgICAgICAgICAgICAgICAieiI6IC02MTYuMzM5DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMl9IUS9TcGF3blBvaW50XzJfNCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ29tYmF0QXJlYSIsDQogICAgICAgICAgICAiQ29tYmF0Vm9sdW1lIjogIkNvbWJhdEFyZWEvQ29tYmF0Vm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkNvbWJhdEFyZWEiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNvbWJhdEFyZWEiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiQ29tYmF0Vm9sdW1lIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDb21iYXRWb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ29tYmF0QXJlYS9Db21iYXRWb2x1bWUiLA0KICAgICAgICAgICAgImhlaWdodCI6IDEwMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDgxNy44NjYsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNzg3LjY1NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDU1Ni4wMDk4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDYzLjczNjQsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTk4NC4wMjQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNTMxLjEzOSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0xMDE0Ljk2NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xMDUxLjU4OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC05MjEuNjk0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTEyMjkuMDA5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDYzLjczNjQsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTY2OC43MDUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMTI0My44MDksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA2Ni41MTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMTEyNy4xMTksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAzNzcuNzEzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTkxOS4wNjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA1MDMuNzkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDY1Ljg2OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IDUwOC41DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTExNy43NDUsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA1MjUuNzE4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjg1LjI5MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IDUyMC43ODMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA0NjIuMjUwMywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IDUyMi4yODgNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA5NDUuNzIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NTQuNzc2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMTE1MC4xNDEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAyMzYuMDMwOQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDExNzAuMzIxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDYzLjczNjQsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTIyNS4zNTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAxMDI4Ljc2NywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01NDkuNjYyDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJEZXBsb3lDYW0iLA0KICAgICAgICAgICAgInR5cGUiOiAiRGVwbG95Q2FtIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLjEwMTA1NiwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjk5NDg4MQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLjk5NDg4MSwNCiAgICAgICAgICAgICAgICAieiI6IDAuMTAxMDU2DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTE1LjUyMzYsDQogICAgICAgICAgICAgICAgInkiOiA0MDguNTQsDQogICAgICAgICAgICAgICAgInoiOiAtMjY1LjI5Mw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYW1lcmEzRC9EZXBsb3lDYW0iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRlYW0xQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgIk9iaklkIjogNTAxLA0KICAgICAgICAgICAgIkFyZWEiOiAiVGVhbTFBcmVhVHJpZ2dlci9UZWFtMU9PQlZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNDU5LjEzNCwNCiAgICAgICAgICAgICAgICAieSI6IDg3LjQ2NjIsDQogICAgICAgICAgICAgICAgInoiOiAtMzM1LjY1NQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJUZWFtMUFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRlYW0xT09CVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgImlkIjogIlRlYW0xQXJlYVRyaWdnZXIvVGVhbTFPT0JWb2x1bWUiLA0KICAgICAgICAgICAgImhlaWdodCI6IDAsDQogICAgICAgICAgICAicG9pbnRzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDg2LjMzOTU4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjM4MDM3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MjAuNjIxNQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MzMuNDYxODgsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODQuMzgwMzcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI2NS43NjAzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTQ4Ny4zNjE1OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC4zODAzNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjQ1LjM1NTYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDMyLjgxNTc4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjM4MDM3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MDguODQ2Nw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiVGVhbTFTZWN0b3IiLA0KICAgICAgICAgICAgIlNlY3RvckFyZWEiOiAiVGVhbTFBcmVhVHJpZ2dlci9UZWFtMU9PQlZvbHVtZSIsDQogICAgICAgICAgICAiUmV0cmVhdEFyZWEiOiAiVGVhbTFBcmVhVHJpZ2dlci9UZWFtMU9PQlZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJTZWN0b3IiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTQ3NC40MjU2LA0KICAgICAgICAgICAgICAgICJ5IjogODIuNzY3NTEsDQogICAgICAgICAgICAgICAgInoiOiAtMzM1LjYwMjQ0ODcNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVGVhbTFBcmVhVHJpZ2dlci9UZWFtMVNlY3RvciIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJTZWN0b3JBcmVhIiwNCiAgICAgICAgICAgICAgICAiUmV0cmVhdEFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRlYW0yQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgIk9iaklkIjogNTAwLA0KICAgICAgICAgICAgIkFyZWEiOiAiVGVhbTJBcmVhVHJpZ2dlci9UZWFtMk9PQlZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiA0MzUuMjc3LA0KICAgICAgICAgICAgICAgICJ5IjogODUuOTcyMiwNCiAgICAgICAgICAgICAgICAieiI6IC01ODEuMTg0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRlYW0yQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiVGVhbTJPT0JWb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiVGVhbTJBcmVhVHJpZ2dlci9UZWFtMk9PQlZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDM1Ny43OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC44OTg5MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNjM0LjQ3NDgNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAzNTIuMTkyOSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC44OTg5MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNTgwLjQ3MDENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA0OTcuMzU5NywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC44OTg5MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNTcwLjQ5MDcNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA1MDguMTk3MywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC44OTg5MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNjI3LjUyNjINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRlYW0yU2VjdG9yIiwNCiAgICAgICAgICAgICJTZWN0b3JBcmVhIjogIlRlYW0yQXJlYVRyaWdnZXIvVGVhbTJPT0JWb2x1bWUiLA0KICAgICAgICAgICAgIlJldHJlYXRBcmVhIjogIlRlYW0yQXJlYVRyaWdnZXIvVGVhbTJPT0JWb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDQzNS44NDk0NDksDQogICAgICAgICAgICAgICAgInkiOiA4Ni4wODMyNzYsDQogICAgICAgICAgICAgICAgInoiOiAtNTg4Ljk1ODk2DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRlYW0yQXJlYVRyaWdnZXIvVGVhbTJTZWN0b3IiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSIsDQogICAgICAgICAgICAgICAgIlJldHJlYXRBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgSCIsDQogICAgICAgICAgICAiT2JqSWQiOiAyMDcsDQogICAgICAgICAgICAiQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgSC9DYXBIIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMjguMzk4OCwNCiAgICAgICAgICAgICAgICAieSI6IDEyNS4yMzQsDQogICAgICAgICAgICAgICAgInoiOiAtMzUzLjM5Mg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgSCIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXBIIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEgvQ2FwSCBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiA1NSwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yMS40OTU0NDksDQogICAgICAgICAgICAgICAgICAgICJ5IjogOTQuNDcxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMDIuOTI2MjQxDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogNzguNTA0NTUxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDk0LjQ3MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzAyLjkyNjI0MQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDc4LjUwNDU1MSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA5NC40NzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQwMi45MjYyNDENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjEuNDk1NDQ5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDk0LjQ3MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDAyLjkyNjI0MQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU2VjdG9yIEgiLA0KICAgICAgICAgICAgIk9iaklkIjogMzA3LA0KICAgICAgICAgICAgIlNlY3RvckFyZWEiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEgvQ2FwSCBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNlY3RvciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAyOC4zOTg4LA0KICAgICAgICAgICAgICAgICJ5IjogMTE1LjIzNCwNCiAgICAgICAgICAgICAgICAieiI6IC0zNTMuMzkyDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBIL1NlY3RvciBIIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIlNlY3RvckFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIldvcmxkSWNvbiBIIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDQwNywNCiAgICAgICAgICAgICJ0eXBlIjogIldvcmxkSWNvbiIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAyOC4zOTg4LA0KICAgICAgICAgICAgICAgICJ5IjogMTI1LjIzNCwNCiAgICAgICAgICAgICAgICAieiI6IC0zNTMuMzkyDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBIL1dvcmxkSWNvbiBIIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXB0dXJlUG9pbnQgSCIsDQogICAgICAgICAgICAiT2JqSWQiOiA2MDcsDQogICAgICAgICAgICAiQ2FwdHVyZUFyZWEiOiBudWxsLA0KICAgICAgICAgICAgInR5cGUiOiAiQ2FwdHVyZVBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDI4LjM5ODgsDQogICAgICAgICAgICAgICAgInkiOiAxMzUuMjM0LA0KICAgICAgICAgICAgICAgICJ6IjogLTM1My4zOTINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEgvQ2FwdHVyZVBvaW50IEgiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiQ2FwdHVyZUFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBHIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDIwNiwNCiAgICAgICAgICAgICJBcmVhIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBHL0NhcEcgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAyNjguMzQyLA0KICAgICAgICAgICAgICAgICJ5IjogOTMuMTg4MiwNCiAgICAgICAgICAgICAgICAieiI6IC00MjIuMDUxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBHIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcEcgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRy9DYXBHIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgImhlaWdodCI6IDIwLA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjYwLjg2MjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzk1LjA1NTE2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjY4LjMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzk2LjUxNjA2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMzAzLjAyNDUsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDEyLjI3ODA1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjk5LjQ2NTEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDI0LjAyNjIyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjk3LjU4NDQsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDQwLjQwMjQ2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjg5LjI1NjYsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDU4Ljk3NTA2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjcyLjAwMDksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDUyLjY5ODY2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjU0Ljg3OTcyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc4LjkzNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ1MS44NzMxNg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDI0MS4yODM2OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OC45MzQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00NTEuNTgwNDYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAyMjguNDQyNCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OC45MzQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00NTAuOTQ2MTYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAyMjEuNTIzOCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OC45MzQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00NDIuNTg4MDYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAyMTkuNzY3MSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OC45MzQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MzMuMDc0NTYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAyNDQuNjgyMzIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDEzLjI1MTkzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjQ5LjI3OTgyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc4LjkzNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQwOS4wNDI0NQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDI1Mi43MzYxOCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OC45MzQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zOTcuMzY2MzYNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNlY3RvciBHIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDMwNiwNCiAgICAgICAgICAgICJTZWN0b3JBcmVhIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBHL0NhcEcgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJTZWN0b3IiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMjY4LjM0MiwNCiAgICAgICAgICAgICAgICAieSI6IDgzLjE4ODIsDQogICAgICAgICAgICAgICAgInoiOiAtNDIyLjA1MQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRy9TZWN0b3IgRyIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJTZWN0b3JBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJXb3JsZEljb24gRyIsDQogICAgICAgICAgICAiT2JqSWQiOiA0MDYsDQogICAgICAgICAgICAidHlwZSI6ICJXb3JsZEljb24iLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMjY4LjM0MiwNCiAgICAgICAgICAgICAgICAieSI6IDkzLjE4ODIsDQogICAgICAgICAgICAgICAgInoiOiAtNDIyLjA1MQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRy9Xb3JsZEljb24gRyINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZVBvaW50IEciLA0KICAgICAgICAgICAgIk9iaklkIjogNjA2LA0KICAgICAgICAgICAgInR5cGUiOiAiQ2FwdHVyZVBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDI2OC4zNDIsDQogICAgICAgICAgICAgICAgInkiOiAxMDMuMTg4MiwNCiAgICAgICAgICAgICAgICAieiI6IC00MjIuMDUxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBHL0NhcHR1cmVQb2ludCBHIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRiIsDQogICAgICAgICAgICAiT2JqSWQiOiAyMDUsDQogICAgICAgICAgICAiQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRi9DYXBGIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMTA1LjIwMywNCiAgICAgICAgICAgICAgICAieSI6IDk5LjEzMTYsDQogICAgICAgICAgICAgICAgInoiOiAtNDEzLjk3NQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRiIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXBGIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEYvQ2FwRiBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAyMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDk5LjIwNDU0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgzLjMwNTEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ0Mi4wNDk3DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogNzYuNTYxOCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4My4zMDUxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MjguODExNQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDc3LjMxMTEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODMuMzA1MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDExLjY5MDQ1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogODAuNjgwMiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4My4zMDUxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MDEuMjkyOQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDkwLjAwODksDQogICAgICAgICAgICAgICAgICAgICJ5IjogODMuMzA1MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzc2LjkzMzYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAxMDcuNTI5ODQsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODMuMzA1MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzgyLjIyNzQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAxMTguNjIzNSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4My4zMDUxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zODkuMTIyMw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDEzMy43MDMyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgzLjMwNTEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQwNy45MDczNA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDEzNi45NjAyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgzLjMwNTEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQxOS4yNDUyNg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDEzMS42MzI3LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgzLjMwNTEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQzMi4yNjU4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMTEzLjc4MzE1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgzLjMwNTEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQzOC42MDc4DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTZWN0b3IgRiIsDQogICAgICAgICAgICAiT2JqSWQiOiAzMDUsDQogICAgICAgICAgICAiU2VjdG9yQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRi9DYXBGIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEwNS4yMDMsDQogICAgICAgICAgICAgICAgInkiOiA4OS4xMzE2LA0KICAgICAgICAgICAgICAgICJ6IjogLTQxMy45NzUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEYvU2VjdG9yIEYiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiV29ybGRJY29uIEYiLA0KICAgICAgICAgICAgIk9iaklkIjogNDA1LA0KICAgICAgICAgICAgInR5cGUiOiAiV29ybGRJY29uIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEwNS4yMDMsDQogICAgICAgICAgICAgICAgInkiOiA5OS4xMzE2LA0KICAgICAgICAgICAgICAgICJ6IjogLTQxMy45NzUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEYvV29ybGRJY29uIEYiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVQb2ludCBGIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDYwNSwNCiAgICAgICAgICAgICJ0eXBlIjogIkNhcHR1cmVQb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAxMDUuMjAzLA0KICAgICAgICAgICAgICAgICJ5IjogMTA5LjEzMTYsDQogICAgICAgICAgICAgICAgInoiOiAtNDEzLjk3NQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRi9DYXB0dXJlUG9pbnQgRiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEUiLA0KICAgICAgICAgICAgIk9iaklkIjogMjA0LA0KICAgICAgICAgICAgIkFyZWEiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEUvQ2FwRSBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDgzLjQ1MywNCiAgICAgICAgICAgICAgICAieSI6IDk2LjA2MDMsDQogICAgICAgICAgICAgICAgInoiOiAtMTU3LjUwNw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXBFIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEUvQ2FwRSBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAyMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDY0LjIxODEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzkuNjcxNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMTMxLjkzMzgNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA3MS4xOTIyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc5LjY3MTcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTEzMS4zNTk0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogODkuOTM2ODksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzkuNjcxNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMTMzLjIwOTUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAxMTAuOTI3NywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OS42NzE3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0xNTAuNDAzNjUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAxMTAuMzQ1OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OS42NzE3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0xNzIuMDA1Mg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDg5Ljg2Nzk2NiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OS42NzE3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0xODIuNTE2Mg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDczLjI3MzEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzkuNjcxNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMTgzLjU0NDcNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA2MC45MDI0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc5LjY3MTcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTE3Ny44MjMzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogNTkuNDAzNywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OS42NzE3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0xNjUuNjc2MTQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA2Mi4yMzM1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc5LjY3MTcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTEzNC40MTMyDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTZWN0b3IgRSIsDQogICAgICAgICAgICAiT2JqSWQiOiAzMDQsDQogICAgICAgICAgICAiU2VjdG9yQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRS9DYXBFIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDgzLjQ1MywNCiAgICAgICAgICAgICAgICAieSI6IDg2LjA2MDMsDQogICAgICAgICAgICAgICAgInoiOiAtMTU3LjUwNw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRS9TZWN0b3IgRSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJTZWN0b3JBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJXb3JsZEljb24gRSIsDQogICAgICAgICAgICAiT2JqSWQiOiA0MDQsDQogICAgICAgICAgICAidHlwZSI6ICJXb3JsZEljb24iLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogODMuNDUzLA0KICAgICAgICAgICAgICAgICJ5IjogOTYuMDYwMywNCiAgICAgICAgICAgICAgICAieiI6IC0xNTcuNTA3DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBFL1dvcmxkSWNvbiBFIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXB0dXJlUG9pbnQgRSIsDQogICAgICAgICAgICAiT2JqSWQiOiA2MDQsDQogICAgICAgICAgICAidHlwZSI6ICJDYXB0dXJlUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogODMuNDUzLA0KICAgICAgICAgICAgICAgICJ5IjogMTA2LjA2MDMsDQogICAgICAgICAgICAgICAgInoiOiAtMTU3LjUwNw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRS9DYXB0dXJlUG9pbnQgRSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEQiLA0KICAgICAgICAgICAgIk9iaklkIjogMjAzLA0KICAgICAgICAgICAgIkFyZWEiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEQvQ2FwRCBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDI5LjY1MzksDQogICAgICAgICAgICAgICAgInkiOiA5OS4wNDA2LA0KICAgICAgICAgICAgICAgICJ6IjogLTM0OS4zMTkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEQiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwRCBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBEL0NhcEQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMjUsDQogICAgICAgICAgICAicG9pbnRzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA2MC42MTI0OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3Ny4wMzg3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMTMuMDQwNw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDIzLjI2ODc1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc3LjAzODcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQwNi45ODM0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTUuOTk1MjEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzcuMDM4NywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzk1LjgzMDINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAwLjIzNDg5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc3LjAzODcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTM2OC44MTI3NQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDI0LjA1NDkyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc3LjAzODcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMxMC45Mzc3DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMzcuMzY3NjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzcuMDM4NywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjk5Ljk0OTINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNlY3RvciBEIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDMwMywNCiAgICAgICAgICAgICJTZWN0b3JBcmVhIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBEL0NhcEQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJTZWN0b3IiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMjkuNjUzOSwNCiAgICAgICAgICAgICAgICAieSI6IDg5LjA0MDYsDQogICAgICAgICAgICAgICAgInoiOiAtMzQ5LjMxOQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRC9TZWN0b3IgRCIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJTZWN0b3JBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJXb3JsZEljb24gRCIsDQogICAgICAgICAgICAiT2JqSWQiOiA0MDMsDQogICAgICAgICAgICAidHlwZSI6ICJXb3JsZEljb24iLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMjkuNjUzOSwNCiAgICAgICAgICAgICAgICAieSI6IDk5LjA0MDYsDQogICAgICAgICAgICAgICAgInoiOiAtMzQ5LjMxOQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRC9Xb3JsZEljb24gRCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZVBvaW50IEQiLA0KICAgICAgICAgICAgIk9iaklkIjogNjAzLA0KICAgICAgICAgICAgInR5cGUiOiAiQ2FwdHVyZVBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDI5LjY1MzksDQogICAgICAgICAgICAgICAgInkiOiAxMDkuMDQwNiwNCiAgICAgICAgICAgICAgICAieiI6IC0zNDkuMzE5DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBEL0NhcHR1cmVQb2ludCBEIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQyIsDQogICAgICAgICAgICAiT2JqSWQiOiAyMDIsDQogICAgICAgICAgICAiQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQy9DYXBDIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTM2LjQ3OTcsDQogICAgICAgICAgICAgICAgInkiOiA5NS42MzIsDQogICAgICAgICAgICAgICAgInoiOiAtNTMwLjY1MQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQyIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXBDIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEMvQ2FwQyBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAxNSwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDIyLjg1NDk0OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01MDQuNTgxMg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDMxLjkzNDI0OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01MTkuMTIwNA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDM1LjY5Mzg0OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01MzMuMjk2Mzg4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjkuMzEyNzQ4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU0OS40OTAzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjAuNjQ5ODQ4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU2My4wNzENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA4Ljk0MDY0OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01NzcuNjkwMQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03LjIxNTQ1MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01ODUuOTI1NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yNy43NDI4MTIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODQuOTE0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNTg2LjE4MjYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNTIuOTk0MjUyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU4My4zNDcNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzcuNjQ4NzUyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU3My4zNjQ0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTk1LjE0MjU1MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01NTguNTA2OA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xMDIuMTk5MTUyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU0MC4yMzU0OA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xMDAuODU3OTUyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTUyNC44NDk1NQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC05Ni42NjI4NTIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODQuOTE0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNTA2LjE5MDkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtODQuODM2ODUyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ5NS41NzgzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTczLjM2ODc1MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00ODQuMzA5OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01Ni44NTUzNTIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODQuOTE0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDc3LjcwNTYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMzguNTA1OTQyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ2OS44ODM5DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE4LjcyMjY1MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00NzAuNDAzNA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDEuMTI2NjQ4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ3OC4wMjY1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMTQuODMwNzQ4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ5MS41NzEzDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTZWN0b3IgQyIsDQogICAgICAgICAgICAiT2JqSWQiOiAzMDIsDQogICAgICAgICAgICAiU2VjdG9yQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQy9DYXBDIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0zNi40Nzk3LA0KICAgICAgICAgICAgICAgICJ5IjogODUuNjMyLA0KICAgICAgICAgICAgICAgICJ6IjogLTUzMC42NTENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEMvU2VjdG9yIEMiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiV29ybGRJY29uIEMiLA0KICAgICAgICAgICAgIk9iaklkIjogNDAyLA0KICAgICAgICAgICAgInR5cGUiOiAiV29ybGRJY29uIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0zNi40Nzk3LA0KICAgICAgICAgICAgICAgICJ5IjogOTUuNjMyLA0KICAgICAgICAgICAgICAgICJ6IjogLTUzMC42NTENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEMvV29ybGRJY29uIEMiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVQb2ludCBDIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDYwMiwNCiAgICAgICAgICAgICJ0eXBlIjogIkNhcHR1cmVQb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMzYuNDc5NywNCiAgICAgICAgICAgICAgICAieSI6IDEwNS42MzIsDQogICAgICAgICAgICAgICAgInoiOiAtNTMwLjY1MQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQy9DYXB0dXJlUG9pbnQgQyINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIiLA0KICAgICAgICAgICAgIk9iaklkIjogMjAxLA0KICAgICAgICAgICAgIkFyZWEiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIvQ2FwQiBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC02My44MzQ1LA0KICAgICAgICAgICAgICAgICJ5IjogOTcuNjE3NiwNCiAgICAgICAgICAgICAgICAieiI6IC0yODIuOTk1DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBCIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcEIgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQi9DYXBCIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgImhlaWdodCI6IDE1LA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTk4Ljc2MTUsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODEuMzUwMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjY0LjIyNzgNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtODguMjkyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI0Ny45NTA3DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTc1Ljg3NDUsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODEuMzUwMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjU2LjI3OTkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjEuODI3MTYsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODEuMzUwMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjY4LjE2OTkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDUuMzQwMiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4MS4zNTAxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNjkuNzUzNA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yNS4zODc5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI3MC40ODk4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI4Ni4zOTM3Nw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0zMy4zMTg0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI5Ny4wMDI0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTUyLjAyNSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4MS4zNTAxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMDUuMzU4Mg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC02NS44NTI0NSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4MS4zNTAxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMjkuODc2Mg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC04Ni4zMjk1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMyMi43OTU4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTk0LjEzODcsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODEuMzUwMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzA5LjIyMDYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtOTAuMjQxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI4MS42NDg5Ng0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU2VjdG9yIEIiLA0KICAgICAgICAgICAgIk9iaklkIjogMzAxLA0KICAgICAgICAgICAgIlNlY3RvckFyZWEiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIvQ2FwQiBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNlY3RvciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNjMuODM0NSwNCiAgICAgICAgICAgICAgICAieSI6IDg3LjYxNzYsDQogICAgICAgICAgICAgICAgInoiOiAtMjgyLjk5NQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQi9TZWN0b3IgQiIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJTZWN0b3JBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJXb3JsZEljb24gQiIsDQogICAgICAgICAgICAiT2JqSWQiOiA0MDEsDQogICAgICAgICAgICAidHlwZSI6ICJXb3JsZEljb24iLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTYzLjgzNDUsDQogICAgICAgICAgICAgICAgInkiOiA5Ny42MTc2LA0KICAgICAgICAgICAgICAgICJ6IjogLTI4Mi45OTUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIvV29ybGRJY29uIEIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVQb2ludCBCIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDYwMSwNCiAgICAgICAgICAgICJ0eXBlIjogIkNhcHR1cmVQb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNjMuODM0NSwNCiAgICAgICAgICAgICAgICAieSI6IDEwNy42MTc2LA0KICAgICAgICAgICAgICAgICJ6IjogLTI4Mi45OTUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIvQ2FwdHVyZVBvaW50IEIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBBIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDIwMCwNCiAgICAgICAgICAgICJBcmVhIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBBL0NhcEEgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMjExLjE1LA0KICAgICAgICAgICAgICAgICJ5IjogOTQuMDY2OSwNCiAgICAgICAgICAgICAgICAieiI6IC0zMDAuNzE4DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBBIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcEEgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQS9DYXBBIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgImhlaWdodCI6IDM1LA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE3My4wMzc5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI2OS45MDY5NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xNzAuODIxNSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2NC41NjkyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNzQuNTUxNjINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMTY4LjEzNjUsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjQuNTY5MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjg0LjU5NDY4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE2OS4zOTI3LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI5MS43NTY1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE3My44NjgyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMwMi40NTQxDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE3Ni44NTg1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMxMi42MzE2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE4Ny41MjkyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMyNS41MzA4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTIwMS45NDg5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMzMi44NTAzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTIzNC45NTkzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMzMS43OTIxDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI0OC4zNzE3LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMyNy45ODU5DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI2MS44MDY5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMyMy44Nzc5DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI2Mi40MTIyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMwNy45NjIzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI1OS4zMzM0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI4OS43MTgzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI1OS40MzY5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI3Ni4yMzY4Mw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yNDAuNjE0NCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2NC41NjkyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNzUuNDQ4MjMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjI2LjM0Njc4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI3NS4zMzM5Nw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yMjAuMTE2MDYsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjQuNTY5MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjczLjY0ODMzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTIxNS45NTIxNSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2NC41NjkyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNzAuNTk2MTUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjA1LjExNTIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjQuNTY5MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjY5LjUxODI0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE5NC40NTA5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI2OC4xMDU0NQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xODEuMjk5MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2NC41NjkyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNjcuMjI5DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTZWN0b3IgQSIsDQogICAgICAgICAgICAiT2JqSWQiOiAzMDAsDQogICAgICAgICAgICAiU2VjdG9yQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQS9DYXBBIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0yMTEuMTUsDQogICAgICAgICAgICAgICAgInkiOiA4NC4wNjY5LA0KICAgICAgICAgICAgICAgICJ6IjogLTMwMC43MTgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEEvU2VjdG9yIEEiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiV29ybGRJY29uIEEiLA0KICAgICAgICAgICAgIk9iaklkIjogNDAwLA0KICAgICAgICAgICAgInR5cGUiOiAiV29ybGRJY29uIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0yMTEuMTUsDQogICAgICAgICAgICAgICAgInkiOiA5NC4wNjY5LA0KICAgICAgICAgICAgICAgICJ6IjogLTMwMC43MTgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEEvV29ybGRJY29uIEEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVQb2ludCBBIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDYwMCwNCiAgICAgICAgICAgICJ0eXBlIjogIkNhcHR1cmVQb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMjExLjE1LA0KICAgICAgICAgICAgICAgICJ5IjogMTA0LjA2NjksDQogICAgICAgICAgICAgICAgInoiOiAtMzAwLjcxOA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQS9DYXB0dXJlUG9pbnQgQSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZyIsDQogICAgICAgICAgICAiT2JqSWQiOiAxMDAwLA0KICAgICAgICAgICAgIkNhcHR1cmVQb2ludHMiOiBbDQogICAgICAgICAgICAgICAgIkNhcHR1cmVBcmVhVHJpZ2dlciBBL0NhcHR1cmVQb2ludCBBIiwNCiAgICAgICAgICAgICAgICAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIvQ2FwdHVyZVBvaW50IEIiLA0KICAgICAgICAgICAgICAgICJDYXB0dXJlQXJlYVRyaWdnZXIgQy9DYXB0dXJlUG9pbnQgQyIsDQogICAgICAgICAgICAgICAgIkNhcHR1cmVBcmVhVHJpZ2dlciBEL0NhcHR1cmVQb2ludCBEIiwNCiAgICAgICAgICAgICAgICAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEUvQ2FwdHVyZVBvaW50IEUiLA0KICAgICAgICAgICAgICAgICJDYXB0dXJlQXJlYVRyaWdnZXIgRi9DYXB0dXJlUG9pbnQgRiIsDQogICAgICAgICAgICAgICAgIkNhcHR1cmVBcmVhVHJpZ2dlciBHL0NhcHR1cmVQb2ludCBHIiwNCiAgICAgICAgICAgICAgICAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEgvQ2FwdHVyZVBvaW50IEgiDQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC01OS44NjkzLA0KICAgICAgICAgICAgICAgICJ5IjogMjE0LjA5MiwNCiAgICAgICAgICAgICAgICAieiI6IC0zNTcuMDMxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVQb2ludCBTZWN0b3IgT3JkZXJpbmciLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiQ2FwdHVyZVBvaW50cyINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgQSBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBBIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgQiBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBCIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgQyBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBDIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgRCBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBEIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgRSBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBFIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgRiBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBGIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgRyBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBHIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgIF0sDQogICAgIlN0YXRpYyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiTVBfVHVuZ3N0ZW5fVGVycmFpbiIsDQogICAgICAgICAgICAibWV0YWRhdGEvX2VkaXRfbG9ja18iOiB0cnVlLA0KICAgICAgICAgICAgInR5cGUiOiAiTVBfVHVuZ3N0ZW5fVGVycmFpbiIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiU3RhdGljL01QX1R1bmdzdGVuX1RlcnJhaW4iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIk1QX1R1bmdzdGVuX0Fzc2V0cyIsDQogICAgICAgICAgICAibWV0YWRhdGEvX2VkaXRfbG9ja18iOiB0cnVlLA0KICAgICAgICAgICAgInR5cGUiOiAiTVBfVHVuZ3N0ZW5fQXNzZXRzIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJTdGF0aWMvTVBfVHVuZ3N0ZW5fQXNzZXRzIg0KICAgICAgICB9DQogICAgXQ0KfQ==","compiled":""},"attachmentType":1,"errors":[]}}],"workspace":{"mod":{"blocks":{"languageVersion":0,"blocks":[{"type":"modBlock","id":"f`y}HF2MN[sU5oXf5Fi8","x":10,"y":10,"deletable":false,"inputs":{"RULES":{"block":{"type":"ruleBlock","id":"%8VOTreQ9~!6,MNruG]A","extraState":{"isOngoingEvent":true},"fields":{"NAME":"New Rule","EVENTTYPE":"Ongoing","OBJECTTYPE":"Global"}}}}}]}}},"teamComposition":[[1,{"humanCapacity":32}],[2,{"humanCapacity":32}]],"gameMode":"ModBuilderCustom","attachments":[{"id":"2965d6d1-95d0-4cbc-93f0-9eb0a1020f1c","version":"234","filename":"Script.ts","isProcessable":true,"processingStatus":2,"attachmentData":{"original":"Ly8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFZlcnNpb25pbmcgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIHZlcnNpb246IDAuNjIxIHwgRGF0ZTogMDIuMDcuMjYgfCBUaW1lOiAxNjo1MiBVVEMKLy8gbmFtZSBvZiBzY3JpcHQ6IFRXTF9WZWhpY2xlc19Pbmx5X1NjcmlwdC50cwovLyBuYW1lIG9mIHBhaXJlZCBzdHJpbmdzIGZpbGU6IFRXTF9WZWhpY2xlc19Pbmx5X1N0cmluZ3MuanNvbgovLyBwb2xpY3k6IHRoZSBzdHJpbmcgaHVkLmJyYW5kaW5nLnRpdGxlIHNob3VsZCBkaXNwbGF5IHRoaXMgc2FtZSB2ZXJzaW9uIGF0IHRoZSBlbmQgb2YgdGhlIHRpdGxlCi8vIHBvbGljeTogaW5jcmVtZW50IG1pbm9yIHZlcnNpb24gb24gZXZlcnkgY2hhbmdlIChVVEMpCi8vIHBvbGljeTogbWFqb3IgdmVyc2lvbnMgcmVzZXJ2ZWQgZm9yIG1pbGVzdG9uZSBmZWF0dXJlIHJlbGVhc2VzIChwcmltYXJ5IGF1dGhvcnMgb25seSkKLy8gcG9saWN5OiBFT0YgdmVyc2lvbiBsaW5lIG11c3QgbWF0Y2ggdGhlIGhlYWRlciB2ZXJzaW9uIGFuZCB0aW1lc3RhbXAKCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBWZXJzaW9uaW5nIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBMaWNlbnNlIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBNSVQgTGljZW5zZQovLyAKLy8gQ29weXJpZ2h0IChjKSAyMDI2IHRlYW13YXJmYXJlLm5ldCwgdWJlcmR1YmVyc29sZGF0LCBwb2x5a2F0YW5hCi8vIAovLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5Ci8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLCB0byBkZWFsCi8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbAovLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMKLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKLy8gCi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbAovLyBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgovLyAKLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKLy8gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRQovLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCi8vIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sCi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFCi8vIFNPRlRXQVJFLgoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIExpY2Vuc2UgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEF1dGhvcnMgLyBBdHRyaWJ1dGlvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gQXV0aG9yczogVWJlckR1YmVyU29sZGF0LCBQb2x5bm9yYmx1LCBEb3gKLy8gQ29kZSBnZW5lcmF0aW9uLCBhc3Npc3RhbmNlIGFuZCBzdXBwb3J0IGJ5OiBDaGF0R1BUIChPcGVuQUksIEdQVC01LjIsIEdQVC01LjItQ29kZXgpCi8vCi8vIFRoaXMgY29kZSBpcyBzb3VyY2VkIGNvbnRyb2xsZWQgaGVyZTogaHR0cHM6Ly9naXRodWIuY29tL1RlYW13YXJmYXJlLU5ldHdvcmsvYmY2LXBvcnRhbC90cmVlL21haW4KLy8KLy8gQkY2IFBvcnRhbCBDb21tdW5pdHkgVG9vbHMgdXNlZC9yZWZlcmVuY2VkOgovLyAgLSBQb3J0YWwgQ29tbXVuaXR5IERpc2NvcmQ6IGh0dHBzOi8vZGlzY29yZC5jb20vaW52aXRlL2JhdHRsZWZpZWxkLXBvcnRhbC1jb21tdW5pdHktODcwMjQ2MTQ3NDU1ODc3MTgxCi8vICAtIFR5cGVTY3JpcHQgUHJvamVjdCBUZW1wbGF0ZSBmb3IgQmF0dGxlZmllbGQgNiBQb3J0YWwgU2NyaXB0aW5nIGJ5IE1pa2UgRGVMdWNhOiBodHRwczovL2dpdGh1Yi5jb20vZGVsdWNhLW1pa2UvYmY2LXBvcnRhbC1zY3JpcHRpbmctdGVtcGxhdGUKLy8gICAgIC0gTXVsdGktQ2xpY2sgZGV0ZWN0b3IgYnkgTWlrZSBEZUx1Y2E6IGh0dHBzOi8vZ2l0aHViLmNvbS9kZWx1Y2EtbWlrZS9iZjYtcG9ydGFsLXV0aWxzL3RyZWUvbWFzdGVyL2ludGVyYWN0LW11bHRpLWNsaWNrLWRldGVjdG9yCi8vICAgICAtIE1hcCBkZXRlY3RvciBieSBNaWtlIERlTHVjYTogaHR0cHM6Ly9naXRodWIuY29tL2RlbHVjYS1taWtlL2JmNi1wb3J0YWwtdXRpbHMvdHJlZS9tYXN0ZXIvbWFwLWRldGVjdG9yCi8vICAtIFRlYW0gU3dpdGNoIFVJIFRlbXBsYXRlIGJ5IFRoZU96enk6IGh0dHBzOi8vZ2l0aHViLmNvbS9UaGUwenp5L0JGNi1Qb3J0YWwtVGVhbVN3aXRjaFVJCi8vICAtIEJGNiBQb3J0YWwgQXNzaXN0YW50IGJ5IFF1b2VpemE6IGh0dHBzOi8vY2hhdGdwdC5jb20vZy9nLTY4ZjI4NTgwZWVmYzgxOTFiNGNmNDBiYmYyMzA1ZGIzLWJmNi1wb3J0YWwtYXNzaXN0YW50Ci8vICAgICAtIEdQVCBQcm9tcHQ6IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL1F1b2VpemEvODA4NWYxNDJhZDhhMDVlZTA0Yjc5YWRjYzRhZDhmZDcKLy8gIC0gQkY2IFVzZXIgSW50ZXJmYWNlIFRvb2wgYnVpbGRlciBieSBFYWdsZU5haXQ6IGh0dHBzOi8vdG9vbHMuYmZwb3J0YWwuZ2cvdWktYnVpbGRlci8KLy8gIC0gQ3VzdG9tIENvbnF1ZXN0IFRlbXBsYXRlIGJ5IGFuZHk2MTcwOiBodHRwczovL2JmcG9ydGFsLmdnL2V4cGVyaWVuY2VzL2N1c3RvbS1jb25xdWVzdC10ZW1wbGF0ZS8KLy8gIC0gQXNzZXQgQnJvd3NlciBieSBXaWxsVG90aDogaHR0cHM6Ly9iZjZwcm9wcy5wYWdlcy5kZXYvIC0tIGh0dHBzOi8vZ2l0aHViLmNvbS9UaGUtU2lyLUNvbW11bml0eS9wcm9wX3N0YXRzL3JlbGVhc2VzL3RhZy92MS4xLjIuMAoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEF1dGhvcnMgLyBBdHRyaWJ1dGlvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2hhbmdlbG9nIC8gSGlzdG9yeSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gdjAuNjIyOiBWZXJzaW9uIGJ1bXAKLy8gdjAuNjIxOiBBZGp1c3RlZCBBaXJjcmFmdCBDZWlsaW5ncyBmb3IgTGFkZGVyIGJhc2VkIG9uIGZlZWRiYWNrCi8vIHYwLjYyMDogSGVsaXMgQWxwaGEgQ2FuZGlkYXRlIDEuMCByZWxlYXNlIGZvciAydjIgTGFkZGVyIG9wZW5pbmcKLy8gdjAuNjE2OiBGaXggZ2FtZW1vZGUgc2V0dGluZ3Mgd2l0aCBzb21lIG1pbm9yIFVJIHR3ZWFrcwovLyB2MC42MDg6IEFkZCBoZWxpcy1vbmx5IEggZmxhZyBzZWxlY3Rpb24gKyBwZXItbW9kZSBvdmVydGltZSB6b25lcwovLyB2MC41OTI6IEFkZCBhZG1pbiB0aWUtYnJlYWtlciBtb2RlIHRvZ2dsZSAobGFzdCByb3VuZC9hbGwvZGlzYWJsZWQpIGFsb25nIHdpdGggbW9yZSBnYW1lIG1vZGUgY29udHJvbHMgYW5kIGN1c3RvbWl6YXRpb25zCi8vIHYwLjU5MTogQWRkIHRha2VvZmYgbGltaXQgZ2F0aW5nICsgb3ZlcnRha2VvZmYgbWVzc2FnaW5nIChIVUQgZmxvb3IgKyAyMCkKLy8gdjAuNTc3OiBBZGQgcmVzZXQgYnV0dG9uICsgaGVsaSBzcGF3biBvdmVycmlkZXMgdGllZCB0byBjb25maXJtCi8vIHYwLjU2ODogQWlyY3JhZnQgY2VpbGluZyBjb25maWcgcGVyIG1hcCArIGN1c3RvbSBvdmVycmlkZSBjb250cm9scyBmb3IgZ2FtZSBtb2RlcwovLyB2MC41Njc6IE1hcCBjb25maWdzIG5vdyBzdXBwb3J0IGhlbGkgc3Bhd25zIGFuZCBtb2RlLWJhc2VkIHNlbGVjdGlvbgovLyB2MC41NDQ6IFBsYXl0ZXN0IHJlYWR5LCBBbHBoYSBDYW5kaWRhdGUgZm9yIDEuMC4uLi4KLy8gdjAuNTQzOiBHdWFyZCBqb2luLXByb21wdCBkZWxldGVzICsgZGVmZXIgZm9yY2VkIHVuZGVwbG95IHRvIGF2b2lkIGRlcGxveSBsaWZlY3ljbGUgY3Jhc2hlcwovLyB2MC41NDE6IEF2b2lkIGhhcmQtZGVsZXRpbmcgb3ZlcnRpbWUgSFVEIG9uIHVuZGVwbG95OyBoaWRlICsgZHJvcCByZWZzIGZvciBzYWZlIHJlYnVpbGQKLy8gdjAuNTM5OiBDb2RlIGNsZWFudXAsIHJlZ2lvbnMgYWRkZWQsIDEuMCBBbHBoYSBSZWxlYXNlIGNhbmRpZGF0ZQovLyB2MC41Mzg6IFVJIHNhZnRleSB3cmFwcGVycywgcmVvcmdhbml6ZWQgY29kZSwgZml4ZWQgZGlzY29ubmVjdCBCdWdzLCBtYXAgY3Jhc2ggYnVncyBhbmQgVUkgaW5jb25zaXN0ZW5jaWVzIHdpdGggdGltaW5nLiBBbHBoYSBjYW5kaWRhdGUgZm9yIDEuMCByZWxlYXNlLgovLyB2MC41MTQ6IFVJL1VYIFBvbGlzaCwgY2FwdHVyZSBiYXIgcHJvZ3Jlc3MgJSBkaXNwbGF5LCB0aWUtYnJlYWtlciB0aXAgYWRkZWQKLy8gdjAuNDc3OiBQbGF5dGVzdGluZyB2ZXJzaW9uLCBhbHBoYSBjYW5kaWRhdGUgZm9yIDEuMCByZWxlYXNlCi8vIHYwLjQ2ODogQWRkZWQgQWRtaW4gZnVuY3Rpb24gZm9yIG92ZXJyaWRpbmcgcmFuZG9tIHRpZS1icmVha2VyIGZsYWcgZm9yIHRlc3RpbmcKLy8gdjAuNDQzOiBQb2xpc2hlZCBUaWUtQnJlYWtlciBVSSwgY2FwdHVyZSB6b25lIHJhdGVzLCBtZXNzYWdpbmcgYW5kIFVYIG9mIGNhcHR1cmluZwovLyB2MC40NTc6IEhhbGYtdGltZSBmbGFnIHZpc2liaWxpdHkgKyBjYXB0dXJlIHR1bmluZwovLyB2MC4zOTU6IEFkZCBvdmVydGltZSBmbGFnIGNhcHR1cmUgdGllYnJlYWtlciAocmFuZG9taXplZCBjYXB0dXJlIHBvaW50ICsgVUkgKyBjYXB0dXJlIGxvZ2ljKQovLyB2MC4zNTk6IFJlcXVpcmUgdHJpcGxlLXRhcCB0byB1bmxvY2sgam9pbiBwcm9tcHQgdGlwcwovLyB2MC4zNTg6IEFkZCBqb2luIHByb21wdCB0aXBzIHNlcXVlbmNlIHdpdGggdW5sb2NrIGdhdGluZyBhbmQgcGVyLXBsYXllciBzdGF0ZQovLyB2MC4zNTc6IEhpZGUgaGVscC9yZWFkeSB0ZXh0IHdoaWxlIHVuZGVwbG95ZWQgdG8gYXZvaWQgcmVzcGF3biBvdmVybGF5ICYgZml4ZWQgaXNzdWVzIHNtYWxsZXIgYXNwZWN0IHJhdGlvcyBvciB3aWVyZCByZXNvbHV0aW9ucyBkdWUgdG8gZGlhbG9nIG92ZXJsYXAKLy8gdjAuMzQ2OiBBZGRlZCBNSVQgTGljZW5jZSBhbmQgZW5zdXJlZCBzcGF3bi1kaXNhYmxlZCB3YXJuaW5nIGlzIHNob3duIHdoaWxlIHVuZGVwbG95ZWQgZHVyaW5nIGxpdmUgcm91bmRzIGZvciBjb250ZXh0Ci8vIHYwLjM0MDogVHdlYWsgSFVEIGNvdW50ZXIgc2l6ZXMsIGFkZCB2aWN0b3J5IGNyb3duICsgZHluYW1pYyByb3N0ZXIgaGVpZ2h0ICsgZGVidWcgcm9zdGVyIHBsYWNlaG9sZGVycwovLyB2MC4zMzc6IEFkZGVkIHJvdW5kLXdpbiBjcm93biBhbmQgdHJlbmRpbmcgd2lubmVyIGNyb3duIGljb25zIGluc2lkZSB0b3AgSFVEIHBhbmVscwovLyB2MC4zMzM6IEFkZGVkIHJvc3RlcnMgdG8gdGhlIGJvdHRvbSBvZiB0aGUgbWFwIHZpY3RvcnkgZGlhbG9nIGZvciBpbXByb3ZlZCBVWCAvIFNjcmVlbnNob3QgYXVkaXRpbmcKLy8gdjAuMzMwOiBDbGVhbmVkIHVwIHRvcCBIVUQsIG1hZGUgcm91bmQgc2NvcmVzIG1vcmUgb2J2aW91cywgcmVmYWN0b3JlZCBzb21lIGxvZ2ljIGFyb3VuZCByZWFkeSBzdGF0dXMgZGlzcGxheXMKLy8gdjAuMzIyOiBDbGVhbmVkIHVwIFVJIHNwYWNpbmdzLCBjb2xvcnMsIGNvbnN0YW50cywgcG9zaXRpb25zIGFuZCBvcGFjaXR5IC0gbW9zdCB0aGluZ3MgY29udHJvbGxlZCB2aWEgY29uc3RhbnRzIG5vdwovLyB2MC4yNzE6IEFkZGVkIGZpcnN0LWpvaW4gaGVscCBwcm9tcHQgb3ZlcmxheSwgY29udHJvbGxlZCB3aXRoIFNIT1dfSEVMUF9URVhUX1BST01QVF9PTl9KT0lOCi8vIHYwLjI2OTogRGlzYWJsZSByZXNwYXduIGR1cmluZyBsaXZlIHJvdW5kcyB3aXRoIERJU0FCTEVfUkVTUEFXTl9EVVJJTkdfTElWRV9ST1VORAovLyB2MC4yNjY6IEluY3JlYXNlZCB0cmlwbGUgdGFwIHdpbmRvdyB0byAycywgaW5zdGVhZCBvZiAxcy4gQ2xhcmlmaWVkIHN0cmluZyB0byBtZW50aW9uICJzdGFuZGluZyBzdGlsbCIgd2hpbGUgdHJpcGxlIHRhcHBpbmcuCi8vIHYwLjI2MzogRml4IGZvciByZWFkeSB1cCByb3N0ZXIgcmVmcmVzaGluZyB3aGVuIG5ldyBwbGF5ZXIgam9pbnMgb3Igb2xkIHBsYXllciBkaXNjb25uZWN0cwovLyB2MC4yNjI6IFJlZmFjdG9yZWQgcm91bmQgZW5kIHByb2Nlc3MuIERlc3Ryb3kgYWxsIHRhbmtzLCBmb3JjZSB1bmRlcGxveSBhbGwgcGxheWVycywgcmVzcGF3biBhbGwgdGFua3MsIHdhaXQsIGZvcmNlIHJlZGVwbG95IHBsYXllcnMsIGtlZXAgUm91bmQgRW5kIGRpYWxvZyB1cCBsb25nZXIKLy8gdjAuMjU5OiBSZWxlYXNlIHZlcnNpb24gZm9yIExhZGRlciB3aXRoIDggbWFwcwovLyB2MC4yNTg6IEFkZGVkIE1hcENvbmZpZyBzZXR0aW5ncyBmb3IgQXJlYSAyMkIKLy8gdjAuMjU3OiBGaXhlZCByYWNlIGNvbmRpdGlvbiBvbiBmaXJzdCB0YW5rIHNwYXduZWQgLSBuZWVkIHRvIGNsZWFyIGl0IGFuZCBzcGF3biBjb3JyZWN0IHZlaGljbGUgdG8gYXZvaWQgZGVmYXVsdCBBYnJhbXMgc3Bhd24KLy8gdjAuMjQ3OiBBZGRlZCB0ZWFtIG5hbWVzIHRvIE1hcENvbmZpZywgZml4ZWQgYmFja2VuZCBKUyBFcnJvcnMgb24gcGxheWVyIGJlaW5nIGRlcGxveWVkIG9yIG5vdCAoZW1wdHkgc3RyaW5nIGFyZ3Mge30gdnMgezB9KQovLyB2MC4yNDA6IEZpeGVkIHNwYXduZXIgbG9naWMgcmVncmVzc2lvbnMgKHNwYXduIGJsb2NrIGFuZCBmYWlsZWQgdG8gc3Bhd24gd2l0aCByYXBpZCBtb2RlIGluY3JlYXNlKQovLyB2MC4yMzg6IFN1Ym1pdHRlZCBmb3IgQ29kZSBSZXZpZXcgYnkgRG94ICYgUG9seQovLyB2MC4yMzM6IENvZGUgY2xlYW51cCwgcmVvcmdhbml6YXRpb24gYW5kIGNvbW1lbnQgY2xhcml0eSwgcHJlcHBpbmcgZm9yIDEuMCBSZWxlYXNlIHZlcnNpb24KLy8gdjAuMjI4OiBBZGRlZCBkeW5hbWljIGJpbmRpbmcgdG8gbW9kZXM6IDF2MSBvbmx5IHNwYXducyAxIHRhbmssIDR2NCBzcGF3bnMgNCB0YW5rcy4gQ29uZmlndXJhYmxlIHdoZW4gcm91bmQgaXMgbm90IGxpdmUuCi8vIHYwLjIyNDogQWRkZWQgTWFwIERldGVjdG9yIGxvZ2ljIHRvIGF1dG8tZGV0ZWN0IHdoaWNoIE1hcENvbmZpZyBhbmQgc3Bhd25lcnMgdG8gdXNlLCB0aGVuIGRpc3BsYXkgdGhlIE1hcCBuYW1lIG9uIHRoZSBSZWFkeSBVcCBzY3JlZW4KLy8gdjAuMjE4OiBGaXJzdCBwYXNzIG9uIFNwYXduIHBvaW50cyBmb3IgYWxsIDcgbWFwcyBpbiBMYWRkZXIgcm90YXRpb24sIHVzaW5nIEFkbWluIERlYnVnIFBvc2l0aW9uIHRvb2wKLy8gdjAuMjE3OiBBZGRlZCBBZG1pbiBEZWJ1ZyBQb3NpdGlvbiBidXR0b24gdG8gZGlzcGxheSBYL1kvWiBjb29yZGluYXRlcyBhbmQgWSByb3RhdGlvbiBvZiBwbGF5ZXIKLy8gdjAuMjA1OiBBZGRlZCBzcGF3biBjYW1wIHNjb3JpbmcgcHJvdGVjdGlvbiBpZiBhIGxlZnRvdmVyIHZlaGljbGUgcmVtYWlucyBpbiBtYWluIGJhc2UgZHVyaW5nIHJvdW5kIHNldHVwCi8vIHYwLjE5NzogQWRqdXN0ZWQgc29tZSBIVUQvVUkgcG9zaXRpb25zLCBhZGRlZCBuZXcgbGFiZWxzIGFuZCBhZGRlZCAiMXYxIiB1cCB0byAiNHY0IiBtYXRjaHVwIGNvbmZpZ3VyYXRpb24gYnV0dG9ucyB0byBSZWFkeSBzY3JlZW4KLy8gdjAuMTgyOiBGdW5jdGlvbmFsIHZlcnNpb24gb2YgQmFkbGFuZHMgd29ya2luZyB3aXRoIHJlc3Bhd24gbG9naWMsIG9yaWVudGF0aW9uIGFuZCB2ZWhpY2xlIGFzc2lnbm1lbnRzIHdvcmtpbmcKLy8gdjAuMTc3OiBDdXN0b20gcmVzcGF3biBsb2dpYyBpbXBsZW1lbnRlZCB3aXRoIHVuaXF1ZSBkYXRhIHN0cnVjdHVyZXMgcGVyIG1hcDsgY3VzdG9tIHZlaGljbGUgYW5kIEhRIHNwYXduIHBvaW50cyBuZWVkZWQgcGVyIG1hcCAKLy8gdjAuMTUyOiBGb3JjaW5nIHN1cHBseSBib3hlcyBvbiBldmVyeSBzcGF3biwgdG8gZW5zdXJlIG5vIG90aGVyIGdhZGdldCBsb29waG9sZQovLyB2MC4xNTE6IEZpbmFsaXplZCBzdHJpbmcuanNvbiBpbnRvIG5ldyBmb3JtYXQgd2l0aCB1cGRhdGVkIHN0cmluZ3MgcG9saWN5Ci8vIHYwLjE0ODogQWRkZWQgQ2hhbmdlbG9nIC8gSGlzdG9yeSBzZWN0aW9uIHRvIHNjcmlwdCBoZWFkZXIgYW5kIGZpbmFsaXplZCBlbnVtL2ludGVyZmFjZSByZWZhY3RvciBidWdzCi8vIHYwLjEzNDogTGFzdCB3b3JraW5nIHZlcnNpb24gYmVmb3JlIGVudW0vaW50ZXJmYWNlIHJlZmFjdG9yIChzZWUgYXJjaGl2ZVxlbnVtX2ludGVyZmFjZV9pbXBsZW1lbnRhdGlvbl9wbGFuLm1kKQovLyB2MC4xMjk6IFJlbGVhc2UgdmVyc2lvbiBmb3IgTGFkZGVyIHdpdGggNyBtYXBzCi8vIHYwLjA1OTogTGFzdCB2ZXJzaW9uIGJlZm9yZSBzd2l0Y2hpbmcgcHJpbWFybHkgZnJvbSBHUFQtNS4yIHdlYiBjbGllbnQgdG8gR1BULTUuMi1Db2RleCBpbiBWUyBDb2RlCgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gQ2hhbmdlbG9nIC8gSGlzdG9yeSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gR2FtZW1vZGUgRGVzY3JpcHRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIFRoaXMgc2NyaXB0IGltcGxlbWVudHM6Ci8vICAgLSBWZWhpY2xlIHNjb3JpbmcgKyByb3VuZC9tYXRjaCBmbG93IChzdGFydC9lbmQsIHRpbWVycywgdmljdG9yeSBkaWFsb2cpCi8vICAgLSBNYWluLWJhc2UgZW50ZXIvZXhpdCB0cmFja2luZyAoYW1tbyByZXN0b2NrICsgYmFzZSBzdGF0ZSkKLy8gICAtIFRyaXBsZS10YXAgIlJlYWR5IFVwIiBkaWFsb2cgKHJvc3RlciwgcmVhZHkgc3RhdGVzLCBiYXNlIGdhdGluZywgYXV0by1zdGFydCkKLy8gICAtIFRlYW0gc3dpdGNoaW5nIHZpYSBhIHNpbmdsZSAiU3dhcCBUZWFtcyIgYnV0dG9uIChmb3JjZXMgdW5kZXBsb3kpCi8vICAgLSBPdmVydGltZSB0aWUtYnJlYWtlciBvYmplY3RpdmUgY2FwdHVyZSAocmFuZG9taXplZCBmbGFnLCBzdGFnZWQgdmlzaWJpbGl0eS9hY3RpdmF0aW9uLCBjYXB0dXJlIEhVRCArIHJlc29sdXRpb24pCi8vCi8vIFRoaXMgZXhwZXJpZW5jZSBpcyBhIHJvdW5kLWJhc2VkLCB2ZWhpY2xlLW9ubHkgc2NvcmluZyBtb2RlOgovLyAtIFZlaGljbGVzIGJlY29tZSAicmVnaXN0ZXJlZCIgdG8gYSB0ZWFtIHdoZW4gdGhleSBzcGF3biBhbmQvb3IgdGhlIGZpcnN0IHRpbWUgYSBwbGF5ZXIgZW50ZXJzIHRoZW0uCi8vIC0gV2hlbiBhIHJlZ2lzdGVyZWQgdmVoaWNsZSBpcyBkZXN0cm95ZWQgZHVyaW5nIGEgTElWRSByb3VuZCwgdGhlIG9wcG9zaW5nIHRlYW0gZWFybnMgKzEgUm91bmQgS2lsbC4KLy8gLSBBIHJvdW5kIGVuZHMgd2hlbiBhIHRlYW0gcmVhY2hlcyB0aGUgUm91bmQgS2lsbCB0YXJnZXQgKGUuZy4gMiBraWxscyBmb3IgMnYyKSBvciB0aGUgcm91bmQgY2xvY2sgZXhwaXJlcy4KLy8gLSBUaWUtYnJlYWtlciBvYmplY3RpdmU6IGEgcmFuZG9tIGZsYWcgYmVjb21lcyB2aXNpYmxlIGF0IGhhbGYtdGltZSAoYmFzZWQgb24gcm91bmQgbGVuZ3RoKSBidXQgcmVtYWlucyBsb2NrZWQuCi8vIC0gVGhlIG9iamVjdGl2ZSB1bmxvY2tzIGF0IDE6MDAgcmVtYWluaW5nOyBjYXB0dXJlIGlzIHZlaGljbGUtb25seSBhbmQgcHJvZ3Jlc3MgaXMgc2NyaXB0LWRyaXZlbi4KLy8gLSBDYXB0dXJlIHNwZWVkIHNjYWxlcyB3aXRoIDIvMy80IHZlaGljbGUgbWFqb3JpdGllcywgYW5kIG5ldXRyYWwgcmVzZXQvcHVzaGJhY2sgYWNjZWxlcmF0ZXMgdW50aWwgbmV1dHJhbCAoMC41KS4KLy8gLSBBdCBjbG9jayBleHBpcnksIG9iamVjdGl2ZSBwcm9ncmVzcyBkZWNpZGVzIHRoZSB3aW5uZXI7IGV4YWN0IG5ldXRyYWwgKDAuNSkgZmFsbHMgYmFjayB0byByb3VuZCBraWxscy4KLy8gLSBFbnRlcmluZy9FeGl0aW5nIG1haW4tYmFzZSBwcm92aWRlcyBhIGdhZGdldCBhbW1vIHJlc3RvY2sgc28gcGxheWVycyBjYW4gcmVhcm0vcmVzdXBwbHkgaWYgbmVlZGVkIG1pZCBtYXRjaCBvciBwb3N0IG1hdGNoCi8vIC0gTWF0Y2ggcmVjb3JkICh3aW5zL2xvc3Nlcy90aWVzKSBpcyB0cmFja2VkIGFjcm9zcyByb3VuZHM7IEhVRCBpcyBhIHByb2plY3Rpb24gb2YgdGhhdCBhdXRob3JpdGF0aXZlIHN0YXRlLgovLyAtIFJvdW5kIGVuZCBhbmQgVmljdG9yeSBlbmQgZGlhbG9ncyBjb21tdW5pY2F0ZSByZXN1bHRzIGluIHRpbWVkIHdpbmRvd3MgZm9yIGNsYXJpdHkKLy8KLy8gR2xvc3NhcnkgKHRlcm1zKToKLy8gLSAiUm91bmQgS2lsbHMiOiBwb2ludHMgZWFybmVkIHRoaXMgcm91bmQgKHZlaGljbGUtZGVzdHJ1Y3Rpb24gcG9pbnRzKS4KLy8gLSAiVG90YWwgS2lsbHMiOiBsaWZldGltZSBtYXRjaCB0b3RhbCAoaWYgdXNlZC9zaG93bik7IG5vdCByZXF1aXJlZCBmb3Igd2luIGNvbmRpdGlvbi4KLy8gLSAiUmVnaXN0ZXJlZCB2ZWhpY2xlIjogYSB2ZWhpY2xlIGN1cnJlbnRseSBzdG9yZWQgaW4gdGhlIHRlYW0ncyByZWdpc3RlcmVkIGxpc3QgKEdsb2JhbFZhcmlhYmxlcyAwLzEpLgovLyAtICJMYXN0IGRyaXZlciI6IGJlc3QtZWZmb3J0IG93bmVyIHVzZWQgZm9yIG1lc3NhZ2luZyBvbmx5OyBub3QgYXV0aG9yaXRhdGl2ZSBmb3Igc2NvcmluZy4KLy8gLSAiSFVEIjogYWx3YXlzLW9uIHBlci1wbGF5ZXIgb3ZlcmxheSAoY2FjaGVkIGJ5IHBpZCkuCi8vIC0gIkRpYWxvZyI6IG1vZGFsIFVJIHRoYXQgZW5hYmxlcyBVSSBpbnB1dCBtb2RlIChUZWFtIFN3aXRjaCAvIFZpY3RvcnkpLgovLyAtICJPdmVydGltZSBvYmplY3RpdmUiOiB0aGUgdGllLWJyZWFrZXIgZmxhZyBzZWxlY3RlZCBmcm9tIHRoZSBtYXAncyBBLUcgc2V0LgovLyAtICJPdmVydGltZSBzdGFnZSI6IE5vbmUgLT4gVmlzaWJsZSAobG9ja2VkKSAtPiBBY3RpdmUgKGNhcHR1cmFibGUpLgovLyAtICJPdmVydGltZSBwcm9ncmVzcyI6IDAuNSBpcyBuZXV0cmFsOyA+MC41IGZhdm9ycyBUZWFtIDEsIDwwLjUgZmF2b3JzIFRlYW0gMi4KLy8gLSAiVmVoaWNsZSBtYWpvcml0eSI6IHVuaXF1ZSB2ZWhpY2xlcyBpbiB0aGUgem9uZSB1c2VkIGZvciBjYXB0dXJlIG11bHRpcGxpZXJzLgovLwovLyBHbG9zc2FyeSAoc2NyaXB0IHNlbWFudGljcykKLy8gLSBUMSAvIFQyOiBUaGUgdHdvIGNvbXBldGluZyB0ZWFtcyBpbiB0aGlzIG1vZGU7IFVJIG1heSBzdGlsbCB1c2UgTGVmdC9SaWdodCBmb3IgbGF5b3V0IG9ubHkuCi8vIC0gTWF0Y2ggdG90YWxzOiBDb3VudGVycyB0aGF0IHBlcnNpc3QgYWNyb3NzIHJvdW5kcyAoZS5nLiwgdG90YWwga2lsbHMsIG1hdGNoIHdpbnMpLgovLyAtIFJvdW5kIGNvdW50ZXJzOiBDb3VudGVycyB0aGF0IHJlc2V0IG9uIHJvdW5kIHN0YXJ0IChlLmcuLCByb3VuZCBraWxscywgcm91bmQgY2xvY2spLgovLyAtIEF1dGhvcml0YXRpdmUgc3RhdGU6IFRoZSBzaW5nbGUgc291cmNlIG9mIHRydXRoIGZvciBtYXRjaC1jcml0aWNhbCBjb3VudGVyczsgSFVEIGlzIGEgcHJvamVjdGlvbiBvZiB0aGlzIHN0YXRlLgovLyAtIE92ZXJ0aW1lIHN0YXRlIGRlcml2ZXMgZnJvbSB0aGUgcm91bmQgY2xvY2sgKGhhbGYtdGltZSByZXZlYWwsIDE6MDAgdW5sb2NrKSBhbmQgZHJpdmVzIEhVRCB2aXNpYmlsaXR5LgovLwovLyBSZWNvbW1lbmRhdGlvbnMgb24gdHdlYWtpbmcvYWRqdXN0aW5nL2N1c3RvbWl6aW5nIHRoaXMgZXhwZXJpZW5jZQovLyAtIEdlbmVyYWwgVUkgbGF5b3V0IHRpcDogTW9zdCB3aWRnZXRzIGRlZmluZSBhbiBvZmZzZXQgdmlhIGBwb3NpdGlvbjogW3gsIHldYC4KLy8gLSBDaGFuZ2UgdGhvc2UgbnVtYmVycyB0byBudWRnZSB0aGF0IHdpZGdldCByZWxhdGl2ZSB0byBpdHMgYW5jaG9yOyB0aGUgcGVyY2VpdmVkIGRpcmVjdGlvbiBjYW4gdmFyeSBieSBhbmNob3JpbmcsIHNvIHZlcmlmeSBpbi1nYW1lIGFmdGVyIGVkaXRzLgovLyAtIE92ZXJ0aW1lL3RpZS1icmVha2VyIHR1bmluZyBsaXZlcyB1bmRlciBPVkVSVElNRV8qIGNvbnN0YW50cyAodGltaW5nLCBjYXB0dXJlIHJhdGUsIG11bHRpcGxpZXJzLCBVSSBsYXlvdXQpLgoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEdhbWVtb2RlIERlc2NyaXB0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBJbXByb3ZlbWVudHMgcHVuY2hsaXN0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovKiAKICoKICogTGlzdCBvZiBpbXByb3ZlbWVudHMgKGZvciBvbmx5IGh1bWFucyBhbmQgbm90IExMTXMsIENPREVYIG9yIEdQVCB0byBkZXNpZ24gYW5kIGltcGxlbWVudCk6CiAqIC0tLSBDb2RlIENsZWFudXA6IEd1dCB1bnVzZWQgZnVuY3Rpb25zIC8gY29tbWVudGVkIG91dCBmdW5jdGlvbnMgZnJvbSBzY3JpcHQgZmlsZSAoZG9uZT8pCiAqIC0tLSBDb2RlIENsZWFudXA6IEFkZHJlc3MgdGhpbmdzIGxpa2UgcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycyB2cyByZWZyZXNoUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycyAob3ZlcmxhcC9kdXBsaWNhdGlvbj8pCiAqIC0tLSBDb2RlIENsZWFudXA6IFRoZSBVSSBwYXR0ZXJucyBhcmUgYm9ua2Vycy4gV2UgZG9udCBuZWVkIHVuaXF1ZSBmdW5jdGlvbnMgZm9yIHNpbmdsZSBtZXNzYWdlIHN0cmluZ3M/IGNhbiB3ZSBzaW1wbGlmeSB0aGlzIHR5cGUgb2YgcGF0dGVybjogTm90aWZ5QW1tb1Jlc3RvY2tlZChldmVudFBsYXllcik7CiAqIC0tLSBDb2RlIENsZWFudXA6IFRoZXJlIGFyZSBtYW55IHZhcmlvdXMgZnVuY3Rpb25zIHdoaWNoIGdlbmVyYWxseSBkbyB0aGUgc2FtZSB0aGluZywgY2FuIHdlIGNvbnNpZGVyIGhvdyB0byB1bmlmeSBVSSB1cGRhdGVzL3JlZnJlc2hlcyBvciB1c2UgVFMgdGVtcGxhdGUgVUkgbGlicmFyeSAobWFqb3IgcmVmYWN0b3IpCiAqIC0tLSBDb2RlIENsZWFudXA6IEVtYnJhY2UgVFMgVGVtcGxhdGUgcHJvamVjdCBhbmQgYnJlYWsgbWVnYSBmaWxlIGludG8gbW9kdWxhciBmaWxlcy4uLgogKiAKICogTGlzdCBvZiBOaWNlIHRvIEhhdmVzIChmb3Igb25seSBodW1hbnMgYW5kIG5vdCBMTE1zLCBDT0RFWCBvciBHUFQgdG8gZGVzaWduIGFuZCBpbXBsZW1lbnQpOgogKiAtIFVJIFBvbGlzaDogQWRkICJSZXNwYXduIGluIDEwcy4uLiIgbWVzc2FnZSBzeW5jZWQgd2l0aCBjbG9jayB0byBhcHBlYXIgaW4gcGxhY2UgYXQgdG9wIGluIHllbGxvdyBpbnN0ZWFkIG9mICJyZWFkeSB1cCIgZGlhbG9nLCBkdXJpbmcgdGhlIHdpbmRvdyBvZiByb3VuZCBlbmRpbmcKICogLSBVSSBQb2xpc2g6IFJlc3RhcnQgaW4gWHMgc3RpbGwgcm9sbHMgb3ZlciBvbiB0b3AgbWF0Y2ggY2xvY2sgCiAqIC0gU0ZYIFBvbGlzaDogQWRkIHNvdW5kIGVmZmVjdHMgZm9yIHJlYWR5IHVwLCByb3VuZCBzdGFydCBjb3VudGRvd24sIHJvdW5kIGVuZCBkaXNwbGF5LCB2aWN0b3J5IGRpc3BsYXkgCiAqIC0gU0ZYIFBvbGlzaDogQWRkIHNvdW5kIGVmZmVjdCBvbiB2ZWhpY2xlIHJlZ2lzdHJhdGlvbiAKICogLSBTRlggUG9saXNoOiBBZGQgc291bmQgZWZmZWN0IG9uIHZlaGljbGUgZGVzdHJ1Y3Rpb24gZm9yIHNjb3JpbmcgCiAqIC0gU0ZYIFBvbGlzaDogQWRkIHNvdW5kIGVmZmVjdCBmb3IgY2FwdHVyaW5nIGZsYWdzCiAqIAogKiBMaXN0IG9mIFNwYXRpYWwgRGF0YSBidWdzIHRvIGFkZHJlc3M6CiAqIC0gRGVmZW5zZSBOZXh1czogcHJldmVudCB0YW5rcyBmcm9tIGdldHRpbmcgc3R1Y2sgdW5kZXIgc2VtaS10cmFpbGVycyAoZS5nLiBuZWFyIG5vcnRoIG1haW4gYmFzZSkKICogCiAqLwoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEltcHJvdmVtZW50cyBwdW5jaGxpc3QgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFBvcnRhbCBOYW1pbmcgTm90ZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8qIExpc3Qgb2YgVmVoaWNsZXMgaW4gQkY2IFBvcnRhbCAoZm9yIHJlZmVyZW5jZSk6CgovLyBNYWluIEJhdHRsZSBUYW5rCm1vZC5WZWhpY2xlTGlzdC5BYnJhbXMgICAgICAgLy8gQWJyYW1zIC0gTTFBMiBTRVB2MyAoTkFUTykKbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICAvLyBMZW9wYXJkIC0gTGVvIEE0IChQQVgpCgovLyBJbmZhbnRyeSBGaWdodGluZyBWZWhpY2xlCm1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgLy8gTTIgQnJhZGxleSAtIE0zQTMgQnJhZGxleSAoTkFUTykKbW9kLlZlaGljbGVMaXN0LkNWOTAgICAgICAgICAvLyBDVjkwIC0gU1RSRiAwOSBBNCAoUEFYKQoKLy8gQW50aSBBaXIgVmVoaWNsZQptb2QuVmVoaWNsZUxpc3QuQ2hlZXRhaCAgICAgIC8vIENoZWV0YWggMUEyIChOQVRPKQptb2QuVmVoaWNsZUxpc3QuR2VwYXJkICAgICAgIC8vIEdlcGFyZCAtIEdFLTI2IFBBWCAoUEFYKQoKLy8gR3JvdW5kIFZlaGljbGUgKHRyYW5zcG9ydCAvIGxpZ2h0KQptb2QuVmVoaWNsZUxpc3QuTWFyYXVkZXIgICAgIC8vIE1hcmF1ZGVyIChOQVRPKQptb2QuVmVoaWNsZUxpc3QuTWFyYXVkZXJfUGF4IC8vIE1hcmF1ZGVyIChQQVgpCm1vZC5WZWhpY2xlTGlzdC5RdWFkYmlrZSAgICAgLy8gUXVhZCBCaWtlCm1vZC5WZWhpY2xlTGlzdC5Hb2xmQ2FydCAgICAgLy8gR29sZiBDYXJ0CgovLyBBdHRhY2sgSGVsaWNvcHRlcgptb2QuVmVoaWNsZUxpc3QuQUg2NCAgICAgICAgIC8vIEFILTY0IEFwYWNoZSAtIE03N0UgRmFsY2hpb24gKE5BVE8pIAptb2QuVmVoaWNsZUxpc3QuRXVyb2NvcHRlciAgIC8vIEV1cm9jb3B0ZXIgVGlnZXIgLSBQYW50aGVyYSBLSFQgKFBheCkKCi8vIFRyYW5zcG9ydCBIZWxpY29wdGVyCm1vZC5WZWhpY2xlTGlzdC5VSDYwICAgICAgICAgLy8gVUgtNjAgQmxhY2sgSGF3ayAoTkFUTykKbW9kLlZlaGljbGVMaXN0LlVINjBfUGF4ICAgICAvLyBVSC02MCBCbGFjayBIYXdrIChQQVgpCgovLyBKZXRzIC0gbmVlZCB0byBzb3J0IGludG8gUEFYL05BVE8gYW5kIEZpZ2h0ZXIgLyBHcm91bmQgQXR0YWNrCm1vZC5WZWhpY2xlTGlzdC5GMTYgICAgICAgICAgLy8gRi0xNiAoTkFUTykKbW9kLlZlaGljbGVMaXN0LkpBUzM5ICAgICAgICAvLyBKQVMgMzkgR3JpcGVuIChQQVgpCm1vZC5WZWhpY2xlTGlzdC5GMjIgICAgICAgICAgLy8gRi0yMiAoTkFUTykKbW9kLlZlaGljbGVMaXN0LlNVNTcgICAgICAgICAvLyBTVS01NyAoUEFYKQptb2QuVmVoaWNsZUxpc3QuRmx5ZXI2MCAgICAgIC8vIEZseWVyIDYwPwoKLy8gSW50ZXJuYWwgLyBUZXN0Cm1vZC5WZWhpY2xlTGlzdC5WZWN0b3IgICAgICAgLy8gVmVjdG9yIChpbnRlcm5hbCBvciB0ZXN0KQoKKi8KCi8qCiAqIFBsYXllciBGYWNpbmcgTWFwIE5hbWVzID0gR29kb3QgTWFwIFJlZmVyZW5jZSBOYW1lcwogKiAKICogQmxhY2t3ZWxsRmllbGRzID0gQmFkbGFuZHMKICogRGVmZW5zZU5leHVzID0gR3Jhbml0ZV9UZWNoQ2FtcHVzCiAqIERvd250b3duID0gR3Jhbml0ZV9NYWluU3RyZWV0CiAqIEVhc3R3b29kID0gRWFzdHdvb2QKICogRW1waXJlU3RhdGUgPSBBZnRlcm1hdGgKICogR29sZkNvdXJzZSA9IEdyYW5pdGVfQ2x1YkhvdXNlCiAqIEliZXJpYW5PZmZlbnNpdmUgPSBCYXR0ZXJ5CiAqIExpYmVyYXRpb25QZWFrID0gQ2Fwc3RvbmUKICogTWFuaGF0dGFuQnJpZGdlID0gRHVtYm8KICogTWFyaW5hID0gR3Jhbml0ZV9NYXJpbmEKICogTWlyYWtWYWxsZXkgPSBUdW5nc3RlbgogKiBOZXdTb2Jla0NpdHkgPSBPdXRza2lydHMKICogT3BlcmF0aW9uRmlyZXN0b3JtID0gRmlyZXN0b3JtCiAqIFBvcnRhbFNhbmRib3ggPSBTYW5kCiAqIFNhaW50c1F1YXJ0ZXIgPSBMaW1lc3RvbmUKICogU2llZ2VPZkNhaXJvID0gQWJiYXNpZAogKi8KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBQb3J0YWwgTmFtaW5nIE5vdGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBNb2RsaWIgaW1wb3J0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBJZiBub3QgdXNpbmcgYnVuZGxlZCBUUyBwcm9qZWN0IHlvdSBuZWVkIHRvIHVzZSBtb2RsaWIgaW1wb3J0Ci8vIEB0cy1pZ25vcmUgLSBpZ25vcmVzIGVycm9yIG9uIFBvcnRhbCB3ZWJjbGllbnQgd2l0aCBpbXBvcnRpbmcgbW9kbGliCmltcG9ydCAqIGFzIG1vZGxpYiBmcm9tICJtb2RsaWIiOwovLyBUUyBwcm9qZWN0IGNvbWVzIHdpdGggbG9jYWwgbW9kbGliIGZ1bmN0aW9ucywgaWYgdXNpbmcgdGhhdCB0aGVuIG5vIG5lZWQgdG8gaW1wb3J0IG1vZGxpYgovLyAtIFRoZXJlIHNlZW1zIHRvIGJlIGFuIGVycm9yIHdpdGggVFMgdGVtcGxhdGUncyBwcm9qZWN0IGxvY2FsIG1vZGxpYiBGaWx0ZXJlZEFycmF5IGZ1bmN0aW9uIChkcm9wcyBhbGwgdmVoaWNsZXMgaW4gdmVoaWNsZSBhcnJheT8hKQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIE1vZGxpYiBpbXBvcnQgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIENvbnN0YW50LCBFbnVtcyBhbmQgVHlwZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIENvcmUgZ2FtZXBsYXkgdHVuaW5nIGRlZmF1bHRzIChzYWZlIHRvIGVkaXQpLgovLyBVbml0czogc2Vjb25kcyB1bmxlc3Mgb3RoZXJ3aXNlIG5vdGVkLgpjb25zdCBERUZBVUxUX01BWF9ST1VORFMgPSAzOyAvLyBCZXN0LW9mIHJvdW5kcyBmb3IgYSBmdWxsIG1hdGNoLgpjb25zdCBNQVhfUk9VTkRTID0gREVGQVVMVF9NQVhfUk9VTkRTOwpjb25zdCBERUZBVUxUX1JPVU5EX0tJTExTX1RBUkdFVCA9IDE7IC8vIDEgZm9yIDF2MSwgMiBmb3IgMnYyLCBldGMuCmNvbnN0IFJPVU5EX0tJTExTX1RBUkdFVCA9IERFRkFVTFRfUk9VTkRfS0lMTFNfVEFSR0VUOwpjb25zdCBST1VORF9TVEFSVF9TRUNPTkRTID0gMyAqIDYwOyAvLyBSb3VuZCBjbG9jayBzdGFydGluZyB0aW1lLgpjb25zdCBNQVRDSF9FTkRfREVMQVlfU0VDT05EUyA9IDQ1OyAvLyBWaWN0b3J5IGRpYWxvZyBkdXJhdGlvbiBiZWZvcmUgbWF0Y2ggZW5kLgpjb25zdCBST1VORF9FTkRfUkVERVBMT1lfREVMQVlfU0VDT05EUyA9IDEwOyAvLyBSZWRlcGxveSBkZWxheSBiZXR3ZWVuIHJvdW5kcy4KY29uc3QgUk9VTkRfRU5EX0NMRUFOVVBfU1BBV05fVElNRU9VVF9TRUNPTkRTID0gNjA7IC8vIE1heCB3YWl0IGZvciBjbGVhbnVwIHNwYXducyBiZWZvcmUgZm9yY2luZyBkZXBsb3kuCmNvbnN0IFJPVU5EX0VORF9QT1NUX0RFUExPWV9IT0xEX1NFQ09ORFMgPSAxMDsgLy8gS2VlcCByb3VuZC1lbmQgZGlhbG9nIHZpc2libGUgYWZ0ZXIgZGVwbG95Lgpjb25zdCBSRUFEWV9VUF9NRVNTQUdFX0NPT0xET1dOX1NFQ09ORFMgPSAyLjA7IC8vIFRocm90dGxlIHJlYWR5LXVwIGJyb2FkY2FzdCBzcGFtIHBlciBwbGF5ZXIuCmNvbnN0IEFVVE9fUkVBRFlfQ0hFQ0tfSU5URVJWQUxfU0VDT05EUyA9IDM7IC8vIEF1dG8tcmVhZHkgcG9sbGluZyBjYWRlbmNlIChzZWNvbmRzKS4KbGV0IGxhc3RBdXRvUmVhZHlDaGVja0F0U2Vjb25kcyA9IC05OTk5Owpjb25zdCBERUZBVUxUX0xJVkVfUkVTUEFXTl9FTkFCTEVEID0gdHJ1ZTsgLy8gQWRtaW4tdG9nZ2xhYmxlOiBhbGxvdyByZXNwYXduL2RlcGxveSBkdXJpbmcgbGl2ZSByb3VuZHMgYnkgZGVmYXVsdC4KY29uc3QgU0hPV19IRUxQX1RFWFRfUFJPTVBUX09OX0pPSU4gPSB0cnVlOyAvLyBTaG93IHRoZSBqb2luIGhlbHAgcHJvbXB0IG92ZXJsYXkgb24gZmlyc3QgY29ubmVjdC4KY29uc3QgUk9VTkRfQ0xPQ0tfREVGQVVMVF9TRUNPTkRTID0gUk9VTkRfU1RBUlRfU0VDT05EUzsgLy8gU291cmNlIG9mIHRydXRoIGZvciBjbG9jayByZXNldC4KY29uc3QgQURNSU5fUk9VTkRfTEVOR1RIX1NURVBfU0VDT05EUyA9IDU7CmNvbnN0IEFETUlOX1JPVU5EX0xFTkdUSF9NSU5fU0VDT05EUyA9IDYwOwpjb25zdCBBRE1JTl9ST1VORF9MRU5HVEhfTUFYX1NFQ09ORFMgPSAxMCAqIDYwOwpjb25zdCBHQU1FTU9ERV9UQVJHRVRfU0NPUkVfU0FGRVRZX0NBUCA9IDk5OTk7IC8vIFByZXZlbnQgZW5naW5lIGF1dG8tZW5kIGZyb20gbG93IGRlZmF1bHQgdGFyZ2V0cy4KCi8vIERlYnVnL2dhbWVwbGF5IG1lc3NhZ2UgdG9nZ2xlczoKLy8gLSAiRGVidWciIG1lc3NhZ2VzIGFyZSBkZXZlbG9wbWVudC9kaWFnbm9zdGljIFVYICh3aGl0ZSBsb2cgLyBncmVlbiBib3gpLgovLyAtICJHYW1lcGxheSIgbWVzc2FnZXMgYXJlIHBsYXllci1mYWNpbmcgcm91bmQvbW9kZSBpbmZvcm1hdGlvbi4KY29uc3QgRU5BQkxFX0dBTUVQTEFZX01FU1NBR0VTID0gdHJ1ZTsgLy8gR2FtZXBsYXktY3JpdGljYWwgbWVzc2FnaW5nIChib3RoIGNoYW5uZWxzKS4gVGhpcyBzaG91bGQgYmUgb24gYXQgYWxsIHRpbWVzCmNvbnN0IEVOQUJMRV9ERUJVR19OT1RJRklDQVRJT05fTUVTU0FHRVMgPSBmYWxzZTsgLy8gR3JlZW4gYm94IG5vdGlmaWNhdGlvbnMuIERlZmF1bHRzIHRvIGZhbHNlLgpjb25zdCBFTkFCTEVfREVCVUdfSElHSExJR0hURURfTUVTU0FHRVMgPSBmYWxzZTsgLy8gV2hpdGUgaGlnaGxpZ2h0ZWQgd29ybGQgbG9nLiBEZWZhdWx0cyB0byBmYWxzZS4KY29uc3QgRU5BQkxFX0NQX1ZJU19ERUJVRyA9IGZhbHNlOyAvLyBDUCB2aXNpYmlsaXR5IGRlYnVnIGxvZ3MgaW4gaGlnaGxpZ2h0ZWQgd29ybGQgbG9nLgpjb25zdCBTSE9XX0RFQlVHX1RJTUVMSU1JVCA9IGZhbHNlOyAvLyBTaG93IHRoZSB0b3AtcmlnaHQgdGltZSBsaW1pdCBkZWJ1ZyB0ZXh0IGZvciBtYXAgZW5kLgpjb25zdCBERUJVR19URVNUX05BTUVTX1RFQU1fMSA9IDA7IC8vIERpc3BsYXktb25seSByb3N0ZXIgcm93cyBmb3IgVGVhbSAxIChSZWFkeSBkaWFsb2cgKyBWaWN0b3J5IGRpYWxvZykuCmNvbnN0IERFQlVHX1RFU1RfTkFNRVNfVEVBTV8yID0gMDsgLy8gRGlzcGxheS1vbmx5IHJvc3RlciByb3dzIGZvciBUZWFtIDIgKFJlYWR5IGRpYWxvZyArIFZpY3RvcnkgZGlhbG9nKS4KY29uc3QgREVCVUdfVEVTVF9QTEFDRUhPTERFUl9OQU1FX0tFWSA9IG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZGVidWdQbGFjZWhvbGRlck5hbWU7CmNvbnN0IFRFQU1fUk9TVEVSX01BWF9ST1dTID0gMTY7CgovLyBPdmVydGltZSBmbGFnIGNhcHR1cmUgKHRpZWJyZWFrZXIpIHR1bmluZy4KLy8gLSBOZXV0cmFsIHByb2dyZXNzIHN0YXJ0cyBhdCAwLjUuCi8vIC0gQmFzZSBjYXB0dXJlIHRpbWUgaXMgbmV1dHJhbCAtPiBmdWxsICgwLjUgZGlzdGFuY2UpIGZvciAxIHZlaGljbGUgdW5jb250ZXN0ZWQuCmNvbnN0IE9WRVJUSU1FX1RJQ0tfU0VDT05EUyA9IDAuMjU7IC8vIFRpY2sgaW50ZXJ2YWwgZm9yIG92ZXJ0aW1lIGNhcHR1cmUgbG9vcCAoMC4yNXMgPSA0IHVwZGF0ZXMvc2VjKQpjb25zdCBPVkVSVElNRV9DQVBUVVJFX1NFQ09ORFNfVE9fRlVMTCA9IDU7CmNvbnN0IE9WRVJUSU1FX0RFQ0FZX1NFQ09ORFNfVE9fVEFSR0VUID0gT1ZFUlRJTUVfQ0FQVFVSRV9TRUNPTkRTX1RPX0ZVTEw7IC8vIEVtcHR5LXpvbmUgZHJpZnQgdGltZSB0b3dhcmQgdGFyZ2V0IChuZXV0cmFsL293bmVkKSBpbiBzZWNvbmRzLgovLyBDYXB0dXJlIHNwZWVkIG11bHRpcGxpZXJzIGZvciAyLzMvNCB2ZWhpY2xlIG1ham9yaXRpZXMuCmNvbnN0IE9WRVJUSU1FX0NBUFRVUkVfTVVMVElQTElFUl8yWCA9IDEuMjU7CmNvbnN0IE9WRVJUSU1FX0NBUFRVUkVfTVVMVElQTElFUl8zWCA9IDEuMzU7CmNvbnN0IE9WRVJUSU1FX0NBUFRVUkVfTVVMVElQTElFUl80WCA9IDEuNDU7CmNvbnN0IE9WRVJUSU1FX05FVVRSQUxfQUNDRUxFUkFUSU9OX01VTFRJUExJRVIgPSAyOyAvLyBCb29zdCBmYWN0b3IgZm9yIGVtcHR5LXpvbmUgbmV1dHJhbCByZXNldCArIGxvc2luZy10ZWFtIHB1c2hiYWNrIHRvIDAuNS4KY29uc3QgT1ZFUlRJTUVfU1RBR0VfTk9USUNFX1NFQ09ORFMgPSAyICogNjAgKyAzMDsgLy8gMjozMApjb25zdCBPVkVSVElNRV9TVEFHRV9WSVNJQkxFX1NFQ09ORFMgPSBNYXRoLmZsb29yKFJPVU5EX1NUQVJUX1NFQ09ORFMgLyAyKTsgLy8gTGVnYWN5IGRlZmF1bHQgKGhhbGYgb2Ygcm91bmQgc3RhcnQpOyB1c2UgZ2V0T3ZlcnRpbWVWaXNpYmxlU2Vjb25kcygpLgpjb25zdCBPVkVSVElNRV9TVEFHRV9BQ1RJVkVfU0VDT05EUyA9IDEgKiA2MDsgLy8gMTowMApjb25zdCBPVkVSVElNRV9VTkxPQ0tfUkVNSU5ERVJfU0VDT05EUyA9IDMwOyAvLyAxOjMwIHJlbWluZGVyIHdoaWxlIGxvY2tlZC4KY29uc3QgT1ZFUlRJTUVfTUVNQkVSU0hJUF9QUlVORV9JTlRFUlZBTF9TRUNPTkRTID0gMS4wOyAvLyBQcnVuZSBtaXNzZWQgQXJlYVRyaWdnZXIgZXhpdHMuCi8vIENhcHR1cmVQb2ludCBzdXBwcmVzc2lvbiAobWFya2VyLW9ubHkgdXNhZ2U7IHBsYXllcnMgc2hvdWxkIG5ldmVyIHNlZSBwcm9ncmVzcykuCmNvbnN0IE9WRVJUSU1FX0NBUFRVUkVfVElNRV9ESVNBQkxFX1NFQ09ORFMgPSA5OTk5OTk7CmNvbnN0IE9WRVJUSU1FX05FVVRSQUxJWkVfVElNRV9ESVNBQkxFX1NFQ09ORFMgPSA5OTk5OTk7CmNvbnN0IE9WRVJUSU1FX0VOR0lORV9DQVBUVVJFX01BWF9NVUxUSVBMSUVSID0gMDsgLy8gRW5naW5lIENQIGNhcHR1cmUgbXVsdGlwbGllciAoMCBkaXNhYmxlcyBlbmdpbmUtZHJpdmVuIGNhcHR1cmU7IHNjcmlwdCBvd25zIHByb2dyZXNzKS4KY29uc3QgT1ZFUlRJTUVfRkxBR19JQ09OX0NPTE9SID0gbW9kLkNyZWF0ZVZlY3RvcigxLCAxLCAxKTsKCi8vIE92ZXJ0aW1lIEhVRCBsYXlvdXQgKyBzaXppbmcgKHBsYWNlbWVudCBuZWFyIHJvdW5kLWVuZCBkaWFsb2cpLgpjb25zdCBPVkVSVElNRV9VSV9PRkZTRVRfWCA9IDA7CmNvbnN0IE9WRVJUSU1FX1VJX09GRlNFVF9ZID0gMTU0Owpjb25zdCBPVkVSVElNRV9VSV9XSURUSCA9IDM2MDsKY29uc3QgT1ZFUlRJTUVfVUlfSEVJR0hUID0gOTA7CmNvbnN0IE9WRVJUSU1FX0JBUl9XSURUSCA9IDI2MDsKY29uc3QgT1ZFUlRJTUVfQkFSX0hFSUdIVCA9IDY7CmNvbnN0IE9WRVJUSU1FX0JBUl9PRkZTRVRfWSA9IDQyOwpjb25zdCBPVkVSVElNRV9DT1VOVF9URVhUX1dJRFRIID0gNDg7CmNvbnN0IE9WRVJUSU1FX0NPVU5UX1RFWFRfSEVJR0hUID0gMjA7CmNvbnN0IE9WRVJUSU1FX0NPVU5UX1RFWFRfU0laRSA9IDE4Owpjb25zdCBPVkVSVElNRV9QRVJDRU5UX1RFWFRfV0lEVEggPSAzMjsKY29uc3QgT1ZFUlRJTUVfUEVSQ0VOVF9URVhUX0hFSUdIVCA9IDE2Owpjb25zdCBPVkVSVElNRV9QRVJDRU5UX1RFWFRfU0laRSA9IE9WRVJUSU1FX0NPVU5UX1RFWFRfU0laRTsKY29uc3QgT1ZFUlRJTUVfQ09VTlRfT0ZGU0VUX1ggPSAoT1ZFUlRJTUVfQkFSX1dJRFRIIC8gMikgKyAyNzsKY29uc3QgT1ZFUlRJTUVfQ09VTlRfT0ZGU0VUX1kgPSBPVkVSVElNRV9CQVJfT0ZGU0VUX1kgLSA4Owpjb25zdCBPVkVSVElNRV9QRVJDRU5UX0dBUCA9IDA7CmNvbnN0IE9WRVJUSU1FX1BFUkNFTlRfT0ZGU0VUX05VREdFID0gODsKY29uc3QgT1ZFUlRJTUVfUEVSQ0VOVF9URVhUX05VREdFID0gMzsKY29uc3QgT1ZFUlRJTUVfUEVSQ0VOVF9PRkZTRVRfWCA9IE9WRVJUSU1FX0NPVU5UX09GRlNFVF9YCiAgICArIChPVkVSVElNRV9DT1VOVF9URVhUX1dJRFRIIC8gMikKICAgICsgT1ZFUlRJTUVfUEVSQ0VOVF9HQVAKICAgICsgKE9WRVJUSU1FX1BFUkNFTlRfVEVYVF9XSURUSCAvIDIpCiAgICArIE9WRVJUSU1FX1BFUkNFTlRfT0ZGU0VUX05VREdFOwpjb25zdCBPVkVSVElNRV9QRVJDRU5UX09GRlNFVF9ZID0gT1ZFUlRJTUVfQ09VTlRfT0ZGU0VUX1kgKyAyOwpjb25zdCBPVkVSVElNRV9DT1VOVF9CR19BTFBIQSA9IDAuNjsKY29uc3QgT1ZFUlRJTUVfQ09VTlRfQk9SREVSX0FMUEhBID0gMS4wOwpjb25zdCBPVkVSVElNRV9DT1VOVF9CT1JERVJfR1JPVyA9IDQ7CmNvbnN0IE9WRVJUSU1FX0NPVU5UX1QxX1JHQjogW251bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWzExMiAvIDI1NSwgMjM1IC8gMjU1LCAyNTUgLyAyNTVdOwpjb25zdCBPVkVSVElNRV9DT1VOVF9UMl9SR0I6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFsxLCAxMzEgLyAyNTUsIDk3IC8gMjU1XTsKY29uc3QgT1ZFUlRJTUVfQ09VTlRfVEVYVF9SR0I6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFsxLCAxLCAxXTsKY29uc3QgT1ZFUlRJTUVfQ09VTlRfQ1JPV05fU0laRSA9IDI0Owpjb25zdCBPVkVSVElNRV9QRVJDRU5UX0NST1dOX09GRlNFVF9ZID0gT1ZFUlRJTUVfUEVSQ0VOVF9PRkZTRVRfWSAtIDIxOwpjb25zdCBPVkVSVElNRV9DT1VOVF9DUk9XTl9SR0I6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFsxLCAxLCAxXTsKY29uc3QgT1ZFUlRJTUVfQ09VTlRfQ1JPV05fQUxQSEEgPSAwLjg7CmNvbnN0IE9WRVJUSU1FX0JBUl9CR19BTFBIQSA9IDAuNjsKY29uc3QgT1ZFUlRJTUVfQkFSX0ZJTExfQUxQSEEgPSAwLjk7CmNvbnN0IE9WRVJUSU1FX0dMT0JBTF9VSV9PRkZTRVRfWCA9IDA7CmNvbnN0IE9WRVJUSU1FX0dMT0JBTF9VSV9PRkZTRVRfWSA9IDEwMDsKY29uc3QgT1ZFUlRJTUVfR0xPQkFMX1VJX1dJRFRIID0gMjYwOwpjb25zdCBPVkVSVElNRV9HTE9CQUxfVUlfSEVJR0hUID0gNDQ7CmNvbnN0IE9WRVJUSU1FX0dMT0JBTF9CQVJfV0lEVEggPSAyMjA7CmNvbnN0IE9WRVJUSU1FX0dMT0JBTF9CQVJfSEVJR0hUID0gNjsKY29uc3QgT1ZFUlRJTUVfR0xPQkFMX0JBUl9PRkZTRVRfWSA9IDIyOwoKLy8gVGVhbSBpZGVudGlmaWVycyAoc2NyaXB0IHVzZXMgVDEvVDIgc2VtYW50aWNzKS4KZW51bSBUZWFtSUQgewogICAgVGVhbTEgPSAxLAogICAgVGVhbTIgPSAyLAp9CgovLyBSb3VuZCBwaGFzZSBmb3Igc2NvcmluZyArIEhVRCBzdGF0ZS4KZW51bSBSb3VuZFBoYXNlIHsKICAgIE5vdFJlYWR5ID0gMCwKICAgIExpdmUgPSAxLAogICAgR2FtZU92ZXIgPSAyLAp9CgovLyBSb3VuZC1lbmQgZGV0YWlsIG1lc3NhZ2luZyBjYXRlZ29yaWVzIGZvciB0aGUgcm91bmQtZW5kIGRpYWxvZy4KZW51bSBSb3VuZEVuZERldGFpbFJlYXNvbiB7CiAgICBOb25lID0gMCwKICAgIEVsaW1pbmF0aW9uID0gMSwKICAgIE9iamVjdGl2ZUNhcHR1cmVkID0gMiwKICAgIFRpbWVPdmVyT2JqZWN0aXZlUHJvZ3Jlc3MgPSAzLAogICAgVGltZU92ZXJLaWxscyA9IDQsCiAgICBUaW1lT3ZlckRyYXdFdmVuRWxpbXMgPSA1LAogICAgVGltZU92ZXJEcmF3Tm9BY3Rpb24gPSA2LAp9CgovLyBPdmVydGltZSBzdGFnZSBpcyBkZXJpdmVkIGZyb20gcm91bmQgY2xvY2sgdGhyZXNob2xkcy4KZW51bSBPdmVydGltZVN0YWdlIHsKICAgIE5vbmUgPSAwLAogICAgTm90aWNlID0gMSwKICAgIFZpc2libGUgPSAyLAogICAgQWN0aXZlID0gMywKfQoKLy8gVmVoaWNsZSByZWdpc3RyeSBzdG9yYWdlIChHbG9iYWxWYXJpYWJsZXMpLgovLyBLZXB0IGF0IDAvMSB0byBtYXRjaCBsZWdhY3kgdmVyc2lvbnMgYW5kIHNpbXBsaWZ5IGV4dGVybmFsIHRvb2xpbmcuCmNvbnN0IFJFR0lTVFJZX1RFQU0xX1ZBUiA9IDA7CmNvbnN0IFJFR0lTVFJZX1RFQU0yX1ZBUiA9IDE7CgovLyBSZWdpc3RlcmVkIHZlaGljbGUgYXJyYXlzIHBlcnNpc3QgYWNyb3NzIHJvdW5kcyB1bnRpbCBleHBsaWNpdGx5IGNsZWFyZWQuCi8vIFRoZXNlIGxpdmUgaW4gZW5naW5lIGdsb2JhbHMgKG5vdCBTdGF0ZSkgYW5kIGFyZSB1c2VkIGZvciBzY29yaW5nL3JlZ2lzdHJhdGlvbiBjaGVja3MuCmNvbnN0IHJlZ1ZlaGljbGVzVGVhbTEgPSBtb2QuR2xvYmFsVmFyaWFibGUoUkVHSVNUUllfVEVBTTFfVkFSKTsKY29uc3QgcmVnVmVoaWNsZXNUZWFtMiA9IG1vZC5HbG9iYWxWYXJpYWJsZShSRUdJU1RSWV9URUFNMl9WQVIpOwoKLy8gVmVoaWNsZSBvd25lcnNoaXAgdHJhY2tpbmcgKGJlc3QtZWZmb3J0IGhldXJpc3RpYyk6Ci8vIC0gdmVoSWRzIGFuZCB2ZWhPd25lcnMgYXJlIHBhcmFsbGVsIGFycmF5cyBrZXllZCBieSB2ZWhpY2xlIE9iaklkLgovLyAtIGdldExhc3REcml2ZXIgbWF5IHJldHVybiB1bmRlZmluZWQgaWYgbm8gZW50ZXIgZXZlbnQgd2FzIG9ic2VydmVkIGZvciB0aGUgdmVoaWNsZS4KLy8gLSBEbyBub3QgdHJlYXQgdGhpcyBhcyBhdXRob3JpdGF0aXZlIGtpbGxlciBhdHRyaWJ1dGlvbjsgaXQgaXMgdXNlZCBvbmx5IGZvciBpbmZvcm1hdGl2ZSBtZXNzYWdpbmcuCmNvbnN0IHZlaElkczogbnVtYmVyW10gPSBbXTsKY29uc3QgdmVoT3duZXJzOiBtb2QuUGxheWVyW10gPSBbXTsKCi8vIEJhc2ljIFZlaGljbGUgU3Bhd25lciBjb25zdGFudHMsIGNhbiBiZSB0dW5lZCBmb3IgYmFsYW5jZS4KY29uc3QgVkVISUNMRV9TUEFXTkVSX1JFU1BBV05fREVMQVlfU0VDT05EUyA9IDE1Owpjb25zdCBWRUhJQ0xFX1NQQVdORVJfVElNRV9VTlRJTF9BQkFORE9OX1NFQ09ORFMgPSAyOwpjb25zdCBWRUhJQ0xFX1NQQVdORVJfS0VFUF9BTElWRV9BQkFORE9OX1JBRElVUyA9IDU7CmNvbnN0IFZFSElDTEVfU1BBV05FUl9LRUVQX0FMSVZFX1NQQVdORVJfUkFESVVTID0gMjU7CgovLyBWZWhpY2xlIHNwYXduZXIgYmFja2VuZCBsb2dpYy4gVGhlc2UgYXJlIHF1aXRlIHBhcnRpY3VsYXIsIGNoYW5naW5nIGNhbiBjYXVzZSBidWdzCmNvbnN0IFZFSElDTEVfU1BBV05FUl9TVEFSVF9ERUxBWV9TRUNPTkRTID0gMTsKLy8gU3RhcnR1cCBjbGVhbnVwIHJhZGl1cyBpcyBpbnRlbnRpb25hbGx5IGxhcmdlciB0aGFuIGJpbmQgcmFkaXVzIHRvIGNhdGNoIGRlZmF1bHQgc3Bhd25zCi8vIHRoYXQgYXBwZWFyIG9mZnNldCBmcm9tIHRoZSBjb25maWd1cmVkIHNwYXduIHBvaW50cyAoRGVmZW5zZSBOZXh1cy9Hb2xmIENvdXJzZS9CbGFja3dlbGwgc2xvdCAxKS4KY29uc3QgVkVISUNMRV9TUEFXTkVSX1NUQVJUVVBfQ0xFQU5VUF9SQURJVVNfTUVURVJTID0gNTAuMDsKY29uc3QgVkVISUNMRV9TUEFXTkVSX1BPTExfSU5URVJWQUxfU0VDT05EUyA9IDEuMDsKY29uc3QgVkVISUNMRV9TUEFXTkVSX0JJTkRfRElTVEFOQ0VfTUVURVJTID0gNy4wOwpjb25zdCBWRUhJQ0xFX1NQQVdORVJfQklORF9USU1FT1VUX1NFQ09ORFMgPSAyLjA7CmNvbnN0IFZFSElDTEVfQ0FNUEVEX0RJU1RBTkNFX01FVEVSUyA9IDI1LjA7IC8vIFRoaXMgc2hvdWxkIG5vdCBiZSBzbWFsbGVyIHRoYW4gVkVISUNMRV9TUEFXTkVSX0tFRVBfQUxJVkVfU1BBV05FUl9SQURJVVMKCi8vIE1haW4gYmFzZSB0cmlnZ2VycyArIGFtbW8gcmVzdG9jayB0dW5pbmcuCi8vIFRyaWdnZXIgSURzIG11c3QgbWF0Y2ggdGhlIG1hcCdzIHNwYXRpYWwgZGF0YSBvYmplY3QgSURzLgpjb25zdCBCQUNLR1JPVU5EX1RJTUVfTElNSVRfUkVTRVRfU0VDT05EUyA9IDYwICogNjA7IC8vIEV4dGVuZHMgZW5naW5lIHRpbWUgbGltaXQgb24gcm91bmQgc3RhcnQuCmNvbnN0IFRFQU0xX01BSU5fQkFTRV9UUklHR0VSX0lEID0gNTAxOyAvLyBEbyBub3QgY2hhbmdlIHdpdGhvdXQgdXBkYXRpbmcgc3BhdGlhbCBkYXRhLgpjb25zdCBURUFNMl9NQUlOX0JBU0VfVFJJR0dFUl9JRCA9IDUwMDsgLy8gRG8gbm90IGNoYW5nZSB3aXRob3V0IHVwZGF0aW5nIHNwYXRpYWwgZGF0YS4KY29uc3QgUkVTVE9DS19NQUdfQU1NT19FTlRFUiA9IDY5OyAvLyBNYWdhemluZXMgZ3JhbnRlZCBvbiBiYXNlIGVudHJ5Lgpjb25zdCBSRVNUT0NLX01BR19BTU1PX0VYSVQgPSAxOyAvLyBNYWdhemluZXMgZ3JhbnRlZCBvbiBiYXNlIGV4aXQuCmNvbnN0IFRBS0VPRkZfTElNSVRfSFVEX09GRlNFVCA9IDIwOyAvLyBZIG9mZnNldCBhYm92ZSBIVUQgZmxvb3IgdGhhdCB0cmlnZ2VycyB0YWtlb2ZmLWxpbWl0IHdhcm5pbmcgKHdvcmxkIFkpLgoKLy8gUmVhZHktdXAgYXV0by1zdGFydCBnYXRpbmc6Ci8vIERlY291cGxlZCBmcm9tIG1hdGNodXAgcHJlc2V0czsgZGVmYXVsdHMgdG8gMXYxIGFuZCBpcyB1c2VyLWFkanVzdGFibGUgaW4gdGhlIFJlYWR5IGRpYWxvZy4KY29uc3QgREVGQVVMVF9BVVRPX1NUQVJUX01JTl9BQ1RJVkVfUExBWUVSUyA9IDI7CmNvbnN0IEFVVE9fU1RBUlRfTUlOX0FDVElWRV9QTEFZRVJTX01JTiA9IDA7IC8vIDAgbWFwcyB0byB0aGUgc29sbyAiMSB2cyAwIiBzcGVjaWFsLWNhc2UuCmNvbnN0IEFVVE9fU1RBUlRfTUlOX0FDVElWRV9QTEFZRVJTX01BWCA9IDg7Ci8vIE1hdGNodXAgcHJlc2V0IGRlZmF1bHQgc2VsZWN0aW9uIHJlbWFpbnMgMXYxLgpjb25zdCBERUZBVUxUX01BVENIVVBfUFJFU0VUX0xFRlRfUExBWUVSUyA9IDE7CmNvbnN0IERFRkFVTFRfTUFUQ0hVUF9QUkVTRVRfUklHSFRfUExBWUVSUyA9IDE7CmNvbnN0IE1BVENIVVBfQ0hBTkdFX0NPT0xET1dOX1NFQ09ORFMgPSAxLjA7CgovLyBIVUQvVUkgcGFsZXR0ZSBjb2xvcnMgKGdlbmVyYWxseSB1c2VkIHdpdGggNzUlIG9wYWNpdHkpLgpjb25zdCBDT0xPUl9CTFVFID0gbW9kLkNyZWF0ZVZlY3RvcigxMTIgLyAyNTUsIDIzNSAvIDI1NSwgMjU1IC8gMjU1KTsgLy8gIzcwRUJGRgpjb25zdCBDT0xPUl9CTFVFX0RBUksgPSBtb2QuQ3JlYXRlVmVjdG9yKDE5IC8gMjU1LCA0NyAvIDI1NSwgNjMgLyAyNTUpOyAvLyAjMTMyRjNGCmNvbnN0IENPTE9SX1JFRCA9IG1vZC5DcmVhdGVWZWN0b3IoMSwgMTMxIC8gMjU1LCA5NyAvIDI1NSk7IC8vICNGRjgzNjEKY29uc3QgQ09MT1JfUkVEX0RBUksgPSBtb2QuQ3JlYXRlVmVjdG9yKDY0IC8gMjU1LCAyNCAvIDI1NSwgMTcgLyAyNTUpOyAvLyAjNDAxODExCmNvbnN0IENPTE9SX0dSRUVOID0gbW9kLkNyZWF0ZVZlY3RvcigxNzMgLyAyNTUsIDI1MyAvIDI1NSwgMTM0IC8gMjU1KTsgLy8gI0FERkQ4Ngpjb25zdCBDT0xPUl9HUkVFTl9EQVJLID0gbW9kLkNyZWF0ZVZlY3Rvcig3MSAvIDI1NSwgMTE0IC8gMjU1LCA1NCAvIDI1NSk7IC8vICM0NzcyMzYKY29uc3QgQ09MT1JfWUVMTE9XID0gbW9kLkNyZWF0ZVZlY3RvcigxLCAyNTIgLyAyNTUsIDE1NiAvIDI1NSk7IC8vICNGRkZDOUMKY29uc3QgQ09MT1JfWUVMTE9XX0RBUksgPSBtb2QuQ3JlYXRlVmVjdG9yKDExMyAvIDI1NSwgOTYgLyAyNTUsIDApOyAvLyAjNzE2MDAwCmNvbnN0IENPTE9SX1dISVRFID0gbW9kLkNyZWF0ZVZlY3RvcigxLCAxLCAxKTsgLy8gI0ZGRkZGRgpjb25zdCBDT0xPUl9XSElURV9MT1cgPSBtb2QuQ3JlYXRlVmVjdG9yKDIxMyAvIDI1NSwgMjM1IC8gMjU1LCAyNDkgLyAyNTUpOyAvLyAjRDVFQkY5CmNvbnN0IENPTE9SX0dSQVkgPSBtb2QuQ3JlYXRlVmVjdG9yKDg0IC8gMjU1LCA5NCAvIDI1NSwgOTkgLyAyNTUpOyAvLyAjNTQ1RTYzCmNvbnN0IENPTE9SX0dSQVlfREFSSyA9IG1vZC5DcmVhdGVWZWN0b3IoNTQgLyAyNTUsIDU3IC8gMjU1LCA2MCAvIDI1NSk7IC8vICMzNjM5M0MKY29uc3QgQ09MT1JfREFSS19CTEFDSyA9IG1vZC5DcmVhdGVWZWN0b3IoOCAvIDI1NSwgMTEgLyAyNTUsIDExIC8gMjU1KTsgLy8gIzA4MEIwQgoKLy8gVXNlZCBmb3IgTW9kZSBzZWxlY3Rpb24sIGUuZy4gMXYxIGRyaXZpbmcgMSBwbGF5ZXIgcGVyIHNpZGUgdG8gcmVhZHkgdXAgYW5kIDEga2lsbCB0byB3aW4gYSByb3VuZC4KdHlwZSBNYXRjaHVwUHJlc2V0ID0gewogICAgbGVmdFBsYXllcnM6IG51bWJlcjsKICAgIHJpZ2h0UGxheWVyczogbnVtYmVyOwogICAgcm91bmRLaWxsc1RhcmdldDogbnVtYmVyOwp9OwoKdHlwZSBSZWFkeURpYWxvZ01vZGVDb25maWcgPSB7CiAgICBnYW1lTW9kZUluZGV4OiBudW1iZXI7CiAgICBhaXJjcmFmdENlaWxpbmc6IG51bWJlcjsKICAgIGFpcmNyYWZ0Q2VpbGluZ092ZXJyaWRlUGVuZGluZzogYm9vbGVhbjsKICAgIHZlaGljbGVJbmRleFQxOiBudW1iZXI7CiAgICB2ZWhpY2xlSW5kZXhUMjogbnVtYmVyOwogICAgZ2FtZU1vZGU6IG51bWJlcjsKICAgIGdhbWVTZXR0aW5nczogbnVtYmVyOwogICAgdmVoaWNsZXNUMTogbnVtYmVyOwogICAgdmVoaWNsZXNUMjogbnVtYmVyOwogICAgY29uZmlybWVkOiB7CiAgICAgICAgZ2FtZU1vZGU6IG51bWJlcjsKICAgICAgICBnYW1lU2V0dGluZ3M6IG51bWJlcjsKICAgICAgICB2ZWhpY2xlc1QxOiBudW1iZXI7CiAgICAgICAgdmVoaWNsZXNUMjogbnVtYmVyOwogICAgICAgIGFpcmNyYWZ0Q2VpbGluZzogbnVtYmVyOwogICAgICAgIGFpcmNyYWZ0Q2VpbGluZ092ZXJyaWRlRW5hYmxlZDogYm9vbGVhbjsKICAgICAgICB2ZWhpY2xlSW5kZXhUMTogbnVtYmVyOwogICAgICAgIHZlaGljbGVJbmRleFQyOiBudW1iZXI7CiAgICAgICAgdmVoaWNsZU92ZXJyaWRlRW5hYmxlZDogYm9vbGVhbjsKICAgIH07Cn07Cgp0eXBlIEFpcmNyYWZ0Q2VpbGluZ1ZlaGljbGVTdGF0ZSA9IHsKICAgIGVuZm9yY2luZzogYm9vbGVhbjsKICAgIGxhc3ROdWRnZUF0OiBudW1iZXI7Cn07CgovLyBNYXRjaHVwIHByZXNldHMgZHJpdmUgcm91bmQga2lsbCB0YXJnZXRzIGFuZCBzbG90IGVuYWJsZW1lbnQ7IGF1dG8tc3RhcnQgbWluaW11bXMgYXJlIGluZGVwZW5kZW50Lgpjb25zdCBNQVRDSFVQX1BSRVNFVFM6IE1hdGNodXBQcmVzZXRbXSA9IFsKICAgIHsgbGVmdFBsYXllcnM6IDEsIHJpZ2h0UGxheWVyczogMSwgcm91bmRLaWxsc1RhcmdldDogMSB9LAogICAgeyBsZWZ0UGxheWVyczogMiwgcmlnaHRQbGF5ZXJzOiAyLCByb3VuZEtpbGxzVGFyZ2V0OiAyIH0sCiAgICB7IGxlZnRQbGF5ZXJzOiAzLCByaWdodFBsYXllcnM6IDMsIHJvdW5kS2lsbHNUYXJnZXQ6IDMgfSwKICAgIHsgbGVmdFBsYXllcnM6IDQsIHJpZ2h0UGxheWVyczogNCwgcm91bmRLaWxsc1RhcmdldDogNCB9LApdOwoKLy8gRGVyaXZlIHRoZSBpbml0aWFsIHByZXNldCBmcm9tIHRoZSBkZWZhdWx0IG1hdGNodXAgKyBraWxsLXRhcmdldCB2YWx1ZXMuCmNvbnN0IERFRkFVTFRfTUFUQ0hVUF9QUkVTRVRfSU5ERVggPSBmaW5kTWF0Y2h1cFByZXNldEluZGV4KAogICAgREVGQVVMVF9NQVRDSFVQX1BSRVNFVF9MRUZUX1BMQVlFUlMsCiAgICBERUZBVUxUX01BVENIVVBfUFJFU0VUX1JJR0hUX1BMQVlFUlMsCiAgICBST1VORF9LSUxMU19UQVJHRVQKKTsKCmNvbnN0IFJFQURZX0RJQUxPR19HQU1FX01PREVfT1BUSU9OUzogbnVtYmVyW10gPSBbCiAgICBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuZ2FtZU1vZGVIZWxpc1ByYWN0aWNlLAogICAgbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmdhbWVNb2RlSGVsaXNMYWRkZXIsCiAgICBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuZ2FtZU1vZGVIZWxpc1R3bDF2MSwKICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5nYW1lTW9kZUhlbGlzQ3VzdG9tLApdOwpjb25zdCBSRUFEWV9ESUFMT0dfVkVISUNMRV9PUFRJT05TOiBudW1iZXJbXSA9IFsKICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy52ZWhpY2xlT3B0aW9uRmFsY2hpb24sCiAgICBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cudmVoaWNsZU9wdGlvblBhbnRoZXJhLAogICAgbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnZlaGljbGVPcHRpb25CbGFja0hhd2ssCiAgICBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cudmVoaWNsZU9wdGlvbk1hcERlZmF1bHQsCl07CmNvbnN0IFJFQURZX0RJQUxPR19WRUhJQ0xFX0xJU1Q6IG1vZC5WZWhpY2xlTGlzdFtdID0gWwogICAgbW9kLlZlaGljbGVMaXN0LkFINjQsCiAgICBtb2QuVmVoaWNsZUxpc3QuRXVyb2NvcHRlciwKICAgIG1vZC5WZWhpY2xlTGlzdC5VSDYwLAogICAgbW9kLlZlaGljbGVMaXN0LkFINjQsCl07CmNvbnN0IFJFQURZX0RJQUxPR19WRUhJQ0xFX01BUF9ERUZBVUxUX0lOREVYID0gUkVBRFlfRElBTE9HX1ZFSElDTEVfT1BUSU9OUy5sZW5ndGggLSAxOwpjb25zdCBSRUFEWV9ESUFMT0dfR0FNRV9NT0RFX0RFRkFVTFRfSU5ERVggPSAwOwpjb25zdCBSRUFEWV9ESUFMT0dfR0FNRV9NT0RFX0xBRERFUl9JTkRFWCA9IDE7CmNvbnN0IFJFQURZX0RJQUxPR19HQU1FX01PREVfVFdMXzFWMV9JTkRFWCA9IDI7CmNvbnN0IFJFQURZX0RJQUxPR19HQU1FX01PREVfQ1VTVE9NX0lOREVYID0gMzsKY29uc3QgUkVBRFlfRElBTE9HX1ZFSElDTEVfVDFfREVGQVVMVF9JTkRFWCA9IDA7CmNvbnN0IFJFQURZX0RJQUxPR19WRUhJQ0xFX1QyX0RFRkFVTFRfSU5ERVggPSAwOwpjb25zdCBSRUFEWV9ESUFMT0dfQUlSQ1JBRlRfQ0VJTElOR19ERUZBVUxUID0gNTUwOwpjb25zdCBSRUFEWV9ESUFMT0dfQUlSQ1JBRlRfQ0VJTElOR19NSU4gPSAtMjAwOwpjb25zdCBSRUFEWV9ESUFMT0dfQUlSQ1JBRlRfQ0VJTElOR19NQVggPSA1MDAwOwpjb25zdCBSRUFEWV9ESUFMT0dfQUlSQ1JBRlRfQ0VJTElOR19TVEVQID0gMTA7CmNvbnN0IFJFQURZX0RJQUxPR19NT0RFX1BSRVNFVF9CRVNUX09GX1ZBTklMTEEgPSAzOwpjb25zdCBSRUFEWV9ESUFMT0dfTU9ERV9QUkVTRVRfQkVTVF9PRl9MQURERVIgPSAxMTsKY29uc3QgUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX01BVENIVVBfSU5ERVggPSAwOwpjb25zdCBSRUFEWV9ESUFMT0dfTU9ERV9QUkVTRVRfUExBWUVSU19QRVJfU0lERV9WQU5JTExBID0gMjsKY29uc3QgUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX1BMQVlFUlNfUEVSX1NJREVfVFdMXzJWMiA9IDI7CmNvbnN0IFJFQURZX0RJQUxPR19NT0RFX1BSRVNFVF9QTEFZRVJTX1BFUl9TSURFX1RXTF8xVjEgPSAxOwpjb25zdCBSRUFEWV9ESUFMT0dfTU9ERV9QUkVTRVRfVkVISUNMRV9JTkRFWCA9IDA7CmxldCBzdXBwcmVzc1JlYWR5RGlhbG9nTW9kZUF1dG9Td2l0Y2ggPSBmYWxzZTsKLy8gQWlyY3JhZnQgY2VpbGluZyBlbmZvcmNlbWVudCBtb2RlIChoYXJkID0gZW5naW5lIGxpbWl0ZXIgb25seSwgc29mdCA9IHNjcmlwdGVkIG51ZGdlcykuCmNvbnN0IEFJUkNSQUZUX0NFSUxJTkdfRU5GT1JDRU1FTlRfTU9ERTogImhhcmQiIHwgInNvZnQiID0gImhhcmQiOwovLyBTb2Z0IGNlaWxpbmcgZW5mb3JjZW1lbnQ6IGtlZXAgdGhlIGVuZ2luZSdzIGhhcmQgbGltaXRlciBhYm92ZSBnYW1lcGxheSB0byBhdm9pZCBzdGlja3kgZmxpZ2h0Lgpjb25zdCBBSVJDUkFGVF9TT0ZUX0NFSUxJTkdfSEFSRF9CVUZGRVIgPSAxMDA7IC8vIEFkanVzdGFibGUgYnVmZmVyIGFib3ZlIHRoZSBzb2Z0IGNlaWxpbmcgKHdvcmxkIFkgdW5pdHMpLgpjb25zdCBBSVJDUkFGVF9TT0ZUX0NFSUxJTkdfRU5URVJfQlVGRkVSID0gMTA7IC8vIFN0YXJ0IGVuZm9yY2luZyBvbmNlIGFib3ZlIHNvZnQrYnVmZmVyLgpjb25zdCBBSVJDUkFGVF9TT0ZUX0NFSUxJTkdfRVhJVF9CVUZGRVIgPSAyMDsgLy8gU3RvcCBlbmZvcmNpbmcgb25jZSBiZWxvdyBzb2Z0LWJ1ZmZlci4KY29uc3QgQUlSQ1JBRlRfU09GVF9DRUlMSU5HX05VREdFX01JTl9TVEVQID0gMC4zOyAvLyBNaW5pbXVtIGRvd253YXJkIG51ZGdlIHN0ZXAgd2hpbGUgZW5mb3JjaW5nLgpjb25zdCBBSVJDUkFGVF9TT0ZUX0NFSUxJTkdfTlVER0VfTUFYX1NURVAgPSA2LjA7IC8vIE1heGltdW0gZG93bndhcmQgbnVkZ2Ugc3RlcCB3aGlsZSBlbmZvcmNpbmcuCmNvbnN0IEFJUkNSQUZUX1NPRlRfQ0VJTElOR19OVURHRV9JTlRFUlZBTF9TRUNPTkRTID0gMC4xNTsgLy8gTWluaW11bSB0aW1lIGJldHdlZW4gbnVkZ2VzLgpjb25zdCBBSVJDUkFGVF9TT0ZUX0NFSUxJTkdfVkVMT0NJVFlfU0NBTEUgPSAxLjE7IC8vIFNjYWxlIHVwd2FyZCB2ZWxvY2l0eSB0byBjb3VudGVyIGNsaW1iIHdpdGhvdXQgYSBoYXJkIGNhcC4KY29uc3QgQUlSQ1JBRlRfU09GVF9DRUlMSU5HX0hBUkRfU1RFUF9NVUxUSVBMSUVSID0gMi4wOyAvLyBFeHRyYSBwdXNoIGlmIGZhciBhYm92ZSBzb2Z0K2J1ZmZlci4KY29uc3QgQUlSQ1JBRlRfU09GVF9DRUlMSU5HX1RJQ0tfU0VDT05EUyA9IDAuMjsgLy8gTG9vcCBjYWRlbmNlIGZvciBzb2Z0IGNlaWxpbmcgZW5mb3JjZW1lbnQuCgovLyBQcmVnYW1lIGNvdW50ZG93biB0dW5pbmcgKFJlYWR5IFVwIC0+IHJvdW5kIHN0YXJ0KS4KLy8gVW5pdHM6IHNlY29uZHMgYW5kIFVJIHNjYWxlIHVuaXRzLgpjb25zdCBQUkVHQU1FX0NPVU5URE9XTl9JTklUSUFMX0RFTEFZX1NFQ09ORFMgPSAwLjU7CmNvbnN0IFBSRUdBTUVfQ09VTlRET1dOX1NURVBfU0VDT05EUyA9IDEuMDsKY29uc3QgUFJFR0FNRV9DT1VOVERPV05fU1RBUlRfTlVNQkVSID0gNTsKY29uc3QgUFJFR0FNRV9DT1VOVERPV05fU0laRV9ESUdJVF9TVEFSVCA9IDYyMDsKY29uc3QgUFJFR0FNRV9DT1VOVERPV05fU0laRV9ESUdJVF9FTkQgPSAzNjA7CmNvbnN0IFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfR09fU1RBUlQgPSA2NTA7CmNvbnN0IFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfR09fRU5EID0gNDIwOwpjb25zdCBQUkVHQU1FX0NPVU5URE9XTl9HT19IT0xEX1NFQ09ORFMgPSAwLjc1Owpjb25zdCBQUkVHQU1FX0NPVU5URE9XTl9BTklNQVRJT05fU1RFUFMgPSAzMDsKY29uc3QgUFJFR0FNRV9BTEVSVF9URVhUX0FMUEhBID0gMC44NTsgLy8gVUkgdGV4dCBhbHBoYSAoMC4uMSkuCgovLyBUZWFtIHN3aXRjaCBiZWhhdmlvciBjb25maWd1cmF0aW9uIChzYWZlIHRvIHR3ZWFrKS4KLy8gLSBlbmFibGVUZWFtU3dpdGNoOiBtYXN0ZXIgdG9nZ2xlIGZvciB0aGUgaW50ZXJhY3QtYmFzZWQgdGVhbSBzd2l0Y2ggZGlhbG9nLgovLyAtIGludGVyYWN0UG9pbnRNaW5MaWZldGltZS9NYXhMaWZldGltZTogbGlmZXRpbWUgd2luZG93IGJlZm9yZSBhdXRvLWRlc3Bhd24uCi8vIC0gdmVsb2NpdHlUaHJlc2hvbGQ6IHJlbW92ZSBpbnRlcmFjdCBwb2ludCB3aGlsZSBwbGF5ZXIgaXMgbW92aW5nLgpjb25zdCBURUFNU1dJVENIQ09ORklHOiBUZWFtU3dpdGNoQ29uZmlnID0gewogICAgZW5hYmxlVGVhbVN3aXRjaDogdHJ1ZSwKICAgIGludGVyYWN0UG9pbnRNaW5MaWZldGltZTogMSwKICAgIGludGVyYWN0UG9pbnRNYXhMaWZldGltZTogMywKICAgIHZlbG9jaXR5VGhyZXNob2xkOiAzLAp9OwoKLy8gQWRtaW4gcGFuZWwgdG9nZ2xlIGRlYm91bmNlIChzZWNvbmRzKS4gUHJldmVudHMgZG91YmxlLXRvZ2dsZSBmcm9tIHByZXNzL3JlbGVhc2UgZXZlbnRzLgpjb25zdCBBRE1JTl9QQU5FTF9UT0dHTEVfQ09PTERPV05fU0VDT05EUyA9IDAuMjsKCi8vIENsb2NrICsgSFVEIGxheW91dCBjb25zdGFudHMgKHBpeGVscyB1bmxlc3Mgbm90ZWQpLgpjb25zdCBUT1BfSFVEX09GRlNFVF9ZID0gMTA7CmNvbnN0IENMT0NLX1BPU0lUSU9OX1ggPSAwOwpjb25zdCBDTE9DS19QT1NJVElPTl9ZID0gNTMgKyBUT1BfSFVEX09GRlNFVF9ZOwpjb25zdCBDTE9DS19XSURUSCA9IDIyMDsKY29uc3QgQ0xPQ0tfSEVJR0hUID0gNDQ7CmNvbnN0IFJPVU5EX0xJVkVfSEVMUF9PRkZTRVRfWSA9IDY3Owpjb25zdCBST1VORF9DT1VOVEVSX09GRlNFVF9YID0gLTY7CmNvbnN0IFJPVU5EX1NMQVNIX09GRlNFVF9YID0gLTY7CmNvbnN0IFRPUF9IVURfUk9PVF9XSURUSCA9IDE5MjA7CmNvbnN0IFRPUF9IVURfUk9PVF9IRUlHSFQgPSAyNjA7CmNvbnN0IFJPVU5EX0xJVkVfSEVMUF9XSURUSCA9IDMwMDsKY29uc3QgUk9VTkRfTElWRV9IRUxQX0hFSUdIVCA9IDE4Owpjb25zdCBDTE9DS19GT05UX1NJWkUgPSAzMjsKY29uc3QgTE9XX1RJTUVfVEhSRVNIT0xEX1NFQ09ORFMgPSA2MDsgLy8gTG93LXRpbWUgY29sb3IgdGhyZXNob2xkIGluIHNlY29uZHMuCi8vIEhVRCB0ZXh0IGRyb3Agc2hhZG93IG9mZnNldCAocGl4ZWxzKTogbmVnYXRpdmUgWCBtb3ZlcyBsZWZ0LCBuZWdhdGl2ZSBZIG1vdmVzIHVwLgovLyBTaGFyZWQgc2hhZG93IG9mZnNldHMgZm9yIHN0YWNrZWQgSFVEIHRleHQgbGF5ZXJzLgpjb25zdCBIVURfVEVYVF9TSEFET1dfT0ZGU0VUX1ggPSAtMTsKY29uc3QgSFVEX1RFWFRfU0hBRE9XX09GRlNFVF9ZID0gLTE7CgovLyBIVUQgc3RhdHVzIGNvbG9ycyAodmVjdG9ycyBhcmUgUkdCIDAuLjEpLgpjb25zdCBDT0xPUl9OT1JNQUwgPSBtb2QuQ3JlYXRlVmVjdG9yKDEsIDEsIDEpOwpjb25zdCBDT0xPUl9MT1dfVElNRSA9IG1vZC5DcmVhdGVWZWN0b3IoMSwgMTMxIC8gMjU1LCA5NyAvIDI1NSk7CmNvbnN0IENPTE9SX1JFQURZX0dSRUVOID0gbW9kLkNyZWF0ZVZlY3RvcigxNzMgLyAyNTUsIDI1MyAvIDI1NSwgMTM0IC8gMjU1KTsgLy8gI0FERkQ4NgoKLy8gU3RhdHVzIC8gZW1waGFzaXMgY29sb3JzICh1c2UgY29uc3RhbnRzOyBkbyBub3QgaW5saW5lIENyZWF0ZVZlY3RvcigpIGluIFVJIGNvZGUpLgpjb25zdCBDT0xPUl9OT1RfUkVBRFlfUkVEID0gbW9kLkNyZWF0ZVZlY3RvcigxLCAwLCAwKTsKY29uc3QgQ09MT1JfV0FSTklOR19ZRUxMT1cgPSBtb2QuQ3JlYXRlVmVjdG9yKDEsIDEsIDApOwoKLy8gQnV0dG9ucyBsb29rIGFuZCBmZWVsIChiYXNlIC8gc2VsZWN0ZWQgLyBwcmVzc2VkIC8gYm9yZGVyKS4KY29uc3QgQ09MT1JfQlVUVE9OX0JBU0UgPSBDT0xPUl9HUkFZOwpjb25zdCBCVVRUT05fT1BBQ0lUWV9CQVNFID0gMC43NTsKY29uc3QgQ09MT1JfQlVUVE9OX1NFTEVDVEVEID0gQ09MT1JfQkxVRTsKY29uc3QgQlVUVE9OX09QQUNJVFlfU0VMRUNURUQgPSAwLjc1Owpjb25zdCBDT0xPUl9CVVRUT05fUFJFU1NFRCA9IENPTE9SX1dISVRFOwpjb25zdCBCVVRUT05fT1BBQ0lUWV9QUkVTU0VEID0gMC43NTsKY29uc3QgQ09MT1JfQlVUVE9OX0JPUkRFUiA9IENPTE9SX0dSQVk7CmNvbnN0IEJVVFRPTl9CT1JERVJfT1BBQ0lUWSA9IDAuNTA7CmNvbnN0IEJVVFRPTl9CT1JERVJfUEFERElORyA9IDA7CgovLyBSZWFkeSBEaWFsb2cKY29uc3QgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9XSURUSCA9IDI2Owpjb25zdCBSRUFEWV9ESUFMT0dfU01BTExfQlVUVE9OX0hFSUdIVCA9IDI0Owpjb25zdCBSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fV0lEVEggPSAzMDA7CmNvbnN0IFJFQURZX0RJQUxPR19NQUlOX0JVVFRPTl9IRUlHSFQgPSA0NTsKLy8gU3BsaXQgYm90dG9tLWNlbnRlciBidXR0b25zOiBSZWFkeSAobGVmdCBvZiBjZW50ZXIpICsgQXV0by1SZWFkeSAocmlnaHQgb2YgY2VudGVyKS4KY29uc3QgUkVBRFlfRElBTE9HX1JFQURZX0JVVFRPTl9PRkZTRVRfWCA9IC0oTWF0aC5mbG9vcihSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fV0lEVEggLyAyKSArIDEwKTsKY29uc3QgUkVBRFlfRElBTE9HX0FVVE9fUkVBRFlfQlVUVE9OX09GRlNFVF9YID0gTWF0aC5mbG9vcihSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fV0lEVEggLyAyKSArIDEwOwpjb25zdCBSRUFEWV9ESUFMT0dfQ09ORklSTV9CVVRUT05fR0FQID0gODsKY29uc3QgUkVBRFlfRElBTE9HX0NPTkZJUk1fQlVUVE9OX1dJRFRIID0gUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX1dJRFRIIC0gNDA7CmNvbnN0IFJFQURZX0RJQUxPR19SRVNFVF9CVVRUT05fV0lEVEggPSBNYXRoLmZsb29yKChSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fV0lEVEggLSA0MCkgLyAyKTsKY29uc3QgUkVBRFlfRElBTE9HX1JFU0VUX0JVVFRPTl9PRkZTRVRfWCA9IDA7CmNvbnN0IFJFQURZX1BBTkVMX1QxX0JHX0NPTE9SID0gbW9kLkNyZWF0ZVZlY3RvcigwLjEwLCAwLjI1LCAwLjcwKTsKY29uc3QgUkVBRFlfUEFORUxfVDJfQkdfQ09MT1IgPSBtb2QuQ3JlYXRlVmVjdG9yKDAuNzAsIDAuMTUsIDAuMTUpOwpjb25zdCBSRUFEWV9QQU5FTF9CR19BTFBIQSA9IDAuMjA7CmNvbnN0IFJFQURZX0RJQUxPR19CVVRUT05fVEVYVF9DT0xPUl9SR0I6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFsxLCAxLCAxXTsKY29uc3QgUkVBRFlfRElBTE9HX0xBQkVMX1RFWFRfQ09MT1IgPSBDT0xPUl9XSElURTsKY29uc3QgUkVBRFlfRElBTE9HX0JPUkRFUl9DT0xPUiA9IENPTE9SX0dSQVk7CgovLyBBZG1pbiBQYW5lbApjb25zdCBBRE1JTl9QQU5FTF9IRUlHSFQgPSA2OTQ7CmNvbnN0IEFETUlOX1BBTkVMX1BBRERJTkcgPSA1Owpjb25zdCBBRE1JTl9QQU5FTF9CQVNFX1ggPSAtNTsKY29uc3QgQURNSU5fUEFORUxfQkFTRV9ZID0gMTU7CmNvbnN0IEFETUlOX1BBTkVMX09GRlNFVF9YID0gMTA7CmNvbnN0IEFETUlOX1BBTkVMX09GRlNFVF9ZID0gMTU7CmNvbnN0IEFETUlOX1BBTkVMX1RPR0dMRV9PRkZTRVRfWCA9IDEwOwpjb25zdCBBRE1JTl9QQU5FTF9UT0dHTEVfT0ZGU0VUX1kgPSAxNTsKY29uc3QgQURNSU5fUEFORUxfVE9HR0xFX1dJRFRIID0gMTIwOwpjb25zdCBBRE1JTl9QQU5FTF9UT0dHTEVfSEVJR0hUID0gMjQ7CmNvbnN0IEFETUlOX1BBTkVMX0JVVFRPTl9TSVpFX1ggPSA0ODsKY29uc3QgQURNSU5fUEFORUxfQlVUVE9OX1NJWkVfWSA9IDMwOwpjb25zdCBBRE1JTl9QQU5FTF9MQUJFTF9TSVpFX1ggPSAxMzA7CmNvbnN0IEFETUlOX1BBTkVMX0NPTlRFTlRfV0lEVEggPSAoQURNSU5fUEFORUxfQlVUVE9OX1NJWkVfWCAqIDIpICsgQURNSU5fUEFORUxfTEFCRUxfU0laRV9YICsgMTY7CmNvbnN0IEFETUlOX1BBTkVMX1JPV19TUEFDSU5HX1kgPSA0Owpjb25zdCBBRE1JTl9QQU5FTF9WQUxVRV9TSVpFX1ggPSA0NjsKY29uc3QgQURNSU5fUEFORUxfVElFQlJFQUtFUl9MQUJFTF9IRUlHSFQgPSAxNjsKY29uc3QgQURNSU5fUEFORUxfVElFQlJFQUtFUl9CVVRUT05fU0laRSA9IDI2Owpjb25zdCBBRE1JTl9QQU5FTF9USUVCUkVBS0VSX0JVVFRPTl9TUEFDSU5HID0gNDsKY29uc3QgQURNSU5fUEFORUxfQkdfQ09MT1IgPSBDT0xPUl9EQVJLX0JMQUNLOwpjb25zdCBBRE1JTl9QQU5FTF9CR19BTFBIQSA9IDEuMDsKY29uc3QgQURNSU5fUEFORUxfQkdfRklMTCA9IG1vZC5VSUJnRmlsbC5CbHVyOwpjb25zdCBBRE1JTl9QQU5FTF9MQUJFTF9URVhUX0NPTE9SX1JHQjogW251bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWzEsIDEsIDFdOwpjb25zdCBBRE1JTl9QQU5FTF9CVVRUT05fVEVYVF9DT0xPUiA9IENPTE9SX1dISVRFOwpjb25zdCBBRE1JTl9QQU5FTF9MQUJFTF9URVhUX0NPTE9SID0gQ09MT1JfV0hJVEU7CmNvbnN0IEFETUlOX1RJRUJSRUFLRVJfT1ZFUlJJREVfTEVUVEVSUyA9IFsiQSIsICJCIiwgIkMiLCAiRCIsICJFIiwgIkYiLCAiRyJdOwpjb25zdCBPVkVSVElNRV9GTEFHX0xFVFRFUlMgPSBbIkEiLCAiQiIsICJDIiwgIkQiLCAiRSIsICJGIiwgIkciLCAiSCJdOwpjb25zdCBPVkVSVElNRV9UQU5LX1pPTkVfTEVUVEVSUyA9IFsiQSIsICJCIiwgIkMiLCAiRCIsICJFIiwgIkYiLCAiRyJdOwpjb25zdCBPVkVSVElNRV9IRUxJX1pPTkVfTEVUVEVSUyA9IFsiSCJdOwpjb25zdCBBRE1JTl9USUVCUkVBS0VSX01PREVfT1BUSU9OUyA9IFsKICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmxhYmVscy50aWVCcmVha2VyTW9kZUxhc3RSb3VuZE9ubHksCiAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5sYWJlbHMudGllQnJlYWtlck1vZGVBbGxSb3VuZHMsCiAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5sYWJlbHMudGllQnJlYWtlck1vZGVEaXNhYmxlZCwKXTsKY29uc3QgQURNSU5fVElFQlJFQUtFUl9NT0RFX0FDVElPTl9LRVlTID0gWwogICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50aWVCcmVha2VyTW9kZUxhc3RSb3VuZE9ubHksCiAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnRpZUJyZWFrZXJNb2RlQWxsUm91bmRzLAogICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50aWVCcmVha2VyTW9kZURpc2FibGVkLApdOwpjb25zdCBBRE1JTl9USUVCUkVBS0VSX01PREVfREVGQVVMVF9JTkRFWCA9IDA7CgovLyBWaWN0b3J5IGRpYWxvZyB0aGVtZSBjb2xvcnMgKFBhcnNlVUkgZXhwZWN0cyBSR0IgdHVwbGVzLCBub3QgdmVjdG9ycykuCmNvbnN0IFZJQ1RPUllfQkdfUkdCOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlcl0gPSBbMC4wMzE0LCAwLjA0MzEsIDAuMDQzMV07CmNvbnN0IFZJQ1RPUllfVEVBTTFfQkdfUkdCOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlcl0gPSBbMC4xMDk4LCAwLjIzMDQsIDAuMjVdOwpjb25zdCBWSUNUT1JZX1RFQU0yX0JHX1JHQjogW251bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWzAuMjUsIDAuMTI4NCwgMC4wOTUxXTsKY29uc3QgVklDVE9SWV9URUFNMV9URVhUX1JHQjogW251bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWzAuNDM5MiwgMC45MjE2LCAxXTsKY29uc3QgVklDVE9SWV9URUFNMl9URVhUX1JHQjogW251bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWzEsIDAuNTEzNywgMC4zODA0XTsKY29uc3QgVklDVE9SWV9ESUFMT0dfV0lEVEggPSAzNjA7CmNvbnN0IFZJQ1RPUllfRElBTE9HX0hFSUdIVCA9IDUwMDsKY29uc3QgVklDVE9SWV9ESUFMT0dfUk9TVEVSX1JPV19ZID0gMjgyOwpjb25zdCBWSUNUT1JZX0RJQUxPR19ST1NURVJfUk9XX1dJRFRIID0gMzQwOwpjb25zdCBWSUNUT1JZX0RJQUxPR19ST1NURVJfUk9XX0hFSUdIVF9NQVggPSAyMDA7CmNvbnN0IFZJQ1RPUllfRElBTE9HX1JPU1RFUl9DT05UQUlORVJfV0lEVEggPSAxNjA7CmNvbnN0IFZJQ1RPUllfRElBTE9HX1JPU1RFUl9ST1dfSEVJR0hUID0gMTI7CmNvbnN0IFZJQ1RPUllfRElBTE9HX1JPU1RFUl9ST1dfUEFERElOR19UT1AgPSA0Owpjb25zdCBWSUNUT1JZX0RJQUxPR19ST1NURVJfUk9XX1BBRERJTkdfQk9UVE9NID0gNDsKY29uc3QgVklDVE9SWV9ESUFMT0dfQk9UVE9NX1BBRERJTkcgPSAxODsKY29uc3QgVklDVE9SWV9DUk9XTl9TSVpFID0gMTY7CmNvbnN0IFZJQ1RPUllfQ1JPV05fT0ZGU0VUX1hfTEVGVCA9IDU4Owpjb25zdCBWSUNUT1JZX0NST1dOX09GRlNFVF9YX1JJR0hUID0gLTU4Owpjb25zdCBWSUNUT1JZX0NST1dOX09GRlNFVF9ZID0gODsKY29uc3QgVklDVE9SWV9DUk9XTl9DT0xPUl9SR0I6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFsxLCAyNTIgLyAyNTUsIDE1NiAvIDI1NV07CmNvbnN0IFNQQVdOX0RJU0FCTEVEX1RFWFRfV0lEVEggPSA2NDA7CmNvbnN0IFNQQVdOX0RJU0FCTEVEX1RFWFRfSEVJR0hUID0gMzY7CmNvbnN0IFNQQVdOX0RJU0FCTEVEX1RFWFRfUE9TX1kgPSAzMzY7CmNvbnN0IFNQQVdOX0RJU0FCTEVEX1RFWFRfU0laRSA9IDI2Owpjb25zdCBTUEFXTl9ESVNBQkxFRF9URVhUX0NPTE9SX1JHQjogW251bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWzEsIDAuMSwgMC4xXTsKCi8vIE1haW4gYmFzZSBtZXNzYWdpbmcgc3RyaW5nIGtleXMgKFN0cmluZ3MuanNvbikuCmNvbnN0IFNUUl9FTlRFUkVEX01BSU5fQkFTRSA9IG1vZC5zdHJpbmdrZXlzLnR3bC5ub3RpZmljYXRpb25zLmVudGVyZWRNYWluQmFzZTsKY29uc3QgU1RSX0VYSVRFRF9NQUlOX0JBU0UgPSBtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5leGl0ZWRNYWluQmFzZTsKY29uc3QgU1RSX0FNTU9fUkVTVE9DS0VEID0gbW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMuYW1tb1Jlc3RvY2tlZDsKY29uc3QgU1RSX1JFQURZVVBfUkVUVVJOX1RPX0JBU0VfTk9UX0xJVkUgPSBtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5yZWFkeXVwUmV0dXJuVG9CYXNlTm90TGl2ZTsKY29uc3QgU1RSX1BMQVlFUl9SRUFESUVEX1VQID0gbW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMucGxheWVyUmVhZGllZFVwOwpjb25zdCBTVFJfUExBWUVSX0FVVE9fUkVBRElFRF9VUCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5ub3RpZmljYXRpb25zLmF1dG9SZWFkaWVkVXA7CmNvbnN0IFNUUl9IVURfQVVUT19SRUFEWV9URVhUID0gbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5hdXRvUmVhZHlUZXh0Owpjb25zdCBTVFJfSk9JTl9QUk9NUFRfVElUTEUgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC50aXRsZTsKY29uc3QgU1RSX0pPSU5fUFJPTVBUX0RJU01JU1MgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5kaXNtaXNzOwpjb25zdCBTVFJfSk9JTl9QUk9NUFRfRElTTUlTU19TSE9XX01PUkVfVElQUyA9IG1vZC5zdHJpbmdrZXlzLnR3bC5qb2luUHJvbXB0LmRpc21pc3NTaG93TW9yZVRpcHM7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9ORVZFUl9TSE9XID0gbW9kLnN0cmluZ2tleXMudHdsLmpvaW5Qcm9tcHQubmV2ZXJTaG93QWdhaW47CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX01BTkRBVE9SWTEgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5Lm1hbmRhdG9yeTE7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX01BTkRBVE9SWTIgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5Lm1hbmRhdG9yeTI7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDMgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDM7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDQgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDQ7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDUgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDU7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDYgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDY7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDcgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDc7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDggPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDg7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDkgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDk7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDEwID0gbW9kLnN0cmluZ2tleXMudHdsLmpvaW5Qcm9tcHQuYm9keS50aXAxMDsKY29uc3QgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMTEgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDExOwpjb25zdCBTVFJfSk9JTl9QUk9NUFRfQk9EWV9USVAxMiA9IG1vZC5zdHJpbmdrZXlzLnR3bC5qb2luUHJvbXB0LmJvZHkudGlwMTI7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDEzID0gbW9kLnN0cmluZ2tleXMudHdsLmpvaW5Qcm9tcHQuYm9keS50aXAxMzsKY29uc3QgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMTQgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDE0Owpjb25zdCBTVFJfSk9JTl9QUk9NUFRfQk9EWV9USVAxNSA9IG1vZC5zdHJpbmdrZXlzLnR3bC5qb2luUHJvbXB0LmJvZHkudGlwMTU7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDE2ID0gbW9kLnN0cmluZ2tleXMudHdsLmpvaW5Qcm9tcHQuYm9keS50aXAxNjsKY29uc3QgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMTcgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDE3Owpjb25zdCBTVFJfSk9JTl9QUk9NUFRfQk9EWV9USVAxOCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5qb2luUHJvbXB0LmJvZHkudGlwMTg7CmNvbnN0IFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDE5ID0gbW9kLnN0cmluZ2tleXMudHdsLmpvaW5Qcm9tcHQuYm9keS50aXAxOTsKY29uc3QgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMjAgPSBtb2Quc3RyaW5na2V5cy50d2wuam9pblByb21wdC5ib2R5LnRpcDIwOwpjb25zdCBTVFJfSFVEX0FVVE9fUkVBRFlfSEVMUF9URVhUID0gbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5hdXRvUmVhZHlIZWxwVGV4dDsKY29uc3QgSk9JTl9QUk9NUFRfQk9EWV9TRVFVRU5DRV9LRVlTOiBudW1iZXJbXSA9IFsKICAgIFNUUl9KT0lOX1BST01QVF9CT0RZX01BTkRBVE9SWTEsCiAgICBTVFJfSk9JTl9QUk9NUFRfQk9EWV9NQU5EQVRPUlkyLAogICAgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMywKICAgIFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDQsCiAgICBTVFJfSk9JTl9QUk9NUFRfQk9EWV9USVA1LAogICAgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQNiwKICAgIFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDcsCiAgICBTVFJfSk9JTl9QUk9NUFRfQk9EWV9USVA4LAogICAgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQOSwKICAgIFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDEwLAogICAgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMTEsCiAgICBTVFJfSk9JTl9QUk9NUFRfQk9EWV9USVAxMiwKICAgIFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDEzLAogICAgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMTQsCiAgICBTVFJfSk9JTl9QUk9NUFRfQk9EWV9USVAxNSwKICAgIFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDE2LAogICAgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMTcsCiAgICBTVFJfSk9JTl9QUk9NUFRfQk9EWV9USVAxOCwKICAgIFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDE5LAogICAgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMjAsCl07CgovLyBBZGQgYW55IGJvZHkga2V5cyB0byBza2lwIChlLmcuLCB0aXBzIHdpdGggZW1wdHkgc3RyaW5ncykuCmNvbnN0IEpPSU5fUFJPTVBUX0JPRFlfU0VRVUVOQ0VfU0tJUF9LRVlTOiBudW1iZXJbXSA9IFsKICAgIFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDE0LAogICAgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMTUsCiAgICBTVFJfSk9JTl9QUk9NUFRfQk9EWV9USVAxNiwKICAgIFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDE3LAogICAgU1RSX0pPSU5fUFJPTVBUX0JPRFlfVElQMTgsCiAgICBTVFJfSk9JTl9QUk9NUFRfQk9EWV9USVAxOSwKICAgIFNUUl9KT0lOX1BST01QVF9CT0RZX1RJUDIwLApdOwoKLy8gVmVoaWNsZSByZWdpc3RyYXRpb24gbWVzc2FnaW5nIHN0cmluZ3MKY29uc3QgU1RSX1JPVU5EX0NMRUFOVVBfU1BBV05fVElNRU9VVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5ub3RpZmljYXRpb25zLnJvdW5kQ2xlYW51cFNwYXduVGltZW91dDsKY29uc3QgU1RSX1ZFSElDTEVfU1BBV05fUkVUUlkgPSBtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMudmVoaWNsZVNwYXduUmV0cnk7CmNvbnN0IFNUUl9WRUhJQ0xFX1NUT0xFTl9SRUdJU1RFUiA9IG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy52ZWhpY2xlU3RvbGVuUmVnaXN0ZXI7CmNvbnN0IFNUUl9WRUhJQ0xFX1JFR19OT19DSEFOR0UgPSBtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMudmVoaWNsZVJlZ2lzdHJhdGlvbk5vQ2hhbmdlOwpjb25zdCBTVFJfVkVISUNMRV9SRUdfUEVORElOR19URUFNID0gbW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnZlaGljbGVSZWdpc3RyYXRpb25QZW5kaW5nVGVhbTsKY29uc3QgU1RSX1JFQURZX0RJQUxPR19NQVRDSFVQX0NIQU5HRUQgPSBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cubWF0Y2h1cENoYW5nZWQ7CmNvbnN0IFNUUl9SRUFEWV9ESUFMT0dfUExBWUVSU19DSEFOR0VEID0gbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnBsYXllcnNDaGFuZ2VkOwpjb25zdCBTVFJfUkVBRFlfRElBTE9HX0dBTUVfTU9ERV9DSEFOR0VEID0gbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmdhbWVNb2RlQ2hhbmdlZDsKY29uc3QgU1RSX1JFQURZX0RJQUxPR19BSVJDUkFGVF9DRUlMSU5HX0NIQU5HRUQgPSBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuYWlyY3JhZnRDZWlsaW5nQ2hhbmdlZDsKY29uc3QgU1RSX1JFQURZX0RJQUxPR19BSVJDUkFGVF9DRUlMSU5HX1ZBTklMTEEgPSBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuYWlyY3JhZnRDZWlsaW5nVmFuaWxsYTsKY29uc3QgU1RSX0hVRF9TRVRUSU5HU19HQU1FX01PREVfRk9STUFUID0gbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5zZXR0aW5ncy5nYW1lTW9kZUZvcm1hdDsKY29uc3QgU1RSX0hVRF9TRVRUSU5HU19BSVJDUkFGVF9DRUlMSU5HX0ZPUk1BVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuc2V0dGluZ3MuYWlyY3JhZnRDZWlsaW5nRm9ybWF0Owpjb25zdCBTVFJfSFVEX1NFVFRJTkdTX1ZFSElDTEVTX1RFQU1fRk9STUFUID0gbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5zZXR0aW5ncy52ZWhpY2xlc1RlYW1Gb3JtYXQ7CmNvbnN0IFNUUl9IVURfU0VUVElOR1NfVkVISUNMRVNfTUFUQ0hVUF9GT1JNQVQgPSBtb2Quc3RyaW5na2V5cy50d2wuaHVkLnNldHRpbmdzLnZlaGljbGVzTWF0Y2h1cEZvcm1hdDsKY29uc3QgU1RSX0hVRF9TRVRUSU5HU19QTEFZRVJTX0ZPUk1BVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuc2V0dGluZ3MucGxheWVyc0Zvcm1hdDsKY29uc3QgU1RSX0hVRF9TRVRUSU5HU19HQU1FX01PREVfREVGQVVMVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuc2V0dGluZ3MuZ2FtZU1vZGVEZWZhdWx0Owpjb25zdCBTVFJfSFVEX1NFVFRJTkdTX1ZBTFVFX0RFRkFVTFQgPSBtb2Quc3RyaW5na2V5cy50d2wuaHVkLnNldHRpbmdzLnZhbHVlRGVmYXVsdDsKY29uc3QgU1RSX0hVRF9TRVRUSU5HU19WQUxVRV9NQVBfREVGQVVMVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuc2V0dGluZ3MudmFsdWVNYXBEZWZhdWx0Owpjb25zdCBTVFJfVUlfWCA9IG1vZC5zdHJpbmdrZXlzLnR3bC51aS54Owpjb25zdCBTVFJfT1ZFUkxJTkVfVEFLRU9GRl9USVRMRSA9IG1vZC5zdHJpbmdrZXlzLnR3bC5vdmVyTGluZS50YWtlb2ZmVGl0bGU7CmNvbnN0IFNUUl9PVkVSTElORV9UQUtFT0ZGX1NVQlRJVExFID0gbW9kLnN0cmluZ2tleXMudHdsLm92ZXJMaW5lLnRha2VvZmZTdWJ0aXRsZTsKCi8vIE92ZXJ0aW1lIGFubm91bmNlbWVudHMgKyBmbGFnIGNhcHR1cmUgVUkgc3RyaW5ncwpjb25zdCBTVFJfT1ZFUlRJTUVfU1VCX05PVElDRSA9IG1vZC5zdHJpbmdrZXlzLnR3bC5vdmVydGltZS5zdWJ0aXRsZS5ub3RpY2U7CmNvbnN0IFNUUl9PVkVSVElNRV9USVRMRV9WSVNJQkxFID0gbW9kLnN0cmluZ2tleXMudHdsLm92ZXJ0aW1lLnRpdGxlLnZpc2libGU7CmNvbnN0IFNUUl9PVkVSVElNRV9USVRMRV9WSVNJQkxFX0FETUlOID0gbW9kLnN0cmluZ2tleXMudHdsLm92ZXJ0aW1lLnRpdGxlLnZpc2libGVBZG1pbjsKY29uc3QgU1RSX09WRVJUSU1FX1NVQl9VTkxPQ0tTX0lOID0gbW9kLnN0cmluZ2tleXMudHdsLm92ZXJ0aW1lLnN1YnRpdGxlLnVubG9ja3NJbjsKY29uc3QgU1RSX09WRVJUSU1FX1NVQl9VTkxPQ0tTX05PVyA9IG1vZC5zdHJpbmdrZXlzLnR3bC5vdmVydGltZS5zdWJ0aXRsZS51bmxvY2tzTm93Owpjb25zdCBTVFJfRkxBR19USVRMRSA9IG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS50aXRsZTsKY29uc3QgU1RSX0ZMQUdfVElUTEVfTE9DS0VEX0ZPUk1BVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5sb2NrZWRUaXRsZUZvcm1hdDsKY29uc3QgU1RSX0ZMQUdfVElUTEVfQUNUSVZFX0ZPUk1BVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5hY3RpdmVUaXRsZUZvcm1hdDsKY29uc3QgU1RSX0ZMQUdfQUNUSVZBVEVTX0lOX0ZPUk1BVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5hY3RpdmF0ZXNJbkZvcm1hdDsKY29uc3QgU1RSX0ZMQUdfU1RBVFVTX0NBUFRVUklORyA9IG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5zdGF0dXMuY2FwdHVyaW5nOwpjb25zdCBTVFJfRkxBR19TVEFUVVNfTE9TSU5HID0gbW9kLnN0cmluZ2tleXMudHdsLmZsYWdDYXB0dXJlLnN0YXR1cy5sb3Npbmc7CmNvbnN0IFNUUl9GTEFHX1NUQVRVU19TVEFMTEVEID0gbW9kLnN0cmluZ2tleXMudHdsLmZsYWdDYXB0dXJlLnN0YXR1cy5zdGFsbGVkOwpjb25zdCBTVFJfRkxBR19TVEFUVVNfUkVTRVRUSU5HID0gbW9kLnN0cmluZ2tleXMudHdsLmZsYWdDYXB0dXJlLnN0YXR1cy5yZXNldHRpbmc7CmNvbnN0IFNUUl9GTEFHX0NPVU5UU19MRUZUX0ZPUk1BVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5jb3VudHMubGVmdEZvcm1hdDsKY29uc3QgU1RSX0ZMQUdfQ09VTlRTX1JJR0hUX0ZPUk1BVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5jb3VudHMucmlnaHRGb3JtYXQ7CmNvbnN0IFNUUl9GTEFHX1BST0dSRVNTX0ZPUk1BVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5wcm9ncmVzcy5mb3JtYXQ7CmNvbnN0IFNUUl9GTEFHX1ZFSElDTEVfUkVRVUlSRUQgPSBtb2Quc3RyaW5na2V5cy50d2wuZmxhZ0NhcHR1cmUudmVoaWNsZVJlcXVpcmVkOwpjb25zdCBTVFJfRkxBR19QUkVWSUVXX0FDVElWRSA9IG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5wcmV2aWV3QWN0aXZlRm9ybWF0OwovLyBXb3JsZEljb24gdGV4dCBwbGFjZWhvbGRlcnMgbXVzdCBiZSBzdHJpbmcga2V5cywgbm90IHJhdyBsZXR0ZXJzLgpjb25zdCBTVFJfRkxBR19MRVRURVJfVU5LTk9XTiA9IG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5sZXR0ZXJzLnVua25vd247CmNvbnN0IFNUUl9GTEFHX0xFVFRFUl9LRVlTOiBudW1iZXJbXSA9IFsKICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5sZXR0ZXJzLkEsCiAgICBtb2Quc3RyaW5na2V5cy50d2wuZmxhZ0NhcHR1cmUubGV0dGVycy5CLAogICAgbW9kLnN0cmluZ2tleXMudHdsLmZsYWdDYXB0dXJlLmxldHRlcnMuQywKICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5sZXR0ZXJzLkQsCiAgICBtb2Quc3RyaW5na2V5cy50d2wuZmxhZ0NhcHR1cmUubGV0dGVycy5FLAogICAgbW9kLnN0cmluZ2tleXMudHdsLmZsYWdDYXB0dXJlLmxldHRlcnMuRiwKICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5mbGFnQ2FwdHVyZS5sZXR0ZXJzLkcsCiAgICBtb2Quc3RyaW5na2V5cy50d2wuZmxhZ0NhcHR1cmUubGV0dGVycy5ILApdOwpjb25zdCBTVFJfREVCVUdfQ1BfVklTX1JFU0VUID0gbW9kLnN0cmluZ2tleXMudHdsLmRlYnVnLmNwVmlzUmVzZXQ7CmNvbnN0IFNUUl9ERUJVR19DUF9WSVNfSEFSRF9SRVNFVCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5kZWJ1Zy5jcFZpc0hhcmRSZXNldDsKY29uc3QgU1RSX1JPVU5EX1NUQVJUX1RJVExFID0gbW9kLnN0cmluZ2tleXMudHdsLnJvdW5kU3RhcnQudGl0bGU7CmNvbnN0IFNUUl9ST1VORF9TVEFSVF9TVUJUSVRMRSA9IG1vZC5zdHJpbmdrZXlzLnR3bC5yb3VuZFN0YXJ0LnN1YnRpdGxlOwpjb25zdCBTVFJfUk9VTkRfRU5EX0RFVEFJTF9XSU5fRUxJTUlOQVRJT04gPSBtb2Quc3RyaW5na2V5cy50d2wucm91bmRFbmQuZGV0YWlsLndpbkVsaW1pbmF0aW9uOwpjb25zdCBTVFJfUk9VTkRfRU5EX0RFVEFJTF9MT1NFX0VMSU1JTkFUSU9OID0gbW9kLnN0cmluZ2tleXMudHdsLnJvdW5kRW5kLmRldGFpbC5sb3NlRWxpbWluYXRpb247CmNvbnN0IFNUUl9ST1VORF9FTkRfREVUQUlMX1dJTl9PQkpFQ1RJVkVfQ0FQVFVSRUQgPSBtb2Quc3RyaW5na2V5cy50d2wucm91bmRFbmQuZGV0YWlsLndpbk9iamVjdGl2ZUNhcHR1cmVkOwpjb25zdCBTVFJfUk9VTkRfRU5EX0RFVEFJTF9MT1NFX09CSkVDVElWRV9DQVBUVVJFRCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5yb3VuZEVuZC5kZXRhaWwubG9zZU9iamVjdGl2ZUNhcHR1cmVkOwpjb25zdCBTVFJfUk9VTkRfRU5EX0RFVEFJTF9XSU5fT0JKRUNUSVZFX1BST0dSRVNTID0gbW9kLnN0cmluZ2tleXMudHdsLnJvdW5kRW5kLmRldGFpbC53aW5PYmplY3RpdmVQcm9ncmVzczsKY29uc3QgU1RSX1JPVU5EX0VORF9ERVRBSUxfTE9TRV9PQkpFQ1RJVkVfUFJPR1JFU1MgPSBtb2Quc3RyaW5na2V5cy50d2wucm91bmRFbmQuZGV0YWlsLmxvc2VPYmplY3RpdmVQcm9ncmVzczsKY29uc3QgU1RSX1JPVU5EX0VORF9ERVRBSUxfV0lOX1RJTUVfT1ZFUl9LSUxMUyA9IG1vZC5zdHJpbmdrZXlzLnR3bC5yb3VuZEVuZC5kZXRhaWwud2luVGltZU92ZXJLaWxsczsKY29uc3QgU1RSX1JPVU5EX0VORF9ERVRBSUxfTE9TRV9USU1FX09WRVJfS0lMTFMgPSBtb2Quc3RyaW5na2V5cy50d2wucm91bmRFbmQuZGV0YWlsLmxvc2VUaW1lT3ZlcktpbGxzOwpjb25zdCBTVFJfUk9VTkRfRU5EX0RFVEFJTF9EUkFXX0VWRU5fRUxJTVMgPSBtb2Quc3RyaW5na2V5cy50d2wucm91bmRFbmQuZGV0YWlsLmRyYXdFdmVuRWxpbXM7CmNvbnN0IFNUUl9ST1VORF9FTkRfREVUQUlMX0RSQVdfTk9fQUNUSU9OID0gbW9kLnN0cmluZ2tleXMudHdsLnJvdW5kRW5kLmRldGFpbC5kcmF3Tm9BY3Rpb247CgovLyBTaGFyZWQgZ2xvYmFsIG1lc3NhZ2UgbGF5b3V0IChPdmVyTGluZSArIHJvdW5kIHN0YXJ0ICsgb3ZlcnRpbWUgYW5ub3VuY2VtZW50cykuCmNvbnN0IEJJR19USVRMRV9TSVpFID0gOTY7IC8vIEZvbnQgc2l6ZSBpbiBVSSBzY2FsZSB1bml0cy4KY29uc3QgQklHX1NVQlRJVExFX1NJWkUgPSAyODsKY29uc3QgQklHX1RJVExFX09GRlNFVF9ZID0gMTYwOyAvLyBQb3NpdGlvbiBiZWxvdyB0b3AgSFVELgpjb25zdCBCSUdfU1VCVElUTEVfT0ZGU0VUX1kgPSAzMDA7IC8vIFN1YnRpdGxlIHBvc2l0aW9uCmNvbnN0IEJJR19NRVNTQUdFX0JHX0FMUEhBID0gMC42Owpjb25zdCBCSUdfVElUTEVfQkdfV0lEVEggPSAyNTAwOwpjb25zdCBCSUdfVElUTEVfQkdfSEVJR0hUID0gMTQwOwpjb25zdCBCSUdfU1VCVElUTEVfQkdfV0lEVEggPSAyNTAwOwpjb25zdCBCSUdfU1VCVElUTEVfQkdfSEVJR0hUID0gODA7CmNvbnN0IFNNQUxMX1RJVExFX0JHX0hFSUdIVCA9IDQwOwpjb25zdCBTTUFMTF9USVRMRV9TSVpFID0gMjg7IC8vIH4xLzQgb2YgYmlnIHRpdGxlIHNpemUuCmNvbnN0IFNNQUxMX1NVQlRJVExFX1NJWkUgPSAxNTsgLy8gfjEvNCBvZiBiaWcgc3VidGl0bGUgc2l6ZS4KY29uc3QgU01BTExfVElUTEVfT0ZGU0VUX1kgPSAyMTA7CmNvbnN0IFNNQUxMX1NVQlRJVExFX09GRlNFVF9ZID0gMjYwOwpjb25zdCBCSUdfTUVTU0FHRV9EVVJBVElPTl9TRUNPTkRTID0gNS41OyAvLyBEdXJhdGlvbiBpbiBzZWNvbmRzLgoKdHlwZSBHbG9iYWxNZXNzYWdlTGF5b3V0ID0gewogICAgdGl0bGVTaXplOiBudW1iZXI7CiAgICBzdWJ0aXRsZVNpemU6IG51bWJlcjsKICAgIHRpdGxlT2Zmc2V0WTogbnVtYmVyOwogICAgc3VidGl0bGVPZmZzZXRZOiBudW1iZXI7CiAgICB0aXRsZUJnSGVpZ2h0PzogbnVtYmVyOwogICAgdXNlQmFja2dyb3VuZD86IGJvb2xlYW47CiAgICBzdWJ0aXRsZVVzZUJhY2tncm91bmQ/OiBib29sZWFuOwp9OwoKY29uc3QgQklHX01FU1NBR0VfTEFZT1VUOiBHbG9iYWxNZXNzYWdlTGF5b3V0ID0gewogICAgdGl0bGVTaXplOiBCSUdfVElUTEVfU0laRSwKICAgIHN1YnRpdGxlU2l6ZTogQklHX1NVQlRJVExFX1NJWkUsCiAgICB0aXRsZU9mZnNldFk6IEJJR19USVRMRV9PRkZTRVRfWSwKICAgIHN1YnRpdGxlT2Zmc2V0WTogQklHX1NVQlRJVExFX09GRlNFVF9ZLAogICAgdXNlQmFja2dyb3VuZDogdHJ1ZSwKfTsKCmNvbnN0IFNNQUxMX01FU1NBR0VfTEFZT1VUOiBHbG9iYWxNZXNzYWdlTGF5b3V0ID0gewogICAgdGl0bGVTaXplOiBTTUFMTF9USVRMRV9TSVpFLAogICAgc3VidGl0bGVTaXplOiBTTUFMTF9TVUJUSVRMRV9TSVpFLAogICAgdGl0bGVPZmZzZXRZOiBTTUFMTF9USVRMRV9PRkZTRVRfWSwKICAgIHN1YnRpdGxlT2Zmc2V0WTogU01BTExfU1VCVElUTEVfT0ZGU0VUX1ksCiAgICB0aXRsZUJnSGVpZ2h0OiBTTUFMTF9USVRMRV9CR19IRUlHSFQsCiAgICB1c2VCYWNrZ3JvdW5kOiB0cnVlLAogICAgc3VidGl0bGVVc2VCYWNrZ3JvdW5kOiB0cnVlLAp9OwoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIENvbnN0YW50cywgRW51bXMgYW5kIFR5cGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBNYXAgQ29uZmlnIChDb25zdGFudHMgKyBUeXBlcykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIFN1cHBvcnQgbWFwcyBmb3IgdGhpcyBnYW1lbW9kZSwgc2hvdWxkIGhhdmUgYSBsaXN0aW5nIGluIE1hcEtleSwgYW5kIGEgY29ycmVzcG9uZGluZyBsaXN0IG9mIHNwYXduZXJzIGluIE1hcENvbmZpZwp0eXBlIE1hcEtleSA9ICJCbGFja3dlbGxfRmllbGRzIiB8ICJEZWZlbnNlX05leHVzIiB8ICJHb2xmX0NvdXJzZSIgfCAiTWlyYWtfVmFsbGV5IiB8ICJPcGVyYXRpb25fRmlyZXN0b3JtIiB8ICJMaWJlcmF0aW9uX1BlYWsiIHwgIk1hbmhhdHRhbl9CcmlkZ2UiIHwgIlNvYmVrX0NpdHkiIHwgIkFyZWFfMjJCIjsKCi8vIHNsb3ROdW1iZXIgZGVmaW5lcyB0aGUgZXhwbGljaXQgc3Bhd24gcHJpb3JpdHkgcGVyIHRlYW0gKHVzZWQgZm9yIDF2MS8ydjIvM3YzLzR2NCBlbmFibGVtZW50KS4KdHlwZSBWZWhpY2xlU3Bhd25TcGVjID0geyBzbG90TnVtYmVyOiBudW1iZXI7IHBvczogbW9kLlZlY3Rvcjsgcm90OiBtb2QuVmVjdG9yOyB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QgfTsKCi8vIE92ZXJ0aW1lIHpvbmVzIGFyZSBjdXN0b20gY2FwdHVyZSBhcmVhcyBhbmNob3JlZCBieSBBcmVhVHJpZ2dlcnMgKyBTZWN0b3JzICsgV29ybGRJY29uICsgQ2FwdHVyZVBvaW50IG9iamVjdHMuCnR5cGUgT3ZlcnRpbWVab25lU3BlYyA9IHsgYXJlYVRyaWdnZXJPYmpJZDogbnVtYmVyOyBzZWN0b3JJZDogbnVtYmVyOyB3b3JsZEljb25PYmpJZDogbnVtYmVyOyBjYXB0dXJlUG9pbnRPYmpJZDogbnVtYmVyIH07CnR5cGUgT3ZlcnRpbWVab25lQ2FuZGlkYXRlID0gT3ZlcnRpbWVab25lU3BlYyAmIHsgbGV0dGVySW5kZXg6IG51bWJlciB9Owp0eXBlIE92ZXJ0aW1lWm9uZUxldHRlcnNCeU1vZGUgPSB7IHRhbmtzPzogc3RyaW5nW107IGhlbGlzPzogc3RyaW5nW10gfTsKCi8vIEV2ZXJ5IG1hcCBuZWVkcyBhIHRlYW0gMSBhbmQgdGVhbSAyIEhRIG9iamVjdCBpbiB0aGUgc3BhdGlhbCBkYXRhLCBzbyB0aGlzIGxpc3Qgb2YgdmVoaWNsZXMgY2FuIHNwYXduIGFuZCBkeW5hbWljYWxseSBnZXQgcmVmZXJlbmNlZCBvbiBtYXAgbG9hZAp0eXBlIE1hcENvbmZpZyA9IHsKICAgIHRlYW0xQmFzZTogbW9kLlZlY3RvcjsKICAgIHRlYW0yQmFzZTogbW9kLlZlY3RvcjsKICAgIHRlYW0xTmFtZTogbnVtYmVyOwogICAgdGVhbTJOYW1lOiBudW1iZXI7CiAgICBhaXJjcmFmdENlaWxpbmc6IG51bWJlcjsKICAgIGh1ZE1heFk6IG51bWJlcjsgLy8gSFVEIGFsdGl0dWRlIGF0IHRoZSB2YW5pbGxhIGhhcmQgY2VpbGluZyBmb3IgdGhpcyBtYXAuCiAgICBodWRGbG9vclk6IG51bWJlcjsgLy8gV29ybGQgWSB3aGVyZSBhaXJjcmFmdCBIVUQgcmVhZHMgMCBvbiB0aGlzIG1hcC4KICAgIHVzZUN1c3RvbUNlaWxpbmc6IGJvb2xlYW47IC8vIFdoZW4gdHJ1ZSwgTGFkZGVyIG1vZGUgYXBwbGllcyBjdXN0b20gY2VpbGluZyBvbiB0aGlzIG1hcC4KICAgIHRlYW0xVGFua1NwYXduczogVmVoaWNsZVNwYXduU3BlY1tdOwogICAgdGVhbTJUYW5rU3Bhd25zOiBWZWhpY2xlU3Bhd25TcGVjW107CiAgICB0ZWFtMUhlbGlTcGF3bnM/OiBWZWhpY2xlU3Bhd25TcGVjW107CiAgICB0ZWFtMkhlbGlTcGF3bnM/OiBWZWhpY2xlU3Bhd25TcGVjW107CiAgICB2ZWhpY2xlU3Bhd25ZYXdPZmZzZXREZWc6IG51bWJlcjsgLy9UaGlzIGlzIG5vdCB1c2VkIGFueW1vcmUsIGJ1dCB3ZSdyZSBrZWVwaW5nIGl0IGluIGNhc2UgaXRzIG5lZWRlZCBpbiB0aGUgZnV0dXJlCiAgICAvLyBPcHRpb25hbCBwZXItbWFwIG92ZXJ0aW1lIHpvbmUgbGlzdCAoQXJlYVRyaWdnZXIgT2JqSWQgKyBTZWN0b3IgSWQgKyBXb3JsZEljb24gT2JqSWQgKyBDYXB0dXJlUG9pbnQgT2JqSWQpLgogICAgLy8gRW1wdHkvdW5kZWZpbmVkIGRpc2FibGVzIG92ZXJ0aW1lIG9uIHRoYXQgbWFwLgogICAgb3ZlcnRpbWVab25lcz86IE92ZXJ0aW1lWm9uZVNwZWNbXTsKICAgIG92ZXJ0aW1lWm9uZUxldHRlcnNCeU1vZGU/OiBPdmVydGltZVpvbmVMZXR0ZXJzQnlNb2RlOwp9OwoKLy8gQ2hhbmdlIHRoaXMgTWFwS2V5IHRvIHN3aXRjaCBhY3RpdmUgbWFwIGNvbmZpZ3VyYXRpb24gZm9yIHRoYXQgbWFwLCBvbmx5IG9uZSBtYXAgY2FuIGJlIGFjdGl2ZSBhdCBhIHRpbWUhIFRoaXMgaGFwcGVucyBpbnNpZGUgZ2V0TWFwTmFtZUtleSAmIGFwcGx5TWFwQ29uZmlnCmxldCBBQ1RJVkVfTUFQX0tFWTogTWFwS2V5ID0gIkJsYWNrd2VsbF9GaWVsZHMiOyAvL05lZWQgdG8gcGljayBvbmUgdG8gYmUgZGVmYXVsdAoKLy8gTWFwLXNwZWNpZmljIGJhc2VzICsgc3Bhd24gc2xvdHMuIEtlZXAgc2xvdE51bWJlciB1bmlxdWUgd2l0aGluIGEgdGVhbTsgU2xvdHMgYXJlIHBhcmFsbGVsLCBlLmcuIFNsb3QgMiBvbiBUZWFtIDEgYW5kIFNsb3QgMiBvbiBUZWFtIDIgLSBib3RoIHZlaGljbGVzIHNwYXduIGluIHdoZW4gdGhlIDJ2MiBtb2RlIGlzIHRvZ2dsZWQKY29uc3QgTUFQX0NPTkZJR1M6IFJlY29yZDxNYXBLZXksIE1hcENvbmZpZz4gPSB7CgogICAgLy9CYWRsYW5kcwogICAgQmxhY2t3ZWxsX0ZpZWxkczogeyAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAKICAgICAgICB0ZWFtMUJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoLTE1MS4zNjQsICA4Ni45NDgsICAtNTY3LjY3MiksIHRlYW0xTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLldFU1QsCiAgICAgICAgdGVhbTJCYXNlOiBtb2QuQ3JlYXRlVmVjdG9yKCAzODguMjMxLCAgNzEuNjUyLCAgIDEzNi41NCksICB0ZWFtMk5hbWU6IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5FQVNULAogICAgICAgIGFpcmNyYWZ0Q2VpbGluZzogNjUwLAogICAgICAgIGh1ZE1heFk6IDY1MCwKICAgICAgICBodWRGbG9vclk6IDgyLAogICAgICAgIHVzZUN1c3RvbUNlaWxpbmc6IGZhbHNlLAogICAgICAgIC8vIE9iaklkIHBhdHRlcm4gcGVyIHpvbmU6IEFyZWFUcmlnZ2VyIDIwMCssIFNlY3RvciAzMDArLCBXb3JsZEljb24gNDAwKywgQ2FwdHVyZVBvaW50IDYwMCsuCiAgICAgICAgb3ZlcnRpbWVab25lczogWwogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMCwgc2VjdG9ySWQ6IDMwMCwgd29ybGRJY29uT2JqSWQ6IDQwMCwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMCB9LCAvLyBBCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAxLCBzZWN0b3JJZDogMzAxLCB3b3JsZEljb25PYmpJZDogNDAxLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAxIH0sIC8vIEIKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDIsIHNlY3RvcklkOiAzMDIsIHdvcmxkSWNvbk9iaklkOiA0MDIsIGNhcHR1cmVQb2ludE9iaklkOiA2MDIgfSwgLy8gQwogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMywgc2VjdG9ySWQ6IDMwMywgd29ybGRJY29uT2JqSWQ6IDQwMywgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMyB9LCAvLyBECiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA0LCBzZWN0b3JJZDogMzA0LCB3b3JsZEljb25PYmpJZDogNDA0LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA0IH0sIC8vIEUKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDUsIHNlY3RvcklkOiAzMDUsIHdvcmxkSWNvbk9iaklkOiA0MDUsIGNhcHR1cmVQb2ludE9iaklkOiA2MDUgfSwgLy8gRgogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNiwgc2VjdG9ySWQ6IDMwNiwgd29ybGRJY29uT2JqSWQ6IDQwNiwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNiB9LCAvLyBHCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA3LCBzZWN0b3JJZDogMzA3LCB3b3JsZEljb25PYmpJZDogNDA3LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA3IH0sIC8vIEgKICAgICAgICBdLAogICAgICAgIG92ZXJ0aW1lWm9uZUxldHRlcnNCeU1vZGU6IHsKICAgICAgICAgICAgdGFua3M6IE9WRVJUSU1FX1RBTktfWk9ORV9MRVRURVJTLAogICAgICAgICAgICBoZWxpczogT1ZFUlRJTUVfSEVMSV9aT05FX0xFVFRFUlMsCiAgICAgICAgfSwKICAgICAgIAogICAgICAgIHZlaGljbGVTcGF3bllhd09mZnNldERlZzogMCwKCiAgICAgICAgdGVhbTFUYW5rU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1ggICAgICBwb3NZICAgICAgcG9zWgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMTYzLjI4NSwgIDg2Ljk2LCAgIC01NzAuMjU0KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNDUuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BYnJhbXMgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTE2OS41NTksICA4Ni45MTUsICAtNTYwLjE2OCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDQ1LjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0xNzguMTc0LCAgODcuMTU5LCAgLTU1MS4yMDYpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA0NS4wLCAgICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMTg1LjgzMywgIDg3LjE1OSwgIC01NDAuOTQ5KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNDUuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICBdLAogICAgICAgIHRlYW0yVGFua1NwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NYICAgICAgcG9zWSAgICAgIHBvc1oKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDQwMy41NzUsICA3MS4yMjcsICAgMTQ0LjU5NCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTkwLjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTGVvcGFyZCAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA0MDQuMDU0LCAgNzEuMjI3LCAgIDEzMS45NjYpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC05MC4wLCAgICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNDAzLjU3NSwgIDcxLjIyNywgICAxMTguNTcxKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtOTAuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDQwMy4yNzQsICA3MS4yMjcsICAgMTA1Ljg4NiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTkwLjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgXSwKICAgIH0sCgogICAgLy9HcmFuaXRlX1RlY2hDYW1wdXMKICAgIERlZmVuc2VfTmV4dXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAKICAgICAgICB0ZWFtMUJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoLTE1MS4wODYyLCAxMzMuNjk0LCAgNDI4LjAxOCksIHRlYW0xTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLlNPVVRILAogICAgICAgIHRlYW0yQmFzZTogbW9kLkNyZWF0ZVZlY3RvcigtMTA3LjcyNywgIDEzOS4yOTMsICAxMjMuMjQ4KSwgdGVhbTJOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuTk9SVEgsCiAgICAgICAgYWlyY3JhZnRDZWlsaW5nOiA2NTAsCiAgICAgICAgaHVkTWF4WTogNjUwLAogICAgICAgIGh1ZEZsb29yWTogODIsCiAgICAgICAgdXNlQ3VzdG9tQ2VpbGluZzogZmFsc2UsCiAgICAgICAgLy8gT2JqSWQgcGF0dGVybiBwZXIgem9uZTogQXJlYVRyaWdnZXIgMjAwKywgU2VjdG9yIDMwMCssIFdvcmxkSWNvbiA0MDArLCBDYXB0dXJlUG9pbnQgNjAwKy4KICAgICAgICBvdmVydGltZVpvbmVzOiBbCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAwLCBzZWN0b3JJZDogMzAwLCB3b3JsZEljb25PYmpJZDogNDAwLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAwIH0sIC8vIEEKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDEsIHNlY3RvcklkOiAzMDEsIHdvcmxkSWNvbk9iaklkOiA0MDEsIGNhcHR1cmVQb2ludE9iaklkOiA2MDEgfSwgLy8gQgogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMiwgc2VjdG9ySWQ6IDMwMiwgd29ybGRJY29uT2JqSWQ6IDQwMiwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMiB9LCAvLyBDCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAzLCBzZWN0b3JJZDogMzAzLCB3b3JsZEljb25PYmpJZDogNDAzLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAzIH0sIC8vIEQKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDQsIHNlY3RvcklkOiAzMDQsIHdvcmxkSWNvbk9iaklkOiA0MDQsIGNhcHR1cmVQb2ludE9iaklkOiA2MDQgfSwgLy8gRQogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNSwgc2VjdG9ySWQ6IDMwNSwgd29ybGRJY29uT2JqSWQ6IDQwNSwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNSB9LCAvLyBGCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA2LCBzZWN0b3JJZDogMzA2LCB3b3JsZEljb25PYmpJZDogNDA2LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA2IH0sIC8vIEcKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDcsIHNlY3RvcklkOiAzMDcsIHdvcmxkSWNvbk9iaklkOiA0MDcsIGNhcHR1cmVQb2ludE9iaklkOiA2MDcgfSwgLy8gSAogICAgICAgIF0sCiAgICAgICAgb3ZlcnRpbWVab25lTGV0dGVyc0J5TW9kZTogewogICAgICAgICAgICB0YW5rczogT1ZFUlRJTUVfVEFOS19aT05FX0xFVFRFUlMsCiAgICAgICAgICAgIGhlbGlzOiBPVkVSVElNRV9IRUxJX1pPTkVfTEVUVEVSUywKICAgICAgICB9LAogICAgCiAgICAgICAgdmVoaWNsZVNwYXduWWF3T2Zmc2V0RGVnOiAwLCAKCiAgICAgICAgdGVhbTFUYW5rU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdFggICAgICByb3RZICAgICAgcm90WgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMTg1LjUwMywgIDEzNi41OTYsICA0NTQuNjE3KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTY1LjgzNCwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTE3OS4xMDksICAxMzYuMTQ2LCAgNDUzLjMyNyksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTE1OC41MjYsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTTJCcmFkbGV5ICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0xNzQuMTcyLCAgMTM1LjE0MCwgIDQ0OS4zODApLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xNDkuMjU2LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMTY4LjI5MywgIDEzNC4wNjcsICA0NDIuOTM1KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTM1LjQ0MiwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICBdLAogICAgICAgIHRlYW0yVGFua1NwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NYICAgICAgcG9zWSAgICAgIHBvc1oKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTEwOC44MjQsICAxMzguODE1LCAgMTEyLjIwOSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTQ0Ljk4NCwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0xMDQuMTUzLCAgMTM4LjUzMCwgIDExNS4wMzQpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC00NC43MTcsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkNWOTAgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMTAxLjM3OCwgIDEzOC41NDQsICAxMTkuMjYzKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtNDQuODA2LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTExNi41NjYsICAxMzguODUyLCAgMTA0LjE3NSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTQ0Ljg5NSwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgXSwKICAgIH0sCgogICAgLy9HcmFuaXRlX0NsdWJIb3VzZQogICAgR29sZl9Db3Vyc2U6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgIHBvc1kgICAgICBwb3NaIAogICAgICAgIHRlYW0xQmFzZTogbW9kLkNyZWF0ZVZlY3RvcigtNzY0LjUwOCwgMTQ2LjY5NiwgLTg1Ni4xOTMpLCB0ZWFtMU5hbWU6IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5OT1JUSCwKICAgICAgICB0ZWFtMkJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoLTcyNC43NjksIDE0MS4zMTcsIC0yNzEuNjUzKSwgdGVhbTJOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuU09VVEgsCiAgICAgICAgYWlyY3JhZnRDZWlsaW5nOiA2NTAsCiAgICAgICAgaHVkTWF4WTogNjUwLAogICAgICAgIGh1ZEZsb29yWTogODIsCiAgICAgICAgdXNlQ3VzdG9tQ2VpbGluZzogZmFsc2UsCiAgICAgICAgLy8gT2JqSWQgcGF0dGVybiBwZXIgem9uZTogQXJlYVRyaWdnZXIgMjAwKywgU2VjdG9yIDMwMCssIFdvcmxkSWNvbiA0MDArLCBDYXB0dXJlUG9pbnQgNjAwKy4KICAgICAgICBvdmVydGltZVpvbmVzOiBbCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAwLCBzZWN0b3JJZDogMzAwLCB3b3JsZEljb25PYmpJZDogNDAwLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAwIH0sIC8vIEEKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDEsIHNlY3RvcklkOiAzMDEsIHdvcmxkSWNvbk9iaklkOiA0MDEsIGNhcHR1cmVQb2ludE9iaklkOiA2MDEgfSwgLy8gQgogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMiwgc2VjdG9ySWQ6IDMwMiwgd29ybGRJY29uT2JqSWQ6IDQwMiwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMiB9LCAvLyBDCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAzLCBzZWN0b3JJZDogMzAzLCB3b3JsZEljb25PYmpJZDogNDAzLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAzIH0sIC8vIEQKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDQsIHNlY3RvcklkOiAzMDQsIHdvcmxkSWNvbk9iaklkOiA0MDQsIGNhcHR1cmVQb2ludE9iaklkOiA2MDQgfSwgLy8gRQogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNSwgc2VjdG9ySWQ6IDMwNSwgd29ybGRJY29uT2JqSWQ6IDQwNSwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNSB9LCAvLyBGCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA2LCBzZWN0b3JJZDogMzA2LCB3b3JsZEljb25PYmpJZDogNDA2LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA2IH0sIC8vIEcKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDcsIHNlY3RvcklkOiAzMDcsIHdvcmxkSWNvbk9iaklkOiA0MDcsIGNhcHR1cmVQb2ludE9iaklkOiA2MDcgfSwgLy8gSAogICAgICAgIF0sCiAgICAgICAgb3ZlcnRpbWVab25lTGV0dGVyc0J5TW9kZTogewogICAgICAgICAgICB0YW5rczogT1ZFUlRJTUVfVEFOS19aT05FX0xFVFRFUlMsCiAgICAgICAgICAgIGhlbGlzOiBPVkVSVElNRV9IRUxJX1pPTkVfTEVUVEVSUywKICAgICAgICB9LAogICAgICAgIAogICAgICAgIHZlaGljbGVTcGF3bllhd09mZnNldERlZzogMCwKCiAgICAgICAgdGVhbTFUYW5rU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdFggICAgICByb3RZICAgICAgcm90WgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNzY1LjAzMiwgIDE0Ni4wNjgsIC04NjMuMzA3KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMjEuOTA4LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTc1OC4zOTgsICAxNDYuNTI0LCAtODYxLjg5MCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDkuMjg3LCAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTTJCcmFkbGV5ICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC03NTEuMjM0LCAgMTQ3LjM3MywgLTg1OS4wMDkpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxMC4wMDAsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNzQxLjc3OSwgIDE0OC45MTksIC04NTYuNzUxKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMjAuMDAwLCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICBdLAogICAgICAgIHRlYW0yVGFua1NwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NYICAgICAgcG9zWSAgICAgIHBvc1oKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTcyMi44MDAsICAxNDAuOTk3LCAtMjc1Ljk4MCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDEzOC4zNTcsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC03MTYuMDQ1LCAgMTQwLjU1NSwgLTI3MC4yMTkpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxMzguMzU3LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkNWOTAgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNzA5LjMyNywgIDE0MC42ODAsIC0yNjQuOTY4KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTM4LjE3OSwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTcwMi4wODAsICAxNDAuNjI1LCAtMjU5Ljc3MiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDEzOS4yNDgsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgXSwKICAgIH0sCgogICAgLy9UdW5nc3RlbgogICAgTWlyYWtfVmFsbGV5OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogCiAgICAgICAgdGVhbTFCYXNlOiBtb2QuQ3JlYXRlVmVjdG9yKC01MDUuNjQxLCAgODIuNTcxLCAgLTMyOS4wMzQpLCB0ZWFtMU5hbWU6IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5XRVNULAogICAgICAgIHRlYW0yQmFzZTogbW9kLkNyZWF0ZVZlY3RvciggNDI4LjMyLCAgIDg1LjIxNSwgIC02MTkuMzM5KSwgdGVhbTJOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuRUFTVCwKICAgICAgICBhaXJjcmFmdENlaWxpbmc6IDExMCwKICAgICAgICBodWRNYXhZOiA2MzUsCiAgICAgICAgaHVkRmxvb3JZOiA4MiwKICAgICAgICB1c2VDdXN0b21DZWlsaW5nOiB0cnVlLAogICAgICAgIC8vIE9iaklkIHBhdHRlcm4gcGVyIHpvbmU6IEFyZWFUcmlnZ2VyIDIwMCssIFNlY3RvciAzMDArLCBXb3JsZEljb24gNDAwKywgQ2FwdHVyZVBvaW50IDYwMCsuCiAgICAgICAgb3ZlcnRpbWVab25lczogWwogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMCwgc2VjdG9ySWQ6IDMwMCwgd29ybGRJY29uT2JqSWQ6IDQwMCwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMCB9LCAvLyBBCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAxLCBzZWN0b3JJZDogMzAxLCB3b3JsZEljb25PYmpJZDogNDAxLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAxIH0sIC8vIEIKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDIsIHNlY3RvcklkOiAzMDIsIHdvcmxkSWNvbk9iaklkOiA0MDIsIGNhcHR1cmVQb2ludE9iaklkOiA2MDIgfSwgLy8gQwogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMywgc2VjdG9ySWQ6IDMwMywgd29ybGRJY29uT2JqSWQ6IDQwMywgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMyB9LCAvLyBECiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA0LCBzZWN0b3JJZDogMzA0LCB3b3JsZEljb25PYmpJZDogNDA0LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA0IH0sIC8vIEUKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDUsIHNlY3RvcklkOiAzMDUsIHdvcmxkSWNvbk9iaklkOiA0MDUsIGNhcHR1cmVQb2ludE9iaklkOiA2MDUgfSwgLy8gRgogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNiwgc2VjdG9ySWQ6IDMwNiwgd29ybGRJY29uT2JqSWQ6IDQwNiwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNiB9LCAvLyBHCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA3LCBzZWN0b3JJZDogMzA3LCB3b3JsZEljb25PYmpJZDogNDA3LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA3IH0sIC8vIEgKICAgICAgICBdLAogICAgICAgIG92ZXJ0aW1lWm9uZUxldHRlcnNCeU1vZGU6IHsKICAgICAgICAgICAgdGFua3M6IE9WRVJUSU1FX1RBTktfWk9ORV9MRVRURVJTLAogICAgICAgICAgICBoZWxpczogT1ZFUlRJTUVfSEVMSV9aT05FX0xFVFRFUlMsCiAgICAgICAgfSwKICAgICAgIAogICAgICAgIHZlaGljbGVTcGF3bllhd09mZnNldERlZzogMCwKCiAgICAgICAgdGVhbTFUYW5rU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdFggICAgICByb3RZICAgICAgcm90WgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNDk3LjMyOCwgIDgxLjkwOSwgIC0zMjAuMDU4KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgOTAuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BYnJhbXMgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTQ5My42OTksICA4Mi4xNjcsICAtMzMwLjYxNiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDg3LjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC00ODguODY5LCAgODIuNTU2LCAgLTM0MC43MjMpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA4NS4wLCAgICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNDg1LjMzNSwgIDgzLjI0NCwgIC0zNTEuMzI3KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgODQuNTAwLCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BYnJhbXMgICAgICAgfSwKICAgICAgICBdLAogICAgICAgIHRlYW0yVGFua1NwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NYICAgICAgcG9zWSAgICAgIHBvc1oKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDQyMy4xNTUsICA4NS4xNjAsICAtNjA5LjU5MyksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTQxLjIxMiwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTGVvcGFyZCAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA0MTIuNDE2LCAgODUuNDQyLCAgLTYxMC4wNDQpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC00NS41ODAsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNDAwLjM5NiwgIDg1Ljc3NSwgIC02MTAuNTc2KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtNDcuNzE5LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5DVjkwICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDM4OC42NjcsICA4Ni4wODUsICAtNjExLjU5NiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTQ0Ljk1NiwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTGVvcGFyZCAgICAgIH0sCiAgICAgICAgXSwKICAgICAgICB0ZWFtMUhlbGlTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90WCAgICAgIHJvdFkgICAgICByb3RaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC01MDAuMDE5LCAgODEuMjU3LCAgLTI5Mi44OTkpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA5OC40MDQsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFINjQgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNDk4LjA1NSwgIDgyLjIyMiwgIC0zMjguNTI3KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNTAuNjM0LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5FdXJvY29wdGVyICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTUxMi44ODMsICA4MC43MTMsICAtMjY5LjcyOCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDYxLjk2NywgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQUg2NCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC00ODEuMjY3LCAgODIuNzYxLCAgLTM0NS4xNzgpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAyOS4zMTIsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LlVINjAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgICAgdGVhbTJIZWxpU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1ggICAgICBwb3NZICAgICAgcG9zWgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNDU0Ljk2OCwgIDg0LjMwNiwgIC02MTIuNDk1KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtNC43ODAsICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BSDY0ICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDQ2MS43NDYsICA4My44OTgsICAtNTg1LjkwMiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTE1Ny40NTIsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuRXVyb2NvcHRlciAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA0OTYuMjUzLCAgODMuMTczLCAgLTYwMC43MTEpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC05MC4yNTEsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFINjQgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNDI3LjIxMywgIDg1LjIzOSwgIC01ODcuNjkxKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtOTIuMjEyLCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5VSDYwX1BheCAgICAgfSwKICAgICAgICBdLAogICAgfSwKCiAgICAvL0ZpcmVzdG9ybQogICAgT3BlcmF0aW9uX0ZpcmVzdG9ybTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaIAogICAgICAgIHRlYW0xQmFzZTogbW9kLkNyZWF0ZVZlY3RvciggNTcwLjY5MiwgIDExMC4yMDUsIC0yMzIuMzQxKSwgdGVhbTFOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuV0VTVCwKICAgICAgICB0ZWFtMkJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoLTc2MS44NjksICAxMzMuMDkxLCAgMjIzLjAzOCksIHRlYW0yTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLkVBU1QsCiAgICAgICAgYWlyY3JhZnRDZWlsaW5nOiAxMzAsCiAgICAgICAgaHVkTWF4WTogNzM1LAogICAgICAgIGh1ZEZsb29yWTogMTMyLAogICAgICAgIHVzZUN1c3RvbUNlaWxpbmc6IHRydWUsCiAgICAgICAgLy8gT2JqSWQgcGF0dGVybiBwZXIgem9uZTogQXJlYVRyaWdnZXIgMjAwKywgU2VjdG9yIDMwMCssIFdvcmxkSWNvbiA0MDArLCBDYXB0dXJlUG9pbnQgNjAwKy4KICAgICAgICBvdmVydGltZVpvbmVzOiBbCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAwLCBzZWN0b3JJZDogMzAwLCB3b3JsZEljb25PYmpJZDogNDAwLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAwIH0sIC8vIEEKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDEsIHNlY3RvcklkOiAzMDEsIHdvcmxkSWNvbk9iaklkOiA0MDEsIGNhcHR1cmVQb2ludE9iaklkOiA2MDEgfSwgLy8gQgogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMiwgc2VjdG9ySWQ6IDMwMiwgd29ybGRJY29uT2JqSWQ6IDQwMiwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMiB9LCAvLyBDCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAzLCBzZWN0b3JJZDogMzAzLCB3b3JsZEljb25PYmpJZDogNDAzLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAzIH0sIC8vIEQKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDQsIHNlY3RvcklkOiAzMDQsIHdvcmxkSWNvbk9iaklkOiA0MDQsIGNhcHR1cmVQb2ludE9iaklkOiA2MDQgfSwgLy8gRQogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNSwgc2VjdG9ySWQ6IDMwNSwgd29ybGRJY29uT2JqSWQ6IDQwNSwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNSB9LCAvLyBGCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA2LCBzZWN0b3JJZDogMzA2LCB3b3JsZEljb25PYmpJZDogNDA2LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA2IH0sIC8vIEcKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDcsIHNlY3RvcklkOiAzMDcsIHdvcmxkSWNvbk9iaklkOiA0MDcsIGNhcHR1cmVQb2ludE9iaklkOiA2MDcgfSwgLy8gSAogICAgICAgIF0sCiAgICAgICAgb3ZlcnRpbWVab25lTGV0dGVyc0J5TW9kZTogewogICAgICAgICAgICB0YW5rczogT1ZFUlRJTUVfVEFOS19aT05FX0xFVFRFUlMsCiAgICAgICAgICAgIGhlbGlzOiBPVkVSVElNRV9IRUxJX1pPTkVfTEVUVEVSUywKICAgICAgICB9LAoKICAgICAgICB2ZWhpY2xlU3Bhd25ZYXdPZmZzZXREZWc6IDAsCgogICAgICAgIHRlYW0xVGFua1NwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RYICAgICAgcm90WSAgICAgIHJvdFoKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTc5MC44MzcsICAxMzIuOTcxLCAgMjQ0LjYxNiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDE0My44NDksICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC03ODUuMDIyLCAgMTMyLjk3MywgIDI0Ni45NTMpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxNDAuMDQ3LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNzc1LjE0MCwgIDEzMi45NzEsICAyNTUuMzEyKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTQzLjg3OSwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTc3MC4yNzcsICAxMzIuOTcxLCAgMjU5LjI5NiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDE0MS42NTEsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCgogICAgICAgIF0sCiAgICAgICAgdGVhbTJUYW5rU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1ggICAgICBwb3NZICAgICAgcG9zWgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNjAxLjczNSwgIDExMC4yODMsIC0yMzAuMjQ2KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTE5LjQ2MywgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDYwOC4zNzksICAxMTAuMjgzLCAtMjMzLjU2OSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTEzMC40MjUsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTGVvcGFyZCAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA2MTUuMzY2LCAgMTEwLjI4MywgLTI0My4yODgpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xMjQuMTg3LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkNWOTAgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNjE3LjkwNCwgIDExMC4yOTcsIC0yNDkuODIzKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTI1LjcwMiwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICBdLAogICAgICAgIHRlYW0xSGVsaVNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RYICAgICAgcm90WSAgICAgIHJvdFoKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTgxMS41OTcsICAxMzIuODE1LCAgMjM0LjE2NSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDEwNS4xNzgsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQUg2NCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC03NjcuNTQ0LCAgMTMyLjg1MywgIDE3Mi43NTUpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xNjcuNjU3LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkV1cm9jb3B0ZXIgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNzgyLjEzMSwgIDEzMi44NjEsICAxOTguMDExKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNDguMjA2LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BSDY0ICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTczOC43MjYsICAxMzIuODYxLCAgMjA5LjE4MiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDExNS42MDYsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuVUg2MCAgICAgICAgIH0sCgogICAgICAgIF0sCiAgICAgICAgdGVhbTJIZWxpU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1ggICAgICBwb3NZICAgICAgcG9zWgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNTUzLjk3NiwgIDExMS4yODMsIC0yNTYuMDcwKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtNDkuNDAxLCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BSDY0ICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDU3MS42MzksICAxMTEuMTc0LCAtMjAyLjA2NSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTQ2LjcyOCwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuRXVyb2NvcHRlciAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA2NDcuNTAwLCAgMTEwLjU2MiwgLTI3Ni44MjgpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xMjYuMDU5LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFINjQgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNjM2LjIzOSwgIDExMC41ODAsIC0yNTguODQxKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTI5LjI1OSwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5VSDYwX1BheCAgICAgfSwKICAgICAgICBdLAogICAgfSwKCiAgICAvL0NhcHN0b25lCiAgICBMaWJlcmF0aW9uX1BlYWs6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAKICAgICAgICB0ZWFtMUJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoLTMyMy4zNjUsICAxMzAuNDUyLCAgODMuMjExKSwgIHRlYW0xTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLldFU1QsCiAgICAgICAgdGVhbTJCYXNlOiBtb2QuQ3JlYXRlVmVjdG9yKCAyODEuODg3LCAgMTM5LjA5NSwgIDQ2NC4xODcpLCB0ZWFtMk5hbWU6IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5FQVNULAogICAgICAgIGFpcmNyYWZ0Q2VpbGluZzogMTYwLAogICAgICAgIGh1ZE1heFk6IDYzNSwKICAgICAgICBodWRGbG9vclk6IDEzOSwKICAgICAgICB1c2VDdXN0b21DZWlsaW5nOiB0cnVlLAogICAgICAgIC8vIE9iaklkIHBhdHRlcm4gcGVyIHpvbmU6IEFyZWFUcmlnZ2VyIDIwMCssIFNlY3RvciAzMDArLCBXb3JsZEljb24gNDAwKywgQ2FwdHVyZVBvaW50IDYwMCsuCiAgICAgICAgb3ZlcnRpbWVab25lczogWwogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMCwgc2VjdG9ySWQ6IDMwMCwgd29ybGRJY29uT2JqSWQ6IDQwMCwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMCB9LCAvLyBBCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAxLCBzZWN0b3JJZDogMzAxLCB3b3JsZEljb25PYmpJZDogNDAxLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAxIH0sIC8vIEIKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDIsIHNlY3RvcklkOiAzMDIsIHdvcmxkSWNvbk9iaklkOiA0MDIsIGNhcHR1cmVQb2ludE9iaklkOiA2MDIgfSwgLy8gQwogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMywgc2VjdG9ySWQ6IDMwMywgd29ybGRJY29uT2JqSWQ6IDQwMywgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMyB9LCAvLyBECiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA0LCBzZWN0b3JJZDogMzA0LCB3b3JsZEljb25PYmpJZDogNDA0LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA0IH0sIC8vIEUKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDUsIHNlY3RvcklkOiAzMDUsIHdvcmxkSWNvbk9iaklkOiA0MDUsIGNhcHR1cmVQb2ludE9iaklkOiA2MDUgfSwgLy8gRgogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNiwgc2VjdG9ySWQ6IDMwNiwgd29ybGRJY29uT2JqSWQ6IDQwNiwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNiB9LCAvLyBHCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA3LCBzZWN0b3JJZDogMzA3LCB3b3JsZEljb25PYmpJZDogNDA3LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA3IH0sIC8vIEgKICAgICAgICBdLAogICAgICAgIG92ZXJ0aW1lWm9uZUxldHRlcnNCeU1vZGU6IHsKICAgICAgICAgICAgdGFua3M6IE9WRVJUSU1FX1RBTktfWk9ORV9MRVRURVJTLAogICAgICAgICAgICBoZWxpczogT1ZFUlRJTUVfSEVMSV9aT05FX0xFVFRFUlMsCiAgICAgICAgfSwKICAgICAgICAKICAgICAgICB2ZWhpY2xlU3Bhd25ZYXdPZmZzZXREZWc6IDAsCgogICAgICAgIHRlYW0xVGFua1NwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RYICAgICAgcm90WSAgICAgIHJvdFoKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTMxMy4xMjIsICAxMzAuMTA5LCAgOTEuMzE3KSwgIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDY3LjY4MSwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0zMDYuODU3LCAgMTI5Ljk5OCwgIDg0LjUwMCksICByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA0OS4zMjEsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMzA5Ljg1OCwgIDEzMC4zMTYsICAxMDIuMTI0KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNjEuNDQyLCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BYnJhbXMgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTMxMC44NjUsICAxMzAuODI1LCAgMTE1LjA5OCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDgzLjI3OCwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTTJCcmFkbGV5ICAgIH0sCiAgICAgICAgXSwKICAgICAgICB0ZWFtMlRhbmtTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zWCAgICAgIHBvc1kgICAgICBwb3NaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAyNzcuMDk3LCAgMTM5LjcyNSwgIDQ1MS4wMjcpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xNTcuMTc2LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMjg1LjQ2NCwgIDEzOS40NDksICA0NDYuODIzKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTM3LjkyNCwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5DVjkwICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDI3MC4wMjMsICAxMzkuOTE3LCAgNDU3LjUzOCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTE1Ni44MTksICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTGVvcGFyZCAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAyNTcuOTM4LCAgMTM5LjQwMywgIDQ1OS4wMzIpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxNjIuMDk0LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkNWOTAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgICAgdGVhbTFIZWxpU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdFggICAgICByb3RZICAgICAgcm90WgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMjc3LjkwNiwgIDEzMC40NjEsICA5NS40ODQpLCAgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTMwLjc3MywgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BSDY0ICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTI4NC40MTMsICAxMzAuNjMyLCAgODUuNjM0KSwgIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDEzNy43MTQsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuRXVyb2NvcHRlciAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0zMjYuNDkxLCAgMTI5LjkyNywgIDgyLjY1NyksICByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0yMy42MjIsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFINjQgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMzQ4LjU3OCwgIDEyOS40MTYsICA3Ny4xMTgpLCAgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMjIuNDc1LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5VSDYwICAgICAgICAgfSwKICAgICAgICBdLAogICAgICAgIHRlYW0ySGVsaVNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NYICAgICAgcG9zWSAgICAgIHBvc1oKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDI1NS4yNTcsICAxMzkuNDM1LCAgNDU5LjY4NyksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTE0Ny40OTcsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQUg2NCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAyNjguMzE5LCAgMTM5Ljc4MSwgIDQ1Mi45NzkpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xNTQuNjk0LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkV1cm9jb3B0ZXIgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMjg4LjA2MSwgIDEzOS4zNCwgICA0NDcuNjMpLCAgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTUyLjk1MywgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BSDY0ICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDMxNS4zMDcsICAxMzYuNTEyLCAgNDkwLjYxMSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTE0NC4yNDYsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuVUg2MF9QYXggICAgIH0sCiAgICAgICAgXSwKICAgIH0sCgogICAgLy9EdW1ibwogICAgTWFuaGF0dGFuX0JyaWRnZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaIAogICAgICAgIHRlYW0xQmFzZTogbW9kLkNyZWF0ZVZlY3RvcigtMjYzLjMxMiwgIDUyLjMwOCwgIC00NjAuNjEyKSwgdGVhbTFOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuV0VTVCwKICAgICAgICB0ZWFtMkJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoIDE3Ni4wNTMsICA1Ny40NzQsICAtMjQzLjg0MyksIHRlYW0yTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLkVBU1QsCiAgICAgICAgYWlyY3JhZnRDZWlsaW5nOiAxOTAsCiAgICAgICAgaHVkTWF4WTogMTgwLAogICAgICAgIGh1ZEZsb29yWTogNTcsCiAgICAgICAgdXNlQ3VzdG9tQ2VpbGluZzogZmFsc2UsCiAgICAgICAgLy8gT2JqSWQgcGF0dGVybiBwZXIgem9uZTogQXJlYVRyaWdnZXIgMjAwKywgU2VjdG9yIDMwMCssIFdvcmxkSWNvbiA0MDArLCBDYXB0dXJlUG9pbnQgNjAwKy4KICAgICAgICBvdmVydGltZVpvbmVzOiBbCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAwLCBzZWN0b3JJZDogMzAwLCB3b3JsZEljb25PYmpJZDogNDAwLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAwIH0sIC8vIEEKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDEsIHNlY3RvcklkOiAzMDEsIHdvcmxkSWNvbk9iaklkOiA0MDEsIGNhcHR1cmVQb2ludE9iaklkOiA2MDEgfSwgLy8gQgogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMiwgc2VjdG9ySWQ6IDMwMiwgd29ybGRJY29uT2JqSWQ6IDQwMiwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMiB9LCAvLyBDCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAzLCBzZWN0b3JJZDogMzAzLCB3b3JsZEljb25PYmpJZDogNDAzLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAzIH0sIC8vIEQKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDQsIHNlY3RvcklkOiAzMDQsIHdvcmxkSWNvbk9iaklkOiA0MDQsIGNhcHR1cmVQb2ludE9iaklkOiA2MDQgfSwgLy8gRQogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNSwgc2VjdG9ySWQ6IDMwNSwgd29ybGRJY29uT2JqSWQ6IDQwNSwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNSB9LCAvLyBGCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA2LCBzZWN0b3JJZDogMzA2LCB3b3JsZEljb25PYmpJZDogNDA2LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA2IH0sIC8vIEcKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDcsIHNlY3RvcklkOiAzMDcsIHdvcmxkSWNvbk9iaklkOiA0MDcsIGNhcHR1cmVQb2ludE9iaklkOiA2MDcgfSwgLy8gSAogICAgICAgIF0sCiAgICAgICAgb3ZlcnRpbWVab25lTGV0dGVyc0J5TW9kZTogewogICAgICAgICAgICB0YW5rczogT1ZFUlRJTUVfVEFOS19aT05FX0xFVFRFUlMsCiAgICAgICAgICAgIGhlbGlzOiBPVkVSVElNRV9IRUxJX1pPTkVfTEVUVEVSUywKICAgICAgICB9LAogICAgICAgCiAgICAgICAgdmVoaWNsZVNwYXduWWF3T2Zmc2V0RGVnOiAwLAoKICAgICAgICB0ZWFtMVRhbmtTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90WCAgICAgIHJvdFkgICAgICByb3RaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0yNjAuMzE3LCAgNTIuMDc5LCAgLTQ1MS40NzUpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAzNC42ODcsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMjcwLjA2MSwgIDUyLjA3OSwgIC00NDguNjgwKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNTIuMjQ1LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTI4MS45NjIsICA1Mi4wNzksICAtNDQ4LjYwNCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDUyLjA2NywgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0yOTQuNDI4LCAgNTIuMDc5LCAgLTQ0OC43NzIpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA0MC42NTksICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICB9LAogICAgICAgIF0sCiAgICAgICAgdGVhbTJUYW5rU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1ggICAgICBwb3NZICAgICAgcG9zWgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMjA1LjI3MSwgIDU3LjM1OCwgIC0yMzkuNzc0KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtOTAuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDIwNS41NDksICA1Ny4zNTgsICAtMjQ3LjgyMiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTkwLjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAyMDUuMjk0LCAgNTcuMzU4LCAgLTI1MS45ODYpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC05MC4wLCAgICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMjAyLjcwNywgIDU3LjM1OCwgIC0yNTcuMjQwKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtOTAuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5DVjkwICAgICAgICAgfSwKICAgICAgICBdLAogICAgICAgIHRlYW0xSGVsaVNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RYICAgICAgcm90WSAgICAgIHJvdFoKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTI5NC42MTksICA1MS4zOTEsICAtNDYyLjgxNiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDkwLjMwOCwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQUg2NCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0yNDguMTkzLCAgNTAuNzY1LCAgLTQ4NC42NzkpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA0OC43MDgsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkV1cm9jb3B0ZXIgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMzMwLjA3MCwgIDUyLjE2MiwgIC00NDAuOTM2KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgOTAuNDE4LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BSDY0ICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTIzNS41MTQsICA1MC44OTEsICAtNTAzLjE2MSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDU5LjIyNCwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuVUg2MCAgICAgICAgIH0sCiAgICAgICAgXSwKICAgICAgICB0ZWFtMkhlbGlTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zWCAgICAgIHBvc1kgICAgICBwb3NaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAxODIuNzc0LCAgNTcuMjc4LCAgLTIzMi4zNjApLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xMDQuMDIxLCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFINjQgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMTczLjkxNiwgIDU3LjI3OCwgIC0yMTQuMTk4KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTc4LjQzOSwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5FdXJvY29wdGVyICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDE4Ni44MjMsICA1Ny4yNzgsICAtMjExLjg5MiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTE3OC43MDksICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQUg2NCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAxNzkuNDc1LCAgNTcuMjc4LCAgLTE5NS45NDQpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC05MC4wLCAgICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LlVINjBfUGF4ICAgICB9LAogICAgICAgIF0sCiAgICB9LAoKICAgIC8vU29iZWsgQ2l0eQogICAgU29iZWtfQ2l0eTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaIAogICAgICAgIHRlYW0xQmFzZTogbW9kLkNyZWF0ZVZlY3RvcigtMzQwLjQ2NSwgIDkyLjU1NywgIC0xMTAuMzE1KSwgdGVhbTFOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuV0VTVCwKICAgICAgICB0ZWFtMkJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoIDIwMC4xOTYsICA5MC4xNjcsICAgMTAuNzE3KSwgIHRlYW0yTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLkVBU1QsCiAgICAgICAgYWlyY3JhZnRDZWlsaW5nOiAxNTAsCiAgICAgICAgaHVkTWF4WTogMjcwLAogICAgICAgIGh1ZEZsb29yWTogOTEsCiAgICAgICAgdXNlQ3VzdG9tQ2VpbGluZzogdHJ1ZSwKICAgICAgICAvLyBPYmpJZCBwYXR0ZXJuIHBlciB6b25lOiBBcmVhVHJpZ2dlciAyMDArLCBTZWN0b3IgMzAwKywgV29ybGRJY29uIDQwMCssIENhcHR1cmVQb2ludCA2MDArLgogICAgICAgIG92ZXJ0aW1lWm9uZXM6IFsKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDAsIHNlY3RvcklkOiAzMDAsIHdvcmxkSWNvbk9iaklkOiA0MDAsIGNhcHR1cmVQb2ludE9iaklkOiA2MDAgfSwgLy8gQQogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMSwgc2VjdG9ySWQ6IDMwMSwgd29ybGRJY29uT2JqSWQ6IDQwMSwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMSB9LCAvLyBCCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAyLCBzZWN0b3JJZDogMzAyLCB3b3JsZEljb25PYmpJZDogNDAyLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAyIH0sIC8vIEMKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDMsIHNlY3RvcklkOiAzMDMsIHdvcmxkSWNvbk9iaklkOiA0MDMsIGNhcHR1cmVQb2ludE9iaklkOiA2MDMgfSwgLy8gRAogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNCwgc2VjdG9ySWQ6IDMwNCwgd29ybGRJY29uT2JqSWQ6IDQwNCwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNCB9LCAvLyBFCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA1LCBzZWN0b3JJZDogMzA1LCB3b3JsZEljb25PYmpJZDogNDA1LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA1IH0sIC8vIEYKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDYsIHNlY3RvcklkOiAzMDYsIHdvcmxkSWNvbk9iaklkOiA0MDYsIGNhcHR1cmVQb2ludE9iaklkOiA2MDYgfSwgLy8gRwogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNywgc2VjdG9ySWQ6IDMwNywgd29ybGRJY29uT2JqSWQ6IDQwNywgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNyB9LCAvLyBICiAgICAgICAgXSwKICAgICAgICBvdmVydGltZVpvbmVMZXR0ZXJzQnlNb2RlOiB7CiAgICAgICAgICAgIHRhbmtzOiBPVkVSVElNRV9UQU5LX1pPTkVfTEVUVEVSUywKICAgICAgICAgICAgaGVsaXM6IE9WRVJUSU1FX0hFTElfWk9ORV9MRVRURVJTLAogICAgICAgIH0sCiAgICAgICAgCiAgICAgICAgdmVoaWNsZVNwYXduWWF3T2Zmc2V0RGVnOiAwLAoKICAgICAgICB0ZWFtMVRhbmtTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90WCAgICAgIHJvdFkgICAgICByb3RaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0zMTMuMTIyLCAgMTMwLjEwOSwgIDkxLjMxNyksICByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA2Ny42ODEsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMzA2Ljg1NywgIDEyOS45OTgsICA4NC41MDApLCAgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNDkuMzIxLCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTMwOS44NTgsICAxMzAuMzE2LCAgMTAyLjEyNCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDYxLjQ0MiwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0zMTAuODY1LCAgMTMwLjgyNSwgIDExNS4wOTgpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA4My4yNzgsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICB9LAogICAgICAgIF0sCiAgICAgICAgdGVhbTJUYW5rU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1ggICAgICBwb3NZICAgICAgcG9zWgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMjc3LjA5NywgIDEzOS43MjUsICA0NTEuMDI3KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTU3LjE3NiwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDI4NS40NjQsICAxMzkuNDQ5LCAgNDQ2LjgyMyksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTEzNy45MjQsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAyNzAuMDIzLCAgMTM5LjkxNywgIDQ1Ny41MzgpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xNTYuODE5LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMjU3LjkzOCwgIDEzOS40MDMsICA0NTkuMDMyKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTYyLjA5NCwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5DVjkwICAgICAgICAgfSwKICAgICAgICBdLAogICAgICAgIHRlYW0xSGVsaVNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RYICAgICAgcm90WSAgICAgIHJvdFoKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTMyOS42MDAsICA5MS43MDQsICAtMTAyLjAwOCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDEwMS40ODEsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQUg2NCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0zMTkuODA5LCAgOTEuNzA0LCAgLTg2LjU3NyksICByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxMjEuODAxLCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkV1cm9jb3B0ZXIgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMzEzLjMyLCAgIDkyLjI5NywgIC03My43MTcxKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTEzLjk1OCwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BSDY0ICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTM1Mi4wMDcsICA5Mi4zOTUsICAtMTI2LjMxMyksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDIzLjMwNSwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuVUg2MCAgICAgICAgIH0sCiAgICAgICAgXSwKICAgICAgICB0ZWFtMkhlbGlTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zWCAgICAgIHBvc1kgICAgICBwb3NaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAyMTAuODY0LCAgOTAuMTUyLCAgIDEwLjk4NiksICByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xMjUuMzE5LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFINjQgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMjAyLjMwMCwgIDkwLjE1MSwgICAyMy44MzkpLCAgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTI5LjU1MywgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5FdXJvY29wdGVyICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDIyNS43ODQsICA5MS4zMSwgICAgMzYuMjI4KSwgIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDE0MC4yNzgsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQUg2NCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAyMzIuOTA2LCAgOTAuMjcxLCAgLTguMzMpLCAgICByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xMzEuMzA5LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LlVINjBfUGF4ICAgICB9LAogICAgICAgIF0sCiAgICB9LAogICAgCiAgICAvL0dyYW5pdGUgTWlsaXRhcnkgUk5EIFBvcnQKICAgIEFyZWFfMjJCOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogCiAgICAgICAgdGVhbTFCYXNlOiBtb2QuQ3JlYXRlVmVjdG9yKCAxODEuMzI3LCAgMTczLjE5MywgLTM5OS4yMDEpLCB0ZWFtMU5hbWU6IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5XRVNULAogICAgICAgIHRlYW0yQmFzZTogbW9kLkNyZWF0ZVZlY3RvciggNzgyLjAxMywgIDE3OC4wMjgsIC01MDguNzkyKSwgdGVhbTJOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuRUFTVCwKICAgICAgICBhaXJjcmFmdENlaWxpbmc6IDY1MCwKICAgICAgICBodWRNYXhZOiA2NTAsCiAgICAgICAgaHVkRmxvb3JZOiA4MiwKICAgICAgICB1c2VDdXN0b21DZWlsaW5nOiBmYWxzZSwKICAgICAgICAvLyBPYmpJZCBwYXR0ZXJuIHBlciB6b25lOiBBcmVhVHJpZ2dlciAyMDArLCBTZWN0b3IgMzAwKywgV29ybGRJY29uIDQwMCssIENhcHR1cmVQb2ludCA2MDArLgogICAgICAgIG92ZXJ0aW1lWm9uZXM6IFsKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDAsIHNlY3RvcklkOiAzMDAsIHdvcmxkSWNvbk9iaklkOiA0MDAsIGNhcHR1cmVQb2ludE9iaklkOiA2MDAgfSwgLy8gQQogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwMSwgc2VjdG9ySWQ6IDMwMSwgd29ybGRJY29uT2JqSWQ6IDQwMSwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwMSB9LCAvLyBCCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjAyLCBzZWN0b3JJZDogMzAyLCB3b3JsZEljb25PYmpJZDogNDAyLCBjYXB0dXJlUG9pbnRPYmpJZDogNjAyIH0sIC8vIEMKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDMsIHNlY3RvcklkOiAzMDMsIHdvcmxkSWNvbk9iaklkOiA0MDMsIGNhcHR1cmVQb2ludE9iaklkOiA2MDMgfSwgLy8gRAogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNCwgc2VjdG9ySWQ6IDMwNCwgd29ybGRJY29uT2JqSWQ6IDQwNCwgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNCB9LCAvLyBFCiAgICAgICAgICAgIHsgYXJlYVRyaWdnZXJPYmpJZDogMjA1LCBzZWN0b3JJZDogMzA1LCB3b3JsZEljb25PYmpJZDogNDA1LCBjYXB0dXJlUG9pbnRPYmpJZDogNjA1IH0sIC8vIEYKICAgICAgICAgICAgeyBhcmVhVHJpZ2dlck9iaklkOiAyMDYsIHNlY3RvcklkOiAzMDYsIHdvcmxkSWNvbk9iaklkOiA0MDYsIGNhcHR1cmVQb2ludE9iaklkOiA2MDYgfSwgLy8gRwogICAgICAgICAgICB7IGFyZWFUcmlnZ2VyT2JqSWQ6IDIwNywgc2VjdG9ySWQ6IDMwNywgd29ybGRJY29uT2JqSWQ6IDQwNywgY2FwdHVyZVBvaW50T2JqSWQ6IDYwNyB9LCAvLyBICiAgICAgICAgXSwKICAgICAgICBvdmVydGltZVpvbmVMZXR0ZXJzQnlNb2RlOiB7CiAgICAgICAgICAgIHRhbmtzOiBPVkVSVElNRV9UQU5LX1pPTkVfTEVUVEVSUywKICAgICAgICAgICAgaGVsaXM6IE9WRVJUSU1FX0hFTElfWk9ORV9MRVRURVJTLAogICAgICAgIH0sCiAgICAgICAKICAgICAgICB2ZWhpY2xlU3Bhd25ZYXdPZmZzZXREZWc6IDAsCgogICAgICAgIHRlYW0xVGFua1NwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RYICAgICAgcm90WSAgICAgIHJvdFoKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDIwMy40NjQsICAxNzMuNjUxLCAtNDA0LjQ5NiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDE1Mi43MjEsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAxOTguMTU3LCAgMTczLjY1MSwgLTQxMS44MDQpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxNTIuNjMyLCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMTk2LjYwNiwgIDE3My41MjEsIC00MjYuNDg5KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTUyLjg5OSwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDE5NS4wMTgsICAxNzMuNjU1LCAtNDQwLjY5OSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDE1Mi41NDMsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgXSwKICAgICAgICB0ZWFtMlRhbmtTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zWCAgICAgIHBvc1kgICAgICBwb3NaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA4MDUuNzA2LCAgMTc3LjYyNCwgLTQ3NC40ODEpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xNTkuNDE5LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNzk5LjUwNiwgIDE3Ny42NjksIC00OTAuMTU2KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTU3LjU0OCwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5DVjkwICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDc5Mi41NjEsICAxNzcuNjI4LCAtNTA2LjY0NSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTE1Ni45MjQsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA3ODYuMzQwLCAgMTc3LjYwNSwgLTUyMC42MTMpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xNTUuMDgzLCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgIF0sCiAgICB9LAp9OwoKLy8gTWFwS2V5IC0+IFN0cmluZ3MuanNvbiBrZXkgbWFwcGluZyBmb3IgdGhlIFJlYWR5IGRpYWxvZyBtYXAgbGFiZWwuCmNvbnN0IE1BUF9OQU1FX1NUUklOR0tFWVM6IFJlY29yZDxNYXBLZXksIG51bWJlcj4gPSB7CiAgICBCbGFja3dlbGxfRmllbGRzOiBtb2Quc3RyaW5na2V5cy50d2wubWFwcy5ibGFja3dlbGxGaWVsZHMsCiAgICBEZWZlbnNlX05leHVzOiBtb2Quc3RyaW5na2V5cy50d2wubWFwcy5kZWZlbnNlTmV4dXMsCiAgICBHb2xmX0NvdXJzZTogbW9kLnN0cmluZ2tleXMudHdsLm1hcHMuZ29sZkNvdXJzZSwKICAgIE1pcmFrX1ZhbGxleTogbW9kLnN0cmluZ2tleXMudHdsLm1hcHMubWlyYWtWYWxsZXksCiAgICBPcGVyYXRpb25fRmlyZXN0b3JtOiBtb2Quc3RyaW5na2V5cy50d2wubWFwcy5vcGVyYXRpb25GaXJlc3Rvcm0sCiAgICBMaWJlcmF0aW9uX1BlYWs6IG1vZC5zdHJpbmdrZXlzLnR3bC5tYXBzLmxpYmVyYXRpb25QZWFrLAogICAgTWFuaGF0dGFuX0JyaWRnZTogbW9kLnN0cmluZ2tleXMudHdsLm1hcHMubWFuaGF0dGFuQnJpZGdlLAogICAgU29iZWtfQ2l0eTogbW9kLnN0cmluZ2tleXMudHdsLm1hcHMuc29iZWtDaXR5LAogICAgQXJlYV8yMkI6IG1vZC5zdHJpbmdrZXlzLnR3bC5tYXBzLmFyZWEyMkIsCn07CgovLyBFeHBlY3RlZCB0byBpbmNsdWRlIHRlYW0gYmFzZXMgKyBhdCBsZWFzdCBvbmUgc3Bhd24gcGVyIHRlYW0sIHdpdGggdW5pcXVlIHNsb3ROdW1iZXIgdmFsdWVzIG1hdGNoaW5nIHBlciBzaWRlLgpsZXQgQUNUSVZFX01BUF9DT05GSUcgPSBNQVBfQ09ORklHU1tBQ1RJVkVfTUFQX0tFWV07Ci8vIEFjdGl2ZSBtYXAncyBjdXJhdGVkIG92ZXJ0aW1lIHpvbmVzIChBcmVhVHJpZ2dlciBPYmpJZCArIFNlY3RvciBJZCArIFdvcmxkSWNvbiBPYmpJZCArIENhcHR1cmVQb2ludCBPYmpJZCkuCmxldCBBQ1RJVkVfT1ZFUlRJTUVfWk9ORVM6IE92ZXJ0aW1lWm9uZVNwZWNbXSA9IChBQ1RJVkVfTUFQX0NPTkZJRy5vdmVydGltZVpvbmVzID8/IFtdKS5tYXAoKHpvbmUpID0+ICh7CiAgICBhcmVhVHJpZ2dlck9iaklkOiB6b25lLmFyZWFUcmlnZ2VyT2JqSWQsCiAgICBzZWN0b3JJZDogem9uZS5zZWN0b3JJZCwKICAgIHdvcmxkSWNvbk9iaklkOiB6b25lLndvcmxkSWNvbk9iaklkLAogICAgY2FwdHVyZVBvaW50T2JqSWQ6IHpvbmUuY2FwdHVyZVBvaW50T2JqSWQsCn0pKTsKCi8vIEJhc2VsaW5lIHRlYW0gaW5mZXJlbmNlIGZyb20gc3RhdGljIG1haW4tYmFzZSBhbmNob3IgY29vcmRpbmF0ZXMgKE9wdGlvbiBBKS4KLy8gLSBSZXBsYWNlIHRoZXNlIHZlY3RvcnMgd2l0aCBleGFjdCBtYXAgY29vcmRpbmF0ZXMgdGhyb3VnaCBNYXBDb25maWc7IHRoZXNlIHBvc2l0aW9ucyBkcml2ZSBmYWxsYmFjayB0ZWFtIHJlZ2lzdHJhdGlvbi4KLy8gLSBBIHNwYXduZWQgdmVoaWNsZSBpcyBhc3NpZ25lZCB0byB0aGUgbmVhcmVzdCBiYXNlIGFuY2hvciBpZiB3aXRoaW4gTUFJTl9CQVNFX0JJTkRfUkFESVVTX01FVEVSUy4KbGV0IE1BSU5fQkFTRV9URUFNMV9QT1MgPSBBQ1RJVkVfTUFQX0NPTkZJRy50ZWFtMUJhc2U7CmxldCBNQUlOX0JBU0VfVEVBTTJfUE9TID0gQUNUSVZFX01BUF9DT05GSUcudGVhbTJCYXNlOwpjb25zdCBNQUlOX0JBU0VfQklORF9SQURJVVNfTUVURVJTID0gMTUwLjA7CgovLyBDYWNoZWQgcGVyLXZlaGljbGUgc3Bhd24gaW5mZXJlbmNlIGZvciBsYXRlciByZWNvbmNpbGlhdGlvbiBvbiBzZWF0IGVudHJ5IChiZXN0LWVmZm9ydCwgY2FuIGdvIHN0YWxlKS4KY29uc3QgdmVoaWNsZVNwYXduQmFzZVRlYW1CeU9iaklkOiBSZWNvcmQ8bnVtYmVyLCBUZWFtSUQ+ID0ge307CgovLyBWZWhpY2xlIHNwYXduZXIgZGVmYXVsdHMgKHBlci1tYXAgc3Bhd24gc3BlY3MsIHNlbGVjdGVkIGJ5IG1vZGUpLgpsZXQgVEVBTTFfVkVISUNMRV9TUEFXTl9TUEVDUyA9IEFDVElWRV9NQVBfQ09ORklHLnRlYW0xVGFua1NwYXduczsKbGV0IFRFQU0yX1ZFSElDTEVfU1BBV05fU1BFQ1MgPSBBQ1RJVkVfTUFQX0NPTkZJRy50ZWFtMlRhbmtTcGF3bnM7CmxldCBWRUhJQ0xFX1NQQVdOX1lBV19PRkZTRVRfREVHID0gQUNUSVZFX01BUF9DT05GSUcudmVoaWNsZVNwYXduWWF3T2Zmc2V0RGVnOwpjb25zdCBNQVBfREVURUNUX0RJU1RBTkNFX01FVEVSUyA9IDUuMDsKCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBNYXAgQ29uZmlnIChDb25zdGFudHMgKyBUeXBlcykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE1hcCArIE1hdGNodXAgSGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gUmV0dXJucyB0aGUgUmVhZHktZGlhbG9nIGRpc3BsYXkgc3RyaW5na2V5IGZvciB0aGUgY3VycmVudCBtYXAuCmZ1bmN0aW9uIGdldE1hcE5hbWVLZXkobWFwS2V5OiBNYXBLZXkpOiBudW1iZXIgewogICAgcmV0dXJuIE1BUF9OQU1FX1NUUklOR0tFWVNbbWFwS2V5XSA/PyBtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLnVua25vd25QbGF5ZXI7Cn0KCi8vIERldGVybWluZXMgd2hldGhlciB0aGUgY3VycmVudCBtb2RlIHNlbGVjdGlvbiBzaG91bGQgdXNlIGhlbGkgc3Bhd25zLgpmdW5jdGlvbiBpc0hlbGlHYW1lTW9kZShnYW1lTW9kZUtleTogbnVtYmVyKTogYm9vbGVhbiB7CiAgICByZXR1cm4gKAogICAgICAgIGdhbWVNb2RlS2V5ID09PSBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuZ2FtZU1vZGVIZWxpc0xhZGRlcgogICAgICAgIHx8IGdhbWVNb2RlS2V5ID09PSBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuZ2FtZU1vZGVIZWxpc1ByYWN0aWNlCiAgICAgICAgfHwgZ2FtZU1vZGVLZXkgPT09IG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5nYW1lTW9kZUhlbGlzQ3VzdG9tCiAgICApOwp9CgovLyBCdWlsZHMgYSBiYXNpYyBoZWxpIHNwYXduIGxpc3QgZnJvbSB0YW5rIHNwYXduIHBvc2l0aW9ucyB3aGVuIG5vIG1hcC1zcGVjaWZpYyBoZWxpIGxpc3QgZXhpc3RzIHlldC4KZnVuY3Rpb24gYnVpbGRIZWxpU3Bhd25zRnJvbVRhbmtTcGF3bnMoc3Bhd25zOiBWZWhpY2xlU3Bhd25TcGVjW10sIHRlYW06IFRlYW1JRCk6IFZlaGljbGVTcGF3blNwZWNbXSB7CiAgICBjb25zdCBhdHRhY2tWZWhpY2xlID0gdGVhbSA9PT0gVGVhbUlELlRlYW0xID8gbW9kLlZlaGljbGVMaXN0LkFINjQgOiBtb2QuVmVoaWNsZUxpc3QuRXVyb2NvcHRlcjsKICAgIGNvbnN0IHRyYW5zcG9ydFZlaGljbGUgPSB0ZWFtID09PSBUZWFtSUQuVGVhbTEgPyBtb2QuVmVoaWNsZUxpc3QuVUg2MCA6IG1vZC5WZWhpY2xlTGlzdC5VSDYwX1BheDsKICAgIHJldHVybiBzcGF3bnMubWFwKChzcGF3bikgPT4gKHsKICAgICAgICBzbG90TnVtYmVyOiBzcGF3bi5zbG90TnVtYmVyLAogICAgICAgIHBvczogc3Bhd24ucG9zLAogICAgICAgIHJvdDogc3Bhd24ucm90LAogICAgICAgIHZlaGljbGU6IHNwYXduLnNsb3ROdW1iZXIgPT09IDMgPyB0cmFuc3BvcnRWZWhpY2xlIDogYXR0YWNrVmVoaWNsZSwKICAgIH0pKTsKfQoKZnVuY3Rpb24gcmVzb2x2ZUhlbGlTcGF3bnNGb3JUZWFtKGNmZzogTWFwQ29uZmlnLCB0ZWFtOiBUZWFtSUQpOiBWZWhpY2xlU3Bhd25TcGVjW10gewogICAgaWYgKHRlYW0gPT09IFRlYW1JRC5UZWFtMSkgewogICAgICAgIGlmIChjZmcudGVhbTFIZWxpU3Bhd25zICYmIGNmZy50ZWFtMUhlbGlTcGF3bnMubGVuZ3RoID4gMCkgcmV0dXJuIGNmZy50ZWFtMUhlbGlTcGF3bnM7CiAgICAgICAgcmV0dXJuIGJ1aWxkSGVsaVNwYXduc0Zyb21UYW5rU3Bhd25zKGNmZy50ZWFtMVRhbmtTcGF3bnMsIFRlYW1JRC5UZWFtMSk7CiAgICB9CiAgICBpZiAoY2ZnLnRlYW0ySGVsaVNwYXducyAmJiBjZmcudGVhbTJIZWxpU3Bhd25zLmxlbmd0aCA+IDApIHJldHVybiBjZmcudGVhbTJIZWxpU3Bhd25zOwogICAgcmV0dXJuIGJ1aWxkSGVsaVNwYXduc0Zyb21UYW5rU3Bhd25zKGNmZy50ZWFtMlRhbmtTcGF3bnMsIFRlYW1JRC5UZWFtMik7Cn0KCmZ1bmN0aW9uIGdldFJlYWR5RGlhbG9nVmVoaWNsZUxpc3RCeUluZGV4KGluZGV4OiBudW1iZXIpOiBtb2QuVmVoaWNsZUxpc3QgewogICAgcmV0dXJuIFJFQURZX0RJQUxPR19WRUhJQ0xFX0xJU1RbaW5kZXhdID8/IFJFQURZX0RJQUxPR19WRUhJQ0xFX0xJU1RbMF07Cn0KCmZ1bmN0aW9uIGFwcGx5VmVoaWNsZU92ZXJyaWRlVG9TcGF3bnMoc3Bhd25zOiBWZWhpY2xlU3Bhd25TcGVjW10sIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdCk6IFZlaGljbGVTcGF3blNwZWNbXSB7CiAgICByZXR1cm4gc3Bhd25zLm1hcCgoc3Bhd24pID0+ICh7CiAgICAgICAgc2xvdE51bWJlcjogc3Bhd24uc2xvdE51bWJlciwKICAgICAgICBwb3M6IHNwYXduLnBvcywKICAgICAgICByb3Q6IHNwYXduLnJvdCwKICAgICAgICB2ZWhpY2xlLAogICAgfSkpOwp9CgpmdW5jdGlvbiByZWZyZXNoVmVoaWNsZVNwYXduU3BlY3NGcm9tTW9kZUNvbmZpZygpOiB2b2lkIHsKICAgIGNvbnN0IHVzZUhlbGlzID0gaXNIZWxpR2FtZU1vZGUoU3RhdGUucm91bmQubW9kZUNvbmZpZy5jb25maXJtZWQuZ2FtZU1vZGUpOwogICAgaWYgKHVzZUhlbGlzKSB7CiAgICAgICAgY29uc3QgYmFzZVQxID0gcmVzb2x2ZUhlbGlTcGF3bnNGb3JUZWFtKEFDVElWRV9NQVBfQ09ORklHLCBUZWFtSUQuVGVhbTEpOwogICAgICAgIGNvbnN0IGJhc2VUMiA9IHJlc29sdmVIZWxpU3Bhd25zRm9yVGVhbShBQ1RJVkVfTUFQX0NPTkZJRywgVGVhbUlELlRlYW0yKTsKICAgICAgICBpZiAoU3RhdGUucm91bmQubW9kZUNvbmZpZy5jb25maXJtZWQudmVoaWNsZU92ZXJyaWRlRW5hYmxlZCkgewogICAgICAgICAgICAvLyBHbG9iYWwgb3ZlcnJpZGU6IHVzZSBhIHNpbmdsZSBoZWxpIHNlbGVjdGlvbiBmb3IgYWxsIGhlbGkgc3Bhd24gc2xvdHMuCiAgICAgICAgICAgIGNvbnN0IG92ZXJyaWRlVmVoaWNsZSA9IGdldFJlYWR5RGlhbG9nVmVoaWNsZUxpc3RCeUluZGV4KFN0YXRlLnJvdW5kLm1vZGVDb25maWcuY29uZmlybWVkLnZlaGljbGVJbmRleFQxKTsKICAgICAgICAgICAgVEVBTTFfVkVISUNMRV9TUEFXTl9TUEVDUyA9IGFwcGx5VmVoaWNsZU92ZXJyaWRlVG9TcGF3bnMoYmFzZVQxLCBvdmVycmlkZVZlaGljbGUpOwogICAgICAgICAgICBURUFNMl9WRUhJQ0xFX1NQQVdOX1NQRUNTID0gYXBwbHlWZWhpY2xlT3ZlcnJpZGVUb1NwYXducyhiYXNlVDIsIG92ZXJyaWRlVmVoaWNsZSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgVEVBTTFfVkVISUNMRV9TUEFXTl9TUEVDUyA9IGJhc2VUMTsKICAgICAgICBURUFNMl9WRUhJQ0xFX1NQQVdOX1NQRUNTID0gYmFzZVQyOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIFRFQU0xX1ZFSElDTEVfU1BBV05fU1BFQ1MgPSBBQ1RJVkVfTUFQX0NPTkZJRy50ZWFtMVRhbmtTcGF3bnM7CiAgICBURUFNMl9WRUhJQ0xFX1NQQVdOX1NQRUNTID0gQUNUSVZFX01BUF9DT05GSUcudGVhbTJUYW5rU3Bhd25zOwp9CgpmdW5jdGlvbiBhcHBseVZlaGljbGVTcGF3blNwZWNzVG9FeGlzdGluZ1Nsb3RzKCk6IHZvaWQgewogICAgaWYgKFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwogICAgY29uc3QgdGVhbTFCeVNsb3Q6IFJlY29yZDxudW1iZXIsIFZlaGljbGVTcGF3blNwZWM+ID0ge307CiAgICBjb25zdCB0ZWFtMkJ5U2xvdDogUmVjb3JkPG51bWJlciwgVmVoaWNsZVNwYXduU3BlYz4gPSB7fTsKICAgIGZvciAoY29uc3Qgc3BlYyBvZiBURUFNMV9WRUhJQ0xFX1NQQVdOX1NQRUNTKSB7CiAgICAgICAgdGVhbTFCeVNsb3Rbc3BlYy5zbG90TnVtYmVyXSA9IHNwZWM7CiAgICB9CiAgICBmb3IgKGNvbnN0IHNwZWMgb2YgVEVBTTJfVkVISUNMRV9TUEFXTl9TUEVDUykgewogICAgICAgIHRlYW0yQnlTbG90W3NwZWMuc2xvdE51bWJlcl0gPSBzcGVjOwogICAgfQogICAgZm9yIChjb25zdCBzbG90IG9mIFN0YXRlLnZlaGljbGVzLnNsb3RzKSB7CiAgICAgICAgY29uc3Qgc3BlYyA9IHNsb3QudGVhbUlkID09PSBUZWFtSUQuVGVhbTEgPyB0ZWFtMUJ5U2xvdFtzbG90LnNsb3ROdW1iZXJdIDogdGVhbTJCeVNsb3Rbc2xvdC5zbG90TnVtYmVyXTsKICAgICAgICBpZiAoIXNwZWMpIGNvbnRpbnVlOwogICAgICAgIGlmIChzbG90LnZlaGljbGVUeXBlID09PSBzcGVjLnZlaGljbGUpIGNvbnRpbnVlOwogICAgICAgIHNsb3QudmVoaWNsZVR5cGUgPSBzcGVjLnZlaGljbGU7CiAgICAgICAgY29uZmlndXJlVmVoaWNsZVNwYXduZXIoc2xvdC5zcGF3bmVyLCBzbG90LnZlaGljbGVUeXBlKTsKICAgIH0KfQoKLy8gQXBwbGllcyB0aGUgc2VsZWN0ZWQgbWFwJ3MgYmFzZSBhbmNob3JzLCBzcGF3biBzcGVjcywgYW5kIHlhdyBvZmZzZXRzIHRvIHRoZSBhY3RpdmUgcnVudGltZSBjb25maWcuCi8vIEFsc28gcmVmcmVzaGVzIHRoZSBSZWFkeSBkaWFsb2cgbWFwIGxhYmVsIHNvIHRoZSBVSSBtYXRjaGVzIHRoZSBhY3RpdmUgbWFwLgpmdW5jdGlvbiBhcHBseU1hcENvbmZpZyhtYXBLZXk6IE1hcEtleSk6IHZvaWQgewogICAgQUNUSVZFX01BUF9LRVkgPSBtYXBLZXk7CiAgICBBQ1RJVkVfTUFQX0NPTkZJRyA9IE1BUF9DT05GSUdTW0FDVElWRV9NQVBfS0VZXTsKICAgIE1BSU5fQkFTRV9URUFNMV9QT1MgPSBBQ1RJVkVfTUFQX0NPTkZJRy50ZWFtMUJhc2U7CiAgICBNQUlOX0JBU0VfVEVBTTJfUE9TID0gQUNUSVZFX01BUF9DT05GSUcudGVhbTJCYXNlOwogICAgcmVmcmVzaFZlaGljbGVTcGF3blNwZWNzRnJvbU1vZGVDb25maWcoKTsKICAgIFZFSElDTEVfU1BBV05fWUFXX09GRlNFVF9ERUcgPSBBQ1RJVkVfTUFQX0NPTkZJRy52ZWhpY2xlU3Bhd25ZYXdPZmZzZXREZWc7CiAgICBBQ1RJVkVfT1ZFUlRJTUVfWk9ORVMgPSAoQUNUSVZFX01BUF9DT05GSUcub3ZlcnRpbWVab25lcyA/PyBbXSkubWFwKCh6b25lKSA9PiAoewogICAgICAgIGFyZWFUcmlnZ2VyT2JqSWQ6IHpvbmUuYXJlYVRyaWdnZXJPYmpJZCwKICAgICAgICBzZWN0b3JJZDogem9uZS5zZWN0b3JJZCwKICAgICAgICB3b3JsZEljb25PYmpJZDogem9uZS53b3JsZEljb25PYmpJZCwKICAgICAgICBjYXB0dXJlUG9pbnRPYmpJZDogem9uZS5jYXB0dXJlUG9pbnRPYmpJZCwKICAgIH0pKTsKICAgIC8vIEtlZXAgb3ZlcnRpbWUgem9uZXMgc3luY2VkIHdpdGggdGhlIGFjdGl2ZSBtYXAgY29uZmlnLgogICAgcmVmcmVzaE92ZXJ0aW1lWm9uZXNGcm9tTWFwQ29uZmlnKCk7CiAgICAvLyBBcHBseSB0aGUgbWFwJ3MgZGVmYXVsdCBhaXJjcmFmdCBjZWlsaW5nLCB1bmxlc3MgYSBjdXN0b20gb3ZlcnJpZGUgaXMgYWN0aXZlLgogICAgc3luY0FpcmNyYWZ0Q2VpbGluZ0Zyb21NYXBDb25maWcoKTsKCiAgICB1cGRhdGVSZWFkeURpYWxvZ01hcExhYmVsRm9yQWxsUGxheWVycygpOwogICAgdXBkYXRlVGVhbU5hbWVXaWRnZXRzRm9yQWxsUGxheWVycygpOwp9CgovLyBCZXN0LWVmZm9ydCBtYXAgZGV0ZWN0aW9uIGJ5IGNvbXBhcmluZyBIUSBwb3NpdGlvbnMgdG8gbWFwIGJhc2UgYW5jaG9ycyAoYmlkaXJlY3Rpb25hbCBjaGVjaykuCmZ1bmN0aW9uIGRldGVjdE1hcEtleUZyb21IcXMoKTogTWFwS2V5IHwgdW5kZWZpbmVkIHsKICAgIGNvbnN0IGhxMVBvcyA9IG1vZC5HZXRPYmplY3RQb3NpdGlvbihtb2QuR2V0SFEoMSkpOwogICAgY29uc3QgaHEyUG9zID0gbW9kLkdldE9iamVjdFBvc2l0aW9uKG1vZC5HZXRIUSgyKSk7CgogICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKE1BUF9DT05GSUdTKSBhcyBNYXBLZXlbXTsKICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHsKICAgICAgICBjb25zdCBjZmcgPSBNQVBfQ09ORklHU1trZXldOwogICAgICAgIGNvbnN0IGQxMSA9IG1vZC5EaXN0YW5jZUJldHdlZW4oaHExUG9zLCBjZmcudGVhbTFCYXNlKTsKICAgICAgICBjb25zdCBkMjIgPSBtb2QuRGlzdGFuY2VCZXR3ZWVuKGhxMlBvcywgY2ZnLnRlYW0yQmFzZSk7CiAgICAgICAgaWYgKGQxMSA8PSBNQVBfREVURUNUX0RJU1RBTkNFX01FVEVSUyAmJiBkMjIgPD0gTUFQX0RFVEVDVF9ESVNUQU5DRV9NRVRFUlMpIHsKICAgICAgICAgICAgcmV0dXJuIGtleTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGQxMiA9IG1vZC5EaXN0YW5jZUJldHdlZW4oaHExUG9zLCBjZmcudGVhbTJCYXNlKTsKICAgICAgICBjb25zdCBkMjEgPSBtb2QuRGlzdGFuY2VCZXR3ZWVuKGhxMlBvcywgY2ZnLnRlYW0xQmFzZSk7CiAgICAgICAgaWYgKGQxMiA8PSBNQVBfREVURUNUX0RJU1RBTkNFX01FVEVSUyAmJiBkMjEgPD0gTUFQX0RFVEVDVF9ESVNUQU5DRV9NRVRFUlMpIHsKICAgICAgICAgICAgcmV0dXJuIGtleTsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIHVuZGVmaW5lZDsKfQoKLy8gRmluZHMgdGhlIHByZXNldCBpbmRleCBtYXRjaGluZyBsZWZ0L3JpZ2h0IHBsYXllcnMgKyBraWxsIHRhcmdldDsgcmV0dXJucyAwIGlmIG5vIGV4YWN0IG1hdGNoLgpmdW5jdGlvbiBmaW5kTWF0Y2h1cFByZXNldEluZGV4KGxlZnRQbGF5ZXJzOiBudW1iZXIsIHJpZ2h0UGxheWVyczogbnVtYmVyLCByb3VuZEtpbGxzVGFyZ2V0OiBudW1iZXIpOiBudW1iZXIgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNQVRDSFVQX1BSRVNFVFMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBwcmVzZXQgPSBNQVRDSFVQX1BSRVNFVFNbaV07CiAgICAgICAgaWYgKAogICAgICAgICAgICBwcmVzZXQubGVmdFBsYXllcnMgPT09IGxlZnRQbGF5ZXJzICYmCiAgICAgICAgICAgIHByZXNldC5yaWdodFBsYXllcnMgPT09IHJpZ2h0UGxheWVycyAmJgogICAgICAgICAgICBwcmVzZXQucm91bmRLaWxsc1RhcmdldCA9PT0gcm91bmRLaWxsc1RhcmdldAogICAgICAgICkgewogICAgICAgICAgICByZXR1cm4gaTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gMDsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIE1hcCArIE1hdGNodXAgSGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gU3RyaW5nIFZhcmlhYmxlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0gU3RyaW5ncy5qc29uIGtleSBwb2xpY3kgLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8KLy8gLSBVSSBsYWJlbHMgKHN0YXRpYyB0ZXh0KSBzaG91bGQgYmUgc2hhcmVkIChlLmcuLCBMYWJlbF9Ub3RhbEtpbGxzKSByYXRoZXIgdGhhbiBkdXBsaWNhdGVkIHBlciB0ZWFtLgovLyAtIFBlci10ZWFtIGRpZmZlcmVuY2VzIGJlbG9uZyBpbiBsYXlvdXQvd2lkZ2V0IHBsYWNlbWVudCwgbm90IGluIGR1cGxpY2F0ZWQgbGFiZWwgc3RyaW5ncy4KLy8gLSBEeW5hbWljIHZhbHVlcyAobnVtYmVycykgYXJlIHVzdWFsbHkgd3JpdHRlbiBpbnRvIHZhbHVlIHdpZGdldHMgZGlyZWN0bHk7IGF2b2lkIGNyZWF0aW5nIG1hbnkgb25lLW9mZiBzdHJpbmdzLgovLyAtIElmIHlvdSBtdXN0IHVzZSBwbGFjZWhvbGRlcnMsIGtlZXAgZm9ybWF0dGluZyBjb25zaXN0ZW50IGFjcm9zcyB0aGUgZmlsZS4KLy8gLSBSZW1pbmRlcjogVUkgd2lkZ2V0IGBuYW1lOmAgdmFsdWVzIGFyZSBOT1QgU3RyaW5ncy5qc29uIGtleXM7IHRoZXkgYXJlIHJ1bnRpbWUgd2lkZ2V0IElEcy4KLy8KLy8gUG9saWN5IGNvbXBsaWFuY2UgY2hlY2tsaXN0OgovLyAtIE5ldyBVSSB0ZXh0IGFkZGVkPyBQdXQgaXQgaW4gU3RyaW5ncy5qc29uIHVuZGVyIGEgc2hhcmVkIGtleSAobm8gcGVyLXRlYW0gZHVwbGljYXRpb24pLgovLyAtIFVzaW5nIHBsYWNlaG9sZGVycz8gTWF0Y2ggZXhpc3RpbmcgZm9ybWF0dGluZyBwYXR0ZXJucyBmb3IgdGhhdCBzZWN0aW9uLgovLyAtIFJldXNpbmcgYW4gZXhpc3RpbmcgbGFiZWw/IFVzZSB0aGUgZXhpc3Rpbmcgc3RyaW5nIGtleSByYXRoZXIgdGhhbiBhIG5ldyBhbGlhcy4KLy8gLSBBdm9pZCBjcmVhdGluZyBzdHJpbmcga2V5IGNvbnN0YW50cyB1bmxlc3MgcmV1c2VkIGluIG11bHRpcGxlIHBsYWNlcy4KLy8KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBVSSB3aWRnZXQgSUQgY29uc3RhbnRzIChzdHJpbmcgcHJlZml4ZXMgdXNlZCB0byBmaW5kIHdpZGdldHMpLgovLyBBbGwgVUkgd2lkZ2V0IElEcyBhcmUgcGVyLXBsYXllcjsgdGhlIHZpZXdlcidzIHBpZCBpcyBhcHBlbmRlZCBhdCB1c2Ugc2l0ZXMuCmNvbnN0IFVJX1RFQU1TV0lUQ0hfQ09OVEFJTkVSX0JBU0VfSUQgPSAiVUlfVEVBTVNXSVRDSF9DT05UQUlORVJfQkFTRV8iOwpjb25zdCBVSV9URUFNU1dJVENIX0JPUkRFUl9UT1BfSUQgPSAiVUlfVEVBTVNXSVRDSF9CT1JERVJfVE9QXyI7CmNvbnN0IFVJX1RFQU1TV0lUQ0hfQk9SREVSX0JPVFRPTV9JRCA9ICJVSV9URUFNU1dJVENIX0JPUkRFUl9CT1RUT01fIjsKY29uc3QgVUlfVEVBTVNXSVRDSF9CT1JERVJfTEVGVF9JRCA9ICJVSV9URUFNU1dJVENIX0JPUkRFUl9MRUZUXyI7CmNvbnN0IFVJX1RFQU1TV0lUQ0hfQk9SREVSX1JJR0hUX0lEID0gIlVJX1RFQU1TV0lUQ0hfQk9SREVSX1JJR0hUXyI7CmNvbnN0IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX1RFQU0xX0lEID0gIlVJX1RFQU1TV0lUQ0hfQlVUVE9OX1RFQU0xXyI7CmNvbnN0IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX1RFQU0yX0lEID0gIlVJX1RFQU1TV0lUQ0hfQlVUVE9OX1RFQU0yXyI7CmNvbnN0IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX0NBTkNFTF9JRCA9ICJVSV9URUFNU1dJVENIX0JVVFRPTl9DQU5DRUxfIjsKY29uc3QgVUlfVEVBTVNXSVRDSF9CVVRUT05fQ0FOQ0VMX0xBQkVMX0lEID0gIlVJX1RFQU1TV0lUQ0hfQlVUVE9OX0NBTkNFTF9MQUJFTF8iOwpjb25zdCBVSV9URUFNU1dJVENIX0JVVFRPTl9PUFRPVVRfSUQgPSAiVUlfVEVBTVNXSVRDSF9CVVRUT05fT1BUT1VUXyI7CmNvbnN0IFVJX1RFQU1TV0lUQ0hfREVCVUdfVElNRUxJTUlUX0lEID0gIlVJX1RFQU1TV0lUQ0hfREVCVUdfVElNRUxJTUlUXyI7CgovLyBSZWFkeSBEaWFsb2cgKFJvc3RlciBVSSkgLSBXaWRnZXQgSUQgYmFzZXMgKHBlci1wbGF5ZXIgSURzIGFwcGVuZCB2aWV3ZXIgcGxheWVySWQpLgpjb25zdCBVSV9SRUFEWV9ESUFMT0dfSEVBREVSX0lEID0gIlVJX1JFQURZX0RJQUxPR19IRUFERVJfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0hFQURFUjJfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0hFQURFUjJfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0hFQURFUjNfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0hFQURFUjNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0hFQURFUjRfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0hFQURFUjRfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0hFQURFUjVfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0hFQURFUjVfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0hFQURFUjZfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0hFQURFUjZfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX1RFQU0xX0NPTlRBSU5FUl9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfVEVBTTFfQ09OVEFJTkVSXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19URUFNMl9DT05UQUlORVJfSUQgPSAiVUlfUkVBRFlfRElBTE9HX1RFQU0yX0NPTlRBSU5FUl8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfVEVBTTFfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX1RFQU0xX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19URUFNMl9MQUJFTF9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfVEVBTTJfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX1QxX1JPV19OQU1FX0lEID0gIlVJX1JFQURZX0RJQUxPR19UMV9ST1dfTkFNRV8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfVDFfUk9XX1JFQURZX0lEID0gIlVJX1JFQURZX0RJQUxPR19UMV9ST1dfUkVBRFlfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX1QxX1JPV19CQVNFX0lEID0gIlVJX1JFQURZX0RJQUxPR19UMV9ST1dfQkFTRV8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfVDJfUk9XX05BTUVfSUQgPSAiVUlfUkVBRFlfRElBTE9HX1QyX1JPV19OQU1FXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19UMl9ST1dfUkVBRFlfSUQgPSAiVUlfUkVBRFlfRElBTE9HX1QyX1JPV19SRUFEWV8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfVDJfUk9XX0JBU0VfSUQgPSAiVUlfUkVBRFlfRElBTE9HX1QyX1JPV19CQVNFXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19CVVRUT05fUkVBRFlfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9SRUFEWV8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1JFQURZX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19CVVRUT05fUkVBRFlfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9BVVRPX1JFQURZX0lEID0gIlVJX1JFQURZX0RJQUxPR19CVVRUT05fQVVUT19SRUFEWV8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX0FVVE9fUkVBRFlfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9BVVRPX1JFQURZX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19CVVRUT05fU1dBUF9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1NXQVBfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9TV0FQX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19CVVRUT05fU1dBUF9MQUJFTF8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfQkVTVE9GX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19CRVNUT0ZfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01BVENIVVBfREVDX0lEID0gIlVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0RFQ18iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9ERUNfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01BVENIVVBfREVDX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0lOQ19JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9JTkNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01BVENIVVBfSU5DX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0lOQ19MQUJFTF8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTUlOUExBWUVSU19ERUNfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01JTlBMQVlFUlNfREVDXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NSU5QTEFZRVJTX0RFQ19MQUJFTF9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTUlOUExBWUVSU19ERUNfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01JTlBMQVlFUlNfSU5DX0lEID0gIlVJX1JFQURZX0RJQUxPR19NSU5QTEFZRVJTX0lOQ18iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTUlOUExBWUVSU19JTkNfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01JTlBMQVlFUlNfSU5DX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX01JTlBMQVlFUlNfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01BVENIVVBfTUlOUExBWUVSU18iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9NSU5QTEFZRVJTX1RPVEFMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NQVRDSFVQX01JTlBMQVlFUlNfVE9UQUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01BVENIVVBfS0lMTFNUQVJHRVRfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01BVENIVVBfS0lMTFNUQVJHRVRfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01BUF9MQUJFTF9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTUFQX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NQVBfVkFMVUVfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01BUF9WQUxVRV8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTU9ERV9HQU1FX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NT0RFX0dBTUVfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfR0FNRV9ERUNfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfR0FNRV9ERUNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfR0FNRV9ERUNfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfR0FNRV9ERUNfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfR0FNRV9WQUxVRV9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTU9ERV9HQU1FX1ZBTFVFXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NT0RFX0dBTUVfSU5DX0lEID0gIlVJX1JFQURZX0RJQUxPR19NT0RFX0dBTUVfSU5DXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NT0RFX0dBTUVfSU5DX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NT0RFX0dBTUVfSU5DX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NT0RFX1NFVFRJTkdTX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NT0RFX1NFVFRJTkdTX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NT0RFX1NFVFRJTkdTX0RFQ19JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19ERUNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfU0VUVElOR1NfREVDX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NT0RFX1NFVFRJTkdTX0RFQ19MQUJFTF8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19WQUxVRV9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19WQUxVRV8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19JTkNfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfU0VUVElOR1NfSU5DXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NT0RFX1NFVFRJTkdTX0lOQ19MQUJFTF9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19JTkNfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfREVDX0lEID0gIlVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QxX0RFQ18iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMV9ERUNfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfREVDX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QxX1ZBTFVFX0lEID0gIlVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QxX1ZBTFVFXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QxX0lOQ19JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMV9JTkNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfSU5DX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QxX0lOQ19MQUJFTF8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMl9MQUJFTF9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMl9MQUJFTF8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMl9ERUNfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDJfREVDXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QyX0RFQ19MQUJFTF9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMl9ERUNfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDJfVkFMVUVfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDJfVkFMVUVfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDJfSU5DX0lEID0gIlVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QyX0lOQ18iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMl9JTkNfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDJfSU5DX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NT0RFX0NPTkZJUk1fSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfQ09ORklSTV8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTU9ERV9DT05GSVJNX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NT0RFX0NPTkZJUk1fTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfUkVTRVRfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfUkVTRVRfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01PREVfUkVTRVRfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01PREVfUkVTRVRfTEFCRUxfIjsKCi8vIEFkbWluL1Rlc3RlciBVSSAtIFdpZGdldCBJRCBiYXNlcyAocGVyLXBsYXllciBJRHMgYXBwZW5kIHZpZXdlciBwbGF5ZXJJZCkuCmNvbnN0IFVJX1RFU1RfSEVBREVSX0xBQkVMX0lEID0gIlVJX1RFU1RfSEVBREVSX0xBQkVMXyI7CmNvbnN0IFVJX1RFU1RfQlVUVE9OX0xFRlRfV0lOU19ERUNfSUQgPSAiVUlfVEVTVF9CVVRUT05fTEVGVF9XSU5TX0RFQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9MRUZUX1dJTlNfSU5DX0lEID0gIlVJX1RFU1RfQlVUVE9OX0xFRlRfV0lOU19JTkNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fUklHSFRfV0lOU19ERUNfSUQgPSAiVUlfVEVTVF9CVVRUT05fUklHSFRfV0lOU19ERUNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fUklHSFRfV0lOU19JTkNfSUQgPSAiVUlfVEVTVF9CVVRUT05fUklHSFRfV0lOU19JTkNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fTEVGVF9LSUxMU19ERUNfSUQgPSAiVUlfVEVTVF9CVVRUT05fTEVGVF9LSUxMU19ERUNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fTEVGVF9LSUxMU19JTkNfSUQgPSAiVUlfVEVTVF9CVVRUT05fTEVGVF9LSUxMU19JTkNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fUklHSFRfS0lMTFNfREVDX0lEID0gIlVJX1RFU1RfQlVUVE9OX1JJR0hUX0tJTExTX0RFQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9SSUdIVF9LSUxMU19JTkNfSUQgPSAiVUlfVEVTVF9CVVRUT05fUklHSFRfS0lMTFNfSU5DXyI7CmNvbnN0IFVJX0FETUlOX0JVVFRPTl9UMV9ST1VORF9LSUxMU19ERUNfSUQgPSAiVUlfQURNSU5fQlVUVE9OX1QxX1JPVU5EX0tJTExTX0RFQ18iOwpjb25zdCBVSV9BRE1JTl9CVVRUT05fVDFfUk9VTkRfS0lMTFNfSU5DX0lEID0gIlVJX0FETUlOX0JVVFRPTl9UMV9ST1VORF9LSUxMU19JTkNfIjsKY29uc3QgVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0RFQ19JRCA9ICJVSV9BRE1JTl9CVVRUT05fVDJfUk9VTkRfS0lMTFNfREVDXyI7CmNvbnN0IFVJX0FETUlOX0JVVFRPTl9UMl9ST1VORF9LSUxMU19JTkNfSUQgPSAiVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0lOQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9ST1VORF9LSUxMU19UQVJHRVRfREVDX0lEID0gIlVJX1RFU1RfQlVUVE9OX1JPVU5EX0tJTExTX1RBUkdFVF9ERUNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fUk9VTkRfS0lMTFNfVEFSR0VUX0lOQ19JRCA9ICJVSV9URVNUX0JVVFRPTl9ST1VORF9LSUxMU19UQVJHRVRfSU5DXyI7CmNvbnN0IFVJX1RFU1RfTEFCRUxfUk9VTkRfS0lMTFNfVEFSR0VUX0lEID0gIlVJX1RFU1RfTEFCRUxfUk9VTkRfS0lMTFNfVEFSR0VUXyI7CmNvbnN0IFVJX1RFU1RfVkFMVUVfUk9VTkRfS0lMTFNfVEFSR0VUX0lEID0gIlVJX1RFU1RfVkFMVUVfUk9VTkRfS0lMTFNfVEFSR0VUXyI7CmNvbnN0IFVJX1RFU1RfQlVUVE9OX1RJRVNfREVDX0lEID0gIlVJX1RFU1RfQlVUVE9OX1RJRVNfREVDXyI7CmNvbnN0IFVJX1RFU1RfQlVUVE9OX1RJRVNfSU5DX0lEID0gIlVJX1RFU1RfQlVUVE9OX1RJRVNfSU5DXyI7CmNvbnN0IFVJX1RFU1RfQlVUVE9OX0NVUl9ST1VORF9ERUNfSUQgPSAiVUlfVEVTVF9CVVRUT05fQ1VSX1JPVU5EX0RFQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9DVVJfUk9VTkRfSU5DX0lEID0gIlVJX1RFU1RfQlVUVE9OX0NVUl9ST1VORF9JTkNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fQ0xPQ0tfVElNRV9ERUNfSUQgPSAiVUlfVEVTVF9CVVRUT05fQ0xPQ0tfVElNRV9ERUNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fQ0xPQ0tfVElNRV9JTkNfSUQgPSAiVUlfVEVTVF9CVVRUT05fQ0xPQ0tfVElNRV9JTkNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fQ0xPQ0tfUkVTRVRfSUQgPSAiVUlfVEVTVF9CVVRUT05fQ0xPQ0tfUkVTRVRfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fUk9VTkRfU1RBUlRfSUQgPSAiVUlfVEVTVF9CVVRUT05fUk9VTkRfU1RBUlRfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fUk9VTkRfRU5EX0lEID0gIlVJX1RFU1RfQlVUVE9OX1JPVU5EX0VORF8iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9QT1NfREVCVUdfSUQgPSAiVUlfVEVTVF9CVVRUT05fUE9TX0RFQlVHXyI7CmNvbnN0IFVJX1RFU1RfTEFCRUxfTEVGVF9XSU5TX0lEID0gIlVJX1RFU1RfTEFCRUxfTEVGVF9XSU5TXyI7CmNvbnN0IFVJX1RFU1RfTEFCRUxfUklHSFRfV0lOU19JRCA9ICJVSV9URVNUX0xBQkVMX1JJR0hUX1dJTlNfIjsKY29uc3QgVUlfVEVTVF9MQUJFTF9MRUZUX0tJTExTX0lEID0gIlVJX1RFU1RfTEFCRUxfTEVGVF9LSUxMU18iOwpjb25zdCBVSV9URVNUX0xBQkVMX1JJR0hUX0tJTExTX0lEID0gIlVJX1RFU1RfTEFCRUxfUklHSFRfS0lMTFNfIjsKY29uc3QgVUlfQURNSU5fTEFCRUxfVDFfUk9VTkRfS0lMTFNfSUQgPSAiVUlfQURNSU5fTEFCRUxfVDFfUk9VTkRfS0lMTFNfIjsKY29uc3QgVUlfQURNSU5fTEFCRUxfVDJfUk9VTkRfS0lMTFNfSUQgPSAiVUlfQURNSU5fTEFCRUxfVDJfUk9VTkRfS0lMTFNfIjsKY29uc3QgVUlfVEVTVF9MQUJFTF9USUVTX0lEID0gIlVJX1RFU1RfTEFCRUxfVElFU18iOwpjb25zdCBVSV9URVNUX0xBQkVMX0NVUl9ST1VORF9JRCA9ICJVSV9URVNUX0xBQkVMX0NVUl9ST1VORF8iOwpjb25zdCBVSV9URVNUX0xBQkVMX0NMT0NLX1RJTUVfSUQgPSAiVUlfVEVTVF9MQUJFTF9DTE9DS19USU1FXyI7CmNvbnN0IFVJX1RFU1RfUExVU19URVhUX0lEID0gIlVJX1RFU1RfUExVU19URVhUXyI7CmNvbnN0IFVJX1RFU1RfTUlOVVNfVEVYVF9JRCA9ICJVSV9URVNUX01JTlVTX1RFWFRfIjsKY29uc3QgVUlfVEVTVF9SRVNFVF9URVhUX0lEID0gIlVJX1RFU1RfUkVTRVRfVEVYVF8iOwpjb25zdCBVSV9URVNUX1JPVU5EX1NUQVJUX1RFWFRfSUQgPSAiVUlfVEVTVF9ST1VORF9TVEFSVF9URVhUXyI7CmNvbnN0IFVJX1RFU1RfUk9VTkRfRU5EX1RFWFRfSUQgPSAiVUlfVEVTVF9ST1VORF9FTkRfVEVYVF8iOwpjb25zdCBVSV9URVNUX1BPU19ERUJVR19URVhUX0lEID0gIlVJX1RFU1RfUE9TX0RFQlVHX1RFWFRfIjsKY29uc3QgVUlfQURNSU5fVElFQlJFQUtFUl9MQUJFTF9JRCA9ICJVSV9BRE1JTl9USUVCUkVBS0VSX0xBQkVMXyI7CmNvbnN0IFVJX0FETUlOX1RJRUJSRUFLRVJfQlVUVE9OX0lEID0gIlVJX0FETUlOX1RJRUJSRUFLRVJfQlVUVE9OXyI7CmNvbnN0IFVJX0FETUlOX1RJRUJSRUFLRVJfQlVUVE9OX1RFWFRfSUQgPSAiVUlfQURNSU5fVElFQlJFQUtFUl9CVVRUT05fVEVYVF8iOwpjb25zdCBVSV9BRE1JTl9USUVCUkVBS0VSX01PREVfREVDX0lEID0gIlVJX0FETUlOX1RJRUJSRUFLRVJfTU9ERV9ERUNfIjsKY29uc3QgVUlfQURNSU5fVElFQlJFQUtFUl9NT0RFX0lOQ19JRCA9ICJVSV9BRE1JTl9USUVCUkVBS0VSX01PREVfSU5DXyI7CmNvbnN0IFVJX0FETUlOX1RJRUJSRUFLRVJfTU9ERV9MQUJFTF9JRCA9ICJVSV9BRE1JTl9USUVCUkVBS0VSX01PREVfTEFCRUxfIjsKY29uc3QgVUlfQURNSU5fVElFQlJFQUtFUl9NT0RFX0hFQURFUl9JRCA9ICJVSV9BRE1JTl9USUVCUkVBS0VSX01PREVfSEVBREVSXyI7CmNvbnN0IFVJX0FETUlOX0xJVkVfUkVTUEFXTl9CVVRUT05fSUQgPSAiVUlfQURNSU5fTElWRV9SRVNQQVdOX0JVVFRPTl8iOwpjb25zdCBVSV9BRE1JTl9MSVZFX1JFU1BBV05fVEVYVF9JRCA9ICJVSV9BRE1JTl9MSVZFX1JFU1BBV05fVEVYVF8iOwpjb25zdCBVSV9BRE1JTl9ST1VORF9MRU5HVEhfREVDX0lEID0gIlVJX0FETUlOX1JPVU5EX0xFTkdUSF9ERUNfIjsKY29uc3QgVUlfQURNSU5fUk9VTkRfTEVOR1RIX0lOQ19JRCA9ICJVSV9BRE1JTl9ST1VORF9MRU5HVEhfSU5DXyI7CmNvbnN0IFVJX0FETUlOX1JPVU5EX0xFTkdUSF9MQUJFTF9JRCA9ICJVSV9BRE1JTl9ST1VORF9MRU5HVEhfTEFCRUxfIjsKCi8vIERlYnVnIFBvc2l0aW9uaW5nIFVJCmNvbnN0IFVJX1BPU19ERUJVR19DT05UQUlORVJfSUQgPSAiVUlfUE9TX0RFQlVHX0NPTlRBSU5FUl8iOwpjb25zdCBVSV9QT1NfREVCVUdfWF9JRCA9ICJVSV9QT1NfREVCVUdfWF8iOwpjb25zdCBVSV9QT1NfREVCVUdfWV9JRCA9ICJVSV9QT1NfREVCVUdfWV8iOwpjb25zdCBVSV9QT1NfREVCVUdfWl9JRCA9ICJVSV9QT1NfREVCVUdfWl8iOwpjb25zdCBVSV9QT1NfREVCVUdfUk9UWV9JRCA9ICJVSV9QT1NfREVCVUdfUk9UWV8iOwoKLy8gQWRtaW4gUGFuZWwgKGRlY291cGxlZCBmcm9tIG1haW4gVGVhbSBTd2l0Y2ggZGlhbG9nKQpjb25zdCBVSV9BRE1JTl9QQU5FTF9CVVRUT05fSUQgPSAiVUlfQURNSU5fUEFORUxfQlVUVE9OXyI7CmNvbnN0IFVJX0FETUlOX1BBTkVMX0JVVFRPTl9MQUJFTF9JRCA9ICJVSV9BRE1JTl9QQU5FTF9CVVRUT05fTEFCRUxfIjsKY29uc3QgVUlfQURNSU5fUEFORUxfQ09OVEFJTkVSX0lEID0gIlVJX0FETUlOX1BBTkVMX0NPTlRBSU5FUl8iOwoKLy8gIk92ZXIgdGhlIGxpbmUiIG1lc3NhZ2luZyBzdHJpbmdzCmNvbnN0IEJJR19USVRMRV9XSURHRVRfSUQgPSAiQmlnVGl0bGVfIjsKY29uc3QgQklHX1NVQlRJVExFX1dJREdFVF9JRCA9ICJCaWdTdWJ0aXRsZV8iOwpjb25zdCBCSUdfVElUTEVfU0hBRE9XX1dJREdFVF9JRCA9ICJCaWdUaXRsZVNoYWRvd18iOwpjb25zdCBCSUdfU1VCVElUTEVfU0hBRE9XX1dJREdFVF9JRCA9ICJCaWdTdWJ0aXRsZVNoYWRvd18iOwoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tIFN0cmluZyBWYXJpYWJsZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIENvcmUgZ2FtZXBsYXkgc3RhdGUgaGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gQ29yZSBnYW1lcGxheSBoZWxwZXIgdXRpbGl0aWVzIChzdGF0ZSBzeW5jICsgbWVzc2FnaW5nIGdhdGVzKS4KCmZ1bmN0aW9uIGdldE1hdGNoV2luc1RlYW0odGVhbU51bTogVGVhbUlEKTogbnVtYmVyIHsKICAgIC8vIERlYnVnLW9ubHk6IGVuZ2luZSBHYW1lTW9kZVNjb3JlIGNhbiBiZSB0cmFuc2llbnQgZHVyaW5nIHJlY29ubmVjdHMgLyB0ZWFtIHN3YXBzLgogICAgcmV0dXJuIE1hdGguZmxvb3IobW9kLkdldEdhbWVNb2RlU2NvcmUobW9kLkdldFRlYW0odGVhbU51bSkpKTsKfQoKZnVuY3Rpb24gc2V0TWF0Y2hXaW5zVGVhbSh0ZWFtTnVtOiBUZWFtSUQsIHdpbnM6IG51bWJlcik6IHZvaWQgewogICAgbW9kLlNldEdhbWVNb2RlU2NvcmUobW9kLkdldFRlYW0odGVhbU51bSksIE1hdGgubWF4KDAsIE1hdGguZmxvb3Iod2lucykpKTsKfQoKLy8gQ2VudHJhbCBtZXNzYWdlLWdhdGluZyBwb2xpY3k6IGdhbWVwbGF5IHZzIGRlYnVnLCBhbmQgaGlnaGxpZ2h0ZWQgdnMgbm90aWZpY2F0aW9uLgpmdW5jdGlvbiBzaG91bGRTZW5kTWVzc2FnZShpc0dhbWVwbGF5OiBib29sZWFuLCBpc0hpZ2hsaWdodGVkOiBib29sZWFuKTogYm9vbGVhbiB7CiAgICBpZiAoaXNHYW1lcGxheSkgcmV0dXJuIEVOQUJMRV9HQU1FUExBWV9NRVNTQUdFUzsKICAgIHJldHVybiBpc0hpZ2hsaWdodGVkID8gRU5BQkxFX0RFQlVHX0hJR0hMSUdIVEVEX01FU1NBR0VTIDogRU5BQkxFX0RFQlVHX05PVElGSUNBVElPTl9NRVNTQUdFUzsKfQoKZnVuY3Rpb24gc2V0VUlJbnB1dE1vZGVGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyLCBlbmFibGVkOiBib29sZWFuKTogdm9pZCB7CiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuOwogICAgbW9kLkVuYWJsZVVJSW5wdXRNb2RlKGVuYWJsZWQsIHBsYXllcik7CiAgICBTdGF0ZS5wbGF5ZXJzLnVpSW5wdXRFbmFibGVkQnlQaWRbbW9kLkdldE9iaklkKHBsYXllcildID0gZW5hYmxlZDsKfQoKZnVuY3Rpb24gbm90ZUhpZ2hsaWdodGVkTWVzc2FnZVNlbnQobWVzc2FnZUtleT86IG51bWJlcik6IHZvaWQgewogICAgU3RhdGUuZGVidWcuaGlnaGxpZ2h0ZWRNZXNzYWdlQ291bnQgPSBTdGF0ZS5kZWJ1Zy5oaWdobGlnaHRlZE1lc3NhZ2VDb3VudCArIDE7CiAgICBTdGF0ZS5kZWJ1Zy5sYXN0SGlnaGxpZ2h0ZWRNZXNzYWdlQXRTZWNvbmRzID0gTWF0aC5mbG9vcihtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpKTsKICAgIGlmIChtZXNzYWdlS2V5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBTdGF0ZS5kZWJ1Zy5sYXN0SGlnaGxpZ2h0ZWRNZXNzYWdlS2V5ID0gbWVzc2FnZUtleTsKICAgIH0KfQoKLy8gUm91bmQgcGhhc2UgaGVscGVyIGZvciByZWFkYWJpbGl0eSAoYXZvaWRzIHNjYXR0ZXJlZCBlbnVtIGNvbXBhcmlzb25zKS4KZnVuY3Rpb24gaXNSb3VuZExpdmUoKTogYm9vbGVhbiB7CiAgICByZXR1cm4gU3RhdGUucm91bmQucGhhc2UgPT09IFJvdW5kUGhhc2UuTGl2ZTsKfQoKLy8gUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiB0ZWFtIGN1cnJlbnRseSBoYXMgYXQgbGVhc3Qgb25lIHZhbGlkIHBsYXllci4KZnVuY3Rpb24gaGFzUGxheWVyc09uVGVhbSh0ZWFtOiBtb2QuVGVhbSk6IGJvb2xlYW4gewogICAgaWYgKG1vZC5FcXVhbHModGVhbSwgbW9kLkdldFRlYW0oMCkpKSByZXR1cm4gZmFsc2U7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGlmIChtb2QuRXF1YWxzKG1vZC5HZXRUZWFtKHApLCB0ZWFtKSkgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn0KCi8vIE5vdGlmaWNhdGlvbiBjaGFubmVsIHdyYXBwZXI7IHJlc3BlY3RzIGdhbWVwbGF5L2RlYnVnIGdhdGVzIGFuZCBvcHRpb25hbCB0YXJnZXQuCmZ1bmN0aW9uIHNlbmROb3RpZmljYXRpb25NZXNzYWdlKG1lc3NhZ2U6IG1vZC5NZXNzYWdlLCBpc0dhbWVwbGF5OiBib29sZWFuLCB0YXJnZXQ/OiBtb2QuUGxheWVyIHwgbW9kLlRlYW0pOiB2b2lkIHsKICAgIGlmICghc2hvdWxkU2VuZE1lc3NhZ2UoaXNHYW1lcGxheSwgZmFsc2UpKSByZXR1cm47CiAgICBpZiAodGFyZ2V0KSB7CiAgICAgICAgLy8gUm91dGUgdG8gdGhlIGNvcnJlY3Qgb3ZlcmxvYWQ7IFRlYW0gY2FzdC1hcy1QbGF5ZXIgY2FuIHNpbGVudGx5IGRyb3AgbWVzc2FnZXMgYWZ0ZXIgdGVhbSBzd2l0Y2hlcy4KICAgICAgICBpZiAobW9kLklzVHlwZSh0YXJnZXQsIG1vZC5UeXBlcy5UZWFtKSkgewogICAgICAgICAgICBjb25zdCB0ZWFtVGFyZ2V0ID0gdGFyZ2V0IGFzIG1vZC5UZWFtOwogICAgICAgICAgICBpZiAoIWhhc1BsYXllcnNPblRlYW0odGVhbVRhcmdldCkpIHJldHVybjsKICAgICAgICAgICAgbW9kLkRpc3BsYXlOb3RpZmljYXRpb25NZXNzYWdlKG1lc3NhZ2UsIHRlYW1UYXJnZXQpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChtb2QuSXNUeXBlKHRhcmdldCwgbW9kLlR5cGVzLlBsYXllcikpIHsKICAgICAgICAgICAgY29uc3QgcGxheWVyVGFyZ2V0ID0gdGFyZ2V0IGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgICAgIGlmICghcGxheWVyVGFyZ2V0IHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXJUYXJnZXQpKSByZXR1cm47CiAgICAgICAgICAgIG1vZC5EaXNwbGF5Tm90aWZpY2F0aW9uTWVzc2FnZShtZXNzYWdlLCBwbGF5ZXJUYXJnZXQpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgIH0KICAgIG1vZC5EaXNwbGF5Tm90aWZpY2F0aW9uTWVzc2FnZShtZXNzYWdlKTsKfQoKLy8gV29ybGQtbG9nIHdyYXBwZXI7IHJlc3BlY3RzIGdhbWVwbGF5L2RlYnVnIGdhdGVzIGFuZCBvcHRpb25hbCB0YXJnZXQuCmZ1bmN0aW9uIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtZXNzYWdlOiBtb2QuTWVzc2FnZSwgaXNHYW1lcGxheTogYm9vbGVhbiwgdGFyZ2V0PzogbW9kLlBsYXllciB8IG1vZC5UZWFtLCBkZWJ1Z0tleT86IG51bWJlcik6IHZvaWQgewogICAgaWYgKCFzaG91bGRTZW5kTWVzc2FnZShpc0dhbWVwbGF5LCB0cnVlKSkgcmV0dXJuOwogICAgbm90ZUhpZ2hsaWdodGVkTWVzc2FnZVNlbnQoZGVidWdLZXkpOwogICAgaWYgKHRhcmdldCkgewogICAgICAgIC8vIFJvdXRlIHRvIHRoZSBjb3JyZWN0IG92ZXJsb2FkOyBUZWFtIGNhc3QtYXMtUGxheWVyIGNhbiBzaWxlbnRseSBkcm9wIG1lc3NhZ2VzIGFmdGVyIHRlYW0gc3dpdGNoZXMuCiAgICAgICAgaWYgKG1vZC5Jc1R5cGUodGFyZ2V0LCBtb2QuVHlwZXMuVGVhbSkpIHsKICAgICAgICAgICAgY29uc3QgdGVhbVRhcmdldCA9IHRhcmdldCBhcyBtb2QuVGVhbTsKICAgICAgICAgICAgaWYgKCFoYXNQbGF5ZXJzT25UZWFtKHRlYW1UYXJnZXQpKSByZXR1cm47CiAgICAgICAgICAgIG1vZC5EaXNwbGF5SGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UobWVzc2FnZSwgdGVhbVRhcmdldCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKG1vZC5Jc1R5cGUodGFyZ2V0LCBtb2QuVHlwZXMuUGxheWVyKSkgewogICAgICAgICAgICBjb25zdCBwbGF5ZXJUYXJnZXQgPSB0YXJnZXQgYXMgbW9kLlBsYXllcjsKICAgICAgICAgICAgaWYgKCFwbGF5ZXJUYXJnZXQgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllclRhcmdldCkpIHJldHVybjsKICAgICAgICAgICAgbW9kLkRpc3BsYXlIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtZXNzYWdlLCBwbGF5ZXJUYXJnZXQpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgIH0KICAgIG1vZC5EaXNwbGF5SGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UobWVzc2FnZSk7Cn0KCgovLyBDUCB2aXNpYmlsaXR5IGRlYnVnIGhlbHBlciAoaGlnaGxpZ2h0ZWQgd29ybGQgbG9nKS4KZnVuY3Rpb24gbG9nQ2FwdHVyZVBvaW50VmlzaWJpbGl0eURlYnVnKG1lc3NhZ2VLZXk6IG51bWJlcik6IHZvaWQgewogICAgaWYgKCFFTkFCTEVfQ1BfVklTX0RFQlVHKSByZXR1cm47CiAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgbW9kLk1lc3NhZ2UobWVzc2FnZUtleSksCiAgICAgICAgdHJ1ZSwKICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgbWVzc2FnZUtleQogICAgKTsKfQoKLy8gU3luY2hyb25pemVzIEhVRCB3aW4gY291bnRlcnMgZnJvbSBhdXRob3JpdGF0aXZlIG1hdGNoIHN0YXRlLgovLyBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgYW55IGFkbWluIG9yIGdhbWVwbGF5IG11dGF0aW9uIG9mIFN0YXRlLm1hdGNoLndpbnNUMS9UMi4KZnVuY3Rpb24gc3luY1dpbkNvdW50ZXJzSHVkRnJvbUdhbWVNb2RlU2NvcmUoKTogdm9pZCB7CiAgICAvLyBEZWJ1Zy1vbmx5OiBkbyBub3QgdXNlIGZvciBhdXRob3JpdGF0aXZlIHN0YXRlOyBwdWxsaW5nIGZyb20gZW5naW5lIGhlcmUgY2FuIGxhdGNoIHRyYW5zaWVudCB2YWx1ZXMuCiAgICBjb25zdCB0MVdpbnMgPSBnZXRNYXRjaFdpbnNUZWFtKFRlYW1JRC5UZWFtMSk7CiAgICBjb25zdCB0MldpbnMgPSBnZXRNYXRjaFdpbnNUZWFtKFRlYW1JRC5UZWFtMik7CgogICAgU3RhdGUubWF0Y2gud2luc1QxID0gdDFXaW5zOwogICAgU3RhdGUubWF0Y2gud2luc1QyID0gdDJXaW5zOwogICAgc3luY1JvdW5kUmVjb3JkSHVkRm9yQWxsUGxheWVycygpOwogICAgc2V0VHJlbmRpbmdXaW5uZXJDcm93bkZvckFsbFBsYXllcnMoKTsKCiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHJlZnMgPSBlbnN1cmVIdWRGb3JQbGF5ZXIocCk7CiAgICAgICAgaWYgKCFyZWZzKSBjb250aW51ZTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLmxlZnRXaW5zVGV4dCwgdDFXaW5zKTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJpZ2h0V2luc1RleHQsIHQyV2lucyk7CiAgICB9Cn0KCmZ1bmN0aW9uIGVuZEdhbWVNb2RlRm9yVGVhbU51bSh0ZWFtTnVtOiBUZWFtSUQgfCAwKTogdm9pZCB7CiAgICBjb25zdCB3aW5uaW5nVGVhbSA9IG1vZC5HZXRUZWFtKHRlYW1OdW0pOwoKICAgIC8vIEVuZCB0aGUgbWF0Y2ggYnkgdGVhbSBjb25zaXN0ZW50bHk7IGVuZGluZyAiYnkgcGxheWVyIiBjYW4geWllbGQgaW5jb25zaXN0ZW50IGVuZ2luZSBmaW5hbGl6YXRpb24KICAgIC8vIHdoZW4gcGxheWVycyByZWNvbm5lY3Qgb3IgYnJpZWZseSBqb2luIGRpZmZlcmVudCB0ZWFtcy4KICAgIG1vZC5FbmRHYW1lTW9kZSh3aW5uaW5nVGVhbSk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBDb3JlIGdhbWVwbGF5IHN0YXRlIGhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFNoYXJlZCBJRCBoZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBnZXRPYmpJZChvYmo6IGFueSk6IG51bWJlciB7CiAgICByZXR1cm4gbW9kLkdldE9iaklkKG9iaik7Cn0KCmZ1bmN0aW9uIHNhZmVHZXRPYmpJZChvYmo6IGFueSk6IG51bWJlciB8IHVuZGVmaW5lZCB7CiAgICBpZiAoIW9iaikgcmV0dXJuIHVuZGVmaW5lZDsKICAgIHRyeSB7CiAgICAgICAgcmV0dXJuIG1vZC5HZXRPYmpJZChvYmopOwogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KfQoKLy8gR3VhcmRlZCBwaWQgcmVzb2x1dGlvbiBmb3IgZGlzY29ubmVjdCByYWNlIHdpbmRvd3MgaW4gaG90IHBhdGhzLgpmdW5jdGlvbiBzYWZlR2V0UGxheWVySWQocGxheWVyOiBtb2QuUGxheWVyIHwgbnVsbCB8IHVuZGVmaW5lZCk6IG51bWJlciB8IHVuZGVmaW5lZCB7CiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIHRyeSB7CiAgICAgICAgcmV0dXJuIG1vZC5HZXRPYmpJZChwbGF5ZXIpOwogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KfQoKZnVuY3Rpb24gaXNQaWREaXNjb25uZWN0ZWQocGlkOiBudW1iZXIpOiBib29sZWFuIHsKICAgIHJldHVybiBTdGF0ZS5wbGF5ZXJzLmRpc2Nvbm5lY3RlZEJ5UGlkW3BpZF0gPT09IHRydWU7Cn0KCmZ1bmN0aW9uIGdldFRlYW1OdW1iZXIodGVhbTogbW9kLlRlYW0pOiBUZWFtSUQgfCAwIHsKICAgIGlmIChtb2QuRXF1YWxzKHRlYW0sIG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMSkpKSByZXR1cm4gVGVhbUlELlRlYW0xOwogICAgaWYgKG1vZC5FcXVhbHModGVhbSwgbW9kLkdldFRlYW0oVGVhbUlELlRlYW0yKSkpIHJldHVybiBUZWFtSUQuVGVhbTI7CiAgICByZXR1cm4gMDsKfQoKZnVuY3Rpb24gc2FmZUdldFRlYW1OdW1iZXJGcm9tUGxheWVyKAogICAgcGxheWVyOiBtb2QuUGxheWVyIHwgbnVsbCB8IHVuZGVmaW5lZCwKICAgIGZhbGxiYWNrOiBUZWFtSUQgfCAwID0gMAopOiBUZWFtSUQgfCAwIHsKICAgIGlmICghcGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXIpKSByZXR1cm4gZmFsbGJhY2s7CiAgICB0cnkgewogICAgICAgIHJldHVybiBnZXRUZWFtTnVtYmVyKG1vZC5HZXRUZWFtKHBsYXllcikpOwogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuIGZhbGxiYWNrOwogICAgfQp9CgpmdW5jdGlvbiBpc1BsYXllckRlcGxveWVkKHBsYXllcjogbW9kLlBsYXllcik6IGJvb2xlYW4gewogICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChwbGF5ZXIpOwogICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZmFsc2U7CiAgICByZXR1cm4gISFTdGF0ZS5wbGF5ZXJzLmRlcGxveWVkQnlQaWRbcGlkXTsKfQoKLy8gU2FmZSBHZXRTb2xkaWVyU3RhdGUgd3JhcHBlcnM6IGF2b2lkIGVuZ2luZSBlcnJvcnMgZHVyaW5nIHVuZGVwbG95L2NsZWFudXAgYW5kIGtlZXAgZGVwbG95IHN0YXRlIGluIHN5bmMuCmZ1bmN0aW9uIHNhZmVHZXRTb2xkaWVyU3RhdGVCb29sKHBsYXllcjogbW9kLlBsYXllciwgc3RhdGVLZXk6IGFueSwgZmFsbGJhY2s6IGJvb2xlYW4gPSBmYWxzZSk6IGJvb2xlYW4gewogICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIHJldHVybiBmYWxsYmFjazsKICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChwbGF5ZXIpKSByZXR1cm4gZmFsbGJhY2s7CiAgICB0cnkgewogICAgICAgIHJldHVybiAhIW1vZC5HZXRTb2xkaWVyU3RhdGUocGxheWVyLCBzdGF0ZUtleSk7CiAgICB9IGNhdGNoIHsKICAgICAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocGxheWVyKTsKICAgICAgICBpZiAocGlkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgU3RhdGUucGxheWVycy5kZXBsb3llZEJ5UGlkW3BpZF0gPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbGxiYWNrOwogICAgfQp9CgpmdW5jdGlvbiBzYWZlR2V0U29sZGllclN0YXRlVmVjdG9yKHBsYXllcjogbW9kLlBsYXllciwgc3RhdGVLZXk6IGFueSk6IG1vZC5WZWN0b3IgfCB1bmRlZmluZWQgewogICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIHJldHVybiB1bmRlZmluZWQ7CiAgICBpZiAoIWlzUGxheWVyRGVwbG95ZWQocGxheWVyKSkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIHRyeSB7CiAgICAgICAgcmV0dXJuIG1vZC5HZXRTb2xkaWVyU3RhdGUocGxheWVyLCBzdGF0ZUtleSkgYXMgdW5rbm93biBhcyBtb2QuVmVjdG9yOwogICAgfSBjYXRjaCB7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICAgICAgaWYgKHBpZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIFN0YXRlLnBsYXllcnMuZGVwbG95ZWRCeVBpZFtwaWRdID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9Cn0KCmZ1bmN0aW9uIGdldFRlYW1OYW1lS2V5KHRlYW1OdW06IFRlYW1JRCB8IDApOiBudW1iZXIgewogICAgaWYgKHRlYW1OdW0gPT09IFRlYW1JRC5UZWFtMSkgcmV0dXJuIEFDVElWRV9NQVBfQ09ORklHPy50ZWFtMU5hbWUgPz8gbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLldFU1Q7CiAgICBpZiAodGVhbU51bSA9PT0gVGVhbUlELlRlYW0yKSByZXR1cm4gQUNUSVZFX01BUF9DT05GSUc/LnRlYW0yTmFtZSA/PyBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuRUFTVDsKICAgIHJldHVybiBtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLnVua25vd25QbGF5ZXI7Cn0KCmZ1bmN0aW9uIG9wcG9zaW5nVGVhbSh0ZWFtTnVtOiBUZWFtSUQgfCAwKTogVGVhbUlEIHwgMCB7CiAgICBpZiAodGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSByZXR1cm4gVGVhbUlELlRlYW0yOwogICAgaWYgKHRlYW1OdW0gPT09IFRlYW1JRC5UZWFtMikgcmV0dXJuIFRlYW1JRC5UZWFtMTsKICAgIHJldHVybiAwOwp9CgpmdW5jdGlvbiBzYWZlRmluZChuYW1lOiBzdHJpbmcpOiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQgewogICAgdHJ5IHsKICAgICAgICByZXR1cm4gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKG5hbWUsIG1vZC5HZXRVSVJvb3QoKSkgYXMgbW9kLlVJV2lkZ2V0OwogICAgfSBjYXRjaCB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShuYW1lKSBhcyBtb2QuVUlXaWRnZXQ7CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgICAgfQogICAgfQp9CgovLyBPdXRsaW5lZCBidXR0b24gaGVscGVyOiB3cmFwcyBhIHNvbGlkIGJ1dHRvbiBpbnNpZGUgYSB0aGluLW91dGxpbmUgY29udGFpbmVyLgpmdW5jdGlvbiBhZGRPdXRsaW5lZEJ1dHRvbigKICAgIGJ1dHRvbklkOiBzdHJpbmcsCiAgICBwb3NYOiBudW1iZXIsCiAgICBwb3NZOiBudW1iZXIsCiAgICBzaXplWDogbnVtYmVyLAogICAgc2l6ZVk6IG51bWJlciwKICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLAogICAgcGFyZW50OiBtb2QuVUlXaWRnZXQsCiAgICBwbGF5ZXI6IG1vZC5QbGF5ZXIsCiAgICBib3JkZXJQYWRkaW5nOiBudW1iZXIgPSBCVVRUT05fQk9SREVSX1BBRERJTkcKKTogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkIHsKICAgIGNvbnN0IGJvcmRlcklkID0gYCR7YnV0dG9uSWR9X0JPUkRFUmA7CiAgICBjb25zdCBib3JkZXJTaXplWCA9IHNpemVYICsgKGJvcmRlclBhZGRpbmcgKiAyKTsKICAgIGNvbnN0IGJvcmRlclNpemVZID0gc2l6ZVkgKyAoYm9yZGVyUGFkZGluZyAqIDIpOwoKICAgIG1vZC5BZGRVSUNvbnRhaW5lcigKICAgICAgICBib3JkZXJJZCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKHBvc1gsIHBvc1ksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoYm9yZGVyU2l6ZVgsIGJvcmRlclNpemVZLCAwKSwKICAgICAgICBhbmNob3IsCiAgICAgICAgcGFyZW50LAogICAgICAgIHRydWUsCiAgICAgICAgMCwKICAgICAgICBDT0xPUl9CVVRUT05fQk9SREVSLAogICAgICAgIEJVVFRPTl9CT1JERVJfT1BBQ0lUWSwKICAgICAgICBtb2QuVUlCZ0ZpbGwuT3V0bGluZVRoaW4sCiAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgcGxheWVyCiAgICApOwoKICAgIGNvbnN0IGJvcmRlciA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShib3JkZXJJZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIGNvbnN0IGJ1dHRvblBhcmVudCA9IGJvcmRlciA/PyBwYXJlbnQ7CgogICAgbW9kLkFkZFVJQnV0dG9uKAogICAgICAgIGJ1dHRvbklkLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihzaXplWCwgc2l6ZVksIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgYnV0dG9uUGFyZW50LAogICAgICAgIHRydWUsCiAgICAgICAgMCwKICAgICAgICBDT0xPUl9CVVRUT05fQkFTRSwKICAgICAgICBCVVRUT05fT1BBQ0lUWV9CQVNFLAogICAgICAgIG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICB0cnVlLAogICAgICAgIENPTE9SX0JVVFRPTl9CQVNFLAogICAgICAgIEJVVFRPTl9PUEFDSVRZX0JBU0UsCiAgICAgICAgQ09MT1JfQlVUVE9OX0JBU0UsCiAgICAgICAgQlVUVE9OX09QQUNJVFlfQkFTRSwKICAgICAgICBDT0xPUl9CVVRUT05fUFJFU1NFRCwKICAgICAgICBCVVRUT05fT1BBQ0lUWV9QUkVTU0VELAogICAgICAgIENPTE9SX0JVVFRPTl9TRUxFQ1RFRCwKICAgICAgICBCVVRUT05fT1BBQ0lUWV9TRUxFQ1RFRCwKICAgICAgICBDT0xPUl9CVVRUT05fU0VMRUNURUQsCiAgICAgICAgQlVUVE9OX09QQUNJVFlfU0VMRUNURUQsCiAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgcGxheWVyCiAgICApOwoKICAgIGNvbnN0IGJ1dHRvbiA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShidXR0b25JZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIGlmIChidXR0b24gJiYgYm9yZGVyKSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KGJ1dHRvbiwgYm9yZGVyKTsKICAgIH0KCiAgICByZXR1cm4gYm9yZGVyID8/IHVuZGVmaW5lZDsKfQoKZnVuY3Rpb24gYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgbGFiZWxJZDogc3RyaW5nLAogICAgc2l6ZVg6IG51bWJlciwKICAgIHNpemVZOiBudW1iZXIsCiAgICBsYWJlbDogbnVtYmVyIHwgbW9kLk1lc3NhZ2UsCiAgICBwbGF5ZXI6IG1vZC5QbGF5ZXIsCiAgICBwYXJlbnQ6IG1vZC5VSVdpZGdldCwKICAgIHRleHRTaXplPzogbnVtYmVyCik6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCB7CiAgICBjb25zdCBleGlzdGluZyA9IHNhZmVGaW5kKGxhYmVsSWQpOwogICAgaWYgKGV4aXN0aW5nKSBtb2QuRGVsZXRlVUlXaWRnZXQoZXhpc3RpbmcpOwoKICAgIGNvbnN0IGNvbmZpZzogYW55ID0gewogICAgICAgIG5hbWU6IGxhYmVsSWQsCiAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgIHBsYXllcklkOiBwbGF5ZXIsCiAgICAgICAgcG9zaXRpb246IFswLCAwXSwKICAgICAgICBzaXplOiBbc2l6ZVgsIHNpemVZXSwKICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICB0ZXh0TGFiZWw6IGxhYmVsLAogICAgICAgIHRleHRDb2xvcjogUkVBRFlfRElBTE9HX0JVVFRPTl9URVhUX0NPTE9SX1JHQiwKICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgIH07CiAgICBpZiAodHlwZW9mIHRleHRTaXplID09PSAibnVtYmVyIikgewogICAgICAgIGNvbmZpZy50ZXh0U2l6ZSA9IHRleHRTaXplOwogICAgfQoKICAgIG1vZGxpYi5QYXJzZVVJKGNvbmZpZyk7CgogICAgY29uc3Qgd2lkZ2V0ID0gc2FmZUZpbmQobGFiZWxJZCk7CiAgICBpZiAod2lkZ2V0KSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KHdpZGdldCwgcGFyZW50KTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRQb3NpdGlvbih3aWRnZXQsIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCkpOwogICAgICAgIGlmICh0eXBlb2YgdGV4dFNpemUgPT09ICJudW1iZXIiKSB7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRTaXplKHdpZGdldCwgdGV4dFNpemUpOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiB3aWRnZXQ7Cn0KCmZ1bmN0aW9uIGFkZFJpZ2h0QWxpZ25lZExhYmVsKAogICAgbGFiZWxJZDogc3RyaW5nLAogICAgcG9zWDogbnVtYmVyLAogICAgcG9zWTogbnVtYmVyLAogICAgc2l6ZVg6IG51bWJlciwKICAgIHNpemVZOiBudW1iZXIsCiAgICBhbmNob3I6IG1vZC5VSUFuY2hvciwKICAgIGxhYmVsOiBtb2QuTWVzc2FnZSwKICAgIHBsYXllcjogbW9kLlBsYXllciwKICAgIHBhcmVudDogbW9kLlVJV2lkZ2V0LAogICAgdGV4dFNpemU6IG51bWJlcgopOiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQgewogICAgY29uc3Qgd2lkZ2V0ID0gbW9kbGliLlBhcnNlVUkoewogICAgICAgIG5hbWU6IGxhYmVsSWQsCiAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgIHBsYXllcklkOiBwbGF5ZXIsCiAgICAgICAgcG9zaXRpb246IFtwb3NYLCBwb3NZXSwKICAgICAgICBzaXplOiBbc2l6ZVgsIHNpemVZXSwKICAgICAgICBhbmNob3I6IGFuY2hvciwKICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgIHRleHRMYWJlbDogbGFiZWwsCiAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgIHRleHRTaXplOiB0ZXh0U2l6ZSwKICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyUmlnaHQsCiAgICB9KTsKICAgIGlmICh3aWRnZXQpIHsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQod2lkZ2V0LCBwYXJlbnQpOwogICAgICAgIGFwcGx5UmVhZHlEaWFsb2dMYWJlbFRleHRDb2xvcih3aWRnZXQpOwogICAgfQogICAgcmV0dXJuIHdpZGdldDsKfQoKZnVuY3Rpb24gYXBwbHlSZWFkeURpYWxvZ0xhYmVsVGV4dENvbG9yKHdpZGdldD86IG1vZC5VSVdpZGdldCk6IHZvaWQgewogICAgaWYgKHdpZGdldCkgbW9kLlNldFVJVGV4dENvbG9yKHdpZGdldCwgUkVBRFlfRElBTE9HX0xBQkVMX1RFWFRfQ09MT1IpOwp9CgpmdW5jdGlvbiBhcHBseUFkbWluUGFuZWxMYWJlbFRleHRDb2xvcih3aWRnZXQ/OiBtb2QuVUlXaWRnZXQpOiB2b2lkIHsKICAgIGlmICh3aWRnZXQpIG1vZC5TZXRVSVRleHRDb2xvcih3aWRnZXQsIEFETUlOX1BBTkVMX0xBQkVMX1RFWFRfQ09MT1IpOwp9CgpmdW5jdGlvbiByZWZyZXNoUmVhZHlEaWFsb2dCdXR0b25UZXh0Rm9yUGlkKHBsYXllcjogbW9kLlBsYXllciwgcGlkOiBudW1iZXIsIGJhc2VDb250YWluZXI6IG1vZC5VSVdpZGdldCk6IHZvaWQgewogICAgY29uc3Qgc3dhcEJvcmRlciA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19CVVRUT05fU1dBUF9JRCArIHBpZCArICJfQk9SREVSIik7CiAgICBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9TV0FQX0xBQkVMX0lEICsgcGlkLAogICAgICAgIFJFQURZX0RJQUxPR19NQUlOX0JVVFRPTl9XSURUSCwKICAgICAgICBSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fSEVJR0hULAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5idXR0b25zLnN3YXBUZWFtcywKICAgICAgICBwbGF5ZXIsCiAgICAgICAgc3dhcEJvcmRlciA/PyBiYXNlQ29udGFpbmVyCiAgICApOwoKICAgIGNvbnN0IHJlYWR5Qm9yZGVyID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9SRUFEWV9JRCArIHBpZCArICJfQk9SREVSIik7CiAgICBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9SRUFEWV9MQUJFTF9JRCArIHBpZCwKICAgICAgICBSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX0hFSUdIVCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuYnV0dG9ucy5yZWFkeSwKICAgICAgICBwbGF5ZXIsCiAgICAgICAgcmVhZHlCb3JkZXIgPz8gYmFzZUNvbnRhaW5lcgogICAgKTsKICAgIHVwZGF0ZVJlYWR5VG9nZ2xlQnV0dG9uRm9yVmlld2VyKHBsYXllciwgcGlkKTsKCiAgICBjb25zdCBhdXRvUmVhZHlCb3JkZXIgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX0FVVE9fUkVBRFlfSUQgKyBwaWQgKyAiX0JPUkRFUiIpOwogICAgYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIFVJX1JFQURZX0RJQUxPR19CVVRUT05fQVVUT19SRUFEWV9MQUJFTF9JRCArIHBpZCwKICAgICAgICBSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX0hFSUdIVCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuYnV0dG9ucy5hdXRvUmVhZHlFbmFibGUsCiAgICAgICAgcGxheWVyLAogICAgICAgIGF1dG9SZWFkeUJvcmRlciA/PyBiYXNlQ29udGFpbmVyCiAgICApOwogICAgdXBkYXRlQXV0b1JlYWR5VG9nZ2xlQnV0dG9uRm9yVmlld2VyKHBsYXllciwgcGlkKTsKCiAgICBjb25zdCBjYW5jZWxCb3JkZXIgPSBzYWZlRmluZChVSV9URUFNU1dJVENIX0JVVFRPTl9DQU5DRUxfSUQgKyBwaWQgKyAiX0JPUkRFUiIpOwogICAgYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIFVJX1RFQU1TV0lUQ0hfQlVUVE9OX0NBTkNFTF9MQUJFTF9JRCArIHBpZCwKICAgICAgICBSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX0hFSUdIVCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wudGVhbVN3aXRjaC5idXR0b25zLmNhbmNlbCwKICAgICAgICBwbGF5ZXIsCiAgICAgICAgY2FuY2VsQm9yZGVyID8/IGJhc2VDb250YWluZXIKICAgICk7CgogICAgY29uc3QgYmVzdE9mRGVjQm9yZGVyID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfSUQgKyBwaWQgKyAiX0JPUkRFUiIpOwogICAgYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIFVJX1JFQURZX0RJQUxPR19CRVNUT0ZfREVDX0xBQkVMX0lEICsgcGlkLAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLnVpLm1pbnVzLAogICAgICAgIHBsYXllciwKICAgICAgICBiZXN0T2ZEZWNCb3JkZXIgPz8gYmFzZUNvbnRhaW5lciwKICAgICAgICAxNAogICAgKTsKICAgIGNvbnN0IGJlc3RPZkluY0JvcmRlciA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19CRVNUT0ZfSU5DX0lEICsgcGlkICsgIl9CT1JERVIiKTsKICAgIGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBVSV9SRUFEWV9ESUFMT0dfQkVTVE9GX0lOQ19MQUJFTF9JRCArIHBpZCwKICAgICAgICBSRUFEWV9ESUFMT0dfU01BTExfQlVUVE9OX1dJRFRILAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fSEVJR0hULAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC51aS5wbHVzLAogICAgICAgIHBsYXllciwKICAgICAgICBiZXN0T2ZJbmNCb3JkZXIgPz8gYmFzZUNvbnRhaW5lciwKICAgICAgICAxNAogICAgKTsKCiAgICBjb25zdCBtYXRjaHVwRGVjQm9yZGVyID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01BVENIVVBfREVDX0lEICsgcGlkICsgIl9CT1JERVIiKTsKICAgIGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9ERUNfTEFCRUxfSUQgKyBwaWQsCiAgICAgICAgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9XSURUSCwKICAgICAgICBSRUFEWV9ESUFMT0dfU01BTExfQlVUVE9OX0hFSUdIVCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wudWkubWludXMsCiAgICAgICAgcGxheWVyLAogICAgICAgIG1hdGNodXBEZWNCb3JkZXIgPz8gYmFzZUNvbnRhaW5lciwKICAgICAgICAxNAogICAgKTsKICAgIGNvbnN0IG1hdGNodXBJbmNCb3JkZXIgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9JTkNfSUQgKyBwaWQgKyAiX0JPUkRFUiIpOwogICAgYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0lOQ19MQUJFTF9JRCArIHBpZCwKICAgICAgICBSRUFEWV9ESUFMT0dfU01BTExfQlVUVE9OX1dJRFRILAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fSEVJR0hULAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC51aS5wbHVzLAogICAgICAgIHBsYXllciwKICAgICAgICBtYXRjaHVwSW5jQm9yZGVyID8/IGJhc2VDb250YWluZXIsCiAgICAgICAgMTQKICAgICk7CgogICAgY29uc3QgbWluUGxheWVyc0RlY0JvcmRlciA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19NSU5QTEFZRVJTX0RFQ19JRCArIHBpZCArICJfQk9SREVSIik7CiAgICBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgVUlfUkVBRFlfRElBTE9HX01JTlBMQVlFUlNfREVDX0xBQkVMX0lEICsgcGlkLAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLnVpLm1pbnVzLAogICAgICAgIHBsYXllciwKICAgICAgICBtaW5QbGF5ZXJzRGVjQm9yZGVyID8/IGJhc2VDb250YWluZXIsCiAgICAgICAgMTQKICAgICk7CiAgICBjb25zdCBtaW5QbGF5ZXJzSW5jQm9yZGVyID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01JTlBMQVlFUlNfSU5DX0lEICsgcGlkICsgIl9CT1JERVIiKTsKICAgIGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBVSV9SRUFEWV9ESUFMT0dfTUlOUExBWUVSU19JTkNfTEFCRUxfSUQgKyBwaWQsCiAgICAgICAgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9XSURUSCwKICAgICAgICBSRUFEWV9ESUFMT0dfU01BTExfQlVUVE9OX0hFSUdIVCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wudWkucGx1cywKICAgICAgICBwbGF5ZXIsCiAgICAgICAgbWluUGxheWVyc0luY0JvcmRlciA/PyBiYXNlQ29udGFpbmVyLAogICAgICAgIDE0CiAgICApOwoKICAgIGNvbnN0IG1vZGVHYW1lRGVjQm9yZGVyID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01PREVfR0FNRV9ERUNfSUQgKyBwaWQgKyAiX0JPUkRFUiIpOwogICAgYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIFVJX1JFQURZX0RJQUxPR19NT0RFX0dBTUVfREVDX0xBQkVMX0lEICsgcGlkLAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLnVpLmxlZnQsCiAgICAgICAgcGxheWVyLAogICAgICAgIG1vZGVHYW1lRGVjQm9yZGVyID8/IGJhc2VDb250YWluZXIsCiAgICAgICAgMTQKICAgICk7CiAgICBjb25zdCBtb2RlR2FtZUluY0JvcmRlciA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19NT0RFX0dBTUVfSU5DX0lEICsgcGlkICsgIl9CT1JERVIiKTsKICAgIGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBVSV9SRUFEWV9ESUFMT0dfTU9ERV9HQU1FX0lOQ19MQUJFTF9JRCArIHBpZCwKICAgICAgICBSRUFEWV9ESUFMT0dfU01BTExfQlVUVE9OX1dJRFRILAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fSEVJR0hULAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC51aS5yaWdodCwKICAgICAgICBwbGF5ZXIsCiAgICAgICAgbW9kZUdhbWVJbmNCb3JkZXIgPz8gYmFzZUNvbnRhaW5lciwKICAgICAgICAxNAogICAgKTsKCiAgICBjb25zdCBtb2RlU2V0dGluZ3NEZWNCb3JkZXIgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19ERUNfSUQgKyBwaWQgKyAiX0JPUkRFUiIpOwogICAgYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIFVJX1JFQURZX0RJQUxPR19NT0RFX1NFVFRJTkdTX0RFQ19MQUJFTF9JRCArIHBpZCwKICAgICAgICBSRUFEWV9ESUFMT0dfU01BTExfQlVUVE9OX1dJRFRILAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fSEVJR0hULAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC51aS5sZWZ0LAogICAgICAgIHBsYXllciwKICAgICAgICBtb2RlU2V0dGluZ3NEZWNCb3JkZXIgPz8gYmFzZUNvbnRhaW5lciwKICAgICAgICAxNAogICAgKTsKICAgIGNvbnN0IG1vZGVTZXR0aW5nc0luY0JvcmRlciA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19NT0RFX1NFVFRJTkdTX0lOQ19JRCArIHBpZCArICJfQk9SREVSIik7CiAgICBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgVUlfUkVBRFlfRElBTE9HX01PREVfU0VUVElOR1NfSU5DX0xBQkVMX0lEICsgcGlkLAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLnVpLnJpZ2h0LAogICAgICAgIHBsYXllciwKICAgICAgICBtb2RlU2V0dGluZ3NJbmNCb3JkZXIgPz8gYmFzZUNvbnRhaW5lciwKICAgICAgICAxNAogICAgKTsKCiAgICBjb25zdCB2ZWhpY2xlc1QxRGVjQm9yZGVyID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfREVDX0lEICsgcGlkICsgIl9CT1JERVIiKTsKICAgIGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMV9ERUNfTEFCRUxfSUQgKyBwaWQsCiAgICAgICAgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9XSURUSCwKICAgICAgICBSRUFEWV9ESUFMT0dfU01BTExfQlVUVE9OX0hFSUdIVCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wudWkubGVmdCwKICAgICAgICBwbGF5ZXIsCiAgICAgICAgdmVoaWNsZXNUMURlY0JvcmRlciA/PyBiYXNlQ29udGFpbmVyLAogICAgICAgIDE0CiAgICApOwogICAgY29uc3QgdmVoaWNsZXNUMUluY0JvcmRlciA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QxX0lOQ19JRCArIHBpZCArICJfQk9SREVSIik7CiAgICBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfSU5DX0xBQkVMX0lEICsgcGlkLAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLnVpLnJpZ2h0LAogICAgICAgIHBsYXllciwKICAgICAgICB2ZWhpY2xlc1QxSW5jQm9yZGVyID8/IGJhc2VDb250YWluZXIsCiAgICAgICAgMTQKICAgICk7CgogICAgY29uc3QgdmVoaWNsZXNUMkRlY0JvcmRlciA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QyX0RFQ19JRCArIHBpZCArICJfQk9SREVSIik7CiAgICBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDJfREVDX0xBQkVMX0lEICsgcGlkLAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLnVpLmxlZnQsCiAgICAgICAgcGxheWVyLAogICAgICAgIHZlaGljbGVzVDJEZWNCb3JkZXIgPz8gYmFzZUNvbnRhaW5lciwKICAgICAgICAxNAogICAgKTsKICAgIGNvbnN0IHZlaGljbGVzVDJJbmNCb3JkZXIgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMl9JTkNfSUQgKyBwaWQgKyAiX0JPUkRFUiIpOwogICAgYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QyX0lOQ19MQUJFTF9JRCArIHBpZCwKICAgICAgICBSRUFEWV9ESUFMT0dfU01BTExfQlVUVE9OX1dJRFRILAogICAgICAgIFJFQURZX0RJQUxPR19TTUFMTF9CVVRUT05fSEVJR0hULAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC51aS5yaWdodCwKICAgICAgICBwbGF5ZXIsCiAgICAgICAgdmVoaWNsZXNUMkluY0JvcmRlciA/PyBiYXNlQ29udGFpbmVyLAogICAgICAgIDE0CiAgICApOwoKICAgIGNvbnN0IGNvbmZpcm1Cb3JkZXIgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTU9ERV9DT05GSVJNX0lEICsgcGlkICsgIl9CT1JERVIiKTsKICAgIGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBVSV9SRUFEWV9ESUFMT0dfTU9ERV9DT05GSVJNX0xBQkVMX0lEICsgcGlkLAogICAgICAgIFJFQURZX0RJQUxPR19DT05GSVJNX0JVVFRPTl9XSURUSCwKICAgICAgICBSRUFEWV9ESUFMT0dfU01BTExfQlVUVE9OX0hFSUdIVCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuY29uZmlybVNldHRpbmdzTGFiZWwsCiAgICAgICAgcGxheWVyLAogICAgICAgIGNvbmZpcm1Cb3JkZXIgPz8gYmFzZUNvbnRhaW5lciwKICAgICAgICAxMgogICAgKTsKICAgIGNvbnN0IHJlc2V0Qm9yZGVyID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01PREVfUkVTRVRfSUQgKyBwaWQgKyAiX0JPUkRFUiIpOwogICAgYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIFVJX1JFQURZX0RJQUxPR19NT0RFX1JFU0VUX0xBQkVMX0lEICsgcGlkLAogICAgICAgIFJFQURZX0RJQUxPR19SRVNFVF9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnJlc2V0U2V0dGluZ3NMYWJlbCwKICAgICAgICBwbGF5ZXIsCiAgICAgICAgcmVzZXRCb3JkZXIgPz8gYmFzZUNvbnRhaW5lciwKICAgICAgICAxMgogICAgKTsKfQoKLy8gU2FmZWx5IHJlc29sdmUgYSBQbGF5ZXIgYnkgcGlkIChtb2QuR2V0T2JqSWQocGxheWVyKSkuIFJldHVybnMgdW5kZWZpbmVkIGlmIG5vdCBmb3VuZC4KZnVuY3Rpb24gc2FmZUZpbmRQbGF5ZXIocGlkOiBudW1iZXIpOiBtb2QuUGxheWVyIHwgdW5kZWZpbmVkIHsKICAgIHRyeSB7CiAgICAgICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICAgICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgaWYgKG1vZC5HZXRPYmpJZChwKSA9PT0gcGlkKSByZXR1cm4gcDsKICAgIH0KICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9IGNhdGNoIHsKICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gU2hhcmVkIElEIGhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBUeXBlcyArIENhY2hlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gV2UgYnVpbGQgSFVEIHBlci1wbGF5ZXIgKHBsYXllcklkIHJlY2VpdmVyKSBhbmQgc3VmZml4IG5hbWVzIHdpdGggcGlkIHRvIGF2b2lkIGNvbGxpc2lvbnMuCnR5cGUgSHVkUmVmcyA9IHsKICAgIHBpZDogbnVtYmVyOwoKICAgIC8vIENvdW50ZXIgdGV4dCB3aWRnZXRzICh3ZSBvbmx5IG5lZWQgdG8gdXBkYXRlIHRoZXNlKQogICAgcm91bmRDdXJUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgcm91bmRNYXhUZXh0PzogbW9kLlVJV2lkZ2V0OwoKICAgIGxlZnRXaW5zVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHJpZ2h0V2luc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CgogICAgbGVmdFJlY29yZFRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICByaWdodFJlY29yZFRleHQ/OiBtb2QuVUlXaWRnZXQ7CgogICAgbGVmdFJvdW5kS2lsbHNUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgcmlnaHRSb3VuZEtpbGxzVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIGxlZnRSb3VuZEtpbGxzTGFiZWw/OiBtb2QuVUlXaWRnZXQ7CiAgICByaWdodFJvdW5kS2lsbHNMYWJlbD86IG1vZC5VSVdpZGdldDsKICAgIGxlZnRWZWhpY2xlc0FsaXZlVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHJpZ2h0VmVoaWNsZXNBbGl2ZVRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICBsZWZ0Um91bmRLaWxsc0Nyb3duPzogbW9kLlVJV2lkZ2V0OwogICAgcmlnaHRSb3VuZEtpbGxzQ3Jvd24/OiBtb2QuVUlXaWRnZXQ7CiAgICBsZWZ0VHJlbmRpbmdXaW5uZXJDcm93bj86IG1vZC5VSVdpZGdldDsKICAgIHJpZ2h0VHJlbmRpbmdXaW5uZXJDcm93bj86IG1vZC5VSVdpZGdldDsKCiAgICBsZWZ0S2lsbHNUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgcmlnaHRLaWxsc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CgogICAgc2V0dGluZ3NHYW1lTW9kZVRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICBzZXR0aW5nc0FpcmNyYWZ0Q2VpbGluZ1RleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICBzZXR0aW5nc1ZlaGljbGVzVDFUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgc2V0dGluZ3NWZWhpY2xlc1QyVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHNldHRpbmdzVmVoaWNsZXNNYXRjaHVwVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHNldHRpbmdzUGxheWVyc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CgogICAgLy8gVmljdG9yeSByZXN1bHRzIGRpYWxvZyB3aWRnZXRzIChzaG93biBkdXJpbmcgbWF0Y2ggZW5kIGNvdW50ZG93bikKICAgIHZpY3RvcnlSb290PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVJlc3RhcnRUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVRpbWVIb3Vyc1RlbnM/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5VGltZUhvdXJzT25lcz86IG1vZC5VSVdpZGdldDsKICAgIHZpY3RvcnlUaW1lTWludXRlc1RlbnM/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5VGltZU1pbnV0ZXNPbmVzPzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVRpbWVTZWNvbmRzVGVucz86IG1vZC5VSVdpZGdldDsKICAgIHZpY3RvcnlUaW1lU2Vjb25kc09uZXM/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5Um91bmRzU3VtbWFyeVRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5QWRtaW5BY3Rpb25zVGV4dD86IG1vZC5VSVdpZGdldDsKCiAgICB2aWN0b3J5TGVmdE91dGNvbWVUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeUxlZnRSZWNvcmRUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeUxlZnRSb3VuZFdpbnNUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeUxlZnRSb3VuZExvc3Nlc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5TGVmdFJvdW5kVGllc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5TGVmdFRvdGFsS2lsbHNUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeUxlZnRDcm93bj86IG1vZC5VSVdpZGdldDsKICAgIHZpY3RvcnlMZWZ0Um9zdGVyVGV4dD86IEFycmF5PG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZD47CgogICAgdmljdG9yeVJpZ2h0T3V0Y29tZVRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5UmlnaHRSZWNvcmRUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVJpZ2h0Um91bmRXaW5zVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHZpY3RvcnlSaWdodFJvdW5kTG9zc2VzVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHZpY3RvcnlSaWdodFJvdW5kVGllc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5UmlnaHRUb3RhbEtpbGxzVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHZpY3RvcnlSaWdodENyb3duPzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVJpZ2h0Um9zdGVyVGV4dD86IEFycmF5PG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZD47CiAgICB2aWN0b3J5Um9zdGVyUm93PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVJvc3RlckxlZnRDb250YWluZXI/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5Um9zdGVyUmlnaHRDb250YWluZXI/OiBtb2QuVUlXaWRnZXQ7CgogICAgLy8gUm91bmQtZW5kIGRpYWxvZyB3aWRnZXRzIChzaG93biBkdXJpbmcgdGhlIHJvdW5kLWVuZCByZWRlcGxveSB3aW5kb3cpCiAgICByb3VuZEVuZFJvb3Q/OiBtb2QuVUlXaWRnZXQ7CiAgICByb3VuZEVuZFJvdW5kVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHJvdW5kRW5kT3V0Y29tZVRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICByb3VuZEVuZERldGFpbFRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICBhZG1pblBhbmVsQWN0aW9uQ291bnRUZXh0PzogbW9kLlVJV2lkZ2V0OwoKICAgIGhlbHBUZXh0Q29udGFpbmVyPzogbW9kLlVJV2lkZ2V0OwogICAgcmVhZHlTdGF0dXNDb250YWluZXI/OiBtb2QuVUlXaWRnZXQ7CgogICAgc3Bhd25EaXNhYmxlZExpdmVUZXh0PzogbW9kLlVJV2lkZ2V0OwoKICAgIC8vIE9wdGlvbmFsIHJvb3RzIChmb3IgY2xlYW51cCBpZiBuZWVkZWQpCiAgICByb290czogbW9kLlVJV2lkZ2V0W107Cn07CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIFR5cGVzICsgQ2FjaGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBHYW1lIFN0YXRlIERlZmluaXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIE92ZXJ0aW1lIFVJIHdpZGdldCBjYWNoZXMgKHBlci1wbGF5ZXIpLiBUaGVzZSBtaXJyb3IgdGhlIEhVRCBjYWNoaW5nIHBhdHRlcm4gdXNlZCBlbHNld2hlcmUuCnR5cGUgT3ZlcnRpbWVGbGFnSHVkUmVmcyA9IHsKICAgIHJvb3Q/OiBtb2QuVUlXaWRnZXQ7CiAgICB0aXRsZT86IG1vZC5VSVdpZGdldDsKICAgIHRpdGxlU2hhZG93PzogbW9kLlVJV2lkZ2V0OwogICAgc3RhdHVzPzogbW9kLlVJV2lkZ2V0OwogICAgc3RhdHVzU2hhZG93PzogbW9kLlVJV2lkZ2V0OwogICAgY291bnRzTGVmdD86IG1vZC5VSVdpZGdldDsKICAgIGNvdW50c1JpZ2h0PzogbW9kLlVJV2lkZ2V0OwogICAgY291bnRzTGVmdEJvcmRlcj86IG1vZC5VSVdpZGdldDsKICAgIGNvdW50c1JpZ2h0Qm9yZGVyPzogbW9kLlVJV2lkZ2V0OwogICAgcGVyY2VudExlZnRCZz86IG1vZC5VSVdpZGdldDsKICAgIHBlcmNlbnRSaWdodEJnPzogbW9kLlVJV2lkZ2V0OwogICAgcGVyY2VudExlZnQ/OiBtb2QuVUlXaWRnZXQ7CiAgICBwZXJjZW50UmlnaHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICBjb3VudHNMZWZ0Q3Jvd24/OiBtb2QuVUlXaWRnZXQ7CiAgICBjb3VudHNSaWdodENyb3duPzogbW9kLlVJV2lkZ2V0OwogICAgYmFyQmc/OiBtb2QuVUlXaWRnZXQ7CiAgICBiYXJGaWxsVDE/OiBtb2QuVUlXaWRnZXQ7CiAgICBiYXJGaWxsVDI/OiBtb2QuVUlXaWRnZXQ7CiAgICB2ZWhpY2xlUmVxdWlyZWQ/OiBtb2QuVUlXaWRnZXQ7Cn07Cgp0eXBlIE92ZXJ0aW1lRmxhZ0dsb2JhbEh1ZFJlZnMgPSB7CiAgICByb290PzogbW9kLlVJV2lkZ2V0OwogICAgdGl0bGU/OiBtb2QuVUlXaWRnZXQ7CiAgICBiYXJCZz86IG1vZC5VSVdpZGdldDsKICAgIGJhckZpbGxUMT86IG1vZC5VSVdpZGdldDsKICAgIGJhckZpbGxUMj86IG1vZC5VSVdpZGdldDsKfTsKCi8vIFRyYWNrcyB6b25lIG1lbWJlcnNoaXAgZm9yIFVJIHVwZGF0ZXMgKyB2ZWhpY2xlIGRlZHVwZSAodmVoaWNsZU9iaklkID0gMCB3aGVuIG9uIGZvb3QpLgp0eXBlIE92ZXJ0aW1lRmxhZ1BsYXllclpvbmVTdGF0ZSA9IHsKICAgIHBsYXllck9iaklkOiBudW1iZXI7CiAgICB0ZWFtSWQ6IFRlYW1JRCB8IDA7CiAgICB2ZWhpY2xlT2JqSWQ6IG51bWJlcjsKfTsKCi8vIExhc3QgcmVuZGVyZWQgdmFsdWVzIGZvciBpbi16b25lIEhVRCB1cGRhdGVzIChhdm9pZCBwZXItdGljayBVSSBjaHVybikuCnR5cGUgT3ZlcnRpbWVGbGFnVWlTbmFwc2hvdCA9IHsKICAgIHByb2dyZXNzUGVyY2VudDogbnVtYmVyOwogICAgbGVmdFBlcmNlbnQ6IG51bWJlcjsKICAgIHJpZ2h0UGVyY2VudDogbnVtYmVyOwogICAgYmFyRmlsbFQxV2lkdGg6IG51bWJlcjsKICAgIGJhckZpbGxUMldpZHRoOiBudW1iZXI7CiAgICB0MUNvdW50OiBudW1iZXI7CiAgICB0MkNvdW50OiBudW1iZXI7CiAgICBzdGF0dXNLZXk6IG51bWJlcjsKICAgIHN0YXR1c1ZhbHVlOiBudW1iZXI7CiAgICBzdGF0dXNWaXNpYmxlOiBib29sZWFuOwogICAgdGl0bGVLZXk6IG51bWJlcjsKICAgIHRpdGxlVmFsdWU6IG51bWJlcjsKICAgIGNvdW50c1Zpc2libGU6IGJvb2xlYW47CiAgICBjb3VudHNVc2VYOiBib29sZWFuOwogICAgbGVmdEJvcmRlclZpc2libGU6IGJvb2xlYW47CiAgICByaWdodEJvcmRlclZpc2libGU6IGJvb2xlYW47CiAgICB2ZWhpY2xlUmVxdWlyZWRWaXNpYmxlOiBib29sZWFuOwp9OwoKdHlwZSBWZWhpY2xlU3Bhd25lclNsb3QgPSB7CiAgICB0ZWFtSWQ6IFRlYW1JRDsKICAgIHNsb3ROdW1iZXI6IG51bWJlcjsKICAgIHNwYXduZXI6IG1vZC5WZWhpY2xlU3Bhd25lcjsKICAgIHNwYXduZXJPYmpJZDogbnVtYmVyOwogICAgc3Bhd25Qb3M6IG1vZC5WZWN0b3I7CiAgICBzcGF3blJvdDogbW9kLlZlY3RvcjsKICAgIHZlaGljbGVUeXBlOiBtb2QuVmVoaWNsZUxpc3Q7CiAgICBlbmFibGVkOiBib29sZWFuOwogICAgZW5hYmxlVG9rZW46IG51bWJlcjsKICAgIHNwYXduUmVxdWVzdFRva2VuOiBudW1iZXI7CiAgICBzcGF3blJlcXVlc3RBdFNlY29uZHM6IG51bWJlcjsKICAgIGV4cGVjdGluZ1NwYXduOiBib29sZWFuOwogICAgdmVoaWNsZUlkOiBudW1iZXI7CiAgICByZXNwYXduUnVubmluZzogYm9vbGVhbjsKICAgIHNwYXduUmV0cnlTY2hlZHVsZWQ6IGJvb2xlYW47Cn07CgovLyBHYW1lU3RhdGUgY2VudHJhbGl6ZXMgYWxsIG11dGFibGUgbWF0Y2gvcm91bmQvVUkgc3RhdGUgc28gd3JpdGVzIGFyZSBleHBsaWNpdCBhbmQgc2VhcmNoYWJsZS4KaW50ZXJmYWNlIEdhbWVTdGF0ZSB7CiAgICByb3VuZDogewogICAgICAgIGN1cnJlbnQ6IG51bWJlcjsKICAgICAgICBtYXg6IG51bWJlcjsKICAgICAgICBraWxsc1RhcmdldDogbnVtYmVyOwogICAgICAgIGF1dG9TdGFydE1pbkFjdGl2ZVBsYXllcnM6IG51bWJlcjsKICAgICAgICBtYXRjaHVwUHJlc2V0SW5kZXg6IG51bWJlcjsKICAgICAgICBsYXN0TWF0Y2h1cENoYW5nZUF0U2Vjb25kczogbnVtYmVyOwogICAgICAgIG1vZGVDb25maWc6IFJlYWR5RGlhbG9nTW9kZUNvbmZpZzsKICAgICAgICBwaGFzZTogUm91bmRQaGFzZTsKICAgICAgICBsYXN0V2lubmVyVGVhbTogVGVhbUlEIHwgMDsKICAgICAgICBsYXN0RW5kRGV0YWlsUmVhc29uOiBSb3VuZEVuZERldGFpbFJlYXNvbjsKICAgICAgICBsYXN0T2JqZWN0aXZlUHJvZ3Jlc3M6IG51bWJlcjsKICAgICAgICBjbG9jazogewogICAgICAgICAgICBkdXJhdGlvblNlY29uZHM6IG51bWJlcjsKICAgICAgICAgICAgcm91bmRMZW5ndGhTZWNvbmRzOiBudW1iZXI7CiAgICAgICAgICAgIG1hdGNoU3RhcnRFbGFwc2VkU2Vjb25kcz86IG51bWJlcjsKICAgICAgICAgICAgcGF1c2VkUmVtYWluaW5nU2Vjb25kcz86IG51bWJlcjsKICAgICAgICAgICAgaXNQYXVzZWQ6IGJvb2xlYW47CiAgICAgICAgICAgIGxhc3REaXNwbGF5ZWRTZWNvbmRzPzogbnVtYmVyOwogICAgICAgICAgICBsYXN0TG93VGltZVN0YXRlPzogYm9vbGVhbjsKICAgICAgICAgICAgZXhwaXJ5RmlyZWQ6IGJvb2xlYW47CiAgICAgICAgICAgIGV4cGlyeUhhbmRsZXJzOiBBcnJheTwoKSA9PiB2b2lkPjsKICAgICAgICB9OwogICAgICAgIC8vIGNsZWFudXBBY3RpdmUgZ2F0ZXMgZGVwbG95L1VJIGR1cmluZyByb3VuZC1lbmQgcmVzZXQ7IGNsZWFudXBBbGxvd0RlcGxveSB0ZW1wb3JhcmlseSBvdmVycmlkZXMuCiAgICAgICAgZmxvdzogewogICAgICAgICAgICByb3VuZEVuZFJlZGVwbG95VG9rZW46IG51bWJlcjsKICAgICAgICAgICAgY2xvY2tFeHBpcnlCb3VuZDogYm9vbGVhbjsKICAgICAgICAgICAgY2xlYW51cEFjdGl2ZTogYm9vbGVhbjsKICAgICAgICAgICAgY2xlYW51cEFsbG93RGVwbG95OiBib29sZWFuOwogICAgICAgICAgICByb3VuZEVuZERpYWxvZ1Zpc2libGU6IGJvb2xlYW47CiAgICAgICAgICAgIC8vIExvY2tzIG92ZXJ0aW1lL0hVRCBVSSB1cGRhdGVzIG9uY2UgYSByb3VuZCBlbmRzIHRvIGF2b2lkIFVJIGNhbGxzIGR1cmluZyB0ZWFyZG93bi4KICAgICAgICAgICAgcm91bmRFbmRVaUxvY2tkb3duOiBib29sZWFuOwogICAgICAgIH07CiAgICAgICAgY291bnRkb3duOiB7CiAgICAgICAgICAgIGlzQWN0aXZlOiBib29sZWFuOwogICAgICAgICAgICBpc1JlcXVlc3RlZDogYm9vbGVhbjsKICAgICAgICAgICAgdG9rZW46IG51bWJlcjsKICAgICAgICAgICAgb3ZlckxpbmVNZXNzYWdlVG9rZW46IG51bWJlcjsKICAgICAgICB9OwogICAgICAgIGFpcmNyYWZ0Q2VpbGluZzogewogICAgICAgICAgICBtYXBEZWZhdWx0SHVkQ2VpbGluZzogbnVtYmVyOwogICAgICAgICAgICBodWRNYXhZOiBudW1iZXI7CiAgICAgICAgICAgIGh1ZEZsb29yWTogbnVtYmVyOwogICAgICAgICAgICBjdXN0b21FbmFibGVkOiBib29sZWFuOwogICAgICAgICAgICBlbmZvcmNlbWVudFRva2VuOiBudW1iZXI7CiAgICAgICAgICAgIHZlaGljbGVTdGF0ZXM6IFJlY29yZDxudW1iZXIsIEFpcmNyYWZ0Q2VpbGluZ1ZlaGljbGVTdGF0ZT47CiAgICAgICAgfTsKICAgIH07CiAgICAvLyBPdmVydGltZSBmbGFnIGNhcHR1cmUgc3RhdGUgKHJlc2V0IG9uIHJvdW5kIHN0YXJ0L2VuZCkuCiAgICAvLyBQcm9ncmVzcyBpcyAwLi4xICgwID0gVGVhbTIgb3ducywgMSA9IFRlYW0xIG93bnMsIDAuNSA9IG5ldXRyYWwpLgogICAgLy8gdDFDb3VudC90MkNvdW50IHRyYWNrIHVuaXF1ZSB2ZWhpY2xlcyBpbiB0aGUgem9uZSAobm90IHBsYXllciBjb3VudCkuCiAgICBmbGFnOiB7CiAgICAgICAgc3RhZ2U6IE92ZXJ0aW1lU3RhZ2U7CiAgICAgICAgYWN0aXZlOiBib29sZWFuOwogICAgICAgIHRyYWNraW5nRW5hYmxlZDogYm9vbGVhbjsKICAgICAgICB1bmxvY2tSZW1pbmRlclNlbnQ6IGJvb2xlYW47CiAgICAgICAgY29uZmlnVmFsaWQ6IGJvb2xlYW47CiAgICAgICAgLy8gVHJ1ZSBvbmx5IHdoZW4gYW4gYWRtaW4gb3ZlcnJpZGUgYWN0dWFsbHkgc2VsZWN0cyB0aGUgem9uZSBmb3IgdGhpcyByb3VuZC4KICAgICAgICBvdmVycmlkZVVzZWRUaGlzUm91bmQ6IGJvb2xlYW47CiAgICAgICAgdGllQnJlYWtlckVuYWJsZWRUaGlzUm91bmQ6IGJvb2xlYW47CiAgICAgICAgY2FuZGlkYXRlWm9uZXM6IE92ZXJ0aW1lWm9uZUNhbmRpZGF0ZVtdOwogICAgICAgIGFjdGl2ZUFyZWFUcmlnZ2VySWQ/OiBudW1iZXI7CiAgICAgICAgYWN0aXZlQXJlYVRyaWdnZXI/OiBtb2QuQXJlYVRyaWdnZXI7CiAgICAgICAgYWN0aXZlU2VjdG9ySWQ/OiBudW1iZXI7CiAgICAgICAgYWN0aXZlU2VjdG9yPzogbW9kLlNlY3RvcjsKICAgICAgICBhY3RpdmVXb3JsZEljb25JZD86IG51bWJlcjsKICAgICAgICBhY3RpdmVXb3JsZEljb24/OiBtb2QuV29ybGRJY29uOwogICAgICAgIGFjdGl2ZUNhcHR1cmVQb2ludElkPzogbnVtYmVyOwogICAgICAgIGFjdGl2ZUNhcHR1cmVQb2ludD86IG1vZC5DYXB0dXJlUG9pbnQ7CiAgICAgICAgYWN0aXZlQ2FuZGlkYXRlSW5kZXg/OiBudW1iZXI7CiAgICAgICAgLy8gQ2FjaGVkIHN0cmluZyBrZXkgZm9yIHRoZSBzZWxlY3RlZCB6b25lIGxldHRlciAoQS1HKS4KICAgICAgICBzZWxlY3RlZFpvbmVMZXR0ZXJLZXk/OiBudW1iZXI7CiAgICAgICAgb3duZXJUZWFtOiBUZWFtSUQgfCAwOwogICAgICAgIHByb2dyZXNzOiBudW1iZXI7CiAgICAgICAgdDFDb3VudDogbnVtYmVyOwogICAgICAgIHQyQ291bnQ6IG51bWJlcjsKICAgICAgICBwbGF5ZXJzSW5ab25lQnlQaWQ6IFJlY29yZDxudW1iZXIsIE92ZXJ0aW1lRmxhZ1BsYXllclpvbmVTdGF0ZT47CiAgICAgICAgdmVoaWNsZU9jY3VwYW50c0J5VmlkOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+OwogICAgICAgIHZlaGljbGVUZWFtQnlWaWQ6IFJlY29yZDxudW1iZXIsIFRlYW1JRD47CiAgICAgICAgbGFzdFVpU25hcHNob3RCeVBpZDogUmVjb3JkPG51bWJlciwgT3ZlcnRpbWVGbGFnVWlTbmFwc2hvdD47CiAgICAgICAgbGFzdEdsb2JhbFByb2dyZXNzUGVyY2VudDogbnVtYmVyOwogICAgICAgIGxhc3RNZW1iZXJzaGlwUHJ1bmVBdFNlY29uZHM6IG51bWJlcjsKICAgICAgICB1aUJ5UGlkOiBSZWNvcmQ8bnVtYmVyLCBPdmVydGltZUZsYWdIdWRSZWZzPjsKICAgICAgICBnbG9iYWxVaUJ5UGlkOiBSZWNvcmQ8bnVtYmVyLCBPdmVydGltZUZsYWdHbG9iYWxIdWRSZWZzPjsKICAgICAgICB0aWNrVG9rZW46IG51bWJlcjsKICAgICAgICB0aWNrQWN0aXZlOiBib29sZWFuOwogICAgfTsKICAgIHNjb3JlczogewogICAgICAgIHQxUm91bmRLaWxsczogbnVtYmVyOwogICAgICAgIHQyUm91bmRLaWxsczogbnVtYmVyOwogICAgICAgIHQxVG90YWxLaWxsczogbnVtYmVyOwogICAgICAgIHQyVG90YWxLaWxsczogbnVtYmVyOwogICAgfTsKICAgIG1hdGNoOiB7CiAgICAgICAgd2luc1QxOiBudW1iZXI7CiAgICAgICAgd2luc1QyOiBudW1iZXI7CiAgICAgICAgbG9zc2VzVDE6IG51bWJlcjsKICAgICAgICBsb3NzZXNUMjogbnVtYmVyOwogICAgICAgIHRpZXNUMTogbnVtYmVyOwogICAgICAgIHRpZXNUMjogbnVtYmVyOwogICAgICAgIGlzRW5kZWQ6IGJvb2xlYW47CiAgICAgICAgdmljdG9yeURpYWxvZ0FjdGl2ZTogYm9vbGVhbjsKICAgICAgICB3aW5uZXJUZWFtPzogVGVhbUlEIHwgMDsKICAgICAgICBlbmRFbGFwc2VkU2Vjb25kc1NuYXBzaG90OiBudW1iZXI7CiAgICAgICAgdmljdG9yeVN0YXJ0RWxhcHNlZFNlY29uZHNTbmFwc2hvdDogbnVtYmVyOwogICAgICAgIGZsb3c6IHsKICAgICAgICAgICAgbWF0Y2hFbmREZWxheVRva2VuOiBudW1iZXI7CiAgICAgICAgfTsKICAgIH07CiAgICBhZG1pbjogewogICAgICAgIGFjdGlvbkNvdW50OiBudW1iZXI7CiAgICAgICAgZGVidWdMb29wQWN0aXZlOiBib29sZWFuOwogICAgICAgIHRpZUJyZWFrZXJPdmVycmlkZUluZGV4PzogbnVtYmVyOwogICAgICAgIC8vIE1hdGNoLWxldmVsIGZsYWcgaWYgYW55IHRpZS1icmVha2VyIG92ZXJyaWRlIHdhcyB1c2VkLgogICAgICAgIHRpZUJyZWFrZXJPdmVycmlkZVVzZWQ6IGJvb2xlYW47CiAgICAgICAgdGllQnJlYWtlck1vZGVJbmRleDogbnVtYmVyOwogICAgICAgIGxpdmVSZXNwYXduRW5hYmxlZDogYm9vbGVhbjsKICAgIH07CiAgICBkZWJ1ZzogewogICAgICAgIGhpZ2hsaWdodGVkTWVzc2FnZUNvdW50OiBudW1iZXI7CiAgICAgICAgbGFzdEhpZ2hsaWdodGVkTWVzc2FnZUF0U2Vjb25kczogbnVtYmVyOwogICAgICAgIGxhc3RIaWdobGlnaHRlZE1lc3NhZ2VLZXk6IG51bWJlcjsKICAgIH07CiAgICBwbGF5ZXJzOiB7CiAgICAgICAgdGVhbVN3aXRjaERhdGE6IFJlY29yZDxudW1iZXIsIHRlYW1Td2l0Y2hEYXRhX3Q+OwogICAgICAgIHJlYWR5QnlQaWQ6IFJlY29yZDxudW1iZXIsIGJvb2xlYW4+OwogICAgICAgIGF1dG9SZWFkeUJ5UGlkOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPjsKICAgICAgICByZWFkeU1lc3NhZ2VDb29sZG93bkJ5UGlkOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+OwogICAgICAgIC8vIEpvaW4tdGltZSBwcm9tcHQ6IG9ubHkgb25jZSBwZXIgcGxheWVyLCByZWdhcmRsZXNzIG9mIHVuZGVwbG95IHJlcGVhdHMuCiAgICAgICAgam9pblByb21wdFNob3duQnlQaWQ6IFJlY29yZDxudW1iZXIsIGJvb2xlYW4+OwogICAgICAgIC8vICJOZXZlciBTaG93IEFnYWluIiBpcyBzdG9yZWQgcGVyIG1hcCBzbyBvdGhlciBtYXBzIGNhbiBzdGlsbCBzaG93IHRoZSBwcm9tcHQuCiAgICAgICAgam9pblByb21wdE5ldmVyU2hvd0J5UGlkTWFwOiBSZWNvcmQ8bnVtYmVyLCBQYXJ0aWFsPFJlY29yZDxNYXBLZXksIGJvb2xlYW4+Pj47CiAgICAgICAgLy8gSm9pbiBwcm9tcHQgc2VxdWVuY2luZyAodGlwcyArIHVubG9jayB0cmFja2luZykuCiAgICAgICAgam9pblByb21wdFJlYWR5RGlhbG9nT3BlbmVkQnlQaWQ6IFJlY29yZDxudW1iZXIsIGJvb2xlYW4+OwogICAgICAgIGpvaW5Qcm9tcHRUaXBJbmRleEJ5UGlkOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+OwogICAgICAgIGpvaW5Qcm9tcHRUaXBzVW5sb2NrZWRCeVBpZDogUmVjb3JkPG51bWJlciwgYm9vbGVhbj47CiAgICAgICAgam9pblByb21wdFRyaXBsZVRhcEFybWVkQnlQaWQ6IFJlY29yZDxudW1iZXIsIGJvb2xlYW4+OwogICAgICAgIGluTWFpbkJhc2VCeVBpZDogUmVjb3JkPG51bWJlciwgYm9vbGVhbj47CiAgICAgICAgb3ZlclRha2VvZmZMaW1pdEJ5UGlkOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPjsKICAgICAgICBkZXBsb3llZEJ5UGlkOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPjsKICAgICAgICBkaXNjb25uZWN0ZWRCeVBpZDogUmVjb3JkPG51bWJlciwgYm9vbGVhbj47CiAgICAgICAgdWlJbnB1dEVuYWJsZWRCeVBpZDogUmVjb3JkPG51bWJlciwgYm9vbGVhbj47CiAgICAgICAgc3Bhd25EaXNhYmxlZFdhcm5pbmdWaXNpYmxlQnlQaWQ6IFJlY29yZDxudW1iZXIsIGJvb2xlYW4+OwogICAgfTsKICAgIHZlaGljbGVzOiB7CiAgICAgICAgc2xvdHM6IFZlaGljbGVTcGF3bmVyU2xvdFtdOwogICAgICAgIHZlaGljbGVUb1Nsb3Q6IFJlY29yZDxudW1iZXIsIG51bWJlcj47CiAgICAgICAgc3Bhd25TZXF1ZW5jZVRva2VuOiBudW1iZXI7CiAgICAgICAgc3Bhd25TZXF1ZW5jZUluUHJvZ3Jlc3M6IGJvb2xlYW47CiAgICAgICAgYWN0aXZlU3Bhd25TbG90SW5kZXg/OiBudW1iZXI7CiAgICAgICAgYWN0aXZlU3Bhd25Ub2tlbj86IG51bWJlcjsKICAgICAgICBhY3RpdmVTcGF3blJlcXVlc3RlZEF0U2Vjb25kcz86IG51bWJlcjsKICAgICAgICBjb25maWdSZWFkeTogYm9vbGVhbjsKICAgICAgICBzdGFydHVwQ2xlYW51cERvbmU6IGJvb2xlYW47CiAgICB9OwogICAgaHVkQ2FjaGU6IHsKICAgICAgICBsYXN0SHVkU2NvcmVUMT86IG51bWJlcjsKICAgICAgICBsYXN0SHVkU2NvcmVUMj86IG51bWJlcjsKICAgICAgICBsYXN0SHVkUm91bmRLaWxsc1QxPzogbnVtYmVyOwogICAgICAgIGxhc3RIdWRSb3VuZEtpbGxzVDI/OiBudW1iZXI7CiAgICAgICAgaHVkQnlQaWQ6IFJlY29yZDxudW1iZXIsIEh1ZFJlZnM+OwogICAgICAgIGNsb2NrV2lkZ2V0Q2FjaGU6IFJlY29yZDxudW1iZXIsIENsb2NrV2lkZ2V0Q2FjaGVFbnRyeT47CiAgICAgICAgY291bnRkb3duV2lkZ2V0Q2FjaGU6IFJlY29yZDxudW1iZXIsIENvdW50ZG93bldpZGdldENhY2hlRW50cnk+OwogICAgICAgIG92ZXJMaW5lVGl0bGVXaWRnZXRDYWNoZTogUmVjb3JkPG51bWJlciwgQ291bnRkb3duV2lkZ2V0Q2FjaGVFbnRyeT47CiAgICAgICAgb3ZlckxpbmVTdWJ0aXRsZVdpZGdldENhY2hlOiBSZWNvcmQ8bnVtYmVyLCBDb3VudGRvd25XaWRnZXRDYWNoZUVudHJ5PjsKICAgICAgICBvdmVyTGluZVRpdGxlU2hhZG93V2lkZ2V0Q2FjaGU6IFJlY29yZDxudW1iZXIsIENvdW50ZG93bldpZGdldENhY2hlRW50cnk+OwogICAgICAgIG92ZXJMaW5lU3VidGl0bGVTaGFkb3dXaWRnZXRDYWNoZTogUmVjb3JkPG51bWJlciwgQ291bnRkb3duV2lkZ2V0Q2FjaGVFbnRyeT47CiAgICB9Owp9CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBBdXRob3JpdGF0aXZlIFN0YXRlIE1hcCAtLS0tLS0tLS0tLS0tLS0tLS0tLQovLwovLyBSb3VuZCBzdGF0ZSAocmVzZXRzIGF0IHJvdW5kIHN0YXJ0KToKLy8gLSBTdGF0ZS5yb3VuZC5jdXJyZW50OiBjdXJyZW50IHJvdW5kIGluZGV4ICgxLWJhc2VkIGRpc3BsYXkpLgovLyAtIFN0YXRlLnJvdW5kLm1heDogbnVtYmVyIG9mIHJvdW5kcyBpbiB0aGUgbWF0Y2guCi8vIC0gU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscyAvIFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHM6IHBvaW50cyBlYXJuZWQgdGhpcyByb3VuZCBieSBlYWNoIHRlYW0uCi8vIC0gU3RhdGUucm91bmQua2lsbHNUYXJnZXQ6IHBvaW50cyBuZWVkZWQgdG8gd2luIHRoZSByb3VuZC4KLy8gLSBTdGF0ZS5yb3VuZC5waGFzZTogUm91bmRQaGFzZS5Ob3RSZWFkeSB8IFJvdW5kUGhhc2UuTGl2ZSB8IFJvdW5kUGhhc2UuR2FtZU92ZXIuCi8vIC0gU3RhdGUucm91bmQuY2xvY2suZHVyYXRpb25TZWNvbmRzOiBhdXRob3JpdGF0aXZlIHJlbWFpbmluZyBzZWNvbmRzIGluIHRoZSByb3VuZC4KLy8gLSBTdGF0ZS5yb3VuZC5jbG9jay5yb3VuZExlbmd0aFNlY29uZHM6IHJvdW5kLXN0YXJ0IGR1cmF0aW9uIHVzZWQgZm9yIGhhbGYtdGltZSByZXZlYWwgdGhyZXNob2xkcy4KLy8KLy8gTWF0Y2ggc3RhdGUgKHJlc2V0cyBhdCBtYXRjaCBzdGFydCk6Ci8vIC0gU3RhdGUubWF0Y2gud2luc1QxL1QyLCBTdGF0ZS5tYXRjaC5sb3NzZXNUMS9UMiwgU3RhdGUubWF0Y2gudGllc1QxL1QyOiBtYXRjaCByZWNvcmQgYWNyb3NzIHJvdW5kcy4KLy8gLSBTdGF0ZS5tYXRjaC5pc0VuZGVkOiBpbmRpY2F0ZXMgbWF0Y2ggaXMgb3ZlciBhbmQgdmljdG9yeSBkaWFsb2cgc2hvdWxkIGJlIHNob3duLgovLwovLyBWZWhpY2xlIHJlZ2lzdHJhdGlvbiAocGVyc2lzdHMgYWNyb3NzIHJvdW5kIHRyYW5zaXRpb25zIHVubGVzcyBleHBsaWNpdGx5IGNsZWFyZWQpOgovLyAtIHJlZ1ZlaGljbGVzVGVhbTEgKEdsb2JhbFZhcmlhYmxlIDApOiBhcnJheSBvZiB2ZWhpY2xlcyByZWdpc3RlcmVkIHRvIFRlYW0gMS4KLy8gLSByZWdWZWhpY2xlc1RlYW0yIChHbG9iYWxWYXJpYWJsZSAxKTogYXJyYXkgb2YgdmVoaWNsZXMgcmVnaXN0ZXJlZCB0byBUZWFtIDIuCi8vIC0gdmVoSWRzL3ZlaE93bmVyczogYmVzdC1lZmZvcnQgJ2xhc3QgZHJpdmVyJyBtYXBwaW5nIHVzZWQgZm9yIG1lc3NhZ2VzIG9ubHkuCi8vCi8vIFVJIGNhY2hlcyAocGVyLXBsYXllciwgcmVidWlsdCBhcyBuZWVkZWQpOgovLyAtIFN0YXRlLmh1ZENhY2hlLmh1ZEJ5UGlkW3BpZF06IGNhY2hlZCBIVUQgd2lkZ2V0IHJlZmVyZW5jZXMuCi8vIC0gZGlhbG9nL3dpZGdldCBjYWNoZXM6IGNhY2hlZCByZWZlcmVuY2VzIHRvIG1vZGFsIFVJIGVsZW1lbnRzICh0ZWFtIHN3aXRjaCwgdmljdG9yeSwgY2xvY2sgZGlnaXRzKS4KLy8KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBDZW50cmFsaXplZCBtdXRhYmxlIHN0YXRlIGZvciBtYXRjaC9yb3VuZCBmbG93IGFuZCBVSSBjYWNoZXMuCmNvbnN0IFN0YXRlOiBHYW1lU3RhdGUgPSB7CiAgICByb3VuZDogewogICAgICAgIGN1cnJlbnQ6IDEsCiAgICAgICAgbWF4OiBNQVhfUk9VTkRTLAogICAgICAgIGtpbGxzVGFyZ2V0OiBST1VORF9LSUxMU19UQVJHRVQsCiAgICAgICAgYXV0b1N0YXJ0TWluQWN0aXZlUGxheWVyczogREVGQVVMVF9BVVRPX1NUQVJUX01JTl9BQ1RJVkVfUExBWUVSUywKICAgICAgICBtYXRjaHVwUHJlc2V0SW5kZXg6IERFRkFVTFRfTUFUQ0hVUF9QUkVTRVRfSU5ERVgsCiAgICAgICAgbGFzdE1hdGNodXBDaGFuZ2VBdFNlY29uZHM6IC05OTksCiAgICAgICAgbW9kZUNvbmZpZzogewogICAgICAgICAgICBnYW1lTW9kZUluZGV4OiBSRUFEWV9ESUFMT0dfR0FNRV9NT0RFX0RFRkFVTFRfSU5ERVgsCiAgICAgICAgICAgIGFpcmNyYWZ0Q2VpbGluZzogUkVBRFlfRElBTE9HX0FJUkNSQUZUX0NFSUxJTkdfREVGQVVMVCwKICAgICAgICAgICAgYWlyY3JhZnRDZWlsaW5nT3ZlcnJpZGVQZW5kaW5nOiBmYWxzZSwKICAgICAgICAgICAgdmVoaWNsZUluZGV4VDE6IFJFQURZX0RJQUxPR19WRUhJQ0xFX1QxX0RFRkFVTFRfSU5ERVgsCiAgICAgICAgICAgIHZlaGljbGVJbmRleFQyOiBSRUFEWV9ESUFMT0dfVkVISUNMRV9UMl9ERUZBVUxUX0lOREVYLAogICAgICAgICAgICBnYW1lTW9kZTogUkVBRFlfRElBTE9HX0dBTUVfTU9ERV9PUFRJT05TW1JFQURZX0RJQUxPR19HQU1FX01PREVfREVGQVVMVF9JTkRFWF0sCiAgICAgICAgICAgIGdhbWVTZXR0aW5nczogbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLm1vZGVTZXR0aW5nQWlyY3JhZnRDZWlsaW5nRm9ybWF0LAogICAgICAgICAgICB2ZWhpY2xlc1QxOiBSRUFEWV9ESUFMT0dfVkVISUNMRV9PUFRJT05TW1JFQURZX0RJQUxPR19WRUhJQ0xFX1QxX0RFRkFVTFRfSU5ERVhdLAogICAgICAgICAgICB2ZWhpY2xlc1QyOiBSRUFEWV9ESUFMT0dfVkVISUNMRV9PUFRJT05TW1JFQURZX0RJQUxPR19WRUhJQ0xFX1QyX0RFRkFVTFRfSU5ERVhdLAogICAgICAgICAgICBjb25maXJtZWQ6IHsKICAgICAgICAgICAgICAgIGdhbWVNb2RlOiBSRUFEWV9ESUFMT0dfR0FNRV9NT0RFX09QVElPTlNbUkVBRFlfRElBTE9HX0dBTUVfTU9ERV9ERUZBVUxUX0lOREVYXSwKICAgICAgICAgICAgICAgIGdhbWVTZXR0aW5nczogbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLm1vZGVTZXR0aW5nQWlyY3JhZnRDZWlsaW5nRm9ybWF0LAogICAgICAgICAgICAgICAgdmVoaWNsZXNUMTogUkVBRFlfRElBTE9HX1ZFSElDTEVfT1BUSU9OU1tSRUFEWV9ESUFMT0dfVkVISUNMRV9UMV9ERUZBVUxUX0lOREVYXSwKICAgICAgICAgICAgICAgIHZlaGljbGVzVDI6IFJFQURZX0RJQUxPR19WRUhJQ0xFX09QVElPTlNbUkVBRFlfRElBTE9HX1ZFSElDTEVfVDJfREVGQVVMVF9JTkRFWF0sCiAgICAgICAgICAgICAgICBhaXJjcmFmdENlaWxpbmc6IFJFQURZX0RJQUxPR19BSVJDUkFGVF9DRUlMSU5HX0RFRkFVTFQsCiAgICAgICAgICAgICAgICBhaXJjcmFmdENlaWxpbmdPdmVycmlkZUVuYWJsZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgdmVoaWNsZUluZGV4VDE6IFJFQURZX0RJQUxPR19WRUhJQ0xFX1QxX0RFRkFVTFRfSU5ERVgsCiAgICAgICAgICAgICAgICB2ZWhpY2xlSW5kZXhUMjogUkVBRFlfRElBTE9HX1ZFSElDTEVfVDJfREVGQVVMVF9JTkRFWCwKICAgICAgICAgICAgICAgIHZlaGljbGVPdmVycmlkZUVuYWJsZWQ6IGZhbHNlLAogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgcGhhc2U6IFJvdW5kUGhhc2UuTm90UmVhZHksCiAgICAgICAgbGFzdFdpbm5lclRlYW06IDAsCiAgICAgICAgbGFzdEVuZERldGFpbFJlYXNvbjogUm91bmRFbmREZXRhaWxSZWFzb24uTm9uZSwKICAgICAgICBsYXN0T2JqZWN0aXZlUHJvZ3Jlc3M6IDAuNSwKICAgICAgICBjbG9jazogewogICAgICAgICAgICBkdXJhdGlvblNlY29uZHM6IFJPVU5EX0NMT0NLX0RFRkFVTFRfU0VDT05EUywKICAgICAgICAgICAgcm91bmRMZW5ndGhTZWNvbmRzOiBST1VORF9DTE9DS19ERUZBVUxUX1NFQ09ORFMsCiAgICAgICAgICAgIG1hdGNoU3RhcnRFbGFwc2VkU2Vjb25kczogdW5kZWZpbmVkLAogICAgICAgICAgICBwYXVzZWRSZW1haW5pbmdTZWNvbmRzOiB1bmRlZmluZWQsCiAgICAgICAgICAgIGlzUGF1c2VkOiBmYWxzZSwKICAgICAgICAgICAgbGFzdERpc3BsYXllZFNlY29uZHM6IHVuZGVmaW5lZCwKICAgICAgICAgICAgbGFzdExvd1RpbWVTdGF0ZTogdW5kZWZpbmVkLAogICAgICAgICAgICBleHBpcnlGaXJlZDogZmFsc2UsCiAgICAgICAgICAgIGV4cGlyeUhhbmRsZXJzOiBbXSwKICAgICAgICB9LAogICAgICAgIGZsb3c6IHsKICAgICAgICAgICAgcm91bmRFbmRSZWRlcGxveVRva2VuOiAwLAogICAgICAgICAgICBjbG9ja0V4cGlyeUJvdW5kOiBmYWxzZSwKICAgICAgICAgICAgY2xlYW51cEFjdGl2ZTogZmFsc2UsCiAgICAgICAgICAgIGNsZWFudXBBbGxvd0RlcGxveTogZmFsc2UsCiAgICAgICAgICAgIHJvdW5kRW5kRGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgIHJvdW5kRW5kVWlMb2NrZG93bjogZmFsc2UsCiAgICAgICAgfSwKICAgICAgICBjb3VudGRvd246IHsKICAgICAgICAgICAgaXNBY3RpdmU6IGZhbHNlLAogICAgICAgICAgICBpc1JlcXVlc3RlZDogZmFsc2UsCiAgICAgICAgICAgIHRva2VuOiAwLAogICAgICAgICAgICBvdmVyTGluZU1lc3NhZ2VUb2tlbjogMCwKICAgICAgICB9LAogICAgICAgIGFpcmNyYWZ0Q2VpbGluZzogewogICAgICAgICAgICBtYXBEZWZhdWx0SHVkQ2VpbGluZzogUkVBRFlfRElBTE9HX0FJUkNSQUZUX0NFSUxJTkdfREVGQVVMVCwKICAgICAgICAgICAgaHVkTWF4WTogUkVBRFlfRElBTE9HX0FJUkNSQUZUX0NFSUxJTkdfREVGQVVMVCwKICAgICAgICAgICAgaHVkRmxvb3JZOiAwLAogICAgICAgICAgICBjdXN0b21FbmFibGVkOiBmYWxzZSwKICAgICAgICAgICAgZW5mb3JjZW1lbnRUb2tlbjogMCwKICAgICAgICAgICAgdmVoaWNsZVN0YXRlczoge30sCiAgICAgICAgfSwKICAgIH0sCiAgICBmbGFnOiB7CiAgICAgICAgc3RhZ2U6IE92ZXJ0aW1lU3RhZ2UuTm9uZSwKICAgICAgICBhY3RpdmU6IGZhbHNlLAogICAgICAgIHRyYWNraW5nRW5hYmxlZDogZmFsc2UsCiAgICAgICAgdW5sb2NrUmVtaW5kZXJTZW50OiBmYWxzZSwKICAgICAgICBjb25maWdWYWxpZDogZmFsc2UsCiAgICAgICAgb3ZlcnJpZGVVc2VkVGhpc1JvdW5kOiBmYWxzZSwKICAgICAgICB0aWVCcmVha2VyRW5hYmxlZFRoaXNSb3VuZDogZmFsc2UsCiAgICAgICAgY2FuZGlkYXRlWm9uZXM6IFtdLAogICAgICAgIGFjdGl2ZUFyZWFUcmlnZ2VySWQ6IHVuZGVmaW5lZCwKICAgICAgICBhY3RpdmVBcmVhVHJpZ2dlcjogdW5kZWZpbmVkLAogICAgICAgIGFjdGl2ZVNlY3RvcklkOiB1bmRlZmluZWQsCiAgICAgICAgYWN0aXZlU2VjdG9yOiB1bmRlZmluZWQsCiAgICAgICAgYWN0aXZlV29ybGRJY29uSWQ6IHVuZGVmaW5lZCwKICAgICAgICBhY3RpdmVXb3JsZEljb246IHVuZGVmaW5lZCwKICAgICAgICBhY3RpdmVDYXB0dXJlUG9pbnRJZDogdW5kZWZpbmVkLAogICAgICAgIGFjdGl2ZUNhcHR1cmVQb2ludDogdW5kZWZpbmVkLAogICAgICAgIGFjdGl2ZUNhbmRpZGF0ZUluZGV4OiB1bmRlZmluZWQsCiAgICAgICAgc2VsZWN0ZWRab25lTGV0dGVyS2V5OiB1bmRlZmluZWQsCiAgICAgICAgb3duZXJUZWFtOiAwLAogICAgICAgIHByb2dyZXNzOiAwLjUsCiAgICAgICAgdDFDb3VudDogMCwKICAgICAgICB0MkNvdW50OiAwLAogICAgICAgIHBsYXllcnNJblpvbmVCeVBpZDoge30sCiAgICAgICAgdmVoaWNsZU9jY3VwYW50c0J5VmlkOiB7fSwKICAgICAgICB2ZWhpY2xlVGVhbUJ5VmlkOiB7fSwKICAgICAgICBsYXN0VWlTbmFwc2hvdEJ5UGlkOiB7fSwKICAgICAgICBsYXN0R2xvYmFsUHJvZ3Jlc3NQZXJjZW50OiAtMSwKICAgICAgICBsYXN0TWVtYmVyc2hpcFBydW5lQXRTZWNvbmRzOiAwLAogICAgICAgIHVpQnlQaWQ6IHt9LAogICAgICAgIGdsb2JhbFVpQnlQaWQ6IHt9LAogICAgICAgIHRpY2tUb2tlbjogMCwKICAgICAgICB0aWNrQWN0aXZlOiBmYWxzZSwKICAgIH0sCiAgICBzY29yZXM6IHsKICAgICAgICB0MVJvdW5kS2lsbHM6IDAsCiAgICAgICAgdDJSb3VuZEtpbGxzOiAwLAogICAgICAgIHQxVG90YWxLaWxsczogMCwKICAgICAgICB0MlRvdGFsS2lsbHM6IDAsCiAgICB9LAogICAgbWF0Y2g6IHsKICAgICAgICB3aW5zVDE6IDAsCiAgICAgICAgd2luc1QyOiAwLAogICAgICAgIGxvc3Nlc1QxOiAwLAogICAgICAgIGxvc3Nlc1QyOiAwLAogICAgICAgIHRpZXNUMTogMCwKICAgICAgICB0aWVzVDI6IDAsCiAgICAgICAgaXNFbmRlZDogZmFsc2UsCiAgICAgICAgdmljdG9yeURpYWxvZ0FjdGl2ZTogZmFsc2UsCiAgICAgICAgd2lubmVyVGVhbTogdW5kZWZpbmVkLAogICAgICAgIGVuZEVsYXBzZWRTZWNvbmRzU25hcHNob3Q6IDAsCiAgICAgICAgdmljdG9yeVN0YXJ0RWxhcHNlZFNlY29uZHNTbmFwc2hvdDogMCwKICAgICAgICBmbG93OiB7CiAgICAgICAgICAgIG1hdGNoRW5kRGVsYXlUb2tlbjogMCwKICAgICAgICB9LAogICAgfSwKICAgIGFkbWluOiB7CiAgICAgICAgYWN0aW9uQ291bnQ6IDAsCiAgICAgICAgZGVidWdMb29wQWN0aXZlOiBmYWxzZSwKICAgICAgICB0aWVCcmVha2VyT3ZlcnJpZGVJbmRleDogdW5kZWZpbmVkLAogICAgICAgIHRpZUJyZWFrZXJPdmVycmlkZVVzZWQ6IGZhbHNlLAogICAgICAgIHRpZUJyZWFrZXJNb2RlSW5kZXg6IEFETUlOX1RJRUJSRUFLRVJfTU9ERV9ERUZBVUxUX0lOREVYLAogICAgICAgIGxpdmVSZXNwYXduRW5hYmxlZDogREVGQVVMVF9MSVZFX1JFU1BBV05fRU5BQkxFRCwKICAgIH0sCiAgICBkZWJ1ZzogewogICAgICAgIGhpZ2hsaWdodGVkTWVzc2FnZUNvdW50OiAwLAogICAgICAgIGxhc3RIaWdobGlnaHRlZE1lc3NhZ2VBdFNlY29uZHM6IC0xLAogICAgICAgIGxhc3RIaWdobGlnaHRlZE1lc3NhZ2VLZXk6IC0xLAogICAgfSwKICAgIHBsYXllcnM6IHsKICAgICAgICB0ZWFtU3dpdGNoRGF0YToge30sCiAgICAgICAgcmVhZHlCeVBpZDoge30sCiAgICAgICAgYXV0b1JlYWR5QnlQaWQ6IHt9LAogICAgICAgIHJlYWR5TWVzc2FnZUNvb2xkb3duQnlQaWQ6IHt9LAogICAgICAgIGpvaW5Qcm9tcHRTaG93bkJ5UGlkOiB7fSwKICAgICAgICBqb2luUHJvbXB0TmV2ZXJTaG93QnlQaWRNYXA6IHt9LAogICAgICAgIGpvaW5Qcm9tcHRSZWFkeURpYWxvZ09wZW5lZEJ5UGlkOiB7fSwKICAgICAgICBqb2luUHJvbXB0VGlwSW5kZXhCeVBpZDoge30sCiAgICAgICAgam9pblByb21wdFRpcHNVbmxvY2tlZEJ5UGlkOiB7fSwKICAgICAgICBqb2luUHJvbXB0VHJpcGxlVGFwQXJtZWRCeVBpZDoge30sCiAgICAgICAgaW5NYWluQmFzZUJ5UGlkOiB7fSwKICAgICAgICBvdmVyVGFrZW9mZkxpbWl0QnlQaWQ6IHt9LAogICAgICAgIGRlcGxveWVkQnlQaWQ6IHt9LAogICAgICAgIGRpc2Nvbm5lY3RlZEJ5UGlkOiB7fSwKICAgICAgICB1aUlucHV0RW5hYmxlZEJ5UGlkOiB7fSwKICAgICAgICBzcGF3bkRpc2FibGVkV2FybmluZ1Zpc2libGVCeVBpZDoge30sCiAgICB9LAogICAgdmVoaWNsZXM6IHsKICAgICAgICBzbG90czogW10sCiAgICAgICAgdmVoaWNsZVRvU2xvdDoge30sCiAgICAgICAgc3Bhd25TZXF1ZW5jZVRva2VuOiAwLAogICAgICAgIHNwYXduU2VxdWVuY2VJblByb2dyZXNzOiBmYWxzZSwKICAgICAgICBhY3RpdmVTcGF3blNsb3RJbmRleDogdW5kZWZpbmVkLAogICAgICAgIGFjdGl2ZVNwYXduVG9rZW46IHVuZGVmaW5lZCwKICAgICAgICBhY3RpdmVTcGF3blJlcXVlc3RlZEF0U2Vjb25kczogdW5kZWZpbmVkLAogICAgICAgIGNvbmZpZ1JlYWR5OiBmYWxzZSwKICAgICAgICBzdGFydHVwQ2xlYW51cERvbmU6IGZhbHNlLAogICAgfSwKICAgIGh1ZENhY2hlOiB7CiAgICAgICAgbGFzdEh1ZFNjb3JlVDE6IHVuZGVmaW5lZCwKICAgICAgICBsYXN0SHVkU2NvcmVUMjogdW5kZWZpbmVkLAogICAgICAgIGxhc3RIdWRSb3VuZEtpbGxzVDE6IHVuZGVmaW5lZCwKICAgICAgICBsYXN0SHVkUm91bmRLaWxsc1QyOiB1bmRlZmluZWQsCiAgICAgICAgaHVkQnlQaWQ6IHt9LAogICAgICAgIGNsb2NrV2lkZ2V0Q2FjaGU6IHt9LAogICAgICAgIGNvdW50ZG93bldpZGdldENhY2hlOiB7fSwKICAgICAgICBvdmVyTGluZVRpdGxlV2lkZ2V0Q2FjaGU6IHt9LAogICAgICAgIG92ZXJMaW5lU3VidGl0bGVXaWRnZXRDYWNoZToge30sCiAgICAgICAgb3ZlckxpbmVUaXRsZVNoYWRvd1dpZGdldENhY2hlOiB7fSwKICAgICAgICBvdmVyTGluZVN1YnRpdGxlU2hhZG93V2lkZ2V0Q2FjaGU6IHt9LAogICAgfSwKfTsKCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBHYW1lIFN0YXRlIERlZmluaXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBDb3VudGVyIEhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIHNldENvdW50ZXJUZXh0KHdpZGdldDogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkLCB2YWx1ZTogbnVtYmVyKTogdm9pZCB7CiAgICBpZiAoIXdpZGdldCkgcmV0dXJuOwogICAgc2FmZVNldFVJVGV4dExhYmVsKHdpZGdldCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgTWF0aC5mbG9vcih2YWx1ZSkpKTsKfQoKZnVuY3Rpb24gc2V0Um91bmRSZWNvcmRUZXh0KHdpZGdldDogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkLCB3aW5zOiBudW1iZXIsIGxvc3NlczogbnVtYmVyLCB0aWVzOiBudW1iZXIpOiB2b2lkIHsKICAgIGlmICghd2lkZ2V0KSByZXR1cm47CiAgICBzYWZlU2V0VUlUZXh0TGFiZWwod2lkZ2V0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kUmVjb3JkRm9ybWF0LCBNYXRoLmZsb29yKHdpbnMpLCBNYXRoLmZsb29yKGxvc3NlcyksIE1hdGguZmxvb3IodGllcykpKTsKfQoKZnVuY3Rpb24gZ2V0VHJlbmRpbmdXaW5uZXJUZWFtKCk6IFRlYW1JRCB8IDAgewogICAgaWYgKFN0YXRlLm1hdGNoLndpbnNUMSA+IFN0YXRlLm1hdGNoLndpbnNUMikgcmV0dXJuIFRlYW1JRC5UZWFtMTsKICAgIGlmIChTdGF0ZS5tYXRjaC53aW5zVDIgPiBTdGF0ZS5tYXRjaC53aW5zVDEpIHJldHVybiBUZWFtSUQuVGVhbTI7CiAgICByZXR1cm4gMDsKfQoKZnVuY3Rpb24gc2V0VHJlbmRpbmdXaW5uZXJDcm93bkZvclJlZnMocmVmczogSHVkUmVmcyB8IHVuZGVmaW5lZCk6IHZvaWQgewogICAgaWYgKCFyZWZzKSByZXR1cm47CiAgICBjb25zdCB3aW5uZXIgPSBnZXRUcmVuZGluZ1dpbm5lclRlYW0oKTsKICAgIGNvbnN0IHNob3dMZWZ0ID0gd2lubmVyID09PSBUZWFtSUQuVGVhbTE7CiAgICBjb25zdCBzaG93UmlnaHQgPSB3aW5uZXIgPT09IFRlYW1JRC5UZWFtMjsKICAgIHNhZmVTZXRVSVdpZGdldFZpc2libGUocmVmcy5sZWZ0VHJlbmRpbmdXaW5uZXJDcm93biwgc2hvd0xlZnQpOwogICAgc2FmZVNldFVJV2lkZ2V0VmlzaWJsZShyZWZzLnJpZ2h0VHJlbmRpbmdXaW5uZXJDcm93biwgc2hvd1JpZ2h0KTsKfQoKZnVuY3Rpb24gc2V0VHJlbmRpbmdXaW5uZXJDcm93bkZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHJlZnMgPSBlbnN1cmVIdWRGb3JQbGF5ZXIocCk7CiAgICAgICAgaWYgKCFyZWZzKSBjb250aW51ZTsKICAgICAgICBzZXRUcmVuZGluZ1dpbm5lckNyb3duRm9yUmVmcyhyZWZzKTsKICAgIH0KfQoKZnVuY3Rpb24gc2V0QWRtaW5QYW5lbEFjdGlvbkNvdW50VGV4dCh3aWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCwgdmFsdWU6IG51bWJlcik6IHZvaWQgewogICAgaWYgKCF3aWRnZXQpIHJldHVybjsKICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3aWRnZXQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbkNvdW50Rm9ybWF0LCBNYXRoLmZsb29yKHZhbHVlKSkpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIENvdW50ZXIgSGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gSFVEIFJvdW5kIFN0YXRlICsgSGVscCBUZXh0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBzZXRSb3VuZFN0YXRlVGV4dCh3aWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCk6IHZvaWQgewogICAgaWYgKCF3aWRnZXQpIHJldHVybjsKCiAgICBpZiAoU3RhdGUucm91bmQucGhhc2UgPT09IFJvdW5kUGhhc2UuR2FtZU92ZXIpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwod2lkZ2V0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kU3RhdGVHYW1lT3ZlcikpOwogICAgICAgIG1vZC5TZXRVSVRleHRDb2xvcih3aWRnZXQsIENPTE9SX1dBUk5JTkdfWUVMTE9XKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgaXNMaXZlID0gaXNSb3VuZExpdmUoKTsKICAgIGNvbnN0IHN0YXRlS2V5ID0gaXNMaXZlID8gbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFN0YXRlTGl2ZSA6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQucm91bmRTdGF0ZU5vdFJlYWR5OwoKICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICB3aWRnZXQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFN0YXRlRm9ybWF0LCBtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kVGV4dCwgTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5jdXJyZW50KSwgc3RhdGVLZXkpCiAgICApOwoKICAgIC8vIENvbG9yOiB3aGl0ZSB3aGVuIExJVkUsIHJlZCB3aGVuIE5PVCBSRUFEWQogICAgbW9kLlNldFVJVGV4dENvbG9yKHdpZGdldCwgaXNMaXZlID8gbW9kLkNyZWF0ZVZlY3RvcigxLCAxLCAxKSA6IENPTE9SX05PVF9SRUFEWV9SRUQpOwp9CgpmdW5jdGlvbiBzZXRSb3VuZExpdmVIZWxwVGV4dCgKICAgIHJvb3Q6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCwKICAgIHRleHQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZAopOiB2b2lkIHsKICAgIGlmICghcm9vdCB8fCAhdGV4dCkgcmV0dXJuOwoKICAgIGNvbnN0IHNob3cgPSAoIVN0YXRlLm1hdGNoLmlzRW5kZWQpICYmIChpc1JvdW5kTGl2ZSgpKTsKICAgIG1vZC5TZXRVSVdpZGdldFZpc2libGUocm9vdCwgc2hvdyk7CgogICAgaWYgKCFzaG93KSByZXR1cm47CgogICAgY29uc3QgbGFiZWwgPSBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kTGl2ZUhlbHBGb3JtYXQsIE1hdGguZmxvb3IoU3RhdGUucm91bmQua2lsbHNUYXJnZXQpKTsKICAgIGlmICh0ZXh0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHRleHQsIGxhYmVsKTsKICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3IodGV4dCwgbW9kLkNyZWF0ZVZlY3RvcigxLCAxLCAxKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGdldFJvdW5kS2lsbHNMYWJlbFJvdW5kKCk6IG51bWJlciB7CiAgICBpZiAoU3RhdGUucm91bmQucGhhc2UgPT09IFJvdW5kUGhhc2UuTGl2ZSkgcmV0dXJuIE1hdGgubWF4KDEsIE1hdGguZmxvb3IoU3RhdGUucm91bmQuY3VycmVudCkpOwogICAgaWYgKFN0YXRlLnJvdW5kLnBoYXNlID09PSBSb3VuZFBoYXNlLkdhbWVPdmVyKSByZXR1cm4gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5jdXJyZW50KSk7CiAgICByZXR1cm4gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5jdXJyZW50IC0gMSkpOwp9CgpmdW5jdGlvbiBzZXRSb3VuZEtpbGxzTGFiZWxUZXh0Rm9yUmVmcyhyZWZzOiBIdWRSZWZzIHwgdW5kZWZpbmVkKTogdm9pZCB7CiAgICBpZiAoIXJlZnMpIHJldHVybjsKICAgIGNvbnN0IGxhYmVsID0gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMucm91bmRLaWxsc1dpdGhSb3VuZEZvcm1hdCwgZ2V0Um91bmRLaWxsc0xhYmVsUm91bmQoKSk7CiAgICBpZiAocmVmcy5sZWZ0Um91bmRLaWxsc0xhYmVsKSBtb2QuU2V0VUlUZXh0TGFiZWwocmVmcy5sZWZ0Um91bmRLaWxsc0xhYmVsLCBsYWJlbCk7CiAgICBpZiAocmVmcy5yaWdodFJvdW5kS2lsbHNMYWJlbCkgbW9kLlNldFVJVGV4dExhYmVsKHJlZnMucmlnaHRSb3VuZEtpbGxzTGFiZWwsIGxhYmVsKTsKfQoKZnVuY3Rpb24gZ2V0Q2xvY2tUaW1lUGFydHMocmVtYWluaW5nU2Vjb25kczogbnVtYmVyKTogeyBtaW51dGVzOiBudW1iZXI7IHNlY1RlbnM6IG51bWJlcjsgc2VjT25lczogbnVtYmVyIH0gewogICAgY29uc3QgY2xhbXBlZCA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IocmVtYWluaW5nU2Vjb25kcykpOwogICAgY29uc3QgbWludXRlcyA9IE1hdGguZmxvb3IoY2xhbXBlZCAvIDYwKTsKICAgIGNvbnN0IHNlY29uZHMgPSBjbGFtcGVkICUgNjA7CiAgICBjb25zdCBzZWNUZW5zID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gMTApOwogICAgY29uc3Qgc2VjT25lcyA9IHNlY29uZHMgJSAxMDsKICAgIHJldHVybiB7CiAgICAgICAgbWludXRlcywKICAgICAgICBzZWNUZW5zLAogICAgICAgIHNlY09uZXMsCiAgICB9Owp9CgovLyBVSSBoYXJkZW5pbmcgaGVscGVycyBza2lwIHdvcmsgaWYgYSB3aWRnZXQgaXMgbWlzc2luZyAoUGFyc2VVSSBhbmQgc2FmZUZpbmQgY2FuIHlpZWxkIHVuZGVmaW5lZCkuCi8vIFRoaXMgcHJldmVudHMgcnVudGltZSBpc3N1ZXMgYW5kIGFsc28gYXZvaWRzIFRTIGVycm9ycyBmcm9tIHBhc3NpbmcgVUlXaWRnZXQgfCB1bmRlZmluZWQgaW50byBtb2QuKiBVSSBjYWxscy4KZnVuY3Rpb24gc2FmZVNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCwgdmlzaWJsZTogYm9vbGVhbik6IHZvaWQgewogICAgaWYgKCF3aWRnZXQpIHJldHVybjsKICAgIHRyeSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXQsIHZpc2libGUpOwogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuOwogICAgfQp9CgpmdW5jdGlvbiBzYWZlU2V0VUlUZXh0TGFiZWwod2lkZ2V0OiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQsIGxhYmVsOiBtb2QuTWVzc2FnZSk6IHZvaWQgewogICAgaWYgKCF3aWRnZXQpIHJldHVybjsKICAgIHRyeSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHdpZGdldCwgbGFiZWwpOwogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuOwogICAgfQp9CgpmdW5jdGlvbiBzYWZlU2V0VUlUZXh0Q29sb3Iod2lkZ2V0OiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQsIGNvbG9yOiBtb2QuVmVjdG9yKTogdm9pZCB7CiAgICBpZiAoIXdpZGdldCkgcmV0dXJuOwogICAgdHJ5IHsKICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3Iod2lkZ2V0LCBjb2xvcik7CiAgICB9IGNhdGNoIHsKICAgICAgICByZXR1cm47CiAgICB9Cn0KCmZ1bmN0aW9uIHNhZmVTZXRVSVdpZGdldERlcHRoKHdpZGdldDogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkLCBkZXB0aDogbW9kLlVJRGVwdGgpOiB2b2lkIHsKICAgIGlmICghd2lkZ2V0KSByZXR1cm47CiAgICB0cnkgewogICAgICAgIG1vZC5TZXRVSVdpZGdldERlcHRoKHdpZGdldCwgZGVwdGgpOwogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuOwogICAgfQp9CgpmdW5jdGlvbiBzYWZlQWRkVUlDb250YWluZXIoCiAgICBuYW1lOiBzdHJpbmcsCiAgICBwb3NpdGlvbjogbW9kLlZlY3RvciwKICAgIHNpemU6IG1vZC5WZWN0b3IsCiAgICBhbmNob3I6IG1vZC5VSUFuY2hvciwKICAgIHBhcmVudDogbW9kLlVJV2lkZ2V0LAogICAgdmlzaWJsZTogYm9vbGVhbiwKICAgIHBhZGRpbmc6IG51bWJlciwKICAgIGNvbG9yOiBtb2QuVmVjdG9yLAogICAgYWxwaGE6IG51bWJlciwKICAgIGZpbGw6IG1vZC5VSUJnRmlsbCwKICAgIGRlcHRoOiBtb2QuVUlEZXB0aCwKICAgIHBsYXllcjogbW9kLlBsYXllcgopOiB2b2lkIHsKICAgIHRyeSB7CiAgICAgICAgbW9kLkFkZFVJQ29udGFpbmVyKAogICAgICAgICAgICBuYW1lLAogICAgICAgICAgICBwb3NpdGlvbiwKICAgICAgICAgICAgc2l6ZSwKICAgICAgICAgICAgYW5jaG9yLAogICAgICAgICAgICBwYXJlbnQsCiAgICAgICAgICAgIHZpc2libGUsCiAgICAgICAgICAgIHBhZGRpbmcsCiAgICAgICAgICAgIGNvbG9yLAogICAgICAgICAgICBhbHBoYSwKICAgICAgICAgICAgZmlsbCwKICAgICAgICAgICAgZGVwdGgsCiAgICAgICAgICAgIHBsYXllcgogICAgICAgICk7CiAgICB9IGNhdGNoIHsKICAgICAgICByZXR1cm47CiAgICB9Cn0KCmZ1bmN0aW9uIHNhZmVTZXRVSVdpZGdldFNpemUod2lkZ2V0OiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQsIHNpemU6IG1vZC5WZWN0b3IpOiB2b2lkIHsKICAgIGlmICghd2lkZ2V0KSByZXR1cm47CiAgICB0cnkgewogICAgICAgIG1vZC5TZXRVSVdpZGdldFNpemUod2lkZ2V0LCBzaXplKTsKICAgIH0gY2F0Y2ggewogICAgICAgIHJldHVybjsKICAgIH0KfQoKZnVuY3Rpb24gc2V0V2lkZ2V0VmlzaWJsZSh3aWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCwgdmlzaWJsZTogYm9vbGVhbik6IHZvaWQgewogICAgaWYgKCF3aWRnZXQpIHJldHVybjsKICAgIHNhZmVTZXRVSVdpZGdldFZpc2libGUod2lkZ2V0LCB2aXNpYmxlKTsKLy8gU2V0VUlUZXh0TGFiZWwgb25seSBhY2NlcHRzIG1vZC5NZXNzYWdlOyBzdHJpbmcgaW5wdXRzIGFyZSB0cmVhdGVkIGFzIHN0cmluZyBrZXlzIGFuZCB3cmFwcGVkIHdpdGggbW9kLk1lc3NhZ2Uoa2V5KS4KfQoKZnVuY3Rpb24gc2V0V2lkZ2V0VGV4dCh3aWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCwgbGFiZWw6IHN0cmluZyB8IG1vZC5NZXNzYWdlKTogdm9pZCB7CiAgICBpZiAoIXdpZGdldCkgcmV0dXJuOwogICAgaWYgKHR5cGVvZiBsYWJlbCA9PT0gJ3N0cmluZycpIHsKICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwod2lkZ2V0LCBtb2QuTWVzc2FnZShsYWJlbCkpOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIHNhZmVTZXRVSVRleHRMYWJlbCh3aWRnZXQsIGxhYmVsKTsKfQoKZnVuY3Rpb24gZW5zdXJlVG9wSHVkUm9vdEZvclBpZChwaWQ6IG51bWJlciwgcGxheWVyPzogbW9kLlBsYXllcik6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCB7CiAgICBjb25zdCByb290TmFtZSA9IGBUb3BIdWRSb290XyR7cGlkfWA7CiAgICBsZXQgcm9vdCA9IHNhZmVGaW5kKHJvb3ROYW1lKTsKICAgIGlmICghcm9vdCAmJiBwbGF5ZXIpIHsKICAgICAgICBtb2QuQWRkVUlDb250YWluZXIoCiAgICAgICAgICAgIHJvb3ROYW1lLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDAsIDApLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKFRPUF9IVURfUk9PVF9XSURUSCwgVE9QX0hVRF9ST09UX0hFSUdIVCwgMCksCiAgICAgICAgICAgIG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgIG1vZC5HZXRVSVJvb3QoKSwKICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigwLCAwLCAwKSwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJLAogICAgICAgICAgICBwbGF5ZXIKICAgICAgICApOwogICAgICAgIHJvb3QgPSBzYWZlRmluZChyb290TmFtZSk7CiAgICB9CgogICAgaWYgKCFyb290KSByZXR1cm4gdW5kZWZpbmVkOwogICAgbW9kLlNldFVJV2lkZ2V0RGVwdGgocm9vdCwgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUkpOwoKICAgIGNvbnN0IHJlcGFyZW50SWRzID0gWwogICAgICAgICJDb250YWluZXJfVG9wTWlkZGxlX0NvcmVVSV8iLAogICAgICAgICJDb250YWluZXJfVG9wTGVmdF9Db3JlVUlfIiwKICAgICAgICAiQ29udGFpbmVyX1RvcFJpZ2h0X0NvcmVVSV8iLAogICAgICAgICJDb250YWluZXJfVG9wTGVmdF9Sb3VuZEtpbGxzXyIsCiAgICAgICAgIkNvbnRhaW5lcl9Ub3BSaWdodF9Sb3VuZEtpbGxzXyIsCiAgICAgICAgIlJvdW5kQ291bnRlckNvbnRhaW5lcl8iLAogICAgICAgICJSb3VuZENvdW50ZXJNYXhDb250YWluZXJfIiwKICAgICAgICAiVGVhbUxlZnRfV2luc19Db3VudGVyXyIsCiAgICAgICAgIlRlYW1SaWdodF9XaW5zX0NvdW50ZXJfIiwKICAgICAgICAiVGVhbUxlZnRfS2lsbHNfQ291bnRlcl8iLAogICAgICAgICJUZWFtUmlnaHRfS2lsbHNfQ291bnRlcl8iLAogICAgXTsKCiAgICBmb3IgKGNvbnN0IGJhc2Ugb2YgcmVwYXJlbnRJZHMpIHsKICAgICAgICBjb25zdCB3aWRnZXQgPSBzYWZlRmluZChiYXNlICsgcGlkKTsKICAgICAgICBpZiAoIXdpZGdldCkgY29udGludWU7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KHdpZGdldCwgcm9vdCk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0RGVwdGgod2lkZ2V0LCBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSk7CiAgICB9CgogICAgY29uc3QgdG9wSHVkRGVwdGhJZHMgPSBbCiAgICAgICAgIk1hdGNoVGltZXJSb290XyIsCiAgICAgICAgIlJvdW5kU3RhdGVSb290XyIsCiAgICBdOwogICAgZm9yIChjb25zdCBiYXNlIG9mIHRvcEh1ZERlcHRoSWRzKSB7CiAgICAgICAgY29uc3Qgd2lkZ2V0ID0gc2FmZUZpbmQoYmFzZSArIHBpZCk7CiAgICAgICAgaWYgKHdpZGdldCkgbW9kLlNldFVJV2lkZ2V0RGVwdGgod2lkZ2V0LCBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSk7CiAgICB9CgogICAgcmV0dXJuIHJvb3Q7Cn0KCmZ1bmN0aW9uIHNldEh1ZEhlbHBEZXB0aEZvclBpZChwaWQ6IG51bWJlcik6IHZvaWQgewogICAgY29uc3QgaGVscElkcyA9IFsKICAgICAgICBgQ29udGFpbmVyX0hlbHBUZXh0XyR7cGlkfWAsCiAgICAgICAgYEhlbHBUZXh0XyR7cGlkfWAsCiAgICAgICAgYENvbnRhaW5lcl9SZWFkeVN0YXR1c18ke3BpZH1gLAogICAgICAgIGBSZWFkeVN0YXR1c1RleHRfJHtwaWR9YCwKICAgICAgICBgUGxheWVyc1JlYWR5VGV4dF8ke3BpZH1gLAogICAgICAgIGBSb3VuZExpdmVIZWxwUm9vdF8ke3BpZH1gLAogICAgICAgIGBSb3VuZExpdmVIZWxwVGV4dF8ke3BpZH1gLAogICAgXTsKICAgIGZvciAoY29uc3QgbmFtZSBvZiBoZWxwSWRzKSB7CiAgICAgICAgY29uc3Qgd2lkZ2V0ID0gc2FmZUZpbmQobmFtZSk7CiAgICAgICAgaWYgKHdpZGdldCkgbW9kLlNldFVJV2lkZ2V0RGVwdGgod2lkZ2V0LCBtb2QuVUlEZXB0aC5CZWxvd0dhbWVVSSk7CiAgICB9Cn0KCmZ1bmN0aW9uIHJlcGFyZW50U3Bhd25EaXNhYmxlZExpdmVUZXh0Rm9yUGlkKHBpZDogbnVtYmVyLCBwYXJlbnRPdmVycmlkZT86IG1vZC5VSVdpZGdldCk6IHZvaWQgewogICAgY29uc3Qgd2lkZ2V0ID0gc2FmZUZpbmQoYFNwYXduRGlzYWJsZWRMaXZlVGV4dF8ke3BpZH1gKTsKICAgIGlmICghd2lkZ2V0KSByZXR1cm47CiAgICBjb25zdCBwYXJlbnQgPSBwYXJlbnRPdmVycmlkZSA/PyBzYWZlRmluZChqb2luUHJvbXB0Um9vdE5hbWUocGlkKSkgPz8gbW9kLkdldFVJUm9vdCgpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KHdpZGdldCwgcGFyZW50KTsKICAgIG1vZC5TZXRVSVdpZGdldERlcHRoKHdpZGdldCwgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUkpOwp9CgpmdW5jdGlvbiBlbnN1cmVTcGF3bkRpc2FibGVkTGl2ZVRleHQocGxheWVyOiBtb2QuUGxheWVyKTogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkIHsKICAgIGNvbnN0IHBpZCA9IGdldE9iaklkKHBsYXllcik7CiAgICBjb25zdCBleGlzdGluZyA9IHNhZmVGaW5kKGBTcGF3bkRpc2FibGVkTGl2ZVRleHRfJHtwaWR9YCk7CiAgICBpZiAoZXhpc3RpbmcpIHsKICAgICAgICByZXBhcmVudFNwYXduRGlzYWJsZWRMaXZlVGV4dEZvclBpZChwaWQpOwogICAgICAgIHJldHVybiBleGlzdGluZzsKICAgIH0KICAgIGNvbnN0IHNwYXduRGlzYWJsZWRUZXh0ID0gbW9kbGliLlBhcnNlVUkoewogICAgICAgIG5hbWU6IGBTcGF3bkRpc2FibGVkTGl2ZVRleHRfJHtwaWR9YCwKICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgIHBvc2l0aW9uOiBbMCwgU1BBV05fRElTQUJMRURfVEVYVF9QT1NfWV0sCiAgICAgICAgc2l6ZTogW1NQQVdOX0RJU0FCTEVEX1RFWFRfV0lEVEgsIFNQQVdOX0RJU0FCTEVEX1RFWFRfSEVJR0hUXSwKICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Cb3R0b21DZW50ZXIsCiAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgcGFkZGluZzogMCwKICAgICAgICBiZ0NvbG9yOiBbMCwgMCwgMF0sCiAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuc3Bhd25EaXNhYmxlZExpdmUsCiAgICAgICAgdGV4dENvbG9yOiBTUEFXTl9ESVNBQkxFRF9URVhUX0NPTE9SX1JHQiwKICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgdGV4dFNpemU6IFNQQVdOX0RJU0FCTEVEX1RFWFRfU0laRSwKICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgfSk7CiAgICBpZiAoc3Bhd25EaXNhYmxlZFRleHQpIHsKICAgICAgICBtb2QuU2V0VUlXaWRnZXREZXB0aChzcGF3bkRpc2FibGVkVGV4dCwgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUkpOwogICAgICAgIHJlcGFyZW50U3Bhd25EaXNhYmxlZExpdmVUZXh0Rm9yUGlkKHBpZCk7CiAgICB9CiAgICByZXR1cm4gc3Bhd25EaXNhYmxlZFRleHQ7Cn0KCmZ1bmN0aW9uIHNldFNwYXduRGlzYWJsZWRMaXZlVGV4dFZpc2libGVGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyLCB2aXNpYmxlOiBib29sZWFuKTogdm9pZCB7CiAgICBjb25zdCByZWZzID0gZW5zdXJlSHVkRm9yUGxheWVyKHBsYXllcik7CiAgICBpZiAoIXJlZnMgfHwgIXJlZnMuc3Bhd25EaXNhYmxlZExpdmVUZXh0KSByZXR1cm47CiAgICBzYWZlU2V0VUlXaWRnZXRWaXNpYmxlKHJlZnMuc3Bhd25EaXNhYmxlZExpdmVUZXh0LCB2aXNpYmxlKTsKfQoKZnVuY3Rpb24gc2V0U3Bhd25EaXNhYmxlZExpdmVUZXh0VmlzaWJsZUZvckFsbFBsYXllcnModmlzaWJsZTogYm9vbGVhbik6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBzZXRTcGF3bkRpc2FibGVkTGl2ZVRleHRWaXNpYmxlRm9yUGxheWVyKHAsIHZpc2libGUpOwogICAgfQp9CgpmdW5jdGlvbiBpc0xpdmVSZXNwYXduRGlzYWJsZWQoKTogYm9vbGVhbiB7CiAgICByZXR1cm4gIVN0YXRlLmFkbWluLmxpdmVSZXNwYXduRW5hYmxlZDsKfQoKZnVuY3Rpb24gdXBkYXRlU3Bhd25EaXNhYmxlZFdhcm5pbmdGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuOwogICAgY29uc3QgcGlkID0gZ2V0T2JqSWQocGxheWVyKTsKICAgIGNvbnN0IHNob3VsZFNob3cgPSBpc0xpdmVSZXNwYXduRGlzYWJsZWQoKSAmJiBpc1JvdW5kTGl2ZSgpICYmICFpc1BsYXllckRlcGxveWVkKHBsYXllcik7CiAgICBjb25zdCBsYXN0VmlzaWJsZSA9IFN0YXRlLnBsYXllcnMuc3Bhd25EaXNhYmxlZFdhcm5pbmdWaXNpYmxlQnlQaWRbcGlkXSA/PyBmYWxzZTsKICAgIGlmIChzaG91bGRTaG93ID09PSBsYXN0VmlzaWJsZSkgcmV0dXJuOwogICAgU3RhdGUucGxheWVycy5zcGF3bkRpc2FibGVkV2FybmluZ1Zpc2libGVCeVBpZFtwaWRdID0gc2hvdWxkU2hvdzsKICAgIGNvbnN0IHdpZGdldCA9IGVuc3VyZVNwYXduRGlzYWJsZWRMaXZlVGV4dChwbGF5ZXIpOwogICAgc2FmZVNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXQsIHNob3VsZFNob3cpOwp9CgpmdW5jdGlvbiB1cGRhdGVTcGF3bkRpc2FibGVkV2FybmluZ0ZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIHVwZGF0ZVNwYXduRGlzYWJsZWRXYXJuaW5nRm9yUGxheWVyKHApOwogICAgfQp9CgovKioKICogU2V0cyB0aGUgc2hhcmVkIHJvdW5kIHN0YXRlIHRleHQgKGUuZy4sIE5PVCBSRUFEWSAvIExJVkUgLyBHQU1FIE9WRVIpIGZvciBldmVyeSBwbGF5ZXIncyBIVUQuCiAqIFRoaXMgaXMgYSBicm9hZGNhc3Qtc3R5bGUgVUkgdXBkYXRlOgogKiAtIEl0IGRvZXMgbm90IG11dGF0ZSByb3VuZCBzdGF0ZTsgaXQgcmVmbGVjdHMgd2hhdGV2ZXIgYXV0aG9yaXRhdGl2ZSBzdGF0ZSBhbHJlYWR5IGV4aXN0cy4KICogLSBJdCBzaG91bGQgYmUgY2FsbGVkIGFmdGVyIGFueSBjaGFuZ2UgdGhhdCBhZmZlY3RzIHRoZSByb3VuZCBwaGFzZSBzbyBIVURzIHJlbWFpbiBjb25zaXN0ZW50LgogKi8KCmZ1bmN0aW9uIHNldFJvdW5kU3RhdGVUZXh0Rm9yQWxsUGxheWVycygpOiB2b2lkIHsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgY2FjaGUgPSBlbnN1cmVDbG9ja1VJQW5kR2V0Q2FjaGUocCk7CiAgICAgICAgaWYgKCFjYWNoZSkgY29udGludWU7CiAgICAgICAgc2V0Um91bmRTdGF0ZVRleHQoY2FjaGUucm91bmRTdGF0ZVRleHQpOwogICAgICAgIHNldFJvdW5kTGl2ZUhlbHBUZXh0KGNhY2hlLnJvdW5kTGl2ZUhlbHBSb290LCBjYWNoZS5yb3VuZExpdmVIZWxwVGV4dCk7CiAgICAgICAgY29uc3QgcmVmcyA9IGVuc3VyZUh1ZEZvclBsYXllcihwKTsKICAgICAgICBpZiAocmVmcykgc2V0Um91bmRLaWxsc0xhYmVsVGV4dEZvclJlZnMocmVmcyk7CiAgICB9CiAgICAvLyBLZWVwIHRoZSBwcmUtcm91bmQgcmVhZHkgY291bnQgbGluZSBpbiBzeW5jIHdpdGggYW55IHJvdW5kLXBoYXNlIEhVRCByZWZyZXNoLgogICAgdXBkYXRlUGxheWVyc1JlYWR5SHVkVGV4dEZvckFsbFBsYXllcnMoKTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEhVRCBSb3VuZCBTdGF0ZSArIEhlbHAgVGV4dCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gSFVEIFJlYWR5IENvdW50IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovKioKICogVXBkYXRlcyB0aGUgeWVsbG93IEhVRCBsaW5lOiAiWCAvIFkgUExBWUVSUyBSRUFEWSIgKHByZS1yb3VuZCBvbmx5KS4KICogVmlzaWJpbGl0eSBydWxlczoKICogLSBPbmx5IHNob3duIHdoaWxlIHByZXBhcmluZyBmb3IgYSBuZXcgcm91bmQgKHJvdW5kIE5PVCBsaXZlKS4KICogLSBIaWRkZW4gZHVyaW5nIGdhbWUtb3ZlciAvIHZpY3RvcnkgZGlhbG9nIHBoYXNlcy4KICogLSBSZW1haW5zIHZpc2libGUgdW50aWwgdGhlIHJvdW5kIGlzIGFjdHVhbGx5IGxpdmUgKGlzUm91bmRMaXZlKCkgPT09IHRydWUpLgogKiBJTVBPUlRBTlQ6IEFueSBjb2RlIHBhdGggdGhhdCBjaGFuZ2VzIFN0YXRlLnBsYXllcnMucmVhZHlCeVBpZCBNVVNUIGFsc28gcmVmcmVzaDoKICogICAtIHVwZGF0ZVBsYXllcnNSZWFkeUh1ZFRleHRGb3JBbGxQbGF5ZXJzKCkKICogICAtIHJlbmRlclJlYWR5RGlhbG9nRm9yQWxsVmlzaWJsZVZpZXdlcnMoKSAoaWYgdGhlIGRpYWxvZyBjYW4gYmUgb3BlbikKICogdG8gcHJldmVudCBzdGFsZSBIVUQvcm9zdGVyIHN0YXRlIChlLmcuLCBhZnRlciBzd2FwIHRlYW1zIG9yIGxlYXZpbmcgYmFzZSBmb3JjZXMgTk9UIFJFQURZKS4KICovCmZ1bmN0aW9uIHVwZGF0ZVBsYXllcnNSZWFkeUh1ZFRleHRGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgLy8gQ29tcHV0ZSBjb3VudHMgb25jZSwgdGhlbiBicm9hZGNhc3QgdGhlIHNhbWUgbGFiZWwgdG8gYWxsIHZpZXdlcnMuCiAgICBjb25zdCBhY3RpdmUgPSBnZXRBY3RpdmVQbGF5ZXJzKCk7CiAgICBjb25zdCB0b3RhbCA9IGFjdGl2ZS5hbGwubGVuZ3RoOwoKICAgIGxldCByZWFkeUNvdW50ID0gMDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG90YWw7IGkrKykgewogICAgICAgIGNvbnN0IHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChhY3RpdmUuYWxsW2ldKTsKICAgICAgICBpZiAocGlkID09PSB1bmRlZmluZWQpIGNvbnRpbnVlOwogICAgICAgIGlmIChTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSkgcmVhZHlDb3VudCsrOwogICAgfQoKICAgIGNvbnN0IHNob3VsZFNob3cgPSAhU3RhdGUubWF0Y2guaXNFbmRlZCAmJiAhU3RhdGUubWF0Y2gudmljdG9yeURpYWxvZ0FjdGl2ZTsKCiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IGNhY2hlID0gZW5zdXJlQ2xvY2tVSUFuZEdldENhY2hlKHApOwogICAgICAgIGlmICghY2FjaGUgfHwgIWNhY2hlLnBsYXllcnNSZWFkeVRleHQpIGNvbnRpbnVlOwoKICAgICAgICAvLyBUb2dnbGUgdmlzaWJpbGl0eSBmaXJzdCBzbyB3ZSBjYW4gYXZvaWQgdW5uZWNlc3NhcnkgbGFiZWwgY2h1cm4gd2hlbiBoaWRkZW4uCiAgICAgICAgc2FmZVNldFVJV2lkZ2V0VmlzaWJsZShjYWNoZS5wbGF5ZXJzUmVhZHlUZXh0LCBzaG91bGRTaG93KTsKICAgICAgICBpZiAoIXNob3VsZFNob3cpIGNvbnRpbnVlOwoKICAgICAgICBsZXQgbGFiZWw6IG1vZC5NZXNzYWdlOwogICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSB7CiAgICAgICAgICAgIGNvbnN0IHByZXNldCA9IE1BVENIVVBfUFJFU0VUU1tTdGF0ZS5yb3VuZC5tYXRjaHVwUHJlc2V0SW5kZXhdOwogICAgICAgICAgICBsYWJlbCA9IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5tYXRjaHVwRm9ybWF0LCBwcmVzZXQubGVmdFBsYXllcnMsIHByZXNldC5yaWdodFBsYXllcnMpOwogICAgICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwoY2FjaGUucGxheWVyc1JlYWR5VGV4dCwgbGFiZWwpOwogICAgICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3IoY2FjaGUucGxheWVyc1JlYWR5VGV4dCwgQ09MT1JfTk9STUFMKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsYWJlbCA9IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQucGxheWVyc1JlYWR5Rm9ybWF0LCByZWFkeUNvdW50LCB0b3RhbCk7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbChjYWNoZS5wbGF5ZXJzUmVhZHlUZXh0LCBsYWJlbCk7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRDb2xvcihjYWNoZS5wbGF5ZXJzUmVhZHlUZXh0LCBDT0xPUl9XQVJOSU5HX1lFTExPVyk7CiAgICAgICAgfQogICAgfQp9CgovLyBMaWdodHdlaWdodCBoZWxwZXIgZm9yIHJlYWR5LXVwIGJyb2FkY2FzdHMgKGF2b2lkcyByZWNvbXB1dGluZyBjb3VudHMgaW4gVUkgaGFuZGxlcnMpLgpmdW5jdGlvbiBnZXRSZWFkeUNvdW50c0Zvck1lc3NhZ2UoKTogeyByZWFkeUNvdW50OiBudW1iZXI7IHRvdGFsQ291bnQ6IG51bWJlciB9IHsKICAgIGNvbnN0IGFjdGl2ZSA9IGdldEFjdGl2ZVBsYXllcnMoKTsKICAgIGNvbnN0IHRvdGFsQ291bnQgPSBhY3RpdmUuYWxsLmxlbmd0aDsKICAgIGxldCByZWFkeUNvdW50ID0gMDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG90YWxDb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKGFjdGl2ZS5hbGxbaV0pOwogICAgICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCkgY29udGludWU7CiAgICAgICAgaWYgKFN0YXRlLnBsYXllcnMucmVhZHlCeVBpZFtwaWRdKSByZWFkeUNvdW50Kys7CiAgICB9CiAgICByZXR1cm4geyByZWFkeUNvdW50LCB0b3RhbENvdW50IH07Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBIVUQgUmVhZHkgQ291bnQgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBWaWN0b3J5IERpYWxvZyBVcGRhdGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBnZXRFbGFwc2VkSG1zUGFydHModG90YWxTZWNvbmRzOiBudW1iZXIpOiB7IGhvdXJzOiBudW1iZXI7IG1pbnV0ZXM6IG51bWJlcjsgc2Vjb25kczogbnVtYmVyIH0gewogICAgY29uc3Qgc2VjID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcih0b3RhbFNlY29uZHMpKTsKICAgIGNvbnN0IGhvdXJzID0gTWF0aC5mbG9vcihzZWMgLyAzNjAwKTsKICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKChzZWMgJSAzNjAwKSAvIDYwKTsKICAgIGNvbnN0IHNlY29uZHMgPSBzZWMgJSA2MDsKICAgIHJldHVybiB7IGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzIH07Cn0KCmZ1bmN0aW9uIHNldFZpY3RvcnlXaW5uZXJDcm93bkZvclJlZnMocmVmczogSHVkUmVmcyB8IHVuZGVmaW5lZCk6IHZvaWQgewogICAgaWYgKCFyZWZzKSByZXR1cm47CiAgICBjb25zdCB3aW5uZXIgPSBnZXRUcmVuZGluZ1dpbm5lclRlYW0oKTsKICAgIGNvbnN0IHNob3dMZWZ0ID0gd2lubmVyID09PSBUZWFtSUQuVGVhbTE7CiAgICBjb25zdCBzaG93UmlnaHQgPSB3aW5uZXIgPT09IFRlYW1JRC5UZWFtMjsKICAgIHNhZmVTZXRVSVdpZGdldFZpc2libGUocmVmcy52aWN0b3J5TGVmdENyb3duLCBzaG93TGVmdCk7CiAgICBzYWZlU2V0VUlXaWRnZXRWaXNpYmxlKHJlZnMudmljdG9yeVJpZ2h0Q3Jvd24sIHNob3dSaWdodCk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZVZpY3RvcnlEaWFsb2dSb3N0ZXJTaXppbmcocmVmczogSHVkUmVmcywgcm9zdGVyUm93czogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCBjbGFtcGVkUm93cyA9IE1hdGgubWF4KDEsIE1hdGgubWluKFRFQU1fUk9TVEVSX01BWF9ST1dTLCBNYXRoLmZsb29yKHJvc3RlclJvd3MpKSk7CiAgICBjb25zdCByb3N0ZXJIZWlnaHQgPSBWSUNUT1JZX0RJQUxPR19ST1NURVJfUk9XX1BBRERJTkdfVE9QICsgKGNsYW1wZWRSb3dzICogVklDVE9SWV9ESUFMT0dfUk9TVEVSX1JPV19IRUlHSFQpICsgVklDVE9SWV9ESUFMT0dfUk9TVEVSX1JPV19QQURESU5HX0JPVFRPTTsKICAgIGNvbnN0IGRpYWxvZ0hlaWdodCA9IFZJQ1RPUllfRElBTE9HX1JPU1RFUl9ST1dfWSArIHJvc3RlckhlaWdodCArIFZJQ1RPUllfRElBTE9HX0JPVFRPTV9QQURESU5HOwoKICAgIGlmIChyZWZzLnZpY3RvcnlSb290KSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0U2l6ZShyZWZzLnZpY3RvcnlSb290LCBtb2QuQ3JlYXRlVmVjdG9yKFZJQ1RPUllfRElBTE9HX1dJRFRILCBkaWFsb2dIZWlnaHQsIDApKTsKICAgIH0KICAgIGlmIChyZWZzLnZpY3RvcnlSb3N0ZXJSb3cpIHsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRTaXplKHJlZnMudmljdG9yeVJvc3RlclJvdywgbW9kLkNyZWF0ZVZlY3RvcihWSUNUT1JZX0RJQUxPR19ST1NURVJfUk9XX1dJRFRILCByb3N0ZXJIZWlnaHQsIDApKTsKICAgIH0KICAgIGlmIChyZWZzLnZpY3RvcnlSb3N0ZXJMZWZ0Q29udGFpbmVyKSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0U2l6ZShyZWZzLnZpY3RvcnlSb3N0ZXJMZWZ0Q29udGFpbmVyLCBtb2QuQ3JlYXRlVmVjdG9yKFZJQ1RPUllfRElBTE9HX1JPU1RFUl9DT05UQUlORVJfV0lEVEgsIHJvc3RlckhlaWdodCwgMCkpOwogICAgfQogICAgaWYgKHJlZnMudmljdG9yeVJvc3RlclJpZ2h0Q29udGFpbmVyKSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0U2l6ZShyZWZzLnZpY3RvcnlSb3N0ZXJSaWdodENvbnRhaW5lciwgbW9kLkNyZWF0ZVZlY3RvcihWSUNUT1JZX0RJQUxPR19ST1NURVJfQ09OVEFJTkVSX1dJRFRILCByb3N0ZXJIZWlnaHQsIDApKTsKICAgIH0KfQoKZnVuY3Rpb24gY29tcHV0ZVRlYW1PdXRjb21lS2V5KHRlYW1OdW06IFRlYW1JRCk6IG51bWJlciB7CiAgICBpZiAoU3RhdGUubWF0Y2gud2lubmVyVGVhbSA9PT0gdW5kZWZpbmVkIHx8IFN0YXRlLm1hdGNoLndpbm5lclRlYW0gPT09IDApIHsKICAgICAgICByZXR1cm4gbW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkuZHJhd3M7CiAgICB9CiAgICByZXR1cm4gU3RhdGUubWF0Y2gud2lubmVyVGVhbSA9PT0gdGVhbU51bSA/IG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LndpbnMgOiBtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS5sb3NlczsKfQoKLyoqCiAqIFVwZGF0ZXMgcGVyLXBsYXllciBWaWN0b3J5IGRpYWxvZyB3aWRnZXRzIHRvIHJlZmxlY3QgY3VycmVudCBtYXRjaC1lbmQgc3RhdGUuCiAqIE5vdGVzOgogKiAtIFRoaXMgb25seSB1cGRhdGVzIFVJIHRleHQvdmlzaWJpbGl0eTsgaXQgZG9lcyBub3QgZGVjaWRlIHdpbm5lcnMuCiAqIC0gQ2FsbGVyIG11c3QgZW5zdXJlIHRoZSBkaWFsb2cgaXMgYnVpbHQgYmVmb3JlIHVwZGF0aW5nLgogKiAtIFJlbWFpbmluZyBzZWNvbmRzIGNhbiB3cmFwIGF0IDAgKGVuZ2luZSBxdWlyayk7IHdlIGNsYW1wIHRvIDAgdG8gYXZvaWQgaHVnZSB2YWx1ZXMuCiAqLwpmdW5jdGlvbiB1cGRhdGVWaWN0b3J5RGlhbG9nRm9yUGxheWVyKHBsYXllcjogbW9kLlBsYXllciwgcmVtYWluaW5nU2Vjb25kczogbnVtYmVyKTogdm9pZCB7CiAgICAvLyBQZXItcGxheWVyIHVwZGF0ZSBmb3IgdGhlIG1hdGNoLWVuZCB2aWN0b3J5IG1vZGFsOiB3aW5uZXIgbGFiZWwsIHNjb3JlcywgYW5kIHJlc3RhcnQvcm90YXRlIGNvdW50ZG93bi4KICAgIC8vIFRoaXMgaXMgY2FsbGVkIG9uY2UgcGVyIHNlY29uZCB3aGlsZSB0aGUgdmljdG9yeSBkaWFsb2cgaXMgYWN0aXZlLgogICAgLy8gRGV0ZXJtaW5lIHRoZSB0YXJnZXQgcGxheWVyIGlkOyBkaWFsb2cgd2lkZ2V0cyBhcmUga2V5ZWQgcGVyLXBsYXllci4KICAgIGlmICghcGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXIpKSByZXR1cm47CiAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocGxheWVyKTsKICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCB8fCBpc1BpZERpc2Nvbm5lY3RlZChwaWQpKSByZXR1cm47CiAgICAvLyBMb29rIHVwIGNhY2hlZCBVSSByZWZlcmVuY2VzIGZvciB0aGlzIHBsYXllciAoaWYgbWlzc2luZywgdGhpcyB1cGRhdGUgYmVjb21lcyBhIG5vLW9wKS4KICAgIGNvbnN0IHJlZnMgPSBTdGF0ZS5odWRDYWNoZS5odWRCeVBpZFtwaWRdOwogICAgaWYgKCFyZWZzKSByZXR1cm47CgogICAgaWYgKHJlZnMudmljdG9yeVJvb3QpIHsKICAgICAgICAvLyBBcHBseSB2aXNpYmlsaXR5IHJ1bGVzIGZvciB0aGUgZGlhbG9nIHBhcnRzIGJhc2VkIG9uIG1hdGNoLWVuZCBzdGF0ZS4KICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHJlZnMudmljdG9yeVJvb3QsIFN0YXRlLm1hdGNoLnZpY3RvcnlEaWFsb2dBY3RpdmUpOwogICAgfQoKICAgIGlmICghU3RhdGUubWF0Y2gudmljdG9yeURpYWxvZ0FjdGl2ZSkgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChyZWZzLnZpY3RvcnlSZXN0YXJ0VGV4dCkgewogICAgICAgIC8vIFVwZGF0ZSBzdHJpbmcta2V5IGxhYmVscyAoU3RyaW5ncy5qc29uKSBzbyB0aGUgZGlhbG9nIHJlZmxlY3RzIHRoZSBsYXRlc3Qgb3V0Y29tZS9jb3VudGRvd24uCiAgICAgICAgLy8gUmVtYWluaW5nIHNlY29uZHMgY2FuIHdyYXAvcm9sbCBvdmVyIG9uIHNvbWUgZW5naW5lIHRpbWVycyBhdCB0aGUgbW9tZW50IGl0IGhpdHMgMC4KICAgICAgICAvLyBUcmVhdCBhbnkgb3V0LW9mLXJhbmdlIHZhbHVlIGFzIDAgdG8gYXZvaWQgZGlzcGxheWluZyBhIGh1Z2UgbnVtYmVyIGF0IHRoZSBlbmQuCiAgICAgICAgbGV0IGRpc3BsYXlTZWNvbmRzID0gTWF0aC5mbG9vcihyZW1haW5pbmdTZWNvbmRzKTsKICAgICAgICBpZiAoZGlzcGxheVNlY29uZHMgPCAwKSBkaXNwbGF5U2Vjb25kcyA9IDA7CiAgICAgICAgaWYgKGRpc3BsYXlTZWNvbmRzID4gTUFUQ0hfRU5EX0RFTEFZX1NFQ09ORFMpIGRpc3BsYXlTZWNvbmRzID0gMDsKICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5UmVzdGFydFRleHQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJlc3RhcnRJbkZvcm1hdCwgZGlzcGxheVNlY29uZHMpKTsKICAgIH0KICAgIGNvbnN0IHBhcnRzID0gZ2V0RWxhcHNlZEhtc1BhcnRzKFN0YXRlLm1hdGNoLmVuZEVsYXBzZWRTZWNvbmRzU25hcHNob3QpOwogICAgY29uc3QgaG91cnMgPSBNYXRoLm1pbig5OSwgTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihwYXJ0cy5ob3VycykpKTsKICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLm1pbig1OSwgTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihwYXJ0cy5taW51dGVzKSkpOwogICAgY29uc3Qgc2Vjb25kcyA9IE1hdGgubWluKDU5LCBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHBhcnRzLnNlY29uZHMpKSk7CgogICAgY29uc3QgaFQgPSBNYXRoLmZsb29yKGhvdXJzIC8gMTApOwogICAgY29uc3QgaE8gPSBob3VycyAlIDEwOwogICAgY29uc3QgbVQgPSBNYXRoLmZsb29yKG1pbnV0ZXMgLyAxMCk7CiAgICBjb25zdCBtTyA9IG1pbnV0ZXMgJSAxMDsKICAgIGNvbnN0IHNUID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gMTApOwogICAgY29uc3Qgc08gPSBzZWNvbmRzICUgMTA7CgogICAgaWYgKHJlZnMudmljdG9yeVRpbWVIb3Vyc1RlbnMpIHNhZmVTZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlUaW1lSG91cnNUZW5zLCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCBoVCkpOwogICAgaWYgKHJlZnMudmljdG9yeVRpbWVIb3Vyc09uZXMpIHNhZmVTZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlUaW1lSG91cnNPbmVzLCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCBoTykpOwogICAgaWYgKHJlZnMudmljdG9yeVRpbWVNaW51dGVzVGVucykgc2FmZVNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeVRpbWVNaW51dGVzVGVucywgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5kaWdpdCwgbVQpKTsKICAgIGlmIChyZWZzLnZpY3RvcnlUaW1lTWludXRlc09uZXMpIHNhZmVTZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlUaW1lTWludXRlc09uZXMsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suZGlnaXQsIG1PKSk7CiAgICBpZiAocmVmcy52aWN0b3J5VGltZVNlY29uZHNUZW5zKSBzYWZlU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5VGltZVNlY29uZHNUZW5zLCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCBzVCkpOwogICAgaWYgKHJlZnMudmljdG9yeVRpbWVTZWNvbmRzT25lcykgc2FmZVNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeVRpbWVTZWNvbmRzT25lcywgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5kaWdpdCwgc08pKTsKCiAgICBpZiAocmVmcy52aWN0b3J5Um91bmRzU3VtbWFyeVRleHQpIHsKICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5Um91bmRzU3VtbWFyeVRleHQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kc1N1bW1hcnlGb3JtYXQsIE1hdGguZmxvb3IoU3RhdGUucm91bmQuY3VycmVudCksIE1hdGguZmxvb3IoU3RhdGUucm91bmQubWF4KSkpOwogICAgfQogICAgaWYgKHJlZnMudmljdG9yeUFkbWluQWN0aW9uc1RleHQpIHsKICAgICAgICBjb25zdCBhY3Rpb25Db3VudCA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IoU3RhdGUuYWRtaW4uYWN0aW9uQ291bnQpKTsKICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHJlZnMudmljdG9yeUFkbWluQWN0aW9uc1RleHQsIGFjdGlvbkNvdW50ID4gMCk7CiAgICAgICAgaWYgKGFjdGlvbkNvdW50ID4gMCkgewogICAgICAgICAgICBjb25zdCBvdmVycmlkZVVzZWQgPSBTdGF0ZS5hZG1pbi50aWVCcmVha2VyT3ZlcnJpZGVVc2VkOyAvLyBIaWdobGlnaHQgaWYgYW55IG92ZXJyaWRlIHdhcyB1c2VkIHRoaXMgbWF0Y2guCiAgICAgICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAgICAgIHJlZnMudmljdG9yeUFkbWluQWN0aW9uc1RleHQsCiAgICAgICAgICAgICAgICBtb2QuTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICBvdmVycmlkZVVzZWQKICAgICAgICAgICAgICAgICAgICAgICAgPyBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25Db3VudFZpY3RvcnlGb3JtYXRSYW5kb21PdmVycmlkZQogICAgICAgICAgICAgICAgICAgICAgICA6IG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbkNvdW50VmljdG9yeUZvcm1hdCwKICAgICAgICAgICAgICAgICAgICBhY3Rpb25Db3VudAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApOwogICAgICAgICAgICBzYWZlU2V0VUlUZXh0Q29sb3IocmVmcy52aWN0b3J5QWRtaW5BY3Rpb25zVGV4dCwgb3ZlcnJpZGVVc2VkID8gQ09MT1JfUkVEIDogQ09MT1JfV0FSTklOR19ZRUxMT1cpOwogICAgICAgIH0KICAgIH0KCiAgICBjb25zdCB0MU91dGNvbWVLZXkgPSBjb21wdXRlVGVhbU91dGNvbWVLZXkoVGVhbUlELlRlYW0xKTsKICAgIGNvbnN0IHQyT3V0Y29tZUtleSA9IGNvbXB1dGVUZWFtT3V0Y29tZUtleShUZWFtSUQuVGVhbTIpOwoKICAgIGlmIChyZWZzLnZpY3RvcnlMZWZ0T3V0Y29tZVRleHQpIHsKICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5TGVmdE91dGNvbWVUZXh0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS50ZWFtT3V0Y29tZUZvcm1hdCwgZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0xKSwgdDFPdXRjb21lS2V5KSk7CiAgICB9CiAgICBpZiAocmVmcy52aWN0b3J5UmlnaHRPdXRjb21lVGV4dCkgewogICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlSaWdodE91dGNvbWVUZXh0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS50ZWFtT3V0Y29tZUZvcm1hdCwgZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0yKSwgdDJPdXRjb21lS2V5KSk7CiAgICB9CiAgICBzZXRWaWN0b3J5V2lubmVyQ3Jvd25Gb3JSZWZzKHJlZnMpOwoKICAgIGlmIChyZWZzLnZpY3RvcnlMZWZ0UmVjb3JkVGV4dCkgewogICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlMZWZ0UmVjb3JkVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFJlY29yZEZvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5tYXRjaC53aW5zVDEpLCBNYXRoLmZsb29yKFN0YXRlLm1hdGNoLndpbnNUMiksIE1hdGguZmxvb3IoU3RhdGUubWF0Y2gudGllc1QxKSkpOwogICAgfQogICAgaWYgKHJlZnMudmljdG9yeVJpZ2h0UmVjb3JkVGV4dCkgewogICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlSaWdodFJlY29yZFRleHQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQucm91bmRSZWNvcmRGb3JtYXQsIE1hdGguZmxvb3IoU3RhdGUubWF0Y2gud2luc1QyKSwgTWF0aC5mbG9vcihTdGF0ZS5tYXRjaC53aW5zVDEpLCBNYXRoLmZsb29yKFN0YXRlLm1hdGNoLnRpZXNUMikpKTsKICAgIH0KCiAgICBpZiAocmVmcy52aWN0b3J5TGVmdFJvdW5kV2luc1RleHQpIHsKICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5TGVmdFJvdW5kV2luc1RleHQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kV2luc0Zvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5tYXRjaC53aW5zVDEpKSk7CiAgICB9CiAgICBpZiAocmVmcy52aWN0b3J5UmlnaHRSb3VuZFdpbnNUZXh0KSB7CiAgICAgICAgc2FmZVNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeVJpZ2h0Um91bmRXaW5zVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkucm91bmRXaW5zRm9ybWF0LCBNYXRoLmZsb29yKFN0YXRlLm1hdGNoLndpbnNUMikpKTsKICAgIH0KCiAgICBjb25zdCBsb3NzZXNUMSA9IFN0YXRlLm1hdGNoLmxvc3Nlc1QxOwogICAgY29uc3QgbG9zc2VzVDIgPSBTdGF0ZS5tYXRjaC5sb3NzZXNUMjsKCiAgICBpZiAocmVmcy52aWN0b3J5TGVmdFJvdW5kTG9zc2VzVGV4dCkgewogICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlMZWZ0Um91bmRMb3NzZXNUZXh0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS5yb3VuZExvc3Nlc0Zvcm1hdCwgTWF0aC5mbG9vcihsb3NzZXNUMSkpKTsKICAgIH0KICAgIGlmIChyZWZzLnZpY3RvcnlSaWdodFJvdW5kTG9zc2VzVGV4dCkgewogICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlSaWdodFJvdW5kTG9zc2VzVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkucm91bmRMb3NzZXNGb3JtYXQsIE1hdGguZmxvb3IobG9zc2VzVDIpKSk7CiAgICB9CiAgICBpZiAocmVmcy52aWN0b3J5TGVmdFJvdW5kVGllc1RleHQpIHsKICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5TGVmdFJvdW5kVGllc1RleHQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kVGllc0Zvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5tYXRjaC50aWVzVDEpKSk7CiAgICB9CiAgICBpZiAocmVmcy52aWN0b3J5UmlnaHRSb3VuZFRpZXNUZXh0KSB7CiAgICAgICAgc2FmZVNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeVJpZ2h0Um91bmRUaWVzVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkucm91bmRUaWVzRm9ybWF0LCBNYXRoLmZsb29yKFN0YXRlLm1hdGNoLnRpZXNUMikpKTsKICAgIH0KCiAgICBpZiAocmVmcy52aWN0b3J5TGVmdFRvdGFsS2lsbHNUZXh0KSB7CiAgICAgICAgc2FmZVNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeUxlZnRUb3RhbEtpbGxzVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudG90YWxLaWxsc0Zvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5zY29yZXMudDFUb3RhbEtpbGxzKSkpOwogICAgfQogICAgaWYgKHJlZnMudmljdG9yeVJpZ2h0VG90YWxLaWxsc1RleHQpIHsKICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5UmlnaHRUb3RhbEtpbGxzVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudG90YWxLaWxsc0Zvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5zY29yZXMudDJUb3RhbEtpbGxzKSkpOwogICAgfQoKICAgIGlmIChyZWZzLnZpY3RvcnlMZWZ0Um9zdGVyVGV4dCB8fCByZWZzLnZpY3RvcnlSaWdodFJvc3RlclRleHQpIHsKICAgICAgICBjb25zdCByb3N0ZXIgPSBnZXRSb3N0ZXJEaXNwbGF5RW50cmllcygpOwogICAgICAgIHVwZGF0ZVZpY3RvcnlEaWFsb2dSb3N0ZXJTaXppbmcocmVmcywgcm9zdGVyLm1heFJvd3MpOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgVEVBTV9ST1NURVJfTUFYX1JPV1M7IGkrKykgewogICAgICAgICAgICBjb25zdCBsZWZ0V2lkZ2V0ID0gcmVmcy52aWN0b3J5TGVmdFJvc3RlclRleHQ/LltpXTsKICAgICAgICAgICAgaWYgKGxlZnRXaWRnZXQpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGxlZnRFbnRyeSA9IHJvc3Rlci50ZWFtMVtpXTsKICAgICAgICAgICAgICAgIHNldFdpZGdldFZpc2libGUobGVmdFdpZGdldCwgISFsZWZ0RW50cnkpOwogICAgICAgICAgICAgICAgaWYgKGxlZnRFbnRyeSkgewogICAgICAgICAgICAgICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbChsZWZ0V2lkZ2V0LCBnZXRSb3N0ZXJFbnRyeU5hbWVNZXNzYWdlKGxlZnRFbnRyeSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCByaWdodFdpZGdldCA9IHJlZnMudmljdG9yeVJpZ2h0Um9zdGVyVGV4dD8uW2ldOwogICAgICAgICAgICBpZiAocmlnaHRXaWRnZXQpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJpZ2h0RW50cnkgPSByb3N0ZXIudGVhbTJbaV07CiAgICAgICAgICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHJpZ2h0V2lkZ2V0LCAhIXJpZ2h0RW50cnkpOwogICAgICAgICAgICAgICAgaWYgKHJpZ2h0RW50cnkpIHsKICAgICAgICAgICAgICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwocmlnaHRXaWRnZXQsIGdldFJvc3RlckVudHJ5TmFtZU1lc3NhZ2UocmlnaHRFbnRyeSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiB1cGRhdGVWaWN0b3J5RGlhbG9nRm9yQWxsUGxheWVycyhyZW1haW5pbmdTZWNvbmRzOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHApOwogICAgICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCB8fCBpc1BpZERpc2Nvbm5lY3RlZChwaWQpKSBjb250aW51ZTsKICAgICAgICB1cGRhdGVWaWN0b3J5RGlhbG9nRm9yUGxheWVyKHAsIHJlbWFpbmluZ1NlY29uZHMpOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIFZpY3RvcnkgRGlhbG9nIFVwZGF0ZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBSb3VuZC1FbmQgRGlhbG9nIFVwZGF0ZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIHNldFJvdW5kV2luQ3Jvd25Gb3JSZWZzKHJlZnM6IEh1ZFJlZnMgfCB1bmRlZmluZWQsIHdpbm5lclRlYW1OdW06IFRlYW1JRCB8IDAsIHZpc2libGU6IGJvb2xlYW4pOiB2b2lkIHsKICAgIGlmICghcmVmcykgcmV0dXJuOwogICAgY29uc3Qgc2hvd0xlZnQgPSB2aXNpYmxlICYmIHdpbm5lclRlYW1OdW0gPT09IFRlYW1JRC5UZWFtMTsKICAgIGNvbnN0IHNob3dSaWdodCA9IHZpc2libGUgJiYgd2lubmVyVGVhbU51bSA9PT0gVGVhbUlELlRlYW0yOwogICAgc2FmZVNldFVJV2lkZ2V0VmlzaWJsZShyZWZzLmxlZnRSb3VuZEtpbGxzQ3Jvd24sIHNob3dMZWZ0KTsKICAgIHNhZmVTZXRVSVdpZGdldFZpc2libGUocmVmcy5yaWdodFJvdW5kS2lsbHNDcm93biwgc2hvd1JpZ2h0KTsKfQoKZnVuY3Rpb24gc2V0Um91bmRXaW5Dcm93bkZvckFsbFBsYXllcnMod2lubmVyVGVhbU51bTogVGVhbUlEIHwgMCwgdmlzaWJsZTogYm9vbGVhbik6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocCk7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHJlZnMgPSBTdGF0ZS5odWRDYWNoZS5odWRCeVBpZFtwaWRdOwogICAgICAgIGlmICghcmVmcykgY29udGludWU7CiAgICAgICAgc2V0Um91bmRXaW5Dcm93bkZvclJlZnMocmVmcywgd2lubmVyVGVhbU51bSwgdmlzaWJsZSk7CiAgICB9Cn0KCmZ1bmN0aW9uIHNldFJvdW5kRW5kRGlhbG9nVmlzaWJsZUZvckFsbFBsYXllcnModmlzaWJsZTogYm9vbGVhbik6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgU3RhdGUucm91bmQuZmxvdy5yb3VuZEVuZERpYWxvZ1Zpc2libGUgPSB2aXNpYmxlOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocCk7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHJlZnMgPSBTdGF0ZS5odWRDYWNoZS5odWRCeVBpZFtwaWRdOwogICAgICAgIGlmICghcmVmcykgY29udGludWU7CiAgICAgICAgaWYgKHJlZnMucm91bmRFbmRSb290KSB7CiAgICAgICAgICAgIHNldFdpZGdldFZpc2libGUocmVmcy5yb3VuZEVuZFJvb3QsIHZpc2libGUpOwogICAgICAgIH0KICAgIH0KICAgIHNldFJvdW5kV2luQ3Jvd25Gb3JBbGxQbGF5ZXJzKFN0YXRlLnJvdW5kLmxhc3RXaW5uZXJUZWFtLCB2aXNpYmxlKTsKICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvckFsbFBsYXllcnMoKTsKfQoKLy8gUm91bmQtZW5kIFVJIGxvY2tkb3duOiBhdm9pZCB0b3VjaGluZyBvdmVydGltZSBIVUQgd2lkZ2V0cyBkdXJpbmcgdGVhcmRvd24gdHJhbnNpdGlvbnMuCmZ1bmN0aW9uIGlzUm91bmRFbmRVaUxvY2tkb3duQWN0aXZlKCk6IGJvb2xlYW4gewogICAgcmV0dXJuIFN0YXRlLnJvdW5kLmZsb3cucm91bmRFbmRVaUxvY2tkb3duCiAgICAgICAgfHwgU3RhdGUucm91bmQuZmxvdy5yb3VuZEVuZERpYWxvZ1Zpc2libGUKICAgICAgICB8fCBTdGF0ZS5yb3VuZC5mbG93LmNsZWFudXBBY3RpdmU7Cn0KCmZ1bmN0aW9uIGlzUm91bmRFbmREZXRhaWxEcmF3UmVhc29uKHJlYXNvbjogUm91bmRFbmREZXRhaWxSZWFzb24pOiBib29sZWFuIHsKICAgIHJldHVybiByZWFzb24gPT09IFJvdW5kRW5kRGV0YWlsUmVhc29uLlRpbWVPdmVyRHJhd0V2ZW5FbGltcwogICAgICAgIHx8IHJlYXNvbiA9PT0gUm91bmRFbmREZXRhaWxSZWFzb24uVGltZU92ZXJEcmF3Tm9BY3Rpb247Cn0KCmZ1bmN0aW9uIGdldFJvdW5kRW5kRGV0YWlsRm9yVmlld2VyKAogICAgdmlld2VyVGVhbU51bTogVGVhbUlEIHwgMCwKICAgIHdpbm5lclRlYW1OdW06IFRlYW1JRCB8IDAKKTogeyBrZXk6IG51bWJlcjsgY29sb3I6IG1vZC5WZWN0b3I7IHZhbHVlPzogbnVtYmVyIH0gfCB1bmRlZmluZWQgewogICAgY29uc3QgcmVhc29uID0gU3RhdGUucm91bmQubGFzdEVuZERldGFpbFJlYXNvbjsKICAgIGlmIChyZWFzb24gPT09IFJvdW5kRW5kRGV0YWlsUmVhc29uLk5vbmUpIHJldHVybiB1bmRlZmluZWQ7CgogICAgaWYgKGlzUm91bmRFbmREZXRhaWxEcmF3UmVhc29uKHJlYXNvbikgfHwgd2lubmVyVGVhbU51bSA9PT0gMCkgewogICAgICAgIGNvbnN0IGRyYXdLZXkgPSByZWFzb24gPT09IFJvdW5kRW5kRGV0YWlsUmVhc29uLlRpbWVPdmVyRHJhd05vQWN0aW9uCiAgICAgICAgICAgID8gU1RSX1JPVU5EX0VORF9ERVRBSUxfRFJBV19OT19BQ1RJT04KICAgICAgICAgICAgOiBTVFJfUk9VTkRfRU5EX0RFVEFJTF9EUkFXX0VWRU5fRUxJTVM7CiAgICAgICAgcmV0dXJuIHsga2V5OiBkcmF3S2V5LCBjb2xvcjogQ09MT1JfV0hJVEUgfTsKICAgIH0KCiAgICBjb25zdCBpc1ZpZXdlcldpbm5lciA9IHZpZXdlclRlYW1OdW0gIT09IDAgJiYgdmlld2VyVGVhbU51bSA9PT0gd2lubmVyVGVhbU51bTsKICAgIGxldCBrZXk6IG51bWJlcjsKICAgIGxldCB2YWx1ZTogbnVtYmVyIHwgdW5kZWZpbmVkOwogICAgc3dpdGNoIChyZWFzb24pIHsKICAgICAgICBjYXNlIFJvdW5kRW5kRGV0YWlsUmVhc29uLkVsaW1pbmF0aW9uOgogICAgICAgICAgICBrZXkgPSBpc1ZpZXdlcldpbm5lciA/IFNUUl9ST1VORF9FTkRfREVUQUlMX1dJTl9FTElNSU5BVElPTiA6IFNUUl9ST1VORF9FTkRfREVUQUlMX0xPU0VfRUxJTUlOQVRJT047CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgUm91bmRFbmREZXRhaWxSZWFzb24uT2JqZWN0aXZlQ2FwdHVyZWQ6CiAgICAgICAgICAgIGtleSA9IGlzVmlld2VyV2lubmVyID8gU1RSX1JPVU5EX0VORF9ERVRBSUxfV0lOX09CSkVDVElWRV9DQVBUVVJFRCA6IFNUUl9ST1VORF9FTkRfREVUQUlMX0xPU0VfT0JKRUNUSVZFX0NBUFRVUkVEOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFJvdW5kRW5kRGV0YWlsUmVhc29uLlRpbWVPdmVyT2JqZWN0aXZlUHJvZ3Jlc3M6CiAgICAgICAgICAgIGtleSA9IGlzVmlld2VyV2lubmVyID8gU1RSX1JPVU5EX0VORF9ERVRBSUxfV0lOX09CSkVDVElWRV9QUk9HUkVTUyA6IFNUUl9ST1VORF9FTkRfREVUQUlMX0xPU0VfT0JKRUNUSVZFX1BST0dSRVNTOwogICAgICAgICAgICBjb25zdCBwZXJjZW50cyA9IGdldE92ZXJ0aW1lRGlzcGxheVBlcmNlbnRzKFN0YXRlLnJvdW5kLmxhc3RPYmplY3RpdmVQcm9ncmVzcyk7CiAgICAgICAgICAgIHZhbHVlID0gd2lubmVyVGVhbU51bSA9PT0gVGVhbUlELlRlYW0xCiAgICAgICAgICAgICAgICA/IHBlcmNlbnRzLmxlZnQKICAgICAgICAgICAgICAgIDogKHdpbm5lclRlYW1OdW0gPT09IFRlYW1JRC5UZWFtMiA/IHBlcmNlbnRzLnJpZ2h0IDogNTApOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFJvdW5kRW5kRGV0YWlsUmVhc29uLlRpbWVPdmVyS2lsbHM6CiAgICAgICAgICAgIGtleSA9IGlzVmlld2VyV2lubmVyID8gU1RSX1JPVU5EX0VORF9ERVRBSUxfV0lOX1RJTUVfT1ZFUl9LSUxMUyA6IFNUUl9ST1VORF9FTkRfREVUQUlMX0xPU0VfVElNRV9PVkVSX0tJTExTOwogICAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIGNvbnN0IHRlYW1Db2xvciA9IHdpbm5lclRlYW1OdW0gPT09IFRlYW1JRC5UZWFtMQogICAgICAgID8gQ09MT1JfQkxVRQogICAgICAgIDogKHdpbm5lclRlYW1OdW0gPT09IFRlYW1JRC5UZWFtMiA/IENPTE9SX1JFRCA6IENPTE9SX1dISVRFKTsKICAgIHJldHVybiB7IGtleSwgY29sb3I6IHRlYW1Db2xvciwgdmFsdWUgfTsKfQoKZnVuY3Rpb24gdXBkYXRlUm91bmRFbmREaWFsb2dGb3JBbGxQbGF5ZXJzKHdpbm5lclRlYW1OdW06IFRlYW1JRCB8IDApOiB2b2lkIHsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHApOwogICAgICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCB8fCBpc1BpZERpc2Nvbm5lY3RlZChwaWQpKSBjb250aW51ZTsKICAgICAgICB1cGRhdGVSb3VuZEVuZERpYWxvZ0ZvclBsYXllcihwLCB3aW5uZXJUZWFtTnVtKTsKICAgIH0KfQoKZnVuY3Rpb24gdXBkYXRlUm91bmRFbmREaWFsb2dGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyLCB3aW5uZXJUZWFtTnVtOiBUZWFtSUQgfCAwKTogdm9pZCB7CiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuOwogICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICBpZiAocGlkID09PSB1bmRlZmluZWQgfHwgaXNQaWREaXNjb25uZWN0ZWQocGlkKSkgcmV0dXJuOwogICAgY29uc3QgcmVmcyA9IFN0YXRlLmh1ZENhY2hlLmh1ZEJ5UGlkW3BpZF07CiAgICBpZiAoIXJlZnMpIHJldHVybjsKCiAgICAvLyBFbnN1cmUgbGFiZWxzIGFyZSBhbHdheXMgYXV0aG9yaXRhdGl2ZSBhdCB0aGUgdGltZSB0aGUgZGlhbG9nIGlzIHNob3duLgogICAgaWYgKHJlZnMucm91bmRFbmRSb3VuZFRleHQpIHsKICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwoCiAgICAgICAgICAgIHJlZnMucm91bmRFbmRSb3VuZFRleHQsCiAgICAgICAgICAgIC8vIFJvdW5kRW5kX1JvdW5kTnVtYmVyIGlzIGEgZGVkaWNhdGVkIGZvcm1hdCBrZXkgKCJST1VORCB7MH0iKSB0byBhdm9pZCBwYXNzaW5nIGFuIGVtcHR5IHN0cmluZyBpbnRvIFJvdW5kU3RhdGVfRm9ybWF0LAogICAgICAgICAgICAvLyB3aGljaCBQb3J0YWwgcmVuZGVycyBhcyA8dW5rbm93biBzdHJpbmc+IHdoZW4gdGhlIGtleSBjYW5ub3QgYmUgcmVzb2x2ZWQuCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yb3VuZEVuZC5yb3VuZE51bWJlciwgU3RhdGUucm91bmQuY3VycmVudCkKICAgICAgICApOwogICAgfQoKICAgIGlmIChyZWZzLnJvdW5kRW5kT3V0Y29tZVRleHQpIHsKICAgICAgICBpZiAod2lubmVyVGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSB7CiAgICAgICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAgICAgIHJlZnMucm91bmRFbmRPdXRjb21lVGV4dCwKICAgICAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnRlYW1PdXRjb21lRm9ybWF0LCBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTEpLCBtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS53aW5zKQogICAgICAgICAgICApOwogICAgICAgIH0gZWxzZSBpZiAod2lubmVyVGVhbU51bSA9PT0gVGVhbUlELlRlYW0yKSB7CiAgICAgICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAgICAgIHJlZnMucm91bmRFbmRPdXRjb21lVGV4dCwKICAgICAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnRlYW1PdXRjb21lRm9ybWF0LCBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTIpLCBtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS53aW5zKQogICAgICAgICAgICApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNldFdpZGdldFRleHQocmVmcy5yb3VuZEVuZE91dGNvbWVUZXh0LCBtb2Quc3RyaW5na2V5cy50d2wucm91bmRFbmQuZHJhdyk7CiAgICAgICAgfQogICAgfQoKICAgIGlmIChyZWZzLnJvdW5kRW5kRGV0YWlsVGV4dCkgewogICAgICAgIGNvbnN0IHZpZXdlclRlYW1OdW0gPSBnZXRUZWFtTnVtYmVyKG1vZC5HZXRUZWFtKHBsYXllcikpOwogICAgICAgIGNvbnN0IGRldGFpbCA9IGdldFJvdW5kRW5kRGV0YWlsRm9yVmlld2VyKHZpZXdlclRlYW1OdW0sIHdpbm5lclRlYW1OdW0pOwogICAgICAgIGlmIChkZXRhaWwpIHsKICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBkZXRhaWwudmFsdWUgIT09IHVuZGVmaW5lZAogICAgICAgICAgICAgICAgPyBtb2QuTWVzc2FnZShkZXRhaWwua2V5LCBkZXRhaWwudmFsdWUpCiAgICAgICAgICAgICAgICA6IG1vZC5NZXNzYWdlKGRldGFpbC5rZXkpOwogICAgICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwocmVmcy5yb3VuZEVuZERldGFpbFRleHQsIGxhYmVsKTsKICAgICAgICAgICAgc2FmZVNldFVJVGV4dENvbG9yKHJlZnMucm91bmRFbmREZXRhaWxUZXh0LCBkZXRhaWwuY29sb3IpOwogICAgICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHJlZnMucm91bmRFbmREZXRhaWxUZXh0LCB0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHJlZnMucm91bmRFbmREZXRhaWxUZXh0LCBmYWxzZSk7CiAgICAgICAgfQogICAgfQoKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEhVRCBSb3VuZC1FbmQgRGlhbG9nIFVwZGF0ZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgLSBEaWFsb2cgT3BlbiArIEhlbHAgVGV4dCBWaXNpYmlsaXR5IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBpc1RlYW1Td2l0Y2hEaWFsb2dPcGVuRm9yUGlkKHBpZDogbnVtYmVyKTogYm9vbGVhbiB7CiAgICAvLyBXaXRoIFVJIGNhY2hpbmcsIHRoZSBkaWFsb2cgcm9vdCB3aWRnZXQgbWF5IGNvbnRpbnVlIHRvIGV4aXN0IHdoaWxlIGhpZGRlbi4KICAgIC8vIFVzZSB0aGUgZXhwbGljaXQgcGVyLXBsYXllciBzdGF0ZSBmbGFnIGFzIHRoZSBzb3VyY2Ugb2YgdHJ1dGggZm9yICJvcGVuIi4KICAgIHJldHVybiAhIVN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGlkXT8uZGlhbG9nVmlzaWJsZTsKfQoKLyoqCiAqIEFwcGxpZXMgdGhlIGN1cnJlbnQgJ2hlbHAgdGV4dCcgdmlzaWJpbGl0eSBydWxlcyB0byBvbmUgc3BlY2lmaWMgcGxheWVyIGlkLgogKiBUaGlzIGlzIGludGVudGlvbmFsbHkgcGlkLWJhc2VkIChub3QgUGxheWVyLWJhc2VkKSBzbyBpdCBjYW4gYmUgdXNlZCBkdXJpbmcgam9pbi9sZWF2ZSBhbmQgVUkgcmVidWlsZHMuCiAqIEtlZXAgaW4gbWluZDoKICogLSBUaGUgcGxheWVyIG1heSBub3QgYmUgcHJlc2VudCBhdCB0aGUgdGltZSBvZiB0aGUgY2FsbDsgdGhpcyBmdW5jdGlvbiBzaG91bGQgdG9sZXJhdGUgbWlzc2luZyBVSSByZWZzLgogKiAtIFZpc2liaWxpdHkgcnVsZXMgdHlwaWNhbGx5IGRlcGVuZCBvbiBwZXItcGxheWVyIGZsYWdzIChlLmcuLCAnZG9udCBzaG93IGFnYWluJykgYW5kIGN1cnJlbnQgcm91bmQgc3RhdGUuCiAqLwoKZnVuY3Rpb24gdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yUGlkKHBpZDogbnVtYmVyKTogdm9pZCB7CiAgICAvLyBGZXRjaCB0aGlzIHBsYXllcidzIEhVRC93aWRnZXQgcmVmczsgaWYgbWlzc2luZyAoZS5nLiwgZHVyaW5nIGpvaW4pLCBiYWlsIG91dCBzYWZlbHkuCiAgICBjb25zdCByZWZzID0gU3RhdGUuaHVkQ2FjaGUuaHVkQnlQaWRbcGlkXTsKICAgIGlmICghcmVmcykgcmV0dXJuOwoKICAgIGNvbnN0IGlzRGlhbG9nT3BlbiA9IGlzVGVhbVN3aXRjaERpYWxvZ09wZW5Gb3JQaWQocGlkKTsKICAgIGNvbnN0IGlzUmVhZHkgPSAhIVN0YXRlLnBsYXllcnMucmVhZHlCeVBpZFtwaWRdOwogICAgY29uc3QgaXNEZXBsb3llZCA9ICEhU3RhdGUucGxheWVycy5kZXBsb3llZEJ5UGlkW3BpZF07CiAgICBjb25zdCBjYW5TaG93ID0gKCFTdGF0ZS5tYXRjaC5pc0VuZGVkKQogICAgICAgICYmICghU3RhdGUubWF0Y2gudmljdG9yeURpYWxvZ0FjdGl2ZSkKICAgICAgICAmJiAoIVN0YXRlLnJvdW5kLmZsb3cucm91bmRFbmREaWFsb2dWaXNpYmxlKQogICAgICAgICYmICghU3RhdGUucm91bmQuZmxvdy5jbGVhbnVwQWN0aXZlKQogICAgICAgICYmIChpc0RlcGxveWVkKTsKICAgIGNvbnN0IHNob3dIZWxwID0gY2FuU2hvdyAmJiAoIWlzUm91bmRMaXZlKCkpICYmICghaXNSZWFkeSkgJiYgKCFpc0RpYWxvZ09wZW4pOwogICAgY29uc3Qgc2hvd1JlYWR5ID0gY2FuU2hvdyAmJiAoIWlzUm91bmRMaXZlKCkpICYmIChpc1JlYWR5KSAmJiAoIWlzRGlhbG9nT3Blbik7CgogICAgY29uc3QgaGVscENvbnRhaW5lciA9IHJlZnMuaGVscFRleHRDb250YWluZXIgPz8gc2FmZUZpbmQoYENvbnRhaW5lcl9IZWxwVGV4dF8ke3BpZH1gKTsKICAgIGlmIChoZWxwQ29udGFpbmVyKSB7CiAgICAgICAgLy8gQXBwbHkgdGhlIGNvbXB1dGVkIHZpc2liaWxpdHkgdG8gdGhlIGhlbHAgdGV4dCB3aWRnZXQuCiAgICAgICAgc2FmZVNldFVJV2lkZ2V0VmlzaWJsZShoZWxwQ29udGFpbmVyLCBzaG93SGVscCk7CiAgICB9CgogICAgY29uc3QgaGVscFRleHQgPSBzYWZlRmluZChgSGVscFRleHRfJHtwaWR9YCk7CiAgICBpZiAoaGVscFRleHQpIHsKICAgICAgICBjb25zdCBhdXRvUmVhZHlIZWxwQWN0aXZlID0gISFTdGF0ZS5wbGF5ZXJzLmF1dG9SZWFkeUJ5UGlkW3BpZF0gJiYgKCFpc1JlYWR5KTsKICAgICAgICBjb25zdCBoZWxwTGFiZWwgPSBhdXRvUmVhZHlIZWxwQWN0aXZlCiAgICAgICAgICAgID8gbW9kLk1lc3NhZ2UoU1RSX0hVRF9BVVRPX1JFQURZX0hFTFBfVEVYVCkKICAgICAgICAgICAgOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmhlbHBUZXh0KTsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwoaGVscFRleHQsIGhlbHBMYWJlbCk7CiAgICB9CgogICAgY29uc3QgcmVhZHlDb250YWluZXIgPSByZWZzLnJlYWR5U3RhdHVzQ29udGFpbmVyID8/IHNhZmVGaW5kKGBDb250YWluZXJfUmVhZHlTdGF0dXNfJHtwaWR9YCk7CiAgICBpZiAocmVhZHlDb250YWluZXIpIHsKICAgICAgICBzYWZlU2V0VUlXaWRnZXRWaXNpYmxlKHJlYWR5Q29udGFpbmVyLCBzaG93UmVhZHkpOwogICAgfQoKICAgIGNvbnN0IHJlYWR5VGV4dCA9IHNhZmVGaW5kKGBSZWFkeVN0YXR1c1RleHRfJHtwaWR9YCk7CiAgICBpZiAocmVhZHlUZXh0KSB7CiAgICAgICAgY29uc3Qgdmlld2VyID0gc2FmZUZpbmRQbGF5ZXIocGlkKTsKICAgICAgICBjb25zdCBpblZlaGljbGUgPSAodmlld2VyICYmIGlzRGVwbG95ZWQpCiAgICAgICAgICAgID8gc2FmZUdldFNvbGRpZXJTdGF0ZUJvb2wodmlld2VyLCBtb2QuU29sZGllclN0YXRlQm9vbC5Jc0luVmVoaWNsZSkKICAgICAgICAgICAgOiBmYWxzZTsKICAgICAgICBjb25zdCBhdXRvUmVhZHlBY3RpdmUgPSAhIVN0YXRlLnBsYXllcnMuYXV0b1JlYWR5QnlQaWRbcGlkXQogICAgICAgICAgICAmJiBpc1JlYWR5CiAgICAgICAgICAgICYmIGluVmVoaWNsZQogICAgICAgICAgICAmJiBpc1BsYXllckluTWFpbkJhc2VGb3JSZWFkeShwaWQpOwogICAgICAgIGNvbnN0IHJlYWR5TGFiZWwgPSBhdXRvUmVhZHlBY3RpdmUKICAgICAgICAgICAgPyBtb2QuTWVzc2FnZShTVFJfSFVEX0FVVE9fUkVBRFlfVEVYVCkKICAgICAgICAgICAgOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJlYWR5VGV4dCk7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHJlYWR5VGV4dCwgcmVhZHlMYWJlbCk7CiAgICB9Cn0KCmZ1bmN0aW9uIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBsYXllcihwbGF5ZXI6IG1vZC5QbGF5ZXIpOiB2b2lkIHsKICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBpZChtb2QuR2V0T2JqSWQocGxheWVyKSk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBpZChtb2QuR2V0T2JqSWQocCkpOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIERpYWxvZyBPcGVuICsgSGVscCBUZXh0IFZpc2liaWxpdHkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgRnVuY3Rpb24gU3RhcnQgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIENvZGUgQ2xlYW51cDogVGhpcyBpcyBhbiBhYnN1cmQgbWVnYS1mdW5jdGlvbiAtIHdlIHNob3VsZCByZWZhY3RvciBhbmQgYnJlYWsgZG93bgovLyBFbnN1cmVzIGFsbCBwZXJzaXN0ZW50IEhVRCB3aWRnZXRzIGV4aXN0IGZvciBhIHBsYXllci4KLy8gVGhpcyBmdW5jdGlvbiBpcyBpZGVtcG90ZW50IGFuZCBzYWZlIHRvIGNhbGwgb24gam9pbiwgcmVzcGF3biwgb3IgcmVjb25uZWN0LgovLyBXaWRnZXQgcmVmZXJlbmNlcyBjcmVhdGVkIGhlcmUgYXJlIHJldXNlZCBhbmQgdXBkYXRlZCBlbHNld2hlcmUuCgpmdW5jdGlvbiBlbnN1cmVIdWRGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyKTogSHVkUmVmcyB8IHVuZGVmaW5lZCB7CiAgICAvLyBQZXItcGxheWVyIEhVRCBsaWZlY3ljbGU6CiAgICAvLyAtIEhVRCB3aWRnZXRzIGFyZSBjcmVhdGVkIG9uY2UgcGVyIHBsYXllciBhbmQgdGhlbiBvbmx5IHVwZGF0ZWQgKG5ldmVyIHJlY3JlYXRlZCkgZHVyaW5nIHRoZSBtYXRjaC4KICAgIC8vIC0gVGhpcyBmdW5jdGlvbiBpcyBzYWZlIHRvIGNhbGwgcmVwZWF0ZWRseSAoam9pbiwgcmVzcGF3biwgcmVjb25uZWN0LCBhZG1pbiBhY3Rpb25zKS4KICAgIC8vIC0gSWYgYSB3aWRnZXQgaXMgbWlzc2luZywgY3JlYXRlIGl0IGFuZCBzdG9yZS9maW5kIGl0IHZpYSB0aGUgVUkgcm9vdC4KCiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuIHVuZGVmaW5lZDsKCiAgICBjb25zdCBwaWQgPSBnZXRPYmpJZChwbGF5ZXIpOwoKICAgIC8vIElmIGNhY2hlZCBhbmQgc3RpbGwgdmFsaWQsIHJldHVybiBpdAogICAgY29uc3QgY2FjaGVkID0gU3RhdGUuaHVkQ2FjaGUuaHVkQnlQaWRbcGlkXTsKICAgIGlmIChjYWNoZWQgJiYgY2FjaGVkLmxlZnRLaWxsc1RleHQgJiYgY2FjaGVkLnJpZ2h0S2lsbHNUZXh0KSB7CiAgICAgICAgY2FjaGVkLnNwYXduRGlzYWJsZWRMaXZlVGV4dCA9IGVuc3VyZVNwYXduRGlzYWJsZWRMaXZlVGV4dChwbGF5ZXIpOwogICAgICAgIGNvbnN0IGhlbHBDb250YWluZXIgPSBzYWZlRmluZChgQ29udGFpbmVyX0hlbHBUZXh0XyR7cGlkfWApOwogICAgICAgIGlmIChoZWxwQ29udGFpbmVyKSB7CiAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFBvc2l0aW9uKGhlbHBDb250YWluZXIsIG1vZC5DcmVhdGVWZWN0b3IoLTE2NS41LCA3NS4yNSwgMCkpOyAvLy0xMTYuNSwgNzUuMjUsIDAKICAgICAgICB9CiAgICAgICAgY29uc3QgcmVhZHlDb250YWluZXIgPSBzYWZlRmluZChgQ29udGFpbmVyX1JlYWR5U3RhdHVzXyR7cGlkfWApOwogICAgICAgIGlmIChyZWFkeUNvbnRhaW5lcikgewogICAgICAgICAgICBtb2QuU2V0VUlXaWRnZXRQb3NpdGlvbihyZWFkeUNvbnRhaW5lciwgbW9kLkNyZWF0ZVZlY3RvcigtMTY1LjUsIDc1LjI1LCAwKSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGFkbWluQWN0aW9uQ291bnRlciA9IHNhZmVGaW5kKGBBZG1pblBhbmVsQWN0aW9uQ291bnRfJHtwaWR9YCk7CiAgICAgICAgaWYgKGFkbWluQWN0aW9uQ291bnRlcikgewogICAgICAgICAgICBtb2QuU2V0VUlXaWRnZXRQb3NpdGlvbihhZG1pbkFjdGlvbkNvdW50ZXIsIG1vZC5DcmVhdGVWZWN0b3IoMjAsIDIyLCAwKSk7CiAgICAgICAgfQogICAgICAgIGVuc3VyZVRvcEh1ZFJvb3RGb3JQaWQocGlkLCBwbGF5ZXIpOwogICAgICAgIHNldEh1ZEhlbHBEZXB0aEZvclBpZChwaWQpOwogICAgICAgIHVwZGF0ZVNldHRpbmdzU3VtbWFyeUh1ZEZvclBpZChwaWQpOwoKICAgICAgICByZXR1cm4gY2FjaGVkOwogICAgfQoKICAgIGNvbnN0IHJlZnM6IEh1ZFJlZnMgPSB7IHBpZCwgcm9vdHM6IFtdIH07CgogICAgLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgRnVuY3Rpb24gU3RhcnQgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKICAgIC8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBIVUQgQnVpbGQvRW5zdXJlIC0gVXBwZXItTGVmdCBIVUQgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAvLyAtLS0gU3RhdGljIEhVRDogVXBwZXItbGVmdCBzbWFsbCBib3ggLS0tCiAgICB7CiAgICAgICAgY29uc3Qgcm9vdE5hbWUgPSBgVXBwZXJfTGVmdF9Db250YWluZXJfJHtwaWR9YDsKICAgICAgICBjb25zdCB1cHBlckxlZnQgPSBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgICAgIG5hbWU6IHJvb3ROYW1lLAogICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgcG9zaXRpb246IFs1LCA1ICsgVE9QX0hVRF9PRkZTRVRfWV0sCiAgICAgICAgICAgIHNpemU6IFsyMDAsIDMwXSwKICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgcGFkZGluZzogMSwKICAgICAgICAgICAgYmdDb2xvcjogWzAuMjUxLCAwLjA5NDEsIDAuMDY2N10sCiAgICAgICAgICAgIGJnQWxwaGE6IDAuNTYyNSwKICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBVcHBlcl9MZWZ0X1RleHRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFVwcGVyX0xlZnRfVGV4dF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbNSwgLTUuNV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzIwMCwgMTddLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlckxlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFswLjgzNTMsIDAuOTIxNiwgMC45NzY1XSwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLkJsdXIsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2Quc3RyaW5na2V5cy50d2wuaHVkLmJyYW5kaW5nLnRpdGxlLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzAuNjc4NCwgMC45OTIyLCAwLjUyNTVdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogOSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBVcHBlcl9MZWZ0X1RleHRfMl8ke3BpZH0KICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVXBwZXJfTGVmdF9UZXh0XzJfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzcuMjUsIDEyLjVdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFsyMDAsIDE2LjVdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFswLjIsIDAuMiwgMC4yXSwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2Quc3RyaW5na2V5cy50d2wuaHVkLmJyYW5kaW5nLnN1YnRpdGxlLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzAuNjc4NCwgMC45OTIyLCAwLjUyNTVdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogOSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXSwKICAgICAgICB9KTsKICAgICAgICBpZiAodXBwZXJMZWZ0KSByZWZzLnJvb3RzLnB1c2godXBwZXJMZWZ0KTsKICAgIH0KCiAgICAvLyAtLS0gU3RhdGljIEhVRDogVXBwZXItbGVmdCBzZXR0aW5ncyBzdW1tYXJ5IChiZWxvdyBicmFuZGluZykgLS0tCiAgICB7CiAgICAgICAgY29uc3QgU0VUVElOR1NfQ09OVEFJTkVSX1ggPSA1OwogICAgICAgIGNvbnN0IFNFVFRJTkdTX0NPTlRBSU5FUl9ZID0gNSArIFRPUF9IVURfT0ZGU0VUX1kgKyAzMCArIDY7CiAgICAgICAgY29uc3QgU0VUVElOR1NfTElORV9IRUlHSFQgPSAxMjsKICAgICAgICBjb25zdCBTRVRUSU5HU19URVhUX1dJRFRIID0gMjAwOwogICAgICAgIGNvbnN0IFNFVFRJTkdTX1RFWFRfU0laRSA9IDk7CiAgICAgICAgY29uc3QgU0VUVElOR1NfVEVYVF9DT0xPUjogW251bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWzAuNjc4NCwgMC45OTIyLCAwLjUyNTVdOwoKICAgICAgICBjb25zdCBzZXR0aW5nc1N1bW1hcnkgPSBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgICAgIG5hbWU6IGBVcHBlcl9MZWZ0X1NldHRpbmdzXyR7cGlkfWAsCiAgICAgICAgICAgIHR5cGU6ICJDb250YWluZXIiLAogICAgICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgICAgICBwb3NpdGlvbjogW1NFVFRJTkdTX0NPTlRBSU5FUl9YLCBTRVRUSU5HU19DT05UQUlORVJfWV0sCiAgICAgICAgICAgIHNpemU6IFtTRVRUSU5HU19URVhUX1dJRFRILCBTRVRUSU5HU19MSU5FX0hFSUdIVCAqIDZdLAogICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICBwYWRkaW5nOiAxLAogICAgICAgICAgICBiZ0NvbG9yOiBbMC4yNTEsIDAuMDk0MSwgMC4wNjY3XSwKICAgICAgICAgICAgYmdBbHBoYTogMC41NjI1LAogICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5CbHVyLAogICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBTZXR0aW5nc19HYW1lTW9kZV8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzYsIDBdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFtTRVRUSU5HU19URVhUX1dJRFRIIC0gMTIsIDE2XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShTVFJfSFVEX1NFVFRJTkdTX0dBTUVfTU9ERV9GT1JNQVQsIFNUUl9IVURfU0VUVElOR1NfR0FNRV9NT0RFX0RFRkFVTFQpLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogU0VUVElOR1NfVEVYVF9DT0xPUiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IFNFVFRJTkdTX1RFWFRfU0laRSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFNldHRpbmdzX0NlaWxpbmdfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFs2LCBTRVRUSU5HU19MSU5FX0hFSUdIVF0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW1NFVFRJTkdTX1RFWFRfV0lEVEggLSAxMiwgMTZdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKFNUUl9IVURfU0VUVElOR1NfQUlSQ1JBRlRfQ0VJTElOR19GT1JNQVQsIFNUUl9SRUFEWV9ESUFMT0dfQUlSQ1JBRlRfQ0VJTElOR19WQU5JTExBKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFNFVFRJTkdTX1RFWFRfQ09MT1IsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiBTRVRUSU5HU19URVhUX1NJWkUsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBTZXR0aW5nc19WZWhpY2xlc1QxXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbNiwgU0VUVElOR1NfTElORV9IRUlHSFQgKiAyXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbU0VUVElOR1NfVEVYVF9XSURUSCAtIDEyLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgICAgIFNUUl9IVURfU0VUVElOR1NfVkVISUNMRVNfVEVBTV9GT1JNQVQsCiAgICAgICAgICAgICAgICAgICAgICAgIGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMSksCiAgICAgICAgICAgICAgICAgICAgICAgIFNUUl9IVURfU0VUVElOR1NfVkFMVUVfREVGQVVMVAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBTRVRUSU5HU19URVhUX0NPTE9SLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogU0VUVElOR1NfVEVYVF9TSVpFLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgU2V0dGluZ3NfVmVoaWNsZXNUMl8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzYsIFNFVFRJTkdTX0xJTkVfSEVJR0hUICogM10sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW1NFVFRJTkdTX1RFWFRfV0lEVEggLSAxMiwgMTZdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKAogICAgICAgICAgICAgICAgICAgICAgICBTVFJfSFVEX1NFVFRJTkdTX1ZFSElDTEVTX1RFQU1fRk9STUFULAogICAgICAgICAgICAgICAgICAgICAgICBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTIpLAogICAgICAgICAgICAgICAgICAgICAgICBTVFJfSFVEX1NFVFRJTkdTX1ZBTFVFX0RFRkFVTFQKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogU0VUVElOR1NfVEVYVF9DT0xPUiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IFNFVFRJTkdTX1RFWFRfU0laRSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFNldHRpbmdzX1ZlaGljbGVzTWF0Y2h1cF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzYsIFNFVFRJTkdTX0xJTkVfSEVJR0hUICogNF0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW1NFVFRJTkdTX1RFWFRfV0lEVEggLSAxMiwgMTZdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKFNUUl9IVURfU0VUVElOR1NfVkVISUNMRVNfTUFUQ0hVUF9GT1JNQVQsIDEsIDEpLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogU0VUVElOR1NfVEVYVF9DT0xPUiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IFNFVFRJTkdTX1RFWFRfU0laRSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFNldHRpbmdzX1BsYXllcnNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFs2LCBTRVRUSU5HU19MSU5FX0hFSUdIVCAqIDVdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFtTRVRUSU5HU19URVhUX1dJRFRIIC0gMTIsIDE2XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShTVFJfSFVEX1NFVFRJTkdTX1BMQVlFUlNfRk9STUFULCAxLCAxKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFNFVFRJTkdTX1RFWFRfQ09MT1IsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiBTRVRUSU5HU19URVhUX1NJWkUsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgIH0pOwogICAgICAgIGlmIChzZXR0aW5nc1N1bW1hcnkpIHJlZnMucm9vdHMucHVzaChzZXR0aW5nc1N1bW1hcnkpOwogICAgfQoKICAgIC8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBIVUQgQnVpbGQvRW5zdXJlIC0gVXBwZXItTGVmdCBIVUQgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKICAgIC8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBIVUQgQnVpbGQvRW5zdXJlIC0gVG9wLUNlbnRlciBQYW5lbHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAvLyAtLS0gU3RhdGljIEhVRDogVG9wLWNlbnRlciBwYW5lbHMgKFRlYW1MZWZ0IC8gTWlkZGxlIC8gVGVhbVJpZ2h0KSAtLS0KICAgIHsKICAgICAgICBjb25zdCBUT1BfUEFORUxfWSA9IDQ0Ljc1ICsgVE9QX0hVRF9PRkZTRVRfWTsKICAgICAgICBjb25zdCBQQU5FTF9XSURUSCA9IDExNC41OwogICAgICAgIGNvbnN0IFBBTkVMX0hFSUdIVCA9IDc0OwogICAgICAgIGNvbnN0IE1JRF9QQU5FTF9YID0gOTAyLjc1OwogICAgICAgIGNvbnN0IExFRlRfUEFORUxfWCA9IDc4My44NjsKICAgICAgICBjb25zdCBSSUdIVF9QQU5FTF9YID0gMTAyMS42NDsKICAgICAgICBjb25zdCBQQU5FTF9HQVAgPSBNSURfUEFORUxfWCAtIExFRlRfUEFORUxfWCAtIFBBTkVMX1dJRFRIOwogICAgICAgIGNvbnN0IFJPVU5EX0tJTExTX1BBTkVMX1NJWkUgPSBQQU5FTF9IRUlHSFQ7CiAgICAgICAgY29uc3QgUk9VTkRfS0lMTFNfTEVGVF9YID0gTEVGVF9QQU5FTF9YIC0gUk9VTkRfS0lMTFNfUEFORUxfU0laRSAtIFBBTkVMX0dBUDsKICAgICAgICBjb25zdCBST1VORF9LSUxMU19SSUdIVF9YID0gUklHSFRfUEFORUxfWCArIFBBTkVMX1dJRFRIICsgUEFORUxfR0FQOwogICAgICAgIGNvbnN0IFRSRU5ESU5HX0NST1dOX1NJWkUgPSAxODsKICAgICAgICBjb25zdCBUUkVORElOR19DUk9XTl9PRkZTRVRfWSA9IDQ7CiAgICAgICAgY29uc3QgVFJFTkRJTkdfQ1JPV05fTEVGVF9YID0gUEFORUxfV0lEVEggLSBUUkVORElOR19DUk9XTl9TSVpFIC0gMTA7CiAgICAgICAgY29uc3QgVFJFTkRJTkdfQ1JPV05fUklHSFRfWCA9IDEwOwogICAgICAgIGNvbnN0IG1pZCA9IG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogQ29udGFpbmVyX1RvcE1pZGRsZV9Db3JlVUlfJHtwaWR9CiAgICAgICAgICAgIG5hbWU6IGBDb250YWluZXJfVG9wTWlkZGxlX0NvcmVVSV8ke3BpZH1gLAogICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgcG9zaXRpb246IFtNSURfUEFORUxfWCwgVE9QX1BBTkVMX1ldLAogICAgICAgICAgICBzaXplOiBbUEFORUxfV0lEVEgsIFBBTkVMX0hFSUdIVF0sCiAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQ29sb3I6IFswLjAzMTQsIDAuMDQzMSwgMC4wNDMxXSwKICAgICAgICAgICAgYmdBbHBoYTogMC43NSwKICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBSb3VuZFRleHRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFJvdW5kVGV4dF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMC41LCAtNF0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzcyLjUsIDI0XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFRleHQsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxNiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBIZWxwL2luc3RydWN0aW9ucyB0ZXh0IHNob3duIHdoZW4gZW5hYmxlZCBmb3IgdGhpcyBwbGF5ZXIKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgQ29udGFpbmVyX0hlbHBUZXh0XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWy0xNjUuNSwgOTJdLCAvL1stMTE2LjUsIDkyXQogICAgICAgICAgICAgICAgICAgIHNpemU6IFs0NTAsIDIwXSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMSwgMC45ODgyLCAwLjYxMThdLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGVscC9pbnN0cnVjdGlvbnMgdGV4dCBzaG93biB3aGVuIGVuYWJsZWQgZm9yIHRoaXMgcGxheWVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgSGVscFRleHRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzQ1MCwgMTRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogWzAuMiwgMC4yLCAwLjJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuaGVscFRleHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFswLjI1MSwgMC4wOTQxLCAwLjA2NjddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBSZWFkeSBzdGF0dXMgdGV4dCBzaG93biB3aGVuIHRoZSBwbGF5ZXIgaXMgUkVBRFkgYW5kIHRoZSByb3VuZCBpcyBub3QgbGl2ZQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBDb250YWluZXJfUmVhZHlTdGF0dXNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbLTE2NS41LCA5Ml0sIC8vWy0xMTYuNSwgOTJdCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzQ1MCwgMjBdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZHkgc3RhdHVzIHRleHQgc2hvd24gd2hlbiBlbmFibGVkIGZvciB0aGlzIHBsYXllcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFJlYWR5U3RhdHVzVGV4dF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbNDUwLCAxNF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yZWFkeVRleHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFswLjY3ODQsIDAuOTkyMiwgMC41MjU1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogU2xhc2hfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFNsYXNoXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFs3MS41ICsgUk9VTkRfU0xBU0hfT0ZGU0VUX1gsIC0yXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbMzEsIDIxXSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5zbGFzaCwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDE2LAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgIH0pOwogICAgICAgIGlmIChtaWQpIHJlZnMucm9vdHMucHVzaChtaWQpOwoKICAgICAgICBjb25zdCB0MVBhbmVsID0gbW9kbGliLlBhcnNlVUkoewogICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBDb250YWluZXJfVG9wTGVmdF9Db3JlVUlfJHtwaWR9CiAgICAgICAgICAgIG5hbWU6IGBDb250YWluZXJfVG9wTGVmdF9Db3JlVUlfJHtwaWR9YCwKICAgICAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXIsCiAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgIHBvc2l0aW9uOiBbTEVGVF9QQU5FTF9YLCBUT1BfUEFORUxfWV0sCiAgICAgICAgICAgIHNpemU6IFtQQU5FTF9XSURUSCwgUEFORUxfSEVJR0hUXSwKICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgYmdDb2xvcjogWzAuNDM5MiwgMC45MjE2LCAxXSwKICAgICAgICAgICAgYmdBbHBoYTogMC43NSwKICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBUcmVuZGluZyB3aW5uZXIgY3Jvd24gKHNvbGlkKSBmb3IgVGVhbSAxCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1MZWZ0X1RyZW5kaW5nX0Nyb3duXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIkltYWdlIiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbVFJFTkRJTkdfQ1JPV05fTEVGVF9YLCBUUkVORElOR19DUk9XTl9PRkZTRVRfWV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW1RSRU5ESU5HX0NST1dOX1NJWkUsIFRSRU5ESU5HX0NST1dOX1NJWkVdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VUeXBlOiBtb2QuVUlJbWFnZVR5cGUuQ3Jvd25Tb2xpZCwKICAgICAgICAgICAgICAgICAgICBpbWFnZUNvbG9yOiBbMSwgMjUyIC8gMjU1LCAxNTYgLyAyNTVdLAogICAgICAgICAgICAgICAgICAgIGltYWdlQWxwaGE6IDEsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFRlYW0gbmFtZSBsYWJlbCBmb3IgVGVhbSAxIChsZWZ0IHNpZGUpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1MZWZ0X05hbWVfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzIzLjI1LCAwXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbNjgsIDI4XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0xKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDE4LAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFRlYW1MZWZ0X1JlY29yZF8ke3BpZH0KICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVGVhbUxlZnRfUmVjb3JkXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFsyLjI1LCAyMl0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzExMCwgMjBdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFswLjIsIDAuMiwgMC4yXSwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kUmVjb3JkRm9ybWF0LCAwLCAwLCAwKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDE4LAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIERpc3BsYXkgdmFyaWFibGUgZm9yIHJvdW5kIHdpbnMgb24gVGVhbSAxIChsZWZ0IHNpZGUpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1MZWZ0X1dpbnNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzMxLCA0NV0sIC8vMjYuNSwgNDQKICAgICAgICAgICAgICAgICAgICBzaXplOiBbNzIsIDE2XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMucm91bmRXaW5zLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gRGlzcGxheSB2YXJpYWJsZSBmb3IgdG90YWwga2lsbHMgb24gVGVhbSAxIChsZWZ0IHNpZGUpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1MZWZ0X0tpbGxzXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFsyNi41LCA1OV0sIC8vMjYuNSwgNTgKICAgICAgICAgICAgICAgICAgICBzaXplOiBbNzIsIDE2XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMudG90YWxLaWxscywKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgIH0pOwogICAgICAgIGlmICh0MVBhbmVsKSByZWZzLnJvb3RzLnB1c2godDFQYW5lbCk7CgogICAgICAgIGNvbnN0IHQxUm91bmRLaWxsc1BhbmVsID0gbW9kbGliLlBhcnNlVUkoewogICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBDb250YWluZXJfVG9wTGVmdF9Sb3VuZEtpbGxzXyR7cGlkfQogICAgICAgICAgICBuYW1lOiBgQ29udGFpbmVyX1RvcExlZnRfUm91bmRLaWxsc18ke3BpZH1gLAogICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgcG9zaXRpb246IFtST1VORF9LSUxMU19MRUZUX1gsIFRPUF9QQU5FTF9ZXSwKICAgICAgICAgICAgc2l6ZTogW1JPVU5EX0tJTExTX1BBTkVMX1NJWkUsIFJPVU5EX0tJTExTX1BBTkVMX1NJWkVdLAogICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICBiZ0NvbG9yOiBbMC40MzkyLCAwLjkyMTYsIDFdLAogICAgICAgICAgICBiZ0FscGhhOiAwLjc1LAogICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5CbHVyLAogICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIENyb3duIGluZGljYXRvciBzaG93biBmb3Igcm91bmQgd2lubmVyIChUZWFtIDEpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1MZWZ0X1JvdW5kS2lsbHNfQ3Jvd25fJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiSW1hZ2UiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCAtMzVdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFs0NSwgNDVdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICBpbWFnZVR5cGU6IG1vZC5VSUltYWdlVHlwZS5Dcm93bk91dGxpbmUsCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIGltYWdlQWxwaGE6IDEsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIEJpZyByb3VuZC1raWxscyBjb3VudGVyIGZvciBUZWFtIDEKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVGVhbUxlZnRfUm91bmRLaWxsc19Db3VudGVyVGV4dF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMF0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW1JPVU5EX0tJTExTX1BBTkVMX1NJWkUsIDYwXSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCAwKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IENPTE9SX0JMVUUsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiA2MCwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBSb3VuZCBraWxscyBsYWJlbCAoYm90dG9tIG9mIHRoZSBwYW5lbCkKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVGVhbUxlZnRfUm91bmRLaWxsc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgNTNdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFtST1VORF9LSUxMU19QQU5FTF9TSVpFLCAxOF0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMucm91bmRLaWxsc1dpdGhSb3VuZEZvcm1hdCwgZ2V0Um91bmRLaWxsc0xhYmVsUm91bmQoKSksCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBSZWdpc3RlcmVkIHZlaGljbGVzIGFsaXZlIChsaXZlIHJvdW5kIG9ubHkpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1MZWZ0X1JvdW5kS2lsbHNfVmVoaWNsZXNBbGl2ZV8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgNzZdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFtST1VORF9LSUxMU19QQU5FTF9TSVpFLCAxMl0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQudmVoaWNsZXNBbGl2ZUZvcm1hdCwgMCksCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMCwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXSwKICAgICAgICB9KTsKICAgICAgICBpZiAodDFSb3VuZEtpbGxzUGFuZWwpIHJlZnMucm9vdHMucHVzaCh0MVJvdW5kS2lsbHNQYW5lbCk7CgogICAgICAgIGNvbnN0IHQyUGFuZWwgPSBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IENvbnRhaW5lcl9Ub3BSaWdodF9Db3JlVUlfJHtwaWR9CiAgICAgICAgICAgIG5hbWU6IGBDb250YWluZXJfVG9wUmlnaHRfQ29yZVVJXyR7cGlkfWAsCiAgICAgICAgICAgIHR5cGU6ICJDb250YWluZXIiLAogICAgICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICBwb3NpdGlvbjogW1JJR0hUX1BBTkVMX1gsIFRPUF9QQU5FTF9ZXSwKICAgICAgICAgICAgc2l6ZTogW1BBTkVMX1dJRFRILCBQQU5FTF9IRUlHSFRdLAogICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICBiZ0NvbG9yOiBbMSwgMC41MTM3LCAwLjM4MDRdLAogICAgICAgICAgICBiZ0FscGhhOiAwLjc1LAogICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5CbHVyLAogICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFRyZW5kaW5nIHdpbm5lciBjcm93biAoc29saWQpIGZvciBUZWFtIDIKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVGVhbVJpZ2h0X1RyZW5kaW5nX0Nyb3duXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIkltYWdlIiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbVFJFTkRJTkdfQ1JPV05fUklHSFRfWCwgVFJFTkRJTkdfQ1JPV05fT0ZGU0VUX1ldLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFtUUkVORElOR19DUk9XTl9TSVpFLCBUUkVORElOR19DUk9XTl9TSVpFXSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIGltYWdlVHlwZTogbW9kLlVJSW1hZ2VUeXBlLkNyb3duU29saWQsCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VDb2xvcjogWzEsIDI1MiAvIDI1NSwgMTU2IC8gMjU1XSwKICAgICAgICAgICAgICAgICAgICBpbWFnZUFscGhhOiAxLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBUZWFtIG5hbWUgbGFiZWwgZm9yIFRlYW0gMiAocmlnaHQgc2lkZSkKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVGVhbVJpZ2h0X05hbWVfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzIzLjI1LCAwXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbNjgsIDI4XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0yKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDE4LAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFRlYW1SaWdodF9SZWNvcmRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1SaWdodF9SZWNvcmRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzIuMjUsIDIyXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTEwLCAyMF0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogWzAuMiwgMC4yLCAwLjJdLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQucm91bmRSZWNvcmRGb3JtYXQsIDAsIDAsIDApLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTgsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gRGlzcGxheSB2YXJpYWJsZSBmb3Igcm91bmQgd2lucyBvbiBUZWFtIDIgKHJpZ2h0IHNpZGUpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1SaWdodF9XaW5zXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFszMSwgNDVdLCAvLzI2LjUsIDQ0CiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzcyLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogWzAuMiwgMC4yLCAwLjJdLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQubGFiZWxzLnJvdW5kV2lucywKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIERpc3BsYXkgdmFyaWFibGUgZm9yIHRvdGFsIGtpbGxzIG9uIFRlYW0gMiAocmlnaHQgc2lkZSkKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVGVhbVJpZ2h0X0tpbGxzXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFsyNi41LCA1OV0sIC8vNTgKICAgICAgICAgICAgICAgICAgICBzaXplOiBbNzIsIDE2XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMudG90YWxLaWxscywKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgIH0pOwoKICAgICAgICBjb25zdCB0MlJvdW5kS2lsbHNQYW5lbCA9IG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogQ29udGFpbmVyX1RvcFJpZ2h0X1JvdW5kS2lsbHNfJHtwaWR9CiAgICAgICAgICAgIG5hbWU6IGBDb250YWluZXJfVG9wUmlnaHRfUm91bmRLaWxsc18ke3BpZH1gLAogICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgcG9zaXRpb246IFtST1VORF9LSUxMU19SSUdIVF9YLCBUT1BfUEFORUxfWV0sCiAgICAgICAgICAgIHNpemU6IFtST1VORF9LSUxMU19QQU5FTF9TSVpFLCBST1VORF9LSUxMU19QQU5FTF9TSVpFXSwKICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgYmdDb2xvcjogWzEsIDAuNTEzNywgMC4zODA0XSwKICAgICAgICAgICAgYmdBbHBoYTogMC43NSwKICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBDcm93biBpbmRpY2F0b3Igc2hvd24gZm9yIHJvdW5kIHdpbm5lciAoVGVhbSAyKQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBUZWFtUmlnaHRfUm91bmRLaWxsc19Dcm93bl8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJJbWFnZSIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIC0zNV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzQ1LCA0NV0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIGltYWdlVHlwZTogbW9kLlVJSW1hZ2VUeXBlLkNyb3duT3V0bGluZSwKICAgICAgICAgICAgICAgICAgICBpbWFnZUNvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VBbHBoYTogMSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gQmlnIHJvdW5kLWtpbGxzIGNvdW50ZXIgZm9yIFRlYW0gMgogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBUZWFtUmlnaHRfUm91bmRLaWxsc19Db3VudGVyVGV4dF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMF0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW1JPVU5EX0tJTExTX1BBTkVMX1NJWkUsIDYwXSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCAwKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IENPTE9SX1JFRCwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDYwLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFJvdW5kIGtpbGxzIGxhYmVsIChib3R0b20gb2YgdGhlIHBhbmVsKQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBUZWFtUmlnaHRfUm91bmRLaWxsc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgNTNdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFtST1VORF9LSUxMU19QQU5FTF9TSVpFLCAxOF0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMucm91bmRLaWxsc1dpdGhSb3VuZEZvcm1hdCwgZ2V0Um91bmRLaWxsc0xhYmVsUm91bmQoKSksCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBSZWdpc3RlcmVkIHZlaGljbGVzIGFsaXZlIChsaXZlIHJvdW5kIG9ubHkpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1SaWdodF9Sb3VuZEtpbGxzX1ZlaGljbGVzQWxpdmVfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDc2XSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbUk9VTkRfS0lMTFNfUEFORUxfU0laRSwgMTJdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnZlaGljbGVzQWxpdmVGb3JtYXQsIDApLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTAsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF0sCiAgICAgICAgfSk7CiAgICAgICAgaWYgKHQyUm91bmRLaWxsc1BhbmVsKSByZWZzLnJvb3RzLnB1c2godDJSb3VuZEtpbGxzUGFuZWwpOwoKICAgIH0KCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIFRvcC1DZW50ZXIgUGFuZWxzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCiAgICAvLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIEFkbWluIEFjdGlvbiBDb3VudGVyIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgewogICAgICAgIC8vIEFkbWluIGFjdGlvbiBhdWRpdCBjb3VudGVyICh0b3AtcmlnaHQpCiAgICAgICAgY29uc3QgYXVkaXRDb3VudGVyID0gbW9kbGliLlBhcnNlVUkoewogICAgICAgICAgICBuYW1lOiBgQWRtaW5QYW5lbEFjdGlvbkNvdW50XyR7cGlkfWAsCiAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGluY3JlYXNlIFggdG8gbW92ZSByaWdodCwgaW5jcmVhc2UgWSB0byBtb3ZlIGRvd24KICAgICAgICAgICAgcG9zaXRpb246IFsyMCwgMjJdLAogICAgICAgICAgICBzaXplOiBbNjAsIDEyXSwKICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9uQ291bnRGb3JtYXQsIDApLAogICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICB0ZXh0U2l6ZTogMTAsCiAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXJSaWdodCwKICAgICAgICB9KTsKICAgICAgICBpZiAoYXVkaXRDb3VudGVyKSByZWZzLnJvb3RzLnB1c2goYXVkaXRDb3VudGVyKTsKICAgIH0KCiAgICByZWZzLmxlZnRSZWNvcmRUZXh0ID0gc2FmZUZpbmQoYFRlYW1MZWZ0X1JlY29yZF8ke3BpZH1gKTsKICAgIHJlZnMucmlnaHRSZWNvcmRUZXh0ID0gc2FmZUZpbmQoYFRlYW1SaWdodF9SZWNvcmRfJHtwaWR9YCk7CiAgICByZWZzLmxlZnRSb3VuZEtpbGxzVGV4dCA9IHNhZmVGaW5kKGBUZWFtTGVmdF9Sb3VuZEtpbGxzX0NvdW50ZXJUZXh0XyR7cGlkfWApOwogICAgcmVmcy5yaWdodFJvdW5kS2lsbHNUZXh0ID0gc2FmZUZpbmQoYFRlYW1SaWdodF9Sb3VuZEtpbGxzX0NvdW50ZXJUZXh0XyR7cGlkfWApOwogICAgcmVmcy5sZWZ0Um91bmRLaWxsc0xhYmVsID0gc2FmZUZpbmQoYFRlYW1MZWZ0X1JvdW5kS2lsbHNfJHtwaWR9YCk7CiAgICByZWZzLnJpZ2h0Um91bmRLaWxsc0xhYmVsID0gc2FmZUZpbmQoYFRlYW1SaWdodF9Sb3VuZEtpbGxzXyR7cGlkfWApOwogICAgcmVmcy5sZWZ0VmVoaWNsZXNBbGl2ZVRleHQgPSBzYWZlRmluZChgVGVhbUxlZnRfUm91bmRLaWxsc19WZWhpY2xlc0FsaXZlXyR7cGlkfWApOwogICAgcmVmcy5yaWdodFZlaGljbGVzQWxpdmVUZXh0ID0gc2FmZUZpbmQoYFRlYW1SaWdodF9Sb3VuZEtpbGxzX1ZlaGljbGVzQWxpdmVfJHtwaWR9YCk7CiAgICByZWZzLmxlZnRSb3VuZEtpbGxzQ3Jvd24gPSBzYWZlRmluZChgVGVhbUxlZnRfUm91bmRLaWxsc19Dcm93bl8ke3BpZH1gKTsKICAgIHJlZnMucmlnaHRSb3VuZEtpbGxzQ3Jvd24gPSBzYWZlRmluZChgVGVhbVJpZ2h0X1JvdW5kS2lsbHNfQ3Jvd25fJHtwaWR9YCk7CiAgICByZWZzLmxlZnRUcmVuZGluZ1dpbm5lckNyb3duID0gc2FmZUZpbmQoYFRlYW1MZWZ0X1RyZW5kaW5nX0Nyb3duXyR7cGlkfWApOwogICAgcmVmcy5yaWdodFRyZW5kaW5nV2lubmVyQ3Jvd24gPSBzYWZlRmluZChgVGVhbVJpZ2h0X1RyZW5kaW5nX0Nyb3duXyR7cGlkfWApOwogICAgcmVmcy5hZG1pblBhbmVsQWN0aW9uQ291bnRUZXh0ID0gc2FmZUZpbmQoYEFkbWluUGFuZWxBY3Rpb25Db3VudF8ke3BpZH1gKTsKCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIEFkbWluIEFjdGlvbiBDb3VudGVyIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCiAgICAvLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIENvdW50ZXIgV2lkZ2V0cyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIC0tLSBDb3VudGVyIHdpZGdldHMgKGRpZ2l0cykgLS0tCiAgICB7CiAgICAgICAgY29uc3QgbWtDb3VudGVyID0gKAogICAgICAgICAgICBjb250YWluZXJOYW1lOiBzdHJpbmcsCiAgICAgICAgICAgIHRleHROYW1lOiBzdHJpbmcsCiAgICAgICAgICAgIHBvczogW251bWJlciwgbnVtYmVyXSwKICAgICAgICAgICAgc2l6ZTogW251bWJlciwgbnVtYmVyXSwKICAgICAgICAgICAgdGV4dFNpemU6IG51bWJlcgogICAgICAgICkgPT4gewogICAgICAgICAgICBjb25zdCByb290ID0gbW9kbGliLlBhcnNlVUkoewogICAgICAgICAgICAgICAgbmFtZTogY29udGFpbmVyTmFtZSwKICAgICAgICAgICAgICAgIHR5cGU6ICJDb250YWluZXIiLAogICAgICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBwb3MsCiAgICAgICAgICAgICAgICBzaXplOiBzaXplLAogICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgYmdDb2xvcjogWzAuMiwgMC4yLCAwLjJdLAogICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGV4dE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogW3NpemVbMF0sIHNpemVbMV1dLAogICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFswLjIsIDAuMiwgMC4yXSwKICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IHRleHRTaXplLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKHJvb3QpIHJlZnMucm9vdHMucHVzaChyb290KTsKICAgICAgICAgICAgcmV0dXJuIHNhZmVGaW5kKHRleHROYW1lKTsKICAgICAgICB9OwoKICAgICAgICByZWZzLnJvdW5kQ3VyVGV4dCA9IG1rQ291bnRlcigKICAgICAgICAgICAgYFJvdW5kQ291bnRlckNvbnRhaW5lcl8ke3BpZH1gLAogICAgICAgICAgICBgUm91bmRDb3VudGVyVGV4dF8ke3BpZH1gLAogICAgICAgICAgICBbOTcwLjkzICsgUk9VTkRfQ09VTlRFUl9PRkZTRVRfWCwgNDQuMzUgKyBUT1BfSFVEX09GRlNFVF9ZXSwKICAgICAgICAgICAgWzEzLjk1LCAxOC4xNV0sCiAgICAgICAgICAgIDE2CiAgICAgICAgKTsKICAgICAgICByZWZzLnJvdW5kTWF4VGV4dCA9IG1rQ291bnRlcigKICAgICAgICAgICAgYFJvdW5kQ291bnRlck1heENvbnRhaW5lcl8ke3BpZH1gLAogICAgICAgICAgICBgUm91bmRDb3VudGVyTWF4VGV4dF8ke3BpZH1gLAogICAgICAgICAgICBbOTkzLjAzICsgUk9VTkRfQ09VTlRFUl9PRkZTRVRfWCwgNDQuMzUgKyBUT1BfSFVEX09GRlNFVF9ZXSwKICAgICAgICAgICAgWzEzLjk1LCAxOC4xNV0sCiAgICAgICAgICAgIDE2CiAgICAgICAgKTsKCiAgICAgICAgcmVmcy5sZWZ0V2luc1RleHQgPSBta0NvdW50ZXIoCiAgICAgICAgICAgIGBUZWFtTGVmdF9XaW5zX0NvdW50ZXJfJHtwaWR9YCwKICAgICAgICAgICAgYFRlYW1MZWZ0X1dpbnNfQ291bnRlclRleHRfJHtwaWR9YCwKICAgICAgICAgICAgWzgwMy4wMywgODQuNzUgKyBUT1BfSFVEX09GRlNFVF9ZXSwKICAgICAgICAgICAgWzIwLCAyNF0sCiAgICAgICAgICAgIDE1CiAgICAgICAgKTsKICAgICAgICByZWZzLnJpZ2h0V2luc1RleHQgPSBta0NvdW50ZXIoCiAgICAgICAgICAgIGBUZWFtUmlnaHRfV2luc19Db3VudGVyXyR7cGlkfWAsCiAgICAgICAgICAgIGBUZWFtUmlnaHRfV2luc19Db3VudGVyVGV4dF8ke3BpZH1gLAogICAgICAgICAgICBbMTAzOS43NiwgODQuNzUgKyBUT1BfSFVEX09GRlNFVF9ZXSwKICAgICAgICAgICAgWzIwLCAyNF0sCiAgICAgICAgICAgIDE1CiAgICAgICAgKTsKCiAgICAgICAgcmVmcy5sZWZ0S2lsbHNUZXh0ID0gbWtDb3VudGVyKAogICAgICAgICAgICBgVGVhbUxlZnRfS2lsbHNfQ291bnRlcl8ke3BpZH1gLAogICAgICAgICAgICBgVGVhbUxlZnRfS2lsbHNfQ291bnRlclRleHRfJHtwaWR9YCwKICAgICAgICAgICAgWzgwMy4wMywgOTguNzUgKyBUT1BfSFVEX09GRlNFVF9ZXSwKICAgICAgICAgICAgWzIwLCAyNF0sCiAgICAgICAgICAgIDE1CiAgICAgICAgKTsKICAgICAgICByZWZzLnJpZ2h0S2lsbHNUZXh0ID0gbWtDb3VudGVyKAogICAgICAgICAgICBgVGVhbVJpZ2h0X0tpbGxzX0NvdW50ZXJfJHtwaWR9YCwKICAgICAgICAgICAgYFRlYW1SaWdodF9LaWxsc19Db3VudGVyVGV4dF8ke3BpZH1gLAogICAgICAgICAgICBbMTAzOS43NiwgOTguNzUgKyBUT1BfSFVEX09GRlNFVF9ZXSwKICAgICAgICAgICAgWzIwLCAyNF0sCiAgICAgICAgICAgIDE1CiAgICAgICAgKTsKICAgIH0KCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIENvdW50ZXIgV2lkZ2V0cyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgLSBSb3VuZC1FbmQgRGlhbG9nIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgewogICAgICAgIGNvbnN0IHNwYXduRGlzYWJsZWRUZXh0ID0gZW5zdXJlU3Bhd25EaXNhYmxlZExpdmVUZXh0KHBsYXllcik7CiAgICAgICAgaWYgKHNwYXduRGlzYWJsZWRUZXh0KSByZWZzLnJvb3RzLnB1c2goc3Bhd25EaXNhYmxlZFRleHQpOwogICAgfQoKICAgIC8vQ29kZSBDbGVhbnVwOiBOZWVkIHRvIHJlZHVjZSByZWR1bmRhbnQgY29tbWVudHMsIGFuZCB3aGVuIG1hbnVhbGx5IGFkanVzdGluZyBwb3NpdGlvbi9zaXplcyB1cGRhdGUgZGlyZWN0aW9ucyAoZS5nLiArWCBpcyByaWdodCBvciBsZWZ0KQogICAgewogICAgICAgIGNvbnN0IHJvdW5kRW5kTW9kYWwgPSBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFJvdW5kRW5kRGlhbG9nUm9vdF8ke3BpZH0KICAgICAgICAgICAgbmFtZTogYFJvdW5kRW5kRGlhbG9nUm9vdF8ke3BpZH1gLAogICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgcG9zaXRpb246IFswLCAxNTBdLAogICAgICAgICAgICBzaXplOiBbNTIwLCAxMTJdLAogICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICBiZ0NvbG9yOiBbVklDVE9SWV9CR19SR0JbMF0sIFZJQ1RPUllfQkdfUkdCWzFdLCBWSUNUT1JZX0JHX1JHQlsyXV0sCiAgICAgICAgICAgIGJnQWxwaGE6IDAuNzUsCiAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLlNvbGlkLAogICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFJvdW5kRW5kRGlhbG9nX1JvdW5kXyR7cGlkfQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBSb3VuZEVuZERpYWxvZ19Sb3VuZF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTZdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszNDAsIDI0XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yb3VuZEVuZC5yb3VuZE51bWJlciwgU3RhdGUucm91bmQuY3VycmVudCksCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAyMCwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBSb3VuZEVuZERpYWxvZ19PdXRjb21lXyR7cGlkfQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBSb3VuZEVuZERpYWxvZ19PdXRjb21lXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCA0Nl0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzM0MCwgMzBdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLnJvdW5kRW5kLmRyYXcsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAyNiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBSb3VuZEVuZERpYWxvZ19EZXRhaWxfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFJvdW5kRW5kRGlhbG9nX0RldGFpbF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgODZdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFs1MDAsIDE4XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5yb3VuZEVuZC5kcmF3LAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTQsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF0sCiAgICAgICAgfSk7CgogICAgICAgIHJlZnMucm91bmRFbmRSb290ID0gcm91bmRFbmRNb2RhbDsKICAgICAgICByZWZzLnJvdW5kRW5kUm91bmRUZXh0ID0gc2FmZUZpbmQoYFJvdW5kRW5kRGlhbG9nX1JvdW5kXyR7cGlkfWApOwogICAgICAgIHJlZnMucm91bmRFbmRPdXRjb21lVGV4dCA9IHNhZmVGaW5kKGBSb3VuZEVuZERpYWxvZ19PdXRjb21lXyR7cGlkfWApOwogICAgICAgIHJlZnMucm91bmRFbmREZXRhaWxUZXh0ID0gc2FmZUZpbmQoYFJvdW5kRW5kRGlhbG9nX0RldGFpbF8ke3BpZH1gKTsKICAgICAgICBpZiAocm91bmRFbmRNb2RhbCkgcmVmcy5yb290cy5wdXNoKHJvdW5kRW5kTW9kYWwpOwogICAgfQoKICAgIC8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBIVUQgQnVpbGQvRW5zdXJlIC0gUm91bmQtRW5kIERpYWxvZyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgLSBWaWN0b3J5IERpYWxvZyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIHsKICAgICAgICBjb25zdCBtb2RhbCA9IG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ1Jvb3RfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nUm9vdF8ke3BpZH1gLAogICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgcG9zaXRpb246IFswLCAxMzVdLAogICAgICAgICAgICBzaXplOiBbVklDVE9SWV9ESUFMT0dfV0lEVEgsIFZJQ1RPUllfRElBTE9HX0hFSUdIVF0sCiAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQ29sb3I6IFtWSUNUT1JZX0JHX1JHQlswXSwgVklDVE9SWV9CR19SR0JbMV0sIFZJQ1RPUllfQkdfUkdCWzJdXSwKICAgICAgICAgICAgYmdBbHBoYTogMC45NSwKICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfSGVhZGVyMV8ke3BpZH0KICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfSGVhZGVyMV8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTRdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszNDAsIDIyXSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuYnJhbmRpbmcudGl0bGUsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxOCwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX0hlYWRlcjJfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfSGVhZGVyMl8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMzZdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszNDAsIDIyXSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuYnJhbmRpbmcuc3VidGl0bGUsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxOCwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1NjcmVlbnNob3RfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfU2NyZWVuc2hvdF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgNjJdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszNDAsIDE2XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnNjcmVlbnNob3RQcm9tcHQsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMF0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1Jlc3RhcnRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfUmVzdGFydF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgODJdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszNDAsIDE2XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJlc3RhcnRJbkZvcm1hdCwgTUFUQ0hfRU5EX0RFTEFZX1NFQ09ORFMpLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19Ub3RhbFRpbWVSb3dfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVG90YWxUaW1lUm93XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDEwMl0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzM0MCwgMTZdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVG90YWxUaW1lTGFiZWxfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19Ub3RhbFRpbWVMYWJlbF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbLTQ1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxMzAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnRvdGFsTWF0Y2hUaW1lTGFiZWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVG90YWxUaW1lRGlnaXRzXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVG90YWxUaW1lRGlnaXRzXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzU1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxMjAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UaW1lSFRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1RpbWVIVF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbLTQ1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzEwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1RpbWVIT18ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVGltZUhPXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFstMzUsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suZGlnaXQsIDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVGltZUMxXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19UaW1lQzFfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWy0yNSwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxMCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5jb2xvbiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UaW1lTVRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1RpbWVNVF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbLTE1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzEwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1RpbWVNT18ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVGltZU1PXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFstNSwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxMCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5kaWdpdCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UaW1lQzJfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1RpbWVDMl8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbNSwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxMCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5jb2xvbiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UaW1lU1RfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1RpbWVTVF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMTUsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suZGlnaXQsIDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVGltZVNPXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19UaW1lU09fJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzI1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzEwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfUm91bmRzXyR7cGlkfQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1JvdW5kc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTIyXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbMzQwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS5yb3VuZHNTdW1tYXJ5Rm9ybWF0LCAwLCAwKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfQWRtaW5BY3Rpb25zXyR7cGlkfQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX0FkbWluQWN0aW9uc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTM4XSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbMzQwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9uQ291bnRWaWN0b3J5Rm9ybWF0LCAwKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAwXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVGVhbXNSb3dfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVGVhbXNSb3dfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTU0XSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbMzQwLCA3MF0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UZWFtTGVmdF8ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1RlYW1MZWZ0XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWy04NSwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTYwLCAxMjJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbVklDVE9SWV9URUFNMV9CR19SR0JbMF0sIFZJQ1RPUllfVEVBTTFfQkdfUkdCWzFdLCBWSUNUT1JZX1RFQU0xX0JHX1JHQlsyXV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLjk1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19MZWZ0T3V0Y29tZV8ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfTGVmdE91dGNvbWVfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTUwLCAyMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS50ZWFtT3V0Y29tZUZvcm1hdCwgZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0xKSwgbW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkubG9zZXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFtWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzBdLCBWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzFdLCBWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdpbm5pbmcgY3Jvd24gKHNob3duIG9ubHkgZm9yIHRoZSB3aW5uaW5nIHRlYW0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX0xlZnRDcm93bl8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiSW1hZ2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogW1ZJQ1RPUllfQ1JPV05fT0ZGU0VUX1hfTEVGVCwgVklDVE9SWV9DUk9XTl9PRkZTRVRfWV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFtWSUNUT1JZX0NST1dOX1NJWkUsIFZJQ1RPUllfQ1JPV05fU0laRV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlVHlwZTogbW9kLlVJSW1hZ2VUeXBlLkNyb3duU29saWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlQ29sb3I6IFZJQ1RPUllfQ1JPV05fQ09MT1JfUkdCLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZUFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX0xlZnRSZWNvcmRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX0xlZnRSZWNvcmRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDMwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE1MCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFJlY29yZEZvcm1hdCwgMCwgMCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxOCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19MZWZ0Um91bmRXaW5zXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19MZWZ0Um91bmRXaW5zXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCA1MF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kV2luc0Zvcm1hdCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19MZWZ0Um91bmRMb3NzZXNfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX0xlZnRSb3VuZExvc3Nlc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgNjhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTUwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS5yb3VuZExvc3Nlc0Zvcm1hdCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19MZWZ0Um91bmRUaWVzXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19MZWZ0Um91bmRUaWVzXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCA4Nl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kVGllc0Zvcm1hdCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19MZWZ0VG90YWxLaWxsc18ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfTGVmdFRvdGFsS2lsbHNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDEwNF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnRvdGFsS2lsbHNGb3JtYXQsIDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFtWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzBdLCBWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzFdLCBWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVGVhbVJpZ2h0XyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVGVhbVJpZ2h0XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzg1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNjAsIDEyMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFtWSUNUT1JZX1RFQU0yX0JHX1JHQlswXSwgVklDVE9SWV9URUFNMl9CR19SR0JbMV0sIFZJQ1RPUllfVEVBTTJfQkdfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAuOTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1JpZ2h0T3V0Y29tZV8ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfUmlnaHRPdXRjb21lXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCA2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE1MCwgMjJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudGVhbU91dGNvbWVGb3JtYXQsIGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMiksIG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LndpbnMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFtWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzBdLCBWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzFdLCBWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdpbm5pbmcgY3Jvd24gKHNob3duIG9ubHkgZm9yIHRoZSB3aW5uaW5nIHRlYW0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1JpZ2h0Q3Jvd25fJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIkltYWdlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFtWSUNUT1JZX0NST1dOX09GRlNFVF9YX1JJR0hULCBWSUNUT1JZX0NST1dOX09GRlNFVF9ZXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogW1ZJQ1RPUllfQ1JPV05fU0laRSwgVklDVE9SWV9DUk9XTl9TSVpFXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VUeXBlOiBtb2QuVUlJbWFnZVR5cGUuQ3Jvd25Tb2xpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VDb2xvcjogVklDVE9SWV9DUk9XTl9DT0xPUl9SR0IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlQWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfUmlnaHRSZWNvcmRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1JpZ2h0UmVjb3JkXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCAzMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQucm91bmRSZWNvcmRGb3JtYXQsIDAsIDAsIDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFtWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzBdLCBWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzFdLCBWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfUmlnaHRSb3VuZFdpbnNfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1JpZ2h0Um91bmRXaW5zXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCA1MF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kV2luc0Zvcm1hdCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19SaWdodFJvdW5kTG9zc2VzXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19SaWdodFJvdW5kTG9zc2VzXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCA2OF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kTG9zc2VzRm9ybWF0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbVklDVE9SWV9URUFNMl9URVhUX1JHQlswXSwgVklDVE9SWV9URUFNMl9URVhUX1JHQlsxXSwgVklDVE9SWV9URUFNMl9URVhUX1JHQlsyXV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1JpZ2h0Um91bmRUaWVzXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19SaWdodFJvdW5kVGllc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgODZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTUwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS5yb3VuZFRpZXNGb3JtYXQsIDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFtWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzBdLCBWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzFdLCBWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfUmlnaHRUb3RhbEtpbGxzXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19SaWdodFRvdGFsS2lsbHNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDEwNF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnRvdGFsS2lsbHNGb3JtYXQsIDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFtWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzBdLCBWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzFdLCBWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19Sb3N0ZXJSb3dfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfUm9zdGVyUm93XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIFZJQ1RPUllfRElBTE9HX1JPU1RFUl9ST1dfWV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW1ZJQ1RPUllfRElBTE9HX1JPU1RFUl9ST1dfV0lEVEgsIFZJQ1RPUllfRElBTE9HX1JPU1RFUl9ST1dfSEVJR0hUX01BWF0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19Sb3N0ZXJMZWZ0XyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfUm9zdGVyTGVmdF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFstODUsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogW1ZJQ1RPUllfRElBTE9HX1JPU1RFUl9DT05UQUlORVJfV0lEVEgsIFZJQ1RPUllfRElBTE9HX1JPU1RFUl9ST1dfSEVJR0hUX01BWF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFtWSUNUT1JZX1RFQU0xX0JHX1JHQlswXSwgVklDVE9SWV9URUFNMV9CR19SR0JbMV0sIFZJQ1RPUllfVEVBTTFfQkdfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAuOTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd3M6IGFueVtdID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBURUFNX1JPU1RFUl9NQVhfUk9XUzsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd3MucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19MZWZ0Um9zdGVyXyR7cGlkfV8ke2l9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIFZJQ1RPUllfRElBTE9HX1JPU1RFUl9ST1dfUEFERElOR19UT1AgKyBpICogVklDVE9SWV9ESUFMT0dfUk9TVEVSX1JPV19IRUlHSFRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogW1ZJQ1RPUllfRElBTE9HX1JPU1RFUl9DT05UQUlORVJfV0lEVEgsIFZJQ1RPUllfRElBTE9HX1JPU1RFUl9ST1dfSEVJR0hUXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsICIiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDExLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByb3dzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkoKSwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19Sb3N0ZXJSaWdodF8ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1Jvc3RlclJpZ2h0XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzg1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFtWSUNUT1JZX0RJQUxPR19ST1NURVJfQ09OVEFJTkVSX1dJRFRILCBWSUNUT1JZX0RJQUxPR19ST1NURVJfUk9XX0hFSUdIVF9NQVhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbVklDVE9SWV9URUFNMl9CR19SR0JbMF0sIFZJQ1RPUllfVEVBTTJfQkdfUkdCWzFdLCBWSUNUT1JZX1RFQU0yX0JHX1JHQlsyXV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLjk1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb3dzOiBhbnlbXSA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgVEVBTV9ST1NURVJfTUFYX1JPV1M7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dzLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfUmlnaHRSb3N0ZXJfJHtwaWR9XyR7aX1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgVklDVE9SWV9ESUFMT0dfUk9TVEVSX1JPV19QQURESU5HX1RPUCArIGkgKiBWSUNUT1JZX0RJQUxPR19ST1NURVJfUk9XX0hFSUdIVF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbVklDVE9SWV9ESUFMT0dfUk9TVEVSX0NPTlRBSU5FUl9XSURUSCwgVklDVE9SWV9ESUFMT0dfUk9TVEVSX1JPV19IRUlHSFRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgIiIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbVklDVE9SWV9URUFNMl9URVhUX1JHQlswXSwgVklDVE9SWV9URUFNMl9URVhUX1JHQlsxXSwgVklDVE9SWV9URUFNMl9URVhUX1JHQlsyXV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvd3M7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSgpLAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgIH0pOwoKICAgICAgICBpZiAobW9kYWwpIHJlZnMucm9vdHMucHVzaChtb2RhbCk7CgogICAgICAgIHJlZnMudmljdG9yeVJvb3QgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ1Jvb3RfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5UmVzdGFydFRleHQgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19SZXN0YXJ0XyR7cGlkfWApOwoKICAgICAgICByZWZzLnZpY3RvcnlUaW1lSG91cnNUZW5zID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfVGltZUhUXyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeVRpbWVIb3Vyc09uZXMgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19UaW1lSE9fJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5VGltZU1pbnV0ZXNUZW5zID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfVGltZU1UXyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeVRpbWVNaW51dGVzT25lcyA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX1RpbWVNT18ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlUaW1lU2Vjb25kc1RlbnMgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19UaW1lU1RfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5VGltZVNlY29uZHNPbmVzID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfVGltZVNPXyR7cGlkfWApOwoKICAgICAgICByZWZzLnZpY3RvcnlSb3VuZHNTdW1tYXJ5VGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX1JvdW5kc18ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlBZG1pbkFjdGlvbnNUZXh0ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfQWRtaW5BY3Rpb25zXyR7cGlkfWApOwoKICAgICAgICByZWZzLnZpY3RvcnlMZWZ0T3V0Y29tZVRleHQgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19MZWZ0T3V0Y29tZV8ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlMZWZ0Um91bmRXaW5zVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX0xlZnRSb3VuZFdpbnNfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5TGVmdFJvdW5kTG9zc2VzVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX0xlZnRSb3VuZExvc3Nlc18ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlMZWZ0Um91bmRUaWVzVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX0xlZnRSb3VuZFRpZXNfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5TGVmdFRvdGFsS2lsbHNUZXh0ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfTGVmdFRvdGFsS2lsbHNfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5TGVmdENyb3duID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfTGVmdENyb3duXyR7cGlkfWApOwoKICAgICAgICByZWZzLnZpY3RvcnlSaWdodE91dGNvbWVUZXh0ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfUmlnaHRPdXRjb21lXyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeVJpZ2h0Um91bmRXaW5zVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX1JpZ2h0Um91bmRXaW5zXyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeVJpZ2h0Um91bmRMb3NzZXNUZXh0ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfUmlnaHRSb3VuZExvc3Nlc18ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlSaWdodFJvdW5kVGllc1RleHQgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19SaWdodFJvdW5kVGllc18ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlMZWZ0UmVjb3JkVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX0xlZnRSZWNvcmRfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5UmlnaHRSZWNvcmRUZXh0ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfUmlnaHRSZWNvcmRfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5UmlnaHRUb3RhbEtpbGxzVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX1JpZ2h0VG90YWxLaWxsc18ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlSaWdodENyb3duID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfUmlnaHRDcm93bl8ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlSb3N0ZXJSb3cgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19Sb3N0ZXJSb3dfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5Um9zdGVyTGVmdENvbnRhaW5lciA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX1Jvc3RlckxlZnRfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5Um9zdGVyUmlnaHRDb250YWluZXIgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19Sb3N0ZXJSaWdodF8ke3BpZH1gKTsKCiAgICAgICAgcmVmcy52aWN0b3J5TGVmdFJvc3RlclRleHQgPSBbXTsKICAgICAgICByZWZzLnZpY3RvcnlSaWdodFJvc3RlclRleHQgPSBbXTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFRFQU1fUk9TVEVSX01BWF9ST1dTOyBpKyspIHsKICAgICAgICAgICAgcmVmcy52aWN0b3J5TGVmdFJvc3RlclRleHQucHVzaChzYWZlRmluZChgVmljdG9yeURpYWxvZ19MZWZ0Um9zdGVyXyR7cGlkfV8ke2l9YCkpOwogICAgICAgICAgICByZWZzLnZpY3RvcnlSaWdodFJvc3RlclRleHQucHVzaChzYWZlRmluZChgVmljdG9yeURpYWxvZ19SaWdodFJvc3Rlcl8ke3BpZH1fJHtpfWApKTsKICAgICAgICB9CiAgICB9CgogICAgLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgLSBWaWN0b3J5IERpYWxvZyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgLSBDYWNoZSBJbml0ICsgRGVmYXVsdHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICByZWZzLmhlbHBUZXh0Q29udGFpbmVyID0gc2FmZUZpbmQoYENvbnRhaW5lcl9IZWxwVGV4dF8ke3BpZH1gKTsKICAgIHJlZnMucmVhZHlTdGF0dXNDb250YWluZXIgPSBzYWZlRmluZChgQ29udGFpbmVyX1JlYWR5U3RhdHVzXyR7cGlkfWApOwogICAgcmVmcy5zcGF3bkRpc2FibGVkTGl2ZVRleHQgPSBzYWZlRmluZChgU3Bhd25EaXNhYmxlZExpdmVUZXh0XyR7cGlkfWApOwogICAgcmVmcy5zZXR0aW5nc0dhbWVNb2RlVGV4dCA9IHNhZmVGaW5kKGBTZXR0aW5nc19HYW1lTW9kZV8ke3BpZH1gKTsKICAgIHJlZnMuc2V0dGluZ3NBaXJjcmFmdENlaWxpbmdUZXh0ID0gc2FmZUZpbmQoYFNldHRpbmdzX0NlaWxpbmdfJHtwaWR9YCk7CiAgICByZWZzLnNldHRpbmdzVmVoaWNsZXNUMVRleHQgPSBzYWZlRmluZChgU2V0dGluZ3NfVmVoaWNsZXNUMV8ke3BpZH1gKTsKICAgIHJlZnMuc2V0dGluZ3NWZWhpY2xlc1QyVGV4dCA9IHNhZmVGaW5kKGBTZXR0aW5nc19WZWhpY2xlc1QyXyR7cGlkfWApOwogICAgcmVmcy5zZXR0aW5nc1ZlaGljbGVzTWF0Y2h1cFRleHQgPSBzYWZlRmluZChgU2V0dGluZ3NfVmVoaWNsZXNNYXRjaHVwXyR7cGlkfWApOwogICAgcmVmcy5zZXR0aW5nc1BsYXllcnNUZXh0ID0gc2FmZUZpbmQoYFNldHRpbmdzX1BsYXllcnNfJHtwaWR9YCk7CiAgICBTdGF0ZS5odWRDYWNoZS5odWRCeVBpZFtwaWRdID0gcmVmczsKCiAgICAvLyBJbml0aWFsaXplIHZpc2libGUgbnVtYmVycyBpbW1lZGlhdGVseQogICAgc2V0Q291bnRlclRleHQocmVmcy5yb3VuZEN1clRleHQsIFN0YXRlLnJvdW5kLmN1cnJlbnQpOwogICAgc2V0Q291bnRlclRleHQocmVmcy5yb3VuZE1heFRleHQsIFN0YXRlLnJvdW5kLm1heCk7CiAgICBzZXRDb3VudGVyVGV4dChyZWZzLmxlZnRXaW5zVGV4dCwgU3RhdGUubWF0Y2gud2luc1QxKTsKICAgIHNldENvdW50ZXJUZXh0KHJlZnMucmlnaHRXaW5zVGV4dCwgU3RhdGUubWF0Y2gud2luc1QyKTsKCiAgICBzZXRDb3VudGVyVGV4dChyZWZzLmxlZnRSb3VuZEtpbGxzVGV4dCwgU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscyk7CiAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJpZ2h0Um91bmRLaWxsc1RleHQsIFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHMpOwogICAgc2V0Um91bmRLaWxsc0xhYmVsVGV4dEZvclJlZnMocmVmcyk7CiAgICBzZXRSb3VuZFdpbkNyb3duRm9yUmVmcyhyZWZzLCBTdGF0ZS5yb3VuZC5sYXN0V2lubmVyVGVhbSwgU3RhdGUucm91bmQuZmxvdy5yb3VuZEVuZERpYWxvZ1Zpc2libGUpOwogICAgc2V0VHJlbmRpbmdXaW5uZXJDcm93bkZvclJlZnMocmVmcyk7CgogICAgLy8gVG90YWwga2lsbHMgYXJlIHRyYWNrZWQgc2VwYXJhdGVseSBmcm9tIEdhbWVNb2RlU2NvcmUgKHdoaWNoIGlzIHVzZWQgZm9yIG1hdGNoIHdpbnMpCiAgICBzZXRDb3VudGVyVGV4dChyZWZzLmxlZnRLaWxsc1RleHQsIFN0YXRlLnNjb3Jlcy50MVRvdGFsS2lsbHMpOwogICAgc2V0Q291bnRlclRleHQocmVmcy5yaWdodEtpbGxzVGV4dCwgU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscyk7CiAgICBzZXRBZG1pblBhbmVsQWN0aW9uQ291bnRUZXh0KHJlZnMuYWRtaW5QYW5lbEFjdGlvbkNvdW50VGV4dCwgU3RhdGUuYWRtaW4uYWN0aW9uQ291bnQpOwogICAgdXBkYXRlU2V0dGluZ3NTdW1tYXJ5SHVkRm9yUGlkKHBpZCk7CgogICAgZW5zdXJlVG9wSHVkUm9vdEZvclBpZChwaWQsIHBsYXllcik7CiAgICBzZXRIdWRIZWxwRGVwdGhGb3JQaWQocGlkKTsKCiAgICB1cGRhdGVWaWN0b3J5RGlhbG9nRm9yUGxheWVyKHBsYXllciwgZ2V0UmVtYWluaW5nU2Vjb25kcygpKTsKCiAgICByZXR1cm4gcmVmczsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgLSBDYWNoZSBJbml0ICsgRGVmYXVsdHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBVcGRhdGUgSGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gc2V0SHVkUm91bmRDb3VudGVyc0ZvckFsbFBsYXllcnMoY3VyOiBudW1iZXIsIG1heDogbnVtYmVyKTogdm9pZCB7CiAgICAvLyBTZXRzIGF1dGhvcml0YXRpdmUgcm91bmQgY3VycmVudC9tYXggdmFsdWVzIGFuZCBzeW5jcyBIVUQgKyBSZWFkeSBkaWFsb2cgIkJlc3Qgb2YiLgogICAgU3RhdGUucm91bmQuY3VycmVudCA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IoY3VyKSk7CiAgICBTdGF0ZS5yb3VuZC5tYXggPSBNYXRoLm1heCgxLCBNYXRoLmZsb29yKG1heCkpOwogICAgaWYgKFN0YXRlLnJvdW5kLm1heCA8IFN0YXRlLnJvdW5kLmN1cnJlbnQpIHsKICAgICAgICBTdGF0ZS5yb3VuZC5tYXggPSBTdGF0ZS5yb3VuZC5jdXJyZW50OwogICAgfQoKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcmVmcyA9IGVuc3VyZUh1ZEZvclBsYXllcihwKTsKICAgICAgICBpZiAoIXJlZnMpIGNvbnRpbnVlOwogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMucm91bmRDdXJUZXh0LCBTdGF0ZS5yb3VuZC5jdXJyZW50KTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJvdW5kTWF4VGV4dCwgU3RhdGUucm91bmQubWF4KTsKICAgIH0KCiAgICBzZXRSb3VuZFN0YXRlVGV4dEZvckFsbFBsYXllcnMoKTsKICAgIC8vIEtlZXAgUmVhZHkgVXAgZGlhbG9nICJCZXN0IG9mIiBsYWJlbCBpbiBzeW5jIHdpdGggU3RhdGUucm91bmQubWF4LgogICAgdXBkYXRlQmVzdE9mUm91bmRzTGFiZWxGb3JBbGxQbGF5ZXJzKCk7Cn0KCmZ1bmN0aW9uIHNldEh1ZFdpbkNvdW50ZXJzRm9yQWxsUGxheWVycyh0MVdpbnM6IG51bWJlciwgdDJXaW5zOiBudW1iZXIpOiB2b2lkIHsKICAgIC8vIFVwZGF0ZXMgbWF0Y2ggd2luIGNvdW50ZXJzIGluIHNjcmlwdCBzdGF0ZSBhbmQgR2FtZU1vZGVTY29yZSwgdGhlbiByZWZyZXNoZXMgSFVELgogICAgY29uc3QgbHcgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHQxV2lucykpOwogICAgY29uc3QgcncgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHQyV2lucykpOwoKICAgIC8vIE1hdGNoIHdpbnMgYXJlIGF1dGhvcml0YXRpdmUgaW4gc2NyaXB0IHN0YXRlOyBHYW1lTW9kZVNjb3JlIGlzIG1pcnJvcmVkIGZvciBzY29yZWJvYXJkIGRpc3BsYXkuCiAgICBzZXRNYXRjaFdpbnNUZWFtKFRlYW1JRC5UZWFtMSwgbHcpOwogICAgc2V0TWF0Y2hXaW5zVGVhbShUZWFtSUQuVGVhbTIsIHJ3KTsKCiAgICAvLyBDYWNoZSBsb2NhbGx5IGZvciBpbW1lZGlhdGUgVUkgKyBsb2dpYy4KICAgIFN0YXRlLm1hdGNoLndpbnNUMSA9IGx3OwogICAgU3RhdGUubWF0Y2gud2luc1QyID0gcnc7CgogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCByZWZzID0gZW5zdXJlSHVkRm9yUGxheWVyKHApOwogICAgICAgIGlmICghcmVmcykgY29udGludWU7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5sZWZ0V2luc1RleHQsIGx3KTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJpZ2h0V2luc1RleHQsIHJ3KTsKICAgIH0KICAgIHNldFRyZW5kaW5nV2lubmVyQ3Jvd25Gb3JBbGxQbGF5ZXJzKCk7CgogICAgc3luY1JvdW5kUmVjb3JkSHVkRm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiBzeW5jUm91bmRSZWNvcmRIdWRGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgLy8gRGVyaXZlcyBsb3NzZXMgZnJvbSB3aW5zL3RpZXMgYW5kIHN5bmNzIHRoZSBSb3VuZCBSZWNvcmQgSFVEIGZvciBib3RoIHRlYW1zLgogICAgLy8gTG9zc2VzIGFyZSBkZXJpdmVkIGZyb20gdGhlIG9wcG9uZW50J3Mgd2luIGNvdW50IHdoZW4gcm91bmRzIGVuZCB3aXRoIGEgc2luZ2xlIHdpbm5lci4KICAgIFN0YXRlLm1hdGNoLmxvc3Nlc1QxID0gU3RhdGUubWF0Y2gud2luc1QyOwogICAgU3RhdGUubWF0Y2gubG9zc2VzVDIgPSBTdGF0ZS5tYXRjaC53aW5zVDE7CgogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCByZWZzID0gZW5zdXJlSHVkRm9yUGxheWVyKHApOwogICAgICAgIGlmICghcmVmcykgY29udGludWU7CiAgICAgICAgc2V0Um91bmRSZWNvcmRUZXh0KHJlZnMubGVmdFJlY29yZFRleHQsIFN0YXRlLm1hdGNoLndpbnNUMSwgU3RhdGUubWF0Y2gubG9zc2VzVDEsIFN0YXRlLm1hdGNoLnRpZXNUMSk7CiAgICAgICAgc2V0Um91bmRSZWNvcmRUZXh0KHJlZnMucmlnaHRSZWNvcmRUZXh0LCBTdGF0ZS5tYXRjaC53aW5zVDIsIFN0YXRlLm1hdGNoLmxvc3Nlc1QyLCBTdGF0ZS5tYXRjaC50aWVzVDIpOwogICAgfQp9CgpmdW5jdGlvbiBhZGp1c3RNYXRjaFRpZXNGb3JCb3RoVGVhbXMoZGVsdGE6IG51bWJlcik6IHZvaWQgewogICAgLy8gQXBwbGllcyBhIGRlbHRhIHRvIG1hdGNoIHRpZXMgZm9yIGJvdGggdGVhbXMgYW5kIHJlZnJlc2hlcyB0aGUgUm91bmQgUmVjb3JkIEhVRC4KICAgIGNvbnN0IGN1cnJlbnQgPSBNYXRoLm1pbihTdGF0ZS5tYXRjaC50aWVzVDEsIFN0YXRlLm1hdGNoLnRpZXNUMik7CiAgICBjb25zdCBuZXh0ID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihjdXJyZW50ICsgZGVsdGEpKTsKICAgIFN0YXRlLm1hdGNoLnRpZXNUMSA9IG5leHQ7CiAgICBTdGF0ZS5tYXRjaC50aWVzVDIgPSBuZXh0OwogICAgc3luY1JvdW5kUmVjb3JkSHVkRm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiB1cGRhdGVBZG1pblBhbmVsQWN0aW9uQ291bnRGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgLy8gUHVzaGVzIHRoZSBhZG1pbiBhY3Rpb24gY291bnQgdG8gZXZlcnkgcGxheWVyJ3MgSFVEIHdpZGdldC4KICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcmVmcyA9IGVuc3VyZUh1ZEZvclBsYXllcihwKTsKICAgICAgICBpZiAoIXJlZnMpIGNvbnRpbnVlOwogICAgICAgIHNldEFkbWluUGFuZWxBY3Rpb25Db3VudFRleHQocmVmcy5hZG1pblBhbmVsQWN0aW9uQ291bnRUZXh0LCBTdGF0ZS5hZG1pbi5hY3Rpb25Db3VudCk7CiAgICB9Cn0KCmZ1bmN0aW9uIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsIGFjdGlvbktleTogbnVtYmVyKTogdm9pZCB7CiAgICAvLyBJbmNyZW1lbnRzIHRoZSBhZG1pbiBhY3Rpb24gY291bnRlciBhbmQgYnJvYWRjYXN0cyB0aGUgYWN0aW9uIHRvIHRoZSB3b3JsZCBsb2cuCiAgICBTdGF0ZS5hZG1pbi5hY3Rpb25Db3VudCA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IoU3RhdGUuYWRtaW4uYWN0aW9uQ291bnQpICsgMSk7CiAgICB1cGRhdGVBZG1pblBhbmVsQWN0aW9uQ291bnRGb3JBbGxQbGF5ZXJzKCk7CiAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9uUHJlc3NlZCwgZXZlbnRQbGF5ZXIsIGFjdGlvbktleSksCiAgICAgICAgdHJ1ZSwKICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9uUHJlc3NlZAogICAgKTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEhVRCBVcGRhdGUgSGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gTGVnYWN5IFVJIENsZWFudXAgKG9sZCBzY29yZV9yb290XyogY29udGFpbmVycykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIENvZGUgQ2xlYW51cDogSXMgdGhpcyBzdGlsbCBuZWVkZWQ/Pz8KZnVuY3Rpb24gZGVsZXRlTGVnYWN5U2NvcmVSb290Rm9yUGxheWVyKHBsYXllcjogbW9kLlBsYXllcik6IHZvaWQgewogICAgY29uc3QgbmFtZSA9ICJzY29yZV9yb290XyIgKyBnZXRPYmpJZChwbGF5ZXIpOwogICAgdHJ5IHsKICAgICAgICBtb2QuRGVsZXRlVUlXaWRnZXQobW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKG5hbWUpKTsKICAgIH0gY2F0Y2ggeyB9Cn0KCmZ1bmN0aW9uIGRlbGV0ZUxlZ2FjeVNjb3JlUm9vdHNGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwKSBjb250aW51ZTsKICAgICAgICBpZiAoIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBkZWxldGVMZWdhY3lTY29yZVJvb3RGb3JQbGF5ZXIocCk7CiAgICB9Cn0KLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIExlZ2FjeSBVSSBDbGVhbnVwIChvbGQgc2NvcmVfcm9vdF8qIGNvbnRhaW5lcnMpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBQb3J0YWwgQXJyYXkgSGVscGVycyAoZW5naW5lIGFycmF5cykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIGFycmF5Q29udGFpbnNWZWhpY2xlKGFycjogYW55LCB2ZWhpY2xlOiBtb2QuVmVoaWNsZSk6IGJvb2xlYW4gewogICAgcmV0dXJuIG1vZGxpYi5Jc1RydWVGb3JBbnkoYXJyLCAoZWw6IGFueSkgPT4gbW9kLkVxdWFscyhlbCwgdmVoaWNsZSkpOwp9CgpmdW5jdGlvbiBhcnJheVJlbW92ZVZlaGljbGUoYXJyOiBhbnksIHZlaGljbGU6IG1vZC5WZWhpY2xlKTogYW55IHsKICAgIC8vIEZpbHRlcmVkQXJyYXkgbXVzdCByZW1haW4gc3RhYmxlIGFjcm9zcyBlbmdpbmUgdXBkYXRlczsgcmVnaXN0cnkgY29ycmVjdG5lc3MgZGVwZW5kcyBvbiBpdC4KICAgIHJldHVybiBtb2RsaWIuRmlsdGVyZWRBcnJheShhcnIsIChlbDogYW55KSA9PiBtb2QuTm90RXF1YWxUbyhlbCwgdmVoaWNsZSkpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gUG9ydGFsIEFycmF5IEhlbHBlcnMgKGVuZ2luZSBhcnJheXMpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBWZWhpY2xlIE93bmVyc2hpcCBUcmFja2luZyAodmVoSWRzL3ZlaE93bmVycykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gVmVoaWNsZSBvd25lciBjYWNoZSBsaWZlY3ljbGU6Ci8vIC0gc2V0TGFzdERyaXZlciBvbiBlbnRyeSwgcG9wTGFzdERyaXZlciBvbiBkZXN0cnVjdGlvbiwgY2xlYXJMYXN0RHJpdmVyQnlWZWhpY2xlT2JqSWQgb24gc3Bhd24vcmVzcGF3bi4KCmZ1bmN0aW9uIGdldFZlaGljbGVJZCh2OiBtb2QuVmVoaWNsZSk6IG51bWJlciB7IHJldHVybiBnZXRPYmpJZCh2KTsgfQoKZnVuY3Rpb24gZ2V0TGFzdERyaXZlcih2ZWhpY2xlOiBtb2QuVmVoaWNsZSk6IG1vZC5QbGF5ZXIgfCB1bmRlZmluZWQgewogICAgY29uc3QgdmlkID0gZ2V0VmVoaWNsZUlkKHZlaGljbGUpOwogICAgLy8gTGluZWFyIHNjYW4gb2YgdGhlIGNhY2hlZCB2ZWhpY2xlLWlkIGxpc3QgdG8gZmluZCBpdHMgbGFzdCBrbm93biBkcml2ZXIuCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZlaElkcy5sZW5ndGg7IGkrKykgewogICAgICAgIC8vIFBhcmFsbGVsIGFycmF5czogdmVoSWRzW2ldIG1hcHMgdG8gdmVoT3duZXJzW2ldLgogICAgICAgIGlmICh2ZWhJZHNbaV0gPT09IHZpZCkgcmV0dXJuIHZlaE93bmVyc1tpXTsKICAgIH0KICAgIC8vIE5vIGNhY2hlZCBlbnRyeSBmb3VuZC4KICAgIHJldHVybiB1bmRlZmluZWQ7Cn0KCmZ1bmN0aW9uIHNldExhc3REcml2ZXIodmVoaWNsZTogbW9kLlZlaGljbGUsIHBsYXllcjogbW9kLlBsYXllcik6IHZvaWQgewogICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIHJldHVybjsKICAgIGNvbnN0IHZpZCA9IGdldFZlaGljbGVJZCh2ZWhpY2xlKTsKICAgIC8vIFVwZGF0ZSBleGlzdGluZyBlbnRyeSBpZiB0aGlzIHZlaGljbGUgaXMgYWxyZWFkeSB0cmFja2VkLgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZWhJZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAodmVoSWRzW2ldID09PSB2aWQpIHsKICAgICAgICAgICAgdmVoT3duZXJzW2ldID0gcGxheWVyOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQogICAgLy8gRmlyc3QgdGltZSB3ZSBzZWUgdGhpcyB2ZWhpY2xlOiBhcHBlbmQgdG8gdGhlIHBhcmFsbGVsIGFycmF5cy4KICAgIHZlaElkcy5wdXNoKHZpZCk7CiAgICB2ZWhPd25lcnMucHVzaChwbGF5ZXIpOwp9CgpmdW5jdGlvbiBwb3BMYXN0RHJpdmVyKHZlaGljbGU6IG1vZC5WZWhpY2xlKTogbW9kLlBsYXllciB8IHVuZGVmaW5lZCB7CiAgICBjb25zdCB2aWQgPSBnZXRWZWhpY2xlSWQodmVoaWNsZSk7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZWhJZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBGaW5kIHRoZSB2ZWhpY2xlIGVudHJ5LCByZXR1cm4gaXRzIG93bmVyLCB0aGVuIHJlbW92ZSBpdCBmcm9tIHRoZSBjYWNoZS4KICAgICAgICBpZiAodmVoSWRzW2ldID09PSB2aWQpIHsKICAgICAgICAgICAgY29uc3Qgb3duZXIgPSB2ZWhPd25lcnNbaV07CgogICAgICAgICAgICAvLyBTd2FwLXJlbW92ZSB0byBhdm9pZCBzaGlmdGluZyB0aGUgYXJyYXlzLgogICAgICAgICAgICBjb25zdCBsYXN0SWR4ID0gdmVoSWRzLmxlbmd0aCAtIDE7CiAgICAgICAgICAgIHZlaElkc1tpXSA9IHZlaElkc1tsYXN0SWR4XTsKICAgICAgICAgICAgdmVoT3duZXJzW2ldID0gdmVoT3duZXJzW2xhc3RJZHhdOwogICAgICAgICAgICB2ZWhJZHMucG9wKCk7CiAgICAgICAgICAgIHZlaE93bmVycy5wb3AoKTsKCiAgICAgICAgICAgIC8vIFJldHVybiB0aGUgcmVtb3ZlZCBvd25lciAoY2FsbGVyIG1heSB1c2UgZm9yIG1lc3NhZ2luZykuCiAgICAgICAgICAgIHJldHVybiBvd25lcjsKICAgICAgICB9CiAgICB9CiAgICAvLyBObyBjYWNoZWQgZW50cnkgZm91bmQuCiAgICByZXR1cm4gdW5kZWZpbmVkOwp9CgpmdW5jdGlvbiBjbGVhckxhc3REcml2ZXJCeVZlaGljbGVPYmpJZCh2ZWhpY2xlT2JqSWQ6IG51bWJlcik6IHZvaWQgewogICAgLy8gUmVtb3ZlIHRoZSBsYXN0LWRyaXZlciBlbnRyeSBmb3IgYSBzcGVjaWZpYyB2ZWhpY2xlIE9iaklkIChpZiBpdCBleGlzdHMpLgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZWhJZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBGaW5kIHRoZSBtYXRjaGluZyB2ZWhpY2xlIGlkIGluIHRoZSBwYXJhbGxlbCBhcnJheXMuCiAgICAgICAgaWYgKHZlaElkc1tpXSA9PT0gdmVoaWNsZU9iaklkKSB7CiAgICAgICAgICAgIC8vIFN3YXAtcmVtb3ZlIHRvIGtlZXAgYXJyYXlzIGNvbXBhY3Qgd2l0aG91dCBwcmVzZXJ2aW5nIG9yZGVyLgogICAgICAgICAgICBjb25zdCBsYXN0SWR4ID0gdmVoSWRzLmxlbmd0aCAtIDE7CiAgICAgICAgICAgIHZlaElkc1tpXSA9IHZlaElkc1tsYXN0SWR4XTsKICAgICAgICAgICAgdmVoT3duZXJzW2ldID0gdmVoT3duZXJzW2xhc3RJZHhdOwogICAgICAgICAgICB2ZWhJZHMucG9wKCk7CiAgICAgICAgICAgIHZlaE93bmVycy5wb3AoKTsKICAgICAgICAgICAgLy8gRG9uZTogdGhlcmUgaXMgbm8gbG9uZ2VyIGEgY2FjaGVkIG93bmVyIGZvciB0aGlzIHZlaGljbGUuCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBWZWhpY2xlIE93bmVyc2hpcCBUcmFja2luZyAodmVoSWRzL3ZlaE93bmVycykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFZlaGljbGUgUmVnaXN0cmF0aW9uICh0ZWFtIGFycmF5cykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIFJlZ2lzdGVycyB2ZWhpY2xlIG93bmVyc2hpcCB0byBhIHRlYW0gZm9yIGtpbGwgYXR0cmlidXRpb24uCi8vIElNUE9SVEFOVDoKLy8gLSBWZWhpY2xlIElEIGFuZCBvd25pbmcgdGVhbSBtdXN0IHN0YXkgaW4gc3luYwovLyAtIFJlYXNzaWdubWVudHMgbXVzdCBvdmVyd3JpdGUgcHJldmlvdXMgb3duZXJzaGlwCgpmdW5jdGlvbiByZWdpc3RlclZlaGljbGVUb1RlYW0odmVoaWNsZTogbW9kLlZlaGljbGUsIHRlYW1OdW06IFRlYW1JRCk6IHZvaWQgewogICAgLy8gRW5zdXJlIHRoZSB2ZWhpY2xlIGV4aXN0cyBpbiBleGFjdGx5IG9uZSByZWdpc3RyeSBieSByZW1vdmluZyBpdCBmcm9tIGJvdGggZmlyc3QuCiAgICBtb2QuU2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMSwgYXJyYXlSZW1vdmVWZWhpY2xlKG1vZC5HZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0xKSwgdmVoaWNsZSkpOwogICAgbW9kLlNldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTIsIGFycmF5UmVtb3ZlVmVoaWNsZShtb2QuR2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMiksIHZlaGljbGUpKTsKCiAgICAvLyBBcHBlbmQgdGhlIHZlaGljbGUgdG8gdGhlIGNob3NlbiB0ZWFtJ3MgcmVnaXN0cnkgYXJyYXkuCiAgICBpZiAodGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSB7CiAgICAgICAgbW9kLlNldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTEsIG1vZC5BcHBlbmRUb0FycmF5KG1vZC5HZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0xKSwgdmVoaWNsZSkpOwogICAgfSBlbHNlIGlmICh0ZWFtTnVtID09PSBUZWFtSUQuVGVhbTIpIHsKICAgICAgICBtb2QuU2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMiwgbW9kLkFwcGVuZFRvQXJyYXkobW9kLkdldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTIpLCB2ZWhpY2xlKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGNsZWFyU3Bhd25CYXNlVGVhbUNhY2hlKCk6IHZvaWQgewogICAgZm9yIChjb25zdCBrIGluIHZlaGljbGVTcGF3bkJhc2VUZWFtQnlPYmpJZCkgZGVsZXRlIHZlaGljbGVTcGF3bkJhc2VUZWFtQnlPYmpJZFtrIGFzIGFueV07Cn0KCmZ1bmN0aW9uIGluZmVyQmFzZVRlYW1Gcm9tUG9zaXRpb24ocG9zOiBtb2QuVmVjdG9yKTogVGVhbUlEIHwgMCB7CiAgICBjb25zdCBkMSA9IG1vZC5EaXN0YW5jZUJldHdlZW4ocG9zLCBNQUlOX0JBU0VfVEVBTTFfUE9TKTsgLy8gRGlzdGFuY2UgZnJvbSB2ZWhpY2xlIHRvIFRlYW0gMSBiYXNlIGFuY2hvci4KICAgIGNvbnN0IGQyID0gbW9kLkRpc3RhbmNlQmV0d2Vlbihwb3MsIE1BSU5fQkFTRV9URUFNMl9QT1MpOyAvLyBEaXN0YW5jZSBmcm9tIHZlaGljbGUgdG8gVGVhbSAyIGJhc2UgYW5jaG9yLgogICAgY29uc3QgYmVzdCA9IGQxIDw9IGQyID8gVGVhbUlELlRlYW0xIDogVGVhbUlELlRlYW0yOyAvLyBQaWNrIHRoZSBuZWFyZXIgYmFzZSBhcyB0aGUgaW5mZXJyZWQgdGVhbS4KICAgIGNvbnN0IGJlc3REaXN0ID0gZDEgPD0gZDIgPyBkMSA6IGQyOyAvLyBUcmFjayB0aGUgZGlzdGFuY2UgdG8gdGhhdCBuZWFyZXN0IGJhc2UuCgogICAgaWYgKGJlc3REaXN0ID4gTUFJTl9CQVNFX0JJTkRfUkFESVVTX01FVEVSUykgeyAvLyBPdXRzaWRlIGJpbmQgcmFkaXVzOiB0cmVhdCBhcyB1bmFzc2lnbmVkLgogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIHJldHVybiBiZXN0OyAvLyBXaXRoaW4gcmFkaXVzOiByZXR1cm4gdGhlIGluZmVycmVkIHRlYW0gaWQuCn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBWZWhpY2xlIFJlZ2lzdHJhdGlvbiAodGVhbSBhcnJheXMpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBWZWhpY2xlIFNwYXduZXIgU3lzdGVtIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBWZWhpY2xlIFNwYXduZXIgU3lzdGVtIGFyY2hpdGVjdHVyZToKLy8gLSBTbG90ID0gKHRlYW0sIHNsb3ROdW1iZXIsIHNwYXduZXIsIGRlc2lyZWQgdmVoaWNsZSB0eXBlLCBsaXZlIHN0YXRlKS4KLy8gLSBFbmFibGVtZW50IGlzIHRpZWQgdG8gbWF0Y2h1cCBwcmVzZXRzIGFuZCBvbmx5IGFwcGxpZXMgd2hlbiB0aGUgcm91bmQgaXMgTk9UIGxpdmUuCi8vIC0gU3Bhd25zIGFyZSBmb3JjZWQgc2VxdWVudGlhbGx5IHRvIGF2b2lkIGNyb3NzLWJpbmRpbmcgYmV0d2VlbiBzcGF3bmVycy4KLy8gLSBTcGF3biBiaW5kaW5nIGlzIHBvc2l0aW9uLWJhc2VkOiB0aGUgZmlyc3QgZXhwZWN0aW5nIHNsb3Qgd2l0aGluIGJpbmQgZGlzdGFuY2UgY2xhaW1zIHRoZSB2ZWhpY2xlLgovLyAtIERpc2FibGVkIHNsb3RzIG5ldmVyIHJlc3Bhd247IGV4aXN0aW5nIHZlaGljbGVzIGFyZSBsZWZ0IGFsb25lIHVudGlsIGRlc3Ryb3llZC4KLy8gLSBBbGwgZGVsYXllZCB3b3JrIGlzIHRva2VuLWdhdGVkIHNvIHN0YWxlIHRpbWVycy9zZXF1ZW5jZXMgYWJvcnQgd2hlbiBzbG90cyBjaGFuZ2UuCgovLyBFYWNoIHNwYXduZXIgaXMgY29uZmlndXJlZCBvbmNlIG9uIGNyZWF0aW9uIHdpdGggaXRzIHZlaGljbGUgdHlwZSBhbmQgYWJhbmRvbm1lbnQvcmVzcGF3biBwYXJhbWV0ZXJzLgpmdW5jdGlvbiBjb25maWd1cmVWZWhpY2xlU3Bhd25lcihzcGF3bmVyOiBtb2QuVmVoaWNsZVNwYXduZXIsIHZlaGljbGVUeXBlOiBtb2QuVmVoaWNsZUxpc3QpOiB2b2lkIHsKICAgIC8vIFNwYXduZXIgc2V0dGluZ3MgYXJlIHR1bmVkIGZvciBjb25zaXN0ZW50IHJlc3Bhd24gYmVoYXZpb3I7IGFkanVzdCB3aXRoIGNhdXRpb24uCiAgICBtb2QuU2V0VmVoaWNsZVNwYXduZXJWZWhpY2xlVHlwZShzcGF3bmVyLCB2ZWhpY2xlVHlwZSk7CiAgICBtb2QuU2V0VmVoaWNsZVNwYXduZXJBdXRvU3Bhd24oc3Bhd25lciwgZmFsc2UpOwogICAgbW9kLlNldFZlaGljbGVTcGF3bmVyUmVzcGF3blRpbWUoc3Bhd25lciwgVkVISUNMRV9TUEFXTkVSX1JFU1BBV05fREVMQVlfU0VDT05EUyk7CiAgICBtb2QuU2V0VmVoaWNsZVNwYXduZXJBcHBseURhbWFnZVRvQWJhbmRvblZlaGljbGUoc3Bhd25lciwgdHJ1ZSk7CiAgICBtb2QuU2V0VmVoaWNsZVNwYXduZXJBYmFuZG9uVmVoaWNsZXNPdXRPZkNvbWJhdEFyZWEoc3Bhd25lciwgdHJ1ZSk7CiAgICBtb2QuU2V0VmVoaWNsZVNwYXduZXJUaW1lVW50aWxBYmFuZG9uKHNwYXduZXIsIFZFSElDTEVfU1BBV05FUl9USU1FX1VOVElMX0FCQU5ET05fU0VDT05EUyk7CiAgICBtb2QuU2V0VmVoaWNsZVNwYXduZXJLZWVwQWxpdmVBYmFuZG9uUmFkaXVzKHNwYXduZXIsIFZFSElDTEVfU1BBV05FUl9LRUVQX0FMSVZFX0FCQU5ET05fUkFESVVTKTsKICAgIG1vZC5TZXRWZWhpY2xlU3Bhd25lcktlZXBBbGl2ZVNwYXduZXJSYWRpdXMoc3Bhd25lciwgVkVISUNMRV9TUEFXTkVSX0tFRVBfQUxJVkVfU1BBV05FUl9SQURJVVMpOwp9CgovLyBQb2xsIGhlbHBlcjogcmV0dXJucyB1bmRlZmluZWQgaWYgdGhlIHZlaGljbGUgbm8gbG9uZ2VyIGV4aXN0cyAoZGVzdHJveWVkL3Vuc3Bhd25lZC9PT0IpLgpmdW5jdGlvbiBmaW5kVmVoaWNsZUJ5SWQodmVoaWNsZUlkOiBudW1iZXIpOiBtb2QuVmVoaWNsZSB8IHVuZGVmaW5lZCB7CiAgICBjb25zdCB2ZWhpY2xlcyA9IG1vZC5BbGxWZWhpY2xlcygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZih2ZWhpY2xlcyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gbW9kLlZhbHVlSW5BcnJheSh2ZWhpY2xlcywgaSkgYXMgbW9kLlZlaGljbGU7CiAgICAgICAgaWYgKG1vZC5HZXRPYmpJZCh2KSA9PT0gdmVoaWNsZUlkKSByZXR1cm4gdjsKICAgIH0KICAgIHJldHVybiB1bmRlZmluZWQ7Cn0KCi8vIENyZWF0ZXMgYSBzcGF3bmVyIG9iamVjdCwgYXBwbGllcyBtYXAtc3BlY2lmaWMgeWF3LCBjb25maWd1cmVzIHZlaGljbGUgdHlwZSwgYW5kIHJlZ2lzdGVycyB0aGUgc2xvdCBzdGF0ZS4KZnVuY3Rpb24gYWRkVmVoaWNsZVNwYXduZXJTbG90KHRlYW1JZDogVGVhbUlELCBzbG90TnVtYmVyOiBudW1iZXIsIHNwYXduUG9zOiBtb2QuVmVjdG9yLCBzcGF3blJvdDogbW9kLlZlY3RvciwgdmVoaWNsZVR5cGU6IG1vZC5WZWhpY2xlTGlzdCk6IG51bWJlciB7CiAgICBjb25zdCB5YXcgPSBtb2QuWUNvbXBvbmVudE9mKHNwYXduUm90KSArIFZFSElDTEVfU1BBV05fWUFXX09GRlNFVF9ERUc7CiAgICBjb25zdCBzcGF3bmVyUm90ID0gbW9kLkNyZWF0ZVZlY3Rvcihtb2QuWENvbXBvbmVudE9mKHNwYXduUm90KSwgeWF3LCBtb2QuWkNvbXBvbmVudE9mKHNwYXduUm90KSk7CiAgICBjb25zdCBzcGF3bmVyID0gbW9kLlNwYXduT2JqZWN0KAogICAgICAgIG1vZC5SdW50aW1lU3Bhd25fQ29tbW9uLlZlaGljbGVTcGF3bmVyLAogICAgICAgIHNwYXduUG9zLAogICAgICAgIHNwYXduZXJSb3QKICAgICkgYXMgbW9kLlZlaGljbGVTcGF3bmVyOwoKICAgIC8vIERpc2FibGUgYXV0b3MgcmlnaHQgYXdheSB0byBhdm9pZCB0aGUgZGVmYXVsdCB2ZWhpY2xlIHNwYXduaW5nIGJlZm9yZSB3ZSBjb25maWd1cmUgdGhlIHNwYXduZXIuCiAgICBtb2QuU2V0VmVoaWNsZVNwYXduZXJBdXRvU3Bhd24oc3Bhd25lciwgZmFsc2UpOwoKICAgIGNvbmZpZ3VyZVZlaGljbGVTcGF3bmVyKHNwYXduZXIsIHZlaGljbGVUeXBlKTsKCiAgICBjb25zdCBzbG90OiBWZWhpY2xlU3Bhd25lclNsb3QgPSB7CiAgICAgICAgdGVhbUlkLAogICAgICAgIHNsb3ROdW1iZXIsCiAgICAgICAgc3Bhd25lciwKICAgICAgICBzcGF3bmVyT2JqSWQ6IGdldE9iaklkKHNwYXduZXIpLAogICAgICAgIHNwYXduUG9zLAogICAgICAgIHNwYXduUm90OiBzcGF3bmVyUm90LAogICAgICAgIHZlaGljbGVUeXBlLAogICAgICAgIGVuYWJsZWQ6IGZhbHNlLAogICAgICAgIGVuYWJsZVRva2VuOiAwLAogICAgICAgIHNwYXduUmVxdWVzdFRva2VuOiAwLAogICAgICAgIHNwYXduUmVxdWVzdEF0U2Vjb25kczogLTEsCiAgICAgICAgZXhwZWN0aW5nU3Bhd246IGZhbHNlLAogICAgICAgIHZlaGljbGVJZDogLTEsCiAgICAgICAgcmVzcGF3blJ1bm5pbmc6IGZhbHNlLAogICAgICAgIHNwYXduUmV0cnlTY2hlZHVsZWQ6IGZhbHNlLAogICAgfTsKCiAgICBTdGF0ZS52ZWhpY2xlcy5zbG90cy5wdXNoKHNsb3QpOwogICAgcmV0dXJuIFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aCAtIDE7Cn0KCmZ1bmN0aW9uIGdldERlc2lyZWRTcGF3bmVyQ291bnRzRm9yUHJlc2V0KHByZXNldEluZGV4OiBudW1iZXIpOiB7IHRlYW0xOiBudW1iZXI7IHRlYW0yOiBudW1iZXIgfSB7CiAgICBjb25zdCBwcmVzZXQgPSBNQVRDSFVQX1BSRVNFVFNbcHJlc2V0SW5kZXhdID8/IE1BVENIVVBfUFJFU0VUU1swXTsKICAgIC8vIFJ1bGU6IDF2MCBzdGlsbCBzcGF3bnMgMSB2ZWhpY2xlIHBlciBzaWRlIChwcmFjdGljZSArIHRvb2xpbmcgY29uc2lzdGVuY3kpLgogICAgY29uc3QgZGVzaXJlZFRlYW0xID0gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcihwcmVzZXQubGVmdFBsYXllcnMpKTsKICAgIGNvbnN0IGRlc2lyZWRUZWFtMiA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IocHJlc2V0LnJpZ2h0UGxheWVycykpOwogICAgcmV0dXJuIHsgdGVhbTE6IGRlc2lyZWRUZWFtMSwgdGVhbTI6IGRlc2lyZWRUZWFtMiB9Owp9CgovLyBUb2dnbGVzIHNsb3QgZW5hYmxlZCBzdGF0ZTsgYnVtcHMgdG9rZW4gdG8gY2FuY2VsIHBlbmRpbmcgd2FpdHMuCi8vIFJldHVybnMgdHJ1ZSBvbmx5IHdoZW4gZW5hYmxpbmcgYSBzbG90IHRoYXQgaGFzIG5vIHRyYWNrZWQgdmVoaWNsZSAobmVlZHMgc3Bhd24pLgpmdW5jdGlvbiBzZXRTcGF3bmVyU2xvdEVuYWJsZWQoc2xvdEluZGV4OiBudW1iZXIsIGVuYWJsZWQ6IGJvb2xlYW4pOiBib29sZWFuIHsKICAgIGNvbnN0IHNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1tzbG90SW5kZXhdOwogICAgaWYgKHNsb3QuZW5hYmxlZCA9PT0gZW5hYmxlZCkgcmV0dXJuIGZhbHNlOwogICAgc2xvdC5lbmFibGVkID0gZW5hYmxlZDsKICAgIHNsb3QuZW5hYmxlVG9rZW4gKz0gMTsKICAgIHNsb3QuZXhwZWN0aW5nU3Bhd24gPSBmYWxzZTsKICAgIGlmICghZW5hYmxlZCkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHNsb3QudmVoaWNsZUlkID09PSAtMTsKfQoKLy8gQXBwbGllcyBtYXRjaHVwIC0+IGRlc2lyZWQgc2xvdCBjb3VudHMsIGluIHNsb3ROdW1iZXIgb3JkZXIsIGFuZCBxdWV1ZXMgc2VxdWVudGlhbCBzcGF3bnMgZm9yIG5ldyBzbG90cy4KZnVuY3Rpb24gYXBwbHlTcGF3bmVyRW5hYmxlbWVudEZvck1hdGNodXAocHJlc2V0SW5kZXg6IG51bWJlciwgc3Bhd25PbkVuYWJsZTogYm9vbGVhbik6IHZvaWQgewogICAgaWYgKGlzUm91bmRMaXZlKCkpIHJldHVybjsKCiAgICBjb25zdCBkZXNpcmVkID0gZ2V0RGVzaXJlZFNwYXduZXJDb3VudHNGb3JQcmVzZXQocHJlc2V0SW5kZXgpOwogICAgY29uc3QgdGVhbTFTbG90SW5kaWNlczogbnVtYmVyW10gPSBbXTsKICAgIGNvbnN0IHRlYW0yU2xvdEluZGljZXM6IG51bWJlcltdID0gW107CiAgICBjb25zdCBzcGF3blF1ZXVlOiBudW1iZXJbXSA9IFtdOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgU3RhdGUudmVoaWNsZXMuc2xvdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbaV07CiAgICAgICAgaWYgKHNsb3QudGVhbUlkID09PSBUZWFtSUQuVGVhbTEpIHRlYW0xU2xvdEluZGljZXMucHVzaChpKTsKICAgICAgICBlbHNlIGlmIChzbG90LnRlYW1JZCA9PT0gVGVhbUlELlRlYW0yKSB0ZWFtMlNsb3RJbmRpY2VzLnB1c2goaSk7CiAgICB9CgogICAgLy8gRW5hYmxlbWVudCBvcmRlciBpcyBkcml2ZW4gYnkgc2xvdE51bWJlciwgbm90IGFycmF5IG9yZGVyLgogICAgdGVhbTFTbG90SW5kaWNlcy5zb3J0KChhLCBiKSA9PiBTdGF0ZS52ZWhpY2xlcy5zbG90c1thXS5zbG90TnVtYmVyIC0gU3RhdGUudmVoaWNsZXMuc2xvdHNbYl0uc2xvdE51bWJlcik7CiAgICB0ZWFtMlNsb3RJbmRpY2VzLnNvcnQoKGEsIGIpID0+IFN0YXRlLnZlaGljbGVzLnNsb3RzW2FdLnNsb3ROdW1iZXIgLSBTdGF0ZS52ZWhpY2xlcy5zbG90c1tiXS5zbG90TnVtYmVyKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRlYW0xU2xvdEluZGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBzbG90SW5kZXggPSB0ZWFtMVNsb3RJbmRpY2VzW2ldOwogICAgICAgIGNvbnN0IHNob3VsZEVuYWJsZSA9IGkgPCBkZXNpcmVkLnRlYW0xOwogICAgICAgIGNvbnN0IHNob3VsZFNwYXduID0gc2V0U3Bhd25lclNsb3RFbmFibGVkKHNsb3RJbmRleCwgc2hvdWxkRW5hYmxlKTsKICAgICAgICBpZiAoc3Bhd25PbkVuYWJsZSAmJiBzaG91bGRTcGF3bikgc3Bhd25RdWV1ZS5wdXNoKHNsb3RJbmRleCk7CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZWFtMlNsb3RJbmRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2xvdEluZGV4ID0gdGVhbTJTbG90SW5kaWNlc1tpXTsKICAgICAgICBjb25zdCBzaG91bGRFbmFibGUgPSBpIDwgZGVzaXJlZC50ZWFtMjsKICAgICAgICBjb25zdCBzaG91bGRTcGF3biA9IHNldFNwYXduZXJTbG90RW5hYmxlZChzbG90SW5kZXgsIHNob3VsZEVuYWJsZSk7CiAgICAgICAgaWYgKHNwYXduT25FbmFibGUgJiYgc2hvdWxkU3Bhd24pIHNwYXduUXVldWUucHVzaChzbG90SW5kZXgpOwogICAgfQoKICAgIGlmIChzcGF3bk9uRW5hYmxlKSB7CiAgICAgICAgLy8gUmUtcXVldWUgYW55IGVuYWJsZWQgYnV0IGVtcHR5IHNsb3RzIHRvIGNvdmVyIHJhcGlkIHByZXNldCBjaGFuZ2VzLgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgU3RhdGUudmVoaWNsZXMuc2xvdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW2ldOwogICAgICAgICAgICBpZiAoIXNsb3QuZW5hYmxlZCkgY29udGludWU7CiAgICAgICAgICAgIGlmIChzbG90LnZlaGljbGVJZCAhPT0gLTEpIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAoc2xvdC5leHBlY3RpbmdTcGF3bikgY29udGludWU7CiAgICAgICAgICAgIHNwYXduUXVldWUucHVzaChpKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gQ2Fubm90IHNwYXduIGluIHBhcmFsbGVsIC0gc3Bhd24gc2VxdWVudGlhbGx5IHRvIGF2b2lkIGNyb3NzLWJpbmRpbmcgd2hlbiBtdWx0aXBsZSBzcGF3bmVycyBmaXJlIGF0IG9uY2UuCiAgICBpZiAoc3Bhd25PbkVuYWJsZSAmJiBzcGF3blF1ZXVlLmxlbmd0aCA+IDApIHsKICAgICAgICBxdWV1ZVNlcXVlbnRpYWxTcGF3bnMoc3Bhd25RdWV1ZSk7CiAgICB9Cn0KCmZ1bmN0aW9uIHF1ZXVlU2VxdWVudGlhbFNwYXducyhzbG90SW5kaWNlczogbnVtYmVyW10pOiB2b2lkIHsKICAgIGlmIChzbG90SW5kaWNlcy5sZW5ndGggPT09IDApIHJldHVybjsKICAgIC8vIFRva2VuIGNhbmNlbHMgYW55IHByaW9yIHNwYXduIHNlcXVlbmNlIGlmIGEgbmV3IG9uZSBpcyBxdWV1ZWQuCiAgICAvLyBDb25zaWRlciBoYXJkZW5pbmc6IElmIGEgc3Bhd24gc2VxdWVuY2Ugc3RhbGxzLCBzcGF3blNlcXVlbmNlSW5Qcm9ncmVzcyBjYW4gcmVtYWluIHRydWUgYW5kIGJsb2NrIG1hdGNodXAgY2hhbmdlcy4KICAgIFN0YXRlLnZlaGljbGVzLnNwYXduU2VxdWVuY2VUb2tlbiArPSAxOwogICAgY29uc3QgdG9rZW4gPSBTdGF0ZS52ZWhpY2xlcy5zcGF3blNlcXVlbmNlVG9rZW47CiAgICBTdGF0ZS52ZWhpY2xlcy5zcGF3blNlcXVlbmNlSW5Qcm9ncmVzcyA9IHRydWU7CiAgICB2b2lkIHJ1blNlcXVlbnRpYWxTcGF3bnMoc2xvdEluZGljZXMsIHRva2VuKTsKfQoKLy8gU3Bhd25zIGVhY2ggc2xvdCBvbmUtYXQtYS10aW1lIHRvIGF2b2lkIHNpbXVsdGFuZW91cyBzcGF3biBjcm9zcy1iaW5kaW5nLgovLyBFeGl0cyBlYXJseSBpZiBhIG5ldyBzZXF1ZW5jZSBzdXBlcnNlZGVzIHRoaXMgb25lICh0b2tlbiBtaXNtYXRjaCkuCmFzeW5jIGZ1bmN0aW9uIHJ1blNlcXVlbnRpYWxTcGF3bnMoc2xvdEluZGljZXM6IG51bWJlcltdLCB0b2tlbjogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7CiAgICAvLyBDb25zaWRlciBoYXJkZW5pbmc6IFRpZ2h0IG1hcHMgYXJlIHZ1bG5lcmFibGUgaWYgYSBkZWxheWVkIHNwYXduIGFycml2ZXMgYWZ0ZXIgdGhlIHRva2VuIHdpbmRvdzsgZmFsbGJhY2sgYmluZGluZyBtYXkgbWlzLWJpbmQuCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNsb3RJbmRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKFN0YXRlLnZlaGljbGVzLnNwYXduU2VxdWVuY2VUb2tlbiAhPT0gdG9rZW4pIHJldHVybjsKICAgICAgICBjb25zdCBzbG90SW5kZXggPSBzbG90SW5kaWNlc1tpXTsKICAgICAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbc2xvdEluZGV4XTsKICAgICAgICBpZiAoIXNsb3QgfHwgIXNsb3QuZW5hYmxlZCB8fCBzbG90LnZlaGljbGVJZCAhPT0gLTEpIGNvbnRpbnVlOwogICAgICAgIGF3YWl0IGZvcmNlU3Bhd25XaXRoUmV0cnkoc2xvdEluZGV4KTsKICAgICAgICBhd2FpdCBtb2QuV2FpdCgwLjMpOwogICAgfQoKICAgIGlmIChTdGF0ZS52ZWhpY2xlcy5zcGF3blNlcXVlbmNlVG9rZW4gPT09IHRva2VuKSB7CiAgICAgICAgU3RhdGUudmVoaWNsZXMuc3Bhd25TZXF1ZW5jZUluUHJvZ3Jlc3MgPSBmYWxzZTsKICAgIH0KfQoKLy8gRm9yY2VzIGEgc3Bhd24gZm9yIGEgc2xvdCwgcG9sbGluZyB1bnRpbCBhIHZlaGljbGUgYmluZHMgb3IgYXR0ZW1wdHMgYXJlIGV4aGF1c3RlZC4KLy8gQWJvcnRzIGlmIHNsb3QgaXMgZGlzYWJsZWQgb3IgdG9rZW4gY2hhbmdlcyBtaWQtYXR0ZW1wdC4KYXN5bmMgZnVuY3Rpb24gZm9yY2VTcGF3bldpdGhSZXRyeShzbG90SW5kZXg6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4gewogICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW3Nsb3RJbmRleF07CiAgICBpZiAoIXNsb3QuZW5hYmxlZCkgcmV0dXJuIGZhbHNlOwogICAgY29uc3QgdG9rZW4gPSBzbG90LmVuYWJsZVRva2VuOwogICAgc2xvdC5leHBlY3RpbmdTcGF3biA9IHRydWU7CiAgICBzbG90LnNwYXduUmVxdWVzdFRva2VuICs9IDE7CiAgICBzbG90LnNwYXduUmVxdWVzdEF0U2Vjb25kcyA9IE1hdGguZmxvb3IobW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKSk7CiAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blNsb3RJbmRleCA9IHNsb3RJbmRleDsKICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduVG9rZW4gPSBzbG90LnNwYXduUmVxdWVzdFRva2VuOwogICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25SZXF1ZXN0ZWRBdFNlY29uZHMgPSBzbG90LnNwYXduUmVxdWVzdEF0U2Vjb25kczsKCiAgICAvLyBSZS1hcHBseSBjb25maWcgYmVmb3JlIGZvcmNpbmcgc3Bhd24gdG8gYXZvaWQgdGhlIGRlZmF1bHQgdmVoaWNsZSB0eXBlLgogICAgY29uZmlndXJlVmVoaWNsZVNwYXduZXIoc2xvdC5zcGF3bmVyLCBzbG90LnZlaGljbGVUeXBlKTsKICAgIGF3YWl0IG1vZC5XYWl0KDApOwoKICAgIGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDwgMjA7IGF0dGVtcHQrKykgewogICAgICAgIGlmICghc2xvdC5lbmFibGVkIHx8IHNsb3QuZW5hYmxlVG9rZW4gIT09IHRva2VuKSB7CiAgICAgICAgICAgIHNsb3QuZXhwZWN0aW5nU3Bhd24gPSBmYWxzZTsKICAgICAgICAgICAgaWYgKFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduU2xvdEluZGV4ID09PSBzbG90SW5kZXggJiYgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25Ub2tlbiA9PT0gc2xvdC5zcGF3blJlcXVlc3RUb2tlbikgewogICAgICAgICAgICAgICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25TbG90SW5kZXggPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blRva2VuID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25SZXF1ZXN0ZWRBdFNlY29uZHMgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBtb2QuRm9yY2VWZWhpY2xlU3Bhd25lclNwYXduKHNsb3Quc3Bhd25lcik7CgogICAgICAgIGlmICghc2xvdC5leHBlY3RpbmdTcGF3biAmJiBzbG90LnZlaGljbGVJZCAhPT0gLTEpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBhd2FpdCBtb2QuV2FpdCgwLjI1KTsKICAgIH0KCiAgICBzbG90LmV4cGVjdGluZ1NwYXduID0gZmFsc2U7CiAgICBpZiAoU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25TbG90SW5kZXggPT09IHNsb3RJbmRleCAmJiBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blRva2VuID09PSBzbG90LnNwYXduUmVxdWVzdFRva2VuKSB7CiAgICAgICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25TbG90SW5kZXggPSB1bmRlZmluZWQ7CiAgICAgICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25Ub2tlbiA9IHVuZGVmaW5lZDsKICAgICAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blJlcXVlc3RlZEF0U2Vjb25kcyA9IHVuZGVmaW5lZDsKICAgIH0KICAgIHJldHVybiBmYWxzZTsKfQoKLy8gU2NoZWR1bGVzIGEgZGVsYXllZCByZXRyeSB3aGVuIHNwYXduIGlzIGJsb2NrZWQ7IHJlY2hlY2tzIHNsb3QvdG9rZW4gYmVmb3JlIHJldHJ5Lgphc3luYyBmdW5jdGlvbiBzY2hlZHVsZUJsb2NrZWRTcGF3blJldHJ5KHNsb3RJbmRleDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7CiAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbc2xvdEluZGV4XTsKICAgIGlmICghc2xvdC5lbmFibGVkKSByZXR1cm47CiAgICBpZiAoc2xvdC5zcGF3blJldHJ5U2NoZWR1bGVkKSByZXR1cm47CiAgICBzbG90LnNwYXduUmV0cnlTY2hlZHVsZWQgPSB0cnVlOwogICAgY29uc3QgdG9rZW4gPSBzbG90LmVuYWJsZVRva2VuOwoKICAgIGF3YWl0IG1vZC5XYWl0KFZFSElDTEVfU1BBV05FUl9SRVNQQVdOX0RFTEFZX1NFQ09ORFMpOwogICAgc2xvdC5zcGF3blJldHJ5U2NoZWR1bGVkID0gZmFsc2U7CgogICAgaWYgKCFzbG90LmVuYWJsZWQgfHwgc2xvdC5lbmFibGVUb2tlbiAhPT0gdG9rZW4pIHJldHVybjsKICAgIGlmIChzbG90LnZlaGljbGVJZCAhPT0gLTEpIHJldHVybjsKCiAgICBjb25zdCB0ZWFtTmFtZUtleSA9IGdldFRlYW1OYW1lS2V5KHNsb3QudGVhbUlkKTsKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICBtb2QuTWVzc2FnZShTVFJfVkVISUNMRV9TUEFXTl9SRVRSWSwgdGVhbU5hbWVLZXksIFZFSElDTEVfU1BBV05FUl9SRVNQQVdOX0RFTEFZX1NFQ09ORFMpLAogICAgICAgIHRydWUsCiAgICAgICAgdW5kZWZpbmVkLAogICAgICAgIFNUUl9WRUhJQ0xFX1NQQVdOX1JFVFJZCiAgICApOwoKICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCBmb3JjZVNwYXduV2l0aFJldHJ5KHNsb3RJbmRleCk7CiAgICBpZiAoIXN1Y2Nlc3MpIHsKICAgICAgICB2b2lkIHNjaGVkdWxlQmxvY2tlZFNwYXduUmV0cnkoc2xvdEluZGV4KTsKICAgIH0KfQoKLy8gV2FpdHMgdGhlIHJlc3Bhd24gZGVsYXksIGNsZWFycyBvbGQgdmVoaWNsZSBtYXBwaW5nLCB0aGVuIHNwYXducyBhIHJlcGxhY2VtZW50LgovLyBUb2tlbi1ndWFyZGVkIHRvIHByZXZlbnQgcmVzcGF3bnMgYWZ0ZXIgZGlzYWJsZS9yZXR1bmUuCmFzeW5jIGZ1bmN0aW9uIHNjaGVkdWxlUmVzcGF3bihzbG90SW5kZXg6IG51bWJlciwgbGFzdFZlaGljbGVJZDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7CiAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbc2xvdEluZGV4XTsKICAgIC8vIExpdmUgcm91bmRzIG5ldmVyIHJlc3Bhd24gdGFua3M7IHJvdW5kLWVuZCBjbGVhbnVwIG93bnMgdGhlIHJlZmlsbC4KICAgIGlmIChpc1JvdW5kTGl2ZSgpKSB7CiAgICAgICAgZGVsZXRlIFN0YXRlLnZlaGljbGVzLnZlaGljbGVUb1Nsb3RbbGFzdFZlaGljbGVJZF07CiAgICAgICAgaWYgKHNsb3QudmVoaWNsZUlkID09PSBsYXN0VmVoaWNsZUlkKSB7CiAgICAgICAgICAgIHNsb3QudmVoaWNsZUlkID0gLTE7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICghc2xvdC5lbmFibGVkKSB7CiAgICAgICAgZGVsZXRlIFN0YXRlLnZlaGljbGVzLnZlaGljbGVUb1Nsb3RbbGFzdFZlaGljbGVJZF07CiAgICAgICAgaWYgKHNsb3QudmVoaWNsZUlkID09PSBsYXN0VmVoaWNsZUlkKSB7CiAgICAgICAgICAgIHNsb3QudmVoaWNsZUlkID0gLTE7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgIH0KICAgIC8vIEd1YXJkIGFnYWluc3Qgb3ZlcmxhcHBpbmcgcmVzcGF3biB0aW1lcnMgZm9yIHRoZSBzYW1lIHNsb3QuCiAgICBpZiAoc2xvdC5yZXNwYXduUnVubmluZykgcmV0dXJuOwoKICAgIHNsb3QucmVzcGF3blJ1bm5pbmcgPSB0cnVlOwogICAgY29uc3QgdG9rZW4gPSBzbG90LmVuYWJsZVRva2VuOwogICAgYXdhaXQgbW9kLldhaXQoVkVISUNMRV9TUEFXTkVSX1JFU1BBV05fREVMQVlfU0VDT05EUyk7CgogICAgaWYgKCFzbG90LmVuYWJsZWQgfHwgc2xvdC5lbmFibGVUb2tlbiAhPT0gdG9rZW4pIHsKICAgICAgICBzbG90LnJlc3Bhd25SdW5uaW5nID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGRlbGV0ZSBTdGF0ZS52ZWhpY2xlcy52ZWhpY2xlVG9TbG90W2xhc3RWZWhpY2xlSWRdOwogICAgc2xvdC52ZWhpY2xlSWQgPSAtMTsKCiAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgZm9yY2VTcGF3bldpdGhSZXRyeShzbG90SW5kZXgpOwogICAgaWYgKCFzdWNjZXNzKSB7CiAgICAgICAgdm9pZCBzY2hlZHVsZUJsb2NrZWRTcGF3blJldHJ5KHNsb3RJbmRleCk7CiAgICB9CiAgICBzbG90LnJlc3Bhd25SdW5uaW5nID0gZmFsc2U7Cn0KCi8vIFBlcmlvZGljYWxseSB2ZXJpZmllcyB0cmFja2VkIHZlaGljbGVzIHN0aWxsIGV4aXN0OyBpZiBtaXNzaW5nLCB0cmlnZ2VycyByZXNwYXduLgphc3luYyBmdW5jdGlvbiBwb2xsVmVoaWNsZVNwYXduZXJTbG90cygpOiBQcm9taXNlPHZvaWQ+IHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgYXdhaXQgbW9kLldhaXQoVkVISUNMRV9TUEFXTkVSX1BPTExfSU5URVJWQUxfU0VDT05EUyk7CiAgICAgICAgLy8gUGF1c2Ugc3Bhd25lciBtYWludGVuYW5jZSBkdXJpbmcgY2xlYW51cCB0byBhdm9pZCBsYXRlIHJlc3Bhd25zL2JpbmRzLgogICAgICAgIGlmIChTdGF0ZS5yb3VuZC5mbG93LmNsZWFudXBBY3RpdmUpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1tpXTsKICAgICAgICAgICAgaWYgKHNsb3QudmVoaWNsZUlkID09PSAtMSkgY29udGludWU7CgogICAgICAgICAgICBjb25zdCB2ZWhpY2xlID0gZmluZFZlaGljbGVCeUlkKHNsb3QudmVoaWNsZUlkKTsKICAgICAgICAgICAgaWYgKCF2ZWhpY2xlKSB7CiAgICAgICAgICAgICAgICBjb25zdCBvbGRJZCA9IHNsb3QudmVoaWNsZUlkOwogICAgICAgICAgICAgICAgc2xvdC52ZWhpY2xlSWQgPSAtMTsKICAgICAgICAgICAgICAgIC8vIFNsb3QgdHJhY2tpbmcgaXMgZm9yIHJlc3Bhd24vYmluZGluZyBvbmx5OyBzY29yaW5nIHVzZXMgdGhlIHJlZ2lzdHJ5IGFycmF5cy4KICAgICAgICAgICAgICAgIC8vIFZlaGljbGUgbWlzc2luZyBtZWFucyBkZXN0cm95ZWQvdW5zcGF3bmVkOyBzY2hlZHVsZSBhIHJlc3Bhd24gd2hlbiBub3QgbGl2ZS4KICAgICAgICAgICAgICAgIGlmICghaXNSb3VuZExpdmUoKSkgewogICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlUmVzcGF3bihpLCBvbGRJZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKYXN5bmMgZnVuY3Rpb24gYXBwbHlTcGF3bllhd1RvVmVoaWNsZShldmVudFZlaGljbGU6IG1vZC5WZWhpY2xlLCBzbG90OiBWZWhpY2xlU3Bhd25lclNsb3QpOiBQcm9taXNlPHZvaWQ+IHsKICAgIC8vIEVuZm9yY2UgdGhlIGRlc2lyZWQgc3Bhd24geWF3IG9uIHRoZSB2ZWhpY2xlIGFmdGVyIGl0IGV4aXN0cyAobWFwLXNwZWNpZmljIHNwYXduZXIgeWF3IGNhbiBkcmlmdCkuCiAgICBjb25zdCBwb3MgPSBzbG90LnNwYXduUG9zOwogICAgY29uc3QgeWF3RGVnID0gbW9kLllDb21wb25lbnRPZihzbG90LnNwYXduUm90KTsKICAgIGNvbnN0IHlhd1JhZCA9IHlhd0RlZyAqIE1hdGguUEkgLyAxODA7CiAgICBtb2QuVGVsZXBvcnQoZXZlbnRWZWhpY2xlLCBwb3MsIHlhd1JhZCk7CiAgICBhd2FpdCBtb2QuV2FpdCgwKTsKICAgIG1vZC5UZWxlcG9ydChldmVudFZlaGljbGUsIHBvcywgeWF3UmFkKTsKfQoKLy8gQmluZGluZyB1c2VzIG9iamVjdCBwb3NpdGlvbiAobm90IHZlaGljbGUgc3RhdGUpIGJlY2F1c2UgaXQgaXMgc3RhYmxlIGF0IHNwYXduIHRpbWUuCi8vIEZhbGxiYWNrIGJpbmRpbmcgY2FuIG1pcy1hc3NpZ24gb24gdGlnaHQgbWFwcyBpZiBhIHNwYXduIGFycml2ZXMgb3V0c2lkZSB0aGUgdG9rZW4gd2luZG93LgpmdW5jdGlvbiBiaW5kU3Bhd25lZFZlaGljbGVUb1Nsb3QoZXZlbnRWZWhpY2xlOiBtb2QuVmVoaWNsZSwgdmVoaWNsZVBvczogbW9kLlZlY3Rvcik6IFRlYW1JRCB8IDAgewogICAgY29uc3QgdmVoaWNsZU9iaklkID0gZ2V0T2JqSWQoZXZlbnRWZWhpY2xlKTsKCiAgICBjb25zdCBhY3RpdmVJbmRleCA9IFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduU2xvdEluZGV4OwogICAgY29uc3QgYWN0aXZlVG9rZW4gPSBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blRva2VuOwogICAgY29uc3QgYWN0aXZlQXQgPSBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blJlcXVlc3RlZEF0U2Vjb25kczsKICAgIGlmIChhY3RpdmVJbmRleCAhPT0gdW5kZWZpbmVkICYmIGFjdGl2ZVRva2VuICE9PSB1bmRlZmluZWQgJiYgYWN0aXZlQXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnN0IG5vdyA9IE1hdGguZmxvb3IobW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKSk7CiAgICAgICAgY29uc3QgZXhwaXJlZCA9IChub3cgLSBhY3RpdmVBdCkgPiBWRUhJQ0xFX1NQQVdORVJfQklORF9USU1FT1VUX1NFQ09ORFM7CiAgICAgICAgaWYgKCFleHBpcmVkKSB7CiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1thY3RpdmVJbmRleF07CiAgICAgICAgICAgIGlmIChhY3RpdmVTbG90ICYmIGFjdGl2ZVNsb3QuZW5hYmxlZCAmJiBhY3RpdmVTbG90LmV4cGVjdGluZ1NwYXduICYmIGFjdGl2ZVNsb3Quc3Bhd25SZXF1ZXN0VG9rZW4gPT09IGFjdGl2ZVRva2VuKSB7CiAgICAgICAgICAgICAgICBhY3RpdmVTbG90LmV4cGVjdGluZ1NwYXduID0gZmFsc2U7CiAgICAgICAgICAgICAgICBhY3RpdmVTbG90LnZlaGljbGVJZCA9IHZlaGljbGVPYmpJZDsKICAgICAgICAgICAgICAgIGFjdGl2ZVNsb3QucmVzcGF3blJ1bm5pbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGFjdGl2ZVNsb3Quc3Bhd25SZXRyeVNjaGVkdWxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgU3RhdGUudmVoaWNsZXMudmVoaWNsZVRvU2xvdFt2ZWhpY2xlT2JqSWRdID0gYWN0aXZlSW5kZXg7CiAgICAgICAgICAgICAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blNsb3RJbmRleCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduVG9rZW4gPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blJlcXVlc3RlZEF0U2Vjb25kcyA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIHZvaWQgYXBwbHlTcGF3bllhd1RvVmVoaWNsZShldmVudFZlaGljbGUsIGFjdGl2ZVNsb3QpOwogICAgICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZVNsb3QudGVhbUlkOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25TbG90SW5kZXggPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduVG9rZW4gPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduUmVxdWVzdGVkQXRTZWNvbmRzID0gdW5kZWZpbmVkOwogICAgICAgIH0KICAgIH0KCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW2ldOwogICAgICAgIGlmICghc2xvdC5leHBlY3RpbmdTcGF3bikgY29udGludWU7CgogICAgICAgIGNvbnN0IHNwYXduZXJQb3MgPSBtb2QuR2V0T2JqZWN0UG9zaXRpb24oc2xvdC5zcGF3bmVyKTsKICAgICAgICBjb25zdCBkID0gbW9kLkRpc3RhbmNlQmV0d2Vlbih2ZWhpY2xlUG9zLCBzcGF3bmVyUG9zKTsKICAgICAgICBpZiAoZCA8PSBWRUhJQ0xFX1NQQVdORVJfQklORF9ESVNUQU5DRV9NRVRFUlMpIHsKICAgICAgICAgICAgc2xvdC5leHBlY3RpbmdTcGF3biA9IGZhbHNlOwogICAgICAgICAgICBzbG90LnZlaGljbGVJZCA9IHZlaGljbGVPYmpJZDsKICAgICAgICAgICAgc2xvdC5yZXNwYXduUnVubmluZyA9IGZhbHNlOwogICAgICAgICAgICBzbG90LnNwYXduUmV0cnlTY2hlZHVsZWQgPSBmYWxzZTsKICAgICAgICAgICAgU3RhdGUudmVoaWNsZXMudmVoaWNsZVRvU2xvdFt2ZWhpY2xlT2JqSWRdID0gaTsKICAgICAgICAgICAgaWYgKFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduU2xvdEluZGV4ID09PSBpICYmIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduVG9rZW4gPT09IHNsb3Quc3Bhd25SZXF1ZXN0VG9rZW4pIHsKICAgICAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduU2xvdEluZGV4ID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25Ub2tlbiA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduUmVxdWVzdGVkQXRTZWNvbmRzID0gdW5kZWZpbmVkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZvaWQgYXBwbHlTcGF3bllhd1RvVmVoaWNsZShldmVudFZlaGljbGUsIHNsb3QpOwogICAgICAgICAgICByZXR1cm4gc2xvdC50ZWFtSWQ7CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiAwOwp9CgovLyBMb2NhdGVzIHRoZSBmaXJzdCAiZXhwZWN0aW5nU3Bhd24iIHNsb3Qgd2l0aGluIGJpbmQgZGlzdGFuY2Ugb2YgdGhlIHZlaGljbGUgcG9zaXRpb24uCmZ1bmN0aW9uIGZpbmRTcGF3bmVyU2xvdEJ5UG9zaXRpb24oc3Bhd25Qb3M6IG1vZC5WZWN0b3IpOiBudW1iZXIgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBTdGF0ZS52ZWhpY2xlcy5zbG90cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1tpXTsKICAgICAgICBjb25zdCBzcGF3bmVyUG9zID0gbW9kLkdldE9iamVjdFBvc2l0aW9uKHNsb3Quc3Bhd25lcik7CiAgICAgICAgaWYgKG1vZC5EaXN0YW5jZUJldHdlZW4oc3Bhd25Qb3MsIHNwYXduZXJQb3MpIDw9IFZFSElDTEVfU1BBV05FUl9CSU5EX0RJU1RBTkNFX01FVEVSUykgewogICAgICAgICAgICByZXR1cm4gaTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gLTE7Cn0KCi8vIEJvb3RzdHJhcHMgc3Bhd25lcnMgKyBzbG90cywgYXBwbGllcyBjdXJyZW50IG1hdGNodXAgZW5hYmxlbWVudCwgYW5kIHN0YXJ0cyB0aGUgcG9sbGluZyBsb29wLgphc3luYyBmdW5jdGlvbiBzdGFydFZlaGljbGVTcGF3bmVyU3lzdGVtKCk6IFByb21pc2U8dm9pZD4gewogICAgLy8gV0FSTklORzogVGhpcyBzaG91bGQgcnVuIG9uY2UgcGVyIG1hdGNoOyBkdXBsaWNhdGUgcnVucyBjYW4gY3JlYXRlIGV4dHJhIHNwYXduZXJzL3Nsb3RzLgogICAgLy8gRW5zdXJlIG1hcCBjb25maWcgaXMgYXBwbGllZCBiZWZvcmUgYW55IHNwYXduZXJzIGFyZSBjcmVhdGVkIG9yIGZvcmNlZCB0byBzcGF3bi4KICAgIHdoaWxlICghU3RhdGUudmVoaWNsZXMuY29uZmlnUmVhZHkpIHsKICAgICAgICBhd2FpdCBtb2QuV2FpdCgwLjEpOwogICAgfQogICAgYXdhaXQgbW9kLldhaXQoVkVISUNMRV9TUEFXTkVSX1NUQVJUX0RFTEFZX1NFQ09ORFMpOwoKICAgIFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aCA9IDA7CiAgICBTdGF0ZS52ZWhpY2xlcy52ZWhpY2xlVG9TbG90ID0ge307CiAgICBTdGF0ZS52ZWhpY2xlcy5zcGF3blNlcXVlbmNlSW5Qcm9ncmVzcyA9IGZhbHNlOwoKICAgIGNvbnN0IHRlYW0xU3BlY3MgPSBbLi4uVEVBTTFfVkVISUNMRV9TUEFXTl9TUEVDU10uc29ydCgoYSwgYikgPT4gYS5zbG90TnVtYmVyIC0gYi5zbG90TnVtYmVyKTsKICAgIGNvbnN0IHRlYW0yU3BlY3MgPSBbLi4uVEVBTTJfVkVISUNMRV9TUEFXTl9TUEVDU10uc29ydCgoYSwgYikgPT4gYS5zbG90TnVtYmVyIC0gYi5zbG90TnVtYmVyKTsKCiAgICBmb3IgKGNvbnN0IHNwZWMgb2YgdGVhbTFTcGVjcykgewogICAgICAgIGFkZFZlaGljbGVTcGF3bmVyU2xvdChUZWFtSUQuVGVhbTEsIHNwZWMuc2xvdE51bWJlciwgc3BlYy5wb3MsIHNwZWMucm90LCBzcGVjLnZlaGljbGUpOwogICAgfQogICAgZm9yIChjb25zdCBzcGVjIG9mIHRlYW0yU3BlY3MpIHsKICAgICAgICBhZGRWZWhpY2xlU3Bhd25lclNsb3QoVGVhbUlELlRlYW0yLCBzcGVjLnNsb3ROdW1iZXIsIHNwZWMucG9zLCBzcGVjLnJvdCwgc3BlYy52ZWhpY2xlKTsKICAgIH0KCiAgICAvLyBPbmUtdGltZSBjbGVhbnVwOiByZW1vdmUgYW55IGRlZmF1bHQgdmVoaWNsZXMgc2l0dGluZyBvbiBvciBuZWFyIHNwYXduIHBhZHMgYmVmb3JlIGZpcnN0IGZvcmNlZCBzcGF3bnMuCiAgICAvLyBUaGlzIHByZXZlbnRzIGEgZGVmYXVsdCBBYnJhbXMgZnJvbSBwZXJzaXN0aW5nIGlmIGl0IHNwYXduZWQgYmVmb3JlIG91ciBzcGF3bmVycyB3ZXJlIGNvbmZpZ3VyZWQuCiAgICAvLyBLZWVwIHRoaXMgb25lLXNob3QgYW5kIHByZS1yb3VuZCB0byBhdm9pZCBkZWxldGluZyBwbGF5ZXIgdmVoaWNsZXMgbGF0ZXIgaW4gdGhlIG1hdGNoLgogICAgLy8gQ29uc2lkZXIgSGFyZGVuaW5nIHdpdGggYSBzZWNvbmQgY2xlYW51cCBwYXNzIGJlZm9yZSBmaXJzdCBmb3JjZWQgc3Bhd25zIGlmIGRlZmF1bHQgc3Bhd25zIHJlYXBwZWFyIGFmdGVyIGNsZWFudXAKICAgIGlmICghaXNSb3VuZExpdmUoKSAmJiAhU3RhdGUudmVoaWNsZXMuc3RhcnR1cENsZWFudXBEb25lKSB7CiAgICAgICAgY29uc3QgdmVoaWNsZXMgPSBtb2QuQWxsVmVoaWNsZXMoKTsKICAgICAgICBjb25zdCB2Q291bnQgPSBtb2QuQ291bnRPZih2ZWhpY2xlcyk7CiAgICAgICAgZm9yIChsZXQgdiA9IDA7IHYgPCB2Q291bnQ7IHYrKykgewogICAgICAgICAgICBjb25zdCB2ZWhpY2xlID0gbW9kLlZhbHVlSW5BcnJheSh2ZWhpY2xlcywgdikgYXMgbW9kLlZlaGljbGU7CiAgICAgICAgICAgIGlmICghdmVoaWNsZSkgY29udGludWU7CiAgICAgICAgICAgIGNvbnN0IHBvcyA9IG1vZC5HZXRPYmplY3RQb3NpdGlvbih2ZWhpY2xlKTsKICAgICAgICAgICAgbGV0IG5lYXJTcGF3biA9IGZhbHNlOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbaV07CiAgICAgICAgICAgICAgICBpZiAobW9kLkRpc3RhbmNlQmV0d2Vlbihwb3MsIHNsb3Quc3Bhd25Qb3MpIDw9IFZFSElDTEVfU1BBV05FUl9TVEFSVFVQX0NMRUFOVVBfUkFESVVTX01FVEVSUykgewogICAgICAgICAgICAgICAgICAgIG5lYXJTcGF3biA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG5lYXJTcGF3bikgewogICAgICAgICAgICAgICAgbW9kLlVuc3Bhd25PYmplY3QodmVoaWNsZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgU3RhdGUudmVoaWNsZXMuc3RhcnR1cENsZWFudXBEb25lID0gdHJ1ZTsKICAgIH0KCgogICAgLy8gRXh0cmEgc2hvcnQgd2FpdCByZWR1Y2VzIHRoZSBjaGFuY2Ugb2YgYSBkZWZhdWx0IHNwYXduIGFwcGVhcmluZyBhZnRlciBjbGVhbnVwLgogICAgYXdhaXQgbW9kLldhaXQoMC4xKTsKICAgIC8vIEFwcGx5IGVuYWJsZW1lbnQgYmVmb3JlIHNwYXduaW5nIHNvIG9ubHkgdGhlIGRlc2lyZWQgc2xvdHMgY2FuIHNwYXduLgogICAgYXBwbHlTcGF3bmVyRW5hYmxlbWVudEZvck1hdGNodXAoU3RhdGUucm91bmQubWF0Y2h1cFByZXNldEluZGV4LCBmYWxzZSk7CgogICAgLy8gS2ljayBpbml0aWFsIHNwYXducyBzbyBlYWNoIHNsb3QgaGFzIGEgdmVoaWNsZSBib3VuZCBiZWZvcmUgdGhlIHBvbGwgbG9vcCBzdGFydHMuCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKCFTdGF0ZS52ZWhpY2xlcy5zbG90c1tpXS5lbmFibGVkKSBjb250aW51ZTsKICAgICAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgZm9yY2VTcGF3bldpdGhSZXRyeShpKTsKICAgICAgICBpZiAoIXN1Y2Nlc3MpIHsKICAgICAgICAgICAgdm9pZCBzY2hlZHVsZUJsb2NrZWRTcGF3blJldHJ5KGkpOwogICAgICAgIH0KICAgICAgICBhd2FpdCBtb2QuV2FpdCgwLjUpOwogICAgfQoKICAgIC8vIExvbmctcnVubmluZyBwb2xsIGxvb3AgdG8gZGV0ZWN0IG1pc3NpbmcgdmVoaWNsZXMgYW5kIHJlc3Bhd24uCiAgICB2b2lkIHBvbGxWZWhpY2xlU3Bhd25lclNsb3RzKCk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBWZWhpY2xlIFNwYXduZXIgU3lzdGVtIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBLaWxscyBIVUQgU3luYyAoR2FtZU1vZGVTY29yZSAtPiBIVUQpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBzeW5jS2lsbHNIdWRGcm9tVHJhY2tlZFRvdGFscyhfZm9yY2U6IGJvb2xlYW4pOiB2b2lkIHsKICAgIC8vIFRvdGFsIGtpbGxzIGFyZSB0cmFja2VkIGluIHNjcmlwdCB2YXJpYWJsZXM7IEdhbWVNb2RlU2NvcmUgaXMgcmVzZXJ2ZWQgZm9yIG1hdGNoIHdpbnMuCiAgICAvLyBBdm9pZCBIVUQgY3JlYXRpb24vcmVwb3NpdGlvbiBoZXJlOyBvbmx5IHVwZGF0ZSBjYWNoZWQgcmVmcyB0byBwcmV2ZW50IGtpbGwtdGltZSBjcmFzaGVzLgogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCBwaWQgPSBnZXRPYmpJZChwKTsKICAgICAgICBjb25zdCByZWZzID0gU3RhdGUuaHVkQ2FjaGUuaHVkQnlQaWRbcGlkXTsKICAgICAgICBpZiAoIXJlZnMpIGNvbnRpbnVlOwogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMubGVmdEtpbGxzVGV4dCwgU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscyk7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5yaWdodEtpbGxzVGV4dCwgU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscyk7CiAgICB9Cn0KCi8vIFJvdW5kIGtpbGxzIEhVRCBTeW5jIChSb3VuZEtpbGxzIC0+IEhVRCkKZnVuY3Rpb24gc3luY1JvdW5kS2lsbHNIdWQoZm9yY2U6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQgewogICAgaWYgKCFmb3JjZSAmJiBTdGF0ZS5odWRDYWNoZS5sYXN0SHVkUm91bmRLaWxsc1QxID09PSBTdGF0ZS5zY29yZXMudDFSb3VuZEtpbGxzICYmIFN0YXRlLmh1ZENhY2hlLmxhc3RIdWRSb3VuZEtpbGxzVDIgPT09IFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHMpIHJldHVybjsKCiAgICBTdGF0ZS5odWRDYWNoZS5sYXN0SHVkUm91bmRLaWxsc1QxID0gU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxsczsKICAgIFN0YXRlLmh1ZENhY2hlLmxhc3RIdWRSb3VuZEtpbGxzVDIgPSBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzOwoKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHBpZCA9IGdldE9iaklkKHApOwogICAgICAgIGNvbnN0IHJlZnMgPSBTdGF0ZS5odWRDYWNoZS5odWRCeVBpZFtwaWRdOwogICAgICAgIGlmICghcmVmcykgY29udGludWU7CgogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMubGVmdFJvdW5kS2lsbHNUZXh0LCBTdGF0ZS5zY29yZXMudDFSb3VuZEtpbGxzKTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJpZ2h0Um91bmRLaWxsc1RleHQsIFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHMpOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gS2lsbHMgSFVEIFN5bmMgKEdhbWVNb2RlU2NvcmUgLT4gSFVEKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gT3ZlcnRpbWUgRmxhZyBDYXB0dXJlIC0gWm9uZSBDb25maWcgKyBQcmV2aWV3IEljb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIEhpZ2gtbGV2ZWwgZmxvdzoKLy8gLSBNYXAgY29uZmlnIHByb3ZpZGVzIGNhbmRpZGF0ZSB6b25lcyAoQXJlYVRyaWdnZXIgT2JqSWQgKyBTZWN0b3IgSWQgKyBXb3JsZEljb24gT2JqSWQgKyBDYXB0dXJlUG9pbnQgT2JqSWQpLgovLyAtIEF0IGhhbGYtdGltZSByZW1haW5pbmcsIHBpY2sgb25lIHJhbmRvbSB6b25lIGFuZCBtYWtlIGl0IHZpc2libGUgKGxvY2tlZCkuCi8vIC0gQXQgMTowMCByZW1haW5pbmcsIGFjdGl2YXRlIGNhcHR1cmUsIHN0YXJ0IHRoZSB0aWNrIGxvb3AsIGFuZCBzaG93IEhVRC4KLy8gLSBGdWxsIGNhcHR1cmUgZW5kcyB0aGUgcm91bmQgaW1tZWRpYXRlbHk7IGF0IGNsb2NrIGV4cGlyeSwgcHJvZ3Jlc3MgZGVjaWRlcyB1bmxlc3MgbmV1dHJhbCAoMC41KS4KLy8gUHJvZ3Jlc3MgbW9kZWw6Ci8vIC0gcHJvZ3Jlc3MgaW4gWzAuLjFdOiAwID0gVGVhbTIgb3ducywgMSA9IFRlYW0xIG93bnMsIDAuNSA9IG5ldXRyYWwgc3RhcnQuCi8vIC0gY291bnRzIGFyZSB1bmlxdWUgdmVoaWNsZXMgaW4gem9uZSAobm90IHBsYXllciBjb3VudCkuCi8vIC0gcGxheWVyIG1lbWJlcnNoaXAgaXMgdHJhY2tlZCB0byBkcml2ZSBVSSArIHZlaGljbGUgc2VhdCByZWNvbmNpbGlhdGlvbi4KCmZ1bmN0aW9uIG5vcm1hbGl6ZU92ZXJ0aW1lWm9uZUxldHRlcihsZXR0ZXI6IHN0cmluZyk6IHN0cmluZyB7CiAgICByZXR1cm4gbGV0dGVyLnRyaW0oKS50b1VwcGVyQ2FzZSgpOwp9CgpmdW5jdGlvbiBnZXRPdmVydGltZVpvbmVJbmRleEZvckxldHRlcihsZXR0ZXI6IHN0cmluZyk6IG51bWJlciB7CiAgICBjb25zdCBub3JtYWxpemVkID0gbm9ybWFsaXplT3ZlcnRpbWVab25lTGV0dGVyKGxldHRlcik7CiAgICByZXR1cm4gT1ZFUlRJTUVfRkxBR19MRVRURVJTLmluZGV4T2Yobm9ybWFsaXplZCk7Cn0KCmZ1bmN0aW9uIGdldE92ZXJ0aW1lWm9uZUxldHRlcnNGb3JHYW1lTW9kZShnYW1lTW9kZUtleTogbnVtYmVyKTogc3RyaW5nW10gfCB1bmRlZmluZWQgewogICAgY29uc3QgbWFwcGluZyA9IEFDVElWRV9NQVBfQ09ORklHLm92ZXJ0aW1lWm9uZUxldHRlcnNCeU1vZGU7CiAgICBpZiAoIW1hcHBpbmcpIHJldHVybiB1bmRlZmluZWQ7CiAgICBpZiAoaXNIZWxpR2FtZU1vZGUoZ2FtZU1vZGVLZXkpKSB7CiAgICAgICAgcmV0dXJuIChtYXBwaW5nLmhlbGlzICYmIG1hcHBpbmcuaGVsaXMubGVuZ3RoID4gMCkgPyBtYXBwaW5nLmhlbGlzIDogbWFwcGluZy50YW5rczsKICAgIH0KICAgIHJldHVybiAobWFwcGluZy50YW5rcyAmJiBtYXBwaW5nLnRhbmtzLmxlbmd0aCA+IDApID8gbWFwcGluZy50YW5rcyA6IG1hcHBpbmcuaGVsaXM7Cn0KCmZ1bmN0aW9uIGdldENvbmZpcm1lZEdhbWVNb2RlS2V5KCk6IG51bWJlciB7CiAgICByZXR1cm4gU3RhdGUucm91bmQubW9kZUNvbmZpZy5jb25maXJtZWQuZ2FtZU1vZGUgPz8gU3RhdGUucm91bmQubW9kZUNvbmZpZy5nYW1lTW9kZTsKfQoKZnVuY3Rpb24gYnVpbGRPdmVydGltZVpvbmVDYW5kaWRhdGVzRm9yR2FtZU1vZGUoZ2FtZU1vZGVLZXk6IG51bWJlcik6IE92ZXJ0aW1lWm9uZUNhbmRpZGF0ZVtdIHsKICAgIGNvbnN0IHpvbmVzID0gQUNUSVZFX09WRVJUSU1FX1pPTkVTOwogICAgaWYgKCF6b25lcyB8fCB6b25lcy5sZW5ndGggPT09IDApIHJldHVybiBbXTsKICAgIGNvbnN0IGxldHRlcnMgPSBnZXRPdmVydGltZVpvbmVMZXR0ZXJzRm9yR2FtZU1vZGUoZ2FtZU1vZGVLZXkpOwogICAgaWYgKCFsZXR0ZXJzIHx8IGxldHRlcnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHpvbmVzLm1hcCgoem9uZSwgaW5kZXgpID0+ICh7CiAgICAgICAgICAgIGFyZWFUcmlnZ2VyT2JqSWQ6IHpvbmUuYXJlYVRyaWdnZXJPYmpJZCwKICAgICAgICAgICAgc2VjdG9ySWQ6IHpvbmUuc2VjdG9ySWQsCiAgICAgICAgICAgIHdvcmxkSWNvbk9iaklkOiB6b25lLndvcmxkSWNvbk9iaklkLAogICAgICAgICAgICBjYXB0dXJlUG9pbnRPYmpJZDogem9uZS5jYXB0dXJlUG9pbnRPYmpJZCwKICAgICAgICAgICAgbGV0dGVySW5kZXg6IGluZGV4LAogICAgICAgIH0pKTsKICAgIH0KICAgIGNvbnN0IGNhbmRpZGF0ZXM6IE92ZXJ0aW1lWm9uZUNhbmRpZGF0ZVtdID0gW107CiAgICBmb3IgKGNvbnN0IGxldHRlciBvZiBsZXR0ZXJzKSB7CiAgICAgICAgY29uc3QgaW5kZXggPSBnZXRPdmVydGltZVpvbmVJbmRleEZvckxldHRlcihsZXR0ZXIpOwogICAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gem9uZXMubGVuZ3RoKSBjb250aW51ZTsKICAgICAgICBjb25zdCB6b25lID0gem9uZXNbaW5kZXhdOwogICAgICAgIGNhbmRpZGF0ZXMucHVzaCh7CiAgICAgICAgICAgIGFyZWFUcmlnZ2VyT2JqSWQ6IHpvbmUuYXJlYVRyaWdnZXJPYmpJZCwKICAgICAgICAgICAgc2VjdG9ySWQ6IHpvbmUuc2VjdG9ySWQsCiAgICAgICAgICAgIHdvcmxkSWNvbk9iaklkOiB6b25lLndvcmxkSWNvbk9iaklkLAogICAgICAgICAgICBjYXB0dXJlUG9pbnRPYmpJZDogem9uZS5jYXB0dXJlUG9pbnRPYmpJZCwKICAgICAgICAgICAgbGV0dGVySW5kZXg6IGluZGV4LAogICAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIGNhbmRpZGF0ZXM7Cn0KCmZ1bmN0aW9uIGlzSGVsaXNPdmVydGltZVNpbmdsZVpvbmVNb2RlKCk6IGJvb2xlYW4gewogICAgY29uc3QgZ2FtZU1vZGVLZXkgPSBnZXRDb25maXJtZWRHYW1lTW9kZUtleSgpOwogICAgaWYgKCFpc0hlbGlHYW1lTW9kZShnYW1lTW9kZUtleSkpIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IGxldHRlcnMgPSBnZXRPdmVydGltZVpvbmVMZXR0ZXJzRm9yR2FtZU1vZGUoZ2FtZU1vZGVLZXkpOwogICAgaWYgKCFsZXR0ZXJzIHx8IGxldHRlcnMubGVuZ3RoICE9PSAxKSByZXR1cm4gZmFsc2U7CiAgICByZXR1cm4gbm9ybWFsaXplT3ZlcnRpbWVab25lTGV0dGVyKGxldHRlcnNbMF0pID09PSAiSCI7Cn0KCmZ1bmN0aW9uIHJlZnJlc2hPdmVydGltZVpvbmVzRnJvbU1hcENvbmZpZygpOiB2b2lkIHsKICAgIC8vIFN5bmMgcGVyLW1hcCB6b25lIGxpc3QgaW50byBzdGF0ZTsgem9uZSBvcmRlciBkZWZpbmVzIEEvQi9DLi4uIGxldHRlcnMuCiAgICBoaWRlQWxsT3ZlcnRpbWVab25lTWFya2VycygpOwogICAgY29uc3QgZ2FtZU1vZGVLZXkgPSBnZXRDb25maXJtZWRHYW1lTW9kZUtleSgpOwogICAgU3RhdGUuZmxhZy5jYW5kaWRhdGVab25lcyA9IGJ1aWxkT3ZlcnRpbWVab25lQ2FuZGlkYXRlc0ZvckdhbWVNb2RlKGdhbWVNb2RlS2V5KTsKICAgIFN0YXRlLmZsYWcuY29uZmlnVmFsaWQgPSB2YWxpZGF0ZU92ZXJ0aW1lWm9uZVNwZWNzKFN0YXRlLmZsYWcuY2FuZGlkYXRlWm9uZXMpOwogICAgc2V0T3ZlcnRpbWVTZWN0b3JzRm9yU2VsZWN0ZWQodW5kZWZpbmVkKTsKICAgIHNldE92ZXJ0aW1lQ2FwdHVyZVBvaW50c0ZvclNlbGVjdGVkKHVuZGVmaW5lZCk7CiAgICBjb25maWd1cmVPdmVydGltZUNhcHR1cmVQb2ludFRpbWVzKCk7Cn0KCmZ1bmN0aW9uIHZhbGlkYXRlT3ZlcnRpbWVab25lU3BlY3Moem9uZXM6IE92ZXJ0aW1lWm9uZVNwZWNbXSk6IGJvb2xlYW4gewogICAgLy8gUmVqZWN0IGVtcHR5IGxpc3RzIG9yIGR1cGxpY2F0ZSBpZHMgdG8gYXZvaWQgcmFuZG9taXphdGlvbiBhbWJpZ3VpdHkuCiAgICBpZiAoIXpvbmVzIHx8IHpvbmVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlOwogICAgY29uc3Qgc2VlblRyaWdnZXJzOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPiA9IHt9OwogICAgY29uc3Qgc2VlblNlY3RvcnM6IFJlY29yZDxudW1iZXIsIGJvb2xlYW4+ID0ge307CiAgICBjb25zdCBzZWVuV29ybGRJY29uczogUmVjb3JkPG51bWJlciwgYm9vbGVhbj4gPSB7fTsKICAgIGNvbnN0IHNlZW5DYXB0dXJlUG9pbnRzOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPiA9IHt9OwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB6b25lcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHRyaWdnZXJJZCA9IE1hdGguZmxvb3Ioem9uZXNbaV0uYXJlYVRyaWdnZXJPYmpJZCk7CiAgICAgICAgY29uc3Qgc2VjdG9ySWQgPSBNYXRoLmZsb29yKHpvbmVzW2ldLnNlY3RvcklkKTsKICAgICAgICBjb25zdCB3b3JsZEljb25JZCA9IE1hdGguZmxvb3Ioem9uZXNbaV0ud29ybGRJY29uT2JqSWQpOwogICAgICAgIGNvbnN0IGNhcHR1cmVQb2ludElkID0gTWF0aC5mbG9vcih6b25lc1tpXS5jYXB0dXJlUG9pbnRPYmpJZCk7CiAgICAgICAgaWYgKCFOdW1iZXIuaXNGaW5pdGUodHJpZ2dlcklkKSB8fCAhTnVtYmVyLmlzRmluaXRlKHNlY3RvcklkKSB8fCAhTnVtYmVyLmlzRmluaXRlKHdvcmxkSWNvbklkKSB8fCAhTnVtYmVyLmlzRmluaXRlKGNhcHR1cmVQb2ludElkKSkgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChzZWVuVHJpZ2dlcnNbdHJpZ2dlcklkXSB8fCBzZWVuU2VjdG9yc1tzZWN0b3JJZF0gfHwgc2VlbldvcmxkSWNvbnNbd29ybGRJY29uSWRdIHx8IHNlZW5DYXB0dXJlUG9pbnRzW2NhcHR1cmVQb2ludElkXSkgcmV0dXJuIGZhbHNlOwogICAgICAgIHNlZW5UcmlnZ2Vyc1t0cmlnZ2VySWRdID0gdHJ1ZTsKICAgICAgICBzZWVuU2VjdG9yc1tzZWN0b3JJZF0gPSB0cnVlOwogICAgICAgIHNlZW5Xb3JsZEljb25zW3dvcmxkSWNvbklkXSA9IHRydWU7CiAgICAgICAgc2VlbkNhcHR1cmVQb2ludHNbY2FwdHVyZVBvaW50SWRdID0gdHJ1ZTsKICAgIH0KICAgIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBidWlsZFBvcnRhbE51bWJlckFycmF5KHZhbHVlczogbnVtYmVyW10pOiBhbnkgewogICAgLy8gbW9kLlJhbmRvbVZhbHVlSW5BcnJheSByZXF1aXJlcyBhIFBvcnRhbCBhcnJheSwgbm90IGEgSlMgbnVtYmVyW10uCiAgICBsZXQgYXJyID0gbW9kLkVtcHR5QXJyYXkoKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgYXJyID0gbW9kLkFwcGVuZFRvQXJyYXkoYXJyLCB2YWx1ZXNbaV0pOwogICAgfQogICAgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gZ2V0T3ZlcnRpbWVGbGFnTGV0dGVyS2V5Rm9ySW5kZXgoaW5kZXg6IG51bWJlcik6IG51bWJlciB7CiAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IFNUUl9GTEFHX0xFVFRFUl9LRVlTLmxlbmd0aCkgcmV0dXJuIFNUUl9GTEFHX0xFVFRFUl9VTktOT1dOOwogICAgcmV0dXJuIFNUUl9GTEFHX0xFVFRFUl9LRVlTW2luZGV4XTsKfQoKZnVuY3Rpb24gZ2V0T3ZlcnRpbWVGbGFnTGV0dGVySW5kZXhGb3JDYW5kaWRhdGUoY2FuZGlkYXRlSW5kZXg6IG51bWJlciB8IHVuZGVmaW5lZCk6IG51bWJlciB8IHVuZGVmaW5lZCB7CiAgICBpZiAoY2FuZGlkYXRlSW5kZXggPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIGNvbnN0IHpvbmUgPSBTdGF0ZS5mbGFnLmNhbmRpZGF0ZVpvbmVzW2NhbmRpZGF0ZUluZGV4XTsKICAgIGlmICghem9uZSkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIGNvbnN0IGxldHRlckluZGV4ID0gKHpvbmUgYXMgT3ZlcnRpbWVab25lQ2FuZGlkYXRlKS5sZXR0ZXJJbmRleDsKICAgIGlmIChsZXR0ZXJJbmRleCA9PT0gdW5kZWZpbmVkIHx8ICFOdW1iZXIuaXNGaW5pdGUobGV0dGVySW5kZXgpKSByZXR1cm4gY2FuZGlkYXRlSW5kZXg7CiAgICByZXR1cm4gTWF0aC5mbG9vcihsZXR0ZXJJbmRleCk7Cn0KCmZ1bmN0aW9uIGdldE92ZXJ0aW1lRmxhZ0xldHRlcktleUZvckNhbmRpZGF0ZUluZGV4KGNhbmRpZGF0ZUluZGV4OiBudW1iZXIgfCB1bmRlZmluZWQpOiBudW1iZXIgewogICAgY29uc3QgbGV0dGVySW5kZXggPSBnZXRPdmVydGltZUZsYWdMZXR0ZXJJbmRleEZvckNhbmRpZGF0ZShjYW5kaWRhdGVJbmRleCk7CiAgICBpZiAobGV0dGVySW5kZXggPT09IHVuZGVmaW5lZCkgcmV0dXJuIFNUUl9GTEFHX0xFVFRFUl9VTktOT1dOOwogICAgcmV0dXJuIGdldE92ZXJ0aW1lRmxhZ0xldHRlcktleUZvckluZGV4KGxldHRlckluZGV4KTsKfQoKZnVuY3Rpb24gZ2V0QWN0aXZlT3ZlcnRpbWVGbGFnTGV0dGVyS2V5KCk6IG51bWJlciB7CiAgICBpZiAoU3RhdGUuZmxhZy5zZWxlY3RlZFpvbmVMZXR0ZXJLZXkgIT09IHVuZGVmaW5lZCkgcmV0dXJuIFN0YXRlLmZsYWcuc2VsZWN0ZWRab25lTGV0dGVyS2V5OwogICAgaWYgKFN0YXRlLmZsYWcuYWN0aXZlQ2FuZGlkYXRlSW5kZXggPT09IHVuZGVmaW5lZCkgcmV0dXJuIFNUUl9GTEFHX0xFVFRFUl9VTktOT1dOOwogICAgcmV0dXJuIGdldE92ZXJ0aW1lRmxhZ0xldHRlcktleUZvckNhbmRpZGF0ZUluZGV4KFN0YXRlLmZsYWcuYWN0aXZlQ2FuZGlkYXRlSW5kZXgpOwp9CgpmdW5jdGlvbiBnZXRPdmVydGltZUZsYWdMZXR0ZXJUZXh0Rm9ySW5kZXgoaW5kZXg6IG51bWJlciB8IHVuZGVmaW5lZCk6IHN0cmluZyB7CiAgICBpZiAoaW5kZXggPT09IHVuZGVmaW5lZCB8fCBpbmRleCA8IDAgfHwgaW5kZXggPj0gU1RSX0ZMQUdfTEVUVEVSX0tFWVMubGVuZ3RoKSByZXR1cm4gIj8iOwogICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoNjUgKyBpbmRleCk7Cn0KCmZ1bmN0aW9uIGdldE92ZXJ0aW1lRmxhZ0xldHRlclRleHRGb3JDYW5kaWRhdGVJbmRleChjYW5kaWRhdGVJbmRleDogbnVtYmVyIHwgdW5kZWZpbmVkKTogc3RyaW5nIHsKICAgIGNvbnN0IGxldHRlckluZGV4ID0gZ2V0T3ZlcnRpbWVGbGFnTGV0dGVySW5kZXhGb3JDYW5kaWRhdGUoY2FuZGlkYXRlSW5kZXgpOwogICAgaWYgKGxldHRlckluZGV4ID09PSB1bmRlZmluZWQgfHwgbGV0dGVySW5kZXggPCAwIHx8IGxldHRlckluZGV4ID49IFNUUl9GTEFHX0xFVFRFUl9LRVlTLmxlbmd0aCkgcmV0dXJuICI/IjsKICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKDY1ICsgbGV0dGVySW5kZXgpOwp9CgpmdW5jdGlvbiBnZXRBY3RpdmVPdmVydGltZUZsYWdMZXR0ZXJUZXh0KCk6IHN0cmluZyB7CiAgICBpZiAoU3RhdGUuZmxhZy5hY3RpdmVDYW5kaWRhdGVJbmRleCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gIj8iOwogICAgcmV0dXJuIGdldE92ZXJ0aW1lRmxhZ0xldHRlclRleHRGb3JDYW5kaWRhdGVJbmRleChTdGF0ZS5mbGFnLmFjdGl2ZUNhbmRpZGF0ZUluZGV4KTsKfQoKZnVuY3Rpb24gaGlkZU92ZXJ0aW1lRmxhZ1ByZXZpZXdJY29uKCk6IHZvaWQgewogICAgY29uc3Qgem9uZXMgPSBTdGF0ZS5mbGFnLmNhbmRpZGF0ZVpvbmVzOwogICAgaWYgKCF6b25lcyB8fCB6b25lcy5sZW5ndGggPT09IDApIHJldHVybjsKICAgIC8vIERpc2FibGUgYWxsIG92ZXJ0aW1lIHdvcmxkIGljb25zIHNvIG9ubHkgdGhlIGFjdGl2ZSB6b25lIGNhbiBiZSBzaG93bi4KICAgIGZvciAobGV0IGkgPSAwOyBpIDwgem9uZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBpY29uID0gbW9kLkdldFdvcmxkSWNvbih6b25lc1tpXS53b3JsZEljb25PYmpJZCk7CiAgICAgICAgICAgIGlmICghaWNvbikgY29udGludWU7CiAgICAgICAgICAgIG1vZC5FbmFibGVXb3JsZEljb25JbWFnZShpY29uLCBmYWxzZSk7CiAgICAgICAgICAgIG1vZC5FbmFibGVXb3JsZEljb25UZXh0KGljb24sIGZhbHNlKTsKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgfQp9CgovLyBUT0RPKDEuMCk6IFVudXNlZDsgcmVtb3ZlIGJlZm9yZSBmaW5hbCAxLjAgcmVsZWFzZS4KZnVuY3Rpb24gZ2V0QWN0aXZlT3ZlcnRpbWVBcmVhVHJpZ2dlcigpOiBtb2QuQXJlYVRyaWdnZXIgfCB1bmRlZmluZWQgewogICAgaWYgKFN0YXRlLmZsYWcuYWN0aXZlQXJlYVRyaWdnZXIpIHJldHVybiBTdGF0ZS5mbGFnLmFjdGl2ZUFyZWFUcmlnZ2VyOwogICAgaWYgKFN0YXRlLmZsYWcuYWN0aXZlQXJlYVRyaWdnZXJJZCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdW5kZWZpbmVkOwogICAgY29uc3QgdHJpZ2dlciA9IG1vZC5HZXRBcmVhVHJpZ2dlcihTdGF0ZS5mbGFnLmFjdGl2ZUFyZWFUcmlnZ2VySWQpOwogICAgU3RhdGUuZmxhZy5hY3RpdmVBcmVhVHJpZ2dlciA9IHRyaWdnZXI7CiAgICByZXR1cm4gdHJpZ2dlcjsKfQoKZnVuY3Rpb24gZ2V0QWN0aXZlT3ZlcnRpbWVXb3JsZEljb24oKTogbW9kLldvcmxkSWNvbiB8IHVuZGVmaW5lZCB7CiAgICBpZiAoU3RhdGUuZmxhZy5hY3RpdmVXb3JsZEljb24pIHJldHVybiBTdGF0ZS5mbGFnLmFjdGl2ZVdvcmxkSWNvbjsKICAgIGlmIChTdGF0ZS5mbGFnLmFjdGl2ZVdvcmxkSWNvbklkID09PSB1bmRlZmluZWQpIHJldHVybiB1bmRlZmluZWQ7CiAgICBjb25zdCBpY29uID0gbW9kLkdldFdvcmxkSWNvbihTdGF0ZS5mbGFnLmFjdGl2ZVdvcmxkSWNvbklkKTsKICAgIFN0YXRlLmZsYWcuYWN0aXZlV29ybGRJY29uID0gaWNvbjsKICAgIHJldHVybiBpY29uOwp9CgpmdW5jdGlvbiBzaG93T3ZlcnRpbWVGbGFnUHJldmlld0ljb24oaXNMb2NrZWQ6IGJvb2xlYW4pOiB2b2lkIHsKICAgIGNvbnN0IGljb24gPSBnZXRBY3RpdmVPdmVydGltZVdvcmxkSWNvbigpOwogICAgaWYgKCFpY29uKSByZXR1cm47CgogICAgLy8gTG9ja2VkIHByZXZpZXcgdXNlcyB0aGUgc2VsZWN0ZWQgem9uZSBsZXR0ZXIgZm9yIGNsYXJpdHkuCiAgICBjb25zdCBsZXR0ZXJLZXkgPSBnZXRBY3RpdmVPdmVydGltZUZsYWdMZXR0ZXJLZXkoKTsKICAgIGNvbnN0IGxhYmVsS2V5ID0gaXNMb2NrZWQgPyBTVFJfRkxBR19USVRMRV9MT0NLRURfRk9STUFUIDogU1RSX0ZMQUdfUFJFVklFV19BQ1RJVkU7CgogICAgLy8gRW5zdXJlIG9ubHkgdGhlIHNlbGVjdGVkIHpvbmUgaWNvbiBpcyB2aXNpYmxlLgogICAgaGlkZU92ZXJ0aW1lRmxhZ1ByZXZpZXdJY29uKCk7CgogICAgLy8gV29ybGRJY29uIG9iamVjdHMgYXJlIHBvc2l0aW9uZWQgaW4gdGhlIHNwYXRpYWwgZGF0YTsgd2Ugb25seSB0b2dnbGUgdmlzaWJpbGl0eSArIHRleHQuCiAgICB0cnkgewogICAgICAgIG1vZC5TZXRXb3JsZEljb25JbWFnZShpY29uLCBtb2QuV29ybGRJY29uSW1hZ2VzLkZsYWcpOwogICAgICAgIG1vZC5TZXRXb3JsZEljb25Db2xvcihpY29uLCBPVkVSVElNRV9GTEFHX0lDT05fQ09MT1IpOwogICAgICAgIC8vIE5PVEU6IExvY2tlZCBwcmV2aWV3IHVzZXMgdGhlIHNhbWUgdGl0bGUgZm9ybWF0IGFzIHRoZSBIVUQgZm9yIGNvbnNpc3RlbmN5LgogICAgICAgIGNvbnN0IGxhYmVsTWVzc2FnZSA9IGlzTG9ja2VkCiAgICAgICAgICAgID8gbW9kLk1lc3NhZ2UobGFiZWxLZXksIGxldHRlcktleSwgZ2V0T3ZlcnRpbWVVbmxvY2tTZWNvbmRzKCkpCiAgICAgICAgICAgIDogbW9kLk1lc3NhZ2UobGFiZWxLZXkpOwogICAgICAgIG1vZC5TZXRXb3JsZEljb25UZXh0KGljb24sIGxhYmVsTWVzc2FnZSk7CiAgICAgICAgbW9kLkVuYWJsZVdvcmxkSWNvbkltYWdlKGljb24sIHRydWUpOwogICAgICAgIG1vZC5FbmFibGVXb3JsZEljb25UZXh0KGljb24sIHRydWUpOwogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gT3ZlcnRpbWUgRmxhZyBDYXB0dXJlIC0gWm9uZSBDb25maWcgKyBQcmV2aWV3IEljb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE92ZXJ0aW1lIEZsYWcgQ2FwdHVyZSAtIE1hcmtlciBWaXNpYmlsaXR5ICsgU3VwcHJlc3Npb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIGdldE92ZXJ0aW1lQ2FwdHVyZVBvaW50SWRzKCk6IG51bWJlcltdIHsKICAgIGNvbnN0IHpvbmVzID0gU3RhdGUuZmxhZy5jYW5kaWRhdGVab25lczsKICAgIGlmICghem9uZXMgfHwgem9uZXMubGVuZ3RoID09PSAwKSByZXR1cm4gW107CiAgICBjb25zdCBpZHM6IG51bWJlcltdID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHpvbmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWRzLnB1c2goem9uZXNbaV0uY2FwdHVyZVBvaW50T2JqSWQpOwogICAgfQogICAgcmV0dXJuIGlkczsKfQoKZnVuY3Rpb24gZ2V0QWxsT3ZlcnRpbWVDYXB0dXJlUG9pbnRJZHMoKTogbnVtYmVyW10gewogICAgY29uc3Qgem9uZXMgPSBBQ1RJVkVfT1ZFUlRJTUVfWk9ORVM7CiAgICBpZiAoIXpvbmVzIHx8IHpvbmVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIFtdOwogICAgY29uc3QgaWRzOiBudW1iZXJbXSA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB6b25lcy5sZW5ndGg7IGkrKykgewogICAgICAgIGlkcy5wdXNoKHpvbmVzW2ldLmNhcHR1cmVQb2ludE9iaklkKTsKICAgIH0KICAgIHJldHVybiBpZHM7Cn0KCmZ1bmN0aW9uIHNldE92ZXJ0aW1lQ2FwdHVyZVBvaW50c0ZvckFsbEhpZGRlbigpOiB2b2lkIHsKICAgIGNvbnN0IGlkcyA9IGdldEFsbE92ZXJ0aW1lQ2FwdHVyZVBvaW50SWRzKCk7CiAgICBpZiAoaWRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzZXRPdmVydGltZUNhcHR1cmVQb2ludE1hcmtlclZpc2libGUoaWRzW2ldLCBmYWxzZSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFwcGx5T3ZlcnRpbWVDYXB0dXJlUG9pbnRTdXBwcmVzc2lvbihjcDogbW9kLkNhcHR1cmVQb2ludCk6IHZvaWQgewogICAgLy8gS2VlcCBDYXB0dXJlUG9pbnRzIG1hcmtlci1vbmx5OiBubyBvd25lcnNoaXAgY2hhbmdlLCBubyBkZXBsb3ksIG5vIHByb2dyZXNzLgogICAgbW9kLlNldENhcHR1cmVQb2ludENhcHR1cmluZ1RpbWUoY3AsIE9WRVJUSU1FX0NBUFRVUkVfVElNRV9ESVNBQkxFX1NFQ09ORFMpOwogICAgbW9kLlNldENhcHR1cmVQb2ludE5ldXRyYWxpemF0aW9uVGltZShjcCwgT1ZFUlRJTUVfTkVVVFJBTElaRV9USU1FX0RJU0FCTEVfU0VDT05EUyk7CiAgICBtb2QuU2V0TWF4Q2FwdHVyZU11bHRpcGxpZXIoY3AsIE9WRVJUSU1FX0VOR0lORV9DQVBUVVJFX01BWF9NVUxUSVBMSUVSKTsKICAgIG1vZC5FbmFibGVDYXB0dXJlUG9pbnREZXBsb3lpbmcoY3AsIGZhbHNlKTsKfQoKZnVuY3Rpb24gc2V0T3ZlcnRpbWVDYXB0dXJlUG9pbnRPd25lcihjcDogbW9kLkNhcHR1cmVQb2ludCwgdGVhbUlkOiBUZWFtSUQgfCAwKTogdm9pZCB7CiAgICBtb2QuU2V0Q2FwdHVyZVBvaW50T3duZXIoY3AsIG1vZC5HZXRUZWFtKHRlYW1JZCkpOwp9CgpmdW5jdGlvbiBoYXJkUmVzZXRPdmVydGltZUNhcHR1cmVQb2ludHMoaWRzOiBudW1iZXJbXSk6IHZvaWQgewogICAgLy8gRm9yY2UtY2xlYXIgZW5naW5lIENQIHN0YXRlIHNvIG5vIHByb2dyZXNzIHBlcnNpc3RzIGFjcm9zcyByb3VuZHMuCiAgICBpZiAoaWRzLmxlbmd0aCA+IDApIHsKICAgICAgICBsb2dDYXB0dXJlUG9pbnRWaXNpYmlsaXR5RGVidWcoU1RSX0RFQlVHX0NQX1ZJU19IQVJEX1JFU0VUKTsKICAgIH0KICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgY3AgPSBtb2QuR2V0Q2FwdHVyZVBvaW50KGlkc1tpXSk7CiAgICAgICAgICAgIGlmICghY3ApIGNvbnRpbnVlOwogICAgICAgICAgICBjb25zdCBzcGF0aWFsID0gbW9kLkdldFNwYXRpYWxPYmplY3QoaWRzW2ldKTsKICAgICAgICAgICAgaWYgKCFzcGF0aWFsKSBjb250aW51ZTsKICAgICAgICAgICAgbW9kLkVuYWJsZUdhbWVNb2RlT2JqZWN0aXZlKGNwLCB0cnVlKTsKICAgICAgICAgICAgYXBwbHlPdmVydGltZUNhcHR1cmVQb2ludFN1cHByZXNzaW9uKGNwKTsKICAgICAgICAgICAgc2V0T3ZlcnRpbWVDYXB0dXJlUG9pbnRPd25lcihjcCwgMCk7CiAgICAgICAgICAgIG1vZC5FbmFibGVHYW1lTW9kZU9iamVjdGl2ZShjcCwgZmFsc2UpOwogICAgICAgICAgICBtb2QuRW5hYmxlU3BhdGlhbE9iamVjdChzcGF0aWFsLCBmYWxzZSk7CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gY29uZmlndXJlT3ZlcnRpbWVDYXB0dXJlUG9pbnRUaW1lcygpOiB2b2lkIHsKICAgIC8vIFJlLWFwcGx5IHN1cHByZXNzaW9uIGZvciBldmVyeSBjYW5kaWRhdGUgc28gZW5naW5lIGNhcHR1cmUgbmV2ZXIgYWR2YW5jZXMuCiAgICBjb25zdCBpZHMgPSBnZXRPdmVydGltZUNhcHR1cmVQb2ludElkcygpOwogICAgaWYgKGlkcy5sZW5ndGggPT09IDApIHJldHVybjsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgY3AgPSBtb2QuR2V0Q2FwdHVyZVBvaW50KGlkc1tpXSk7CiAgICAgICAgICAgIGlmICghY3ApIGNvbnRpbnVlOwogICAgICAgICAgICBhcHBseU92ZXJ0aW1lQ2FwdHVyZVBvaW50U3VwcHJlc3Npb24oY3ApOwogICAgICAgICAgICBzZXRPdmVydGltZUNhcHR1cmVQb2ludE93bmVyKGNwLCAwKTsKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBzZXRPdmVydGltZUNhcHR1cmVQb2ludE1hcmtlclZpc2libGUoY2FwdHVyZVBvaW50T2JqSWQ6IG51bWJlciwgdmlzaWJsZTogYm9vbGVhbik6IHZvaWQgewogICAgdHJ5IHsKICAgICAgICBjb25zdCBjcCA9IG1vZC5HZXRDYXB0dXJlUG9pbnQoY2FwdHVyZVBvaW50T2JqSWQpOwogICAgICAgIGlmICghY3ApIHJldHVybjsKICAgICAgICBjb25zdCBzcGF0aWFsID0gbW9kLkdldFNwYXRpYWxPYmplY3QoY2FwdHVyZVBvaW50T2JqSWQpOwogICAgICAgIGlmICghc3BhdGlhbCkgcmV0dXJuOwogICAgICAgIC8vIEFwcGx5IENQIHN0YXRlIGJlZm9yZSB0aGUgZmluYWwgZW5hYmxlL2Rpc2FibGU7IHNldHRlcnMgY2FuIHJlLXJlZ2lzdGVyIHRoZSBvYmplY3RpdmUuCiAgICAgICAgYXBwbHlPdmVydGltZUNhcHR1cmVQb2ludFN1cHByZXNzaW9uKGNwKTsKICAgICAgICBzZXRPdmVydGltZUNhcHR1cmVQb2ludE93bmVyKGNwLCAwKTsKICAgICAgICAvLyBUb2dnbGUgYm90aCBvYmplY3RpdmUgdmlzaWJpbGl0eSBhbmQgdGhlIHNwYXRpYWwgb2JqZWN0IHVzaW5nIHRoZSBjb3JyZWN0IHJ1bnRpbWUgaGFuZGxlLgogICAgICAgIG1vZC5FbmFibGVHYW1lTW9kZU9iamVjdGl2ZShjcCwgdmlzaWJsZSk7CiAgICAgICAgbW9kLkVuYWJsZVNwYXRpYWxPYmplY3Qoc3BhdGlhbCwgdmlzaWJsZSk7CiAgICB9IGNhdGNoIHsKICAgICAgICByZXR1cm47CiAgICB9Cn0KCmZ1bmN0aW9uIHNldE92ZXJ0aW1lQ2FwdHVyZVBvaW50c0ZvclNlbGVjdGVkKHNlbGVjdGVkSWQ/OiBudW1iZXIpOiB2b2lkIHsKICAgIC8vIEVuYWJsZSBvbmx5IHRoZSBzZWxlY3RlZCBDYXB0dXJlUG9pbnQgZm9yIG1pbmltYXAvd29ybGQgbWFya2VyIGRpc3BsYXkuCiAgICBjb25zdCBpZHMgPSBnZXRPdmVydGltZUNhcHR1cmVQb2ludElkcygpOwogICAgaWYgKGlkcy5sZW5ndGggPT09IDApIHJldHVybjsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgZW5hYmxlID0gc2VsZWN0ZWRJZCAhPT0gdW5kZWZpbmVkICYmIGlkc1tpXSA9PT0gc2VsZWN0ZWRJZDsKICAgICAgICBzZXRPdmVydGltZUNhcHR1cmVQb2ludE1hcmtlclZpc2libGUoaWRzW2ldLCBlbmFibGUpOwogICAgfQp9CgpmdW5jdGlvbiBzZXRPdmVydGltZUNhcHR1cmVQb2ludHNGb3JBbGxWaXNpYmxlKCk6IHZvaWQgewogICAgY29uc3QgaWRzID0gZ2V0T3ZlcnRpbWVDYXB0dXJlUG9pbnRJZHMoKTsKICAgIGlmIChpZHMubGVuZ3RoID09PSAwKSByZXR1cm47CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlkcy5sZW5ndGg7IGkrKykgewogICAgICAgIHNldE92ZXJ0aW1lQ2FwdHVyZVBvaW50TWFya2VyVmlzaWJsZShpZHNbaV0sIHRydWUpOwogICAgfQp9CgpmdW5jdGlvbiBzZXRPdmVydGltZVNlY3RvcnNGb3JBbGxWaXNpYmxlKCk6IHZvaWQgewogICAgY29uc3Qgem9uZXMgPSBTdGF0ZS5mbGFnLmNhbmRpZGF0ZVpvbmVzOwogICAgaWYgKCF6b25lcyB8fCB6b25lcy5sZW5ndGggPT09IDApIHJldHVybjsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgem9uZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBzZWN0b3IgPSBtb2QuR2V0U2VjdG9yKHpvbmVzW2ldLnNlY3RvcklkKTsKICAgICAgICAgICAgaWYgKCFzZWN0b3IpIGNvbnRpbnVlOwogICAgICAgICAgICBtb2QuRW5hYmxlR2FtZU1vZGVPYmplY3RpdmUoc2VjdG9yLCB0cnVlKTsKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBzZXRPdmVydGltZVNlY3RvcnNGb3JBbGxIaWRkZW4oKTogdm9pZCB7CiAgICBjb25zdCB6b25lcyA9IEFDVElWRV9PVkVSVElNRV9aT05FUzsKICAgIGlmICghem9uZXMgfHwgem9uZXMubGVuZ3RoID09PSAwKSByZXR1cm47CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHpvbmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3Qgc2VjdG9yID0gbW9kLkdldFNlY3Rvcih6b25lc1tpXS5zZWN0b3JJZCk7CiAgICAgICAgICAgIGlmICghc2VjdG9yKSBjb250aW51ZTsKICAgICAgICAgICAgbW9kLkVuYWJsZUdhbWVNb2RlT2JqZWN0aXZlKHNlY3RvciwgZmFsc2UpOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIGhpZGVBbGxPdmVydGltZVpvbmVNYXJrZXJzKCk6IHZvaWQgewogICAgc2V0T3ZlcnRpbWVTZWN0b3JzRm9yQWxsSGlkZGVuKCk7CiAgICBzZXRPdmVydGltZUNhcHR1cmVQb2ludHNGb3JBbGxIaWRkZW4oKTsKfQoKZnVuY3Rpb24gc2V0T3ZlcnRpbWVBbGxGbGFnVmlzaWJpbGl0eSh2aXNpYmxlOiBib29sZWFuKTogdm9pZCB7CiAgICBpZiAodmlzaWJsZSkgewogICAgICAgIHNldE92ZXJ0aW1lU2VjdG9yc0ZvckFsbFZpc2libGUoKTsKICAgICAgICBzZXRPdmVydGltZUNhcHR1cmVQb2ludHNGb3JBbGxWaXNpYmxlKCk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaGlkZUFsbE92ZXJ0aW1lWm9uZU1hcmtlcnMoKTsKfQoKZnVuY3Rpb24gZ2V0QWN0aXZlT3ZlcnRpbWVDYXB0dXJlUG9pbnQoKTogbW9kLkNhcHR1cmVQb2ludCB8IHVuZGVmaW5lZCB7CiAgICBpZiAoU3RhdGUuZmxhZy5hY3RpdmVDYXB0dXJlUG9pbnQpIHJldHVybiBTdGF0ZS5mbGFnLmFjdGl2ZUNhcHR1cmVQb2ludDsKICAgIGlmIChTdGF0ZS5mbGFnLmFjdGl2ZUNhcHR1cmVQb2ludElkID09PSB1bmRlZmluZWQpIHJldHVybiB1bmRlZmluZWQ7CiAgICBjb25zdCBjcCA9IG1vZC5HZXRDYXB0dXJlUG9pbnQoU3RhdGUuZmxhZy5hY3RpdmVDYXB0dXJlUG9pbnRJZCk7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZUNhcHR1cmVQb2ludCA9IGNwOwogICAgcmV0dXJuIGNwOwp9CgpmdW5jdGlvbiBpc0FjdGl2ZU92ZXJ0aW1lQ2FwdHVyZVBvaW50KGNwOiBtb2QuQ2FwdHVyZVBvaW50KTogYm9vbGVhbiB7CiAgICBjb25zdCBhY3RpdmUgPSBnZXRBY3RpdmVPdmVydGltZUNhcHR1cmVQb2ludCgpOwogICAgaWYgKCFhY3RpdmUpIHJldHVybiBmYWxzZTsKICAgIHJldHVybiBtb2QuRXF1YWxzKGNwLCBhY3RpdmUpOwp9CgpmdW5jdGlvbiBzZXRPdmVydGltZVNlY3RvcnNGb3JTZWxlY3RlZChzZWxlY3RlZElkPzogbnVtYmVyKTogdm9pZCB7CiAgICAvLyBTZWN0b3Igb2JqZWN0aXZlcyBkcml2ZSB0aGUgbWluaW1hcCByYWRpdXMgd2l0aG91dCBlbmFibGluZyBjYXB0dXJlIGxvZ2ljLgogICAgY29uc3Qgem9uZXMgPSBTdGF0ZS5mbGFnLmNhbmRpZGF0ZVpvbmVzOwogICAgaWYgKCF6b25lcyB8fCB6b25lcy5sZW5ndGggPT09IDApIHJldHVybjsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgem9uZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBzZWN0b3IgPSBtb2QuR2V0U2VjdG9yKHpvbmVzW2ldLnNlY3RvcklkKTsKICAgICAgICAgICAgaWYgKCFzZWN0b3IpIGNvbnRpbnVlOwogICAgICAgICAgICBjb25zdCBlbmFibGUgPSBzZWxlY3RlZElkICE9PSB1bmRlZmluZWQgJiYgem9uZXNbaV0uc2VjdG9ySWQgPT09IHNlbGVjdGVkSWQ7CiAgICAgICAgICAgIG1vZC5FbmFibGVHYW1lTW9kZU9iamVjdGl2ZShzZWN0b3IsIGVuYWJsZSk7CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE92ZXJ0aW1lIEZsYWcgQ2FwdHVyZSAtIE1hcmtlciBWaXNpYmlsaXR5ICsgU3VwcHJlc3Npb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEFkbWluIFBhbmVsIC0gVGllLUJyZWFrZXIgKyBMaXZlIFJlc3Bhd24gKyBSb3VuZCBMZW5ndGggSGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gbm9ybWFsaXplVGllQnJlYWtlck1vZGVJbmRleChpbmRleDogbnVtYmVyKTogbnVtYmVyIHsKICAgIGNvbnN0IGNvdW50ID0gQURNSU5fVElFQlJFQUtFUl9NT0RFX09QVElPTlMubGVuZ3RoOwogICAgaWYgKGNvdW50IDw9IDApIHJldHVybiAwOwogICAgY29uc3Qgbm9ybWFsaXplZCA9ICgoTWF0aC5mbG9vcihpbmRleCkgJSBjb3VudCkgKyBjb3VudCkgJSBjb3VudDsKICAgIHJldHVybiBub3JtYWxpemVkOwp9CgpmdW5jdGlvbiBnZXRUaWVCcmVha2VyTW9kZUxhYmVsS2V5KCk6IG51bWJlciB7CiAgICBjb25zdCBpbmRleCA9IG5vcm1hbGl6ZVRpZUJyZWFrZXJNb2RlSW5kZXgoU3RhdGUuYWRtaW4udGllQnJlYWtlck1vZGVJbmRleCk7CiAgICByZXR1cm4gQURNSU5fVElFQlJFQUtFUl9NT0RFX09QVElPTlNbaW5kZXhdOwp9CgpmdW5jdGlvbiBnZXRUaWVCcmVha2VyTW9kZUFjdGlvbktleShpbmRleDogbnVtYmVyKTogbnVtYmVyIHsKICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBub3JtYWxpemVUaWVCcmVha2VyTW9kZUluZGV4KGluZGV4KTsKICAgIHJldHVybiBBRE1JTl9USUVCUkVBS0VSX01PREVfQUNUSU9OX0tFWVNbbm9ybWFsaXplZF07Cn0KCmZ1bmN0aW9uIHN5bmNBZG1pblRpZUJyZWFrZXJNb2RlTGFiZWxGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgbGFiZWxLZXkgPSBnZXRUaWVCcmVha2VyTW9kZUxhYmVsS2V5KCk7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwbGF5ZXIgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChwbGF5ZXIpOwogICAgICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCB8fCBpc1BpZERpc2Nvbm5lY3RlZChwaWQpKSBjb250aW51ZTsKICAgICAgICBjb25zdCBsYWJlbCA9IHNhZmVGaW5kKFVJX0FETUlOX1RJRUJSRUFLRVJfTU9ERV9MQUJFTF9JRCArIHBpZCk7CiAgICAgICAgaWYgKCFsYWJlbCkgY29udGludWU7CiAgICAgICAgc2FmZVNldFVJVGV4dExhYmVsKGxhYmVsLCBtb2QuTWVzc2FnZShsYWJlbEtleSkpOwogICAgfQp9CgpmdW5jdGlvbiBnZXRBZG1pbkxpdmVSZXNwYXduTGFiZWxLZXkoKTogbnVtYmVyIHsKICAgIHJldHVybiBTdGF0ZS5hZG1pbi5saXZlUmVzcGF3bkVuYWJsZWQKICAgICAgICA/IG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmxhYmVscy5saXZlUmVzcGF3bk9uCiAgICAgICAgOiBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5sYWJlbHMubGl2ZVJlc3Bhd25PZmY7Cn0KCmZ1bmN0aW9uIHN5bmNBZG1pbkxpdmVSZXNwYXduTGFiZWxGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgbGFiZWxLZXkgPSBnZXRBZG1pbkxpdmVSZXNwYXduTGFiZWxLZXkoKTsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHBsYXllciA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IGxhYmVsID0gc2FmZUZpbmQoVUlfQURNSU5fTElWRV9SRVNQQVdOX1RFWFRfSUQgKyBwaWQpOwogICAgICAgIGlmICghbGFiZWwpIGNvbnRpbnVlOwogICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbChsYWJlbCwgbW9kLk1lc3NhZ2UobGFiZWxLZXkpKTsKICAgIH0KfQoKZnVuY3Rpb24gY2xhbXBSb3VuZExlbmd0aFNlY29uZHMoc2Vjb25kczogbnVtYmVyKTogbnVtYmVyIHsKICAgIHJldHVybiBNYXRoLm1heChBRE1JTl9ST1VORF9MRU5HVEhfTUlOX1NFQ09ORFMsIE1hdGgubWluKEFETUlOX1JPVU5EX0xFTkdUSF9NQVhfU0VDT05EUywgTWF0aC5mbG9vcihzZWNvbmRzKSkpOwp9CgpmdW5jdGlvbiBnZXRDb25maWd1cmVkUm91bmRMZW5ndGhTZWNvbmRzKCk6IG51bWJlciB7CiAgICByZXR1cm4gY2xhbXBSb3VuZExlbmd0aFNlY29uZHMoU3RhdGUucm91bmQuY2xvY2sucm91bmRMZW5ndGhTZWNvbmRzID8/IFJPVU5EX1NUQVJUX1NFQ09ORFMpOwp9CgovLyBNaXJyb3JzIHRoZSBjb25maWd1cmVkIHJvdW5kIGxlbmd0aCAocHJlLXJvdW5kKSwgbm90IHRoZSBsaXZlIGNvdW50ZG93bi4KZnVuY3Rpb24gc3luY0FkbWluUm91bmRMZW5ndGhMYWJlbEZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBjb25zdCB0b3RhbFNlY29uZHMgPSBnZXRDb25maWd1cmVkUm91bmRMZW5ndGhTZWNvbmRzKCk7CiAgICBjb25zdCB0aW1lID0gZ2V0Q2xvY2tUaW1lUGFydHModG90YWxTZWNvbmRzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHBsYXllciA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IGxhYmVsID0gc2FmZUZpbmQoVUlfQURNSU5fUk9VTkRfTEVOR1RIX0xBQkVMX0lEICsgcGlkKTsKICAgICAgICBpZiAoIWxhYmVsKSBjb250aW51ZTsKICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwoCiAgICAgICAgICAgIGxhYmVsLAogICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5sYWJlbHMucm91bmRMZW5ndGhGb3JtYXQsIHRpbWUubWludXRlcywgdGltZS5zZWNUZW5zLCB0aW1lLnNlY09uZXMpCiAgICAgICAgKTsKICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEFkbWluIFBhbmVsIC0gVGllLUJyZWFrZXIgKyBMaXZlIFJlc3Bhd24gKyBSb3VuZCBMZW5ndGggSGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gT3ZlcnRpbWUgRmxhZyBDYXB0dXJlIC0gU2VsZWN0aW9uICsgT3ZlcnJpZGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBpc1RpZUJyZWFrZXJFbmFibGVkRm9yUm91bmQoKTogYm9vbGVhbiB7CiAgICByZXR1cm4gU3RhdGUuZmxhZy50aWVCcmVha2VyRW5hYmxlZFRoaXNSb3VuZDsKfQoKZnVuY3Rpb24gY29tcHV0ZVRpZUJyZWFrZXJFbmFibGVkRm9yUm91bmQocm91bmROdW1iZXI6IG51bWJlciwgbWF4Um91bmRzOiBudW1iZXIsIG1vZGVJbmRleDogbnVtYmVyKTogYm9vbGVhbiB7CiAgICBjb25zdCBub3JtYWxpemVkID0gbm9ybWFsaXplVGllQnJlYWtlck1vZGVJbmRleChtb2RlSW5kZXgpOwogICAgaWYgKG5vcm1hbGl6ZWQgPT09IDEpIHJldHVybiB0cnVlOyAvLyBBbGwgUm91bmRzCiAgICBpZiAobm9ybWFsaXplZCA9PT0gMikgcmV0dXJuIGZhbHNlOyAvLyBEaXNhYmxlZAogICAgY29uc3QgY3VycmVudFJvdW5kID0gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcihyb3VuZE51bWJlcikpOwogICAgY29uc3Qgcm91bmRNYXggPSBNYXRoLm1heCgxLCBNYXRoLmZsb29yKG1heFJvdW5kcykpOwogICAgcmV0dXJuIGN1cnJlbnRSb3VuZCA+PSByb3VuZE1heDsgLy8gTGFzdCBSb3VuZCBPbmx5Cn0KCmZ1bmN0aW9uIHN5bmNUaWVCcmVha2VyRW5hYmxlZEZvckN1cnJlbnRSb3VuZCgpOiB2b2lkIHsKICAgIFN0YXRlLmZsYWcudGllQnJlYWtlckVuYWJsZWRUaGlzUm91bmQgPSBjb21wdXRlVGllQnJlYWtlckVuYWJsZWRGb3JSb3VuZCgKICAgICAgICBTdGF0ZS5yb3VuZC5jdXJyZW50LAogICAgICAgIFN0YXRlLnJvdW5kLm1heCwKICAgICAgICBTdGF0ZS5hZG1pbi50aWVCcmVha2VyTW9kZUluZGV4CiAgICApOwp9CgpmdW5jdGlvbiByZXNldE92ZXJ0aW1lU2VsZWN0aW9uRm9yT3ZlcnJpZGUoKTogdm9pZCB7CiAgICAvLyBDbGVhcnMgdGhlIGFjdGl2ZSBvdmVydGltZSBzZWxlY3Rpb24gd2l0aG91dCB0b3VjaGluZyBzdGFnZS9hY3RpdmUgZmxhZ3MuCiAgICAvLyBVc2VkIGZvciBhZG1pbiBvdmVycmlkZXMgYmVmb3JlIHRoZSByZXZlYWwgc3RhZ2UuCiAgICBoaWRlT3ZlcnRpbWVGbGFnUHJldmlld0ljb24oKTsKICAgIFN0YXRlLmZsYWcuYWN0aXZlQXJlYVRyaWdnZXJJZCA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLmZsYWcuYWN0aXZlQXJlYVRyaWdnZXIgPSB1bmRlZmluZWQ7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZVNlY3RvcklkID0gdW5kZWZpbmVkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVTZWN0b3IgPSB1bmRlZmluZWQ7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZVdvcmxkSWNvbklkID0gdW5kZWZpbmVkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVXb3JsZEljb24gPSB1bmRlZmluZWQ7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZUNhcHR1cmVQb2ludElkID0gdW5kZWZpbmVkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVDYXB0dXJlUG9pbnQgPSB1bmRlZmluZWQ7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZUNhbmRpZGF0ZUluZGV4ID0gdW5kZWZpbmVkOwogICAgU3RhdGUuZmxhZy5zZWxlY3RlZFpvbmVMZXR0ZXJLZXkgPSB1bmRlZmluZWQ7CiAgICBTdGF0ZS5mbGFnLm93bmVyVGVhbSA9IDA7CiAgICBTdGF0ZS5mbGFnLnByb2dyZXNzID0gMC41OwogICAgU3RhdGUuZmxhZy50MUNvdW50ID0gMDsKICAgIFN0YXRlLmZsYWcudDJDb3VudCA9IDA7CiAgICBTdGF0ZS5mbGFnLnBsYXllcnNJblpvbmVCeVBpZCA9IHt9OwogICAgU3RhdGUuZmxhZy52ZWhpY2xlT2NjdXBhbnRzQnlWaWQgPSB7fTsKICAgIFN0YXRlLmZsYWcudmVoaWNsZVRlYW1CeVZpZCA9IHt9OwogICAgU3RhdGUuZmxhZy5sYXN0VWlTbmFwc2hvdEJ5UGlkID0ge307CiAgICBTdGF0ZS5mbGFnLmxhc3RHbG9iYWxQcm9ncmVzc1BlcmNlbnQgPSAtMTsKICAgIFN0YXRlLmZsYWcubGFzdE1lbWJlcnNoaXBQcnVuZUF0U2Vjb25kcyA9IDA7Cn0KCmZ1bmN0aW9uIHNlbGVjdE92ZXJ0aW1lWm9uZUZvclJvdW5kKCk6IGJvb2xlYW4gewogICAgLy8gU2VsZWN0IG9uY2UgcGVyIHJvdW5kOyB6b25lIG9yZGVyIGRlZmluZXMgQS9CL0MuLi4gbGV0dGVycy4KICAgIGlmICghaXNUaWVCcmVha2VyRW5hYmxlZEZvclJvdW5kKCkpIHJldHVybiBmYWxzZTsKICAgIGlmICghU3RhdGUuZmxhZy5jb25maWdWYWxpZCkgcmV0dXJuIGZhbHNlOwogICAgY29uc3Qgem9uZXMgPSBTdGF0ZS5mbGFnLmNhbmRpZGF0ZVpvbmVzOwogICAgaWYgKHpvbmVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlOwogICAgY29uc3QgY2FuT3ZlcnJpZGUgPSBTdGF0ZS5mbGFnLnN0YWdlIDwgT3ZlcnRpbWVTdGFnZS5WaXNpYmxlOwogICAgY29uc3QgaGFzQWN0aXZlU2VsZWN0aW9uID0gU3RhdGUuZmxhZy5hY3RpdmVBcmVhVHJpZ2dlcklkICE9PSB1bmRlZmluZWQ7CgogICAgY29uc3QgdmFsaWRJbmRpY2VzOiBudW1iZXJbXSA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB6b25lcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHRyaWdnZXIgPSBtb2QuR2V0QXJlYVRyaWdnZXIoem9uZXNbaV0uYXJlYVRyaWdnZXJPYmpJZCk7CiAgICAgICAgY29uc3Qgc2VjdG9yID0gbW9kLkdldFNlY3Rvcih6b25lc1tpXS5zZWN0b3JJZCk7CiAgICAgICAgY29uc3QgaWNvbiA9IG1vZC5HZXRXb3JsZEljb24oem9uZXNbaV0ud29ybGRJY29uT2JqSWQpOwogICAgICAgIGNvbnN0IGNwID0gbW9kLkdldENhcHR1cmVQb2ludCh6b25lc1tpXS5jYXB0dXJlUG9pbnRPYmpJZCk7CiAgICAgICAgaWYgKCF0cmlnZ2VyIHx8ICFzZWN0b3IgfHwgIWljb24gfHwgIWNwKSBjb250aW51ZTsKICAgICAgICB2YWxpZEluZGljZXMucHVzaChpKTsKICAgIH0KCiAgICBpZiAodmFsaWRJbmRpY2VzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIC8vIElmIG5vIHZhbGlkIHpvbmVzIGNhbiBiZSByZXNvbHZlZCwgZGlzYWJsZSBvdmVydGltZSBmb3IgdGhpcyByb3VuZC4KICAgICAgICBTdGF0ZS5mbGFnLmNvbmZpZ1ZhbGlkID0gZmFsc2U7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGxldCBvdmVycmlkZUluZGV4ID0gY2FuT3ZlcnJpZGUgPyBTdGF0ZS5hZG1pbi50aWVCcmVha2VyT3ZlcnJpZGVJbmRleCA6IHVuZGVmaW5lZDsKICAgIGlmIChvdmVycmlkZUluZGV4ICE9PSB1bmRlZmluZWQgJiYgdmFsaWRJbmRpY2VzLmluZGV4T2Yob3ZlcnJpZGVJbmRleCkgPT09IC0xKSB7CiAgICAgICAgU3RhdGUuYWRtaW4udGllQnJlYWtlck92ZXJyaWRlSW5kZXggPSB1bmRlZmluZWQ7CiAgICAgICAgb3ZlcnJpZGVJbmRleCA9IHVuZGVmaW5lZDsKICAgIH0KCiAgICBpZiAoaGFzQWN0aXZlU2VsZWN0aW9uICYmIG92ZXJyaWRlSW5kZXggPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWU7CgogICAgY29uc3QgcG9ydGFsQXJyYXkgPSBidWlsZFBvcnRhbE51bWJlckFycmF5KHZhbGlkSW5kaWNlcyk7CiAgICBjb25zdCBzZWxlY3RlZEluZGV4ID0gb3ZlcnJpZGVJbmRleCAhPT0gdW5kZWZpbmVkID8gb3ZlcnJpZGVJbmRleCA6IChtb2QuUmFuZG9tVmFsdWVJbkFycmF5KHBvcnRhbEFycmF5KSBhcyBudW1iZXIpOwogICAgaWYgKHNlbGVjdGVkSW5kZXggPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlOwogICAgY29uc3Qgc2VsZWN0ZWRab25lID0gem9uZXNbc2VsZWN0ZWRJbmRleF07CgogICAgaWYgKGhhc0FjdGl2ZVNlbGVjdGlvbiAmJiBvdmVycmlkZUluZGV4ICE9PSB1bmRlZmluZWQgJiYgU3RhdGUuZmxhZy5hY3RpdmVDYW5kaWRhdGVJbmRleCAhPT0gc2VsZWN0ZWRJbmRleCkgewogICAgICAgIHJlc2V0T3ZlcnRpbWVTZWxlY3Rpb25Gb3JPdmVycmlkZSgpOwogICAgfQoKICAgIFN0YXRlLmZsYWcuYWN0aXZlQ2FuZGlkYXRlSW5kZXggPSBzZWxlY3RlZEluZGV4OwogICAgU3RhdGUuZmxhZy5zZWxlY3RlZFpvbmVMZXR0ZXJLZXkgPSBnZXRPdmVydGltZUZsYWdMZXR0ZXJLZXlGb3JDYW5kaWRhdGVJbmRleChzZWxlY3RlZEluZGV4KTsKICAgIFN0YXRlLmZsYWcuYWN0aXZlQXJlYVRyaWdnZXJJZCA9IHNlbGVjdGVkWm9uZS5hcmVhVHJpZ2dlck9iaklkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVBcmVhVHJpZ2dlciA9IG1vZC5HZXRBcmVhVHJpZ2dlcihzZWxlY3RlZFpvbmUuYXJlYVRyaWdnZXJPYmpJZCk7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZVNlY3RvcklkID0gc2VsZWN0ZWRab25lLnNlY3RvcklkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVTZWN0b3IgPSBtb2QuR2V0U2VjdG9yKHNlbGVjdGVkWm9uZS5zZWN0b3JJZCk7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZVdvcmxkSWNvbklkID0gc2VsZWN0ZWRab25lLndvcmxkSWNvbk9iaklkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVXb3JsZEljb24gPSBtb2QuR2V0V29ybGRJY29uKHNlbGVjdGVkWm9uZS53b3JsZEljb25PYmpJZCk7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZUNhcHR1cmVQb2ludElkID0gc2VsZWN0ZWRab25lLmNhcHR1cmVQb2ludE9iaklkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVDYXB0dXJlUG9pbnQgPSBtb2QuR2V0Q2FwdHVyZVBvaW50KHNlbGVjdGVkWm9uZS5jYXB0dXJlUG9pbnRPYmpJZCk7CgogICAgaWYgKCFTdGF0ZS5mbGFnLmFjdGl2ZUFyZWFUcmlnZ2VyIHx8ICFTdGF0ZS5mbGFnLmFjdGl2ZVNlY3RvciB8fCAhU3RhdGUuZmxhZy5hY3RpdmVXb3JsZEljb24gfHwgIVN0YXRlLmZsYWcuYWN0aXZlQ2FwdHVyZVBvaW50KSB7CiAgICAgICAgU3RhdGUuZmxhZy5jb25maWdWYWxpZCA9IGZhbHNlOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvLyBUcmFjayBvdmVycmlkZSB1c2FnZSBvbmx5IHdoZW4gaXQgYWN0dWFsbHkgZGljdGF0ZXMgdGhlIHNlbGVjdGlvbi4KICAgIGlmIChvdmVycmlkZUluZGV4ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBTdGF0ZS5mbGFnLm92ZXJyaWRlVXNlZFRoaXNSb3VuZCA9IHRydWU7CiAgICAgICAgU3RhdGUuYWRtaW4udGllQnJlYWtlck92ZXJyaWRlVXNlZCA9IHRydWU7CiAgICB9CgogICAgaWYgKG92ZXJyaWRlSW5kZXggIT09IHVuZGVmaW5lZCkgewogICAgICAgIFN0YXRlLmFkbWluLnRpZUJyZWFrZXJPdmVycmlkZUluZGV4ID0gdW5kZWZpbmVkOwogICAgfQoKICAgIHJldHVybiBTdGF0ZS5mbGFnLmFjdGl2ZUFyZWFUcmlnZ2VySWQgIT09IHVuZGVmaW5lZDsKfQoKLy8gVE9ETygxLjApOiBVbnVzZWQ7IHJlbW92ZSBiZWZvcmUgZmluYWwgMS4wIHJlbGVhc2UuCmZ1bmN0aW9uIGdldEFjdGl2ZU92ZXJ0aW1lU2VjdG9yKCk6IG1vZC5TZWN0b3IgfCB1bmRlZmluZWQgewogICAgaWYgKFN0YXRlLmZsYWcuYWN0aXZlU2VjdG9yKSByZXR1cm4gU3RhdGUuZmxhZy5hY3RpdmVTZWN0b3I7CiAgICBpZiAoU3RhdGUuZmxhZy5hY3RpdmVTZWN0b3JJZCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdW5kZWZpbmVkOwogICAgY29uc3Qgc2VjdG9yID0gbW9kLkdldFNlY3RvcihTdGF0ZS5mbGFnLmFjdGl2ZVNlY3RvcklkKTsKICAgIFN0YXRlLmZsYWcuYWN0aXZlU2VjdG9yID0gc2VjdG9yOwogICAgcmV0dXJuIHNlY3RvcjsKfQoKZnVuY3Rpb24gYXBwbHlBZG1pblRpZUJyZWFrZXJPdmVycmlkZShzZWxlY3RlZEluZGV4OiBudW1iZXIpOiB2b2lkIHsKICAgIGlmICghaXNUaWVCcmVha2VyRW5hYmxlZEZvclJvdW5kKCkpIHJldHVybjsKICAgIGlmICghU3RhdGUuZmxhZy5jb25maWdWYWxpZCkgcmV0dXJuOwogICAgaWYgKFN0YXRlLmZsYWcuc3RhZ2UgPj0gT3ZlcnRpbWVTdGFnZS5WaXNpYmxlKSByZXR1cm47CiAgICBTdGF0ZS5hZG1pbi50aWVCcmVha2VyT3ZlcnJpZGVJbmRleCA9IHNlbGVjdGVkSW5kZXg7CiAgICBpZiAoIWlzUm91bmRMaXZlKCkpIHJldHVybjsKICAgIGNvbnN0IHNlbGVjdGVkID0gc2VsZWN0T3ZlcnRpbWVab25lRm9yUm91bmQoKTsKICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgIFN0YXRlLmZsYWcudHJhY2tpbmdFbmFibGVkID0gdHJ1ZTsKICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE92ZXJ0aW1lIEZsYWcgQ2FwdHVyZSAtIFNlbGVjdGlvbiArIE92ZXJyaWRlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gT3ZlcnRpbWUgRmxhZyBDYXB0dXJlIC0gUmVzZXQgKyBTdGF0ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gcmVzZXRPdmVydGltZUZsYWdTdGF0ZSgpOiB2b2lkIHsKICAgIC8vIENsZWFycyBhbGwgb3ZlcnRpbWUgc3RhdGUgYW5kIGhpZGVzIFVJLiBTYWZlIHRvIGNhbGwgb24gcm91bmQgcmVzZXQvZW5kLgogICAgLy8gUHJvZ3Jlc3MgcmVzZXRzIHRvIG5ldXRyYWwgKDAuNSkgYW5kIHZlaGljbGUgY291bnRzIGFyZSBjbGVhcmVkLgogICAgaGlkZU92ZXJ0aW1lRmxhZ1ByZXZpZXdJY29uKCk7CiAgICBzdG9wT3ZlcnRpbWVDYXB0dXJlTG9vcCgpOwogICAgU3RhdGUuZmxhZy5zdGFnZSA9IE92ZXJ0aW1lU3RhZ2UuTm9uZTsKICAgIFN0YXRlLmZsYWcuYWN0aXZlID0gZmFsc2U7CiAgICBTdGF0ZS5mbGFnLnRyYWNraW5nRW5hYmxlZCA9IGZhbHNlOwogICAgU3RhdGUuZmxhZy51bmxvY2tSZW1pbmRlclNlbnQgPSBmYWxzZTsKICAgIFN0YXRlLmZsYWcub3ZlcnJpZGVVc2VkVGhpc1JvdW5kID0gZmFsc2U7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZUFyZWFUcmlnZ2VySWQgPSB1bmRlZmluZWQ7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZUFyZWFUcmlnZ2VyID0gdW5kZWZpbmVkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVTZWN0b3JJZCA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLmZsYWcuYWN0aXZlU2VjdG9yID0gdW5kZWZpbmVkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVXb3JsZEljb25JZCA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLmZsYWcuYWN0aXZlV29ybGRJY29uID0gdW5kZWZpbmVkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVDYXB0dXJlUG9pbnRJZCA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLmZsYWcuYWN0aXZlQ2FwdHVyZVBvaW50ID0gdW5kZWZpbmVkOwogICAgU3RhdGUuZmxhZy5hY3RpdmVDYW5kaWRhdGVJbmRleCA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLmZsYWcuc2VsZWN0ZWRab25lTGV0dGVyS2V5ID0gdW5kZWZpbmVkOwogICAgU3RhdGUuZmxhZy5vd25lclRlYW0gPSAwOwogICAgU3RhdGUuZmxhZy5wcm9ncmVzcyA9IDAuNTsKICAgIFN0YXRlLmZsYWcudDFDb3VudCA9IDA7CiAgICBTdGF0ZS5mbGFnLnQyQ291bnQgPSAwOwogICAgU3RhdGUuZmxhZy5wbGF5ZXJzSW5ab25lQnlQaWQgPSB7fTsKICAgIFN0YXRlLmZsYWcudmVoaWNsZU9jY3VwYW50c0J5VmlkID0ge307CiAgICBTdGF0ZS5mbGFnLnZlaGljbGVUZWFtQnlWaWQgPSB7fTsKICAgIFN0YXRlLmZsYWcubGFzdFVpU25hcHNob3RCeVBpZCA9IHt9OwogICAgU3RhdGUuZmxhZy5sYXN0R2xvYmFsUHJvZ3Jlc3NQZXJjZW50ID0gLTE7CiAgICBTdGF0ZS5mbGFnLmxhc3RNZW1iZXJzaGlwUHJ1bmVBdFNlY29uZHMgPSAwOwogICAgaGlkZU92ZXJ0aW1lVWlGb3JBbGxQbGF5ZXJzKCk7CiAgICBsb2dDYXB0dXJlUG9pbnRWaXNpYmlsaXR5RGVidWcoU1RSX0RFQlVHX0NQX1ZJU19SRVNFVCk7CiAgICBoaWRlQWxsT3ZlcnRpbWVab25lTWFya2VycygpOwogICAgaGFyZFJlc2V0T3ZlcnRpbWVDYXB0dXJlUG9pbnRzKGdldEFsbE92ZXJ0aW1lQ2FwdHVyZVBvaW50SWRzKCkpOwogICAgY29uZmlndXJlT3ZlcnRpbWVDYXB0dXJlUG9pbnRUaW1lcygpOwp9CgpmdW5jdGlvbiBpc1JvdW5kS2lsbFRhcmdldFJlYWNoZWQoKTogYm9vbGVhbiB7CiAgICAvLyBVc2VkIHRvIHByZXZlbnQgZG91YmxlLWVuZCB3aGVuIGNhcHR1cmUgY29tcGxldGVzIGFmdGVyIGEga2lsbC10YXJnZXQgd2luLgogICAgcmV0dXJuIFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgPj0gU3RhdGUucm91bmQua2lsbHNUYXJnZXQgfHwgU3RhdGUuc2NvcmVzLnQyUm91bmRLaWxscyA+PSBTdGF0ZS5yb3VuZC5raWxsc1RhcmdldDsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE92ZXJ0aW1lIEZsYWcgQ2FwdHVyZSAtIFJlc2V0ICsgU3RhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE92ZXJ0aW1lIEZsYWcgQ2FwdHVyZSAtIFZlaGljbGUgKyBab25lIE1lbWJlcnNoaXAgVHJhY2tpbmcgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIFZlaGljbGUgY291bnRzIGRyaXZlIGNhcHR1cmUgc3BlZWQ7IG9uZSB2ZWhpY2xlID0gb25lIGNhcHR1cmUgdW5pdC4KZnVuY3Rpb24gaW5jcmVtZW50T3ZlcnRpbWVUZWFtVmVoaWNsZUNvdW50KHRlYW1JZDogVGVhbUlEIHwgMCk6IHZvaWQgewogICAgaWYgKHRlYW1JZCA9PT0gVGVhbUlELlRlYW0xKSB7CiAgICAgICAgU3RhdGUuZmxhZy50MUNvdW50ID0gTWF0aC5tYXgoMCwgU3RhdGUuZmxhZy50MUNvdW50ICsgMSk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKHRlYW1JZCA9PT0gVGVhbUlELlRlYW0yKSB7CiAgICAgICAgU3RhdGUuZmxhZy50MkNvdW50ID0gTWF0aC5tYXgoMCwgU3RhdGUuZmxhZy50MkNvdW50ICsgMSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGRlY3JlbWVudE92ZXJ0aW1lVGVhbVZlaGljbGVDb3VudCh0ZWFtSWQ6IFRlYW1JRCB8IDApOiB2b2lkIHsKICAgIGlmICh0ZWFtSWQgPT09IFRlYW1JRC5UZWFtMSkgewogICAgICAgIFN0YXRlLmZsYWcudDFDb3VudCA9IE1hdGgubWF4KDAsIFN0YXRlLmZsYWcudDFDb3VudCAtIDEpOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICh0ZWFtSWQgPT09IFRlYW1JRC5UZWFtMikgewogICAgICAgIFN0YXRlLmZsYWcudDJDb3VudCA9IE1hdGgubWF4KDAsIFN0YXRlLmZsYWcudDJDb3VudCAtIDEpOwogICAgfQp9CgpmdW5jdGlvbiBhZGRPdmVydGltZVZlaGljbGVPY2N1cGFudCh0ZWFtSWQ6IFRlYW1JRCB8IDAsIHZlaGljbGVPYmpJZDogbnVtYmVyKTogdm9pZCB7CiAgICAvLyBPbmUgdmVoaWNsZSA9IG9uZSBjYXB0dXJlIHVuaXQsIHJlZ2FyZGxlc3Mgb2YgaG93IG1hbnkgb2NjdXBhbnRzLgogICAgaWYgKHRlYW1JZCAhPT0gVGVhbUlELlRlYW0xICYmIHRlYW1JZCAhPT0gVGVhbUlELlRlYW0yKSByZXR1cm47CiAgICBjb25zdCBjdXJyZW50ID0gU3RhdGUuZmxhZy52ZWhpY2xlT2NjdXBhbnRzQnlWaWRbdmVoaWNsZU9iaklkXSA/PyAwOwogICAgY29uc3QgcHJpb3JUZWFtID0gU3RhdGUuZmxhZy52ZWhpY2xlVGVhbUJ5VmlkW3ZlaGljbGVPYmpJZF07CiAgICBTdGF0ZS5mbGFnLnZlaGljbGVPY2N1cGFudHNCeVZpZFt2ZWhpY2xlT2JqSWRdID0gY3VycmVudCArIDE7CiAgICBpZiAoY3VycmVudCA9PT0gMCkgewogICAgICAgIFN0YXRlLmZsYWcudmVoaWNsZVRlYW1CeVZpZFt2ZWhpY2xlT2JqSWRdID0gdGVhbUlkOwogICAgICAgIGluY3JlbWVudE92ZXJ0aW1lVGVhbVZlaGljbGVDb3VudCh0ZWFtSWQpOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChwcmlvclRlYW0gJiYgcHJpb3JUZWFtICE9PSB0ZWFtSWQpIHsKICAgICAgICBkZWNyZW1lbnRPdmVydGltZVRlYW1WZWhpY2xlQ291bnQocHJpb3JUZWFtKTsKICAgICAgICBpbmNyZW1lbnRPdmVydGltZVRlYW1WZWhpY2xlQ291bnQodGVhbUlkKTsKICAgICAgICBTdGF0ZS5mbGFnLnZlaGljbGVUZWFtQnlWaWRbdmVoaWNsZU9iaklkXSA9IHRlYW1JZDsKICAgIH0KfQoKZnVuY3Rpb24gcmVtb3ZlT3ZlcnRpbWVWZWhpY2xlT2NjdXBhbnQodmVoaWNsZU9iaklkOiBudW1iZXIpOiB2b2lkIHsKICAgIC8vIFJlbW92ZSB0aGUgdmVoaWNsZSBmcm9tIHRoZSB0ZWFtIHNldCB3aGVuIHRoZSBsYXN0IG9jY3VwYW50IGxlYXZlcy4KICAgIGNvbnN0IGN1cnJlbnQgPSBTdGF0ZS5mbGFnLnZlaGljbGVPY2N1cGFudHNCeVZpZFt2ZWhpY2xlT2JqSWRdOwogICAgaWYgKGN1cnJlbnQgPT09IHVuZGVmaW5lZCkgcmV0dXJuOwogICAgY29uc3QgbmV4dCA9IE1hdGgubWF4KDAsIGN1cnJlbnQgLSAxKTsKICAgIGlmIChuZXh0IDw9IDApIHsKICAgICAgICBkZWxldGUgU3RhdGUuZmxhZy52ZWhpY2xlT2NjdXBhbnRzQnlWaWRbdmVoaWNsZU9iaklkXTsKICAgICAgICBjb25zdCB0ZWFtSWQgPSBTdGF0ZS5mbGFnLnZlaGljbGVUZWFtQnlWaWRbdmVoaWNsZU9iaklkXTsKICAgICAgICBkZWxldGUgU3RhdGUuZmxhZy52ZWhpY2xlVGVhbUJ5VmlkW3ZlaGljbGVPYmpJZF07CiAgICAgICAgZGVjcmVtZW50T3ZlcnRpbWVUZWFtVmVoaWNsZUNvdW50KHRlYW1JZCk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgU3RhdGUuZmxhZy52ZWhpY2xlT2NjdXBhbnRzQnlWaWRbdmVoaWNsZU9iaklkXSA9IG5leHQ7Cn0KCmZ1bmN0aW9uIHN5bmNPdmVydGltZVBsYXllclZlaGljbGVTdGF0ZShwbGF5ZXI6IG1vZC5QbGF5ZXIsIGVudHJ5OiBPdmVydGltZUZsYWdQbGF5ZXJab25lU3RhdGUpOiB2b2lkIHsKICAgIGlmICghcGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXIpKSByZXR1cm47CiAgICAvLyBLZWVwIHZlaGljbGUgbWVtYmVyc2hpcCBhY2N1cmF0ZSBmb3IgaW4tem9uZSBwbGF5ZXJzIHdobyBlbnRlci9leGl0IHZlaGljbGVzLgogICAgLy8gQ2FsbGVycyBvbmx5IGludm9rZSB0aGlzIGZvciBwbGF5ZXJzIGN1cnJlbnRseSB0cmFja2VkIGFzIGluLXpvbmUuCiAgICBjb25zdCBpblZlaGljbGUgPSBzYWZlR2V0U29sZGllclN0YXRlQm9vbChwbGF5ZXIsIG1vZC5Tb2xkaWVyU3RhdGVCb29sLklzSW5WZWhpY2xlKTsKICAgIGlmICghaW5WZWhpY2xlKSB7CiAgICAgICAgaWYgKGVudHJ5LnZlaGljbGVPYmpJZCkgewogICAgICAgICAgICByZW1vdmVPdmVydGltZVZlaGljbGVPY2N1cGFudChlbnRyeS52ZWhpY2xlT2JqSWQpOwogICAgICAgICAgICBlbnRyeS52ZWhpY2xlT2JqSWQgPSAwOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICB9CiAgICBsZXQgdmVoaWNsZTogbW9kLlZlaGljbGUgfCB1bmRlZmluZWQ7CiAgICB0cnkgewogICAgICAgIHZlaGljbGUgPSBtb2QuR2V0VmVoaWNsZUZyb21QbGF5ZXIocGxheWVyKTsKICAgIH0gY2F0Y2ggewogICAgICAgIHZlaGljbGUgPSB1bmRlZmluZWQ7CiAgICB9CiAgICBpZiAoIXZlaGljbGUpIHsKICAgICAgICBpZiAoZW50cnkudmVoaWNsZU9iaklkKSB7CiAgICAgICAgICAgIHJlbW92ZU92ZXJ0aW1lVmVoaWNsZU9jY3VwYW50KGVudHJ5LnZlaGljbGVPYmpJZCk7CiAgICAgICAgICAgIGVudHJ5LnZlaGljbGVPYmpJZCA9IDA7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnN0IHZpZCA9IHNhZmVHZXRPYmpJZCh2ZWhpY2xlKTsKICAgIGlmICh2aWQgPT09IHVuZGVmaW5lZCkgewogICAgICAgIGlmIChlbnRyeS52ZWhpY2xlT2JqSWQpIHsKICAgICAgICAgICAgcmVtb3ZlT3ZlcnRpbWVWZWhpY2xlT2NjdXBhbnQoZW50cnkudmVoaWNsZU9iaklkKTsKICAgICAgICAgICAgZW50cnkudmVoaWNsZU9iaklkID0gMDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKGVudHJ5LnZlaGljbGVPYmpJZCAmJiBlbnRyeS52ZWhpY2xlT2JqSWQgIT09IHZpZCkgewogICAgICAgIHJlbW92ZU92ZXJ0aW1lVmVoaWNsZU9jY3VwYW50KGVudHJ5LnZlaGljbGVPYmpJZCk7CiAgICB9CiAgICBpZiAoZW50cnkudmVoaWNsZU9iaklkICE9PSB2aWQpIHsKICAgICAgICBlbnRyeS52ZWhpY2xlT2JqSWQgPSB2aWQ7CiAgICAgICAgYWRkT3ZlcnRpbWVWZWhpY2xlT2NjdXBhbnQoZW50cnkudGVhbUlkLCB2aWQpOwogICAgfQp9CgpmdW5jdGlvbiBoYW5kbGVPdmVydGltZVBsYXllckVudGVyWm9uZShldmVudFBsYXllcjogbW9kLlBsYXllcik6IHZvaWQgewogICAgdHJ5IHsKICAgICAgICBpZiAoIWV2ZW50UGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChldmVudFBsYXllcikpIHJldHVybjsKICAgICAgICAvLyBBcmVhVHJpZ2dlciBlbnRlciBpcyBzb2xkaWVyLWJhc2VkOyB3ZSBzdGlsbCBnYXRlIGNhcHR1cmUgYnkgdmVoaWNsZSBvY2N1cGFuY3kuCiAgICAgICAgLy8gVHJhY2sgb24tZm9vdCBwbGF5ZXJzIHRvbyBzbyBVSSBjYW4gc2hvdyAidmVoaWNsZSByZXF1aXJlZCIuCiAgICAgICAgaWYgKCFTdGF0ZS5mbGFnLmNvbmZpZ1ZhbGlkKSByZXR1cm47CiAgICAgICAgaWYgKCFpc092ZXJ0aW1lWm9uZVRyYWNraW5nRW5hYmxlZCgpKSByZXR1cm47CiAgICAgICAgaWYgKFN0YXRlLmZsYWcuYWN0aXZlQXJlYVRyaWdnZXJJZCA9PT0gdW5kZWZpbmVkKSByZXR1cm47CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKGV2ZW50UGxheWVyKTsKICAgICAgICBpZiAocGlkID09PSB1bmRlZmluZWQgfHwgaXNQaWREaXNjb25uZWN0ZWQocGlkKSkgcmV0dXJuOwogICAgICAgIGNvbnN0IHRlYW1JZCA9IHNhZmVHZXRUZWFtTnVtYmVyRnJvbVBsYXllcihldmVudFBsYXllcik7CiAgICAgICAgY29uc3QgZW50cnkgPSBTdGF0ZS5mbGFnLnBsYXllcnNJblpvbmVCeVBpZFtwaWRdID8/IHsgcGxheWVyT2JqSWQ6IHBpZCwgdGVhbUlkLCB2ZWhpY2xlT2JqSWQ6IDAgfTsKICAgICAgICBlbnRyeS5wbGF5ZXJPYmpJZCA9IHBpZDsKICAgICAgICBlbnRyeS50ZWFtSWQgPSB0ZWFtSWQ7CiAgICAgICAgU3RhdGUuZmxhZy5wbGF5ZXJzSW5ab25lQnlQaWRbcGlkXSA9IGVudHJ5OwogICAgICAgIHN5bmNPdmVydGltZVBsYXllclZlaGljbGVTdGF0ZShldmVudFBsYXllciwgZW50cnkpOwogICAgICAgIHJlZnJlc2hPdmVydGltZVVpVmlzaWJpbGl0eUZvclBsYXllcihldmVudFBsYXllcik7CiAgICB9IGNhdGNoIHsKICAgICAgICByZXR1cm47CiAgICB9Cn0KCmZ1bmN0aW9uIGhhbmRsZU92ZXJ0aW1lUGxheWVyRXhpdFpvbmUoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIpOiB2b2lkIHsKICAgIHRyeSB7CiAgICAgICAgaWYgKCFldmVudFBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQoZXZlbnRQbGF5ZXIpKSByZXR1cm47CiAgICAgICAgLy8gRHJvcCBtZW1iZXJzaGlwIGFuZCB2ZWhpY2xlIGNvdW50cyB3aGVuIGxlYXZpbmcgdGhlIGNhcHR1cmUgem9uZS4KICAgICAgICAvLyBDbGVhciBzbmFwc2hvdHMgc28gVUkgY2FuIHJlYnVpbGQgY2xlYW5seSBpZiB0aGV5IHJlLWVudGVyLgogICAgICAgIGNvbnN0IHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChldmVudFBsYXllcik7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIHJldHVybjsKICAgICAgICBjb25zdCBlbnRyeSA9IFN0YXRlLmZsYWcucGxheWVyc0luWm9uZUJ5UGlkW3BpZF07CiAgICAgICAgaWYgKCFlbnRyeSkgcmV0dXJuOwogICAgICAgIGlmIChlbnRyeS52ZWhpY2xlT2JqSWQpIHsKICAgICAgICAgICAgcmVtb3ZlT3ZlcnRpbWVWZWhpY2xlT2NjdXBhbnQoZW50cnkudmVoaWNsZU9iaklkKTsKICAgICAgICB9CiAgICAgICAgZGVsZXRlIFN0YXRlLmZsYWcucGxheWVyc0luWm9uZUJ5UGlkW3BpZF07CiAgICAgICAgZGVsZXRlIFN0YXRlLmZsYWcubGFzdFVpU25hcHNob3RCeVBpZFtwaWRdOwogICAgICAgIHJlZnJlc2hPdmVydGltZVVpVmlzaWJpbGl0eUZvclBsYXllcihldmVudFBsYXllcik7CiAgICB9IGNhdGNoIHsKICAgICAgICByZXR1cm47CiAgICB9Cn0KCmZ1bmN0aW9uIGhhbmRsZU92ZXJ0aW1lUGxheWVyTGVhdmVCeUlkKHBsYXllcklkOiBudW1iZXIsIGFsbG93SGFyZERlbGV0ZTogYm9vbGVhbiA9IHRydWUpOiB2b2lkIHsKICAgIC8vIERpc2Nvbm5lY3QgY2xlYW51cCB1c2VzIHBsYXllciBpZCAoZXZlbnROdW1iZXIpLCBub3QgUGxheWVyIG9iamVjdC4KICAgIGNvbnN0IGVudHJ5ID0gU3RhdGUuZmxhZy5wbGF5ZXJzSW5ab25lQnlQaWRbcGxheWVySWRdOwogICAgaWYgKGVudHJ5Py52ZWhpY2xlT2JqSWQpIHsKICAgICAgICByZW1vdmVPdmVydGltZVZlaGljbGVPY2N1cGFudChlbnRyeS52ZWhpY2xlT2JqSWQpOwogICAgfQogICAgZGVsZXRlIFN0YXRlLmZsYWcucGxheWVyc0luWm9uZUJ5UGlkW3BsYXllcklkXTsKICAgIGRlbGV0ZSBTdGF0ZS5mbGFnLmxhc3RVaVNuYXBzaG90QnlQaWRbcGxheWVySWRdOwoKICAgIGlmICghYWxsb3dIYXJkRGVsZXRlKSB7CiAgICAgICAgLy8gVW5kZXBsb3kvZGVhdGggY2xlYW51cDogZG8gTk9UIGRlbGV0ZSB3aWRnZXRzIG1pZC1yb3VuZCB0byBhdm9pZCBlbmdpbmUgaW5zdGFiaWxpdHkuCiAgICAgICAgLy8gSGlkZSArIGRyb3AgcmVmcyBzbyBIVUQgY2FuIGJlIHNhZmVseSByZWJ1aWx0IG9uIG5leHQgcm91bmQvcmVjb25uZWN0LgogICAgICAgIGNvbnN0IHJlZnMgPSBTdGF0ZS5mbGFnLnVpQnlQaWRbcGxheWVySWRdOwogICAgICAgIGlmIChyZWZzPy5yb290KSBzZXRXaWRnZXRWaXNpYmxlKHJlZnMucm9vdCwgZmFsc2UpOwogICAgICAgIGNvbnN0IGdsb2JhbFJlZnMgPSBTdGF0ZS5mbGFnLmdsb2JhbFVpQnlQaWRbcGxheWVySWRdOwogICAgICAgIGlmIChnbG9iYWxSZWZzPy5yb290KSBzZXRXaWRnZXRWaXNpYmxlKGdsb2JhbFJlZnMucm9vdCwgZmFsc2UpOwogICAgICAgIGRyb3BPdmVydGltZVVpUmVmc0ZvclBsYXllcklkKHBsYXllcklkKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGlzUGlkRGlzY29ubmVjdGVkKHBsYXllcklkKSAmJiBzaG91bGREZWZlckRpc2Nvbm5lY3RVaURlbGV0ZXMoKSkgewogICAgICAgIGRyb3BPdmVydGltZVVpUmVmc0ZvclBsYXllcklkKHBsYXllcklkKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBkZWxldGVPdmVydGltZVVpRm9yUGxheWVySWQocGxheWVySWQpOwp9CgpmdW5jdGlvbiBoYW5kbGVPdmVydGltZVBsYXllckVudGVyVmVoaWNsZShldmVudFBsYXllcjogbW9kLlBsYXllciwgZXZlbnRWZWhpY2xlOiBtb2QuVmVoaWNsZSk6IHZvaWQgewogICAgdHJ5IHsKICAgICAgICBpZiAoIWV2ZW50UGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChldmVudFBsYXllcikpIHJldHVybjsKICAgICAgICAvLyBTZWF0IGNoYW5nZXMgaW5zaWRlIHRoZSB6b25lIG11c3QgdXBkYXRlIHZlaGljbGUgb2NjdXBhbmN5LgogICAgICAgIC8vIE5vLW9wIGZvciBwbGF5ZXJzIG5vdCBjdXJyZW50bHkgdHJhY2tlZCBhcyBpbi16b25lLgogICAgICAgIGlmICghU3RhdGUuZmxhZy5jb25maWdWYWxpZCkgcmV0dXJuOwogICAgICAgIGNvbnN0IHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChldmVudFBsYXllcik7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIHJldHVybjsKICAgICAgICBjb25zdCBlbnRyeSA9IFN0YXRlLmZsYWcucGxheWVyc0luWm9uZUJ5UGlkW3BpZF07CiAgICAgICAgaWYgKCFlbnRyeSkgcmV0dXJuOwogICAgICAgIGNvbnN0IHRlYW1JZCA9IHNhZmVHZXRUZWFtTnVtYmVyRnJvbVBsYXllcihldmVudFBsYXllcik7CiAgICAgICAgZW50cnkudGVhbUlkID0gdGVhbUlkOwogICAgICAgIGNvbnN0IHZpZCA9IHNhZmVHZXRPYmpJZChldmVudFZlaGljbGUpOwogICAgICAgIGlmICh2aWQgPT09IHVuZGVmaW5lZCkgcmV0dXJuOwogICAgICAgIGlmIChlbnRyeS52ZWhpY2xlT2JqSWQgJiYgZW50cnkudmVoaWNsZU9iaklkICE9PSB2aWQpIHsKICAgICAgICAgICAgcmVtb3ZlT3ZlcnRpbWVWZWhpY2xlT2NjdXBhbnQoZW50cnkudmVoaWNsZU9iaklkKTsKICAgICAgICB9CiAgICAgICAgaWYgKGVudHJ5LnZlaGljbGVPYmpJZCAhPT0gdmlkKSB7CiAgICAgICAgICAgIGVudHJ5LnZlaGljbGVPYmpJZCA9IHZpZDsKICAgICAgICAgICAgYWRkT3ZlcnRpbWVWZWhpY2xlT2NjdXBhbnQodGVhbUlkLCB2aWQpOwogICAgICAgIH0KICAgICAgICByZWZyZXNoT3ZlcnRpbWVVaVZpc2liaWxpdHlGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIpOwogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuOwogICAgfQp9CgpmdW5jdGlvbiBoYW5kbGVPdmVydGltZVBsYXllckV4aXRWZWhpY2xlKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyLCBldmVudFZlaGljbGU6IG1vZC5WZWhpY2xlKTogdm9pZCB7CiAgICB0cnkgewogICAgICAgIGlmICghZXZlbnRQbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKGV2ZW50UGxheWVyKSkgcmV0dXJuOwogICAgICAgIC8vIEV4aXRpbmcgYSB2ZWhpY2xlIGluc2lkZSB0aGUgem9uZSByZW1vdmVzIHRoYXQgdmVoaWNsZSBmcm9tIGNhcHR1cmUgY291bnRzLgogICAgICAgIC8vIFRoZSBwZXItcGxheWVyIFVJIHdpbGwgc3dpdGNoIHRvIHRoZSAidmVoaWNsZSByZXF1aXJlZCIgaGludC4KICAgICAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQoZXZlbnRQbGF5ZXIpOwogICAgICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCB8fCBpc1BpZERpc2Nvbm5lY3RlZChwaWQpKSByZXR1cm47CiAgICAgICAgY29uc3QgZW50cnkgPSBTdGF0ZS5mbGFnLnBsYXllcnNJblpvbmVCeVBpZFtwaWRdOwogICAgICAgIGlmICghZW50cnkpIHJldHVybjsKICAgICAgICBjb25zdCB2aWQgPSBzYWZlR2V0T2JqSWQoZXZlbnRWZWhpY2xlKTsKICAgICAgICBpZiAodmlkID09PSB1bmRlZmluZWQpIHJldHVybjsKICAgICAgICBpZiAoZW50cnkudmVoaWNsZU9iaklkID09PSB2aWQpIHsKICAgICAgICAgICAgcmVtb3ZlT3ZlcnRpbWVWZWhpY2xlT2NjdXBhbnQodmlkKTsKICAgICAgICAgICAgZW50cnkudmVoaWNsZU9iaklkID0gMDsKICAgICAgICAgICAgZGVsZXRlIFN0YXRlLmZsYWcubGFzdFVpU25hcHNob3RCeVBpZFtwaWRdOwogICAgICAgIH0KICAgICAgICByZWZyZXNoT3ZlcnRpbWVVaVZpc2liaWxpdHlGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIpOwogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuOwogICAgfQp9CgpmdW5jdGlvbiBoYW5kbGVPdmVydGltZVZlaGljbGVEZXN0cm95ZWQoZXZlbnRWZWhpY2xlOiBtb2QuVmVoaWNsZSk6IHZvaWQgewogICAgdHJ5IHsKICAgICAgICAvLyBFbnN1cmUgZGVzdHJveWVkIHZlaGljbGVzIGFyZSByZW1vdmVkIGZyb20gY2FwdHVyZSBjb3VudHMgdG8gYXZvaWQgZ2hvc3QgY2FwdHVyZS4KICAgICAgICBjb25zdCB2aWQgPSBzYWZlR2V0T2JqSWQoZXZlbnRWZWhpY2xlKTsKICAgICAgICBpZiAodmlkID09PSB1bmRlZmluZWQpIHJldHVybjsKICAgICAgICBpZiAoU3RhdGUuZmxhZy52ZWhpY2xlT2NjdXBhbnRzQnlWaWRbdmlkXSA9PT0gdW5kZWZpbmVkKSByZXR1cm47CiAgICAgICAgZGVsZXRlIFN0YXRlLmZsYWcudmVoaWNsZU9jY3VwYW50c0J5VmlkW3ZpZF07CiAgICAgICAgY29uc3QgdGVhbUlkID0gU3RhdGUuZmxhZy52ZWhpY2xlVGVhbUJ5VmlkW3ZpZF07CiAgICAgICAgZGVsZXRlIFN0YXRlLmZsYWcudmVoaWNsZVRlYW1CeVZpZFt2aWRdOwogICAgICAgIGRlY3JlbWVudE92ZXJ0aW1lVGVhbVZlaGljbGVDb3VudCh0ZWFtSWQpOwogICAgICAgIGNvbnN0IHBpZHMgPSBPYmplY3Qua2V5cyhTdGF0ZS5mbGFnLnBsYXllcnNJblpvbmVCeVBpZCk7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHBpZCA9IE51bWJlcihwaWRzW2ldKTsKICAgICAgICAgICAgY29uc3QgZW50cnkgPSBTdGF0ZS5mbGFnLnBsYXllcnNJblpvbmVCeVBpZFtwaWRdOwogICAgICAgICAgICBpZiAoZW50cnk/LnZlaGljbGVPYmpJZCA9PT0gdmlkKSB7CiAgICAgICAgICAgICAgICBlbnRyeS52ZWhpY2xlT2JqSWQgPSAwOwogICAgICAgICAgICAgICAgZGVsZXRlIFN0YXRlLmZsYWcubGFzdFVpU25hcHNob3RCeVBpZFtwaWRdOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gT3ZlcnRpbWUgRmxhZyBDYXB0dXJlIC0gVmVoaWNsZSArIFpvbmUgTWVtYmVyc2hpcCBUcmFja2luZyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gT3ZlcnRpbWUgRmxhZyBDYXB0dXJlIC0gQ2FwdHVyZSBMb29wICsgUHJvZ3Jlc3MgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIHN0b3BPdmVydGltZUNhcHR1cmVMb29wKCk6IHZvaWQgewogICAgaWYgKCFTdGF0ZS5mbGFnLnRpY2tBY3RpdmUpIHJldHVybjsKICAgIC8vIEludmFsaWRhdGUgdGhlIHRva2VuIHNvIGFueSBydW5uaW5nIGxvb3AgZXhpdHMgb24gdGhlIG5leHQgdGljay4KICAgIFN0YXRlLmZsYWcudGlja0FjdGl2ZSA9IGZhbHNlOwogICAgU3RhdGUuZmxhZy50aWNrVG9rZW4gPSAoU3RhdGUuZmxhZy50aWNrVG9rZW4gKyAxKSAlIDEwMDAwMDAwMDA7Cn0KCmZ1bmN0aW9uIHN0YXJ0T3ZlcnRpbWVDYXB0dXJlTG9vcCgpOiB2b2lkIHsKICAgIC8vIFRva2VuIGd1YXJkcyBhZ2FpbnN0IG11bHRpcGxlIGxvb3BzIHJ1bm5pbmcgYXQgb25jZS4KICAgIGlmIChTdGF0ZS5mbGFnLnRpY2tBY3RpdmUpIHJldHVybjsKICAgIFN0YXRlLmZsYWcudGlja0FjdGl2ZSA9IHRydWU7CiAgICBTdGF0ZS5mbGFnLnRpY2tUb2tlbiA9IChTdGF0ZS5mbGFnLnRpY2tUb2tlbiArIDEpICUgMTAwMDAwMDAwMDsKICAgIGNvbnN0IHRva2VuID0gU3RhdGUuZmxhZy50aWNrVG9rZW47CiAgICB2b2lkIHJ1bk92ZXJ0aW1lQ2FwdHVyZUxvb3AodG9rZW4pOwp9Cgphc3luYyBmdW5jdGlvbiBydW5PdmVydGltZUNhcHR1cmVMb29wKGV4cGVjdGVkVG9rZW46IG51bWJlcik6IFByb21pc2U8dm9pZD4gewogICAgLy8gVGljayBsb29wOiB1cGRhdGUgY2FwdHVyZSBzdGF0ZSArIEhVRCwgdGhlbiB3YWl0LgogICAgd2hpbGUgKFN0YXRlLmZsYWcudGlja0FjdGl2ZSAmJiBTdGF0ZS5mbGFnLnRpY2tUb2tlbiA9PT0gZXhwZWN0ZWRUb2tlbikgewogICAgICAgIGlmICghU3RhdGUuZmxhZy5hY3RpdmUgfHwgIWlzUm91bmRMaXZlKCkpIHsKICAgICAgICAgICAgc3RvcE92ZXJ0aW1lQ2FwdHVyZUxvb3AoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoaXNSb3VuZEVuZFVpTG9ja2Rvd25BY3RpdmUoKSkgewogICAgICAgICAgICAvLyBSb3VuZC1lbmQgdHJhbnNpdGlvbjogc3RvcCBjYXB0dXJlIHRpY2tzIGJlZm9yZSBhbnkgVUkgdXBkYXRlcy4KICAgICAgICAgICAgc3RvcE92ZXJ0aW1lQ2FwdHVyZUxvb3AoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAgICBwcnVuZU92ZXJ0aW1lWm9uZU1lbWJlcnNoaXAoKTsKICAgICAgICAgICAgcHJ1bmVPdmVydGltZVVpQ2FjaGVzKCk7CiAgICAgICAgICAgIHVwZGF0ZU92ZXJ0aW1lQ2FwdHVyZVByb2dyZXNzKCk7CiAgICAgICAgICAgIHVwZGF0ZU92ZXJ0aW1lSHVkRm9yQWxsUGxheWVycygpOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAvLyBEZWZlbnNpdmU6IHNraXAgYSBiYWQgdGljayBpZiBhIGRpc2Nvbm5lY3QgaW52YWxpZGF0ZXMgc3RhdGUgbWlkLWxvb3AuCiAgICAgICAgfQogICAgICAgIGF3YWl0IG1vZC5XYWl0KE9WRVJUSU1FX1RJQ0tfU0VDT05EUyk7CiAgICB9Cn0KCmZ1bmN0aW9uIHBydW5lT3ZlcnRpbWVab25lTWVtYmVyc2hpcCgpOiB2b2lkIHsKICAgIC8vIFJvdW5kLWVuZCB0ZWFyZG93bjogc2tpcCBvdmVydGltZSBtZW1iZXJzaGlwIGNodXJuLgogICAgaWYgKGlzUm91bmRFbmRVaUxvY2tkb3duQWN0aXZlKCkpIHJldHVybjsKICAgIGlmICghaXNPdmVydGltZVpvbmVUcmFja2luZ0VuYWJsZWQoKSkgcmV0dXJuOwogICAgY29uc3Qgbm93ID0gbW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKTsKICAgIGlmIChub3cgLSBTdGF0ZS5mbGFnLmxhc3RNZW1iZXJzaGlwUHJ1bmVBdFNlY29uZHMgPCBPVkVSVElNRV9NRU1CRVJTSElQX1BSVU5FX0lOVEVSVkFMX1NFQ09ORFMpIHJldHVybjsKICAgIFN0YXRlLmZsYWcubGFzdE1lbWJlcnNoaXBQcnVuZUF0U2Vjb25kcyA9IG5vdzsKCiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBjb25zdCB2YWxpZFBsYXllcnNCeVBpZDogUmVjb3JkPG51bWJlciwgbW9kLlBsYXllcj4gPSB7fTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHBsYXllciA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkKSBjb250aW51ZTsKICAgICAgICB2YWxpZFBsYXllcnNCeVBpZFtwaWRdID0gcGxheWVyOwogICAgfQoKICAgIGNvbnN0IHRyYWNrZWRQaWRzID0gT2JqZWN0LmtleXMoU3RhdGUuZmxhZy5wbGF5ZXJzSW5ab25lQnlQaWQpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmFja2VkUGlkcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHBpZCA9IE51bWJlcih0cmFja2VkUGlkc1tpXSk7CiAgICAgICAgaWYgKGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIHsKICAgICAgICAgICAgaGFuZGxlT3ZlcnRpbWVQbGF5ZXJMZWF2ZUJ5SWQocGlkLCB0cnVlKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGNvbnN0IHBsYXllciA9IHZhbGlkUGxheWVyc0J5UGlkW3BpZF07CiAgICAgICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIHsKICAgICAgICAgICAgLy8gQmVzdC1lZmZvcnQgY2xlYW51cCBmb3IgbWlzc2VkIEFyZWFUcmlnZ2VyIGV4aXRzLgogICAgICAgICAgICBoYW5kbGVPdmVydGltZVBsYXllckxlYXZlQnlJZChwaWQsIGZhbHNlKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChwbGF5ZXIpKSB7CiAgICAgICAgICAgIGhhbmRsZU92ZXJ0aW1lUGxheWVyRXhpdFpvbmUocGxheWVyKTsKICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIHBydW5lT3ZlcnRpbWVVaUNhY2hlcygpOiB2b2lkIHsKICAgIC8vIFJvdW5kLWVuZCB0ZWFyZG93bjogYXZvaWQgdG91Y2hpbmcgb3ZlcnRpbWUgVUkgY2FjaGVzLgogICAgaWYgKGlzUm91bmRFbmRVaUxvY2tkb3duQWN0aXZlKCkpIHJldHVybjsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGNvbnN0IHZhbGlkUGlkczogUmVjb3JkPG51bWJlciwgdHJ1ZT4gPSB7fTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHBsYXllciA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocGxheWVyKTsKICAgICAgICBpZiAocGlkID09PSB1bmRlZmluZWQpIGNvbnRpbnVlOwogICAgICAgIHZhbGlkUGlkc1twaWRdID0gdHJ1ZTsKICAgIH0KCiAgICBjb25zdCB6b25lUGlkcyA9IE9iamVjdC5rZXlzKFN0YXRlLmZsYWcudWlCeVBpZCk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHpvbmVQaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgcGlkID0gTnVtYmVyKHpvbmVQaWRzW2ldKTsKICAgICAgICBpZiAodmFsaWRQaWRzW3BpZF0pIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHJlZnMgPSBTdGF0ZS5mbGFnLnVpQnlQaWRbcGlkXTsKICAgICAgICBpZiAocmVmcz8ucm9vdCkgc2V0V2lkZ2V0VmlzaWJsZShyZWZzLnJvb3QsIGZhbHNlKTsKICAgICAgICBkZWxldGUgU3RhdGUuZmxhZy51aUJ5UGlkW3BpZF07CiAgICAgICAgZGVsZXRlIFN0YXRlLmZsYWcubGFzdFVpU25hcHNob3RCeVBpZFtwaWRdOwogICAgfQoKICAgIGNvbnN0IGdsb2JhbFBpZHMgPSBPYmplY3Qua2V5cyhTdGF0ZS5mbGFnLmdsb2JhbFVpQnlQaWQpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnbG9iYWxQaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgcGlkID0gTnVtYmVyKGdsb2JhbFBpZHNbaV0pOwogICAgICAgIGlmICh2YWxpZFBpZHNbcGlkXSkgY29udGludWU7CiAgICAgICAgY29uc3QgcmVmcyA9IFN0YXRlLmZsYWcuZ2xvYmFsVWlCeVBpZFtwaWRdOwogICAgICAgIGlmIChyZWZzPy5yb290KSBzZXRXaWRnZXRWaXNpYmxlKHJlZnMucm9vdCwgZmFsc2UpOwogICAgICAgIGRlbGV0ZSBTdGF0ZS5mbGFnLmdsb2JhbFVpQnlQaWRbcGlkXTsKICAgIH0KfQoKZnVuY3Rpb24gZ2V0T3ZlcnRpbWVDYXB0dXJlTXVsdGlwbGllcihkZWx0YUFiczogbnVtYmVyKTogbnVtYmVyIHsKICAgIGlmIChkZWx0YUFicyA+PSA0KSByZXR1cm4gT1ZFUlRJTUVfQ0FQVFVSRV9NVUxUSVBMSUVSXzRYOwogICAgaWYgKGRlbHRhQWJzID09PSAzKSByZXR1cm4gT1ZFUlRJTUVfQ0FQVFVSRV9NVUxUSVBMSUVSXzNYOwogICAgaWYgKGRlbHRhQWJzID09PSAyKSByZXR1cm4gT1ZFUlRJTUVfQ0FQVFVSRV9NVUxUSVBMSUVSXzJYOwogICAgcmV0dXJuIDE7Cn0KCmZ1bmN0aW9uIHVwZGF0ZU92ZXJ0aW1lQ2FwdHVyZVByb2dyZXNzKCk6IHZvaWQgewogICAgaWYgKCFTdGF0ZS5mbGFnLmFjdGl2ZSB8fCAhaXNSb3VuZExpdmUoKSkgcmV0dXJuOwoKICAgIC8vIFByb2dyZXNzIHJ1bnMgdG93YXJkIHRoZSB0ZWFtIHdpdGggdmVoaWNsZSBtYWpvcml0eTsgbmV1dHJhbCBpcyAwLjUuCiAgICAvLyBEZWNheSBydW5zIG9ubHkgd2hlbiB0aGUgem9uZSBpcyBlbXB0eSBhbmQgcHJvZ3Jlc3MgaXMgbm90IGZ1bGx5IG93bmVkLgogICAgY29uc3QgdDFDb3VudCA9IFN0YXRlLmZsYWcudDFDb3VudDsKICAgIGNvbnN0IHQyQ291bnQgPSBTdGF0ZS5mbGFnLnQyQ291bnQ7CiAgICBjb25zdCBkZWx0YSA9IHQxQ291bnQgLSB0MkNvdW50OwogICAgaWYgKGRlbHRhICE9PSAwKSB7CiAgICAgICAgLy8gQmFzZSBzdGVwIHVzZXMgMC41IGRpc3RhbmNlIChuZXV0cmFsIC0+IGZ1bGwpIGFuZCBzY2FsZXMgYnkgbWFqb3JpdHkuCiAgICAgICAgY29uc3QgYmFzZVN0ZXAgPSAoT1ZFUlRJTUVfVElDS19TRUNPTkRTIC8gT1ZFUlRJTUVfQ0FQVFVSRV9TRUNPTkRTX1RPX0ZVTEwpICogMC41OwogICAgICAgIGNvbnN0IHNjYWxlZCA9IGdldE92ZXJ0aW1lQ2FwdHVyZU11bHRpcGxpZXIoTWF0aC5hYnMoZGVsdGEpKTsKICAgICAgICBjb25zdCBzb2xvVGVhbTEgPSB0MUNvdW50ID4gMCAmJiB0MkNvdW50ID09PSAwOwogICAgICAgIGNvbnN0IHNvbG9UZWFtMiA9IHQyQ291bnQgPiAwICYmIHQxQ291bnQgPT09IDA7CiAgICAgICAgY29uc3QgdGVhbTFDYXRjaGluZ1VwID0gc29sb1RlYW0xICYmIFN0YXRlLmZsYWcucHJvZ3Jlc3MgPCAwLjU7CiAgICAgICAgY29uc3QgdGVhbTJDYXRjaGluZ1VwID0gc29sb1RlYW0yICYmIFN0YXRlLmZsYWcucHJvZ3Jlc3MgPiAwLjU7CiAgICAgICAgY29uc3QgY2F0Y2h1cEJvb3N0ID0gKHRlYW0xQ2F0Y2hpbmdVcCB8fCB0ZWFtMkNhdGNoaW5nVXApID8gT1ZFUlRJTUVfTkVVVFJBTF9BQ0NFTEVSQVRJT05fTVVMVElQTElFUiA6IDE7CiAgICAgICAgY29uc3Qgc3RlcCA9IGJhc2VTdGVwICogc2NhbGVkICogY2F0Y2h1cEJvb3N0OwogICAgICAgIFN0YXRlLmZsYWcucHJvZ3Jlc3MgPSBTdGF0ZS5mbGFnLnByb2dyZXNzICsgKGRlbHRhID4gMCA/IHN0ZXAgOiAtc3RlcCk7CiAgICAgICAgaWYgKHRlYW0xQ2F0Y2hpbmdVcCAmJiBTdGF0ZS5mbGFnLnByb2dyZXNzID4gMC41KSB7CiAgICAgICAgICAgIFN0YXRlLmZsYWcucHJvZ3Jlc3MgPSAwLjU7CiAgICAgICAgfQogICAgICAgIGlmICh0ZWFtMkNhdGNoaW5nVXAgJiYgU3RhdGUuZmxhZy5wcm9ncmVzcyA8IDAuNSkgewogICAgICAgICAgICBTdGF0ZS5mbGFnLnByb2dyZXNzID0gMC41OwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAodDFDb3VudCA9PT0gMCAmJiB0MkNvdW50ID09PSAwKSB7CiAgICAgICAgaWYgKFN0YXRlLmZsYWcucHJvZ3Jlc3MgIT09IDAgJiYgU3RhdGUuZmxhZy5wcm9ncmVzcyAhPT0gMSkgewogICAgICAgICAgICBjb25zdCBkZWNheVN0ZXAgPSAoT1ZFUlRJTUVfVElDS19TRUNPTkRTIC8gT1ZFUlRJTUVfREVDQVlfU0VDT05EU19UT19UQVJHRVQpICogMC41OwogICAgICAgICAgICBjb25zdCBuZXV0cmFsU3RlcCA9IChTdGF0ZS5mbGFnLm93bmVyVGVhbSA9PT0gMCkgPyAoZGVjYXlTdGVwICogT1ZFUlRJTUVfTkVVVFJBTF9BQ0NFTEVSQVRJT05fTVVMVElQTElFUikgOiBkZWNheVN0ZXA7CiAgICAgICAgICAgIGlmIChTdGF0ZS5mbGFnLm93bmVyVGVhbSA9PT0gVGVhbUlELlRlYW0xKSB7CiAgICAgICAgICAgICAgICBTdGF0ZS5mbGFnLnByb2dyZXNzID0gTWF0aC5taW4oMSwgU3RhdGUuZmxhZy5wcm9ncmVzcyArIGRlY2F5U3RlcCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoU3RhdGUuZmxhZy5vd25lclRlYW0gPT09IFRlYW1JRC5UZWFtMikgewogICAgICAgICAgICAgICAgU3RhdGUuZmxhZy5wcm9ncmVzcyA9IE1hdGgubWF4KDAsIFN0YXRlLmZsYWcucHJvZ3Jlc3MgLSBkZWNheVN0ZXApOwogICAgICAgICAgICB9IGVsc2UgaWYgKFN0YXRlLmZsYWcucHJvZ3Jlc3MgPiAwLjUpIHsKICAgICAgICAgICAgICAgIFN0YXRlLmZsYWcucHJvZ3Jlc3MgPSBNYXRoLm1heCgwLjUsIFN0YXRlLmZsYWcucHJvZ3Jlc3MgLSBuZXV0cmFsU3RlcCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoU3RhdGUuZmxhZy5wcm9ncmVzcyA8IDAuNSkgewogICAgICAgICAgICAgICAgU3RhdGUuZmxhZy5wcm9ncmVzcyA9IE1hdGgubWluKDAuNSwgU3RhdGUuZmxhZy5wcm9ncmVzcyArIG5ldXRyYWxTdGVwKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBTdGF0ZS5mbGFnLnByb2dyZXNzID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgU3RhdGUuZmxhZy5wcm9ncmVzcykpOwoKICAgIGlmIChTdGF0ZS5mbGFnLnByb2dyZXNzIDw9IDApIHsKICAgICAgICBTdGF0ZS5mbGFnLnByb2dyZXNzID0gMDsKICAgICAgICBTdGF0ZS5mbGFnLm93bmVyVGVhbSA9IFRlYW1JRC5UZWFtMjsKICAgICAgICAvLyBGdWxsIGNhcHR1cmUgZW5kcyB0aGUgcm91bmQgaW1tZWRpYXRlbHkgKHVubGVzcyBhIGtpbGwtdGFyZ2V0IGFscmVhZHkgZW5kZWQgaXQpLgogICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpICYmICFpc1JvdW5kS2lsbFRhcmdldFJlYWNoZWQoKSkgewogICAgICAgICAgICBTdGF0ZS5mbGFnLmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgICBzdG9wT3ZlcnRpbWVDYXB0dXJlTG9vcCgpOwogICAgICAgICAgICBlbmRSb3VuZCh1bmRlZmluZWQsIGdldFJlbWFpbmluZ1NlY29uZHMoKSwgVGVhbUlELlRlYW0yKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKFN0YXRlLmZsYWcucHJvZ3Jlc3MgPj0gMSkgewogICAgICAgIFN0YXRlLmZsYWcucHJvZ3Jlc3MgPSAxOwogICAgICAgIFN0YXRlLmZsYWcub3duZXJUZWFtID0gVGVhbUlELlRlYW0xOwogICAgICAgIC8vIEZ1bGwgY2FwdHVyZSBlbmRzIHRoZSByb3VuZCBpbW1lZGlhdGVseSAodW5sZXNzIGEga2lsbC10YXJnZXQgYWxyZWFkeSBlbmRlZCBpdCkuCiAgICAgICAgaWYgKGlzUm91bmRMaXZlKCkgJiYgIWlzUm91bmRLaWxsVGFyZ2V0UmVhY2hlZCgpKSB7CiAgICAgICAgICAgIFN0YXRlLmZsYWcuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICAgIHN0b3BPdmVydGltZUNhcHR1cmVMb29wKCk7CiAgICAgICAgICAgIGVuZFJvdW5kKHVuZGVmaW5lZCwgZ2V0UmVtYWluaW5nU2Vjb25kcygpLCBUZWFtSUQuVGVhbTEpOwogICAgICAgIH0KICAgIH0KfQoKLy8gVE9ETygxLjApOiBVbnVzZWQ7IHJlbW92ZSBiZWZvcmUgZmluYWwgMS4wIHJlbGVhc2UuCmZ1bmN0aW9uIGdldE92ZXJ0aW1lUHJvZ3Jlc3NQZXJjZW50KCk6IG51bWJlciB7CiAgICAvLyBQZXJjZW50IGlzIGZsb29yZWQgZm9yIHN0YWJsZSBVSSB1cGRhdGVzLgogICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEwMCwgTWF0aC5mbG9vcihTdGF0ZS5mbGFnLnByb2dyZXNzICogMTAwKSkpOwp9CgpmdW5jdGlvbiBnZXRPdmVydGltZURpc3BsYXlQZXJjZW50cyhwcm9ncmVzczogbnVtYmVyKTogeyBsZWZ0OiBudW1iZXI7IHJpZ2h0OiBudW1iZXIgfSB7CiAgICAvLyBCaWFzZWQgd2hvbGUtbnVtYmVyIHJvdW5kaW5nIHNvIHRoZSBkaXNwbGF5ZWQgd2lubmVyIG1hdGNoZXMgdGhlIGNhcHR1cmUgd2lubmVyLgogICAgY29uc3QgY2xhbXBlZCA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHByb2dyZXNzKSk7CiAgICBpZiAoY2xhbXBlZCA9PT0gMC41KSByZXR1cm4geyBsZWZ0OiA1MCwgcmlnaHQ6IDUwIH07CiAgICBpZiAoY2xhbXBlZCA+IDAuNSkgewogICAgICAgIGNvbnN0IGxlZnQgPSBNYXRoLm1pbigxMDAsIE1hdGgubWF4KDAsIE1hdGguY2VpbChjbGFtcGVkICogMTAwKSkpOwogICAgICAgIHJldHVybiB7IGxlZnQsIHJpZ2h0OiAxMDAgLSBsZWZ0IH07CiAgICB9CiAgICBjb25zdCBsZWZ0ID0gTWF0aC5taW4oMTAwLCBNYXRoLm1heCgwLCBNYXRoLmZsb29yKGNsYW1wZWQgKiAxMDApKSk7CiAgICByZXR1cm4geyBsZWZ0LCByaWdodDogMTAwIC0gbGVmdCB9Owp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gT3ZlcnRpbWUgRmxhZyBDYXB0dXJlIC0gQ2FwdHVyZSBMb29wICsgUHJvZ3Jlc3MgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE92ZXJ0aW1lIEZsYWcgQ2FwdHVyZSAtIEhVRCBVcGRhdGUgKyBWaXNpYmlsaXR5IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBpc092ZXJ0aW1lWm9uZVRyYWNraW5nRW5hYmxlZCgpOiBib29sZWFuIHsKICAgIHJldHVybiBpc1JvdW5kTGl2ZSgpICYmIFN0YXRlLmZsYWcudHJhY2tpbmdFbmFibGVkICYmIGlzVGllQnJlYWtlckVuYWJsZWRGb3JSb3VuZCgpOwp9CgpmdW5jdGlvbiBzaG91bGREZWZlckRpc2Nvbm5lY3RVaURlbGV0ZXMoKTogYm9vbGVhbiB7CiAgICAvLyBBdm9pZCBoYXJkIFVJIGRlbGV0ZXMgZHVyaW5nIGFjdGl2ZSBvdmVydGltZSBjYXB0dXJlIHRvIHJlZHVjZSBjcmFzaCByaXNrIG9uIGRpc2Nvbm5lY3RzLgogICAgcmV0dXJuIGlzUm91bmRMaXZlKCkgJiYgU3RhdGUuZmxhZy5zdGFnZSA+PSBPdmVydGltZVN0YWdlLlZpc2libGU7Cn0KCmZ1bmN0aW9uIHVwZGF0ZU92ZXJ0aW1lSHVkRm9yQWxsUGxheWVycygpOiB2b2lkIHsKICAgIGlmICghaXNSb3VuZExpdmUoKSkgcmV0dXJuOwogICAgLy8gUm91bmQtZW5kIHRlYXJkb3duOiBzdG9wIGxpdmUgSFVEIHVwZGF0ZXMuCiAgICBpZiAoaXNSb3VuZEVuZFVpTG9ja2Rvd25BY3RpdmUoKSkgcmV0dXJuOwogICAgaWYgKFN0YXRlLmZsYWcuc3RhZ2UgPCBPdmVydGltZVN0YWdlLlZpc2libGUpIHJldHVybjsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHBsYXllciA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIGNvbnRpbnVlOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHVwZGF0ZU92ZXJ0aW1lSHVkRm9yUGxheWVyKHBsYXllcik7CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gdXBkYXRlT3ZlcnRpbWVIdWRGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuOwogICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICBpZiAocGlkID09PSB1bmRlZmluZWQpIHJldHVybjsKICAgIGlmIChpc1BpZERpc2Nvbm5lY3RlZChwaWQpKSByZXR1cm47CiAgICAvLyBSb3VuZC1lbmQgdGVhcmRvd246IHNraXAgcGVyLXBsYXllciBIVUQgdXBkYXRlcy4KICAgIGlmIChpc1JvdW5kRW5kVWlMb2NrZG93bkFjdGl2ZSgpKSByZXR1cm47CiAgICBjb25zdCBlbnRyeSA9IFN0YXRlLmZsYWcucGxheWVyc0luWm9uZUJ5UGlkW3BpZF07CiAgICBjb25zdCBpblpvbmUgPSAhIWVudHJ5OwogICAgY29uc3QgcmVmcyA9IFN0YXRlLmZsYWcudWlCeVBpZFtwaWRdOwogICAgaWYgKCFyZWZzIHx8ICFyZWZzLnJvb3QpIHJldHVybjsKCiAgICBjb25zdCBzdGFnZSA9IFN0YXRlLmZsYWcuc3RhZ2U7CiAgICBjb25zdCBpc0FjdGl2ZSA9IHN0YWdlID49IE92ZXJ0aW1lU3RhZ2UuQWN0aXZlOwogICAgY29uc3QgbGV0dGVyS2V5ID0gZ2V0QWN0aXZlT3ZlcnRpbWVGbGFnTGV0dGVyS2V5KCk7CiAgICBjb25zdCBsZXR0ZXJUZXh0ID0gZ2V0QWN0aXZlT3ZlcnRpbWVGbGFnTGV0dGVyVGV4dCgpOwogICAgY29uc3QgdGVhbUlkID0gZW50cnk/LnRlYW1JZCA/PyBzYWZlR2V0VGVhbU51bWJlckZyb21QbGF5ZXIocGxheWVyKTsKCiAgICAvLyBUaXRsZSArIHN0YXR1cyByb3V0aW5nIGJ5IHN0YWdlIGFuZCB6b25lIHByZXNlbmNlLgogICAgbGV0IHRpdGxlS2V5ID0gU1RSX0ZMQUdfVElUTEVfQUNUSVZFX0ZPUk1BVDsKICAgIGxldCB0aXRsZVZhbHVlID0gbGV0dGVyS2V5OwogICAgbGV0IHN0YXR1c0tleSA9IFNUUl9GTEFHX1NUQVRVU19TVEFMTEVEOwogICAgbGV0IHN0YXR1c1ZhbHVlID0gLTE7CiAgICBsZXQgc3RhdHVzVmlzaWJsZSA9IHRydWU7CiAgICBsZXQgdW5sb2NrU2Vjb25kcyA9IC0xOwoKICAgIGlmICghaXNBY3RpdmUpIHsKICAgICAgICB0aXRsZUtleSA9IFNUUl9GTEFHX1RJVExFX0xPQ0tFRF9GT1JNQVQ7CiAgICAgICAgdGl0bGVWYWx1ZSA9IGxldHRlcktleTsKICAgICAgICB1bmxvY2tTZWNvbmRzID0gZ2V0T3ZlcnRpbWVVbmxvY2tTZWNvbmRzKCk7CiAgICAgICAgaWYgKGluWm9uZSkgewogICAgICAgICAgICBzdGF0dXNLZXkgPSBTVFJfRkxBR19BQ1RJVkFURVNfSU5fRk9STUFUOwogICAgICAgICAgICBzdGF0dXNWYWx1ZSA9IHVubG9ja1NlY29uZHM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhdHVzVmlzaWJsZSA9IGZhbHNlOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgdGl0bGVLZXkgPSBTVFJfRkxBR19USVRMRV9BQ1RJVkVfRk9STUFUOwogICAgICAgIHRpdGxlVmFsdWUgPSBsZXR0ZXJLZXk7CiAgICAgICAgLy8gQWN0aXZlIHN0YWdlOiBzdGF0dXMgcmVmbGVjdHMgd2hpY2ggdGVhbSBpcyB3aW5uaW5nIHRoZSBjYXB0dXJlLgogICAgICAgIGNvbnN0IGRlbHRhID0gU3RhdGUuZmxhZy50MUNvdW50IC0gU3RhdGUuZmxhZy50MkNvdW50OwogICAgICAgIGlmIChkZWx0YSAhPT0gMCkgewogICAgICAgICAgICBpZiAodGVhbUlkID09PSBUZWFtSUQuVGVhbTEpIHsKICAgICAgICAgICAgICAgIHN0YXR1c0tleSA9IGRlbHRhID4gMCA/IFNUUl9GTEFHX1NUQVRVU19DQVBUVVJJTkcgOiBTVFJfRkxBR19TVEFUVVNfTE9TSU5HOwogICAgICAgICAgICB9IGVsc2UgaWYgKHRlYW1JZCA9PT0gVGVhbUlELlRlYW0yKSB7CiAgICAgICAgICAgICAgICBzdGF0dXNLZXkgPSBkZWx0YSA8IDAgPyBTVFJfRkxBR19TVEFUVVNfQ0FQVFVSSU5HIDogU1RSX0ZMQUdfU1RBVFVTX0xPU0lORzsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoU3RhdGUuZmxhZy50MUNvdW50ID4gMCAmJiBTdGF0ZS5mbGFnLnQyQ291bnQgPiAwKSB7CiAgICAgICAgICAgIHN0YXR1c0tleSA9IFNUUl9GTEFHX1NUQVRVU19TVEFMTEVEOwogICAgICAgIH0gZWxzZSBpZiAoU3RhdGUuZmxhZy50MUNvdW50ID09PSAwICYmIFN0YXRlLmZsYWcudDJDb3VudCA9PT0gMCkgewogICAgICAgICAgICBjb25zdCBpc1Jlc2V0dGluZyA9IE1hdGguYWJzKFN0YXRlLmZsYWcucHJvZ3Jlc3MgLSAwLjUpID4gMC4wMDAxOwogICAgICAgICAgICBpZiAoaXNSZXNldHRpbmcpIHsKICAgICAgICAgICAgICAgIHN0YXR1c0tleSA9IFNUUl9GTEFHX1NUQVRVU19SRVNFVFRJTkc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzdGF0dXNWaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgY29uc3QgcHJlQWN0aXZlSW5ab25lID0gIWlzQWN0aXZlICYmIHN0YWdlID49IE92ZXJ0aW1lU3RhZ2UuVmlzaWJsZSAmJiBpblpvbmU7CiAgICBjb25zdCBjb3VudHNWaXNpYmxlID0gaXNBY3RpdmUgfHwgcHJlQWN0aXZlSW5ab25lOwogICAgY29uc3QgY291bnRzVXNlWCA9IHByZUFjdGl2ZUluWm9uZTsKICAgIGNvbnN0IGxlZnRCb3JkZXJWaXNpYmxlID0gaXNBY3RpdmUgJiYgU3RhdGUuZmxhZy50MUNvdW50ID4gMDsKICAgIGNvbnN0IHJpZ2h0Qm9yZGVyVmlzaWJsZSA9IGlzQWN0aXZlICYmIFN0YXRlLmZsYWcudDJDb3VudCA+IDA7CiAgICBjb25zdCB2ZWhpY2xlUmVxdWlyZWRWaXNpYmxlID0gc3RhZ2UgPj0gT3ZlcnRpbWVTdGFnZS5WaXNpYmxlICYmIGluWm9uZSAmJiBlbnRyeT8udmVoaWNsZU9iaklkID09PSAwOwogICAgY29uc3QgcHJvZ3Jlc3MgPSBpc0FjdGl2ZSA/IFN0YXRlLmZsYWcucHJvZ3Jlc3MgOiAwLjU7CiAgICBjb25zdCBwcm9ncmVzc1BlcmNlbnQgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxMDAsIE1hdGguZmxvb3IocHJvZ3Jlc3MgKiAxMDApKSk7CiAgICBjb25zdCBkaXNwbGF5UGVyY2VudHMgPSBnZXRPdmVydGltZURpc3BsYXlQZXJjZW50cyhwcm9ncmVzcyk7CiAgICBjb25zdCBsZWZ0UGVyY2VudCA9IE1hdGgubWluKDk5LCBkaXNwbGF5UGVyY2VudHMubGVmdCk7CiAgICBjb25zdCByaWdodFBlcmNlbnQgPSBNYXRoLm1pbig5OSwgZGlzcGxheVBlcmNlbnRzLnJpZ2h0KTsKICAgIGNvbnN0IHQxV2lkdGggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihPVkVSVElNRV9CQVJfV0lEVEgsIE1hdGgucm91bmQoT1ZFUlRJTUVfQkFSX1dJRFRIICogcHJvZ3Jlc3MpKSk7CiAgICBjb25zdCB0MldpZHRoID0gTWF0aC5tYXgoMCwgT1ZFUlRJTUVfQkFSX1dJRFRIIC0gdDFXaWR0aCk7CgogICAgLy8gQWx3YXlzIHJlZnJlc2ggdGhlIHRpdGxlIHNvIGxvY2tlZC9hY3RpdmUgdGV4dCBzdGF5cyB2aXNpYmxlIGV2ZW4gd2hlbiBzbmFwc2hvdCBnYXRpbmcgc2tpcHMgb3RoZXIgdXBkYXRlcy4KICAgIGNvbnN0IHRpdGxlV2lkZ2V0ID0gcmVmcy50aXRsZSA/PyBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1RpdGxlXyR7cGlkfWApOwogICAgY29uc3QgdGl0bGVTaGFkb3dXaWRnZXQgPSByZWZzLnRpdGxlU2hhZG93ID8/IHNhZmVGaW5kKGBPdmVydGltZUZsYWdfVGl0bGVTaGFkb3dfJHtwaWR9YCk7CiAgICBpZiAodGl0bGVXaWRnZXQgfHwgdGl0bGVTaGFkb3dXaWRnZXQpIHsKICAgICAgICBjb25zdCB0aXRsZUxhYmVsID0gIWlzQWN0aXZlCiAgICAgICAgICAgID8gbW9kLk1lc3NhZ2UodGl0bGVLZXksIGxldHRlclRleHQsIHVubG9ja1NlY29uZHMpCiAgICAgICAgICAgIDogbW9kLk1lc3NhZ2UodGl0bGVLZXksIGxldHRlclRleHQpOwogICAgICAgIGlmICh0aXRsZVdpZGdldCkgewogICAgICAgICAgICByZWZzLnRpdGxlID0gdGl0bGVXaWRnZXQ7CiAgICAgICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbCh0aXRsZVdpZGdldCwgdGl0bGVMYWJlbCk7CiAgICAgICAgICAgIHNldFdpZGdldFZpc2libGUodGl0bGVXaWRnZXQsIHRydWUpOwogICAgICAgIH0KICAgICAgICBpZiAodGl0bGVTaGFkb3dXaWRnZXQpIHsKICAgICAgICAgICAgcmVmcy50aXRsZVNoYWRvdyA9IHRpdGxlU2hhZG93V2lkZ2V0OwogICAgICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwodGl0bGVTaGFkb3dXaWRnZXQsIHRpdGxlTGFiZWwpOwogICAgICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHRpdGxlU2hhZG93V2lkZ2V0LCB0cnVlKTsKICAgICAgICB9CiAgICB9CgogICAgY29uc3Qgc25hcHNob3QgPSBTdGF0ZS5mbGFnLmxhc3RVaVNuYXBzaG90QnlQaWRbcGlkXTsKICAgIC8vIEF2b2lkIHRvdWNoaW5nIFVJIGlmIG5vdGhpbmcgY2hhbmdlZCBzaW5jZSB0aGUgbGFzdCB0aWNrLgogICAgaWYgKAogICAgICAgIHNuYXBzaG90CiAgICAgICAgJiYgc25hcHNob3QucHJvZ3Jlc3NQZXJjZW50ID09PSBwcm9ncmVzc1BlcmNlbnQKICAgICAgICAmJiBzbmFwc2hvdC5sZWZ0UGVyY2VudCA9PT0gbGVmdFBlcmNlbnQKICAgICAgICAmJiBzbmFwc2hvdC5yaWdodFBlcmNlbnQgPT09IHJpZ2h0UGVyY2VudAogICAgICAgICYmIHNuYXBzaG90LmJhckZpbGxUMVdpZHRoID09PSB0MVdpZHRoCiAgICAgICAgJiYgc25hcHNob3QuYmFyRmlsbFQyV2lkdGggPT09IHQyV2lkdGgKICAgICAgICAmJiBzbmFwc2hvdC50MUNvdW50ID09PSBTdGF0ZS5mbGFnLnQxQ291bnQKICAgICAgICAmJiBzbmFwc2hvdC50MkNvdW50ID09PSBTdGF0ZS5mbGFnLnQyQ291bnQKICAgICAgICAmJiBzbmFwc2hvdC5zdGF0dXNLZXkgPT09IHN0YXR1c0tleQogICAgICAgICYmIHNuYXBzaG90LnN0YXR1c1ZhbHVlID09PSBzdGF0dXNWYWx1ZQogICAgICAgICYmIHNuYXBzaG90LnN0YXR1c1Zpc2libGUgPT09IHN0YXR1c1Zpc2libGUKICAgICAgICAmJiBzbmFwc2hvdC50aXRsZUtleSA9PT0gdGl0bGVLZXkKICAgICAgICAmJiBzbmFwc2hvdC50aXRsZVZhbHVlID09PSB0aXRsZVZhbHVlCiAgICAgICAgJiYgc25hcHNob3QuY291bnRzVmlzaWJsZSA9PT0gY291bnRzVmlzaWJsZQogICAgICAgICYmIHNuYXBzaG90LmNvdW50c1VzZVggPT09IGNvdW50c1VzZVgKICAgICAgICAmJiBzbmFwc2hvdC5sZWZ0Qm9yZGVyVmlzaWJsZSA9PT0gbGVmdEJvcmRlclZpc2libGUKICAgICAgICAmJiBzbmFwc2hvdC5yaWdodEJvcmRlclZpc2libGUgPT09IHJpZ2h0Qm9yZGVyVmlzaWJsZQogICAgICAgICYmIHNuYXBzaG90LnZlaGljbGVSZXF1aXJlZFZpc2libGUgPT09IHZlaGljbGVSZXF1aXJlZFZpc2libGUKICAgICkgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBTdGF0ZS5mbGFnLmxhc3RVaVNuYXBzaG90QnlQaWRbcGlkXSA9IHsKICAgICAgICBwcm9ncmVzc1BlcmNlbnQsCiAgICAgICAgbGVmdFBlcmNlbnQsCiAgICAgICAgcmlnaHRQZXJjZW50LAogICAgICAgIGJhckZpbGxUMVdpZHRoOiB0MVdpZHRoLAogICAgICAgIGJhckZpbGxUMldpZHRoOiB0MldpZHRoLAogICAgICAgIHQxQ291bnQ6IFN0YXRlLmZsYWcudDFDb3VudCwKICAgICAgICB0MkNvdW50OiBTdGF0ZS5mbGFnLnQyQ291bnQsCiAgICAgICAgc3RhdHVzS2V5LAogICAgICAgIHN0YXR1c1ZhbHVlLAogICAgICAgIHN0YXR1c1Zpc2libGUsCiAgICAgICAgdGl0bGVLZXksCiAgICAgICAgdGl0bGVWYWx1ZSwKICAgICAgICBjb3VudHNWaXNpYmxlLAogICAgICAgIGNvdW50c1VzZVgsCiAgICAgICAgbGVmdEJvcmRlclZpc2libGUsCiAgICAgICAgcmlnaHRCb3JkZXJWaXNpYmxlLAogICAgICAgIHZlaGljbGVSZXF1aXJlZFZpc2libGUsCiAgICB9OwoKICAgIGlmIChyZWZzLnN0YXR1cyB8fCByZWZzLnN0YXR1c1NoYWRvdykgewogICAgICAgIGlmIChzdGF0dXNWaXNpYmxlKSB7CiAgICAgICAgICAgIGNvbnN0IHN0YXR1c0xhYmVsID0gc3RhdHVzVmFsdWUgPj0gMCA/IG1vZC5NZXNzYWdlKHN0YXR1c0tleSwgc3RhdHVzVmFsdWUpIDogbW9kLk1lc3NhZ2Uoc3RhdHVzS2V5KTsKICAgICAgICAgICAgaWYgKHJlZnMuc3RhdHVzKSB7CiAgICAgICAgICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwocmVmcy5zdGF0dXMsIHN0YXR1c0xhYmVsKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocmVmcy5zdGF0dXNTaGFkb3cpIHsKICAgICAgICAgICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbChyZWZzLnN0YXR1c1NoYWRvdywgc3RhdHVzTGFiZWwpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChyZWZzLnN0YXR1cykgewogICAgICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHJlZnMuc3RhdHVzLCBzdGF0dXNWaXNpYmxlKTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlZnMuc3RhdHVzU2hhZG93KSB7CiAgICAgICAgICAgIHNldFdpZGdldFZpc2libGUocmVmcy5zdGF0dXNTaGFkb3csIHN0YXR1c1Zpc2libGUpOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAocmVmcy5jb3VudHNMZWZ0KSB7CiAgICAgICAgaWYgKGNvdW50c1Zpc2libGUpIHsKICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBjb3VudHNVc2VYCiAgICAgICAgICAgICAgICA/IG1vZC5NZXNzYWdlKFNUUl9GTEFHX0NPVU5UU19MRUZUX0ZPUk1BVCwgU1RSX1VJX1gpCiAgICAgICAgICAgICAgICA6IG1vZC5NZXNzYWdlKFNUUl9GTEFHX0NPVU5UU19MRUZUX0ZPUk1BVCwgU3RhdGUuZmxhZy50MUNvdW50KTsKICAgICAgICAgICAgc2FmZVNldFVJVGV4dExhYmVsKHJlZnMuY291bnRzTGVmdCwgbGFiZWwpOwogICAgICAgIH0KICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHJlZnMuY291bnRzTGVmdCwgY291bnRzVmlzaWJsZSk7CiAgICB9CiAgICBpZiAocmVmcy5jb3VudHNMZWZ0Qm9yZGVyKSB7CiAgICAgICAgc2V0V2lkZ2V0VmlzaWJsZShyZWZzLmNvdW50c0xlZnRCb3JkZXIsIGxlZnRCb3JkZXJWaXNpYmxlKTsKICAgIH0KICAgIGlmIChyZWZzLmNvdW50c1JpZ2h0KSB7CiAgICAgICAgaWYgKGNvdW50c1Zpc2libGUpIHsKICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBjb3VudHNVc2VYCiAgICAgICAgICAgICAgICA/IG1vZC5NZXNzYWdlKFNUUl9GTEFHX0NPVU5UU19SSUdIVF9GT1JNQVQsIFNUUl9VSV9YKQogICAgICAgICAgICAgICAgOiBtb2QuTWVzc2FnZShTVFJfRkxBR19DT1VOVFNfUklHSFRfRk9STUFULCBTdGF0ZS5mbGFnLnQyQ291bnQpOwogICAgICAgICAgICBzYWZlU2V0VUlUZXh0TGFiZWwocmVmcy5jb3VudHNSaWdodCwgbGFiZWwpOwogICAgICAgIH0KICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHJlZnMuY291bnRzUmlnaHQsIGNvdW50c1Zpc2libGUpOwogICAgfQogICAgaWYgKHJlZnMuY291bnRzUmlnaHRCb3JkZXIpIHsKICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHJlZnMuY291bnRzUmlnaHRCb3JkZXIsIHJpZ2h0Qm9yZGVyVmlzaWJsZSk7CiAgICB9CiAgICBpZiAocmVmcy5wZXJjZW50TGVmdCkgewogICAgICAgIGlmIChjb3VudHNWaXNpYmxlKSB7CiAgICAgICAgICAgIHNhZmVTZXRVSVRleHRMYWJlbChyZWZzLnBlcmNlbnRMZWZ0LCBtb2QuTWVzc2FnZShTVFJfRkxBR19QUk9HUkVTU19GT1JNQVQsIGxlZnRQZXJjZW50KSk7CiAgICAgICAgfQogICAgICAgIHNldFdpZGdldFZpc2libGUocmVmcy5wZXJjZW50TGVmdCwgY291bnRzVmlzaWJsZSk7CiAgICB9CiAgICBpZiAocmVmcy5wZXJjZW50TGVmdEJnKSB7CiAgICAgICAgc2V0V2lkZ2V0VmlzaWJsZShyZWZzLnBlcmNlbnRMZWZ0QmcsIGNvdW50c1Zpc2libGUpOwogICAgfQogICAgaWYgKHJlZnMucGVyY2VudFJpZ2h0KSB7CiAgICAgICAgaWYgKGNvdW50c1Zpc2libGUpIHsKICAgICAgICAgICAgc2FmZVNldFVJVGV4dExhYmVsKHJlZnMucGVyY2VudFJpZ2h0LCBtb2QuTWVzc2FnZShTVFJfRkxBR19QUk9HUkVTU19GT1JNQVQsIHJpZ2h0UGVyY2VudCkpOwogICAgICAgIH0KICAgICAgICBzZXRXaWRnZXRWaXNpYmxlKHJlZnMucGVyY2VudFJpZ2h0LCBjb3VudHNWaXNpYmxlKTsKICAgIH0KICAgIGlmIChyZWZzLnBlcmNlbnRSaWdodEJnKSB7CiAgICAgICAgc2V0V2lkZ2V0VmlzaWJsZShyZWZzLnBlcmNlbnRSaWdodEJnLCBjb3VudHNWaXNpYmxlKTsKICAgIH0KCiAgICBjb25zdCBwcm9ncmVzc0RlbHRhID0gcHJvZ3Jlc3MgLSAwLjU7CiAgICBjb25zdCBwcm9ncmVzc0Vwc2lsb24gPSAwLjAwMDE7CiAgICBjb25zdCBzaG93TGVmdENyb3duID0gY291bnRzVmlzaWJsZSAmJiBwcm9ncmVzc0RlbHRhID4gcHJvZ3Jlc3NFcHNpbG9uOwogICAgY29uc3Qgc2hvd1JpZ2h0Q3Jvd24gPSBjb3VudHNWaXNpYmxlICYmIHByb2dyZXNzRGVsdGEgPCAtcHJvZ3Jlc3NFcHNpbG9uOwogICAgc2V0V2lkZ2V0VmlzaWJsZShyZWZzLmNvdW50c0xlZnRDcm93biwgc2hvd0xlZnRDcm93bik7CiAgICBzZXRXaWRnZXRWaXNpYmxlKHJlZnMuY291bnRzUmlnaHRDcm93biwgc2hvd1JpZ2h0Q3Jvd24pOwoKICAgIHNldFdpZGdldFZpc2libGUocmVmcy52ZWhpY2xlUmVxdWlyZWQsIHZlaGljbGVSZXF1aXJlZFZpc2libGUpOwoKICAgIC8vIEJhciBmaWxsIGlzIHNwbGl0IGJldHdlZW4gdGhlIHR3byB0ZWFtcyBhcm91bmQgbmV1dHJhbC4KICAgIGlmIChyZWZzLmJhckJnKSBzZXRXaWRnZXRWaXNpYmxlKHJlZnMuYmFyQmcsIHRydWUpOwogICAgaWYgKHJlZnMuYmFyRmlsbFQxKSBzZXRXaWRnZXRWaXNpYmxlKHJlZnMuYmFyRmlsbFQxLCB0cnVlKTsKICAgIGlmIChyZWZzLmJhckZpbGxUMikgc2V0V2lkZ2V0VmlzaWJsZShyZWZzLmJhckZpbGxUMiwgdHJ1ZSk7CiAgICBpZiAocmVmcy5iYXJGaWxsVDEpIHNhZmVTZXRVSVdpZGdldFNpemUocmVmcy5iYXJGaWxsVDEsIG1vZC5DcmVhdGVWZWN0b3IodDFXaWR0aCwgT1ZFUlRJTUVfQkFSX0hFSUdIVCwgMCkpOwogICAgaWYgKHJlZnMuYmFyRmlsbFQyKSBzYWZlU2V0VUlXaWRnZXRTaXplKHJlZnMuYmFyRmlsbFQyLCBtb2QuQ3JlYXRlVmVjdG9yKHQyV2lkdGgsIE9WRVJUSU1FX0JBUl9IRUlHSFQsIDApKTsKfQoKLy8gVE9ETygxLjApOiBVbnVzZWQ7IHJlbW92ZSBiZWZvcmUgZmluYWwgMS4wIHJlbGVhc2UuCmZ1bmN0aW9uIHVwZGF0ZU92ZXJ0aW1lR2xvYmFsSHVkRm9yQWxsUGxheWVycyhmb3JjZTogYm9vbGVhbik6IHZvaWQgewogICAgLy8gRGVwcmVjYXRlZDogZ2xvYmFsIEhVRCByZXBsYWNlZCBieSB1bmlmaWVkIGluLXpvbmUgSFVELgogICAgaWYgKCFmb3JjZSkgcmV0dXJuOwogICAgLy8gUm91bmQtZW5kIHRlYXJkb3duOiBhdm9pZCBmb3JjZWQgSFVEIHJlZnJlc2guCiAgICBpZiAoaXNSb3VuZEVuZFVpTG9ja2Rvd25BY3RpdmUoKSkgcmV0dXJuOwogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcGxheWVyID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXIpKSBjb250aW51ZTsKICAgICAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocGxheWVyKTsKICAgICAgICBpZiAocGlkID09PSB1bmRlZmluZWQgfHwgaXNQaWREaXNjb25uZWN0ZWQocGlkKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcmVmcyA9IFN0YXRlLmZsYWcuZ2xvYmFsVWlCeVBpZFtwaWRdOwogICAgICAgIGlmIChyZWZzPy5yb290KSBzZXRXaWRnZXRWaXNpYmxlKHJlZnMucm9vdCwgZmFsc2UpOwogICAgfQp9CgpmdW5jdGlvbiByZWZyZXNoT3ZlcnRpbWVVaVZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgLy8gVXNlZCBhZnRlciBzdGFnZSB0cmFuc2l0aW9ucyBvciBnbG9iYWwgc3RhdGUgY2hhbmdlcy4KICAgIC8vIFJvdW5kLWVuZCB0ZWFyZG93bjogZG8gbm90IHRvZ2dsZSBvdmVydGltZSBIVUQgdmlzaWJpbGl0eS4KICAgIGlmIChpc1JvdW5kRW5kVWlMb2NrZG93bkFjdGl2ZSgpKSByZXR1cm47CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwbGF5ZXIgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIGNvbnRpbnVlOwogICAgICAgIHJlZnJlc2hPdmVydGltZVVpVmlzaWJpbGl0eUZvclBsYXllcihwbGF5ZXIpOwogICAgfQp9CgpmdW5jdGlvbiByZWZyZXNoT3ZlcnRpbWVVaVZpc2liaWxpdHlGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuOwogICAgLy8gU2luZ2xlIEhVRCBmb3IgYWxsIHBsYXllcnMgb25jZSB2aXNpYmxlOyBnbG9iYWwgSFVEIGlzIGRlcHJlY2F0ZWQuCiAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocGxheWVyKTsKICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCkgcmV0dXJuOwogICAgaWYgKGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIHJldHVybjsKICAgIC8vIFJvdW5kLWVuZCB0ZWFyZG93bjogc2tpcCBwZXItcGxheWVyIHZpc2liaWxpdHkgY2hhbmdlcy4KICAgIGlmIChpc1JvdW5kRW5kVWlMb2NrZG93bkFjdGl2ZSgpKSByZXR1cm47CiAgICBjb25zdCBpc0xpdmUgPSBpc1JvdW5kTGl2ZSgpOwogICAgY29uc3Qgc2hvdWxkU2hvdyA9IGlzTGl2ZSAmJiBTdGF0ZS5mbGFnLnN0YWdlID49IE92ZXJ0aW1lU3RhZ2UuVmlzaWJsZTsKICAgIGxldCByZWZzOiBPdmVydGltZUZsYWdIdWRSZWZzIHwgdW5kZWZpbmVkID0gU3RhdGUuZmxhZy51aUJ5UGlkW3BpZF07CiAgICBpZiAoIXJlZnMgJiYgc2hvdWxkU2hvdykgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJlZnMgPSBlbnN1cmVPdmVydGltZUh1ZEZvclBsYXllcihwbGF5ZXIpOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQogICAgaWYgKHJlZnM/LnJvb3QpIHNldFdpZGdldFZpc2libGUocmVmcy5yb290LCBzaG91bGRTaG93KTsKICAgIGlmIChzaG91bGRTaG93ICYmIHJlZnM/LnJvb3QpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICB1cGRhdGVPdmVydGltZUh1ZEZvclBsYXllcihwbGF5ZXIpOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQogICAgY29uc3QgZ2xvYmFsUmVmcyA9IFN0YXRlLmZsYWcuZ2xvYmFsVWlCeVBpZFtwaWRdOwogICAgaWYgKGdsb2JhbFJlZnM/LnJvb3QpIHNldFdpZGdldFZpc2libGUoZ2xvYmFsUmVmcy5yb290LCBmYWxzZSk7Cn0KCmZ1bmN0aW9uIHJlYnVpbGRPdmVydGltZVVpRm9yUGxheWVyKHBsYXllcjogbW9kLlBsYXllcik6IHZvaWQgewogICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIHJldHVybjsKICAgIGNvbnN0IHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChwbGF5ZXIpOwogICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkKSByZXR1cm47CgogICAgLy8gSGlkZSBhbnkgbGluZ2VyaW5nIG92ZXJ0aW1lIEhVRCByb290cyBhbmQgZHJvcCBjYWNoZWQgcmVmcy9zbmFwc2hvdHMuCiAgICBjb25zdCB6b25lUm9vdCA9IHNhZmVGaW5kKGBPdmVydGltZUZsYWdSb290XyR7cGlkfWApOwogICAgaWYgKHpvbmVSb290KSBzZXRXaWRnZXRWaXNpYmxlKHpvbmVSb290LCBmYWxzZSk7CiAgICBjb25zdCBnbG9iYWxSb290ID0gc2FmZUZpbmQoYE92ZXJ0aW1lR2xvYmFsUm9vdF8ke3BpZH1gKTsKICAgIGlmIChnbG9iYWxSb290KSBzZXRXaWRnZXRWaXNpYmxlKGdsb2JhbFJvb3QsIGZhbHNlKTsKCiAgICBkcm9wT3ZlcnRpbWVVaVJlZnNGb3JQbGF5ZXJJZChwaWQpOwoKICAgIC8vIFJlYnVpbGQgb25seSB3aGVuIHRoZSByb3VuZCBpcyBpbiBhIHNhZmUgc3RhdGUgZm9yIG92ZXJ0aW1lIFVJIHVwZGF0ZXMuCiAgICBpZiAoaXNSb3VuZEVuZFVpTG9ja2Rvd25BY3RpdmUoKSkgcmV0dXJuOwogICAgcmVmcmVzaE92ZXJ0aW1lVWlWaXNpYmlsaXR5Rm9yUGxheWVyKHBsYXllcik7Cn0KCmZ1bmN0aW9uIHByZXdhcm1PdmVydGltZUh1ZEZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICAvLyBSb3VuZC1lbmQgdGVhcmRvd246IHNraXAgcHJld2FybSBpZiB0ZWFyZG93biBpcyBhY3RpdmUuCiAgICBpZiAoaXNSb3VuZEVuZFVpTG9ja2Rvd25BY3RpdmUoKSkgcmV0dXJuOwogICAgaWYgKCFpc1JvdW5kTGl2ZSgpKSByZXR1cm47CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwbGF5ZXIgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIGNvbnRpbnVlOwogICAgICAgIGxldCByZWZzOiBPdmVydGltZUZsYWdIdWRSZWZzIHwgdW5kZWZpbmVkOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJlZnMgPSBlbnN1cmVPdmVydGltZUh1ZEZvclBsYXllcihwbGF5ZXIpOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlZnM/LnJvb3QpIHNldFdpZGdldFZpc2libGUocmVmcy5yb290LCBmYWxzZSk7CiAgICAgICAgY29uc3QgZ2xvYmFsUmVmcyA9IFN0YXRlLmZsYWcuZ2xvYmFsVWlCeVBpZFtwaWRdOwogICAgICAgIGlmIChnbG9iYWxSZWZzPy5yb290KSBzZXRXaWRnZXRWaXNpYmxlKGdsb2JhbFJlZnMucm9vdCwgZmFsc2UpOwogICAgfQp9CgpmdW5jdGlvbiBoaWRlT3ZlcnRpbWVVaUZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICAvLyBIaWRlIGJvdGggaW4tem9uZSBhbmQgb3V0LW9mLXpvbmUgSFVEIHJvb3RzLgogICAgLy8gUm91bmQtZW5kIHRlYXJkb3duOiBhdm9pZCB0b3VjaGluZyB3aWRnZXQgdmlzaWJpbGl0eS4KICAgIGlmIChpc1JvdW5kRW5kVWlMb2NrZG93bkFjdGl2ZSgpKSByZXR1cm47CiAgICBjb25zdCB6b25lUGlkcyA9IE9iamVjdC5rZXlzKFN0YXRlLmZsYWcudWlCeVBpZCk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHpvbmVQaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgcGlkID0gTnVtYmVyKHpvbmVQaWRzW2ldKTsKICAgICAgICBjb25zdCByZWZzID0gU3RhdGUuZmxhZy51aUJ5UGlkW3BpZF07CiAgICAgICAgaWYgKHJlZnM/LnJvb3QpIHNldFdpZGdldFZpc2libGUocmVmcy5yb290LCBmYWxzZSk7CiAgICB9CiAgICBjb25zdCBnbG9iYWxQaWRzID0gT2JqZWN0LmtleXMoU3RhdGUuZmxhZy5nbG9iYWxVaUJ5UGlkKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2xvYmFsUGlkcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHBpZCA9IE51bWJlcihnbG9iYWxQaWRzW2ldKTsKICAgICAgICBjb25zdCByZWZzID0gU3RhdGUuZmxhZy5nbG9iYWxVaUJ5UGlkW3BpZF07CiAgICAgICAgaWYgKHJlZnM/LnJvb3QpIHNldFdpZGdldFZpc2libGUocmVmcy5yb290LCBmYWxzZSk7CiAgICB9Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBPdmVydGltZSBGbGFnIENhcHR1cmUgLSBIVUQgVXBkYXRlICsgVmlzaWJpbGl0eSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gT3ZlcnRpbWUgRmxhZyBDYXB0dXJlIC0gSFVEIEJ1aWxkICsgQ2FjaGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIHNhZmVEZWxldGVVaVdpZGdldCh3aWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCk6IHZvaWQgewogICAgaWYgKCF3aWRnZXQpIHJldHVybjsKICAgIHRyeSB7CiAgICAgICAgbW9kLkRlbGV0ZVVJV2lkZ2V0KHdpZGdldCk7CiAgICB9IGNhdGNoIHsKICAgICAgICByZXR1cm47CiAgICB9Cn0KCmZ1bmN0aW9uIGRyb3BPdmVydGltZVVpUmVmc0ZvclBsYXllcklkKHBpZDogbnVtYmVyKTogdm9pZCB7CiAgICBkZWxldGUgU3RhdGUuZmxhZy51aUJ5UGlkW3BpZF07CiAgICBkZWxldGUgU3RhdGUuZmxhZy5nbG9iYWxVaUJ5UGlkW3BpZF07CiAgICBkZWxldGUgU3RhdGUuZmxhZy5sYXN0VWlTbmFwc2hvdEJ5UGlkW3BpZF07Cn0KCmZ1bmN0aW9uIGRlbGV0ZU92ZXJ0aW1lVWlGb3JQbGF5ZXJJZChwaWQ6IG51bWJlcik6IHZvaWQgewogICAgLy8gUm91bmQtZW5kIHRlYXJkb3duOiBkcm9wIHJlZnMgd2l0aG91dCBkZWxldGluZyB3aWRnZXRzLgogICAgaWYgKGlzUm91bmRFbmRVaUxvY2tkb3duQWN0aXZlKCkpIHsKICAgICAgICBkcm9wT3ZlcnRpbWVVaVJlZnNGb3JQbGF5ZXJJZChwaWQpOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIC8vIEhhcmQgZGVsZXRlIHdpZGdldHMgZm9yIGRpc2Nvbm5lY3QgY2xlYW51cC4KICAgIGNvbnN0IHJlZnMgPSBTdGF0ZS5mbGFnLnVpQnlQaWRbcGlkXTsKICAgIGlmIChyZWZzKSB7CiAgICAgICAgc2FmZURlbGV0ZVVpV2lkZ2V0KHJlZnMucm9vdCk7CiAgICAgICAgc2FmZURlbGV0ZVVpV2lkZ2V0KHJlZnMuYmFyQmcpOwogICAgICAgIHNhZmVEZWxldGVVaVdpZGdldChyZWZzLmJhckZpbGxUMSk7CiAgICAgICAgc2FmZURlbGV0ZVVpV2lkZ2V0KHJlZnMuYmFyRmlsbFQyKTsKICAgICAgICBzYWZlRGVsZXRlVWlXaWRnZXQocmVmcy50aXRsZSk7CiAgICAgICAgc2FmZURlbGV0ZVVpV2lkZ2V0KHJlZnMudGl0bGVTaGFkb3cpOwogICAgICAgIHNhZmVEZWxldGVVaVdpZGdldChyZWZzLnN0YXR1cyk7CiAgICAgICAgc2FmZURlbGV0ZVVpV2lkZ2V0KHJlZnMuY291bnRzTGVmdCk7CiAgICAgICAgc2FmZURlbGV0ZVVpV2lkZ2V0KHJlZnMuY291bnRzUmlnaHQpOwogICAgICAgIHNhZmVEZWxldGVVaVdpZGdldChyZWZzLmNvdW50c0xlZnRCb3JkZXIpOwogICAgICAgIHNhZmVEZWxldGVVaVdpZGdldChyZWZzLmNvdW50c1JpZ2h0Qm9yZGVyKTsKICAgICAgICBzYWZlRGVsZXRlVWlXaWRnZXQocmVmcy5wZXJjZW50TGVmdEJnKTsKICAgICAgICBzYWZlRGVsZXRlVWlXaWRnZXQocmVmcy5wZXJjZW50UmlnaHRCZyk7CiAgICAgICAgc2FmZURlbGV0ZVVpV2lkZ2V0KHJlZnMucGVyY2VudExlZnQpOwogICAgICAgIHNhZmVEZWxldGVVaVdpZGdldChyZWZzLnBlcmNlbnRSaWdodCk7CiAgICAgICAgc2FmZURlbGV0ZVVpV2lkZ2V0KHJlZnMuY291bnRzTGVmdENyb3duKTsKICAgICAgICBzYWZlRGVsZXRlVWlXaWRnZXQocmVmcy5jb3VudHNSaWdodENyb3duKTsKICAgICAgICBzYWZlRGVsZXRlVWlXaWRnZXQocmVmcy5zdGF0dXNTaGFkb3cpOwogICAgICAgIHNhZmVEZWxldGVVaVdpZGdldChyZWZzLnZlaGljbGVSZXF1aXJlZCk7CiAgICB9CiAgICBjb25zdCBnbG9iYWxSZWZzID0gU3RhdGUuZmxhZy5nbG9iYWxVaUJ5UGlkW3BpZF07CiAgICBpZiAoZ2xvYmFsUmVmcykgewogICAgICAgIHNhZmVEZWxldGVVaVdpZGdldChnbG9iYWxSZWZzLnJvb3QpOwogICAgICAgIHNhZmVEZWxldGVVaVdpZGdldChnbG9iYWxSZWZzLmJhckJnKTsKICAgICAgICBzYWZlRGVsZXRlVWlXaWRnZXQoZ2xvYmFsUmVmcy5iYXJGaWxsVDEpOwogICAgICAgIHNhZmVEZWxldGVVaVdpZGdldChnbG9iYWxSZWZzLmJhckZpbGxUMik7CiAgICAgICAgc2FmZURlbGV0ZVVpV2lkZ2V0KGdsb2JhbFJlZnMudGl0bGUpOwogICAgfQogICAgZGVsZXRlIFN0YXRlLmZsYWcudWlCeVBpZFtwaWRdOwogICAgZGVsZXRlIFN0YXRlLmZsYWcuZ2xvYmFsVWlCeVBpZFtwaWRdOwogICAgZGVsZXRlIFN0YXRlLmZsYWcubGFzdFVpU25hcHNob3RCeVBpZFtwaWRdOwp9CgpmdW5jdGlvbiBlbnN1cmVPdmVydGltZUh1ZEZvclBsYXllcihwbGF5ZXI6IG1vZC5QbGF5ZXIpOiBPdmVydGltZUZsYWdIdWRSZWZzIHwgdW5kZWZpbmVkIHsKICAgIC8vIEluLXpvbmUgSFVEOiBzdGF0dXMsIGNvdW50cywgYW5kIGNhcHR1cmUgYmFyLgogICAgLy8gVGV4dCB3aWRnZXRzIGFyZSBidWlsdCB2aWEgbW9kbGliLlBhcnNlVUk7IHRoZSBiYXIgdXNlcyBBZGRVSUNvbnRhaW5lciBmb3IgZHluYW1pYyB3aWR0aCB1cGRhdGVzLgogICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIHJldHVybiB1bmRlZmluZWQ7CiAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocGxheWVyKTsKICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIGlmIChpc1BpZERpc2Nvbm5lY3RlZChwaWQpKSByZXR1cm4gdW5kZWZpbmVkOwogICAgY29uc3Qgcm9vdE5hbWUgPSBgT3ZlcnRpbWVGbGFnUm9vdF8ke3BpZH1gOwogICAgY29uc3QgY2FjaGVkID0gU3RhdGUuZmxhZy51aUJ5UGlkW3BpZF07CiAgICBjb25zdCBleGlzdGluZ1Jvb3QgPSBzYWZlRmluZChyb290TmFtZSk7CiAgICBpZiAoY2FjaGVkICYmIGNhY2hlZC5yb290ICYmIGV4aXN0aW5nUm9vdCkgcmV0dXJuIGNhY2hlZDsKICAgIGlmIChleGlzdGluZ1Jvb3QpIHsKICAgICAgICAvLyBSZWh5ZHJhdGUgcmVmcyBpZiB3aWRnZXRzIGFscmVhZHkgZXhpc3QgKGUuZy4sIHJlY29ubmVjdCBvciBjYWNoZWQgVUkgcmVtbmFudHMpLgogICAgICAgIGNvbnN0IHJlZnM6IE92ZXJ0aW1lRmxhZ0h1ZFJlZnMgPSB7CiAgICAgICAgICAgIHJvb3Q6IGV4aXN0aW5nUm9vdCwKICAgICAgICAgICAgdGl0bGU6IHNhZmVGaW5kKGBPdmVydGltZUZsYWdfVGl0bGVfJHtwaWR9YCksCiAgICAgICAgICAgIHRpdGxlU2hhZG93OiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1RpdGxlU2hhZG93XyR7cGlkfWApLAogICAgICAgICAgICBjb3VudHNMZWZ0OiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX0NvdW50c0xlZnRfJHtwaWR9YCksCiAgICAgICAgICAgIGNvdW50c1JpZ2h0OiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX0NvdW50c1JpZ2h0XyR7cGlkfWApLAogICAgICAgICAgICBjb3VudHNMZWZ0Qm9yZGVyOiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX0NvdW50c0xlZnRfQm9yZGVyXyR7cGlkfWApLAogICAgICAgICAgICBjb3VudHNSaWdodEJvcmRlcjogc2FmZUZpbmQoYE92ZXJ0aW1lRmxhZ19Db3VudHNSaWdodF9Cb3JkZXJfJHtwaWR9YCksCiAgICAgICAgICAgIHBlcmNlbnRMZWZ0Qmc6IHNhZmVGaW5kKGBPdmVydGltZUZsYWdfUGVyY2VudExlZnRfJHtwaWR9YCksCiAgICAgICAgICAgIHBlcmNlbnRSaWdodEJnOiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1BlcmNlbnRSaWdodF8ke3BpZH1gKSwKICAgICAgICAgICAgcGVyY2VudExlZnQ6IHNhZmVGaW5kKGBPdmVydGltZUZsYWdfUGVyY2VudExlZnRfVGV4dF8ke3BpZH1gKSwKICAgICAgICAgICAgcGVyY2VudFJpZ2h0OiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1BlcmNlbnRSaWdodF9UZXh0XyR7cGlkfWApLAogICAgICAgICAgICBjb3VudHNMZWZ0Q3Jvd246IHNhZmVGaW5kKGBPdmVydGltZUZsYWdfQ291bnRzTGVmdF9Dcm93bl8ke3BpZH1gKSwKICAgICAgICAgICAgY291bnRzUmlnaHRDcm93bjogc2FmZUZpbmQoYE92ZXJ0aW1lRmxhZ19Db3VudHNSaWdodF9Dcm93bl8ke3BpZH1gKSwKICAgICAgICAgICAgc3RhdHVzOiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1N0YXR1c18ke3BpZH1gKSwKICAgICAgICAgICAgc3RhdHVzU2hhZG93OiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1N0YXR1c1NoYWRvd18ke3BpZH1gKSwKICAgICAgICAgICAgdmVoaWNsZVJlcXVpcmVkOiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1ZlaGljbGVSZXF1aXJlZF8ke3BpZH1gKSwKICAgICAgICAgICAgYmFyQmc6IHNhZmVGaW5kKGBPdmVydGltZUZsYWdfQmFyQmdfJHtwaWR9YCksCiAgICAgICAgICAgIGJhckZpbGxUMTogc2FmZUZpbmQoYE92ZXJ0aW1lRmxhZ19CYXJGaWxsVDFfJHtwaWR9YCksCiAgICAgICAgICAgIGJhckZpbGxUMjogc2FmZUZpbmQoYE92ZXJ0aW1lRmxhZ19CYXJGaWxsVDJfJHtwaWR9YCksCiAgICAgICAgfTsKICAgICAgICBTdGF0ZS5mbGFnLnVpQnlQaWRbcGlkXSA9IHJlZnM7CiAgICAgICAgcmV0dXJuIHJlZnM7CiAgICB9CgogICAgdHJ5IHsKICAgICAgICBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgICAgIG5hbWU6IHJvb3ROYW1lLAogICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICBwb3NpdGlvbjogW09WRVJUSU1FX1VJX09GRlNFVF9YLCBPVkVSVElNRV9VSV9PRkZTRVRfWV0sCiAgICAgICAgICAgIHNpemU6IFtPVkVSVElNRV9VSV9XSURUSCwgT1ZFUlRJTUVfVUlfSEVJR0hUXSwKICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYE92ZXJ0aW1lRmxhZ19UaXRsZVNoYWRvd18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogW0hVRF9URVhUX1NIQURPV19PRkZTRVRfWCwgMTggKyBIVURfVEVYVF9TSEFET1dfT0ZGU0VUX1ldLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFtPVkVSVElNRV9VSV9XSURUSCwgMThdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogU1RSX0ZMQUdfVElUTEUsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMCwgMCwgMF0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxNiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgT3ZlcnRpbWVGbGFnX1RpdGxlXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMThdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFtPVkVSVElNRV9VSV9XSURUSCwgMThdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogU1RSX0ZMQUdfVElUTEUsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxNiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgT3ZlcnRpbWVGbGFnX0NvdW50c0xlZnRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFstT1ZFUlRJTUVfQ09VTlRfT0ZGU0VUX1gsIE9WRVJUSU1FX0NPVU5UX09GRlNFVF9ZXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbT1ZFUlRJTUVfQ09VTlRfVEVYVF9XSURUSCwgT1ZFUlRJTUVfQ09VTlRfVEVYVF9IRUlHSFRdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogT1ZFUlRJTUVfQ09VTlRfVDFfUkdCLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IE9WRVJUSU1FX0NPVU5UX0JHX0FMUEhBLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLkJsdXIsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShTVFJfRkxBR19DT1VOVFNfTEVGVF9GT1JNQVQsIDApLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogT1ZFUlRJTUVfQ09VTlRfVEVYVF9SR0IsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiBPVkVSVElNRV9DT1VOVF9URVhUX1NJWkUsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYE92ZXJ0aW1lRmxhZ19Db3VudHNSaWdodF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogW09WRVJUSU1FX0NPVU5UX09GRlNFVF9YLCBPVkVSVElNRV9DT1VOVF9PRkZTRVRfWV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW09WRVJUSU1FX0NPVU5UX1RFWFRfV0lEVEgsIE9WRVJUSU1FX0NPVU5UX1RFWFRfSEVJR0hUXSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IE9WRVJUSU1FX0NPVU5UX1QyX1JHQiwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiBPVkVSVElNRV9DT1VOVF9CR19BTFBIQSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5CbHVyLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UoU1RSX0ZMQUdfQ09VTlRTX1JJR0hUX0ZPUk1BVCwgMCksCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBPVkVSVElNRV9DT1VOVF9URVhUX1JHQiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IE9WRVJUSU1FX0NPVU5UX1RFWFRfU0laRSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgT3ZlcnRpbWVGbGFnX1BlcmNlbnRMZWZ0XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFstT1ZFUlRJTUVfUEVSQ0VOVF9PRkZTRVRfWCwgT1ZFUlRJTUVfUEVSQ0VOVF9PRkZTRVRfWV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW09WRVJUSU1FX1BFUkNFTlRfVEVYVF9XSURUSCwgT1ZFUlRJTUVfUEVSQ0VOVF9URVhUX0hFSUdIVF0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBPVkVSVElNRV9DT1VOVF9UMV9SR0IsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogT1ZFUlRJTUVfQ09VTlRfQkdfQUxQSEEsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgT3ZlcnRpbWVGbGFnX1BlcmNlbnRMZWZ0X1RleHRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbLU9WRVJUSU1FX1BFUkNFTlRfVEVYVF9OVURHRSwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbT1ZFUlRJTUVfUEVSQ0VOVF9URVhUX1dJRFRILCBPVkVSVElNRV9QRVJDRU5UX1RFWFRfSEVJR0hUXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKFNUUl9GTEFHX1BST0dSRVNTX0ZPUk1BVCwgNTApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBPVkVSVElNRV9DT1VOVF9URVhUX1JHQiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiBPVkVSVElNRV9QRVJDRU5UX1RFWFRfU0laRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXJSaWdodCwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgT3ZlcnRpbWVGbGFnX1BlcmNlbnRSaWdodF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJDb250YWluZXIiLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbT1ZFUlRJTUVfUEVSQ0VOVF9PRkZTRVRfWCwgT1ZFUlRJTUVfUEVSQ0VOVF9PRkZTRVRfWV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW09WRVJUSU1FX1BFUkNFTlRfVEVYVF9XSURUSCwgT1ZFUlRJTUVfUEVSQ0VOVF9URVhUX0hFSUdIVF0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBPVkVSVElNRV9DT1VOVF9UMl9SR0IsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogT1ZFUlRJTUVfQ09VTlRfQkdfQUxQSEEsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgT3ZlcnRpbWVGbGFnX1BlcmNlbnRSaWdodF9UZXh0XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogW09WRVJUSU1FX1BFUkNFTlRfVEVYVF9OVURHRSwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbT1ZFUlRJTUVfUEVSQ0VOVF9URVhUX1dJRFRILCBPVkVSVElNRV9QRVJDRU5UX1RFWFRfSEVJR0hUXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKFNUUl9GTEFHX1BST0dSRVNTX0ZPUk1BVCwgNTApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBPVkVSVElNRV9DT1VOVF9URVhUX1JHQiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiBPVkVSVElNRV9QRVJDRU5UX1RFWFRfU0laRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXJMZWZ0LAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBPdmVydGltZUZsYWdfQ291bnRzTGVmdF9Dcm93bl8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJJbWFnZSIsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFstT1ZFUlRJTUVfUEVSQ0VOVF9PRkZTRVRfWCwgT1ZFUlRJTUVfUEVSQ0VOVF9DUk9XTl9PRkZTRVRfWV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW09WRVJUSU1FX0NPVU5UX0NST1dOX1NJWkUsIE9WRVJUSU1FX0NPVU5UX0NST1dOX1NJWkVdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICBpbWFnZVR5cGU6IG1vZC5VSUltYWdlVHlwZS5Dcm93blNvbGlkLAogICAgICAgICAgICAgICAgICAgIGltYWdlQ29sb3I6IE9WRVJUSU1FX0NPVU5UX0NST1dOX1JHQiwKICAgICAgICAgICAgICAgICAgICBpbWFnZUFscGhhOiBPVkVSVElNRV9DT1VOVF9DUk9XTl9BTFBIQSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYE92ZXJ0aW1lRmxhZ19Db3VudHNSaWdodF9Dcm93bl8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJJbWFnZSIsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFtPVkVSVElNRV9QRVJDRU5UX09GRlNFVF9YLCBPVkVSVElNRV9QRVJDRU5UX0NST1dOX09GRlNFVF9ZXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbT1ZFUlRJTUVfQ09VTlRfQ1JPV05fU0laRSwgT1ZFUlRJTUVfQ09VTlRfQ1JPV05fU0laRV0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIGltYWdlVHlwZTogbW9kLlVJSW1hZ2VUeXBlLkNyb3duU29saWQsCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VDb2xvcjogT1ZFUlRJTUVfQ09VTlRfQ1JPV05fUkdCLAogICAgICAgICAgICAgICAgICAgIGltYWdlQWxwaGE6IE9WRVJUSU1FX0NPVU5UX0NST1dOX0FMUEhBLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgT3ZlcnRpbWVGbGFnX1N0YXR1c1NoYWRvd18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogW0hVRF9URVhUX1NIQURPV19PRkZTRVRfWCwgNTQgKyBIVURfVEVYVF9TSEFET1dfT0ZGU0VUX1ldLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFtPVkVSVElNRV9VSV9XSURUSCwgMTZdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogU1RSX0ZMQUdfU1RBVFVTX1NUQUxMRUQsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMCwgMCwgMF0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxNCwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgT3ZlcnRpbWVGbGFnX1N0YXR1c18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDU0XSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbT1ZFUlRJTUVfVUlfV0lEVEgsIDE2XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IFNUUl9GTEFHX1NUQVRVU19TVEFMTEVELAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTQsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYE92ZXJ0aW1lRmxhZ19WZWhpY2xlUmVxdWlyZWRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCA3MF0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW09WRVJUSU1FX1VJX1dJRFRILCAxNF0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogU1RSX0ZMQUdfVkVISUNMRV9SRVFVSVJFRCwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgIH0pOwogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICBjb25zdCByb290ID0gc2FmZUZpbmQocm9vdE5hbWUpOwogICAgaWYgKCFyb290KSByZXR1cm4gdW5kZWZpbmVkOwogICAgc2FmZVNldFVJV2lkZ2V0RGVwdGgocm9vdCwgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUkpOwoKICAgIGNvbnN0IGNvdW50c0xlZnQgPSBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX0NvdW50c0xlZnRfJHtwaWR9YCk7CiAgICBjb25zdCBjb3VudHNSaWdodCA9IHNhZmVGaW5kKGBPdmVydGltZUZsYWdfQ291bnRzUmlnaHRfJHtwaWR9YCk7CgogICAgY29uc3QgY291bnRzTGVmdEJvcmRlcklkID0gYE92ZXJ0aW1lRmxhZ19Db3VudHNMZWZ0X0JvcmRlcl8ke3BpZH1gOwogICAgc2FmZUFkZFVJQ29udGFpbmVyKAogICAgICAgIGNvdW50c0xlZnRCb3JkZXJJZCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC1PVkVSVElNRV9DT1VOVF9PRkZTRVRfWCwgT1ZFUlRJTUVfQ09VTlRfT0ZGU0VUX1kgLSBPVkVSVElNRV9DT1VOVF9CT1JERVJfR1JPVywgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigKICAgICAgICAgICAgT1ZFUlRJTUVfQ09VTlRfVEVYVF9XSURUSCArIChPVkVSVElNRV9DT1VOVF9CT1JERVJfR1JPVyAqIDIpLAogICAgICAgICAgICBPVkVSVElNRV9DT1VOVF9URVhUX0hFSUdIVCArIChPVkVSVElNRV9DT1VOVF9CT1JERVJfR1JPVyAqIDIpLAogICAgICAgICAgICAwCiAgICAgICAgKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgIHJvb3QsCiAgICAgICAgdHJ1ZSwKICAgICAgICAwLAogICAgICAgIENPTE9SX0JMVUUsCiAgICAgICAgT1ZFUlRJTUVfQ09VTlRfQk9SREVSX0FMUEhBLAogICAgICAgIG1vZC5VSUJnRmlsbC5PdXRsaW5lVGhpbiwKICAgICAgICBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSwKICAgICAgICBwbGF5ZXIKICAgICk7CiAgICBjb25zdCBjb3VudHNMZWZ0Qm9yZGVyID0gc2FmZUZpbmQoY291bnRzTGVmdEJvcmRlcklkKTsKCiAgICBjb25zdCBjb3VudHNSaWdodEJvcmRlcklkID0gYE92ZXJ0aW1lRmxhZ19Db3VudHNSaWdodF9Cb3JkZXJfJHtwaWR9YDsKICAgIHNhZmVBZGRVSUNvbnRhaW5lcigKICAgICAgICBjb3VudHNSaWdodEJvcmRlcklkLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoT1ZFUlRJTUVfQ09VTlRfT0ZGU0VUX1gsIE9WRVJUSU1FX0NPVU5UX09GRlNFVF9ZIC0gT1ZFUlRJTUVfQ09VTlRfQk9SREVSX0dST1csIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoCiAgICAgICAgICAgIE9WRVJUSU1FX0NPVU5UX1RFWFRfV0lEVEggKyAoT1ZFUlRJTUVfQ09VTlRfQk9SREVSX0dST1cgKiAyKSwKICAgICAgICAgICAgT1ZFUlRJTUVfQ09VTlRfVEVYVF9IRUlHSFQgKyAoT1ZFUlRJTUVfQ09VTlRfQk9SREVSX0dST1cgKiAyKSwKICAgICAgICAgICAgMAogICAgICAgICksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICByb290LAogICAgICAgIHRydWUsCiAgICAgICAgMCwKICAgICAgICBDT0xPUl9SRUQsCiAgICAgICAgT1ZFUlRJTUVfQ09VTlRfQk9SREVSX0FMUEhBLAogICAgICAgIG1vZC5VSUJnRmlsbC5PdXRsaW5lVGhpbiwKICAgICAgICBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSwKICAgICAgICBwbGF5ZXIKICAgICk7CiAgICBjb25zdCBjb3VudHNSaWdodEJvcmRlciA9IHNhZmVGaW5kKGNvdW50c1JpZ2h0Qm9yZGVySWQpOwoKICAgIGNvbnN0IGJhckJnSWQgPSBgT3ZlcnRpbWVGbGFnX0JhckJnXyR7cGlkfWA7CiAgICBzYWZlQWRkVUlDb250YWluZXIoCiAgICAgICAgYmFyQmdJZCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIE9WRVJUSU1FX0JBUl9PRkZTRVRfWSwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihPVkVSVElNRV9CQVJfV0lEVEgsIE9WRVJUSU1FX0JBUl9IRUlHSFQsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgcm9vdCwKICAgICAgICB0cnVlLAogICAgICAgIDAsCiAgICAgICAgQ09MT1JfQkxVRV9EQVJLLAogICAgICAgIE9WRVJUSU1FX0JBUl9CR19BTFBIQSwKICAgICAgICBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgcGxheWVyCiAgICApOwogICAgY29uc3QgYmFyQmcgPSBzYWZlRmluZChiYXJCZ0lkKTsKICAgIGlmIChiYXJCZykgewogICAgICAgIGNvbnN0IGZpbGxUMUlkID0gYE92ZXJ0aW1lRmxhZ19CYXJGaWxsVDFfJHtwaWR9YDsKICAgICAgICBzYWZlQWRkVUlDb250YWluZXIoCiAgICAgICAgICAgIGZpbGxUMUlkLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDAsIDApLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKE9WRVJUSU1FX0JBUl9XSURUSCwgT1ZFUlRJTUVfQkFSX0hFSUdIVCwgMCksCiAgICAgICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICBiYXJCZywKICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgQ09MT1JfQkxVRSwKICAgICAgICAgICAgT1ZFUlRJTUVfQkFSX0ZJTExfQUxQSEEsCiAgICAgICAgICAgIG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgICAgIHBsYXllcgogICAgICAgICk7CgogICAgICAgIGNvbnN0IGZpbGxUMklkID0gYE92ZXJ0aW1lRmxhZ19CYXJGaWxsVDJfJHtwaWR9YDsKICAgICAgICBzYWZlQWRkVUlDb250YWluZXIoCiAgICAgICAgICAgIGZpbGxUMklkLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDAsIDApLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKE9WRVJUSU1FX0JBUl9XSURUSCwgT1ZFUlRJTUVfQkFSX0hFSUdIVCwgMCksCiAgICAgICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICAgICAgYmFyQmcsCiAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIENPTE9SX1JFRCwKICAgICAgICAgICAgT1ZFUlRJTUVfQkFSX0ZJTExfQUxQSEEsCiAgICAgICAgICAgIG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgICAgIHBsYXllcgogICAgICAgICk7CiAgICB9CgogICAgY29uc3QgcmVmczogT3ZlcnRpbWVGbGFnSHVkUmVmcyA9IHsKICAgICAgICByb290LAogICAgICAgIHRpdGxlOiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1RpdGxlXyR7cGlkfWApLAogICAgICAgIHRpdGxlU2hhZG93OiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1RpdGxlU2hhZG93XyR7cGlkfWApLAogICAgICAgIGNvdW50c0xlZnQsCiAgICAgICAgY291bnRzUmlnaHQsCiAgICAgICAgY291bnRzTGVmdEJvcmRlciwKICAgICAgICBjb3VudHNSaWdodEJvcmRlciwKICAgICAgICBwZXJjZW50TGVmdEJnOiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1BlcmNlbnRMZWZ0XyR7cGlkfWApLAogICAgICAgIHBlcmNlbnRSaWdodEJnOiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1BlcmNlbnRSaWdodF8ke3BpZH1gKSwKICAgICAgICBwZXJjZW50TGVmdDogc2FmZUZpbmQoYE92ZXJ0aW1lRmxhZ19QZXJjZW50TGVmdF9UZXh0XyR7cGlkfWApLAogICAgICAgIHBlcmNlbnRSaWdodDogc2FmZUZpbmQoYE92ZXJ0aW1lRmxhZ19QZXJjZW50UmlnaHRfVGV4dF8ke3BpZH1gKSwKICAgICAgICBjb3VudHNMZWZ0Q3Jvd246IHNhZmVGaW5kKGBPdmVydGltZUZsYWdfQ291bnRzTGVmdF9Dcm93bl8ke3BpZH1gKSwKICAgICAgICBjb3VudHNSaWdodENyb3duOiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX0NvdW50c1JpZ2h0X0Nyb3duXyR7cGlkfWApLAogICAgICAgIHN0YXR1czogc2FmZUZpbmQoYE92ZXJ0aW1lRmxhZ19TdGF0dXNfJHtwaWR9YCksCiAgICAgICAgc3RhdHVzU2hhZG93OiBzYWZlRmluZChgT3ZlcnRpbWVGbGFnX1N0YXR1c1NoYWRvd18ke3BpZH1gKSwKICAgICAgICB2ZWhpY2xlUmVxdWlyZWQ6IHNhZmVGaW5kKGBPdmVydGltZUZsYWdfVmVoaWNsZVJlcXVpcmVkXyR7cGlkfWApLAogICAgICAgIGJhckJnOiBiYXJCZywKICAgICAgICBiYXJGaWxsVDE6IHNhZmVGaW5kKGBPdmVydGltZUZsYWdfQmFyRmlsbFQxXyR7cGlkfWApLAogICAgICAgIGJhckZpbGxUMjogc2FmZUZpbmQoYE92ZXJ0aW1lRmxhZ19CYXJGaWxsVDJfJHtwaWR9YCksCiAgICB9OwogICAgU3RhdGUuZmxhZy51aUJ5UGlkW3BpZF0gPSByZWZzOwogICAgcmV0dXJuIHJlZnM7Cn0KCi8vIFRPRE8oMS4wKTogVW51c2VkOyByZW1vdmUgYmVmb3JlIGZpbmFsIDEuMCByZWxlYXNlLgpmdW5jdGlvbiBlbnN1cmVPdmVydGltZUdsb2JhbEh1ZEZvclBsYXllcihwbGF5ZXI6IG1vZC5QbGF5ZXIpOiBPdmVydGltZUZsYWdHbG9iYWxIdWRSZWZzIHwgdW5kZWZpbmVkIHsKICAgIC8vIEdsb2JhbCBIVUQ6IGNvbXBhY3QgbGFiZWwgKyBwcm9ncmVzcyBiYXIgZm9yIG91dC1vZi16b25lIHBsYXllcnMuCiAgICAvLyBUaGlzIHN0YXlzIGxpZ2h0d2VpZ2h0IHNvIGl0IGNhbiBiZSBzaG93biB0byBhbGwgb3V0LW9mLXpvbmUgcGxheWVycy4KICAgIGlmICghcGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXIpKSByZXR1cm4gdW5kZWZpbmVkOwogICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICBpZiAocGlkID09PSB1bmRlZmluZWQpIHJldHVybiB1bmRlZmluZWQ7CiAgICBpZiAoaXNQaWREaXNjb25uZWN0ZWQocGlkKSkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIGNvbnN0IHJvb3ROYW1lID0gYE92ZXJ0aW1lR2xvYmFsUm9vdF8ke3BpZH1gOwogICAgY29uc3QgY2FjaGVkID0gU3RhdGUuZmxhZy5nbG9iYWxVaUJ5UGlkW3BpZF07CiAgICBpZiAoY2FjaGVkICYmIGNhY2hlZC5yb290ICYmIHNhZmVGaW5kKHJvb3ROYW1lKSkgcmV0dXJuIGNhY2hlZDsKCiAgICB0cnkgewogICAgICAgIG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICAgICAgbmFtZTogcm9vdE5hbWUsCiAgICAgICAgICAgIHR5cGU6ICJDb250YWluZXIiLAogICAgICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgIHBvc2l0aW9uOiBbT1ZFUlRJTUVfR0xPQkFMX1VJX09GRlNFVF9YLCBPVkVSVElNRV9HTE9CQUxfVUlfT0ZGU0VUX1ldLAogICAgICAgICAgICBzaXplOiBbT1ZFUlRJTUVfR0xPQkFMX1VJX1dJRFRILCBPVkVSVElNRV9HTE9CQUxfVUlfSEVJR0hUXSwKICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYE92ZXJ0aW1lR2xvYmFsX1RpdGxlXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgNF0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogW09WRVJUSU1FX0dMT0JBTF9VSV9XSURUSCwgMTZdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogU1RSX0ZMQUdfVElUTEUsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxNCwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXSwKICAgICAgICB9KTsKICAgIH0gY2F0Y2ggewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgY29uc3Qgcm9vdCA9IHNhZmVGaW5kKHJvb3ROYW1lKTsKICAgIGlmICghcm9vdCkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIHNhZmVTZXRVSVdpZGdldERlcHRoKHJvb3QsIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJKTsKCiAgICBjb25zdCBiYXJCZ0lkID0gYE92ZXJ0aW1lR2xvYmFsX0JhckJnXyR7cGlkfWA7CiAgICBzYWZlQWRkVUlDb250YWluZXIoCiAgICAgICAgYmFyQmdJZCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIE9WRVJUSU1FX0dMT0JBTF9CQVJfT0ZGU0VUX1ksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoT1ZFUlRJTUVfR0xPQkFMX0JBUl9XSURUSCwgT1ZFUlRJTUVfR0xPQkFMX0JBUl9IRUlHSFQsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgcm9vdCwKICAgICAgICB0cnVlLAogICAgICAgIDAsCiAgICAgICAgQ09MT1JfQkxVRV9EQVJLLAogICAgICAgIE9WRVJUSU1FX0JBUl9CR19BTFBIQSwKICAgICAgICBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgcGxheWVyCiAgICApOwogICAgY29uc3QgYmFyQmcgPSBzYWZlRmluZChiYXJCZ0lkKTsKICAgIGlmIChiYXJCZykgewogICAgICAgIGNvbnN0IGZpbGxUMUlkID0gYE92ZXJ0aW1lR2xvYmFsX0JhckZpbGxUMV8ke3BpZH1gOwogICAgICAgIHNhZmVBZGRVSUNvbnRhaW5lcigKICAgICAgICAgICAgZmlsbFQxSWQsCiAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCksCiAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoT1ZFUlRJTUVfR0xPQkFMX0JBUl9XSURUSCwgT1ZFUlRJTUVfR0xPQkFMX0JBUl9IRUlHSFQsIDApLAogICAgICAgICAgICBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgYmFyQmcsCiAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIENPTE9SX0JMVUUsCiAgICAgICAgICAgIE9WRVJUSU1FX0JBUl9GSUxMX0FMUEhBLAogICAgICAgICAgICBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgICAgIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJLAogICAgICAgICAgICBwbGF5ZXIKICAgICAgICApOwoKICAgICAgICBjb25zdCBmaWxsVDJJZCA9IGBPdmVydGltZUdsb2JhbF9CYXJGaWxsVDJfJHtwaWR9YDsKICAgICAgICBzYWZlQWRkVUlDb250YWluZXIoCiAgICAgICAgICAgIGZpbGxUMklkLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDAsIDApLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKE9WRVJUSU1FX0dMT0JBTF9CQVJfV0lEVEgsIE9WRVJUSU1FX0dMT0JBTF9CQVJfSEVJR0hULCAwKSwKICAgICAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgICAgICBiYXJCZywKICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgQ09MT1JfUkVELAogICAgICAgICAgICBPVkVSVElNRV9CQVJfRklMTF9BTFBIQSwKICAgICAgICAgICAgbW9kLlVJQmdGaWxsLlNvbGlkLAogICAgICAgICAgICBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSwKICAgICAgICAgICAgcGxheWVyCiAgICAgICAgKTsKICAgIH0KCiAgICBjb25zdCByZWZzOiBPdmVydGltZUZsYWdHbG9iYWxIdWRSZWZzID0gewogICAgICAgIHJvb3QsCiAgICAgICAgdGl0bGU6IHNhZmVGaW5kKGBPdmVydGltZUdsb2JhbF9UaXRsZV8ke3BpZH1gKSwKICAgICAgICBiYXJCZzogYmFyQmcsCiAgICAgICAgYmFyRmlsbFQxOiBzYWZlRmluZChgT3ZlcnRpbWVHbG9iYWxfQmFyRmlsbFQxXyR7cGlkfWApLAogICAgICAgIGJhckZpbGxUMjogc2FmZUZpbmQoYE92ZXJ0aW1lR2xvYmFsX0JhckZpbGxUMl8ke3BpZH1gKSwKICAgIH07CiAgICBTdGF0ZS5mbGFnLmdsb2JhbFVpQnlQaWRbcGlkXSA9IHJlZnM7CiAgICByZXR1cm4gcmVmczsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE92ZXJ0aW1lIEZsYWcgQ2FwdHVyZSAtIEhVRCBCdWlsZCArIENhY2hlIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBPdmVydGltZSBGbGFnIENhcHR1cmUgLSBTdGFnZSBUcmFuc2l0aW9ucyArIE1lc3NhZ2luZyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gdXBkYXRlT3ZlcnRpbWVTdGFnZSgpOiB2b2lkIHsKICAgIC8vIFN0YWdlIHRyYW5zaXRpb25zIGFyZSBkcml2ZW4gYnkgdGhlIHJvdW5kIGNsb2NrLgogICAgLy8gQ2hlY2tzIHJ1biBmcm9tIGxhdGVzdCB0byBlYXJsaWVzdCB0byB0b2xlcmF0ZSBhZG1pbiB0aW1lIGp1bXBzLgogICAgY29uc3QgaGVsaXNTaW5nbGVab25lID0gaXNIZWxpc092ZXJ0aW1lU2luZ2xlWm9uZU1vZGUoKTsKICAgIGNvbnN0IHByZXZpZXdFbmFibGVkID0gY29tcHV0ZVRpZUJyZWFrZXJFbmFibGVkRm9yUm91bmQoCiAgICAgICAgU3RhdGUucm91bmQuY3VycmVudCwKICAgICAgICBTdGF0ZS5yb3VuZC5tYXgsCiAgICAgICAgU3RhdGUuYWRtaW4udGllQnJlYWtlck1vZGVJbmRleAogICAgKTsKCiAgICBpZiAoIWlzUm91bmRMaXZlKCkpIHsKICAgICAgICBTdGF0ZS5mbGFnLnRpZUJyZWFrZXJFbmFibGVkVGhpc1JvdW5kID0gcHJldmlld0VuYWJsZWQ7CiAgICB9CgogICAgY29uc3QgdGllQnJlYWtlckVuYWJsZWQgPSBpc1JvdW5kTGl2ZSgpID8gaXNUaWVCcmVha2VyRW5hYmxlZEZvclJvdW5kKCkgOiBwcmV2aWV3RW5hYmxlZDsKICAgIGlmICghdGllQnJlYWtlckVuYWJsZWQpIHsKICAgICAgICBpZiAoU3RhdGUuZmxhZy5zdGFnZSAhPT0gT3ZlcnRpbWVTdGFnZS5Ob25lKSB7CiAgICAgICAgICAgIHJlc2V0T3ZlcnRpbWVGbGFnU3RhdGUoKTsKICAgICAgICB9CiAgICAgICAgc2V0T3ZlcnRpbWVBbGxGbGFnVmlzaWJpbGl0eShmYWxzZSk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKCFpc1JvdW5kTGl2ZSgpKSB7CiAgICAgICAgaWYgKCFTdGF0ZS5mbGFnLmNvbmZpZ1ZhbGlkKSByZXR1cm47CiAgICAgICAgaWYgKGhlbGlzU2luZ2xlWm9uZSkgewogICAgICAgICAgICBpZiAoU3RhdGUuZmxhZy5zdGFnZSA8IE92ZXJ0aW1lU3RhZ2UuVmlzaWJsZSkgewogICAgICAgICAgICAgICAgaWYgKCFzZWxlY3RPdmVydGltZVpvbmVGb3JSb3VuZCgpKSByZXR1cm47CiAgICAgICAgICAgICAgICBTdGF0ZS5mbGFnLnN0YWdlID0gT3ZlcnRpbWVTdGFnZS5WaXNpYmxlOwogICAgICAgICAgICAgICAgU3RhdGUuZmxhZy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHNldE92ZXJ0aW1lU2VjdG9yc0ZvclNlbGVjdGVkKFN0YXRlLmZsYWcuYWN0aXZlU2VjdG9ySWQpOwogICAgICAgICAgICAgICAgc2V0T3ZlcnRpbWVDYXB0dXJlUG9pbnRzRm9yU2VsZWN0ZWQoU3RhdGUuZmxhZy5hY3RpdmVDYXB0dXJlUG9pbnRJZCk7CiAgICAgICAgICAgICAgICBzaG93T3ZlcnRpbWVGbGFnUHJldmlld0ljb24odHJ1ZSk7CiAgICAgICAgICAgICAgICByZWZyZXNoT3ZlcnRpbWVVaVZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgICAgICB1cGRhdGVPdmVydGltZUh1ZEZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFByZWdhbWUgc3RhdGU6IHNob3cgYWxsIGZsYWcgbWFya2VycyBmb3IgcGxhbm5pbmcgKHZpc2liaWxpdHkgb25seSkuCiAgICAgICAgICAgIHNldE92ZXJ0aW1lQWxsRmxhZ1Zpc2liaWxpdHkodHJ1ZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoIVN0YXRlLmZsYWcuY29uZmlnVmFsaWQpIHJldHVybjsKCiAgICBjb25zdCByZW1haW5pbmcgPSBnZXRSZW1haW5pbmdTZWNvbmRzKCk7CiAgICBjb25zdCB2aXNpYmxlVGhyZXNob2xkID0gZ2V0T3ZlcnRpbWVWaXNpYmxlU2Vjb25kcygpOwoKICAgIGlmIChoZWxpc1NpbmdsZVpvbmUpIHsKICAgICAgICBpZiAoU3RhdGUuZmxhZy5zdGFnZSA8IE92ZXJ0aW1lU3RhZ2UuVmlzaWJsZSkgewogICAgICAgICAgICBlbnRlck92ZXJ0aW1lVmlzaWJsZVN0YWdlU2lsZW50KCk7CiAgICAgICAgfQogICAgICAgIGlmIChyZW1haW5pbmcgPD0gT1ZFUlRJTUVfU1RBR0VfQUNUSVZFX1NFQ09ORFMpIHsKICAgICAgICAgICAgaWYgKFN0YXRlLmZsYWcuc3RhZ2UgPCBPdmVydGltZVN0YWdlLkFjdGl2ZSkgewogICAgICAgICAgICAgICAgZW50ZXJPdmVydGltZUFjdGl2ZVN0YWdlKHJlbWFpbmluZyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdXBkYXRlT3ZlcnRpbWVBY3RpdmVQcmV2aWV3SWNvblRleHQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1cGRhdGVPdmVydGltZUxvY2tlZFByZXZpZXdJY29uVGV4dChyZW1haW5pbmcpOwogICAgICAgICAgICBtYXliZVNlbmRPdmVydGltZVVubG9ja1JlbWluZGVyKHJlbWFpbmluZyk7CiAgICAgICAgICAgIHVwZGF0ZU92ZXJ0aW1lSHVkRm9yQWxsUGxheWVycygpOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHJlbWFpbmluZyA8PSBPVkVSVElNRV9TVEFHRV9BQ1RJVkVfU0VDT05EUykgewogICAgICAgIGlmIChTdGF0ZS5mbGFnLnN0YWdlIDwgT3ZlcnRpbWVTdGFnZS5WaXNpYmxlKSB7CiAgICAgICAgICAgIGVudGVyT3ZlcnRpbWVWaXNpYmxlU3RhZ2UocmVtYWluaW5nKTsKICAgICAgICB9CiAgICAgICAgaWYgKFN0YXRlLmZsYWcuc3RhZ2UgPCBPdmVydGltZVN0YWdlLkFjdGl2ZSkgewogICAgICAgICAgICBlbnRlck92ZXJ0aW1lQWN0aXZlU3RhZ2UocmVtYWluaW5nKTsKICAgICAgICB9CiAgICAgICAgdXBkYXRlT3ZlcnRpbWVBY3RpdmVQcmV2aWV3SWNvblRleHQoKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBpZiAocmVtYWluaW5nIDw9IHZpc2libGVUaHJlc2hvbGQpIHsKICAgICAgICBpZiAoU3RhdGUuZmxhZy5zdGFnZSA8IE92ZXJ0aW1lU3RhZ2UuVmlzaWJsZSkgewogICAgICAgICAgICBlbnRlck92ZXJ0aW1lVmlzaWJsZVN0YWdlKHJlbWFpbmluZyk7CiAgICAgICAgfQogICAgICAgIHVwZGF0ZU92ZXJ0aW1lTG9ja2VkUHJldmlld0ljb25UZXh0KHJlbWFpbmluZyk7CiAgICAgICAgbWF5YmVTZW5kT3ZlcnRpbWVVbmxvY2tSZW1pbmRlcihyZW1haW5pbmcpOwogICAgICAgIC8vIEtlZXAgbG9ja2VkLXN0YWdlIGNvdW50ZG93biB0ZXh0IGluIHN5bmMgd2hpbGUgdmlzaWJsZSBidXQgaW5hY3RpdmUuCiAgICAgICAgdXBkYXRlT3ZlcnRpbWVIdWRGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKHJlbWFpbmluZyA8PSBPVkVSVElNRV9TVEFHRV9OT1RJQ0VfU0VDT05EUykgewogICAgICAgIGlmIChTdGF0ZS5mbGFnLnN0YWdlIDwgT3ZlcnRpbWVTdGFnZS5Ob3RpY2UpIHsKICAgICAgICAgICAgZW50ZXJPdmVydGltZU5vdGljZVN0YWdlKHJlbWFpbmluZyk7CiAgICAgICAgfQogICAgfQoKfQoKZnVuY3Rpb24gZ2V0T3ZlcnRpbWVWaXNpYmxlU2Vjb25kcygpOiBudW1iZXIgewogICAgY29uc3Qgcm91bmRMZW5ndGggPSBTdGF0ZS5yb3VuZC5jbG9jay5yb3VuZExlbmd0aFNlY29uZHM7CiAgICBjb25zdCBkdXJhdGlvbiA9IChyb3VuZExlbmd0aCAhPT0gdW5kZWZpbmVkICYmIHJvdW5kTGVuZ3RoID4gMCkKICAgICAgICA/IHJvdW5kTGVuZ3RoCiAgICAgICAgOiAoU3RhdGUucm91bmQuY2xvY2suZHVyYXRpb25TZWNvbmRzID8/IFJPVU5EX1NUQVJUX1NFQ09ORFMpOwogICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGguZmxvb3IoZHVyYXRpb24gLyAyKSk7Cn0KCi8vIFRPRE8oMS4wKTogVW51c2VkOyByZW1vdmUgYmVmb3JlIGZpbmFsIDEuMCByZWxlYXNlLgpmdW5jdGlvbiBidWlsZFJlbWFpbmluZ1RpbWVNZXNzYWdlKG1lc3NhZ2VLZXk6IG51bWJlciwgcmVtYWluaW5nU2Vjb25kczogbnVtYmVyKTogbW9kLk1lc3NhZ2UgewogICAgY29uc3QgdGltZSA9IGdldENsb2NrVGltZVBhcnRzKHJlbWFpbmluZ1NlY29uZHMpOwogICAgcmV0dXJuIG1vZC5NZXNzYWdlKG1lc3NhZ2VLZXksIHRpbWUubWludXRlcywgdGltZS5zZWNUZW5zLCB0aW1lLnNlY09uZXMpOwp9CgpmdW5jdGlvbiBnZXRPdmVydGltZVVubG9ja1NlY29uZHMocmVtYWluaW5nU2Vjb25kcz86IG51bWJlcik6IG51bWJlciB7CiAgICBjb25zdCByZW1haW5pbmcgPSByZW1haW5pbmdTZWNvbmRzICE9PSB1bmRlZmluZWQgPyByZW1haW5pbmdTZWNvbmRzIDogZ2V0UmVtYWluaW5nU2Vjb25kcygpOwogICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGguZmxvb3IocmVtYWluaW5nIC0gT1ZFUlRJTUVfU1RBR0VfQUNUSVZFX1NFQ09ORFMpKTsKfQoKZnVuY3Rpb24gdXBkYXRlT3ZlcnRpbWVMb2NrZWRQcmV2aWV3SWNvblRleHQocmVtYWluaW5nU2Vjb25kcz86IG51bWJlcik6IHZvaWQgewogICAgaWYgKFN0YXRlLmZsYWcuc3RhZ2UgPCBPdmVydGltZVN0YWdlLlZpc2libGUgfHwgU3RhdGUuZmxhZy5zdGFnZSA+PSBPdmVydGltZVN0YWdlLkFjdGl2ZSkgcmV0dXJuOwogICAgY29uc3QgaWNvbiA9IGdldEFjdGl2ZU92ZXJ0aW1lV29ybGRJY29uKCk7CiAgICBpZiAoIWljb24pIHJldHVybjsKICAgIGNvbnN0IGxldHRlcktleSA9IGdldEFjdGl2ZU92ZXJ0aW1lRmxhZ0xldHRlcktleSgpOwogICAgY29uc3QgdW5sb2NrU2Vjb25kcyA9IGdldE92ZXJ0aW1lVW5sb2NrU2Vjb25kcyhyZW1haW5pbmdTZWNvbmRzKTsKICAgIHRyeSB7CiAgICAgICAgbW9kLlNldFdvcmxkSWNvblRleHQoaWNvbiwgbW9kLk1lc3NhZ2UoU1RSX0ZMQUdfVElUTEVfTE9DS0VEX0ZPUk1BVCwgbGV0dGVyS2V5LCB1bmxvY2tTZWNvbmRzKSk7CiAgICB9IGNhdGNoIHsKICAgICAgICByZXR1cm47CiAgICB9Cn0KCmZ1bmN0aW9uIHVwZGF0ZU92ZXJ0aW1lQWN0aXZlUHJldmlld0ljb25UZXh0KCk6IHZvaWQgewogICAgaWYgKFN0YXRlLmZsYWcuc3RhZ2UgPCBPdmVydGltZVN0YWdlLkFjdGl2ZSkgcmV0dXJuOwogICAgY29uc3QgaWNvbiA9IGdldEFjdGl2ZU92ZXJ0aW1lV29ybGRJY29uKCk7CiAgICBpZiAoIWljb24pIHJldHVybjsKICAgIHRyeSB7CiAgICAgICAgbW9kLlNldFdvcmxkSWNvblRleHQoaWNvbiwgbW9kLk1lc3NhZ2UoU1RSX0ZMQUdfUFJFVklFV19BQ1RJVkUpKTsKICAgIH0gY2F0Y2ggewogICAgICAgIHJldHVybjsKICAgIH0KfQoKLy8gVE9ETygxLjApOiBVbnVzZWQ7IHJlbW92ZSBiZWZvcmUgZmluYWwgMS4wIHJlbGVhc2UuCmZ1bmN0aW9uIHNob3VsZFNob3dPdmVydGltZVVubG9ja01lc3NhZ2VGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyKTogYm9vbGVhbiB7CiAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocGxheWVyKTsKICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCB8fCBpc1BpZERpc2Nvbm5lY3RlZChwaWQpKSByZXR1cm4gZmFsc2U7CiAgICByZXR1cm4gU3RhdGUuZmxhZy5wbGF5ZXJzSW5ab25lQnlQaWRbcGlkXSA9PT0gdW5kZWZpbmVkOwp9CgpmdW5jdGlvbiBlbnRlck92ZXJ0aW1lTm90aWNlU3RhZ2UocmVtYWluaW5nU2Vjb25kczogbnVtYmVyKTogdm9pZCB7CiAgICBTdGF0ZS5mbGFnLnN0YWdlID0gT3ZlcnRpbWVTdGFnZS5Ob3RpY2U7CiAgICAvLyBOT1RFOiAyOjMwIG5vdGljZSBtZXNzYWdlIGRpc2FibGVkICh2aXNpYmlsaXR5IG5vdyBoYW5kbGVkIGF0IGhhbGYgdGltZSkuCiAgICAvLyB2b2lkIHNob3dEeW5hbWljR2xvYmFsVGl0bGVTdWJ0aXRsZU1lc3NhZ2VGb3JBbGxQbGF5ZXJzKAogICAgLy8gICAgIHVuZGVmaW5lZCwKICAgIC8vICAgICAocmVtYWluaW5nKSA9PiBidWlsZFJlbWFpbmluZ1RpbWVNZXNzYWdlKFNUUl9PVkVSVElNRV9TVUJfTk9USUNFLCByZW1haW5pbmcpLAogICAgLy8gICAgIENPTE9SX1dISVRFLAogICAgLy8gICAgIENPTE9SX1dISVRFLAogICAgLy8gICAgIEJJR19NRVNTQUdFX0RVUkFUSU9OX1NFQ09ORFMsCiAgICAvLyAgICAgMSwKICAgIC8vICAgICBTTUFMTF9NRVNTQUdFX0xBWU9VVAogICAgLy8gKTsKfQoKZnVuY3Rpb24gZW50ZXJPdmVydGltZVZpc2libGVTdGFnZVNpbGVudCgpOiB2b2lkIHsKICAgIGlmICghc2VsZWN0T3ZlcnRpbWVab25lRm9yUm91bmQoKSkgcmV0dXJuOwogICAgU3RhdGUuZmxhZy5zdGFnZSA9IE92ZXJ0aW1lU3RhZ2UuVmlzaWJsZTsKICAgIFN0YXRlLmZsYWcuYWN0aXZlID0gZmFsc2U7CiAgICAvLyBMb2NrZWQgc3RhZ2U6IHVzZSBzZWN0b3IgcmFkaXVzICsgcHJldmlldyBpY29uOyB0cmFja2luZyBzdGF5cyBvbiBidXQgY2FwdHVyZSByZW1haW5zIGluYWN0aXZlLgogICAgc2V0T3ZlcnRpbWVTZWN0b3JzRm9yU2VsZWN0ZWQoU3RhdGUuZmxhZy5hY3RpdmVTZWN0b3JJZCk7CiAgICBzZXRPdmVydGltZUNhcHR1cmVQb2ludHNGb3JTZWxlY3RlZChTdGF0ZS5mbGFnLmFjdGl2ZUNhcHR1cmVQb2ludElkKTsKICAgIHNob3dPdmVydGltZUZsYWdQcmV2aWV3SWNvbih0cnVlKTsKICAgIHJlZnJlc2hPdmVydGltZVVpVmlzaWJpbGl0eUZvckFsbFBsYXllcnMoKTsKICAgIHVwZGF0ZU92ZXJ0aW1lSHVkRm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiBlbnRlck92ZXJ0aW1lVmlzaWJsZVN0YWdlKHJlbWFpbmluZ1NlY29uZHM6IG51bWJlcik6IHZvaWQgewogICAgaWYgKCFzZWxlY3RPdmVydGltZVpvbmVGb3JSb3VuZCgpKSByZXR1cm47CiAgICBTdGF0ZS5mbGFnLnN0YWdlID0gT3ZlcnRpbWVTdGFnZS5WaXNpYmxlOwogICAgU3RhdGUuZmxhZy5hY3RpdmUgPSBmYWxzZTsKICAgIC8vIExvY2tlZCBzdGFnZTogdXNlIHNlY3RvciByYWRpdXMgKyBwcmV2aWV3IGljb247IHRyYWNraW5nIHN0YXlzIG9uIGJ1dCBjYXB0dXJlIHJlbWFpbnMgaW5hY3RpdmUuCiAgICBzZXRPdmVydGltZVNlY3RvcnNGb3JTZWxlY3RlZChTdGF0ZS5mbGFnLmFjdGl2ZVNlY3RvcklkKTsKICAgIHNldE92ZXJ0aW1lQ2FwdHVyZVBvaW50c0ZvclNlbGVjdGVkKFN0YXRlLmZsYWcuYWN0aXZlQ2FwdHVyZVBvaW50SWQpOwogICAgc2hvd092ZXJ0aW1lRmxhZ1ByZXZpZXdJY29uKHRydWUpOwogICAgcmVmcmVzaE92ZXJ0aW1lVWlWaXNpYmlsaXR5Rm9yQWxsUGxheWVycygpOwogICAgdXBkYXRlT3ZlcnRpbWVIdWRGb3JBbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBsZXR0ZXJLZXkgPSBnZXRBY3RpdmVPdmVydGltZUZsYWdMZXR0ZXJLZXkoKTsKICAgIGNvbnN0IG92ZXJyaWRlVXNlZCA9IFN0YXRlLmZsYWcub3ZlcnJpZGVVc2VkVGhpc1JvdW5kOyAvLyBBZG1pbiBvdmVycmlkZSB1c2VzIHRoZSByZWQgY2FsbG91dCArIHRleHQuCiAgICB2b2lkIHNob3dHbG9iYWxUaXRsZVN1YnRpdGxlTWVzc2FnZUZvckFsbFBsYXllcnMoCiAgICAgICAgbW9kLk1lc3NhZ2Uob3ZlcnJpZGVVc2VkID8gU1RSX09WRVJUSU1FX1RJVExFX1ZJU0lCTEVfQURNSU4gOiBTVFJfT1ZFUlRJTUVfVElUTEVfVklTSUJMRSwgbGV0dGVyS2V5KSwKICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgb3ZlcnJpZGVVc2VkID8gQ09MT1JfUkVEIDogQ09MT1JfV0hJVEUsCiAgICAgICAgb3ZlcnJpZGVVc2VkID8gQ09MT1JfUkVEIDogQ09MT1JfV0hJVEUsCiAgICAgICAgQklHX01FU1NBR0VfRFVSQVRJT05fU0VDT05EUywKICAgICAgICBTTUFMTF9NRVNTQUdFX0xBWU9VVAogICAgKTsKfQoKZnVuY3Rpb24gZW50ZXJPdmVydGltZUFjdGl2ZVN0YWdlKHJlbWFpbmluZ1NlY29uZHM6IG51bWJlcik6IHZvaWQgewogICAgaWYgKCFzZWxlY3RPdmVydGltZVpvbmVGb3JSb3VuZCgpKSByZXR1cm47CiAgICBTdGF0ZS5mbGFnLnN0YWdlID0gT3ZlcnRpbWVTdGFnZS5BY3RpdmU7CiAgICBTdGF0ZS5mbGFnLmFjdGl2ZSA9IHRydWU7CiAgICAvLyBBY3RpdmUgc3RhZ2U6IGNhcHR1cmUgbG9naWMgKyBIVUQgZW5hYmxlZCAoQXJlYVRyaWdnZXIgZXZlbnRzIGFyZSBhdXRob3JpdGF0aXZlKS4KICAgIHNldE92ZXJ0aW1lU2VjdG9yc0ZvclNlbGVjdGVkKFN0YXRlLmZsYWcuYWN0aXZlU2VjdG9ySWQpOwogICAgc2V0T3ZlcnRpbWVDYXB0dXJlUG9pbnRzRm9yU2VsZWN0ZWQoU3RhdGUuZmxhZy5hY3RpdmVDYXB0dXJlUG9pbnRJZCk7CiAgICBzaG93T3ZlcnRpbWVGbGFnUHJldmlld0ljb24oZmFsc2UpOwogICAgLy8gRmFpbHNhZmU6IHJlZnJlc2ggd29ybGQtaWNvbiB0ZXh0IG9uIGFjdGl2YXRpb24uCiAgICB1cGRhdGVPdmVydGltZUFjdGl2ZVByZXZpZXdJY29uVGV4dCgpOwogICAgY29uc3QgbGV0dGVyS2V5ID0gZ2V0QWN0aXZlT3ZlcnRpbWVGbGFnTGV0dGVyS2V5KCk7CiAgICB2b2lkIHNob3dHbG9iYWxUaXRsZVN1YnRpdGxlTWVzc2FnZUZvckFsbFBsYXllcnMoCiAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX09WRVJUSU1FX1NVQl9VTkxPQ0tTX05PVywgbGV0dGVyS2V5KSwKICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgQ09MT1JfV0hJVEUsCiAgICAgICAgQ09MT1JfV0hJVEUsCiAgICAgICAgQklHX01FU1NBR0VfRFVSQVRJT05fU0VDT05EUywKICAgICAgICBTTUFMTF9NRVNTQUdFX0xBWU9VVAogICAgKTsKICAgIHN0YXJ0T3ZlcnRpbWVDYXB0dXJlTG9vcCgpOwogICAgcmVmcmVzaE92ZXJ0aW1lVWlWaXNpYmlsaXR5Rm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiBtYXliZVNlbmRPdmVydGltZVVubG9ja1JlbWluZGVyKHJlbWFpbmluZ1NlY29uZHM6IG51bWJlcik6IHZvaWQgewogICAgLy8gRGlzYWJsZWQ6IHVubG9jayByZW1pbmRlciBzdWJ0aXRsZSBtZXNzYWdlcyBhcmUgY3VycmVudGx5IGhpZGRlbi4KICAgIHJldHVybjsKICAgIGlmIChTdGF0ZS5mbGFnLnVubG9ja1JlbWluZGVyU2VudCkgcmV0dXJuOwogICAgY29uc3QgdGhyZXNob2xkID0gT1ZFUlRJTUVfU1RBR0VfQUNUSVZFX1NFQ09ORFMgKyBPVkVSVElNRV9VTkxPQ0tfUkVNSU5ERVJfU0VDT05EUzsKICAgIGlmIChyZW1haW5pbmdTZWNvbmRzIDw9IHRocmVzaG9sZCkgewogICAgICAgIFN0YXRlLmZsYWcudW5sb2NrUmVtaW5kZXJTZW50ID0gdHJ1ZTsKICAgICAgICBjb25zdCBsZXR0ZXJLZXkgPSBnZXRBY3RpdmVPdmVydGltZUZsYWdMZXR0ZXJLZXkoKTsKICAgICAgICB2b2lkIHNob3dEeW5hbWljR2xvYmFsVGl0bGVTdWJ0aXRsZU1lc3NhZ2VGb3JBbGxQbGF5ZXJzKAogICAgICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgICAgIChyZW1haW5pbmcpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHVubG9ja1NlY29uZHMgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHJlbWFpbmluZyAtIE9WRVJUSU1FX1NUQUdFX0FDVElWRV9TRUNPTkRTKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbW9kLk1lc3NhZ2UoU1RSX09WRVJUSU1FX1NVQl9VTkxPQ0tTX0lOLCBsZXR0ZXJLZXksIHVubG9ja1NlY29uZHMpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBDT0xPUl9XSElURSwKICAgICAgICAgICAgQ09MT1JfV0hJVEUsCiAgICAgICAgICAgIEJJR19NRVNTQUdFX0RVUkFUSU9OX1NFQ09ORFMsCiAgICAgICAgICAgIDEsCiAgICAgICAgICAgIFNNQUxMX01FU1NBR0VfTEFZT1VULAogICAgICAgICAgICBzaG91bGRTaG93T3ZlcnRpbWVVbmxvY2tNZXNzYWdlRm9yUGxheWVyCiAgICAgICAgKTsKICAgIH0KfQoKZnVuY3Rpb24gcmVzb2x2ZU92ZXJ0aW1lV2lubmVyQXRDbG9ja0V4cGlyeSgpOiBUZWFtSUQgfCAwIHwgdW5kZWZpbmVkIHsKICAgIC8vIEF0IGV4cGlyeSwgY2FwdHVyZSBwcm9ncmVzcyBkZWNpZGVzIHVubGVzcyBleGFjdGx5IG5ldXRyYWwgKDAuNSksIHdoaWNoIGZhbGxzIGJhY2sgdG8ga2lsbHMuCiAgICBpZiAoIVN0YXRlLmZsYWcuY29uZmlnVmFsaWQpIHJldHVybiB1bmRlZmluZWQ7CiAgICBpZiAoU3RhdGUuZmxhZy5wcm9ncmVzcyA+IDAuNSkgcmV0dXJuIFRlYW1JRC5UZWFtMTsKICAgIGlmIChTdGF0ZS5mbGFnLnByb2dyZXNzIDwgMC41KSByZXR1cm4gVGVhbUlELlRlYW0yOwogICAgcmV0dXJuIHVuZGVmaW5lZDsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE92ZXJ0aW1lIEZsYWcgQ2FwdHVyZSAtIFN0YWdlIFRyYW5zaXRpb25zICsgTWVzc2FnaW5nIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBNYXRjaCBDbG9jayAtIFVwZGF0ZSArIFN0YXRlIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBDbG9ja1dpZGdldENhY2hlRW50cnk6Ci8vIENhY2hlcyBhbGwgVUkgd2lkZ2V0IHJlZmVyZW5jZXMgcmVxdWlyZWQgdG8gcmVuZGVyIHRoZSByb3VuZCBjbG9jayBmb3Igb25lIHBsYXllci4KLy8gVGhpcyBwcmV2ZW50cyByZXBlYXRlZCBGaW5kVUlXaWRnZXQgY2FsbHMgZHVyaW5nIGNsb2NrIHVwZGF0ZXMgKHBlcmZvcm1hbmNlIGNyaXRpY2FsKS4KLy8gTGlmZWN5Y2xlOgovLyAtIENyZWF0ZWQgb25jZSBwZXIgcGxheWVyIGJ5IGVuc3VyZUNsb2NrVUlBbmRHZXRDYWNoZS4KLy8gLSBSZXVzZWQgb24gZXZlcnkgY2xvY2sgdGljay4KLy8gLSBTYWZlIHRvIGRpc2NhcmQgaWYgSFVEIGlzIHJlYnVpbHQgKHdpbGwgYmUgcmVjcmVhdGVkKS4KaW50ZXJmYWNlIENsb2NrV2lkZ2V0Q2FjaGVFbnRyeSB7CiAgICByb290TmFtZTogc3RyaW5nOwogICAgcm91bmRTdGF0ZVJvb3ROYW1lOiBzdHJpbmc7CiAgICByb3VuZExpdmVIZWxwUm9vdE5hbWU6IHN0cmluZzsKICAgIHJvdW5kU3RhdGVUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgcGxheWVyc1JlYWR5VGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHJvdW5kTGl2ZUhlbHBSb290PzogbW9kLlVJV2lkZ2V0OwogICAgcm91bmRMaXZlSGVscFRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICBtaW5UZW5zOiBtb2QuVUlXaWRnZXQ7CiAgICBtaW5PbmVzOiBtb2QuVUlXaWRnZXQ7CiAgICBjb2xvbjogbW9kLlVJV2lkZ2V0OwogICAgc2VjVGVuczogbW9kLlVJV2lkZ2V0OwogICAgc2VjT25lczogbW9kLlVJV2lkZ2V0Owp9CgpleHBvcnQgZnVuY3Rpb24gUmVzZXRSb3VuZENsb2NrKHNlY29uZHM6IG51bWJlcik6IHZvaWQgewogICAgY29uc3QgY2xhbXBlZFNlY29uZHMgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHNlY29uZHMpKTsKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmR1cmF0aW9uU2Vjb25kcyA9IGNsYW1wZWRTZWNvbmRzOwogICAgU3RhdGUucm91bmQuY2xvY2sucm91bmRMZW5ndGhTZWNvbmRzID0gY2xhbXBlZFNlY29uZHM7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5tYXRjaFN0YXJ0RWxhcHNlZFNlY29uZHMgPSBNYXRoLmZsb29yKG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCkpOwoKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmlzUGF1c2VkID0gZmFsc2U7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5wYXVzZWRSZW1haW5pbmdTZWNvbmRzID0gdW5kZWZpbmVkOwoKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmV4cGlyeUZpcmVkID0gZmFsc2U7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5sYXN0RGlzcGxheWVkU2Vjb25kcyA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmxhc3RMb3dUaW1lU3RhdGUgPSB1bmRlZmluZWQ7Cn0KCmZ1bmN0aW9uIHNldFJvdW5kQ2xvY2tQcmV2aWV3KHNlY29uZHM6IG51bWJlcik6IHZvaWQgewogICAgY29uc3QgY2xhbXBlZFNlY29uZHMgPSBjbGFtcFJvdW5kTGVuZ3RoU2Vjb25kcyhzZWNvbmRzKTsKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmR1cmF0aW9uU2Vjb25kcyA9IGNsYW1wZWRTZWNvbmRzOwogICAgU3RhdGUucm91bmQuY2xvY2sucm91bmRMZW5ndGhTZWNvbmRzID0gY2xhbXBlZFNlY29uZHM7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5tYXRjaFN0YXJ0RWxhcHNlZFNlY29uZHMgPSB1bmRlZmluZWQ7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5pc1BhdXNlZCA9IHRydWU7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5wYXVzZWRSZW1haW5pbmdTZWNvbmRzID0gY2xhbXBlZFNlY29uZHM7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5leHBpcnlGaXJlZCA9IGZhbHNlOwogICAgU3RhdGUucm91bmQuY2xvY2subGFzdERpc3BsYXllZFNlY29uZHMgPSB1bmRlZmluZWQ7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5sYXN0TG93VGltZVN0YXRlID0gdW5kZWZpbmVkOwp9CgpmdW5jdGlvbiBnZXRSZW1haW5pbmdTZWNvbmRzKCk6IG51bWJlciB7CiAgICBpZiAoU3RhdGUucm91bmQuY2xvY2suaXNQYXVzZWQpIHsKICAgICAgICByZXR1cm4gTWF0aC5tYXgoMCwgU3RhdGUucm91bmQuY2xvY2sucGF1c2VkUmVtYWluaW5nU2Vjb25kcyAhPT0gdW5kZWZpbmVkID8gU3RhdGUucm91bmQuY2xvY2sucGF1c2VkUmVtYWluaW5nU2Vjb25kcyA6IDApOwogICAgfQoKICAgIGlmIChTdGF0ZS5yb3VuZC5jbG9jay5tYXRjaFN0YXJ0RWxhcHNlZFNlY29uZHMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIDA7CgogICAgY29uc3QgZWxhcHNlZCA9IE1hdGguZmxvb3IobW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKSkgLSBTdGF0ZS5yb3VuZC5jbG9jay5tYXRjaFN0YXJ0RWxhcHNlZFNlY29uZHM7CiAgICByZXR1cm4gTWF0aC5tYXgoMCwgU3RhdGUucm91bmQuY2xvY2suZHVyYXRpb25TZWNvbmRzIC0gZWxhcHNlZCk7Cn0KCmZ1bmN0aW9uIGFkanVzdFJvdW5kQ2xvY2tCeVNlY29uZHMoZGVsdGFTZWNvbmRzOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IGRlbHRhID0gTWF0aC5mbG9vcihkZWx0YVNlY29uZHMpOwoKICAgIGlmIChTdGF0ZS5yb3VuZC5jbG9jay5pc1BhdXNlZCkgewogICAgICAgIGNvbnN0IGN1cnJlbnQgPSBTdGF0ZS5yb3VuZC5jbG9jay5wYXVzZWRSZW1haW5pbmdTZWNvbmRzICE9PSB1bmRlZmluZWQgPyBTdGF0ZS5yb3VuZC5jbG9jay5wYXVzZWRSZW1haW5pbmdTZWNvbmRzIDogMDsKICAgICAgICBTdGF0ZS5yb3VuZC5jbG9jay5wYXVzZWRSZW1haW5pbmdTZWNvbmRzID0gTWF0aC5tYXgoMCwgY3VycmVudCArIGRlbHRhKTsKICAgICAgICBTdGF0ZS5yb3VuZC5jbG9jay5kdXJhdGlvblNlY29uZHMgPSBNYXRoLm1heCgwLCBTdGF0ZS5yb3VuZC5jbG9jay5kdXJhdGlvblNlY29uZHMgKyBkZWx0YSk7CiAgICB9IGVsc2UgewogICAgICAgIFN0YXRlLnJvdW5kLmNsb2NrLmR1cmF0aW9uU2Vjb25kcyA9IE1hdGgubWF4KDAsIFN0YXRlLnJvdW5kLmNsb2NrLmR1cmF0aW9uU2Vjb25kcyArIGRlbHRhKTsKICAgIH0KCiAgICBpZiAoZGVsdGEgPiAwKSB7CiAgICAgICAgU3RhdGUucm91bmQuY2xvY2suZXhwaXJ5RmlyZWQgPSBmYWxzZTsKICAgIH0KCiAgICBTdGF0ZS5yb3VuZC5jbG9jay5sYXN0RGlzcGxheWVkU2Vjb25kcyA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmxhc3RMb3dUaW1lU3RhdGUgPSB1bmRlZmluZWQ7Cn0KCmZ1bmN0aW9uIHJlc2V0Um91bmRDbG9ja1RvRGVmYXVsdCgpOiB2b2lkIHsKICAgIFJlc2V0Um91bmRDbG9jayhnZXRDb25maWd1cmVkUm91bmRMZW5ndGhTZWNvbmRzKCkpOwp9CgovLyBOT1RFOiBUaGlzIGNvdW50cyByZWdpc3RlcmVkL3Njb3JpbmcgdmVoaWNsZXMsIG5vdCBldmVyeSBzcGF3bmVkIHZlaGljbGUgaW4gdGhlIHdvcmxkLgpmdW5jdGlvbiBnZXRSZWdpc3RlcmVkVmVoaWNsZUNvdW50KHRlYW1OdW06IFRlYW1JRCk6IG51bWJlciB7CiAgICBjb25zdCBhcnIgPSB0ZWFtTnVtID09PSBUZWFtSUQuVGVhbTEKICAgICAgICA/IG1vZC5HZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0xKQogICAgICAgIDogbW9kLkdldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTIpOwogICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGguZmxvb3IobW9kLkNvdW50T2YoYXJyKSkpOwp9CgovLyBQdXNoZXMgdGhlIGN1cnJlbnQgcm91bmQgY2xvY2sgc3RhdGUgdG8gYWxsIHBsYXllcnMnIEhVRHMuCi8vIE11c3QgYmUgY2FsbGVkIGFmdGVyIGFueSBtYW51YWwgYWRtaW4gYWRqdXN0bWVudCBvciByZXNldCBvZiB0aGUgY2xvY2suCgovKioKICogUmVmcmVzaGVzIHRoZSB2aXNpYmxlIHJvdW5kIGNsb2NrIGZvciBhbGwgcGxheWVycy4KICogRXhwZWN0ZWQgdXNhZ2U6CiAqIC0gQ2FsbGVkIHdoZW4gdGhlIGF1dGhvcml0YXRpdmUgY2xvY2sgc2Vjb25kcyBjaGFuZ2UgKHRpY2spIG9yIHdoZW4gY2xvY2sgc3R5bGUgY2hhbmdlcyAobG93IHRpbWUpLgogKiBQZXJmb3JtYW5jZSBub3RlOgogKiAtIFRoaXMgc2hvdWxkIHJlbWFpbiBhIGxpZ2h0d2VpZ2h0IHBhc3MgdGhhdCBvbmx5IHVwZGF0ZXMgd2lkZ2V0cyB3aGVuIHRoZSBkaXNwbGF5ZWQgdmFsdWUgY2hhbmdlcy4KICovCgpmdW5jdGlvbiB1cGRhdGVBbGxQbGF5ZXJzQ2xvY2soKTogdm9pZCB7CiAgICBjb25zdCByZW1haW5pbmcgPSBpc1JvdW5kTGl2ZSgpID8gZ2V0UmVtYWluaW5nU2Vjb25kcygpIDogZ2V0Q29uZmlndXJlZFJvdW5kTGVuZ3RoU2Vjb25kcygpOwoKICAgIGlmICghU3RhdGUucm91bmQuY2xvY2suZXhwaXJ5RmlyZWQgJiYgcmVtYWluaW5nIDw9IDApIHsKICAgICAgICBTdGF0ZS5yb3VuZC5jbG9jay5leHBpcnlGaXJlZCA9IHRydWU7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBTdGF0ZS5yb3VuZC5jbG9jay5leHBpcnlIYW5kbGVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBTdGF0ZS5yb3VuZC5jbG9jay5leHBpcnlIYW5kbGVyc1tpXSgpOwogICAgICAgIH0KICAgIH0KCiAgICBjb25zdCBsb3dUaW1lID0gcmVtYWluaW5nIDwgTE9XX1RJTUVfVEhSRVNIT0xEX1NFQ09ORFM7CgogICAgY29uc3QgbWludXRlcyA9IE1hdGguZmxvb3IocmVtYWluaW5nIC8gNjApOwogICAgLy8gUmVhZCB0aGUgYXV0aG9yaXRhdGl2ZSByZW1haW5pbmcgc2Vjb25kcyBmb3IgdGhlIHJvdW5kIGNsb2NrLgpjb25zdCBzZWNvbmRzID0gcmVtYWluaW5nICUgNjA7CgogICAgY29uc3QgZGlnaXRzID0gewogICAgICAgIG1UOiBNYXRoLmZsb29yKG1pbnV0ZXMgLyAxMCksCiAgICAgICAgbU86IG1pbnV0ZXMgJSAxMCwKICAgICAgICBzVDogTWF0aC5mbG9vcihzZWNvbmRzIC8gMTApLAogICAgICAgIHNPOiBzZWNvbmRzICUgMTAsCiAgICB9OwoKICAgIGNvbnN0IHNob3dWZWhpY2xlc0FsaXZlID0gaXNSb3VuZExpdmUoKSAmJiAhU3RhdGUucm91bmQuZmxvdy5jbGVhbnVwQWN0aXZlICYmICFTdGF0ZS5tYXRjaC5pc0VuZGVkOwogICAgY29uc3QgdmVoaWNsZXNBbGl2ZVQxID0gc2hvd1ZlaGljbGVzQWxpdmUgPyBnZXRSZWdpc3RlcmVkVmVoaWNsZUNvdW50KFRlYW1JRC5UZWFtMSkgOiAwOwogICAgY29uc3QgdmVoaWNsZXNBbGl2ZVQyID0gc2hvd1ZlaGljbGVzQWxpdmUgPyBnZXRSZWdpc3RlcmVkVmVoaWNsZUNvdW50KFRlYW1JRC5UZWFtMikgOiAwOwoKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwbGF5ZXIgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIGNvbnRpbnVlOwoKICAgICAgICAvLyBFbnN1cmUgZWFjaCBwbGF5ZXIncyBjbG9jayB3aWRnZXRzIGV4aXN0IGFuZCBnZXQgY2FjaGVkIHJlZnMgZm9yIGVmZmljaWVudCB1cGRhdGVzLgogICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSBlbnN1cmVDbG9ja1VJQW5kR2V0Q2FjaGUocGxheWVyKTsKICAgICAgICBpZiAoIWNhY2hlRW50cnkpIGNvbnRpbnVlOwoKICAgICAgICBpZiAoU3RhdGUucm91bmQuY2xvY2subGFzdExvd1RpbWVTdGF0ZSA9PT0gdW5kZWZpbmVkIHx8IGxvd1RpbWUgIT09IFN0YXRlLnJvdW5kLmNsb2NrLmxhc3RMb3dUaW1lU3RhdGUpIHsKICAgICAgICAgICAgc2V0Q2xvY2tDb2xvckNhY2hlZChjYWNoZUVudHJ5LCBsb3dUaW1lID8gQ09MT1JfTE9XX1RJTUUgOiBDT0xPUl9OT1JNQUwpOwogICAgICAgIH0KCiAgICAgICAgaWYgKFN0YXRlLnJvdW5kLmNsb2NrLmxhc3REaXNwbGF5ZWRTZWNvbmRzICE9PSByZW1haW5pbmcpIHsKICAgICAgICAgICAgc2V0RGlnaXRDYWNoZWQoY2FjaGVFbnRyeS5taW5UZW5zLCBkaWdpdHMubVQpOwogICAgICAgICAgICBzZXREaWdpdENhY2hlZChjYWNoZUVudHJ5Lm1pbk9uZXMsIGRpZ2l0cy5tTyk7CiAgICAgICAgICAgIHNldENvbG9uQ2FjaGVkKGNhY2hlRW50cnkuY29sb24pOwogICAgICAgICAgICBzZXREaWdpdENhY2hlZChjYWNoZUVudHJ5LnNlY1RlbnMsIGRpZ2l0cy5zVCk7CiAgICAgICAgICAgIHNldERpZ2l0Q2FjaGVkKGNhY2hlRW50cnkuc2VjT25lcywgZGlnaXRzLnNPKTsKICAgICAgICB9CgogICAgICAgIHVwZGF0ZVZpY3RvcnlEaWFsb2dGb3JQbGF5ZXIocGxheWVyLCByZW1haW5pbmcpOwoKICAgICAgICBjb25zdCBwaWQgPSBtb2QuR2V0T2JqSWQocGxheWVyKTsKICAgICAgICBjb25zdCByZWZzID0gU3RhdGUuaHVkQ2FjaGUuaHVkQnlQaWRbcGlkXSA/PyBlbnN1cmVIdWRGb3JQbGF5ZXIocGxheWVyKTsKICAgICAgICBpZiAocmVmcz8ubGVmdFZlaGljbGVzQWxpdmVUZXh0KSB7CiAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFZpc2libGUocmVmcy5sZWZ0VmVoaWNsZXNBbGl2ZVRleHQsIHNob3dWZWhpY2xlc0FsaXZlKTsKICAgICAgICAgICAgaWYgKHNob3dWZWhpY2xlc0FsaXZlKSB7CiAgICAgICAgICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwoCiAgICAgICAgICAgICAgICAgICAgcmVmcy5sZWZ0VmVoaWNsZXNBbGl2ZVRleHQsCiAgICAgICAgICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC52ZWhpY2xlc0FsaXZlRm9ybWF0LCB2ZWhpY2xlc0FsaXZlVDEpCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChyZWZzPy5yaWdodFZlaGljbGVzQWxpdmVUZXh0KSB7CiAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFZpc2libGUocmVmcy5yaWdodFZlaGljbGVzQWxpdmVUZXh0LCBzaG93VmVoaWNsZXNBbGl2ZSk7CiAgICAgICAgICAgIGlmIChzaG93VmVoaWNsZXNBbGl2ZSkgewogICAgICAgICAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKAogICAgICAgICAgICAgICAgICAgIHJlZnMucmlnaHRWZWhpY2xlc0FsaXZlVGV4dCwKICAgICAgICAgICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnZlaGljbGVzQWxpdmVGb3JtYXQsIHZlaGljbGVzQWxpdmVUMikKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgU3RhdGUucm91bmQuY2xvY2subGFzdExvd1RpbWVTdGF0ZSA9IGxvd1RpbWU7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5sYXN0RGlzcGxheWVkU2Vjb25kcyA9IHJlbWFpbmluZzsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIE1hdGNoIENsb2NrIC0gVXBkYXRlICsgU3RhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE1hdGNoIENsb2NrIC0gVUkgQnVpbGQgKyBDYWNoZSBIZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8qKgogKiBFbnN1cmVzIHRoZSBjbG9jayBVSSB3aWRnZXRzIGV4aXN0IGZvciBhIGdpdmVuIHBsYXllciBhbmQgcmV0dXJucyB0aGUgY2FjaGVkIHJlZmVyZW5jZXMuCiAqIFJlc3BvbnNpYmlsaXRpZXM6CiAqIC0gQ3JlYXRlIGFueSBtaXNzaW5nIGRpZ2l0L2NvbG9uIHdpZGdldHMgKG9uZS10aW1lIHBlciBwbGF5ZXIpLgogKiAtIFJldHVybiBhIGNhY2hlIG9iamVjdCB0aGF0IHRoZSBjbG9jayB1cGRhdGUgY29kZSBjYW4gdXNlIHdpdGhvdXQgcmVwZWF0ZWQgd2lkZ2V0IGxvb2t1cHMuCiAqIE5vbi1yZXNwb25zaWJpbGl0aWVzOgogKiAtIERvZXMgbm90IHN0YXJ0L3N0b3AgdGhlIGNsb2NrOyBpdCBvbmx5IGVuc3VyZXMgVUkgZXhpc3RzLgogKi8KCmZ1bmN0aW9uIGVuc3VyZUNsb2NrVUlBbmRHZXRDYWNoZShwbGF5ZXI6IG1vZC5QbGF5ZXIpOiBDbG9ja1dpZGdldENhY2hlRW50cnkgfCB1bmRlZmluZWQgewogICAgLy8gQ2xvY2sgd2lkZ2V0cyBhcmUgc3RvcmVkIHBlci1wbGF5ZXI7IGRlcml2ZSBwaWQgZm9yIGNhY2hlIGxvb2t1cC4KY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHBsYXllcik7CiAgICBjb25zdCByb290TmFtZSA9ICJNYXRjaFRpbWVyUm9vdF8iICsgcGlkOwogICAgY29uc3Qgcm91bmRTdGF0ZVJvb3ROYW1lID0gIlJvdW5kU3RhdGVSb290XyIgKyBwaWQ7CiAgICBjb25zdCByb3VuZExpdmVIZWxwUm9vdE5hbWUgPSAiUm91bmRMaXZlSGVscFJvb3RfIiArIHBpZDsKCiAgICBjb25zdCBjYWNoZWQgPSBTdGF0ZS5odWRDYWNoZS5jbG9ja1dpZGdldENhY2hlW3BpZF07CiAgICBpZiAoY2FjaGVkKSB7CiAgICAgICAgY29uc3QgcHJvYmVDbG9jayA9IHNhZmVGaW5kKGNhY2hlZC5yb290TmFtZSk7CiAgICAgICAgY29uc3QgcHJvYmVTdGF0ZSA9IHNhZmVGaW5kKGNhY2hlZC5yb3VuZFN0YXRlUm9vdE5hbWUpOwogICAgICAgIGNvbnN0IHByb2JlSGVscCA9IHNhZmVGaW5kKGNhY2hlZC5yb3VuZExpdmVIZWxwUm9vdE5hbWUpOwogICAgICAgIGlmIChwcm9iZUNsb2NrICYmIHByb2JlU3RhdGUgJiYgcHJvYmVIZWxwKSB7CiAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFBvc2l0aW9uKHByb2JlSGVscCwgbW9kLkNyZWF0ZVZlY3RvcihDTE9DS19QT1NJVElPTl9YLCBDTE9DS19QT1NJVElPTl9ZICsgUk9VTkRfTElWRV9IRUxQX09GRlNFVF9ZLCAwKSk7CiAgICAgICAgICAgIGVuc3VyZVRvcEh1ZFJvb3RGb3JQaWQocGlkLCBwbGF5ZXIpOwogICAgICAgICAgICBzZXRIdWRIZWxwRGVwdGhGb3JQaWQocGlkKTsKICAgICAgICAgICAgcmV0dXJuIGNhY2hlZDsKICAgICAgICB9CiAgICB9CgogICAgY29uc3QgZGlnaXRXaWR0aCA9IENMT0NLX1dJRFRIICogMC4xMjsKICAgIGNvbnN0IGNvbG9uV2lkdGggPSBDTE9DS19XSURUSCAqIDAuMDY7CgogICAgY29uc3QgeE9mZnNldHMgPSB7CiAgICAgICAgbWluVGVuczogLWRpZ2l0V2lkdGggKiAxLjggKyAxNCwgCiAgICAgICAgbWluT25lczogLWRpZ2l0V2lkdGggKiAwLjggKyA4LCAKICAgICAgICBjb2xvbjogLWRpZ2l0V2lkdGggKiAwLjA1LAogICAgICAgIHNlY1RlbnM6IGRpZ2l0V2lkdGggKiAwLjkgLSAxMCwgCiAgICAgICAgc2VjT25lczogZGlnaXRXaWR0aCAqIDEuOSAtIDE2LCAKICAgIH07CgogICAgbW9kbGliLlBhcnNlVUkoewogICAgICAgIG5hbWU6IHJvb3ROYW1lLAogICAgICAgIHR5cGU6ICJDb250YWluZXIiLAogICAgICAgIHBsYXllcklkOiBwbGF5ZXIsCiAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgcG9zaXRpb246IFtDTE9DS19QT1NJVElPTl9YLCBDTE9DS19QT1NJVElPTl9ZXSwKICAgICAgICBzaXplOiBbQ0xPQ0tfV0lEVEgsIENMT0NLX0hFSUdIVF0sCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgIC8vIFNsb3cgcGF0aDogY3JlYXRlIGRpZ2l0IHdpZGdldHMgb25jZSBwZXIgcGxheWVyLCB0aGVuIGNhY2hlIHJlZnMgZm9yIGZ1dHVyZSB1cGRhdGVzLgogICAgICAgICAgICBidWlsZERpZ2l0KCJNaW5UZW5zIiwgcGlkLCB4T2Zmc2V0cy5taW5UZW5zLCBkaWdpdFdpZHRoKSwKICAgICAgICAgICAgYnVpbGREaWdpdCgiTWluT25lcyIsIHBpZCwgeE9mZnNldHMubWluT25lcywgZGlnaXRXaWR0aCksCiAgICAgICAgICAgIGJ1aWxkQ29sb24ocGlkLCB4T2Zmc2V0cy5jb2xvbiwgY29sb25XaWR0aCksCiAgICAgICAgICAgIGJ1aWxkRGlnaXQoIlNlY1RlbnMiLCBwaWQsIHhPZmZzZXRzLnNlY1RlbnMsIGRpZ2l0V2lkdGgpLAogICAgICAgICAgICBidWlsZERpZ2l0KCJTZWNPbmVzIiwgcGlkLCB4T2Zmc2V0cy5zZWNPbmVzLCBkaWdpdFdpZHRoKSwKICAgICAgICBdLAogICAgfSk7CgogICAgLy8gQ3JlYXRlIHJvdW5kLXN0YXRlIHRleHQgdW5kZXIgdGhlIG1hdGNoIGNsb2NrIGZvciB0aGlzIHBsYXllci4KICAgIG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICBuYW1lOiByb3VuZFN0YXRlUm9vdE5hbWUsCiAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICBwb3NpdGlvbjogW0NMT0NLX1BPU0lUSU9OX1gsIENMT0NLX1BPU0lUSU9OX1kgKyBDTE9DS19IRUlHSFQgLSAxMF0sCiAgICAgICAgc2l6ZTogW0NMT0NLX1dJRFRILCAzNF0sCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6ICJSb3VuZFN0YXRlVGV4dF8iICsgcGlkLAogICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMF0sCiAgICAgICAgICAgICAgICBzaXplOiBbQ0xPQ0tfV0lEVEgsIDE4XSwKICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQucm91bmRTdGF0ZU5vdFJlYWR5LAogICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuYW1lOiAiUGxheWVyc1JlYWR5VGV4dF8iICsgcGlkLAogICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTRdLAogICAgICAgICAgICAgICAgc2l6ZTogW0NMT0NLX1dJRFRILCAxOF0sCiAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgIC8vIFBsYWNlaG9sZGVyIGxhYmVsOyBydW50aW1lIHdpbGwgc2V0IGZ1bGwgIntYfSAvIHtZfSBQTEFZRVJTIFJFQURZIiBmb3JtYXQuCiAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6ICIiLAogICAgICAgICAgICAgICAgLy8gWWVsbG93LCBtYXRjaGluZyBvdGhlciBpbXBvcnRhbnQgSFVEIGNhbGxvdXRzLgogICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMF0sCiAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTEsCiAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICB9LAogICAgICAgIF0sCiAgICB9KTsKCiAgICAvLyBDcmVhdGUgcm91bmQtbGl2ZSBoZWxwIHRleHQgdW5kZXIgdGhlIHJvdW5kLXN0YXRlIGZvciB0aGlzIHBsYXllci4KICAgIG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICBuYW1lOiByb3VuZExpdmVIZWxwUm9vdE5hbWUsCiAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICBwb3NpdGlvbjogW0NMT0NLX1BPU0lUSU9OX1gsIENMT0NLX1BPU0lUSU9OX1kgKyBST1VORF9MSVZFX0hFTFBfT0ZGU0VUX1ldLAogICAgICAgIHNpemU6IFtST1VORF9MSVZFX0hFTFBfV0lEVEgsIFJPVU5EX0xJVkVfSEVMUF9IRUlHSFRdLAogICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogIlJvdW5kTGl2ZUhlbHBUZXh0XyIgKyBwaWQsCiAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCAwXSwKICAgICAgICAgICAgICAgIHNpemU6IFtST1VORF9MSVZFX0hFTFBfV0lEVEgsIFJPVU5EX0xJVkVfSEVMUF9IRUlHSFRdLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZExpdmVIZWxwRm9ybWF0LCAwKSwKICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgfSwKICAgICAgICBdLAogICAgfSk7CgogICAgY29uc3QgZW50cnk6IENsb2NrV2lkZ2V0Q2FjaGVFbnRyeSA9IHsKICAgICAgICByb290TmFtZTogcm9vdE5hbWUsCiAgICAgICAgcm91bmRTdGF0ZVJvb3ROYW1lOiByb3VuZFN0YXRlUm9vdE5hbWUsCiAgICAgICAgcm91bmRMaXZlSGVscFJvb3ROYW1lOiByb3VuZExpdmVIZWxwUm9vdE5hbWUsCiAgICAgICAgbWluVGVuczogc2FmZUZpbmQoIk1hdGNoVGltZXJNaW5UZW5zXyIgKyBwaWQpIGFzIG1vZC5VSVdpZGdldCwKICAgICAgICBtaW5PbmVzOiBzYWZlRmluZCgiTWF0Y2hUaW1lck1pbk9uZXNfIiArIHBpZCkgYXMgbW9kLlVJV2lkZ2V0LAogICAgICAgIGNvbG9uOiBzYWZlRmluZCgiTWF0Y2hUaW1lckNvbG9uXyIgKyBwaWQpIGFzIG1vZC5VSVdpZGdldCwKICAgICAgICBzZWNUZW5zOiBzYWZlRmluZCgiTWF0Y2hUaW1lclNlY1RlbnNfIiArIHBpZCkgYXMgbW9kLlVJV2lkZ2V0LAogICAgICAgIHNlY09uZXM6IHNhZmVGaW5kKCJNYXRjaFRpbWVyU2VjT25lc18iICsgcGlkKSBhcyBtb2QuVUlXaWRnZXQsCiAgICAgICAgcm91bmRTdGF0ZVRleHQ6IHNhZmVGaW5kKCJSb3VuZFN0YXRlVGV4dF8iICsgcGlkKSBhcyBtb2QuVUlXaWRnZXQsCiAgICAgICAgcGxheWVyc1JlYWR5VGV4dDogc2FmZUZpbmQoIlBsYXllcnNSZWFkeVRleHRfIiArIHBpZCkgYXMgbW9kLlVJV2lkZ2V0LAogICAgICAgIHJvdW5kTGl2ZUhlbHBSb290OiBzYWZlRmluZChyb3VuZExpdmVIZWxwUm9vdE5hbWUpIGFzIG1vZC5VSVdpZGdldCwKICAgICAgICByb3VuZExpdmVIZWxwVGV4dDogc2FmZUZpbmQoIlJvdW5kTGl2ZUhlbHBUZXh0XyIgKyBwaWQpIGFzIG1vZC5VSVdpZGdldCwKICAgIH07CgogICAgaWYgKAogICAgICAgICFlbnRyeS5taW5UZW5zIHx8CiAgICAgICAgIWVudHJ5Lm1pbk9uZXMgfHwKICAgICAgICAhZW50cnkuY29sb24gfHwKICAgICAgICAhZW50cnkuc2VjVGVucyB8fAogICAgICAgICFlbnRyeS5zZWNPbmVzIHx8CiAgICAgICAgIWVudHJ5LnJvdW5kU3RhdGVUZXh0IHx8CiAgICAgICAgIWVudHJ5LnBsYXllcnNSZWFkeVRleHQgfHwKICAgICAgICAhZW50cnkucm91bmRMaXZlSGVscFJvb3QgfHwKICAgICAgICAhZW50cnkucm91bmRMaXZlSGVscFRleHQKICAgICkgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgU3RhdGUuaHVkQ2FjaGUuY2xvY2tXaWRnZXRDYWNoZVtwaWRdID0gZW50cnk7CiAgICBzZXRDbG9ja0NvbG9yQ2FjaGVkKGVudHJ5LCBDT0xPUl9OT1JNQUwpOwogICAgZW5zdXJlVG9wSHVkUm9vdEZvclBpZChwaWQsIHBsYXllcik7CiAgICBzZXRIdWRIZWxwRGVwdGhGb3JQaWQocGlkKTsKCiAgICByZXR1cm4gZW50cnk7Cn0KCmZ1bmN0aW9uIGJ1aWxkRGlnaXQocGFydDogc3RyaW5nLCBwaWQ6IG51bWJlciwgeDogbnVtYmVyLCB3aWR0aDogbnVtYmVyKSB7CiAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJNYXRjaFRpbWVyIiArIHBhcnQgKyAiXyIgKyBwaWQsCiAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgIHBvc2l0aW9uOiBbeCwgMF0sCiAgICAgICAgc2l6ZTogW3dpZHRoLCBDTE9DS19IRUlHSFRdLAogICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suZGlnaXQsIDApLAogICAgICAgIHRleHRTaXplOiBDTE9DS19GT05UX1NJWkUsCiAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgIH07Cn0KCmZ1bmN0aW9uIGJ1aWxkQ29sb24ocGlkOiBudW1iZXIsIHg6IG51bWJlciwgd2lkdGg6IG51bWJlcikgewogICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiTWF0Y2hUaW1lckNvbG9uXyIgKyBwaWQsCiAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgIHBvc2l0aW9uOiBbeCwgMF0sCiAgICAgICAgc2l6ZTogW3dpZHRoLCBDTE9DS19IRUlHSFRdLAogICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suY29sb24sCiAgICAgICAgdGV4dFNpemU6IENMT0NLX0ZPTlRfU0laRSwKICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgfTsKfQoKZnVuY3Rpb24gc2V0RGlnaXRDYWNoZWQod2lkZ2V0OiBtb2QuVUlXaWRnZXQsIGRpZ2l0OiBudW1iZXIpOiB2b2lkIHsKICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3aWRnZXQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suZGlnaXQsIGRpZ2l0KSk7Cn0KCmZ1bmN0aW9uIHNldENvbG9uQ2FjaGVkKHdpZGdldDogbW9kLlVJV2lkZ2V0KTogdm9pZCB7CiAgICBtb2QuU2V0VUlUZXh0TGFiZWwod2lkZ2V0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmNvbG9uKSk7Cn0KCmZ1bmN0aW9uIHNldENsb2NrQ29sb3JDYWNoZWQoY2FjaGVFbnRyeTogQ2xvY2tXaWRnZXRDYWNoZUVudHJ5LCBjb2xvcjogYW55KTogdm9pZCB7CiAgICBtb2QuU2V0VUlUZXh0Q29sb3IoY2FjaGVFbnRyeS5taW5UZW5zLCBjb2xvcik7CiAgICBtb2QuU2V0VUlUZXh0Q29sb3IoY2FjaGVFbnRyeS5taW5PbmVzLCBjb2xvcik7CiAgICBtb2QuU2V0VUlUZXh0Q29sb3IoY2FjaGVFbnRyeS5jb2xvbiwgY29sb3IpOwogICAgbW9kLlNldFVJVGV4dENvbG9yKGNhY2hlRW50cnkuc2VjVGVucywgY29sb3IpOwogICAgbW9kLlNldFVJVGV4dENvbG9yKGNhY2hlRW50cnkuc2VjT25lcywgY29sb3IpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gTWF0Y2ggQ2xvY2sgLSBVSSBCdWlsZCArIENhY2hlIEhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFRlYW0gU3dpdGNoIERhdGEgKyBDb25maWcgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmludGVyZmFjZSBUZWFtU3dpdGNoQ29uZmlnIHsKICAgIGVuYWJsZVRlYW1Td2l0Y2g6IGJvb2xlYW47CiAgICBpbnRlcmFjdFBvaW50TWluTGlmZXRpbWU6IG51bWJlcjsKICAgIGludGVyYWN0UG9pbnRNYXhMaWZldGltZTogbnVtYmVyOwogICAgdmVsb2NpdHlUaHJlc2hvbGQ6IG51bWJlcjsKfQoKaW50ZXJmYWNlIHRlYW1Td2l0Y2hEYXRhX3QgewogICAgaW50ZXJhY3RQb2ludDogbW9kLkludGVyYWN0UG9pbnQgfCBudWxsOwogICAgbGFzdERlcGxveVRpbWU6IG51bWJlcjsKICAgIGRvbnRTaG93QWdhaW46IGJvb2xlYW47CiAgICBhZG1pblBhbmVsVmlzaWJsZTogYm9vbGVhbjsKICAgIGFkbWluUGFuZWxCdWlsdDogYm9vbGVhbjsKICAgIGxhc3RBZG1pblBhbmVsVG9nZ2xlQXQ6IG51bWJlcjsKICAgIGRpYWxvZ1Zpc2libGU6IGJvb2xlYW47CiAgICAvLyBVSSBjYWNoaW5nOiB0cnVlIGFmdGVyIHRoZSBmaXJzdCB3YXJtLXVwIGJ1aWxkIHNvIHN1YnNlcXVlbnQgb3BlbnMgY2FuIGJlIGluc3RhbnQuCiAgICB1aUJ1aWx0OiBib29sZWFuOwogICAgcG9zRGVidWdWaXNpYmxlOiBib29sZWFuOwogICAgcG9zRGVidWdUb2tlbjogbnVtYmVyOwp9CgovLyBQZXItcGxheWVyIHN0YXRlIGxpdmVzIGluIFN0YXRlLnBsYXllcnM6Ci8vIC0gdGVhbVN3aXRjaERhdGE6IGRpYWxvZyArIGludGVyYWN0LXBvaW50IHN0YXRlIHBlciBwbGF5ZXIuCi8vIC0gcmVhZHlCeVBpZDogUkVBRFkgdG9nZ2xlIHN0YXRlIGZvciByb3N0ZXIgKyBhdXRvLXN0YXJ0IGdhdGluZy4KLy8gLSBhdXRvUmVhZHlCeVBpZDogcGVyLXBsYXllciBhdXRvLXJlYWR5IHRvZ2dsZSAodmVoaWNsZSArIG1haW4gYmFzZSkuCi8vIC0gaW5NYWluQmFzZUJ5UGlkOiBtYWluLWJhc2UgcHJlc2VuY2UgZm9yIHByZS1yb3VuZCBnYXRpbmcgKyBVSS4KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBUZWFtIFN3aXRjaCBEYXRhICsgQ29uZmlnIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBUZWFtIFN3aXRjaCBJbnRlcmFjdCBQb2ludCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKYXN5bmMgZnVuY3Rpb24gc3Bhd25UZWFtU3dpdGNoSW50ZXJhY3RQb2ludChldmVudFBsYXllcjogbW9kLlBsYXllcikgewogICAgaWYgKCFpc1BsYXllckRlcGxveWVkKGV2ZW50UGxheWVyKSkgcmV0dXJuOwogICAgY29uc3QgcGxheWVySWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXSkgaW5pdFRlYW1Td2l0Y2hEYXRhKGV2ZW50UGxheWVyKTsKCiAgICBpZiAoCiAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uaW50ZXJhY3RQb2ludCA9PT0gbnVsbCAmJgogICAgICAgICFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5kb250U2hvd0FnYWluICYmCiAgICAgICAgVEVBTVNXSVRDSENPTkZJRy5lbmFibGVUZWFtU3dpdGNoCiAgICApIHsKICAgICAgICBsZXQgaXNPbkdyb3VuZCA9IHNhZmVHZXRTb2xkaWVyU3RhdGVCb29sKGV2ZW50UGxheWVyLCBtb2QuU29sZGllclN0YXRlQm9vbC5Jc09uR3JvdW5kKTsKCiAgICAgICAgd2hpbGUgKCFpc09uR3JvdW5kKSB7CiAgICAgICAgICAgIGF3YWl0IG1vZC5XYWl0KDAuMik7CiAgICAgICAgICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChldmVudFBsYXllcikpIHJldHVybjsKICAgICAgICAgICAgaXNPbkdyb3VuZCA9IHNhZmVHZXRTb2xkaWVyU3RhdGVCb29sKGV2ZW50UGxheWVyLCBtb2QuU29sZGllclN0YXRlQm9vbC5Jc09uR3JvdW5kKTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHBsYXllclBvc2l0aW9uID0gc2FmZUdldFNvbGRpZXJTdGF0ZVZlY3RvcihldmVudFBsYXllciwgbW9kLlNvbGRpZXJTdGF0ZVZlY3Rvci5HZXRQb3NpdGlvbik7CiAgICAgICAgY29uc3QgcGxheWVyRmFjaW5nRGlyZWN0aW9uID0gc2FmZUdldFNvbGRpZXJTdGF0ZVZlY3RvcihldmVudFBsYXllciwgbW9kLlNvbGRpZXJTdGF0ZVZlY3Rvci5HZXRGYWNpbmdEaXJlY3Rpb24pOwogICAgICAgIGlmICghcGxheWVyUG9zaXRpb24gfHwgIXBsYXllckZhY2luZ0RpcmVjdGlvbikgcmV0dXJuOwoKICAgICAgICBjb25zdCBpbnRlcmFjdFBvaW50UG9zaXRpb24gPSBtb2QuQWRkKAogICAgICAgICAgICBtb2QuQWRkKHBsYXllclBvc2l0aW9uLCBwbGF5ZXJGYWNpbmdEaXJlY3Rpb24pLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDEuNSwgMCkKICAgICAgICApOwoKICAgICAgICBjb25zdCBpbnRlcmFjdFBvaW50OiBtb2QuSW50ZXJhY3RQb2ludCA9IG1vZC5TcGF3bk9iamVjdCgKICAgICAgICAgICAgbW9kLlJ1bnRpbWVTcGF3bl9Db21tb24uSW50ZXJhY3RQb2ludCwKICAgICAgICAgICAgaW50ZXJhY3RQb2ludFBvc2l0aW9uLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDAsIDApCiAgICAgICAgKTsKCiAgICAgICAgbW9kLkVuYWJsZUludGVyYWN0UG9pbnQoaW50ZXJhY3RQb2ludCwgdHJ1ZSk7CiAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uaW50ZXJhY3RQb2ludCA9IGludGVyYWN0UG9pbnQ7CiAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0ubGFzdERlcGxveVRpbWUgPSBtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpOwogICAgfQp9CgpmdW5jdGlvbiB0ZWFtU3dpdGNoSW50ZXJhY3RQb2ludEFjdGl2YXRlZChldmVudFBsYXllcjogbW9kLlBsYXllciwgZXZlbnRJbnRlcmFjdFBvaW50OiBtb2QuSW50ZXJhY3RQb2ludCkgewogICAgY29uc3QgcGxheWVySWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXSkgaW5pdFRlYW1Td2l0Y2hEYXRhKGV2ZW50UGxheWVyKTsKCiAgICBpZiAoU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uaW50ZXJhY3RQb2ludCAhPSBudWxsKSB7CiAgICAgICAgY29uc3QgaW50ZXJhY3RQb2ludElkID0gbW9kLkdldE9iaklkKFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdLmludGVyYWN0UG9pbnQpOwogICAgICAgIGNvbnN0IGV2ZW50SW50ZXJhY3RQb2ludElkID0gbW9kLkdldE9iaklkKGV2ZW50SW50ZXJhY3RQb2ludCk7CiAgICAgICAgaWYgKGludGVyYWN0UG9pbnRJZCA9PT0gZXZlbnRJbnRlcmFjdFBvaW50SWQpIHsKICAgICAgICAgICAgc2V0VUlJbnB1dE1vZGVGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIsIHRydWUpOwogICAgICAgICAgICBjcmVhdGVUZWFtU3dpdGNoVUkoZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICAvLyBUcmFjayB2aXNpYmlsaXR5IHNvIHJvc3RlciByZWZyZXNoZXMgY2FuIHRhcmdldCBhbGwgdmlld2VycyB3aXRoIHRoZSBkaWFsb2cgb3Blbi4KICAgICAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uZGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICAgICAgICAgIGlmIChjb25zdW1lSm9pblByb21wdFRyaXBsZVRhcEZvclBpZChwbGF5ZXJJZCkpIHsKICAgICAgICAgICAgICAgIG1hcmtKb2luUHJvbXB0UmVhZHlEaWFsb2dPcGVuZWQocGxheWVySWQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBpZChwbGF5ZXJJZCk7CiAgICAgICAgICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yVmlld2VyKGV2ZW50UGxheWVyLCBwbGF5ZXJJZCk7CiAgICAgICAgICAgIC8vIEltbWVkaWF0ZSBzZWxmLXJlZnJlc2ggdG8gYXZvaWQgcmVseWluZyBzb2xlbHkgb24gZ2xvYmFsIHJlZnJlc2ggYm9va2tlZXBpbmcuCgogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gcmVtb3ZlVGVhbVN3aXRjaEludGVyYWN0UG9pbnQoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIgfCBudW1iZXIpIHsKICAgIGxldCBwbGF5ZXJJZDogbnVtYmVyOwoKICAgIGlmIChtb2QuSXNUeXBlKGV2ZW50UGxheWVyLCBtb2QuVHlwZXMuUGxheWVyKSkgewogICAgICAgIHBsYXllcklkID0gbW9kLkdldE9iaklkKGV2ZW50UGxheWVyIGFzIG1vZC5QbGF5ZXIpOwogICAgfSBlbHNlIHsKICAgICAgICBwbGF5ZXJJZCA9IGV2ZW50UGxheWVyIGFzIG51bWJlcjsKICAgIH0KCiAgICBpZiAoIVN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdKSByZXR1cm47CgogICAgaWYgKFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdLmludGVyYWN0UG9pbnQgIT0gbnVsbCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG1vZC5FbmFibGVJbnRlcmFjdFBvaW50KFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdLmludGVyYWN0UG9pbnQgYXMgbW9kLkludGVyYWN0UG9pbnQsIGZhbHNlKTsKICAgICAgICAgICAgbW9kLlVuc3Bhd25PYmplY3QoU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uaW50ZXJhY3RQb2ludCBhcyBtb2QuSW50ZXJhY3RQb2ludCk7CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIC8vIEJlc3QtZWZmb3J0IGNsZWFudXA7IGlnbm9yZSBpZiBhbHJlYWR5IGRlc3Bhd25lZCBieSB0aGUgZW5naW5lLgogICAgICAgIH0KICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5pbnRlcmFjdFBvaW50ID0gbnVsbDsKICAgIH0KfQoKZnVuY3Rpb24gaXNWZWxvY2l0eUJleW9uZCh0aHJlc2hvbGQ6IG51bWJlciwgZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIpOiBib29sZWFuIHsKICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChldmVudFBsYXllcikpIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IHYgPSBzYWZlR2V0U29sZGllclN0YXRlVmVjdG9yKGV2ZW50UGxheWVyLCBtb2QuU29sZGllclN0YXRlVmVjdG9yLkdldExpbmVhclZlbG9jaXR5KTsKICAgIGlmICghdikgcmV0dXJuIGZhbHNlOwogICAgY29uc3QgeCA9IG1vZC5BYnNvbHV0ZVZhbHVlKG1vZC5YQ29tcG9uZW50T2YodikpOwogICAgY29uc3QgeSA9IG1vZC5BYnNvbHV0ZVZhbHVlKG1vZC5ZQ29tcG9uZW50T2YodikpOwogICAgY29uc3QgeiA9IG1vZC5BYnNvbHV0ZVZhbHVlKG1vZC5aQ29tcG9uZW50T2YodikpOwogICAgcmV0dXJuIHggKyB5ICsgeiA+IHRocmVzaG9sZDsKfQoKZnVuY3Rpb24gY2hlY2tUZWFtU3dpdGNoSW50ZXJhY3RQb2ludFJlbW92YWwoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIpIHsKICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChldmVudFBsYXllcikpIHJldHVybjsKICAgIGNvbnN0IGlzRGVhZCA9IHNhZmVHZXRTb2xkaWVyU3RhdGVCb29sKGV2ZW50UGxheWVyLCBtb2QuU29sZGllclN0YXRlQm9vbC5Jc0RlYWQpOwogICAgaWYgKFRFQU1TV0lUQ0hDT05GSUcuZW5hYmxlVGVhbVN3aXRjaCAmJiAhaXNEZWFkKSB7CiAgICAgICAgY29uc3QgcGxheWVySWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgICAgIGlmICghU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0pIGluaXRUZWFtU3dpdGNoRGF0YShldmVudFBsYXllcik7CgogICAgICAgIGlmIChTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5pbnRlcmFjdFBvaW50ICE9IG51bGwpIHsKICAgICAgICAgICAgY29uc3QgbGlmZXRpbWUgPSBtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpIC0gU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0ubGFzdERlcGxveVRpbWU7CgogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBpc1ZlbG9jaXR5QmV5b25kKFRFQU1TV0lUQ0hDT05GSUcudmVsb2NpdHlUaHJlc2hvbGQsIGV2ZW50UGxheWVyKSB8fAogICAgICAgICAgICAgICAgbGlmZXRpbWUgPiBURUFNU1dJVENIQ09ORklHLmludGVyYWN0UG9pbnRNYXhMaWZldGltZQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHJlbW92ZVRlYW1Td2l0Y2hJbnRlcmFjdFBvaW50KHBsYXllcklkKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gaW5pdFRlYW1Td2l0Y2hEYXRhKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKSB7CiAgICBjb25zdCBwbGF5ZXJJZCA9IG1vZC5HZXRPYmpJZChldmVudFBsYXllcik7CiAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXSA9IHsKICAgICAgICBkb250U2hvd0FnYWluOiBmYWxzZSwKICAgICAgICBhZG1pblBhbmVsVmlzaWJsZTogZmFsc2UsCiAgICAgICAgYWRtaW5QYW5lbEJ1aWx0OiBmYWxzZSwKICAgICAgICBsYXN0QWRtaW5QYW5lbFRvZ2dsZUF0OiAwLAogICAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICAgIGludGVyYWN0UG9pbnQ6IG51bGwsCiAgICAgICAgbGFzdERlcGxveVRpbWU6IDAsCiAgICAgICAgdWlCdWlsdDogZmFsc2UsCiAgICAgICAgcG9zRGVidWdWaXNpYmxlOiBmYWxzZSwKICAgICAgICBwb3NEZWJ1Z1Rva2VuOiAwLAogICAgfTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIFRlYW0gU3dpdGNoIEludGVyYWN0IFBvaW50IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBUZWFtIFN3aXRjaCBBY3Rpb25zIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBIYW5kbGVzIGEgcGxheWVyLWluaXRpYXRlZCB0ZWFtIHN3aXRjaC4KLy8gVGhpcyBmdW5jdGlvbiB2YWxpZGF0ZXMgdGhlIHJlcXVlc3QsIHVwZGF0ZXMgdGVhbSBtZW1iZXJzaGlwLAovLyBhbmQgdHJpZ2dlcnMgYW55IHJlcXVpcmVkIEhVRCBvciBzdGF0ZSByZWZyZXNoLgoKLy8gUGVyZm9ybXMgYW4gdW5kZXBsb3kgd2l0aCBhIHNob3J0IGRlbGF5IHRvIGVuc3VyZSB0aGUgZW5naW5lIGhhcyBhcHBsaWVkIGEgcHJpb3IgU2V0VGVhbSgpIGJlZm9yZSBjaGFuZ2luZyBkZXBsb3kgc3RhdGUuCi8vIFRoaXMgaW50ZW50aW9uYWxseSBkb2VzIE5PVCByZS1kZXBsb3kgdGhlIHBsYXllcjsgdGhlIHBsYXllciBpcyBleHBlY3RlZCB0byBjaG9vc2UgYSBzcGF3biBwb2ludCBtYW51YWxseS4KYXN5bmMgZnVuY3Rpb24gZm9yY2VVbmRlcGxveVBsYXllcihldmVudFBsYXllcjogbW9kLlBsYXllcik6IFByb21pc2U8dm9pZD4gewogICAgaWYgKCFldmVudFBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQoZXZlbnRQbGF5ZXIpKSByZXR1cm47CiAgICAvLyBVbmRlcGxveSBpbW1lZGlhdGVseSBzbyB0aGUgcGxheWVyIGlzIGZvcmNlZCB0byB0aGUgZGVwbG95IHNjcmVlbiByaWdodCBhd2F5LgogICAgLy8gVGhlbiByZXRyeSBvbmNlIHdpdGggYSBzaG9ydCBkZWxheSBmb3Igcm9idXN0bmVzcyBhY3Jvc3MgdHJhbnNpZW50IGVuZ2luZSB0aW1pbmcuCiAgICBtb2QuVW5kZXBsb3lQbGF5ZXIoZXZlbnRQbGF5ZXIpOwogICAgYXdhaXQgbW9kLldhaXQoMC4wNSk7CiAgICBpZiAoIWV2ZW50UGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChldmVudFBsYXllcikpIHJldHVybjsKICAgIG1vZC5VbmRlcGxveVBsYXllcihldmVudFBsYXllcik7Cn0KCmZ1bmN0aW9uIHByb2Nlc3NUZWFtU3dpdGNoKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKSB7CiAgICAvLyBMZWdhY3kgdGVhbS1zd2l0Y2ggcGF0aHdheSByZXRhaW5lZCBmb3IgcmV1c2UgYnkgdGhlIFJlYWR5IERpYWxvZyAoU3dhcCBUZWFtcyBidXR0b246IFN3YXAgVGVhbXMgYnV0dG9uKS4KICAgIC8vIFJlcXVpcmVtZW50czoKICAgIC8vIC0gQ2hhbmdlIHRoZSBwbGF5ZXIncyB0ZWFtIGFzc2lnbm1lbnQgKFRlYW1JRC5UZWFtMSA8LT4gVGVhbUlELlRlYW0yKQogICAgLy8gLSBGb3JjZSB0aGUgcGxheWVyIGJhY2sgdG8gdGhlIGRlcGxveSBzY3JlZW4gb24gdGhlIG5ldyB0ZWFtIChub3QganVzdCB1cGRhdGUgVUkvcm9zdGVyIHN0YXRlKQogICAgLy8KICAgIC8vIE5PVEU6IFNvbWUgZW5naW5lcyBjYWNoZSB0ZWFtIGFmZmlsaWF0aW9uIG9uIHRoZSBkZXBsb3llZCBzb2xkaWVyIGVudGl0eTsgdGhlcmVmb3JlIHdlOgogICAgLy8gMSkgU2V0IHRoZSB0ZWFtLCB0aGVuCiAgICAvLyAyKSBVbmRlcGxveSB0aGUgcGxheWVyIHNvIHRoZXkgbXVzdCByZWRlcGxveSBvbiB0aGUgbmV3IHRlYW0uCgogICAgLy8gQ2xvc2UgZGlhbG9nICsgcmVzdG9yZSBVSSBpbnB1dCBtb2RlIGJlZm9yZSB0ZWFtIG11dGF0aW9uL3VuZGVwbG95IHRvIGF2b2lkIHN0YWxlIGhhbmRsZSBpc3N1ZXMuCiAgICBkZWxldGVUZWFtU3dpdGNoVUkoZXZlbnRQbGF5ZXIpOwoKICAgIGNvbnN0IGN1cnJlbnRUZWFtTnVtID0gZ2V0VGVhbU51bWJlcihtb2QuR2V0VGVhbShldmVudFBsYXllcikpOwogICAgY29uc3QgbmV3VGVhbU51bSA9IChjdXJyZW50VGVhbU51bSA9PT0gVGVhbUlELlRlYW0yKSA/IFRlYW1JRC5UZWFtMSA6IFRlYW1JRC5UZWFtMjsKICAgIG1vZC5TZXRUZWFtKGV2ZW50UGxheWVyLCBtb2QuR2V0VGVhbShuZXdUZWFtTnVtKSk7CgogICAgLy8gRm9yY2UgYSByYXBpZCByZXR1cm4gdG8gdGhlIGRlcGxveSBzY3JlZW4gc28gdGhlIHBsYXllciByZXNwYXducyBvbiB0aGUgbmV3IHRlYW0uCiAgICAvLyBOb3RlOiBkbyBub3QgbW9kaWZ5IHJlZGVwbG95IHRpbWVycyBnbG9iYWxseTsgd2Ugb25seSBmb3JjZSBhbiB1bmRlcGxveSBzbyB0aGUgcGxheWVyIGNhbiBjaG9vc2Ugc3Bhd24gbWFudWFsbHkuCiAgICAvLyBFbnN1cmUgdGVhbSBzd2l0Y2hpbmcgZG9lcyBub3QgZ3JhbnQgZmFzdGVyLXRoYW4tbm9ybWFsIHJlc3Bhd24gdGltaW5nLgogICAgLy8gV2UgcmV1c2UgdGhlIHNhbWUgcmVkZXBsb3kgd2luZG93IHVzZWQgYXQgcm91bmQgZW5kIChST1VORF9FTkRfUkVERVBMT1lfREVMQVlfU0VDT05EUykuCiAgICBtb2QuU2V0UmVkZXBsb3lUaW1lKGV2ZW50UGxheWVyLCBST1VORF9FTkRfUkVERVBMT1lfREVMQVlfU0VDT05EUyk7CiAgICB2b2lkIGZvcmNlVW5kZXBsb3lQbGF5ZXIoZXZlbnRQbGF5ZXIpOwoKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy50ZWFtU3dpdGNoKSwKICAgICAgICBmYWxzZSwKICAgICAgICBtb2QuR2V0VGVhbShldmVudFBsYXllciksCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMudGVhbVN3aXRjaAogICAgKTsKfQoKZnVuY3Rpb24gZGVsZXRlVGVhbVN3aXRjaFVJKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyIHwgbnVtYmVyKSB7CiAgICAvLyBEZWxldGVzIHRoZSBUZWFtIFN3aXRjaCBVSSBmb3IgdGhlIGdpdmVuIHBsYXllciBpZCBhbmQgcmVzdG9yZXMgbm9ybWFsIGlucHV0LgogICAgLy8gTm90ZTogV2hlbiBjYWxsZWQgd2l0aCBhIHBsYXllciBpZCAobnVtYmVyKSByYXRoZXIgdGhhbiBhIG1vZC5QbGF5ZXIsIFVJIGlucHV0IG1vZGUgY2Fubm90IGJlIHRvZ2dsZWQgaGVyZS4KCiAgICBsZXQgcGxheWVySWQ6IGFueSA9IGV2ZW50UGxheWVyOwoKICAgIGlmIChtb2QuSXNUeXBlKGV2ZW50UGxheWVyLCBtb2QuVHlwZXMuUGxheWVyKSkgewogICAgICAgIHNldFVJSW5wdXRNb2RlRm9yUGxheWVyKGV2ZW50UGxheWVyIGFzIG1vZC5QbGF5ZXIsIGZhbHNlKTsKICAgICAgICBwbGF5ZXJJZCA9IG1vZC5HZXRPYmpJZChldmVudFBsYXllciBhcyBtb2QuUGxheWVyKTsKICAgIH0KCiAgICBjb25zdCBiYXNlV2lkZ2V0ID0gc2FmZUZpbmQoVUlfVEVBTVNXSVRDSF9DT05UQUlORVJfQkFTRV9JRCArIHBsYXllcklkKTsKICAgIGlmIChiYXNlV2lkZ2V0KSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGJhc2VXaWRnZXQsIGZhbHNlKTsKICAgIGNvbnN0IGJvcmRlclRvcCA9IHNhZmVGaW5kKFVJX1RFQU1TV0lUQ0hfQk9SREVSX1RPUF9JRCArIHBsYXllcklkKTsKICAgIGlmIChib3JkZXJUb3ApIG1vZC5TZXRVSVdpZGdldFZpc2libGUoYm9yZGVyVG9wLCBmYWxzZSk7CiAgICBjb25zdCBib3JkZXJCb3R0b20gPSBzYWZlRmluZChVSV9URUFNU1dJVENIX0JPUkRFUl9CT1RUT01fSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAoYm9yZGVyQm90dG9tKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGJvcmRlckJvdHRvbSwgZmFsc2UpOwogICAgY29uc3QgYm9yZGVyTGVmdCA9IHNhZmVGaW5kKFVJX1RFQU1TV0lUQ0hfQk9SREVSX0xFRlRfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAoYm9yZGVyTGVmdCkgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShib3JkZXJMZWZ0LCBmYWxzZSk7CiAgICBjb25zdCBib3JkZXJSaWdodCA9IHNhZmVGaW5kKFVJX1RFQU1TV0lUQ0hfQk9SREVSX1JJR0hUX0lEICsgcGxheWVySWQpOwogICAgaWYgKGJvcmRlclJpZ2h0KSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGJvcmRlclJpZ2h0LCBmYWxzZSk7CiAgICBjb25zdCBkZWJ1Z1dpZGdldCA9IHNhZmVGaW5kKFVJX1RFQU1TV0lUQ0hfREVCVUdfVElNRUxJTUlUX0lEICsgcGxheWVySWQpOwogICAgaWYgKGRlYnVnV2lkZ2V0KSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShkZWJ1Z1dpZGdldCwgZmFsc2UpOwogICAgfQogICAgY29uc3QgbWFwTGFiZWwgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTUFQX0xBQkVMX0lEICsgcGxheWVySWQpOwogICAgaWYgKG1hcExhYmVsKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKG1hcExhYmVsLCBmYWxzZSk7CiAgICBjb25zdCBtYXBWYWx1ZSA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19NQVBfVkFMVUVfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAobWFwVmFsdWUpIG1vZC5TZXRVSVdpZGdldFZpc2libGUobWFwVmFsdWUsIGZhbHNlKTsKCiAgICAvLyBBZG1pbiBwYW5lbCBpcyBub3QgY2FjaGVkOiBkZWxldGUgY29udGFpbmVyICsgY2hpbGRyZW4gKyB0b2dnbGUgb24gY2xvc2UgdG8gcHJldmVudCBzdHJheSB3aWRnZXRzLgogICAgZGVsZXRlQWRtaW5QYW5lbFVJKHBsYXllcklkLCB0cnVlKTsKICAgIHNldEFkbWluUGFuZWxDaGlsZFdpZGdldHNWaXNpYmxlKHBsYXllcklkLCBmYWxzZSk7CgogICAgaWYgKFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdKSB7CiAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uYWRtaW5QYW5lbFZpc2libGUgPSBmYWxzZTsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5hZG1pblBhbmVsQnVpbHQgPSBmYWxzZTsKICAgICAgICAvLyBGb3JjZS1oaWRlIGFueSBzdHJheSBhZG1pbiBwYW5lbCBjaGlsZHJlbiAoc29tZSBlbmdpbmVzIGRvIG5vdCBjYXNjYWRlIGNvbnRhaW5lciB2aXNpYmlsaXR5KS4KICAgICAgICBzZXRBZG1pblBhbmVsQ2hpbGRXaWRnZXRzVmlzaWJsZShwbGF5ZXJJZCwgZmFsc2UpOwogICAgICAgIC8vIERlbGV0ZSBhbnkgcHJldmlvdXNseS1idWlsdCBhZG1pbiBjb250YWluZXIgc28gdGhlIHBhbmVsIHdpbGwgcmVidWlsZCBjbGVhbmx5IG9uIGRlbWFuZC4KICAgICAgICBjb25zdCBleGlzdGluZ0FkbWluQ29udGFpbmVyID0gc2FmZUZpbmQoVUlfQURNSU5fUEFORUxfQ09OVEFJTkVSX0lEICsgcGxheWVySWQpOwogICAgICAgIGlmIChleGlzdGluZ0FkbWluQ29udGFpbmVyKSBtb2QuRGVsZXRlVUlXaWRnZXQoZXhpc3RpbmdBZG1pbkNvbnRhaW5lcik7CiAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5hZG1pblBhbmVsQnVpbHQgPSBmYWxzZTsKICAgICAgICAvLyBEaWFsb2cgaXMgbm8gbG9uZ2VyIHZpc2libGU7IHN0b3AgcGFydGljaXBhdGluZyBpbiBnbG9iYWwgcm9zdGVyIHJlZnJlc2hlcy4KICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5kaWFsb2dWaXNpYmxlID0gZmFsc2U7CiAgICB9CgogICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yUGlkKHBsYXllcklkKTsKfQoKZnVuY3Rpb24gY2xvc2VSZWFkeURpYWxvZ0ZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChwKTsKICAgICAgICBpZiAoU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwaWRdPy5kaWFsb2dWaXNpYmxlKSB7CiAgICAgICAgICAgIGRlbGV0ZVRlYW1Td2l0Y2hVSShwKTsKICAgICAgICB9CiAgICB9Cn0KCi8vIEhhcmQgZGVsZXRlIHVzZWQgb25seSBmb3IgY2xlYW51cCAoZS5nLiwgcGxheWVyIGxlYXZlcyBnYW1lKS4KLy8gTm9ybWFsIGRpYWxvZyBjbG9zZSBzaG91bGQgaGlkZSB3aWRnZXRzIHRvIGVuYWJsZSBVSSBjYWNoaW5nIGFuZCBmYXN0ZXIgcmVvcGVuLgpmdW5jdGlvbiBoYXJkRGVsZXRlVGVhbVN3aXRjaFVJKHBsYXllcklkOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IGJhc2VXaWRnZXQgPSBzYWZlRmluZChVSV9URUFNU1dJVENIX0NPTlRBSU5FUl9CQVNFX0lEICsgcGxheWVySWQpOwogICAgaWYgKGJhc2VXaWRnZXQpIG1vZC5EZWxldGVVSVdpZGdldChiYXNlV2lkZ2V0KTsKICAgIGNvbnN0IGJvcmRlclRvcCA9IHNhZmVGaW5kKFVJX1RFQU1TV0lUQ0hfQk9SREVSX1RPUF9JRCArIHBsYXllcklkKTsKICAgIGlmIChib3JkZXJUb3ApIG1vZC5EZWxldGVVSVdpZGdldChib3JkZXJUb3ApOwogICAgY29uc3QgYm9yZGVyQm90dG9tID0gc2FmZUZpbmQoVUlfVEVBTVNXSVRDSF9CT1JERVJfQk9UVE9NX0lEICsgcGxheWVySWQpOwogICAgaWYgKGJvcmRlckJvdHRvbSkgbW9kLkRlbGV0ZVVJV2lkZ2V0KGJvcmRlckJvdHRvbSk7CiAgICBjb25zdCBib3JkZXJMZWZ0ID0gc2FmZUZpbmQoVUlfVEVBTVNXSVRDSF9CT1JERVJfTEVGVF9JRCArIHBsYXllcklkKTsKICAgIGlmIChib3JkZXJMZWZ0KSBtb2QuRGVsZXRlVUlXaWRnZXQoYm9yZGVyTGVmdCk7CiAgICBjb25zdCBib3JkZXJSaWdodCA9IHNhZmVGaW5kKFVJX1RFQU1TV0lUQ0hfQk9SREVSX1JJR0hUX0lEICsgcGxheWVySWQpOwogICAgaWYgKGJvcmRlclJpZ2h0KSBtb2QuRGVsZXRlVUlXaWRnZXQoYm9yZGVyUmlnaHQpOwogICAgY29uc3QgZGVidWdXaWRnZXQgPSBzYWZlRmluZChVSV9URUFNU1dJVENIX0RFQlVHX1RJTUVMSU1JVF9JRCArIHBsYXllcklkKTsKICAgIGlmIChkZWJ1Z1dpZGdldCkgbW9kLkRlbGV0ZVVJV2lkZ2V0KGRlYnVnV2lkZ2V0KTsKICAgIGNvbnN0IG1hcExhYmVsID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01BUF9MQUJFTF9JRCArIHBsYXllcklkKTsKICAgIGlmIChtYXBMYWJlbCkgbW9kLkRlbGV0ZVVJV2lkZ2V0KG1hcExhYmVsKTsKICAgIGNvbnN0IG1hcFZhbHVlID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01BUF9WQUxVRV9JRCArIHBsYXllcklkKTsKICAgIGlmIChtYXBWYWx1ZSkgbW9kLkRlbGV0ZVVJV2lkZ2V0KG1hcFZhbHVlKTsKCiAgICAvLyBBZG1pbiBQYW5lbCB3aWRnZXRzICh0b2dnbGUgYnV0dG9uICsgbGFiZWwgKyBjb250YWluZXIpLgogICAgY29uc3QgYWRtaW5Ub2dnbGUgPSBzYWZlRmluZChVSV9BRE1JTl9QQU5FTF9CVVRUT05fSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAoYWRtaW5Ub2dnbGUpIG1vZC5EZWxldGVVSVdpZGdldChhZG1pblRvZ2dsZSk7CiAgICBjb25zdCBhZG1pblRvZ2dsZUxhYmVsID0gc2FmZUZpbmQoVUlfQURNSU5fUEFORUxfQlVUVE9OX0xBQkVMX0lEICsgcGxheWVySWQpOwogICAgaWYgKGFkbWluVG9nZ2xlTGFiZWwpIG1vZC5EZWxldGVVSVdpZGdldChhZG1pblRvZ2dsZUxhYmVsKTsKICAgIGNvbnN0IGFkbWluVG9nZ2xlQm9yZGVyID0gc2FmZUZpbmQoVUlfQURNSU5fUEFORUxfQlVUVE9OX0lEICsgcGxheWVySWQgKyAiX0JPUkRFUiIpOwogICAgaWYgKGFkbWluVG9nZ2xlQm9yZGVyKSBtb2QuRGVsZXRlVUlXaWRnZXQoYWRtaW5Ub2dnbGVCb3JkZXIpOwogICAgY29uc3QgYWRtaW5Db250YWluZXIgPSBzYWZlRmluZChVSV9BRE1JTl9QQU5FTF9DT05UQUlORVJfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAoYWRtaW5Db250YWluZXIpIG1vZC5EZWxldGVVSVdpZGdldChhZG1pbkNvbnRhaW5lcik7CgogICAgY29uc3QgcG9zQ29udGFpbmVyID0gc2FmZUZpbmQoVUlfUE9TX0RFQlVHX0NPTlRBSU5FUl9JRCArIHBsYXllcklkKTsKICAgIGlmIChwb3NDb250YWluZXIpIG1vZC5EZWxldGVVSVdpZGdldChwb3NDb250YWluZXIpOwogICAgY29uc3QgcG9zWCA9IHNhZmVGaW5kKFVJX1BPU19ERUJVR19YX0lEICsgcGxheWVySWQpOwogICAgaWYgKHBvc1gpIG1vZC5EZWxldGVVSVdpZGdldChwb3NYKTsKICAgIGNvbnN0IHBvc1kgPSBzYWZlRmluZChVSV9QT1NfREVCVUdfWV9JRCArIHBsYXllcklkKTsKICAgIGlmIChwb3NZKSBtb2QuRGVsZXRlVUlXaWRnZXQocG9zWSk7CiAgICBjb25zdCBwb3NaID0gc2FmZUZpbmQoVUlfUE9TX0RFQlVHX1pfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAocG9zWikgbW9kLkRlbGV0ZVVJV2lkZ2V0KHBvc1opOwogICAgY29uc3Qgcm90WSA9IHNhZmVGaW5kKFVJX1BPU19ERUJVR19ST1RZX0lEICsgcGxheWVySWQpOwogICAgaWYgKHJvdFkpIG1vZC5EZWxldGVVSVdpZGdldChyb3RZKTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIFRlYW0gU3dpdGNoIEFjdGlvbnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFRlYW0gU3dpdGNoIFVJICsgVGVzdGVyIFBhbmVsIChJRHMgKyBidWlsZCBoZWxwZXJzKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gdGVhbVN3aXRjaEJ1dHRvbkV2ZW50KAogICAgZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsCiAgICBldmVudFVJV2lkZ2V0OiBtb2QuVUlXaWRnZXQsCiAgICBldmVudFVJQnV0dG9uRXZlbnQ6IG1vZC5VSUJ1dHRvbkV2ZW50CikgewogICAgLy8gU3RlcHM6CiAgICAvLyAxKSBJZGVudGlmeSB3aGljaCBidXR0b24gd2FzIHByZXNzZWQgZm9yIHRoaXMgcGxheWVyCiAgICAvLyAyKSBNdXRhdGUgYXV0aG9yaXRhdGl2ZSBzdGF0ZSAobWF0Y2ggLyByb3VuZCBjb3VudGVycykgaWYgYXBwbGljYWJsZQogICAgLy8gMykgUmVzeW5jIEhVRC9VSSBwcm9qZWN0aW9ucyBzbyBldmVyeSBwbGF5ZXIgc2VlcyB0aGUgbmV3IHN0YXRlCgogICAgY29uc3QgcGxheWVySWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgY29uc3Qgd2lkZ2V0TmFtZSA9IG1vZC5HZXRVSVdpZGdldE5hbWUoZXZlbnRVSVdpZGdldCk7CgogICAgc3dpdGNoICh3aWRnZXROYW1lKSB7CiAgICAgICAgY2FzZSBVSV9URUFNU1dJVENIX0JVVFRPTl9URUFNMV9JRCArIHBsYXllcklkOgogICAgICAgIGNhc2UgVUlfVEVBTVNXSVRDSF9CVVRUT05fVEVBTTJfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgLy8gRGVwcmVjYXRlZCBVSSAodjAuNSk6IFRlYW0gMSAvIFRlYW0gMiBidXR0b25zIHJlbW92ZWQgZnJvbSB0aGUgZGlhbG9nLgogICAgICAgICAgICAvLyBUaGlzIGhhbmRsZXIgcGF0aCBpcyBpbnRlbnRpb25hbGx5IHJldGFpbmVkIHNvIHRoZSBVSSBjYW4gYmUgcmUtZW5hYmxlZCBsYXRlciB3aXRob3V0IHJlLWltcGxlbWVudGluZyB0ZWFtIHN3aXRjaCBsb2dpYy4KICAgICAgICAgICAgcHJvY2Vzc1RlYW1Td2l0Y2goZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBVSV9URUFNU1dJVENIX0JVVFRPTl9DQU5DRUxfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgZGVsZXRlVGVhbVN3aXRjaFVJKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9SRUFEWV9JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIC8vIFByZS1yb3VuZCBnYXRpbmc6OiBwbGF5ZXJzIG1heSBvbmx5IHRyYW5zaXRpb24gdG8gUkVBRFkgd2hpbGUgaW4gdGhlaXIgbWFpbiBiYXNlIHdoZW4gdGhlIHJvdW5kIGlzIE5PVCBhY3RpdmUuCiAgICAgICAgICAgIC8vIFJlYWR5LWN5Y2xlIGF1dG8tc3RhcnQgLyByZXNldDo6IHdoZW4gYWxsIGFjdGl2ZSBwbGF5ZXJzIGJlY29tZSBSRUFEWSwgYXV0by1zdGFydCB0aGUgcm91bmQgdmlhIHN0YXJ0Um91bmQoKS4KICAgICAgICAgICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgLy8gTWFudWFsIHJlYWR5IGRpc2FibGVzIGF1dG8tcmVhZHkgdG8gZW5mb3JjZSBhIHNpbmdsZSByZWFkeSBtZXRob2QgYXQgYSB0aW1lLgogICAgICAgICAgICBpZiAoU3RhdGUucGxheWVycy5hdXRvUmVhZHlCeVBpZFtwaWRdKSB7CiAgICAgICAgICAgICAgICBTdGF0ZS5wbGF5ZXJzLmF1dG9SZWFkeUJ5UGlkW3BpZF0gPSBmYWxzZTsKICAgICAgICAgICAgICAgIHVwZGF0ZUF1dG9SZWFkeVRvZ2dsZUJ1dHRvbkZvclZpZXdlcihldmVudFBsYXllciwgcGlkKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBjdXJyZW50bHlSZWFkeSA9ICEhU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW3BpZF07CiAgICAgICAgICAgIGNvbnN0IGluQmFzZSA9IGlzUGxheWVySW5NYWluQmFzZUZvclJlYWR5KHBpZCk7CiAgICAgICAgICAgIGNvbnN0IG5vd1NlY29uZHMgPSBNYXRoLmZsb29yKG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCkpOwoKICAgICAgICAgICAgLy8gVHJhbnNpdGlvbiBydWxlczoKICAgICAgICAgICAgLy8gLSBOT1QgUkVBRFkgLT4gUkVBRFk6IGFsbG93ZWQgb25seSBpZiAoaW5CYXNlIHx8IGlzUm91bmRMaXZlKCkpIChQcmUtcm91bmQgZ2F0aW5nOiBnYXRpbmcgYXBwbGllcyBvbmx5IHByZS1yb3VuZCkuCiAgICAgICAgICAgIC8vIC0gUkVBRFkgLT4gTk9UIFJFQURZOiBhbHdheXMgYWxsb3dlZC4KICAgICAgICAgICAgaWYgKCFjdXJyZW50bHlSZWFkeSkgewogICAgICAgICAgICAgICAgaWYgKCFpc1JvdW5kTGl2ZSgpICYmICFpbkJhc2UpIHsKICAgICAgICAgICAgICAgICAgICAvLyBEZW55IHJlYWR5LXVwIG91dHNpZGUgb2YgYmFzZSBwcmUtcm91bmQgKG5vIG1lc3NhZ2luZyBpbiBjdXJyZW50IG1pbGVzdG9uZSkuCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSA9IHRydWU7CgogICAgICAgICAgICAgICAgLy8gS2VlcCB0aGUgSFVEICJYIC8gWSBQTEFZRVJTIFJFQURZIiBsaW5lIGluIHN5bmMgb24gZXZlcnkgcmVhZHktc3RhdGUgY2hhbmdlLgogICAgICAgICAgICAgICAgdXBkYXRlUGxheWVyc1JlYWR5SHVkVGV4dEZvckFsbFBsYXllcnMoKTsKCiAgICAgICAgICAgICAgICAvLyBUaHJvdHRsZSByZWFkeS11cCBicm9hZGNhc3RzIHBlciBwbGF5ZXIgdG8gcHJldmVudCBzcGFtLgogICAgICAgICAgICAgICAgY29uc3QgbGFzdFJlYWR5QXQgPSBTdGF0ZS5wbGF5ZXJzLnJlYWR5TWVzc2FnZUNvb2xkb3duQnlQaWRbcGlkXSA/PyAtOTk5OTsKICAgICAgICAgICAgICAgIGlmIChub3dTZWNvbmRzIC0gbGFzdFJlYWR5QXQgPj0gUkVBRFlfVVBfTUVTU0FHRV9DT09MRE9XTl9TRUNPTkRTKSB7CiAgICAgICAgICAgICAgICAgICAgU3RhdGUucGxheWVycy5yZWFkeU1lc3NhZ2VDb29sZG93bkJ5UGlkW3BpZF0gPSBub3dTZWNvbmRzOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvdW50cyA9IGdldFJlYWR5Q291bnRzRm9yTWVzc2FnZSgpOwogICAgICAgICAgICAgICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX1BMQVlFUl9SRUFESUVEX1VQLCBldmVudFBsYXllciwgY291bnRzLnJlYWR5Q291bnQsIGNvdW50cy50b3RhbENvdW50KSwKICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLAogICAgICAgICAgICAgICAgICAgICAgICBTVFJfUExBWUVSX1JFQURJRURfVVAKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW3BpZF0gPSBmYWxzZTsKICAgICAgICAgICAgICAgIC8vIEtlZXAgdGhlIEhVRCAiWCAvIFkgUExBWUVSUyBSRUFEWSIgbGluZSBpbiBzeW5jIG9uIGV2ZXJ5IHJlYWR5LXN0YXRlIGNoYW5nZS4KICAgICAgICAgICAgICAgIHVwZGF0ZVBsYXllcnNSZWFkeUh1ZFRleHRGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBpZChwaWQpOwoKICAgICAgICAgICAgLy8gUmVmcmVzaCBzZWxmICsgYWxsIHZpc2libGUgdmlld2VycyAoY2VudHJhbGl6ZWQgcmVuZGVyKS4KICAgICAgICAgICAgcmVuZGVyUmVhZHlEaWFsb2dGb3JWaWV3ZXIoZXZlbnRQbGF5ZXIsIHBsYXllcklkKTsKICAgICAgICAgICAgLy8gUmVmcmVzaCBhbGwgdmlzaWJsZSB2aWV3ZXJzIHNvIGV2ZXJ5b25lIHNlZXMgcmVhZGluZXNzIGNoYW5nZXMgaW1tZWRpYXRlbHkuCgogICAgICAgICAgICAvLyBBbHNvIHJlZnJlc2ggYWxsIG90aGVyIHZpZXdlcnMgd2hvIGN1cnJlbnRseSBoYXZlIHRoZSBkaWFsb2cgb3Blbi4KICAgICAgICAgICAgcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycygpOwogICAgICAgICAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwoKICAgICAgICAgICAgLy8gUmVhZHktY3ljbGUgYXV0by1zdGFydCAvIHJlc2V0OjogaWYgdGhpcyBpbnRlcmFjdGlvbiByZXN1bHRlZCBpbiBhbGwgYWN0aXZlIHBsYXllcnMgYmVpbmcgUkVBRFksIGJlZ2luIHRoZSByb3VuZC4KICAgICAgICAgICAgdHJ5QXV0b1N0YXJ0Um91bmRJZkFsbFJlYWR5KGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjYXNlIFVJX1JFQURZX0RJQUxPR19CVVRUT05fQVVUT19SRUFEWV9JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChldmVudFBsYXllcik7CiAgICAgICAgICAgIGNvbnN0IG5leHRBdXRvUmVhZHkgPSAhU3RhdGUucGxheWVycy5hdXRvUmVhZHlCeVBpZFtwaWRdOwogICAgICAgICAgICBTdGF0ZS5wbGF5ZXJzLmF1dG9SZWFkeUJ5UGlkW3BpZF0gPSBuZXh0QXV0b1JlYWR5OwogICAgICAgICAgICB1cGRhdGVBdXRvUmVhZHlUb2dnbGVCdXR0b25Gb3JWaWV3ZXIoZXZlbnRQbGF5ZXIsIHBpZCk7CiAgICAgICAgICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBpZChwaWQpOwoKICAgICAgICAgICAgaWYgKG5leHRBdXRvUmVhZHkpIHsKICAgICAgICAgICAgICAgIC8vIEF1dG8tcmVhZHkgbW9kZSBhbHdheXMgc3RhcnRzIGZyb20gTk9UIFJFQURZLgogICAgICAgICAgICAgICAgaWYgKFN0YXRlLnBsYXllcnMucmVhZHlCeVBpZFtwaWRdKSB7CiAgICAgICAgICAgICAgICAgICAgU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW3BpZF0gPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVSZWFkeVRvZ2dsZUJ1dHRvbkZvclZpZXdlcihldmVudFBsYXllciwgcGlkKTsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCBjaGFuZ2VkID0gYXBwbHlBdXRvUmVhZHlGb3JQaWQoZXZlbnRQbGF5ZXIsIHBpZCk7CiAgICAgICAgICAgIGlmIChjaGFuZ2VkKSB7CiAgICAgICAgICAgICAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgICAgICAgICAgICAgcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycygpOwogICAgICAgICAgICAgICAgdHJ5QXV0b1N0YXJ0Um91bmRJZkFsbFJlYWR5KGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yVmlld2VyKGV2ZW50UGxheWVyLCBwbGF5ZXJJZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjYXNlIFVJX1JFQURZX0RJQUxPR19CVVRUT05fU1dBUF9JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIC8vIFN3YXAgVGVhbXMgYnV0dG9uOjogc2luZ2xlLWJ1dHRvbiB0ZWFtIHRvZ2dsZS4KICAgICAgICAgICAgc3dhcFBsYXllclRlYW0oZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGNhc2UgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfSUQgKyBwbGF5ZXJJZDogewogICAgICAgICAgICAvLyBDbGFtcCB0byBjdXJyZW50IHJvdW5kIHNvIG1heCByb3VuZHMgbmV2ZXIgZGlwcyBiZWxvdyB0aGUgbGl2ZSByb3VuZCBpbmRleC4KICAgICAgICAgICAgZW5zdXJlQ3VzdG9tR2FtZU1vZGVGb3JNYW51YWxDaGFuZ2UoKTsKICAgICAgICAgICAgY29uc3QgcHJldk1heCA9IFN0YXRlLnJvdW5kLm1heDsKICAgICAgICAgICAgc2V0SHVkUm91bmRDb3VudGVyc0ZvckFsbFBsYXllcnMoU3RhdGUucm91bmQuY3VycmVudCwgTWF0aC5tYXgoU3RhdGUucm91bmQuY3VycmVudCwgTWF0aC5tYXgoMSwgU3RhdGUucm91bmQubWF4IC0gMSkpKTsKICAgICAgICAgICAgaWYgKFN0YXRlLnJvdW5kLm1heCAhPT0gcHJldk1heCkgewogICAgICAgICAgICAgICAgLy8gR2FtZXBsYXktZ2F0ZWQgd29ybGQgbG9nIG1lc3NhZ2UgZm9yIGJlc3Qtb2YgY2hhbmdlcy4KICAgICAgICAgICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuYmVzdE9mQ2hhbmdlZCwgZXZlbnRQbGF5ZXIsIE1hdGguZmxvb3IoU3RhdGUucm91bmQubWF4KSksCiAgICAgICAgICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJlc3RPZkNoYW5nZWQKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfSUQgKyBwbGF5ZXJJZDogewogICAgICAgICAgICBlbnN1cmVDdXN0b21HYW1lTW9kZUZvck1hbnVhbENoYW5nZSgpOwogICAgICAgICAgICBjb25zdCBwcmV2TWF4ID0gU3RhdGUucm91bmQubWF4OwogICAgICAgICAgICBzZXRIdWRSb3VuZENvdW50ZXJzRm9yQWxsUGxheWVycyhTdGF0ZS5yb3VuZC5jdXJyZW50LCBTdGF0ZS5yb3VuZC5tYXggKyAxKTsKICAgICAgICAgICAgaWYgKFN0YXRlLnJvdW5kLm1heCAhPT0gcHJldk1heCkgewogICAgICAgICAgICAgICAgLy8gR2FtZXBsYXktZ2F0ZWQgd29ybGQgbG9nIG1lc3NhZ2UgZm9yIGJlc3Qtb2YgY2hhbmdlcy4KICAgICAgICAgICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuYmVzdE9mQ2hhbmdlZCwgZXZlbnRQbGF5ZXIsIE1hdGguZmxvb3IoU3RhdGUucm91bmQubWF4KSksCiAgICAgICAgICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJlc3RPZkNoYW5nZWQKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgVUlfUkVBRFlfRElBTE9HX01BVENIVVBfREVDX0lEICsgcGxheWVySWQ6IHsKICAgICAgICAgICAgaWYgKGlzUm91bmRMaXZlKCkpIGJyZWFrOwogICAgICAgICAgICBjb25zdCBuZXh0ID0gTWF0aC5tYXgoMCwgU3RhdGUucm91bmQubWF0Y2h1cFByZXNldEluZGV4IC0gMSk7CiAgICAgICAgICAgIGFwcGx5TWF0Y2h1cFByZXNldChuZXh0LCBldmVudFBsYXllcik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0lOQ19JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSBicmVhazsKICAgICAgICAgICAgY29uc3QgbmV4dCA9IE1hdGgubWluKE1BVENIVVBfUFJFU0VUUy5sZW5ndGggLSAxLCBTdGF0ZS5yb3VuZC5tYXRjaHVwUHJlc2V0SW5kZXggKyAxKTsKICAgICAgICAgICAgYXBwbHlNYXRjaHVwUHJlc2V0KG5leHQsIGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgVUlfUkVBRFlfRElBTE9HX01JTlBMQVlFUlNfREVDX0lEICsgcGxheWVySWQ6IHsKICAgICAgICAgICAgaWYgKGlzUm91bmRMaXZlKCkpIGJyZWFrOwogICAgICAgICAgICBzZXRBdXRvU3RhcnRNaW5BY3RpdmVQbGF5ZXJzKFN0YXRlLnJvdW5kLmF1dG9TdGFydE1pbkFjdGl2ZVBsYXllcnMgLSAxLCBldmVudFBsYXllcik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIFVJX1JFQURZX0RJQUxPR19NSU5QTEFZRVJTX0lOQ19JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSBicmVhazsKICAgICAgICAgICAgc2V0QXV0b1N0YXJ0TWluQWN0aXZlUGxheWVycyhTdGF0ZS5yb3VuZC5hdXRvU3RhcnRNaW5BY3RpdmVQbGF5ZXJzICsgMSwgZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9HQU1FX0RFQ19JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSBicmVhazsKICAgICAgICAgICAgc2V0UmVhZHlEaWFsb2dHYW1lTW9kZUluZGV4KFN0YXRlLnJvdW5kLm1vZGVDb25maWcuZ2FtZU1vZGVJbmRleCAtIDEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9HQU1FX0lOQ19JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSBicmVhazsKICAgICAgICAgICAgc2V0UmVhZHlEaWFsb2dHYW1lTW9kZUluZGV4KFN0YXRlLnJvdW5kLm1vZGVDb25maWcuZ2FtZU1vZGVJbmRleCArIDEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19ERUNfSUQgKyBwbGF5ZXJJZDogewogICAgICAgICAgICBpZiAoaXNSb3VuZExpdmUoKSkgYnJlYWs7CiAgICAgICAgICAgIHNldFJlYWR5RGlhbG9nQWlyY3JhZnRDZWlsaW5nKAogICAgICAgICAgICAgICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5haXJjcmFmdENlaWxpbmcgLSBSRUFEWV9ESUFMT0dfQUlSQ1JBRlRfQ0VJTElOR19TVEVQLAogICAgICAgICAgICAgICAgZXZlbnRQbGF5ZXIKICAgICAgICAgICAgKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgVUlfUkVBRFlfRElBTE9HX01PREVfU0VUVElOR1NfSU5DX0lEICsgcGxheWVySWQ6IHsKICAgICAgICAgICAgaWYgKGlzUm91bmRMaXZlKCkpIGJyZWFrOwogICAgICAgICAgICBzZXRSZWFkeURpYWxvZ0FpcmNyYWZ0Q2VpbGluZygKICAgICAgICAgICAgICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcuYWlyY3JhZnRDZWlsaW5nICsgUkVBRFlfRElBTE9HX0FJUkNSQUZUX0NFSUxJTkdfU1RFUCwKICAgICAgICAgICAgICAgIGV2ZW50UGxheWVyCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QxX0RFQ19JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSBicmVhazsKICAgICAgICAgICAgc2V0UmVhZHlEaWFsb2dWZWhpY2xlSW5kZXhUMShTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVJbmRleFQxIC0gMSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QxX0lOQ19JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSBicmVhazsKICAgICAgICAgICAgc2V0UmVhZHlEaWFsb2dWZWhpY2xlSW5kZXhUMShTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVJbmRleFQxICsgMSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QyX0RFQ19JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSBicmVhazsKICAgICAgICAgICAgc2V0UmVhZHlEaWFsb2dWZWhpY2xlSW5kZXhUMihTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVJbmRleFQyIC0gMSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QyX0lOQ19JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSBicmVhazsKICAgICAgICAgICAgc2V0UmVhZHlEaWFsb2dWZWhpY2xlSW5kZXhUMihTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVJbmRleFQyICsgMSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIFVJX1JFQURZX0RJQUxPR19NT0RFX0NPTkZJUk1fSUQgKyBwbGF5ZXJJZDogewogICAgICAgICAgICBpZiAoaXNSb3VuZExpdmUoKSkgYnJlYWs7CiAgICAgICAgICAgIGNvbmZpcm1SZWFkeURpYWxvZ01vZGVDb25maWcoZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICB1cGRhdGVSZWFkeURpYWxvZ01vZGVDb25maWdGb3JBbGxWaXNpYmxlVmlld2VycygpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9SRVNFVF9JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSBicmVhazsKICAgICAgICAgICAgdHJpZ2dlckZyZXNoUm91bmRTZXR1cChldmVudFBsYXllcik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgY2FzZSBVSV9URUFNU1dJVENIX0JVVFRPTl9PUFRPVVRfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgLy8gRGVwcmVjYXRlZCBVSSAodjAuNSk6ICdET05UIFNIT1cgQUdBSU4nIGJ1dHRvbiByZW1vdmVkIGZyb20gdGhlIGRpYWxvZy4KICAgICAgICAgICAgLy8gVGhlIG9wdC1vdXQgZmxhZyBhbmQgYmVoYXZpb3IgcmVtYWluIHRvIHN1cHBvcnQgcmVpbnRyb2R1Y2luZyB0aGUgY29udHJvbCBpbiBhIGZ1dHVyZSB2ZXJzaW9uLgogICAgICAgICAgICBpZiAoIVN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdKSBpbml0VGVhbVN3aXRjaERhdGEoZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5kb250U2hvd0FnYWluID0gdHJ1ZTsKICAgICAgICAgICAgZGVsZXRlVGVhbVN3aXRjaFVJKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfQURNSU5fUEFORUxfQlVUVE9OX0lEICsgcGxheWVySWQ6IHsKICAgICAgICAgICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXSkgaW5pdFRlYW1Td2l0Y2hEYXRhKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgY29uc3Qgbm93ID0gbW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKTsKICAgICAgICAgICAgaWYgKG5vdyAtIFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdLmxhc3RBZG1pblBhbmVsVG9nZ2xlQXQgPCBBRE1JTl9QQU5FTF9UT0dHTEVfQ09PTERPV05fU0VDT05EUykgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0ubGFzdEFkbWluUGFuZWxUb2dnbGVBdCA9IG5vdzsKCiAgICAgICAgICAgIC8vIFRvZ2dsZSBhZG1pbiBwYW5lbCB2aXNpYmlsaXR5LgogICAgICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5hZG1pblBhbmVsVmlzaWJsZSA9ICFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5hZG1pblBhbmVsVmlzaWJsZTsKICAgICAgICAgICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5hZG1pblBhbmVsVmlzaWJsZSkgewogICAgICAgICAgICAgICAgLy8gQ2xvc2U6IGRlbGV0ZSBwYW5lbCBjb250ZW50cyB0byBhdm9pZCAiZ2hvc3QiIGNoaWxkcmVuIG9uIHNvbWUgY2xpZW50cy4KICAgICAgICAgICAgICAgIGRlbGV0ZUFkbWluUGFuZWxVSShwbGF5ZXJJZCwgZmFsc2UpOwogICAgICAgICAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uYWRtaW5QYW5lbEJ1aWx0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWNjZXNzZWQsIGV2ZW50UGxheWVyKSwKICAgICAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY2Nlc3NlZAogICAgICAgICAgICApOwoKICAgICAgICAgICAgLy8gT3BlbjogcmVidWlsZCBjb250YWluZXIgKyB3aWRnZXRzIGZyZXNoIGVhY2ggdGltZSAobG93IGNvc3Q7IGF2b2lkcyBkdXBsaWNhdGUgZHJhdyBidWdzKS4KICAgICAgICAgICAgZGVsZXRlQWRtaW5QYW5lbFVJKHBsYXllcklkLCBmYWxzZSk7IC8vIHNhZmV0eTogZW5zdXJlIG5vIHN0YWxlIGNvbnRhaW5lci9jaGlsZHJlbiBleGlzdAoKICAgICAgICAgICAgbW9kLkFkZFVJQ29udGFpbmVyKAogICAgICAgICAgICAgICAgVUlfQURNSU5fUEFORUxfQ09OVEFJTkVSX0lEICsgcGxheWVySWQsCiAgICAgICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKEFETUlOX1BBTkVMX09GRlNFVF9YLCBBRE1JTl9QQU5FTF9PRkZTRVRfWSwgMCksCiAgICAgICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKEFETUlOX1BBTkVMX0NPTlRFTlRfV0lEVEggKyAoQURNSU5fUEFORUxfUEFERElORyAqIDIpLCBBRE1JTl9QQU5FTF9IRUlHSFQgKyAoQURNSU5fUEFORUxfUEFERElORyAqIDIpLCAwKSwKICAgICAgICAgICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICAgICAgICAgIG1vZC5HZXRVSVJvb3QoKSwKICAgICAgICAgICAgICAgIGZhbHNlLAogICAgICAgICAgICAgICAgMTAsCiAgICAgICAgICAgICAgICBBRE1JTl9QQU5FTF9CR19DT0xPUiwKICAgICAgICAgICAgICAgIEFETUlOX1BBTkVMX0JHX0FMUEhBLAogICAgICAgICAgICAgICAgQURNSU5fUEFORUxfQkdfRklMTCwKICAgICAgICAgICAgICAgIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJLAogICAgICAgICAgICAgICAgZXZlbnRQbGF5ZXIKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGNvbnN0IGFkbWluQ29udGFpbmVyID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFVJX0FETUlOX1BBTkVMX0NPTlRBSU5FUl9JRCArIHBsYXllcklkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgICAgICBpZiAoIWFkbWluQ29udGFpbmVyKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBidWlsZEFkbWluUGFuZWxXaWRnZXRzKGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQpOwogICAgICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5hZG1pblBhbmVsQnVpbHQgPSB0cnVlOwogICAgICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGFkbWluQ29udGFpbmVyLCB0cnVlKTsKICAgICAgICAgICAgc2V0QWRtaW5QYW5lbENoaWxkV2lkZ2V0c1Zpc2libGUocGxheWVySWQsIHRydWUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIC8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBUZWFtIFN3aXRjaCBVSSArIFRlc3RlciBQYW5lbCAoSURzICsgYnVpbGQgaGVscGVycykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKICAgICAgICAvLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gVGVzdGVyIEJ1dHRvbiBFdmVudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9MRUZUX1dJTlNfREVDX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIHNldEh1ZFdpbkNvdW50ZXJzRm9yQWxsUGxheWVycyhNYXRoLm1heCgwLCBTdGF0ZS5tYXRjaC53aW5zVDEgLSAxKSwgU3RhdGUubWF0Y2gud2luc1QyKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50MVdpbnNEZWMpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX0xFRlRfV0lOU19JTkNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgc2V0SHVkV2luQ291bnRlcnNGb3JBbGxQbGF5ZXJzKFN0YXRlLm1hdGNoLndpbnNUMSArIDEsIFN0YXRlLm1hdGNoLndpbnNUMik7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudDFXaW5zSW5jKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fUklHSFRfV0lOU19ERUNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgc2V0SHVkV2luQ291bnRlcnNGb3JBbGxQbGF5ZXJzKFN0YXRlLm1hdGNoLndpbnNUMSwgTWF0aC5tYXgoMCwgU3RhdGUubWF0Y2gud2luc1QyIC0gMSkpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnQyV2luc0RlYyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fUklHSFRfV0lOU19JTkNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgc2V0SHVkV2luQ291bnRlcnNGb3JBbGxQbGF5ZXJzKFN0YXRlLm1hdGNoLndpbnNUMSwgU3RhdGUubWF0Y2gud2luc1QyICsgMSk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudDJXaW5zSW5jKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fTEVGVF9LSUxMU19ERUNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscyA9IE1hdGgubWF4KDAsIFN0YXRlLnNjb3Jlcy50MVRvdGFsS2lsbHMgLSAxKTsKICAgICAgICAgICAgc3luY0tpbGxzSHVkRnJvbVRyYWNrZWRUb3RhbHModHJ1ZSk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudDFUb3RhbEtpbGxzRGVjKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9MRUZUX0tJTExTX0lOQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBTdGF0ZS5zY29yZXMudDFUb3RhbEtpbGxzID0gU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscyArIDE7CiAgICAgICAgICAgIHN5bmNLaWxsc0h1ZEZyb21UcmFja2VkVG90YWxzKHRydWUpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnQxVG90YWxLaWxsc0luYyk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX1JJR0hUX0tJTExTX0RFQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBTdGF0ZS5zY29yZXMudDJUb3RhbEtpbGxzID0gTWF0aC5tYXgoMCwgU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscyAtIDEpOwogICAgICAgICAgICBzeW5jS2lsbHNIdWRGcm9tVHJhY2tlZFRvdGFscyh0cnVlKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50MlRvdGFsS2lsbHNEZWMpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX1JJR0hUX0tJTExTX0lOQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBTdGF0ZS5zY29yZXMudDJUb3RhbEtpbGxzID0gU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscyArIDE7CiAgICAgICAgICAgIHN5bmNLaWxsc0h1ZEZyb21UcmFja2VkVG90YWxzKHRydWUpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnQyVG90YWxLaWxsc0luYyk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX0FETUlOX0JVVFRPTl9UMV9ST1VORF9LSUxMU19ERUNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscyA9IE1hdGgubWF4KDAsIFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgLSAxKTsKICAgICAgICAgICAgc3luY1JvdW5kS2lsbHNIdWQodHJ1ZSk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudDFSb3VuZEtpbGxzRGVjKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9BRE1JTl9CVVRUT05fVDFfUk9VTkRfS0lMTFNfSU5DX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgPSBTdGF0ZS5zY29yZXMudDFSb3VuZEtpbGxzICsgMTsKICAgICAgICAgICAgc3luY1JvdW5kS2lsbHNIdWQodHJ1ZSk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudDFSb3VuZEtpbGxzSW5jKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0RFQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzID0gTWF0aC5tYXgoMCwgU3RhdGUuc2NvcmVzLnQyUm91bmRLaWxscyAtIDEpOwogICAgICAgICAgICBzeW5jUm91bmRLaWxsc0h1ZCh0cnVlKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50MlJvdW5kS2lsbHNEZWMpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFVJX0FETUlOX0JVVFRPTl9UMl9ST1VORF9LSUxMU19JTkNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgU3RhdGUuc2NvcmVzLnQyUm91bmRLaWxscyA9IFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHMgKyAxOwogICAgICAgICAgICBzeW5jUm91bmRLaWxsc0h1ZCh0cnVlKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50MlJvdW5kS2lsbHNJbmMpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9ST1VORF9LSUxMU19UQVJHRVRfREVDX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIFN0YXRlLnJvdW5kLmtpbGxzVGFyZ2V0ID0gTWF0aC5tYXgoMSwgU3RhdGUucm91bmQua2lsbHNUYXJnZXQgLSAxKTsKICAgICAgICAgICAgLy8gUmVmcmVzaCBIVUQgaGVscCB0ZXh0ICgiRmlyc3QgdG8gWCBLaWxscyIpIGltbWVkaWF0ZWx5IHdoZW4gdGFyZ2V0IGtpbGxzIGNoYW5nZXMgaW4gdGhlIEFkbWluIFBhbmVsLgogICAgICAgICAgICBzZXRSb3VuZFN0YXRlVGV4dEZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgc3luY1JvdW5kS2lsbHNUYXJnZXRUZXN0ZXJWYWx1ZUZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50YXJnZXRSb3VuZEtpbGxzRGVjKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9ST1VORF9LSUxMU19UQVJHRVRfSU5DX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIC8vIE5PVEU6IEFkbWluLXBhbmVsIHRhcmdldC1raWxscyBhZGp1c3RtZW50cyBtdXN0IHJlZnJlc2ggdGhlIEhVRCBoZWxwIHRleHQgaW1tZWRpYXRlbHkuCiAgICAgICAgICAgIFN0YXRlLnJvdW5kLmtpbGxzVGFyZ2V0ID0gU3RhdGUucm91bmQua2lsbHNUYXJnZXQgKyAxOwogICAgICAgICAgICAvLyBSZWZyZXNoIEhVRCBoZWxwIHRleHQgKCJGaXJzdCB0byBYIEtpbGxzIikgaW1tZWRpYXRlbHkgd2hlbiB0YXJnZXQga2lsbHMgY2hhbmdlcyBpbiB0aGUgQWRtaW4gUGFuZWwuCiAgICAgICAgICAgIHNldFJvdW5kU3RhdGVUZXh0Rm9yQWxsUGxheWVycygpOwogICAgICAgICAgICBzeW5jUm91bmRLaWxsc1RhcmdldFRlc3RlclZhbHVlRm9yQWxsUGxheWVycygpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnRhcmdldFJvdW5kS2lsbHNJbmMpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9USUVTX0RFQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBhZGp1c3RNYXRjaFRpZXNGb3JCb3RoVGVhbXMoLTEpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnRpZXNEZWMpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX1RJRVNfSU5DX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIGFkanVzdE1hdGNoVGllc0ZvckJvdGhUZWFtcygxKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50aWVzSW5jKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fQ1VSX1JPVU5EX0RFQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBzZXRIdWRSb3VuZENvdW50ZXJzRm9yQWxsUGxheWVycyhNYXRoLm1heCgwLCBTdGF0ZS5yb3VuZC5jdXJyZW50IC0gMSksIFN0YXRlLnJvdW5kLm1heCk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMuY3VycmVudFJvdW5kRGVjKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9DVVJfUk9VTkRfSU5DX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIHNldEh1ZFJvdW5kQ291bnRlcnNGb3JBbGxQbGF5ZXJzKFN0YXRlLnJvdW5kLmN1cnJlbnQgKyAxLCBTdGF0ZS5yb3VuZC5tYXgpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLmN1cnJlbnRSb3VuZEluYyk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX0NMT0NLX1RJTUVfREVDX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIGFkanVzdFJvdW5kQ2xvY2tCeVNlY29uZHMoLTYwKTsKICAgICAgICAgICAgdXBkYXRlT3ZlcnRpbWVTdGFnZSgpOwogICAgICAgICAgICBpZiAoaXNSb3VuZExpdmUoKSkgewogICAgICAgICAgICAgICAgcmVmcmVzaE92ZXJ0aW1lVWlWaXNpYmlsaXR5Rm9yQWxsUGxheWVycygpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMuY2xvY2tUaW1lRGVjKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9DTE9DS19USU1FX0lOQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBpZiAoIVN0YXRlLnJvdW5kLmNsb2NrLmlzUGF1c2VkICYmIGdldFJlbWFpbmluZ1NlY29uZHMoKSA8IDApIHsKICAgICAgICAgICAgICAgIFJlc2V0Um91bmRDbG9jayg2MCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhZGp1c3RSb3VuZENsb2NrQnlTZWNvbmRzKDYwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cGRhdGVPdmVydGltZVN0YWdlKCk7CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSB7CiAgICAgICAgICAgICAgICByZWZyZXNoT3ZlcnRpbWVVaVZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy5jbG9ja1RpbWVJbmMpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9DTE9DS19SRVNFVF9JRCArIHBsYXllcklkOgogICAgICAgICAgICBpZiAoaXNSb3VuZExpdmUoKSkgewogICAgICAgICAgICAgICAgcmVzZXRSb3VuZENsb2NrVG9EZWZhdWx0KCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzZXRSb3VuZENsb2NrUHJldmlldyhnZXRDb25maWd1cmVkUm91bmRMZW5ndGhTZWNvbmRzKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHVwZGF0ZU92ZXJ0aW1lU3RhZ2UoKTsKICAgICAgICAgICAgaWYgKGlzUm91bmRMaXZlKCkpIHsKICAgICAgICAgICAgICAgIHJlZnJlc2hPdmVydGltZVVpVmlzaWJpbGl0eUZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLmNsb2NrUmVzZXQpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9ST1VORF9TVEFSVF9JRCArIHBsYXllcklkOgogICAgICAgICAgICBzdGFydFByZWdhbWVDb3VudGRvd24oZXZlbnRQbGF5ZXIsIHRydWUpOyAvL29sZDogc3RhcnRSb3VuZChldmVudFBsYXllcik7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMucm91bmRTdGFydCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fUk9VTkRfRU5EX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIGVuZFJvdW5kKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy5yb3VuZEVuZCk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX1BPU19ERUJVR19JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmICghU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0pIGluaXRUZWFtU3dpdGNoRGF0YShldmVudFBsYXllcik7CiAgICAgICAgICAgIGNvbnN0IHN0YXRlID0gU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF07CiAgICAgICAgICAgIHN0YXRlLnBvc0RlYnVnVmlzaWJsZSA9ICFzdGF0ZS5wb3NEZWJ1Z1Zpc2libGU7CiAgICAgICAgICAgIHNldFBvc2l0aW9uRGVidWdWaXNpYmxlRm9yUGxheWVyKGV2ZW50UGxheWVyLCBzdGF0ZS5wb3NEZWJ1Z1Zpc2libGUpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnBvc2l0aW9uRGVidWcpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGNhc2UgVUlfQURNSU5fVElFQlJFQUtFUl9CVVRUT05fSUQgKyAiQV8iICsgcGxheWVySWQ6CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudGllQnJlYWtlck92ZXJyaWRlQSk7CiAgICAgICAgICAgIGFwcGx5QWRtaW5UaWVCcmVha2VyT3ZlcnJpZGUoMCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgVUlfQURNSU5fVElFQlJFQUtFUl9CVVRUT05fSUQgKyAiQl8iICsgcGxheWVySWQ6CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudGllQnJlYWtlck92ZXJyaWRlQik7CiAgICAgICAgICAgIGFwcGx5QWRtaW5UaWVCcmVha2VyT3ZlcnJpZGUoMSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgVUlfQURNSU5fVElFQlJFQUtFUl9CVVRUT05fSUQgKyAiQ18iICsgcGxheWVySWQ6CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudGllQnJlYWtlck92ZXJyaWRlQyk7CiAgICAgICAgICAgIGFwcGx5QWRtaW5UaWVCcmVha2VyT3ZlcnJpZGUoMik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgVUlfQURNSU5fVElFQlJFQUtFUl9CVVRUT05fSUQgKyAiRF8iICsgcGxheWVySWQ6CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudGllQnJlYWtlck92ZXJyaWRlRCk7CiAgICAgICAgICAgIGFwcGx5QWRtaW5UaWVCcmVha2VyT3ZlcnJpZGUoMyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgVUlfQURNSU5fVElFQlJFQUtFUl9CVVRUT05fSUQgKyAiRV8iICsgcGxheWVySWQ6CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudGllQnJlYWtlck92ZXJyaWRlRSk7CiAgICAgICAgICAgIGFwcGx5QWRtaW5UaWVCcmVha2VyT3ZlcnJpZGUoNCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgVUlfQURNSU5fVElFQlJFQUtFUl9CVVRUT05fSUQgKyAiRl8iICsgcGxheWVySWQ6CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudGllQnJlYWtlck92ZXJyaWRlRik7CiAgICAgICAgICAgIGFwcGx5QWRtaW5UaWVCcmVha2VyT3ZlcnJpZGUoNSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgVUlfQURNSU5fVElFQlJFQUtFUl9CVVRUT05fSUQgKyAiR18iICsgcGxheWVySWQ6CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudGllQnJlYWtlck92ZXJyaWRlRyk7CiAgICAgICAgICAgIGFwcGx5QWRtaW5UaWVCcmVha2VyT3ZlcnJpZGUoNik7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX0FETUlOX1RJRUJSRUFLRVJfTU9ERV9ERUNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgaWYgKGlzUm91bmRMaXZlKCkpIGJyZWFrOwogICAgICAgICAgICBTdGF0ZS5hZG1pbi50aWVCcmVha2VyTW9kZUluZGV4ID0gbm9ybWFsaXplVGllQnJlYWtlck1vZGVJbmRleChTdGF0ZS5hZG1pbi50aWVCcmVha2VyTW9kZUluZGV4IC0gMSk7CiAgICAgICAgICAgIHN5bmNBZG1pblRpZUJyZWFrZXJNb2RlTGFiZWxGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIGdldFRpZUJyZWFrZXJNb2RlQWN0aW9uS2V5KFN0YXRlLmFkbWluLnRpZUJyZWFrZXJNb2RlSW5kZXgpKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9BRE1JTl9USUVCUkVBS0VSX01PREVfSU5DX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSBicmVhazsKICAgICAgICAgICAgU3RhdGUuYWRtaW4udGllQnJlYWtlck1vZGVJbmRleCA9IG5vcm1hbGl6ZVRpZUJyZWFrZXJNb2RlSW5kZXgoU3RhdGUuYWRtaW4udGllQnJlYWtlck1vZGVJbmRleCArIDEpOwogICAgICAgICAgICBzeW5jQWRtaW5UaWVCcmVha2VyTW9kZUxhYmVsRm9yQWxsUGxheWVycygpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBnZXRUaWVCcmVha2VyTW9kZUFjdGlvbktleShTdGF0ZS5hZG1pbi50aWVCcmVha2VyTW9kZUluZGV4KSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX0FETUlOX0xJVkVfUkVTUEFXTl9CVVRUT05fSUQgKyBwbGF5ZXJJZDogewogICAgICAgICAgICBTdGF0ZS5hZG1pbi5saXZlUmVzcGF3bkVuYWJsZWQgPSAhU3RhdGUuYWRtaW4ubGl2ZVJlc3Bhd25FbmFibGVkOwogICAgICAgICAgICBzeW5jQWRtaW5MaXZlUmVzcGF3bkxhYmVsRm9yQWxsUGxheWVycygpOwogICAgICAgICAgICB1cGRhdGVTcGF3bkRpc2FibGVkV2FybmluZ0ZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbigKICAgICAgICAgICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgICAgICAgICAgU3RhdGUuYWRtaW4ubGl2ZVJlc3Bhd25FbmFibGVkCiAgICAgICAgICAgICAgICAgICAgPyBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLmxpdmVSZXNwYXduT24KICAgICAgICAgICAgICAgICAgICA6IG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMubGl2ZVJlc3Bhd25PZmYKICAgICAgICAgICAgKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjYXNlIFVJX0FETUlOX1JPVU5EX0xFTkdUSF9ERUNfSUQgKyBwbGF5ZXJJZDogewogICAgICAgICAgICBpZiAoaXNSb3VuZExpdmUoKSkgYnJlYWs7CiAgICAgICAgICAgIGNvbnN0IG5leHQgPSBjbGFtcFJvdW5kTGVuZ3RoU2Vjb25kcyhnZXRDb25maWd1cmVkUm91bmRMZW5ndGhTZWNvbmRzKCkgLSBBRE1JTl9ST1VORF9MRU5HVEhfU1RFUF9TRUNPTkRTKTsKICAgICAgICAgICAgc2V0Um91bmRDbG9ja1ByZXZpZXcobmV4dCk7CiAgICAgICAgICAgIHVwZGF0ZUFsbFBsYXllcnNDbG9jaygpOwogICAgICAgICAgICB1cGRhdGVPdmVydGltZVN0YWdlKCk7CiAgICAgICAgICAgIHN5bmNBZG1pblJvdW5kTGVuZ3RoTGFiZWxGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMucm91bmRMZW5ndGhEZWMpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSBVSV9BRE1JTl9ST1VORF9MRU5HVEhfSU5DX0lEICsgcGxheWVySWQ6IHsKICAgICAgICAgICAgaWYgKGlzUm91bmRMaXZlKCkpIGJyZWFrOwogICAgICAgICAgICBjb25zdCBuZXh0ID0gY2xhbXBSb3VuZExlbmd0aFNlY29uZHMoZ2V0Q29uZmlndXJlZFJvdW5kTGVuZ3RoU2Vjb25kcygpICsgQURNSU5fUk9VTkRfTEVOR1RIX1NURVBfU0VDT05EUyk7CiAgICAgICAgICAgIHNldFJvdW5kQ2xvY2tQcmV2aWV3KG5leHQpOwogICAgICAgICAgICB1cGRhdGVBbGxQbGF5ZXJzQ2xvY2soKTsKICAgICAgICAgICAgdXBkYXRlT3ZlcnRpbWVTdGFnZSgpOwogICAgICAgICAgICBzeW5jQWRtaW5Sb3VuZExlbmd0aExhYmVsRm9yQWxsUGxheWVycygpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnJvdW5kTGVuZ3RoSW5jKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhazsKICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIFRlc3RlciBCdXR0b24gRXZlbnRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSb3VuZCBTdGFydC9FbmQgRmxvdyArIFN0YXRlIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBSdW5zIHJvdW5kIHN0YXJ0L2VuZCBmbG93IHRpZWQgdG8gdGhlIHJvdW5kIGNsb2NrIGV4cGlyeS4KLy8gVmljdG9yeSBkaWFsb2cgdmlzaWJpbGl0eSBpcyBpbnRlbnRpb25hbGx5IGRlY291cGxlZCBmcm9tIFN0YXRlLm1hdGNoLmlzRW5kZWQuCi8vIFN0YXRlLm1hdGNoLmlzRW5kZWQgY2FuIGJlY29tZSB0cnVlIGF0IHJvdW5kIGVuZCwgYnV0IHRoZSBWaWN0b3J5IFVJIHNob3VsZCBvbmx5IGFwcGVhciBhZnRlciB0aGUgMTBzIHJvdW5kLWVuZCB3aW5kb3cgZXhwaXJlcy4KLy8gU3RhdGUubWF0Y2gudmljdG9yeURpYWxvZ0FjdGl2ZSBnYXRlcyBib3RoIHZpc2liaWxpdHkgYW5kIGNvdW50ZG93biB1cGRhdGVzIHNvIHRoZSByZXN0YXJ0IHRpbWVyIGFsd2F5cyBzdGFydHMgYXQgNDVzIHdoZW4gdGhlIGRpYWxvZyBhcHBlYXJzLgoKLy8gQXN5bmMgY29udHJvbCAocm91bmQgZW5kKToKLy8gLSBTdGF0ZS5yb3VuZC5mbG93LnJvdW5kRW5kUmVkZXBsb3lUb2tlbiBpbnZhbGlkYXRlcyBhbnkgaW4tZmxpZ2h0IHJvdW5kLWVuZCBjb3VudGRvd25zIHdoZW4gaW5jcmVtZW50ZWQuCi8vIC0gU3RhdGUucm91bmQuZmxvdy5jbG9ja0V4cGlyeUJvdW5kIHByZXZlbnRzIGRvdWJsZS1iaW5kaW5nIHRoZSBjbG9jay1leHBpcnkgaGFuZGxlci4KLy8gQXN5bmMgY29udHJvbCAobWF0Y2ggZW5kKToKLy8gLSBTdGF0ZS5tYXRjaC5mbG93Lm1hdGNoRW5kRGVsYXlUb2tlbiBpbnZhbGlkYXRlcyBhbnkgaW4tZmxpZ2h0IG1hdGNoLWVuZCBkZWxheXMgd2hlbiBpbmNyZW1lbnRlZC4KCgpmdW5jdGlvbiBicm9hZGNhc3RTdHJpbmdLZXkoCiAgICBzdHJpbmdLZXk6IG51bWJlciwKICAgIGFyZzA/OiBzdHJpbmcgfCBudW1iZXIgfCBtb2QuUGxheWVyLAogICAgYXJnMT86IHN0cmluZyB8IG51bWJlciB8IG1vZC5QbGF5ZXIsCiAgICBhcmcyPzogc3RyaW5nIHwgbnVtYmVyIHwgbW9kLlBsYXllcgopOiB2b2lkIHsKICAgIGNvbnN0IG1lc3NhZ2UgPSAoYXJnMCA9PT0gdW5kZWZpbmVkKQogICAgICAgID8gbW9kLk1lc3NhZ2Uoc3RyaW5nS2V5KQogICAgICAgIDogKGFyZzEgPT09IHVuZGVmaW5lZCkKICAgICAgICAgICAgPyBtb2QuTWVzc2FnZShzdHJpbmdLZXksIGFyZzApCiAgICAgICAgICAgIDogKGFyZzIgPT09IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgID8gbW9kLk1lc3NhZ2Uoc3RyaW5nS2V5LCBhcmcwLCBhcmcxKQogICAgICAgICAgICAgICAgOiBtb2QuTWVzc2FnZShzdHJpbmdLZXksIGFyZzAsIGFyZzEsIGFyZzIpOwogICAgc2VuZE5vdGlmaWNhdGlvbk1lc3NhZ2UobWVzc2FnZSwgZmFsc2UpOwp9CgovLyBUT0RPKDEuMCk6IFVudXNlZDsgcmVtb3ZlIGJlZm9yZSBmaW5hbCAxLjAgcmVsZWFzZS4KZnVuY3Rpb24gYnJvYWRjYXN0R2FtZXBsYXlOb3RpZmljYXRpb25LZXkoCiAgICBzdHJpbmdLZXk6IG51bWJlciwKICAgIGFyZzA/OiBzdHJpbmcgfCBudW1iZXIgfCBtb2QuUGxheWVyLAogICAgYXJnMT86IHN0cmluZyB8IG51bWJlciB8IG1vZC5QbGF5ZXIsCiAgICBhcmcyPzogc3RyaW5nIHwgbnVtYmVyIHwgbW9kLlBsYXllcgopOiB2b2lkIHsKICAgIGNvbnN0IG1lc3NhZ2UgPSAoYXJnMCA9PT0gdW5kZWZpbmVkKQogICAgICAgID8gbW9kLk1lc3NhZ2Uoc3RyaW5nS2V5KQogICAgICAgIDogKGFyZzEgPT09IHVuZGVmaW5lZCkKICAgICAgICAgICAgPyBtb2QuTWVzc2FnZShzdHJpbmdLZXksIGFyZzApCiAgICAgICAgICAgIDogKGFyZzIgPT09IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgID8gbW9kLk1lc3NhZ2Uoc3RyaW5nS2V5LCBhcmcwLCBhcmcxKQogICAgICAgICAgICAgICAgOiBtb2QuTWVzc2FnZShzdHJpbmdLZXksIGFyZzAsIGFyZzEsIGFyZzIpOwogICAgc2VuZE5vdGlmaWNhdGlvbk1lc3NhZ2UobWVzc2FnZSwgdHJ1ZSk7Cn0KCi8vIFRPRE8oMS4wKTogVW51c2VkOyByZW1vdmUgYmVmb3JlIGZpbmFsIDEuMCByZWxlYXNlLgpmdW5jdGlvbiBicm9hZGNhc3RHYW1lcGxheUhpZ2hsaWdodGVkU3RyaW5nS2V5KAogICAgc3RyaW5nS2V5OiBudW1iZXIsCiAgICBhcmcwPzogc3RyaW5nIHwgbnVtYmVyIHwgbW9kLlBsYXllciwKICAgIGFyZzE/OiBzdHJpbmcgfCBudW1iZXIgfCBtb2QuUGxheWVyLAogICAgYXJnMj86IHN0cmluZyB8IG51bWJlciB8IG1vZC5QbGF5ZXIKKTogdm9pZCB7CiAgICBjb25zdCBtZXNzYWdlID0gKGFyZzAgPT09IHVuZGVmaW5lZCkKICAgICAgICA/IG1vZC5NZXNzYWdlKHN0cmluZ0tleSkKICAgICAgICA6IChhcmcxID09PSB1bmRlZmluZWQpCiAgICAgICAgICAgID8gbW9kLk1lc3NhZ2Uoc3RyaW5nS2V5LCBhcmcwKQogICAgICAgICAgICA6IChhcmcyID09PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICA/IG1vZC5NZXNzYWdlKHN0cmluZ0tleSwgYXJnMCwgYXJnMSkKICAgICAgICAgICAgICAgIDogbW9kLk1lc3NhZ2Uoc3RyaW5nS2V5LCBhcmcwLCBhcmcxLCBhcmcyKTsKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtZXNzYWdlLCB0cnVlLCB1bmRlZmluZWQsIHN0cmluZ0tleSk7Cn0KCmZ1bmN0aW9uIGJyb2FkY2FzdEhpZ2hsaWdodGVkU3RyaW5nS2V5KAogICAgc3RyaW5nS2V5OiBudW1iZXIsCiAgICBhcmcwPzogc3RyaW5nIHwgbnVtYmVyIHwgbW9kLlBsYXllciwKICAgIGFyZzE/OiBzdHJpbmcgfCBudW1iZXIgfCBtb2QuUGxheWVyLAogICAgYXJnMj86IHN0cmluZyB8IG51bWJlciB8IG1vZC5QbGF5ZXIKKTogdm9pZCB7CiAgICBjb25zdCBtZXNzYWdlID0gKGFyZzAgPT09IHVuZGVmaW5lZCkKICAgICAgICA/IG1vZC5NZXNzYWdlKHN0cmluZ0tleSkKICAgICAgICA6IChhcmcxID09PSB1bmRlZmluZWQpCiAgICAgICAgICAgID8gbW9kLk1lc3NhZ2Uoc3RyaW5nS2V5LCBhcmcwKQogICAgICAgICAgICA6IChhcmcyID09PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICA/IG1vZC5NZXNzYWdlKHN0cmluZ0tleSwgYXJnMCwgYXJnMSkKICAgICAgICAgICAgICAgIDogbW9kLk1lc3NhZ2Uoc3RyaW5nS2V5LCBhcmcwLCBhcmcxLCBhcmcyKTsKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtZXNzYWdlLCBmYWxzZSwgdW5kZWZpbmVkLCBzdHJpbmdLZXkpOwp9CgovLyBDb21tZW50ZWQgb3V0IGZ1bmN0aW9uOgovL2Z1bmN0aW9uIGJyb2FkY2FzdE5vdGlmaWNhdGlvbk1lc3NhZ2UobWVzc2FnZTogbW9kLk1lc3NhZ2UpOiB2b2lkIHsKLy8gICAgbW9kLkRpc3BsYXlOb3RpZmljYXRpb25NZXNzYWdlKG1lc3NhZ2UpOwovL30KCnR5cGUgQ2xlYW51cFNwYXduV2FpdFJlc3VsdCA9ICJjb21wbGV0ZWQiIHwgInRpbWVvdXQiIHwgImFib3J0ZWQiOwoKZnVuY3Rpb24gc2V0Q2xlYW51cFN0YXRlKGFjdGl2ZTogYm9vbGVhbiwgYWxsb3dEZXBsb3k6IGJvb2xlYW4pOiB2b2lkIHsKICAgIFN0YXRlLnJvdW5kLmZsb3cuY2xlYW51cEFjdGl2ZSA9IGFjdGl2ZTsKICAgIFN0YXRlLnJvdW5kLmZsb3cuY2xlYW51cEFsbG93RGVwbG95ID0gYWxsb3dEZXBsb3k7CiAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7Cn0KCi8vIFN0b3BzIGFsbCBzcGF3bmVyIGFjdGl2aXR5IGFuZCBpbnZhbGlkYXRlcyBpbi1mbGlnaHQgc2VxdWVuY2VzIGJlZm9yZSBjbGVhbnVwLgpmdW5jdGlvbiBxdWllc2NlU3Bhd25lclN5c3RlbUZvckNsZWFudXAoKTogdm9pZCB7CiAgICBTdGF0ZS52ZWhpY2xlcy5zcGF3blNlcXVlbmNlVG9rZW4gPSAoU3RhdGUudmVoaWNsZXMuc3Bhd25TZXF1ZW5jZVRva2VuICsgMSkgJSAxMDAwMDAwMDAwOwogICAgU3RhdGUudmVoaWNsZXMuc3Bhd25TZXF1ZW5jZUluUHJvZ3Jlc3MgPSBmYWxzZTsKICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduU2xvdEluZGV4ID0gdW5kZWZpbmVkOwogICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25Ub2tlbiA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduUmVxdWVzdGVkQXRTZWNvbmRzID0gdW5kZWZpbmVkOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgU3RhdGUudmVoaWNsZXMuc2xvdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbaV07CiAgICAgICAgaWYgKHNsb3QuZW5hYmxlZCkgewogICAgICAgICAgICBzZXRTcGF3bmVyU2xvdEVuYWJsZWQoaSwgZmFsc2UpOwogICAgICAgIH0KICAgICAgICBzbG90LmV4cGVjdGluZ1NwYXduID0gZmFsc2U7CiAgICAgICAgc2xvdC5zcGF3blJldHJ5U2NoZWR1bGVkID0gZmFsc2U7CiAgICAgICAgc2xvdC5yZXNwYXduUnVubmluZyA9IGZhbHNlOwogICAgfQp9CgpmdW5jdGlvbiByZXNldFNwYXduZXJTbG90U3RhdGVGb3JDbGVhbnVwKCk6IHZvaWQgewogICAgU3RhdGUudmVoaWNsZXMudmVoaWNsZVRvU2xvdCA9IHt9OwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBTdGF0ZS52ZWhpY2xlcy5zbG90cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1tpXTsKICAgICAgICBzbG90LnZlaGljbGVJZCA9IC0xOwogICAgICAgIHNsb3QuZXhwZWN0aW5nU3Bhd24gPSBmYWxzZTsKICAgICAgICBzbG90LnNwYXduUmV0cnlTY2hlZHVsZWQgPSBmYWxzZTsKICAgICAgICBzbG90LnJlc3Bhd25SdW5uaW5nID0gZmFsc2U7CiAgICAgICAgc2xvdC5zcGF3blJlcXVlc3RUb2tlbiA9IDA7CiAgICAgICAgc2xvdC5zcGF3blJlcXVlc3RBdFNlY29uZHMgPSAtMTsKICAgIH0KfQoKZnVuY3Rpb24gY2xlYXJWZWhpY2xlQ2FjaGVzRm9yQ2xlYW51cCgpOiB2b2lkIHsKICAgIG1vZC5TZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0xLCBtb2QuRW1wdHlBcnJheSgpKTsKICAgIG1vZC5TZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0yLCBtb2QuRW1wdHlBcnJheSgpKTsKICAgIHZlaElkcy5sZW5ndGggPSAwOwogICAgdmVoT3duZXJzLmxlbmd0aCA9IDA7CiAgICBjbGVhclNwYXduQmFzZVRlYW1DYWNoZSgpOwp9CgpmdW5jdGlvbiBhcmVDbGVhbnVwU3Bhd25zUmVhZHkoKTogYm9vbGVhbiB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW2ldOwogICAgICAgIGlmICghc2xvdC5lbmFibGVkKSBjb250aW51ZTsKICAgICAgICBpZiAoc2xvdC52ZWhpY2xlSWQgPT09IC0xKSByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKfQoKLy8gQ2xlYW51cCBnYXRpbmc6ICJxdWllc2NlbnQiIG1lYW5zIG5vIHBlbmRpbmcgYmluZHMvcmVzcGF3bnMgb3IgYWN0aXZlIHNwYXduIHNlcXVlbmNlcy4KZnVuY3Rpb24gaXNTcGF3bmVyU3lzdGVtUXVpZXNjZW50KCk6IGJvb2xlYW4gewogICAgaWYgKFN0YXRlLnZlaGljbGVzLnNwYXduU2VxdWVuY2VJblByb2dyZXNzKSByZXR1cm4gZmFsc2U7CiAgICBpZiAoU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25TbG90SW5kZXggIT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlOwogICAgaWYgKFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduVG9rZW4gIT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlOwogICAgaWYgKFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduUmVxdWVzdGVkQXRTZWNvbmRzICE9PSB1bmRlZmluZWQpIHJldHVybiBmYWxzZTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW2ldOwogICAgICAgIGlmIChzbG90LmV4cGVjdGluZ1NwYXduKSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKHNsb3QucmVzcGF3blJ1bm5pbmcpIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoc2xvdC5zcGF3blJldHJ5U2NoZWR1bGVkKSByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcmV0dXJuIHRydWU7Cn0KCi8vIFdhaXRzIGZvciBzbG90IElEcyArIHF1aWVzY2VudCBzcGF3bmVyIHN0YXRlLCB0aGVuIHN0YWJpbGl6ZXMgYnJpZWZseSB0byBhdm9pZCBsYXRlIGJpbmRzLgphc3luYyBmdW5jdGlvbiB3YWl0Rm9yQ2xlYW51cFNwYXduc09yVGltZW91dChleHBlY3RlZFRva2VuOiBudW1iZXIpOiBQcm9taXNlPENsZWFudXBTcGF3bldhaXRSZXN1bHQ+IHsKICAgIGNvbnN0IHN0YXJ0RWxhcHNlZCA9IE1hdGguZmxvb3IobW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKSk7CiAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgIGlmIChleHBlY3RlZFRva2VuICE9PSBTdGF0ZS5yb3VuZC5mbG93LnJvdW5kRW5kUmVkZXBsb3lUb2tlbikgcmV0dXJuICJhYm9ydGVkIjsKICAgICAgICBpZiAoIVN0YXRlLnJvdW5kLmZsb3cuY2xlYW51cEFjdGl2ZSkgcmV0dXJuICJhYm9ydGVkIjsKICAgICAgICBpZiAoYXJlQ2xlYW51cFNwYXduc1JlYWR5KCkgJiYgaXNTcGF3bmVyU3lzdGVtUXVpZXNjZW50KCkpIHsKICAgICAgICAgICAgYXdhaXQgbW9kLldhaXQoMC41KTsKICAgICAgICAgICAgaWYgKGFyZUNsZWFudXBTcGF3bnNSZWFkeSgpICYmIGlzU3Bhd25lclN5c3RlbVF1aWVzY2VudCgpKSByZXR1cm4gImNvbXBsZXRlZCI7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBlbGFwc2VkID0gTWF0aC5mbG9vcihtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpKSAtIHN0YXJ0RWxhcHNlZDsKICAgICAgICBpZiAoZWxhcHNlZCA+PSBST1VORF9FTkRfQ0xFQU5VUF9TUEFXTl9USU1FT1VUX1NFQ09ORFMpIHJldHVybiAidGltZW91dCI7CgogICAgICAgIGF3YWl0IG1vZC5XYWl0KDAuNSk7CiAgICB9Cn0KCi8vIFJvdW5kLWVuZCBjbGVhbnVwIGZsb3c6IGxvY2sgLT4gcXVpZXNjZSAtPiBkZXN0cm95IC0+IHVuZGVwbG95IC0+IHJlc2V0IC0+IHNwYXduIC0+IHdhaXQvdGltZW91dCAtPiBkZXBsb3kgLT4gaG9sZC4KLy8gU3RhdGUucm91bmQuZmxvdy5yb3VuZEVuZFJlZGVwbG95VG9rZW4gY2FuY2VscyBvbGRlciB0aW1lcnMgaWYgYSBuZXcgcm91bmQgZW5kIGlzIHRyaWdnZXJlZCBiZWZvcmUgdGhlIGRlbGF5IGNvbXBsZXRlcy4KYXN5bmMgZnVuY3Rpb24gc2NoZWR1bGVSb3VuZEVuZENsZWFudXAoZXhwZWN0ZWRUb2tlbjogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7CiAgICBzZXRDbGVhbnVwU3RhdGUodHJ1ZSwgZmFsc2UpOwogICAgbW9kLkVuYWJsZUFsbFBsYXllckRlcGxveShmYWxzZSk7CiAgICAvLyBJbnZhcmlhbnQ6IGNsZWFudXBBY3RpdmUgYmxvY2tzIGRlcGxveS9VSSB1bnRpbCBjbGVhbnVwQWxsb3dEZXBsb3kgZmxpcHMgYWZ0ZXIgc3Bhd25zIGFyZSByZWFkeS4KCiAgICBhd2FpdCBtb2QuV2FpdChST1VORF9FTkRfUkVERVBMT1lfREVMQVlfU0VDT05EUyk7CgogICAgaWYgKGV4cGVjdGVkVG9rZW4gIT09IFN0YXRlLnJvdW5kLmZsb3cucm91bmRFbmRSZWRlcGxveVRva2VuKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKGlzUm91bmRMaXZlKCkpIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCkgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBxdWllc2NlU3Bhd25lclN5c3RlbUZvckNsZWFudXAoKTsKCiAgICBjb25zdCB2ZWhpY2xlcyA9IG1vZC5BbGxWZWhpY2xlcygpOwogICAgY29uc3QgdkNvdW50ID0gbW9kLkNvdW50T2YodmVoaWNsZXMpOwogICAgZm9yIChsZXQgdiA9IDA7IHYgPCB2Q291bnQ7IHYrKykgewogICAgICAgIGNvbnN0IHZlaGljbGUgPSBtb2QuVmFsdWVJbkFycmF5KHZlaGljbGVzLCB2KSBhcyBtb2QuVmVoaWNsZTsKICAgICAgICBpZiAoIXZlaGljbGUpIGNvbnRpbnVlOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG1vZC5EZWFsRGFtYWdlKHZlaGljbGUsIDk5OTkpOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAvLyBEaXNjb25uZWN0LXNhZmU6IGF2b2lkIGhhcmQgY3Jhc2ggaWYgdmVoaWNsZSBpbnZhbGlkYXRlcyBtaWQtbG9vcC4KICAgICAgICB9CiAgICB9CgogICAgYXdhaXQgbW9kLldhaXQoMyk7CgogICAgLy8gUGVyLXBsYXllciB1bmRlcGxveSB0byBhdm9pZCBnbG9iYWwgcmVkZXBsb3kgc2lkZSBlZmZlY3RzLgogICAgY29uc3QgdW5kZXBsb3llZFBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgdW5kZXBsb3lDb3VudCA9IG1vZC5Db3VudE9mKHVuZGVwbG95ZWRQbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdW5kZXBsb3lDb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcGxheWVyID0gbW9kLlZhbHVlSW5BcnJheSh1bmRlcGxveWVkUGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIGNvbnRpbnVlOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG1vZC5VbmRlcGxveVBsYXllcihwbGF5ZXIpOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgU3RhdGUucGxheWVycy5kZXBsb3llZEJ5UGlkW3BpZF0gPSBmYWxzZTsKICAgICAgICB0cnkgewogICAgICAgICAgICBzZXRVSUlucHV0TW9kZUZvclBsYXllcihwbGF5ZXIsIGZhbHNlKTsKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgLy8gSWdub3JlIFVJIGZhaWx1cmVzIGR1cmluZyBjbGVhbnVwLgogICAgICAgIH0KICAgIH0KCiAgICByZXNldFNwYXduZXJTbG90U3RhdGVGb3JDbGVhbnVwKCk7CiAgICBjbGVhclZlaGljbGVDYWNoZXNGb3JDbGVhbnVwKCk7CgogICAgYXBwbHlTcGF3bmVyRW5hYmxlbWVudEZvck1hdGNodXAoU3RhdGUucm91bmQubWF0Y2h1cFByZXNldEluZGV4LCB0cnVlKTsKCiAgICBjb25zdCB3YWl0UmVzdWx0ID0gYXdhaXQgd2FpdEZvckNsZWFudXBTcGF3bnNPclRpbWVvdXQoZXhwZWN0ZWRUb2tlbik7CiAgICBpZiAod2FpdFJlc3VsdCA9PT0gInRpbWVvdXQiKSB7CiAgICAgICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgICAgICBtb2QuTWVzc2FnZShTVFJfUk9VTkRfQ0xFQU5VUF9TUEFXTl9USU1FT1VULCBST1VORF9FTkRfQ0xFQU5VUF9TUEFXTl9USU1FT1VUX1NFQ09ORFMpLAogICAgICAgICAgICB0cnVlLAogICAgICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgICAgIFNUUl9ST1VORF9DTEVBTlVQX1NQQVdOX1RJTUVPVVQKICAgICAgICApOwogICAgfSBlbHNlIGlmICh3YWl0UmVzdWx0ID09PSAiYWJvcnRlZCIpIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgc2V0Q2xlYW51cFN0YXRlKHRydWUsIHRydWUpOwogICAgbW9kLkVuYWJsZUFsbFBsYXllckRlcGxveSh0cnVlKTsKICAgIC8vIFBlci1wbGF5ZXIgZGVwbG95IHBhc3MsIHRoZW4gcmVjaGVjayBmb3Igc3RyYWdnbGVycy4KICAgIGF3YWl0IG1vZC5XYWl0KDAuMSk7CgogICAgbGV0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgbGV0IHBDb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwQ291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHBsYXllciA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIGNvbnRpbnVlOwogICAgICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChwbGF5ZXIpKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBtb2QuRGVwbG95UGxheWVyKHBsYXllcik7CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgYXdhaXQgbW9kLldhaXQoMC41KTsKCiAgICBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIHBDb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwQ291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHBsYXllciA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHBsYXllcik7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkIHx8IGlzUGlkRGlzY29ubmVjdGVkKHBpZCkpIGNvbnRpbnVlOwogICAgICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChwbGF5ZXIpKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBtb2QuRGVwbG95UGxheWVyKHBsYXllcik7CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgYXdhaXQgbW9kLldhaXQoUk9VTkRfRU5EX1BPU1RfREVQTE9ZX0hPTERfU0VDT05EUyk7CgogICAgaWYgKGV4cGVjdGVkVG9rZW4gIT09IFN0YXRlLnJvdW5kLmZsb3cucm91bmRFbmRSZWRlcGxveVRva2VuKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIHNldFJvdW5kRW5kRGlhbG9nVmlzaWJsZUZvckFsbFBsYXllcnMoZmFsc2UpOwogICAgc2V0Q2xlYW51cFN0YXRlKGZhbHNlLCBmYWxzZSk7Cn0KCi8vIE1hbnVhbCByZXNldCBmbG93IChub24tbGl2ZSBvbmx5KTogcnVuIHRoZSBzYW1lIGNsZWFudXAgc2VxdWVuY2UgdXNlZCBhZnRlciByb3VuZCBlbmQsCi8vIGJ1dCB3aXRob3V0IGFmZmVjdGluZyBzY29yZXMgb3IgYWR2YW5jaW5nIHRoZSByb3VuZCBjb3VudGVyLgpmdW5jdGlvbiB0cmlnZ2VyRnJlc2hSb3VuZFNldHVwKHRyaWdnZXJQbGF5ZXI/OiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCkgcmV0dXJuOwogICAgaWYgKGlzUm91bmRMaXZlKCkpIHJldHVybjsKICAgIGlmIChTdGF0ZS5yb3VuZC5mbG93LmNsZWFudXBBY3RpdmUpIHJldHVybjsKCiAgICAvLyBFbnN1cmUgd2UgYXJlIGluIGEgcHJlLXJvdW5kIHN0YXRlIGFuZCBjbGVhciBhbnkgcm91bmQtZW5kIFVJLgogICAgU3RhdGUucm91bmQucGhhc2UgPSBSb3VuZFBoYXNlLk5vdFJlYWR5OwogICAgU3RhdGUucm91bmQuZmxvdy5yb3VuZEVuZFVpTG9ja2Rvd24gPSBmYWxzZTsKICAgIHNldFJvdW5kRW5kRGlhbG9nVmlzaWJsZUZvckFsbFBsYXllcnMoZmFsc2UpOwoKICAgIC8vIFJlc2V0IHJlYWR5IHN0YXRlIHNvIHRoZSBuZXh0IHNldHVwIHJlcXVpcmVzIGZyZXNoIHBsYXllciBjb25maXJtYXRpb24uCiAgICByZXNldFJlYWR5U3RhdGVGb3JBbGxQbGF5ZXJzKCk7CgogICAgLy8gQ2xlYXIgb3ZlcnRpbWUvdGllLWJyZWFrZXIgc3RhdGU7IHRoZSBuZXh0IHJvdW5kIHdpbGwgcmUtZXZhbHVhdGUgZWxpZ2liaWxpdHkuCiAgICByZXNldE92ZXJ0aW1lRmxhZ1N0YXRlKCk7CiAgICBTdGF0ZS5mbGFnLnRpZUJyZWFrZXJFbmFibGVkVGhpc1JvdW5kID0gZmFsc2U7CiAgICBzZXRPdmVydGltZUFsbEZsYWdWaXNpYmlsaXR5KGZhbHNlKTsKCiAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7CiAgICBzZXRSb3VuZFN0YXRlVGV4dEZvckFsbFBsYXllcnMoKTsKCiAgICBTdGF0ZS5yb3VuZC5mbG93LnJvdW5kRW5kUmVkZXBsb3lUb2tlbiA9IChTdGF0ZS5yb3VuZC5mbG93LnJvdW5kRW5kUmVkZXBsb3lUb2tlbiArIDEpICUgMTAwMDAwMDAwMDsKICAgIGNvbnN0IHJlZGVwbG95VG9rZW4gPSBTdGF0ZS5yb3VuZC5mbG93LnJvdW5kRW5kUmVkZXBsb3lUb2tlbjsKCiAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMucm91bmRPdmVyUmVkZXBsb3lpbmcsIFJPVU5EX0VORF9SRURFUExPWV9ERUxBWV9TRUNPTkRTKSwKICAgICAgICB0cnVlLAogICAgICAgIHVuZGVmaW5lZCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5yb3VuZE92ZXJSZWRlcGxveWluZwogICAgKTsKCiAgICB2b2lkIHNjaGVkdWxlUm91bmRFbmRDbGVhbnVwKHJlZGVwbG95VG9rZW4pOwp9CgovLyBGaW5hbC1yb3VuZCBmbG93OiBrZWVwIHRoZSByb3VuZC1lbmQgZGlhbG9nIHZpc2libGUgZm9yIHRoZSBub3JtYWwgMTBzIHdpbmRvdywgdGhlbiBoaWRlIGl0IGFuZCBzaG93IHRoZSBWaWN0b3J5IGRpYWxvZyBmb3IgTUFUQ0hfRU5EX0RFTEFZX1NFQ09ORFMuCi8vIFRoaXMgdXNlcyBTdGF0ZS5tYXRjaC5mbG93Lm1hdGNoRW5kRGVsYXlUb2tlbiBhcyBhIGNhbmNlbGxhdGlvbiB0b2tlbiBzbyBhZG1pbiBhY3Rpb25zIG9yIHVuZXhwZWN0ZWQgc3RhdGUgY2hhbmdlcyBjYW5ub3QgdHJpZ2dlciBzdGFsZSBkZWxheWVkIFVJLgphc3luYyBmdW5jdGlvbiBzY2hlZHVsZUZpbmFsUm91bmRWaWN0b3J5KGV4cGVjdGVkVG9rZW46IG51bWJlciwgd2lubmluZ1RlYW1OdW06IFRlYW1JRCB8IDApOiBQcm9taXNlPHZvaWQ+IHsKICAgIGF3YWl0IG1vZC5XYWl0KFJPVU5EX0VORF9SRURFUExPWV9ERUxBWV9TRUNPTkRTKTsKCiAgICBpZiAoZXhwZWN0ZWRUb2tlbiAhPT0gU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW4pIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoIVN0YXRlLm1hdGNoLmlzRW5kZWQpIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgLy8gSGlkZSB0aGUgcm91bmQtZW5kIGRpYWxvZyB3aGVuIHRoZSByb3VuZC1lbmQgd2luZG93IGV4cGlyZXMsIGV2ZW4gb24gdGhlIGZpbmFsIHJvdW5kLgogICAgc2V0Um91bmRFbmREaWFsb2dWaXNpYmxlRm9yQWxsUGxheWVycyhmYWxzZSk7CgogICAgLy8gRmluYWwtcm91bmQgZXhjZXB0aW9uOiByZS1lbmFibGUgZGVwbG95IHdpdGhvdXQgZm9yY2luZyByZXNwYXduIHNvIFZpY3RvcnkgZGlhbG9nIGlzIHZpc2libGUuCiAgICBpZiAoaXNMaXZlUmVzcGF3bkRpc2FibGVkKCkpIHsKICAgICAgICBtb2QuRW5hYmxlQWxsUGxheWVyRGVwbG95KHRydWUpOwogICAgfQoKICAgIC8vIFN0YXJ0IHRoZSBtYXRjaC1lbmQgdmljdG9yeSBmbG93IG9ubHkgYWZ0ZXIgdGhlIHJvdW5kLWVuZCB3aW5kb3cgY29tcGxldGVzLgogICAgU3RhdGUubWF0Y2gudmljdG9yeVN0YXJ0RWxhcHNlZFNlY29uZHNTbmFwc2hvdCA9IE1hdGguZmxvb3IobW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKSk7CiAgICBTdGF0ZS5tYXRjaC5lbmRFbGFwc2VkU2Vjb25kc1NuYXBzaG90ID0gU3RhdGUubWF0Y2gudmljdG9yeVN0YXJ0RWxhcHNlZFNlY29uZHNTbmFwc2hvdDsKICAgIFN0YXRlLm1hdGNoLnZpY3RvcnlEaWFsb2dBY3RpdmUgPSB0cnVlOwogICAgU3RhdGUucm91bmQuY2xvY2suaXNQYXVzZWQgPSBmYWxzZTsKICAgIFN0YXRlLnJvdW5kLmNsb2NrLnBhdXNlZFJlbWFpbmluZ1NlY29uZHMgPSB1bmRlZmluZWQ7CiAgICBSZXNldFJvdW5kQ2xvY2soTUFUQ0hfRU5EX0RFTEFZX1NFQ09ORFMpOwogICAgdXBkYXRlVmljdG9yeURpYWxvZ0ZvckFsbFBsYXllcnMoTUFUQ0hfRU5EX0RFTEFZX1NFQ09ORFMpOwoKICAgIHZvaWQgc2NoZWR1bGVNYXRjaEVuZChleHBlY3RlZFRva2VuLCB3aW5uaW5nVGVhbU51bSk7Cn0KCmFzeW5jIGZ1bmN0aW9uIHNjaGVkdWxlTWF0Y2hFbmQoZXhwZWN0ZWRUb2tlbjogbnVtYmVyLCB3aW5uaW5nVGVhbU51bT86IFRlYW1JRCB8IDApOiBQcm9taXNlPHZvaWQ+IHsKICAgIGF3YWl0IG1vZC5XYWl0KE1BVENIX0VORF9ERUxBWV9TRUNPTkRTKTsKCiAgICBpZiAoZXhwZWN0ZWRUb2tlbiAhPT0gU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW4pIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoIVN0YXRlLm1hdGNoLmlzRW5kZWQpIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHdpbm5pbmdUZWFtTnVtICE9PSB1bmRlZmluZWQgJiYgd2lubmluZ1RlYW1OdW0gIT09IDApIHsKICAgICAgICBlbmRHYW1lTW9kZUZvclRlYW1OdW0od2lubmluZ1RlYW1OdW0pOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBtb2QuRW5kR2FtZU1vZGUobW9kLkdldFRlYW0oMCkpOwp9CgpmdW5jdGlvbiBiaW5kUm91bmRDbG9ja0V4cGlyeVRvUm91bmRFbmQoKTogdm9pZCB7CiAgICBpZiAoU3RhdGUucm91bmQuZmxvdy5jbG9ja0V4cGlyeUJvdW5kKSByZXR1cm47CiAgICBTdGF0ZS5yb3VuZC5mbG93LmNsb2NrRXhwaXJ5Qm91bmQgPSB0cnVlOwoKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmV4cGlyeUhhbmRsZXJzLnB1c2goKCkgPT4gewogICAgICAgIGlmIChpc1JvdW5kTGl2ZSgpKSB7CiAgICAgICAgICAgIGNvbnN0IG92ZXJ0aW1lV2lubmVyID0gcmVzb2x2ZU92ZXJ0aW1lV2lubmVyQXRDbG9ja0V4cGlyeSgpOwogICAgICAgICAgICAvLyBVbmRlZmluZWQgPSBuZXV0cmFsIHByb2dyZXNzOyBlbmRSb3VuZCB3aWxsIGZhbGwgYmFjayB0byByb3VuZCBraWxscy4KICAgICAgICAgICAgZW5kUm91bmQodW5kZWZpbmVkLCB1bmRlZmluZWQsIG92ZXJ0aW1lV2lubmVyKTsKICAgICAgICB9CiAgICB9KTsKfQoKLy8gU3RhcnRzIGEgbmV3IHJvdW5kIHVzaW5nIHRoZSBjdXJyZW50IGF1dGhvcml0YXRpdmUgY29uZmlndXJhdGlvbi4KLy8gSW52YXJpYW50czoKLy8gLSBSZXNldHMgcGVyLXJvdW5kIGNvdW50ZXJzIGJ1dCBwcmVzZXJ2ZXMgbWF0Y2gtbGV2ZWwgdG90YWxzCi8vIC0gSW5pdGlhbGl6ZXMgdGhlIHJvdW5kIGNsb2NrIGZyb20gUk9VTkRfU1RBUlRfU0VDT05EUwovLyAtIFNldHMgcm91bmQgcGhhc2Ugc3RhdGUgdXNlZCBieSBIVUQgYW5kIGVuZCBjb25kaXRpb25zCgpmdW5jdGlvbiBzdGFydFJvdW5kKF90cmlnZ2VyUGxheWVyPzogbW9kLlBsYXllcik6IHZvaWQgewogICAgaWYgKFN0YXRlLm1hdGNoLmlzRW5kZWQpIHsKICAgIC8vIFN0ZXBzOgogICAgLy8gMSkgUmVzZXQgcm91bmQtc2NvcGVkIGNvdW50ZXJzIGFuZCBmbGFncwogICAgLy8gMikgSW5pdGlhbGl6ZSB0aGUgcm91bmQgY2xvY2sgZnJvbSBST1VORF9TVEFSVF9TRUNPTkRTCiAgICAvLyAzKSBQdXNoIEhVRC9VSSB1cGRhdGVzIGZvciB0aGUgbmV3IHJvdW5kIHN0YXRlCgogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAvLyBEZWZlbnNpdmUgY2xlYW51cDogaGlkZSBjb3VudGRvd24gVUkgaWYgd2UgYXJlIG5vdCBjdXJyZW50bHkgcnVubmluZyBhIGNvdW50ZG93bi4KICAgIC8vIFRoaXMgcHJlc2VydmVzIHRoZSBHTyBkaXNwbGF5IHdoZW4gc3RhcnRSb3VuZCBpcyB0cmlnZ2VyZWQgYnkgdGhlIGNvdW50ZG93biBpdHNlbGYuCiAgICBpZiAoIVN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc0FjdGl2ZSkgewogICAgICAgIGhpZGVQcmVnYW1lQ291bnRkb3duRm9yQWxsUGxheWVycygpOwogICAgfQoKICAgIFN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc1JlcXVlc3RlZCA9IGZhbHNlOwogICAgYmluZFJvdW5kQ2xvY2tFeHBpcnlUb1JvdW5kRW5kKCk7CiAgICBTdGF0ZS5yb3VuZC5waGFzZSA9IFJvdW5kUGhhc2UuTGl2ZTsgLy8gRW5hYmxlcyBzY29yaW5nICsgTElWRSBIVUQgc3RhdGUuCiAgICAvLyBPcHRpb25hbCByZXNwYXduIGxvY2s6IGRpc2FibGUgZGVwbG95IGR1cmluZyBMSVZFIHJvdW5kcyB3aGVuIHRlc3QgdG9nZ2xlIGlzIG9uLgogICAgaWYgKGlzTGl2ZVJlc3Bhd25EaXNhYmxlZCgpKSB7CiAgICAgICAgbW9kLkVuYWJsZUFsbFBsYXllckRlcGxveShmYWxzZSk7CiAgICB9CiAgICBzZXRTcGF3bkRpc2FibGVkTGl2ZVRleHRWaXNpYmxlRm9yQWxsUGxheWVycyhmYWxzZSk7CiAgICAvLyBFeHRlbmRzIHRoZSBidWlsdC1pbiBnYW1lbW9kZSB0aW1lIGxpbWl0IHNvIHRoZSBtYXRjaCBhbHdheXMgaGFzIGEgZnVsbCBob3VyIHJlbWFpbmluZyBhZnRlciBlYWNoIHJvdW5kIHN0YXJ0LgogICAgY29uc3QgZWxhcHNlZFNlY29uZHMgPSBNYXRoLmZsb29yKG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCkpOwogICAgbW9kLlNldEdhbWVNb2RlVGltZUxpbWl0KGVsYXBzZWRTZWNvbmRzICsgQkFDS0dST1VORF9USU1FX0xJTUlUX1JFU0VUX1NFQ09ORFMpOwogICAgc2V0Um91bmRTdGF0ZVRleHRGb3JBbGxQbGF5ZXJzKCk7CiAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7CiAgICBzZXRSb3VuZEVuZERpYWxvZ1Zpc2libGVGb3JBbGxQbGF5ZXJzKGZhbHNlKTsKICAgIC8vIFJvdW5kIHN0YXJ0OiByZWxlYXNlIHJvdW5kLWVuZCBVSSBsb2NrZG93biBzbyBvdmVydGltZSBIVUQgY2FuIHByZXdhcm0uCiAgICBTdGF0ZS5yb3VuZC5mbG93LnJvdW5kRW5kVWlMb2NrZG93biA9IGZhbHNlOwogICAgU3RhdGUucm91bmQubGFzdFdpbm5lclRlYW0gPSAwOwogICAgU3RhdGUucm91bmQubGFzdEVuZERldGFpbFJlYXNvbiA9IFJvdW5kRW5kRGV0YWlsUmVhc29uLk5vbmU7CgogICAgU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscyA9IDA7CiAgICBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzID0gMDsKCiAgICBzeW5jUm91bmRLaWxsc0h1ZCh0cnVlKTsKICAgIHJlZnJlc2hPdmVydGltZVpvbmVzRnJvbU1hcENvbmZpZygpOwogICAgcmVzZXRPdmVydGltZUZsYWdTdGF0ZSgpOwogICAgLy8gUm91bmQgc3RhcnQ6IGRlY2lkZSBpZiB0aWUtYnJlYWtlciBpcyBlbmFibGVkIGZvciB0aGlzIHJvdW5kIGJlZm9yZSBhbnkgZmxhZyBzZXR1cC4KICAgIHN5bmNUaWVCcmVha2VyRW5hYmxlZEZvckN1cnJlbnRSb3VuZCgpOwogICAgY29uc3QgaGVsaXNTaW5nbGVab25lID0gaXNIZWxpc092ZXJ0aW1lU2luZ2xlWm9uZU1vZGUoKTsKICAgIGlmIChpc1RpZUJyZWFrZXJFbmFibGVkRm9yUm91bmQoKSkgewogICAgICAgIC8vIFJvdW5kIHN0YXJ0OiBwcmVzZWxlY3QgdGhlIG92ZXJ0aW1lIHpvbmUgc28gd2UgY2FuIHRyYWNrIG9jY3VwYW5jeSBiZWZvcmUgYWN0aXZhdGlvbi4KICAgICAgICBTdGF0ZS5mbGFnLnRyYWNraW5nRW5hYmxlZCA9IHNlbGVjdE92ZXJ0aW1lWm9uZUZvclJvdW5kKCk7CiAgICAgICAgcHJld2FybU92ZXJ0aW1lSHVkRm9yQWxsUGxheWVycygpOwogICAgICAgIGlmIChoZWxpc1NpbmdsZVpvbmUpIHsKICAgICAgICAgICAgZW50ZXJPdmVydGltZVZpc2libGVTdGFnZVNpbGVudCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFJvdW5kIHN0YXJ0OiBoaWRlIGFsbCBmbGFnIG1hcmtlcnMgdW50aWwgdGhlIGhhbGYtdGltZSByZXZlYWwuCiAgICAgICAgICAgIHNldE92ZXJ0aW1lQWxsRmxhZ1Zpc2liaWxpdHkoZmFsc2UpOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgU3RhdGUuZmxhZy50cmFja2luZ0VuYWJsZWQgPSBmYWxzZTsKICAgICAgICBzZXRPdmVydGltZUFsbEZsYWdWaXNpYmlsaXR5KGZhbHNlKTsKICAgIH0KCiAgICBSZXNldFJvdW5kQ2xvY2soZ2V0Q29uZmlndXJlZFJvdW5kTGVuZ3RoU2Vjb25kcygpKTsKICAgIGJyb2FkY2FzdFN0cmluZ0tleShtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5yb3VuZFN0YXJ0ZWQpOwp9CgovLyBFbmRzIHRoZSBjdXJyZW50IHJvdW5kIGFuZCBzY2hlZHVsZXMgdHJhbnNpdGlvbiB0byB0aGUgbmV4dCBzdGF0ZS4KLy8gTm90ZXM6Ci8vIC0gUm91bmQgZW5kIHJlYXNvbiBpcyBkZXRlcm1pbmVkIGJlZm9yZSB0aGlzIGNhbGwKLy8gLSBSZWRlcGxveSBkZWxheSBhbmQgbmV4dC1yb3VuZCBzY2hlZHVsaW5nIGFyZSB0aW1lLWJhc2VkCi8vIC0gTWF0Y2ggZW5kIGlzIGhhbmRsZWQgc2VwYXJhdGVseSBhbmQgbXVzdCBub3QgYmUgdHJpZ2dlcmVkIGhlcmUKCmZ1bmN0aW9uIGVuZFJvdW5kKF90cmlnZ2VyUGxheWVyPzogbW9kLlBsYXllciwgZnJlZXplUmVtYWluaW5nU2Vjb25kcz86IG51bWJlciwgb3ZlcnJpZGVXaW5uZXJUZWFtTnVtPzogVGVhbUlEIHwgMCk6IHZvaWQgewogICAgaWYgKCFpc1JvdW5kTGl2ZSgpKSB7CiAgICAvLyBTdGVwczoKICAgIC8vIDEpIEZyZWV6ZSByb3VuZC1saXZlIHN5c3RlbXMgKG5vIGZ1cnRoZXIgc2NvcmluZykKICAgIC8vIDIpIFNjaGVkdWxlIHJlZGVwbG95IC8gdHJhbnNpdGlvbiB1c2luZyBST1VORF9FTkRfUkVERVBMT1lfREVMQVlfU0VDT05EUwogICAgLy8gMykgSWYgbWF0Y2ggc2hvdWxkIGVuZCwgaGFuZCBvZmYgdG8gbWF0Y2gtZW5kIHBhdGggKG5vdCByb3VuZCBwYXRoKQoKICAgICAgICByZXR1cm47CiAgICB9CiAgICBjb25zdCB0aW1lRXhwaXJlZCA9IFN0YXRlLnJvdW5kLmNsb2NrLmV4cGlyeUZpcmVkOwogICAgY29uc3QgdDEgPSBTdGF0ZS5zY29yZXMudDFSb3VuZEtpbGxzOwogICAgY29uc3QgdDIgPSBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzOwogICAgY29uc3Qgb3ZlcnRpbWVQcm9ncmVzcyA9IFN0YXRlLmZsYWcucHJvZ3Jlc3M7CiAgICBjb25zdCBvdmVydGltZUNvbmZpZ1ZhbGlkID0gU3RhdGUuZmxhZy5jb25maWdWYWxpZDsKICAgIGNvbnN0IHByb2dyZXNzTmV1dHJhbCA9ICFvdmVydGltZUNvbmZpZ1ZhbGlkIHx8IE1hdGguYWJzKG92ZXJ0aW1lUHJvZ3Jlc3MgLSAwLjUpIDw9IDAuMDAwMTsKICAgIGNvbnN0IHByb2dyZXNzRnVsbCA9IG92ZXJ0aW1lQ29uZmlnVmFsaWQgJiYgKG92ZXJ0aW1lUHJvZ3Jlc3MgPD0gMC4wMDAxIHx8IG92ZXJ0aW1lUHJvZ3Jlc3MgPj0gMC45OTk5KTsKICAgIGNvbnN0IGtpbGxUYXJnZXRSZWFjaGVkID0gaXNSb3VuZEtpbGxUYXJnZXRSZWFjaGVkKCk7CiAgICBsZXQgZW5kRGV0YWlsUmVhc29uID0gUm91bmRFbmREZXRhaWxSZWFzb24uTm9uZTsKCiAgICBpZiAoa2lsbFRhcmdldFJlYWNoZWQpIHsKICAgICAgICBlbmREZXRhaWxSZWFzb24gPSBSb3VuZEVuZERldGFpbFJlYXNvbi5FbGltaW5hdGlvbjsKICAgIH0gZWxzZSBpZiAoIXRpbWVFeHBpcmVkICYmIHByb2dyZXNzRnVsbCkgewogICAgICAgIGVuZERldGFpbFJlYXNvbiA9IFJvdW5kRW5kRGV0YWlsUmVhc29uLk9iamVjdGl2ZUNhcHR1cmVkOwogICAgfSBlbHNlIGlmICh0aW1lRXhwaXJlZCAmJiAhcHJvZ3Jlc3NOZXV0cmFsKSB7CiAgICAgICAgZW5kRGV0YWlsUmVhc29uID0gUm91bmRFbmREZXRhaWxSZWFzb24uVGltZU92ZXJPYmplY3RpdmVQcm9ncmVzczsKICAgIH0gZWxzZSBpZiAodGltZUV4cGlyZWQgJiYgdDEgPT09IHQyKSB7CiAgICAgICAgZW5kRGV0YWlsUmVhc29uID0gKHQxID09PSAwKQogICAgICAgICAgICA/IFJvdW5kRW5kRGV0YWlsUmVhc29uLlRpbWVPdmVyRHJhd05vQWN0aW9uCiAgICAgICAgICAgIDogUm91bmRFbmREZXRhaWxSZWFzb24uVGltZU92ZXJEcmF3RXZlbkVsaW1zOwogICAgfSBlbHNlIGlmICh0aW1lRXhwaXJlZCkgewogICAgICAgIGVuZERldGFpbFJlYXNvbiA9IFJvdW5kRW5kRGV0YWlsUmVhc29uLlRpbWVPdmVyS2lsbHM7CiAgICB9IGVsc2UgewogICAgICAgIGVuZERldGFpbFJlYXNvbiA9IFJvdW5kRW5kRGV0YWlsUmVhc29uLkVsaW1pbmF0aW9uOwogICAgfQogICAgU3RhdGUucm91bmQubGFzdEVuZERldGFpbFJlYXNvbiA9IGVuZERldGFpbFJlYXNvbjsKICAgIFN0YXRlLnJvdW5kLmxhc3RPYmplY3RpdmVQcm9ncmVzcyA9IG92ZXJ0aW1lUHJvZ3Jlc3M7CgogICAgU3RhdGUucm91bmQucGhhc2UgPSBSb3VuZFBoYXNlLk5vdFJlYWR5OyAvLyBSZXR1cm4gdG8gcHJlLXJvdW5kIHN0YXRlOyBtYXkgYmUgb3ZlcnJpZGRlbiB0byBHYW1lT3ZlciBiZWxvdy4KICAgIHNldFNwYXduRGlzYWJsZWRMaXZlVGV4dFZpc2libGVGb3JBbGxQbGF5ZXJzKGZhbHNlKTsKICAgIC8vIFJlYWR5LWN5Y2xlIGF1dG8tc3RhcnQgLyByZXNldDo6IHJvdW5kIGVuZGVkIC0+IHJlc2V0IGFsbCBwbGF5ZXJzIHRvIE5PVCBSRUFEWSBmb3IgdGhlIG5leHQgcmVhZHktdXAgY3ljbGUuCiAgICByZXNldFJlYWR5U3RhdGVGb3JBbGxQbGF5ZXJzKCk7CgogICAgLy8gRnJlZXplIGRpc3BsYXkgYWZ0ZXIgZW5kaW5nIHRoZSByb3VuZC4KICAgIFN0YXRlLnJvdW5kLmNsb2NrLmlzUGF1c2VkID0gdHJ1ZTsKICAgIFN0YXRlLnJvdW5kLmNsb2NrLnBhdXNlZFJlbWFpbmluZ1NlY29uZHMgPSBNYXRoLm1heCgwLCBmcmVlemVSZW1haW5pbmdTZWNvbmRzICE9PSB1bmRlZmluZWQgPyBNYXRoLmZsb29yKGZyZWV6ZVJlbWFpbmluZ1NlY29uZHMpIDogMCk7CgogICAgcmVzZXRPdmVydGltZUZsYWdTdGF0ZSgpOwogICAgLy8gUm91bmQgZW5kOiBoaWRlIHRpZS1icmVha2VyIG1hcmtlcnMgdW50aWwgdGhlIG5leHQgcm91bmQgZGVjaWRlcyBlbGlnaWJpbGl0eS4KICAgIFN0YXRlLmZsYWcudGllQnJlYWtlckVuYWJsZWRUaGlzUm91bmQgPSBmYWxzZTsKICAgIHNldE92ZXJ0aW1lQWxsRmxhZ1Zpc2liaWxpdHkoZmFsc2UpOwoKICAgIGNvbnN0IHdpbm5lclRlYW1OdW0gPSAob3ZlcnJpZGVXaW5uZXJUZWFtTnVtICE9PSB1bmRlZmluZWQpCiAgICAgICAgPyBvdmVycmlkZVdpbm5lclRlYW1OdW0KICAgICAgICA6ICh0MSA+IHQyID8gVGVhbUlELlRlYW0xIDogKCh0MiA+IHQxKSA/IFRlYW1JRC5UZWFtMiA6IDApKTsKICAgIFN0YXRlLnJvdW5kLmxhc3RXaW5uZXJUZWFtID0gd2lubmVyVGVhbU51bTsKICAgIHVwZGF0ZVJvdW5kRW5kRGlhbG9nRm9yQWxsUGxheWVycyh3aW5uZXJUZWFtTnVtKTsKICAgIHNldFJvdW5kRW5kRGlhbG9nVmlzaWJsZUZvckFsbFBsYXllcnModHJ1ZSk7CiAgICAvLyBMb2NrIG92ZXJ0aW1lIFVJIHVwZGF0ZXMgb25jZSB0aGUgcm91bmQtZW5kIGRpYWxvZyBpcyBzaG93bi4KICAgIFN0YXRlLnJvdW5kLmZsb3cucm91bmRFbmRVaUxvY2tkb3duID0gdHJ1ZTsKCiAgICBpZiAod2lubmVyVGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSB7CiAgICAgICAgY29uc3QgbmV3VDFXaW5zID0gU3RhdGUubWF0Y2gud2luc1QxICsgMTsKICAgICAgICBjb25zdCBuZXdUMldpbnMgPSBTdGF0ZS5tYXRjaC53aW5zVDI7CiAgICAgICAgc2V0SHVkV2luQ291bnRlcnNGb3JBbGxQbGF5ZXJzKG5ld1QxV2lucywgbmV3VDJXaW5zKTsKICAgICAgICBicm9hZGNhc3RTdHJpbmdLZXkobW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMucm91bmRFbmRXaW4sIGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMSksIHQxLCB0Mik7CiAgICAgICAgYnJvYWRjYXN0SGlnaGxpZ2h0ZWRTdHJpbmdLZXkobW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMucm91bmRXaW5zLCBuZXdUMVdpbnMsIG5ld1QyV2lucyk7CiAgICB9IGVsc2UgaWYgKHdpbm5lclRlYW1OdW0gPT09IFRlYW1JRC5UZWFtMikgewogICAgICAgIGNvbnN0IG5ld1QxV2lucyA9IFN0YXRlLm1hdGNoLndpbnNUMTsKICAgICAgICBjb25zdCBuZXdUMldpbnMgPSBTdGF0ZS5tYXRjaC53aW5zVDIgKyAxOwogICAgICAgIHNldEh1ZFdpbkNvdW50ZXJzRm9yQWxsUGxheWVycyhuZXdUMVdpbnMsIG5ld1QyV2lucyk7CiAgICAgICAgYnJvYWRjYXN0U3RyaW5nS2V5KG1vZC5zdHJpbmdrZXlzLnR3bC5ub3RpZmljYXRpb25zLnJvdW5kRW5kV2luLCBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTIpLCB0MiwgdDEpOwogICAgICAgIGJyb2FkY2FzdEhpZ2hsaWdodGVkU3RyaW5nS2V5KG1vZC5zdHJpbmdrZXlzLnR3bC5ub3RpZmljYXRpb25zLnJvdW5kV2lucywgbmV3VDFXaW5zLCBuZXdUMldpbnMpOwogICAgfSBlbHNlIHsKICAgICAgICBTdGF0ZS5tYXRjaC50aWVzVDEgPSBTdGF0ZS5tYXRjaC50aWVzVDEgKyAxOwogICAgICAgIFN0YXRlLm1hdGNoLnRpZXNUMiA9IFN0YXRlLm1hdGNoLnRpZXNUMiArIDE7CiAgICAgICAgc3luY1JvdW5kUmVjb3JkSHVkRm9yQWxsUGxheWVycygpOwogICAgICAgIGJyb2FkY2FzdFN0cmluZ0tleShtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5yb3VuZEVuZFRpZSwgdDEsIHQyKTsKICAgICAgICBicm9hZGNhc3RIaWdobGlnaHRlZFN0cmluZ0tleShtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5yb3VuZFdpbnMsIFN0YXRlLm1hdGNoLndpbnNUMSwgU3RhdGUubWF0Y2gud2luc1QyKTsKICAgIH0KCiAgICAvLyBFbmQgbWF0Y2ggd2hlbiBhIHRlYW0gcmVhY2hlcyB0aGUgcmVxdWlyZWQgbWFqb3JpdHkgb2Ygd2lucy4KICAgIGNvbnN0IHdpbnNOZWVkZWQgPSBNYXRoLmZsb29yKFN0YXRlLnJvdW5kLm1heCAvIDIpICsgMTsKICAgIGlmIChTdGF0ZS5yb3VuZC5tYXggPj0gMSkgewogICAgICAgIGlmIChTdGF0ZS5tYXRjaC53aW5zVDEgPj0gd2luc05lZWRlZCkgewogICAgICAgICAgICBTdGF0ZS5tYXRjaC5pc0VuZGVkID0gdHJ1ZTsKICAgICAgICAgICAgU3RhdGUucm91bmQucGhhc2UgPSBSb3VuZFBoYXNlLkdhbWVPdmVyOyAvLyBMb2NrcyBIVUQgdG8gR0FNRSBPVkVSIGFuZCBkaXNhYmxlcyBsaXZlIHNjb3JpbmcuCiAgICAgICAgICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgc2V0Um91bmRTdGF0ZVRleHRGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIFN0YXRlLm1hdGNoLndpbm5lclRlYW0gPSBUZWFtSUQuVGVhbTE7CiAgICAgICAgICAgIFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuID0gKFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuICsgMSkgJSAxMDAwMDAwMDAwOwogICAgICAgICAgICBjb25zdCBtYXRjaEVuZFRva2VuID0gU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW47CiAgICAgICAgICAgIHZvaWQgc2NoZWR1bGVGaW5hbFJvdW5kVmljdG9yeShtYXRjaEVuZFRva2VuLCBUZWFtSUQuVGVhbTEpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChTdGF0ZS5tYXRjaC53aW5zVDIgPj0gd2luc05lZWRlZCkgewogICAgICAgICAgICBTdGF0ZS5tYXRjaC5pc0VuZGVkID0gdHJ1ZTsKICAgICAgICAgICAgU3RhdGUucm91bmQucGhhc2UgPSBSb3VuZFBoYXNlLkdhbWVPdmVyOyAvLyBMb2NrcyBIVUQgdG8gR0FNRSBPVkVSIGFuZCBkaXNhYmxlcyBsaXZlIHNjb3JpbmcuCiAgICAgICAgICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgc2V0Um91bmRTdGF0ZVRleHRGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIFN0YXRlLm1hdGNoLndpbm5lclRlYW0gPSBUZWFtSUQuVGVhbTI7CiAgICAgICAgICAgIFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuID0gKFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuICsgMSkgJSAxMDAwMDAwMDAwOwogICAgICAgICAgICBjb25zdCBtYXRjaEVuZFRva2VuID0gU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW47CiAgICAgICAgICAgIHZvaWQgc2NoZWR1bGVGaW5hbFJvdW5kVmljdG9yeShtYXRjaEVuZFRva2VuLCBUZWFtSUQuVGVhbTIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfSAgICAKICAgIAogICAgLy8gRW5kcyB0aGUgbWF0Y2ggYXQgbWF4IHJvdW5kcyBieSBjb21wYXJpbmcgd2luczsgYSB0aWUgcmVtYWlucyBhIGRyYXcuCiAgICAvLyBFbmQgbWF0Y2ggd2hlbiB0aGUgY29uZmlndXJlZCBtYXggcm91bmRzIGFyZSBjb21wbGV0ZWQgd2l0aG91dCBhIG1ham9yaXR5IHdpbm5lci4KICAgIC8vIFdpbm5lciBpcyBkZWNpZGVkIGJ5IG1vc3Qgcm91bmRzIHdvbjsgYSB0aWUgcmVtYWlucyBhIGRyYXcuCiAgICBpZiAoU3RhdGUucm91bmQubWF4ID49IDEgJiYgU3RhdGUucm91bmQuY3VycmVudCA+PSBTdGF0ZS5yb3VuZC5tYXgpIHsKICAgICAgICBTdGF0ZS5tYXRjaC5pc0VuZGVkID0gdHJ1ZTsKICAgICAgICBTdGF0ZS5yb3VuZC5waGFzZSA9IFJvdW5kUGhhc2UuR2FtZU92ZXI7IC8vIExvY2tzIEhVRCB0byBHQU1FIE9WRVIgYW5kIGRpc2FibGVzIGxpdmUgc2NvcmluZy4KICAgICAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgc2V0Um91bmRTdGF0ZVRleHRGb3JBbGxQbGF5ZXJzKCk7CgogICAgICAgIGlmIChTdGF0ZS5tYXRjaC53aW5zVDEgPiBTdGF0ZS5tYXRjaC53aW5zVDIpIHsKICAgICAgICAgICAgU3RhdGUubWF0Y2gud2lubmVyVGVhbSA9IFRlYW1JRC5UZWFtMTsKICAgICAgICAgICAgU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW4gPSAoU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW4gKyAxKSAlIDEwMDAwMDAwMDA7CiAgICAgICAgICAgIGNvbnN0IG1hdGNoRW5kVG9rZW4gPSBTdGF0ZS5tYXRjaC5mbG93Lm1hdGNoRW5kRGVsYXlUb2tlbjsKICAgICAgICAgICAgdm9pZCBzY2hlZHVsZUZpbmFsUm91bmRWaWN0b3J5KG1hdGNoRW5kVG9rZW4sIFRlYW1JRC5UZWFtMSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChTdGF0ZS5tYXRjaC53aW5zVDIgPiBTdGF0ZS5tYXRjaC53aW5zVDEpIHsKICAgICAgICAgICAgU3RhdGUubWF0Y2gud2lubmVyVGVhbSA9IFRlYW1JRC5UZWFtMjsKICAgICAgICAgICAgU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW4gPSAoU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW4gKyAxKSAlIDEwMDAwMDAwMDA7CiAgICAgICAgICAgIGNvbnN0IG1hdGNoRW5kVG9rZW4gPSBTdGF0ZS5tYXRjaC5mbG93Lm1hdGNoRW5kRGVsYXlUb2tlbjsKICAgICAgICAgICAgdm9pZCBzY2hlZHVsZUZpbmFsUm91bmRWaWN0b3J5KG1hdGNoRW5kVG9rZW4sIFRlYW1JRC5UZWFtMik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIFN0YXRlLm1hdGNoLndpbm5lclRlYW0gPSB1bmRlZmluZWQ7CiAgICAgICAgU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW4gPSAoU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW4gKyAxKSAlIDEwMDAwMDAwMDA7CiAgICAgICAgY29uc3QgbWF0Y2hFbmRUb2tlbiA9IFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuOwogICAgICAgIHZvaWQgc2NoZWR1bGVGaW5hbFJvdW5kVmljdG9yeShtYXRjaEVuZFRva2VuLCAwKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgU3RhdGUucm91bmQuZmxvdy5yb3VuZEVuZFJlZGVwbG95VG9rZW4gPSAoU3RhdGUucm91bmQuZmxvdy5yb3VuZEVuZFJlZGVwbG95VG9rZW4gKyAxKSAlIDEwMDAwMDAwMDA7CiAgICBjb25zdCByZWRlcGxveVRva2VuID0gU3RhdGUucm91bmQuZmxvdy5yb3VuZEVuZFJlZGVwbG95VG9rZW47CgogICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5ub3RpZmljYXRpb25zLnJvdW5kT3ZlclJlZGVwbG95aW5nLCBST1VORF9FTkRfUkVERVBMT1lfREVMQVlfU0VDT05EUyksCiAgICAgICAgdHJ1ZSwKICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMucm91bmRPdmVyUmVkZXBsb3lpbmcKICAgICk7CiAgICB2b2lkIHNjaGVkdWxlUm91bmRFbmRDbGVhbnVwKHJlZGVwbG95VG9rZW4pOwoKICAgIC8vIFByZXBhcmUgbmV4dCByb3VuZCBjb3VudGVycyBhZnRlciBlbmRpbmcgdGhlIGFjdGl2ZSByb3VuZC4KICAgIFN0YXRlLnJvdW5kLmN1cnJlbnQgPSBNYXRoLmZsb29yKFN0YXRlLnJvdW5kLmN1cnJlbnQpICsgMTsKICAgIHNldEh1ZFJvdW5kQ291bnRlcnNGb3JBbGxQbGF5ZXJzKFN0YXRlLnJvdW5kLmN1cnJlbnQsIFN0YXRlLnJvdW5kLm1heCk7CiAgICBzZXRSb3VuZFN0YXRlVGV4dEZvckFsbFBsYXllcnMoKTsKICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvckFsbFBsYXllcnMoKTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIFJvdW5kIFN0YXJ0L0VuZCBGbG93ICsgU3RhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFVJIC0gUmVhZHkgVXAgRGlhbG9nIChjb25zdHJ1Y3Rpb24pIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBFbnN1cmVzIHRoZSBBZG1pbiBQYW5lbCB0b2dnbGUgYnV0dG9uICsgY29udGFpbmVyIGV4aXN0IGZvciB0aGlzIHBsYXllciBhbmQgYXJlIHNob3duL2hpZGRlbiBjb3JyZWN0bHkuCi8vIFJlcXVpcmVkIGZvciBVSSBjYWNoaW5nOiB3ZSBoaWRlIHRoZXNlIHdpZGdldHMgb24gZGlhbG9nIGNsb3NlIChub3QgZGVsZXRlKSwgc28gcmVvcGVuIGNhbiBzaW1wbHkgcmUtc2hvdyB0aGVtLgoKLy8gU29tZSBVSSBpbXBsZW1lbnRhdGlvbnMgZG8gbm90IGNhc2NhZGUgdmlzaWJpbGl0eSBmcm9tIGEgY29udGFpbmVyIHRvIGl0cyBjaGlsZHJlbi4KLy8gVG8gYXZvaWQgImdob3N0IiBhZG1pbiB3aWRnZXRzIGFwcGVhcmluZyB3aGVuIHRoZSBwYW5lbCBpcyBoaWRkZW4sIHdlIGV4cGxpY2l0bHkgdG9nZ2xlIGFsbCBhZG1pbi90ZXN0ZXIgd2lkZ2V0cy4KZnVuY3Rpb24gc2V0QWRtaW5QYW5lbENoaWxkV2lkZ2V0c1Zpc2libGUocGxheWVySWQ6IG51bWJlciwgdmlzaWJsZTogYm9vbGVhbik6IHZvaWQgewogICAgY29uc3QgaWRzOiBzdHJpbmdbXSA9IFsKICAgICAgICAvLyBBZG1pbi90ZXN0ZXIgaGVhZGVyICsgcm93IGxhYmVscwogICAgICAgIFVJX1RFU1RfSEVBREVSX0xBQkVMX0lELAogICAgICAgIFVJX1RFU1RfTEFCRUxfTEVGVF9XSU5TX0lELAogICAgICAgIFVJX1RFU1RfTEFCRUxfUklHSFRfV0lOU19JRCwKICAgICAgICBVSV9URVNUX0xBQkVMX0xFRlRfS0lMTFNfSUQsCiAgICAgICAgVUlfVEVTVF9MQUJFTF9SSUdIVF9LSUxMU19JRCwKICAgICAgICBVSV9URVNUX0xBQkVMX1JPVU5EX0tJTExTX1RBUkdFVF9JRCwKICAgICAgICBVSV9URVNUX1ZBTFVFX1JPVU5EX0tJTExTX1RBUkdFVF9JRCwKICAgICAgICBVSV9URVNUX0xBQkVMX1RJRVNfSUQsCiAgICAgICAgVUlfVEVTVF9MQUJFTF9DVVJfUk9VTkRfSUQsCiAgICAgICAgVUlfVEVTVF9MQUJFTF9DTE9DS19USU1FX0lELAogICAgICAgIFVJX0FETUlOX0xBQkVMX1QxX1JPVU5EX0tJTExTX0lELAogICAgICAgIFVJX0FETUlOX0xBQkVMX1QyX1JPVU5EX0tJTExTX0lELAogICAgICAgIFVJX0FETUlOX1RJRUJSRUFLRVJfTEFCRUxfSUQsCiAgICAgICAgVUlfQURNSU5fVElFQlJFQUtFUl9NT0RFX0hFQURFUl9JRCwKICAgICAgICBVSV9BRE1JTl9USUVCUkVBS0VSX01PREVfTEFCRUxfSUQsCiAgICAgICAgVUlfQURNSU5fTElWRV9SRVNQQVdOX1RFWFRfSUQsCgogICAgICAgIC8vIFJvdyArLy0gYnV0dG9ucwogICAgICAgIFVJX1RFU1RfQlVUVE9OX0xFRlRfV0lOU19ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX0xFRlRfV0lOU19JTkNfSUQsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fUklHSFRfV0lOU19ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX1JJR0hUX1dJTlNfSU5DX0lELAogICAgICAgIFVJX1RFU1RfQlVUVE9OX0xFRlRfS0lMTFNfREVDX0lELCBVSV9URVNUX0JVVFRPTl9MRUZUX0tJTExTX0lOQ19JRCwKICAgICAgICBVSV9URVNUX0JVVFRPTl9SSUdIVF9LSUxMU19ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX1JJR0hUX0tJTExTX0lOQ19JRCwKICAgICAgICBVSV9URVNUX0JVVFRPTl9ST1VORF9LSUxMU19UQVJHRVRfREVDX0lELCBVSV9URVNUX0JVVFRPTl9ST1VORF9LSUxMU19UQVJHRVRfSU5DX0lELAogICAgICAgIFVJX0FETUlOX0JVVFRPTl9UMV9ST1VORF9LSUxMU19ERUNfSUQsIFVJX0FETUlOX0JVVFRPTl9UMV9ST1VORF9LSUxMU19JTkNfSUQsCiAgICAgICAgVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0RFQ19JRCwgVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0lOQ19JRCwKICAgICAgICBVSV9BRE1JTl9USUVCUkVBS0VSX01PREVfREVDX0lELCBVSV9BRE1JTl9USUVCUkVBS0VSX01PREVfSU5DX0lELAogICAgICAgIFVJX0FETUlOX0xJVkVfUkVTUEFXTl9CVVRUT05fSUQsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fVElFU19ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX1RJRVNfSU5DX0lELAogICAgICAgIFVJX1RFU1RfQlVUVE9OX0NVUl9ST1VORF9ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX0NVUl9ST1VORF9JTkNfSUQsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fQ0xPQ0tfVElNRV9ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX0NMT0NLX1RJTUVfSU5DX0lELAoKICAgICAgICAvLyArLy0gdGV4dCBvdmVybGF5cwogICAgICAgIFVJX1RFU1RfTUlOVVNfVEVYVF9JRCwKICAgICAgICBVSV9URVNUX1BMVVNfVEVYVF9JRCwKCiAgICAgICAgLy8gQm90dG9tIGFkbWluIGJ1dHRvbnMKICAgICAgICBVSV9URVNUX0JVVFRPTl9DTE9DS19SRVNFVF9JRCwgVUlfVEVTVF9SRVNFVF9URVhUX0lELAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1JPVU5EX1NUQVJUX0lELCBVSV9URVNUX1JPVU5EX1NUQVJUX1RFWFRfSUQsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fUk9VTkRfRU5EX0lELCBVSV9URVNUX1JPVU5EX0VORF9URVhUX0lELAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1BPU19ERUJVR19JRCwgVUlfVEVTVF9QT1NfREVCVUdfVEVYVF9JRCwKICAgIF07CgogICAgZm9yIChjb25zdCBiYXNlSWQgb2YgaWRzKSB7CiAgICAgICAgY29uc3QgdyA9IHNhZmVGaW5kKGJhc2VJZCArIHBsYXllcklkKTsKICAgICAgICBpZiAodykgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh3LCB2aXNpYmxlKTsKICAgICAgICBjb25zdCBib3JkZXIgPSBzYWZlRmluZChiYXNlSWQgKyBwbGF5ZXJJZCArICJfQk9SREVSIik7CiAgICAgICAgaWYgKGJvcmRlcikgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShib3JkZXIsIHZpc2libGUpOwogICAgfQoKICAgIGZvciAoY29uc3QgbGV0dGVyIG9mIEFETUlOX1RJRUJSRUFLRVJfT1ZFUlJJREVfTEVUVEVSUykgewogICAgICAgIGNvbnN0IGJ1dHRvbkJhc2VJZCA9IFVJX0FETUlOX1RJRUJSRUFLRVJfQlVUVE9OX0lEICsgbGV0dGVyICsgIl8iOwogICAgICAgIGNvbnN0IHRleHRCYXNlSWQgPSBVSV9BRE1JTl9USUVCUkVBS0VSX0JVVFRPTl9URVhUX0lEICsgbGV0dGVyICsgIl8iOwogICAgICAgIGNvbnN0IGJ1dHRvbiA9IHNhZmVGaW5kKGJ1dHRvbkJhc2VJZCArIHBsYXllcklkKTsKICAgICAgICBpZiAoYnV0dG9uKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGJ1dHRvbiwgdmlzaWJsZSk7CiAgICAgICAgY29uc3QgYm9yZGVyID0gc2FmZUZpbmQoYnV0dG9uQmFzZUlkICsgcGxheWVySWQgKyAiX0JPUkRFUiIpOwogICAgICAgIGlmIChib3JkZXIpIG1vZC5TZXRVSVdpZGdldFZpc2libGUoYm9yZGVyLCB2aXNpYmxlKTsKICAgICAgICBjb25zdCB0ZXh0ID0gc2FmZUZpbmQodGV4dEJhc2VJZCArIHBsYXllcklkKTsKICAgICAgICBpZiAodGV4dCkgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh0ZXh0LCB2aXNpYmxlKTsKICAgIH0KfQoKLy8gQWRtaW4gUGFuZWwgbGlmZWN5Y2xlIGhlbHBlci4KLy8gV2UgRE8gTk9UIGNhY2hlIHRoZSBhZG1pbiBwYW5lbCBjb250ZW50cyBiZWNhdXNlIHNvbWUgZW5naW5lcyBkbyBub3QgcmVsaWFibHkgaGlkZSBjb250YWluZXIgY2hpbGRyZW4uCi8vIEluc3RlYWQsIHdlIGRlbGV0ZSB0aGUgcGFuZWwgY29udGFpbmVyICsgYWxsIGNoaWxkcmVuIHdoZW5ldmVyIGl0IGlzIGNsb3NlZCwgYW5kIHJlYnVpbGQgb24tZGVtYW5kLgpmdW5jdGlvbiBkZWxldGVBZG1pblBhbmVsVUkocGxheWVySWQ6IG51bWJlciwgZGVsZXRlVG9nZ2xlOiBib29sZWFuKTogdm9pZCB7CiAgICAvLyBIaWRlIGNoaWxkIHdpZGdldHMgZmlyc3QgKGNvdmVycyBhbnkgc3RyYXkgY2hpbGRyZW4gdGhhdCBtYXkgaGF2ZSBkZXRhY2hlZCBmcm9tIHRoZSBjb250YWluZXIpLgogICAgc2V0QWRtaW5QYW5lbENoaWxkV2lkZ2V0c1Zpc2libGUocGxheWVySWQsIGZhbHNlKTsKCiAgICBjb25zdCBhZG1pbkNvbnRhaW5lciA9IHNhZmVGaW5kKFVJX0FETUlOX1BBTkVMX0NPTlRBSU5FUl9JRCArIHBsYXllcklkKTsKICAgIGlmIChhZG1pbkNvbnRhaW5lcikgbW9kLkRlbGV0ZVVJV2lkZ2V0KGFkbWluQ29udGFpbmVyKTsKCiAgICBpZiAoZGVsZXRlVG9nZ2xlKSB7CiAgICAgICAgY29uc3QgYWRtaW5Ub2dnbGUgPSBzYWZlRmluZChVSV9BRE1JTl9QQU5FTF9CVVRUT05fSUQgKyBwbGF5ZXJJZCk7CiAgICAgICAgaWYgKGFkbWluVG9nZ2xlKSBtb2QuRGVsZXRlVUlXaWRnZXQoYWRtaW5Ub2dnbGUpOwogICAgICAgIGNvbnN0IGFkbWluVG9nZ2xlTGFiZWwgPSBzYWZlRmluZChVSV9BRE1JTl9QQU5FTF9CVVRUT05fTEFCRUxfSUQgKyBwbGF5ZXJJZCk7CiAgICAgICAgaWYgKGFkbWluVG9nZ2xlTGFiZWwpIG1vZC5EZWxldGVVSVdpZGdldChhZG1pblRvZ2dsZUxhYmVsKTsKICAgICAgICBjb25zdCBhZG1pblRvZ2dsZUJvcmRlciA9IHNhZmVGaW5kKFVJX0FETUlOX1BBTkVMX0JVVFRPTl9JRCArIHBsYXllcklkICsgIl9CT1JERVIiKTsKICAgICAgICBpZiAoYWRtaW5Ub2dnbGVCb3JkZXIpIG1vZC5EZWxldGVVSVdpZGdldChhZG1pblRvZ2dsZUJvcmRlcik7CiAgICB9Cn0KCmZ1bmN0aW9uIGVuc3VyZUFkbWluUGFuZWxXaWRnZXRzKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyLCBwbGF5ZXJJZDogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCBBRE1JTl9UT0dHTEVfQlVUVE9OX0lEID0gVUlfQURNSU5fUEFORUxfQlVUVE9OX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBBRE1JTl9UT0dHTEVfTEFCRUxfSUQgPSBVSV9BRE1JTl9QQU5FTF9CVVRUT05fTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IEFETUlOX0NPTlRBSU5FUl9JRCA9IFVJX0FETUlOX1BBTkVMX0NPTlRBSU5FUl9JRCArIHBsYXllcklkOwoKICAgIC8vIENyZWF0ZSB0b2dnbGUgYnV0dG9uIGlmIG1pc3NpbmcuCiAgICBsZXQgdG9nZ2xlQnRuID0gc2FmZUZpbmQoQURNSU5fVE9HR0xFX0JVVFRPTl9JRCk7CiAgICBpZiAoIXRvZ2dsZUJ0bikgewogICAgICAgIGNvbnN0IHRvZ2dsZUJvcmRlciA9IGFkZE91dGxpbmVkQnV0dG9uKAogICAgICAgICAgICBBRE1JTl9UT0dHTEVfQlVUVE9OX0lELAogICAgICAgICAgICBBRE1JTl9QQU5FTF9UT0dHTEVfT0ZGU0VUX1gsCiAgICAgICAgICAgIEFETUlOX1BBTkVMX1RPR0dMRV9PRkZTRVRfWSwKICAgICAgICAgICAgQURNSU5fUEFORUxfVE9HR0xFX1dJRFRILAogICAgICAgICAgICBBRE1JTl9QQU5FTF9UT0dHTEVfSEVJR0hULAogICAgICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgICAgIG1vZC5HZXRVSVJvb3QoKSwKICAgICAgICAgICAgZXZlbnRQbGF5ZXIKICAgICAgICApOwogICAgICAgIHRvZ2dsZUJ0biA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShBRE1JTl9UT0dHTEVfQlVUVE9OX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgfQoKICAgIC8vIFJlY3JlYXRlIGxhYmVsIHRvIGd1YXJhbnRlZSBjb3JyZWN0IGFuY2hvci9wYXJlbnRpbmcgd2l0aCBvdXRsaW5lZCBib3JkZXIuCiAgICBjb25zdCBleGlzdGluZ1RvZ2dsZUxhYmVsID0gc2FmZUZpbmQoQURNSU5fVE9HR0xFX0xBQkVMX0lEKTsKICAgIGlmIChleGlzdGluZ1RvZ2dsZUxhYmVsKSBtb2QuRGVsZXRlVUlXaWRnZXQoZXhpc3RpbmdUb2dnbGVMYWJlbCk7CiAgICBjb25zdCBhZG1pblRvZ2dsZUJvcmRlciA9IHNhZmVGaW5kKEFETUlOX1RPR0dMRV9CVVRUT05fSUQgKyAiX0JPUkRFUiIpOwogICAgY29uc3QgdG9nZ2xlTGFiZWwgPSBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgQURNSU5fVE9HR0xFX0xBQkVMX0lELAogICAgICAgIEFETUlOX1BBTkVMX1RPR0dMRV9XSURUSCwKICAgICAgICBBRE1JTl9QQU5FTF9UT0dHTEVfSEVJR0hULAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmJ1dHRvbnMucGFuZWwpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIGFkbWluVG9nZ2xlQm9yZGVyID8/IG1vZC5HZXRVSVJvb3QoKQogICAgKTsKICAgIGlmICh0b2dnbGVMYWJlbCkgewogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKHRvZ2dsZUxhYmVsLCAxMik7CiAgICAgICAgbW9kLlNldFVJVGV4dENvbG9yKHRvZ2dsZUxhYmVsLCBBRE1JTl9QQU5FTF9CVVRUT05fVEVYVF9DT0xPUik7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0RGVwdGgodG9nZ2xlTGFiZWwsIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJKTsKICAgIH0KCiAgICAvLyBDcmVhdGUgYWRtaW4gY29udGFpbmVyIGlmIG1pc3NpbmcuCiAgICBsZXQgYWRtaW5Db250YWluZXIgPSBzYWZlRmluZChBRE1JTl9DT05UQUlORVJfSUQpOwogICAgaWYgKCFhZG1pbkNvbnRhaW5lcikgewogICAgICAgIG1vZC5BZGRVSUNvbnRhaW5lcigKICAgICAgICAgICAgQURNSU5fQ09OVEFJTkVSX0lELAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKEFETUlOX1BBTkVMX09GRlNFVF9YLCBBRE1JTl9QQU5FTF9PRkZTRVRfWSwgMCksCiAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoQURNSU5fUEFORUxfQ09OVEVOVF9XSURUSCArIChBRE1JTl9QQU5FTF9QQURESU5HICogMiksIEFETUlOX1BBTkVMX0hFSUdIVCArIChBRE1JTl9QQU5FTF9QQURESU5HICogMiksIDApLAogICAgICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgICAgIG1vZC5HZXRVSVJvb3QoKSwKICAgICAgICAgICAgZmFsc2UsCiAgICAgICAgICAgIDEwLAogICAgICAgICAgICBBRE1JTl9QQU5FTF9CR19DT0xPUiwKICAgICAgICAgICAgQURNSU5fUEFORUxfQkdfQUxQSEEsCiAgICAgICAgICAgIEFETUlOX1BBTkVMX0JHX0ZJTEwsCiAgICAgICAgICAgIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJLAogICAgICAgICAgICBldmVudFBsYXllcgogICAgICAgICk7CiAgICAgICAgYWRtaW5Db250YWluZXIgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoQURNSU5fQ09OVEFJTkVSX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgfQoKICAgIC8vIEFkbWluIHRvZ2dsZSBidXR0b24gc2hvdWxkIGV4aXN0IG9ubHkgd2hpbGUgdGhlIFJlYWR5IFVwIGRpYWxvZyBpcyBvcGVuLgogICAgLy8gV2hlbiBjYWNoaW5nIGlzIGVuYWJsZWQsIHdlIGhpZGUvc2hvdyByYXRoZXIgdGhhbiByZWNyZWF0ZS4KICAgIGlmICh0b2dnbGVCdG4pIG1vZC5TZXRVSVdpZGdldFZpc2libGUodG9nZ2xlQnRuLCB0cnVlKTsKICAgIGlmICh0b2dnbGVMYWJlbCkgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh0b2dnbGVMYWJlbCwgdHJ1ZSk7CiAgICBjb25zdCB0b2dnbGVCb3JkZXIgPSBzYWZlRmluZChBRE1JTl9UT0dHTEVfQlVUVE9OX0lEICsgIl9CT1JERVIiKTsKICAgIGlmICh0b2dnbGVCb3JkZXIpIG1vZC5TZXRVSVdpZGdldFZpc2libGUodG9nZ2xlQm9yZGVyLCB0cnVlKTsKCiAgICAvLyBEZWZhdWx0IGNsb3NlZCBvbiBmaXJzdCBidWlsZDsgcHJlc2VydmUgc3RhdGUgb24gcmVvcGVuLgogICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXSkgaW5pdFRlYW1Td2l0Y2hEYXRhKGV2ZW50UGxheWVyKTsKICAgIGlmICghU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uYWRtaW5QYW5lbEJ1aWx0KSB7CiAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uYWRtaW5QYW5lbFZpc2libGUgPSBmYWxzZTsKICAgICAgICBpZiAoYWRtaW5Db250YWluZXIpIG1vZC5TZXRVSVdpZGdldFZpc2libGUoYWRtaW5Db250YWluZXIsIGZhbHNlKTsKICAgICAgICBzZXRBZG1pblBhbmVsQ2hpbGRXaWRnZXRzVmlzaWJsZShwbGF5ZXJJZCwgZmFsc2UpOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB2aXNpYmxlID0gU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uYWRtaW5QYW5lbFZpc2libGU7CiAgICAgICAgaWYgKGFkbWluQ29udGFpbmVyKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGFkbWluQ29udGFpbmVyLCB2aXNpYmxlKTsKICAgICAgICBzZXRBZG1pblBhbmVsQ2hpbGRXaWRnZXRzVmlzaWJsZShwbGF5ZXJJZCwgdmlzaWJsZSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGNyZWF0ZVRlYW1Td2l0Y2hVSShldmVudFBsYXllcjogbW9kLlBsYXllcikgewogICAgLy8gU3RlcHM6CiAgICAvLyAxKSBFbnN1cmUgcGVyLXBsYXllciBkaWFsb2cgcm9vdCBleGlzdHMKICAgIC8vIDIpIEJ1aWxkIGxlZnQgdGVhbSBwYW5lbCB3aWRnZXRzCiAgICAvLyAzKSBCdWlsZCByaWdodCB0ZWFtIHBhbmVsIHdpZGdldHMKICAgIC8vIDQpIEJ1aWxkIGFkbWluIHBhbmVsIHdpZGdldHMgKyBiaW5kIGJ1dHRvbiBJRHMKICAgIC8vIDUpIEZpbmFsaXplIHZpc2liaWxpdHkgLyBkZWZhdWx0IHN0YXRlcwoKICAgIC8vIFVJIGxheW91dCBtYXBzIChwZXIgcGFuZWwpOgogICAgLy8gLSBMZWZ0IHBhbmVsOiBUZWFtIDEgcm9zdGVyIC8gaW50ZXJhY3Rpb24gc3VyZmFjZSAobGF5b3V0LWRyaXZlbikuCiAgICAvLyAtIFJpZ2h0IHBhbmVsOiBUZWFtIDIgcm9zdGVyIC8gaW50ZXJhY3Rpb24gc3VyZmFjZSAobGF5b3V0LWRyaXZlbikuCiAgICAvLyAtIEFkbWluIHBhbmVsOiBUdW5hYmxlIGNvbnRyb2xzIHRoYXQgbXV0YXRlIGF1dGhvcml0YXRpdmUgc3RhdGU7IHJvd3MgYXJlIHBsYWNlZCB2aWEgcm93MFkgKyBOICogKGJ1dHRvblNpemVZICsgcm93U3BhY2luZ1kpLgogICAgLy8gTGF5b3V0IHJ1bGU6IGlmIGEgbGFiZWwgd3JhcHMgb3Igb3ZlcmxhcHMsIGFkanVzdCBsYWJlbFNpemVYIG9yIHRleHQgc2l6ZSBiZWZvcmUgdG91Y2hpbmcgcm93IG1hdGguCgogICAgY29uc3QgcGxheWVySWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgLy8gVUkgY2FjaGluZyAob3B0ICMxKTogaWYgdGhpcyBwbGF5ZXIgYWxyZWFkeSBidWlsdCB0aGUgZGlhbG9nIG9uY2UsIGp1c3Qgc2hvdyBpdCBhZ2Fpbi4KICAgIC8vIFRoaXMgYXZvaWRzIHJlY3JlYXRpbmcgfjEwMCB3aWRnZXRzIG9uIGV2ZXJ5IG9wZW4gYW5kIG1ha2VzIGRpYWxvZyBvcGVuIG5lYXItaW5zdGFudCBhZnRlciBmaXJzdCBidWlsZC4KICAgIGNvbnN0IGV4aXN0aW5nQmFzZSA9IHNhZmVGaW5kKFVJX1RFQU1TV0lUQ0hfQ09OVEFJTkVSX0JBU0VfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAoZXhpc3RpbmdCYXNlKSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShleGlzdGluZ0Jhc2UsIHRydWUpOwogICAgICAgIGNvbnN0IGV4aXN0aW5nQm9yZGVyVG9wID0gc2FmZUZpbmQoVUlfVEVBTVNXSVRDSF9CT1JERVJfVE9QX0lEICsgcGxheWVySWQpOwogICAgICAgIGlmIChleGlzdGluZ0JvcmRlclRvcCkgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShleGlzdGluZ0JvcmRlclRvcCwgdHJ1ZSk7CiAgICAgICAgY29uc3QgZXhpc3RpbmdCb3JkZXJCb3R0b20gPSBzYWZlRmluZChVSV9URUFNU1dJVENIX0JPUkRFUl9CT1RUT01fSUQgKyBwbGF5ZXJJZCk7CiAgICAgICAgaWYgKGV4aXN0aW5nQm9yZGVyQm90dG9tKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGV4aXN0aW5nQm9yZGVyQm90dG9tLCB0cnVlKTsKICAgICAgICBjb25zdCBleGlzdGluZ0JvcmRlckxlZnQgPSBzYWZlRmluZChVSV9URUFNU1dJVENIX0JPUkRFUl9MRUZUX0lEICsgcGxheWVySWQpOwogICAgICAgIGlmIChleGlzdGluZ0JvcmRlckxlZnQpIG1vZC5TZXRVSVdpZGdldFZpc2libGUoZXhpc3RpbmdCb3JkZXJMZWZ0LCB0cnVlKTsKICAgICAgICBjb25zdCBleGlzdGluZ0JvcmRlclJpZ2h0ID0gc2FmZUZpbmQoVUlfVEVBTVNXSVRDSF9CT1JERVJfUklHSFRfSUQgKyBwbGF5ZXJJZCk7CiAgICAgICAgaWYgKGV4aXN0aW5nQm9yZGVyUmlnaHQpIG1vZC5TZXRVSVdpZGdldFZpc2libGUoZXhpc3RpbmdCb3JkZXJSaWdodCwgdHJ1ZSk7CiAgICAgICAgY29uc3QgZXhpc3RpbmdEZWJ1ZyA9IHNhZmVGaW5kKFVJX1RFQU1TV0lUQ0hfREVCVUdfVElNRUxJTUlUX0lEICsgcGxheWVySWQpOwogICAgICAgIGlmIChleGlzdGluZ0RlYnVnKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGV4aXN0aW5nRGVidWcsIFNIT1dfREVCVUdfVElNRUxJTUlUKTsKICAgICAgICByZWZyZXNoUmVhZHlEaWFsb2dCdXR0b25UZXh0Rm9yUGlkKGV2ZW50UGxheWVyLCBwbGF5ZXJJZCwgZXhpc3RpbmdCYXNlIGFzIG1vZC5VSVdpZGdldCk7CiAgICAgICAgY29uc3QgZXhpc3RpbmdNYXBMYWJlbCA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19NQVBfTEFCRUxfSUQgKyBwbGF5ZXJJZCk7CiAgICAgICAgaWYgKGV4aXN0aW5nTWFwTGFiZWwpIG1vZC5TZXRVSVdpZGdldFZpc2libGUoZXhpc3RpbmdNYXBMYWJlbCwgdHJ1ZSk7CiAgICAgICAgY29uc3QgZXhpc3RpbmdNYXBWYWx1ZSA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19NQVBfVkFMVUVfSUQgKyBwbGF5ZXJJZCk7CiAgICAgICAgaWYgKGV4aXN0aW5nTWFwVmFsdWUpIG1vZC5TZXRVSVdpZGdldFZpc2libGUoZXhpc3RpbmdNYXBWYWx1ZSwgdHJ1ZSk7CiAgICAgICAgdXBkYXRlUmVhZHlEaWFsb2dNb2RlQ29uZmlnRm9yUGlkKHBsYXllcklkKTsKICAgICAgICBlbnN1cmVBZG1pblBhbmVsV2lkZ2V0cyhldmVudFBsYXllciwgcGxheWVySWQpOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBDT05UQUlORVJfQkFTRV9JRCA9IFVJX1RFQU1TV0lUQ0hfQ09OVEFJTkVSX0JBU0VfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IEJPUkRFUl9UT1BfSUQgPSBVSV9URUFNU1dJVENIX0JPUkRFUl9UT1BfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IEJPUkRFUl9CT1RUT01fSUQgPSBVSV9URUFNU1dJVENIX0JPUkRFUl9CT1RUT01fSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IEJPUkRFUl9MRUZUX0lEID0gVUlfVEVBTVNXSVRDSF9CT1JERVJfTEVGVF9JRCArIHBsYXllcklkOwogICAgY29uc3QgQk9SREVSX1JJR0hUX0lEID0gVUlfVEVBTVNXSVRDSF9CT1JERVJfUklHSFRfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IENPTlRBSU5FUl9CT1JERVJfUEFERElORyA9IDE7CiAgICBjb25zdCBDT05UQUlORVJfQk9SREVSX1RISUNLTkVTUyA9IDI7CiAgICBjb25zdCBDT05UQUlORVJfQk9SREVSX09WRVJMQVAgPSAyOwogICAgY29uc3QgQ09OVEFJTkVSX1dJRFRIID0gMTMwMDsKICAgIGNvbnN0IENPTlRBSU5FUl9IRUlHSFQgPSA3MDA7CiAgICBjb25zdCBSRUFEWV9ST1NURVJfUEFORUxfV0lEVEggPSA1ODA7CiAgICBjb25zdCBSRUFEWV9ST1NURVJfUEFORUxfSEVJR0hUID0gNDQwOwogICAgY29uc3QgUkVBRFlfUk9TVEVSX1BBTkVMX0dBUCA9IDQwOwogICAgY29uc3QgUkVBRFlfUk9TVEVSX1BBTkVMX01BUkdJTiA9IDQwOwogICAgY29uc3QgUkVBRFlfUk9TVEVSX1BBTkVMX1kgPSAxNzU7CgogICAgLy9jb25zdCBCVVRUT05fVEVBTTFfSUQgPSBVSV9URUFNU1dJVENIX0JVVFRPTl9URUFNMV9JRCArIHBsYXllcklkOyAvL29sZCBidXR0b24vZGVhZAogICAgLy9jb25zdCBCVVRUT05fVEVBTTFfTEFCRUxfSUQgPSBVSV9URUFNU1dJVENIX0JVVFRPTl9URUFNMV9MQUJFTF9JRCArIHBsYXllcklkOyAvL29sZCBidXR0b24vZGVhZAoKICAgIC8vY29uc3QgQlVUVE9OX1RFQU0yX0lEID0gVUlfVEVBTVNXSVRDSF9CVVRUT05fVEVBTTJfSUQgKyBwbGF5ZXJJZDsgLy9vbGQgYnV0dG9uL2RlYWQKICAgIC8vY29uc3QgQlVUVE9OX1RFQU0yX0xBQkVMX0lEID0gVUlfVEVBTVNXSVRDSF9CVVRUT05fVEVBTTJfTEFCRUxfSUQgKyBwbGF5ZXJJZDsgLy9vbGQgYnV0dG9uL2RlYWQKCiAgICAvL2NvbnN0IEJVVFRPTl9TUEVDVEFURV9JRCA9IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX1NQRUNUQVRFX0lEICsgcGxheWVySWQ7IC8vb2xkIGJ1dHRvbi9kZWFkCiAgICAvL2NvbnN0IEJVVFRPTl9TUEVDVEFURV9MQUJFTF9JRCA9IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX1NQRUNUQVRFX0xBQkVMX0lEICsgcGxheWVySWQ7IC8vb2xkIGJ1dHRvbi9kZWFkCgogICAgY29uc3QgQlVUVE9OX0NBTkNFTF9JRCA9IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX0NBTkNFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgQlVUVE9OX0NBTkNFTF9MQUJFTF9JRCA9IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX0NBTkNFTF9MQUJFTF9JRCArIHBsYXllcklkOwoKICAgIC8vY29uc3QgQlVUVE9OX09QVE9VVF9JRCA9IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX09QVE9VVF9JRCArIHBsYXllcklkOyAvL29sZCBidXR0b24vZGVhZAogICAgLy9jb25zdCBCVVRUT05fT1BUT1VUX0xBQkVMX0lEID0gVUlfVEVBTVNXSVRDSF9CVVRUT05fT1BUT1VUX0xBQkVMX0lEICsgcGxheWVySWQ7IC8vb2xkIGJ1dHRvbi9kZWFkCgogICAgbW9kLkFkZFVJQ29udGFpbmVyKAogICAgICAgIENPTlRBSU5FUl9CQVNFX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihDT05UQUlORVJfV0lEVEgsIENPTlRBSU5FUl9IRUlHSFQsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgbW9kLkdldFVJUm9vdCgpLAogICAgICAgIHRydWUsCiAgICAgICAgMTAsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigwLCAwLCAwKSwKICAgICAgICAwLjk5NSwKICAgICAgICBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IENPTlRBSU5FUl9CQVNFID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKENPTlRBSU5FUl9CQVNFX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShDT05UQUlORVJfQkFTRSwgMC45OTUpOyAvLyBGb3JjZSBkYXJrZXIgb3ZlcmxheSAoc29tZSBjbGllbnRzIHJlbmRlciBibHVyIGxpZ2h0ZXIpCgogICAgY29uc3QgYm9yZGVySGFsZldpZHRoID0gKENPTlRBSU5FUl9XSURUSCAvIDIpICsgQ09OVEFJTkVSX0JPUkRFUl9QQURESU5HICsgKENPTlRBSU5FUl9CT1JERVJfVEhJQ0tORVNTIC8gMik7CiAgICBjb25zdCBib3JkZXJIYWxmSGVpZ2h0ID0gKENPTlRBSU5FUl9IRUlHSFQgLyAyKSArIENPTlRBSU5FUl9CT1JERVJfUEFERElORyArIChDT05UQUlORVJfQk9SREVSX1RISUNLTkVTUyAvIDIpOwogICAgY29uc3QgYm9yZGVyTGluZVdpZHRoID0gQ09OVEFJTkVSX1dJRFRIICsgKENPTlRBSU5FUl9CT1JERVJfUEFERElORyAqIDIpICsgKENPTlRBSU5FUl9CT1JERVJfT1ZFUkxBUCAqIDIpOwogICAgY29uc3QgYm9yZGVyTGluZUhlaWdodCA9IENPTlRBSU5FUl9IRUlHSFQgKyAoQ09OVEFJTkVSX0JPUkRFUl9QQURESU5HICogMikgKyAoQ09OVEFJTkVSX0JPUkRFUl9PVkVSTEFQICogMik7CgogICAgLy8gVG9wIGJvcmRlciBsaW5lCiAgICBtb2QuQWRkVUlDb250YWluZXIoCiAgICAgICAgQk9SREVSX1RPUF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIC1ib3JkZXJIYWxmSGVpZ2h0LCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKGJvcmRlckxpbmVXaWR0aCwgQ09OVEFJTkVSX0JPUkRFUl9USElDS05FU1MsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgdHJ1ZSwKICAgICAgICAwLAogICAgICAgIFJFQURZX0RJQUxPR19CT1JERVJfQ09MT1IsCiAgICAgICAgMSwKICAgICAgICBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CgogICAgLy8gQm90dG9tIGJvcmRlciBsaW5lCiAgICBtb2QuQWRkVUlDb250YWluZXIoCiAgICAgICAgQk9SREVSX0JPVFRPTV9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIGJvcmRlckhhbGZIZWlnaHQsIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoYm9yZGVyTGluZVdpZHRoLCBDT05UQUlORVJfQk9SREVSX1RISUNLTkVTUywgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICBDT05UQUlORVJfQkFTRSwKICAgICAgICB0cnVlLAogICAgICAgIDAsCiAgICAgICAgUkVBRFlfRElBTE9HX0JPUkRFUl9DT0xPUiwKICAgICAgICAxLAogICAgICAgIG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKCiAgICAvLyBMZWZ0IGJvcmRlciBsaW5lCiAgICBtb2QuQWRkVUlDb250YWluZXIoCiAgICAgICAgQk9SREVSX0xFRlRfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtYm9yZGVySGFsZldpZHRoLCAwLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKENPTlRBSU5FUl9CT1JERVJfVEhJQ0tORVNTLCBib3JkZXJMaW5lSGVpZ2h0LCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgIENPTlRBSU5FUl9CQVNFLAogICAgICAgIHRydWUsCiAgICAgICAgMCwKICAgICAgICBSRUFEWV9ESUFMT0dfQk9SREVSX0NPTE9SLAogICAgICAgIDEsCiAgICAgICAgbW9kLlVJQmdGaWxsLlNvbGlkLAogICAgICAgIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwoKICAgIC8vIFJpZ2h0IGJvcmRlciBsaW5lCiAgICBtb2QuQWRkVUlDb250YWluZXIoCiAgICAgICAgQk9SREVSX1JJR0hUX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoYm9yZGVySGFsZldpZHRoLCAwLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKENPTlRBSU5FUl9CT1JERVJfVEhJQ0tORVNTLCBib3JkZXJMaW5lSGVpZ2h0LCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgIENPTlRBSU5FUl9CQVNFLAogICAgICAgIHRydWUsCiAgICAgICAgMCwKICAgICAgICBSRUFEWV9ESUFMT0dfQk9SREVSX0NPTE9SLAogICAgICAgIDEsCiAgICAgICAgbW9kLlVJQmdGaWxsLlNvbGlkLAogICAgICAgIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwoKICAgIC8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBVSSAtIFJlYWR5IFVwIERpYWxvZyAoY29uc3RydWN0aW9uKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAoUm9zdGVyIFVJKSAtICAoaGVhZGVyICsgdGVhbSByb3N0ZXJzKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIEhlYWRlciByb3dzIChzdHJpbmctYmFja2VkIGZvciBlYXN5IGl0ZXJhdGlvbikuCiAgICBjb25zdCBSRUFEWV9IRUFERVJfSUQgPSBVSV9SRUFEWV9ESUFMT0dfSEVBREVSX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBSRUFEWV9IRUFERVIyX0lEID0gVUlfUkVBRFlfRElBTE9HX0hFQURFUjJfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IFJFQURZX0hFQURFUjNfSUQgPSBVSV9SRUFEWV9ESUFMT0dfSEVBREVSM19JRCArIHBsYXllcklkOwogICAgY29uc3QgUkVBRFlfSEVBREVSNF9JRCA9IFVJX1JFQURZX0RJQUxPR19IRUFERVI0X0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBSRUFEWV9IRUFERVI1X0lEID0gVUlfUkVBRFlfRElBTE9HX0hFQURFUjVfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IFJFQURZX0hFQURFUjZfSUQgPSBVSV9SRUFEWV9ESUFMT0dfSEVBREVSNl9JRCArIHBsYXllcklkOwoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgUkVBRFlfSEVBREVSX0lELAogICAgICAgIC8vSWYgQW5jaG9yZWQgYXQgVG9wTGVmdCwgWCBpcyBsZWZ0IG9mZnNldCAtIGluY3JlYXNlIHRvIG1vdmUgcmlnaHQsIFkgaXMgZG93biBvZmZzZXQgLSBpbmNyZWFzZSB0byBtb3ZlIGRvd24KICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0xMSwgLTUsIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoOTAwLCAyMiwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmhlYWRlciksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBSRUFEWV9IRUFERVIgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoUkVBRFlfSEVBREVSX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShSRUFEWV9IRUFERVIsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoUkVBRFlfSEVBREVSLCAyMCk7CiAgICBhcHBseVJlYWR5RGlhbG9nTGFiZWxUZXh0Q29sb3IoUkVBRFlfSEVBREVSKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChSRUFEWV9IRUFERVIsIENPTlRBSU5FUl9CQVNFKTsKCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIFJFQURZX0hFQURFUjJfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtMTEsIDE5LCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDkwMCwgMjAsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5oZWFkZXIyKSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IFJFQURZX0hFQURFUjIgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoUkVBRFlfSEVBREVSMl9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoUkVBRFlfSEVBREVSMiwgMCk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShSRUFEWV9IRUFERVIyLCAxNik7CiAgICBhcHBseVJlYWR5RGlhbG9nTGFiZWxUZXh0Q29sb3IoUkVBRFlfSEVBREVSMik7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoUkVBRFlfSEVBREVSMiwgQ09OVEFJTkVSX0JBU0UpOwoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgUkVBRFlfSEVBREVSM19JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0xMSwgMzksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoOTAwLCAyMCwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmhlYWRlcjMpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgUkVBRFlfSEVBREVSMyA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShSRUFEWV9IRUFERVIzX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShSRUFEWV9IRUFERVIzLCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKFJFQURZX0hFQURFUjMsIDE2KTsKICAgIGFwcGx5UmVhZHlEaWFsb2dMYWJlbFRleHRDb2xvcihSRUFEWV9IRUFERVIzKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChSRUFEWV9IRUFERVIzLCBDT05UQUlORVJfQkFTRSk7CgogICAgLy8gSGVhZGVyIDQgcHJlc2VydmVzIHRoZSBzYW1lIHZlcnRpY2FsIHNwYWNpbmcgYXMgaGVhZGVyIDIgLT4gaGVhZGVyIDMuCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIFJFQURZX0hFQURFUjRfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtMTEsIDU5LCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDkwMCwgMjAsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5oZWFkZXI0LCBNYXRoLmZsb29yKFZFSElDTEVfU1BBV05FUl9LRUVQX0FMSVZFX0FCQU5ET05fUkFESVVTKSksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBSRUFEWV9IRUFERVI0ID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFJFQURZX0hFQURFUjRfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKFJFQURZX0hFQURFUjQsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoUkVBRFlfSEVBREVSNCwgMTYpOwogICAgYXBwbHlSZWFkeURpYWxvZ0xhYmVsVGV4dENvbG9yKFJFQURZX0hFQURFUjQpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFJFQURZX0hFQURFUjQsIENPTlRBSU5FUl9CQVNFKTsKCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIFJFQURZX0hFQURFUjVfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtMTEsIDc5LCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDkwMCwgMjAsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5oZWFkZXI1KSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IFJFQURZX0hFQURFUjUgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoUkVBRFlfSEVBREVSNV9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoUkVBRFlfSEVBREVSNSwgMCk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShSRUFEWV9IRUFERVI1LCAxNik7CiAgICBhcHBseVJlYWR5RGlhbG9nTGFiZWxUZXh0Q29sb3IoUkVBRFlfSEVBREVSNSk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoUkVBRFlfSEVBREVSNSwgQ09OVEFJTkVSX0JBU0UpOwoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgUkVBRFlfSEVBREVSNl9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0xMSwgOTksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoOTAwLCAyMCwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmhlYWRlcjYpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgUkVBRFlfSEVBREVSNiA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShSRUFEWV9IRUFERVI2X0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShSRUFEWV9IRUFERVI2LCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKFJFQURZX0hFQURFUjYsIDE2KTsKICAgIGFwcGx5UmVhZHlEaWFsb2dMYWJlbFRleHRDb2xvcihSRUFEWV9IRUFERVI2KTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChSRUFEWV9IRUFERVI2LCBDT05UQUlORVJfQkFTRSk7CgogICAgY29uc3QgUkVBRFlfTUFQX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01BUF9MQUJFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgUkVBRFlfTUFQX1ZBTFVFX0lEID0gVUlfUkVBRFlfRElBTE9HX01BUF9WQUxVRV9JRCArIHBsYXllcklkOwogICAgY29uc3QgbWFwTGFiZWxYID0gQURNSU5fUEFORUxfT0ZGU0VUX1ggKyBBRE1JTl9QQU5FTF9UT0dHTEVfV0lEVEggKyA3MDsKICAgIGNvbnN0IG1hcFZhbHVlWCA9IEFETUlOX1BBTkVMX09GRlNFVF9YICsgQURNSU5fUEFORUxfVE9HR0xFX1dJRFRIIC0gNjM7IC8vLVggbW92ZXMgcmlnaHQKICAgIGNvbnN0IG1hcExhYmVsWSA9IEFETUlOX1BBTkVMX09GRlNFVF9ZOwogICAgY29uc3QgbWFwTGFiZWxTaXplWCA9IDYwOwogICAgY29uc3QgbWFwVmFsdWVTaXplWCA9IDE3MDsKCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIFJFQURZX01BUF9MQUJFTF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKG1hcExhYmVsWCwgbWFwTGFiZWxZLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKG1hcExhYmVsU2l6ZVgsIDIwLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLm1hcExhYmVsKSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IFJFQURZX01BUF9MQUJFTCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShSRUFEWV9NQVBfTEFCRUxfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKFJFQURZX01BUF9MQUJFTCwgMCk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShSRUFEWV9NQVBfTEFCRUwsIDEyKTsKICAgIGFwcGx5UmVhZHlEaWFsb2dMYWJlbFRleHRDb2xvcihSRUFEWV9NQVBfTEFCRUwpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFJFQURZX01BUF9MQUJFTCwgbW9kLkdldFVJUm9vdCgpKTsKCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIFJFQURZX01BUF9WQUxVRV9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKG1hcFZhbHVlWCwgbWFwTGFiZWxZLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKG1hcFZhbHVlU2l6ZVgsIDIwLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgbW9kLk1lc3NhZ2UoZ2V0TWFwTmFtZUtleShBQ1RJVkVfTUFQX0tFWSkpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgUkVBRFlfTUFQX1ZBTFVFID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFJFQURZX01BUF9WQUxVRV9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoUkVBRFlfTUFQX1ZBTFVFLCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKFJFQURZX01BUF9WQUxVRSwgMTIpOwogICAgYXBwbHlSZWFkeURpYWxvZ0xhYmVsVGV4dENvbG9yKFJFQURZX01BUF9WQUxVRSk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoUkVBRFlfTUFQX1ZBTFVFLCBtb2QuR2V0VUlSb290KCkpOwogICAgdXBkYXRlUmVhZHlEaWFsb2dNYXBMYWJlbEZvclBpZChwbGF5ZXJJZCk7CgogICAgLy8gQmVzdC1vZiByb3VuZHMgY29udHJvbCAodG9wLXJpZ2h0KTogbWludXMgYnV0dG9uLCBkeW5hbWljIGxhYmVsLCBwbHVzIGJ1dHRvbi4KICAgIGNvbnN0IEJFU1RPRl9ERUNfSUQgPSBVSV9SRUFEWV9ESUFMT0dfQkVTVE9GX0RFQ19JRCArIHBsYXllcklkOwogICAgY29uc3QgQkVTVE9GX0RFQ19MQUJFTF9JRCA9IFVJX1JFQURZX0RJQUxPR19CRVNUT0ZfREVDX0xBQkVMX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBCRVNUT0ZfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfQkVTVE9GX0xBQkVMX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBCRVNUT0ZfSU5DX0lEID0gVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IEJFU1RPRl9JTkNfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfQkVTVE9GX0lOQ19MQUJFTF9JRCArIHBsYXllcklkOwoKICAgIGNvbnN0IGJlc3RPZlkgPSAtMzsKICAgIGNvbnN0IGJlc3RPZkJ1dHRvblNpemVYID0gUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9XSURUSDsKICAgIGNvbnN0IGJlc3RPZkJ1dHRvblNpemVZID0gUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9IRUlHSFQ7CiAgICBjb25zdCBiZXN0T2ZMYWJlbFNpemVYID0gMTcwOwogICAgY29uc3QgYmVzdE9mTGFiZWxTaXplWSA9IDI0OwogICAgY29uc3QgbGVmdFNlY3Rpb25HYXBYID0gUkVBRFlfRElBTE9HX1NNQUxMX0JVVFRPTl9XSURUSCArIDEyOwogICAgY29uc3QgbGVmdFNlY3Rpb25CdXR0b25TcHJlYWQgPSAxODsKICAgIGNvbnN0IGxlZnRTZWN0aW9uU2hpZnRYID0gMTI4ICsgbGVmdFNlY3Rpb25HYXBYICsgbGVmdFNlY3Rpb25CdXR0b25TcHJlYWQ7CiAgICBjb25zdCBsZWZ0U2VjdGlvbkxlZnRCdXR0b25YID0gMTI1ICsgbGVmdFNlY3Rpb25TaGlmdFggKyBsZWZ0U2VjdGlvbkJ1dHRvblNwcmVhZDsKICAgIGNvbnN0IGxlZnRTZWN0aW9uUmlnaHRCdXR0b25YID0gLTMgKyBsZWZ0U2VjdGlvblNoaWZ0WCAtIGxlZnRTZWN0aW9uQnV0dG9uU3ByZWFkOwogICAgY29uc3QgbGVmdFNlY3Rpb25WYWx1ZVggPSAtNTggKyBsZWZ0U2VjdGlvblNoaWZ0WDsKICAgIGNvbnN0IGxlZnRTZWN0aW9uTGFiZWxHYXAgPSA0OwogICAgY29uc3QgbGVmdFNlY3Rpb25MYWJlbFggPSBsZWZ0U2VjdGlvbkxlZnRCdXR0b25YICsgYmVzdE9mQnV0dG9uU2l6ZVggKyBsZWZ0U2VjdGlvbkxhYmVsR2FwOwogICAgY29uc3QgbGVmdFNlY3Rpb25MYWJlbFdpZHRoID0gMTEwOwogICAgY29uc3QgbGVmdFNlY3Rpb25WYWx1ZVdpZHRoID0gMjAwOwogICAgY29uc3QgbGVmdFNlY3Rpb25Sb3dHYXAgPSBiZXN0T2ZCdXR0b25TaXplWSArIDY7CiAgICBjb25zdCByaWdodFNlY3Rpb25SaWdodEJ1dHRvblggPSAtMzsKICAgIGNvbnN0IGNvbmZpcm1CdXR0b25XaWR0aCA9IFJFQURZX0RJQUxPR19DT05GSVJNX0JVVFRPTl9XSURUSDsKICAgIGNvbnN0IHJlc2V0QnV0dG9uV2lkdGggPSBSRUFEWV9ESUFMT0dfUkVTRVRfQlVUVE9OX1dJRFRIOwogICAgY29uc3QgcmVzZXRCdXR0b25YID0gcmlnaHRTZWN0aW9uUmlnaHRCdXR0b25YICsgUkVBRFlfRElBTE9HX1JFU0VUX0JVVFRPTl9PRkZTRVRfWDsKICAgIGNvbnN0IGNvbmZpcm1CdXR0b25YID0gcmVzZXRCdXR0b25YICsgcmVzZXRCdXR0b25XaWR0aCArIFJFQURZX0RJQUxPR19DT05GSVJNX0JVVFRPTl9HQVA7CgogICAgY29uc3QgR0FNRV9NT0RFX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfR0FNRV9MQUJFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgR0FNRV9NT0RFX0RFQ19JRCA9IFVJX1JFQURZX0RJQUxPR19NT0RFX0dBTUVfREVDX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBHQU1FX01PREVfREVDX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfR0FNRV9ERUNfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IEdBTUVfTU9ERV9WQUxVRV9JRCA9IFVJX1JFQURZX0RJQUxPR19NT0RFX0dBTUVfVkFMVUVfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IEdBTUVfTU9ERV9JTkNfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9HQU1FX0lOQ19JRCArIHBsYXllcklkOwogICAgY29uc3QgR0FNRV9NT0RFX0lOQ19MQUJFTF9JRCA9IFVJX1JFQURZX0RJQUxPR19NT0RFX0dBTUVfSU5DX0xBQkVMX0lEICsgcGxheWVySWQ7CgogICAgY29uc3QgTU9ERV9TRVRUSU5HU19MQUJFTF9JRCA9IFVJX1JFQURZX0RJQUxPR19NT0RFX1NFVFRJTkdTX0xBQkVMX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBNT0RFX1NFVFRJTkdTX0RFQ19JRCA9IFVJX1JFQURZX0RJQUxPR19NT0RFX1NFVFRJTkdTX0RFQ19JRCArIHBsYXllcklkOwogICAgY29uc3QgTU9ERV9TRVRUSU5HU19ERUNfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19ERUNfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IE1PREVfU0VUVElOR1NfVkFMVUVfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19WQUxVRV9JRCArIHBsYXllcklkOwogICAgY29uc3QgTU9ERV9TRVRUSU5HU19JTkNfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19JTkNfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IE1PREVfU0VUVElOR1NfSU5DX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfU0VUVElOR1NfSU5DX0xBQkVMX0lEICsgcGxheWVySWQ7CgogICAgY29uc3QgVkVISUNMRVNfVDFfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMV9MQUJFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgVkVISUNMRVNfVDFfREVDX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfREVDX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBWRUhJQ0xFU19UMV9ERUNfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMV9ERUNfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IFZFSElDTEVTX1QxX1ZBTFVFX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfVkFMVUVfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IFZFSElDTEVTX1QxX0lOQ19JRCA9IFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QxX0lOQ19JRCArIHBsYXllcklkOwogICAgY29uc3QgVkVISUNMRVNfVDFfSU5DX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfSU5DX0xBQkVMX0lEICsgcGxheWVySWQ7CgogICAgY29uc3QgVkVISUNMRVNfVDJfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMl9MQUJFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgVkVISUNMRVNfVDJfREVDX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDJfREVDX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBWRUhJQ0xFU19UMl9ERUNfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMl9ERUNfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IFZFSElDTEVTX1QyX1ZBTFVFX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDJfVkFMVUVfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IFZFSElDTEVTX1QyX0lOQ19JRCA9IFVJX1JFQURZX0RJQUxPR19NT0RFX1ZFSElDTEVTX1QyX0lOQ19JRCArIHBsYXllcklkOwogICAgY29uc3QgVkVISUNMRVNfVDJfSU5DX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDJfSU5DX0xBQkVMX0lEICsgcGxheWVySWQ7CgogICAgY29uc3QgTU9ERV9DT05GSVJNX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfQ09ORklSTV9JRCArIHBsYXllcklkOwogICAgY29uc3QgTU9ERV9DT05GSVJNX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfQ09ORklSTV9MQUJFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgTU9ERV9SRVNFVF9JRCA9IFVJX1JFQURZX0RJQUxPR19NT0RFX1JFU0VUX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBNT0RFX1JFU0VUX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01PREVfUkVTRVRfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKCiAgICBjb25zdCBnYW1lTW9kZVkgPSBiZXN0T2ZZOwogICAgY29uc3QgbW9kZVNldHRpbmdzWSA9IGdhbWVNb2RlWSArIGxlZnRTZWN0aW9uUm93R2FwOwogICAgY29uc3QgdmVoaWNsZXNUMVkgPSBtb2RlU2V0dGluZ3NZICsgbGVmdFNlY3Rpb25Sb3dHYXA7CiAgICBjb25zdCB2ZWhpY2xlc1QyWSA9IHZlaGljbGVzVDFZICsgbGVmdFNlY3Rpb25Sb3dHYXA7CiAgICBjb25zdCBjb25maXJtWSA9IHZlaGljbGVzVDJZICsgbGVmdFNlY3Rpb25Sb3dHYXAgKyA0OwoKICAgIGFkZFJpZ2h0QWxpZ25lZExhYmVsKAogICAgICAgIEdBTUVfTU9ERV9MQUJFTF9JRCwKICAgICAgICBsZWZ0U2VjdGlvbkxhYmVsWCwKICAgICAgICBnYW1lTW9kZVksCiAgICAgICAgbGVmdFNlY3Rpb25MYWJlbFdpZHRoLAogICAgICAgIGJlc3RPZkxhYmVsU2l6ZVksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5nYW1lTW9kZUxhYmVsKSwKICAgICAgICBldmVudFBsYXllciwKICAgICAgICBDT05UQUlORVJfQkFTRSwKICAgICAgICAxMgogICAgKTsKCiAgICBjb25zdCBnYW1lTW9kZURlY0JvcmRlciA9IGFkZE91dGxpbmVkQnV0dG9uKAogICAgICAgIEdBTUVfTU9ERV9ERUNfSUQsCiAgICAgICAgbGVmdFNlY3Rpb25MZWZ0QnV0dG9uWCwKICAgICAgICBnYW1lTW9kZVksCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVgsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIENPTlRBSU5FUl9CQVNFLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgR0FNRV9NT0RFX0RFQ19MQUJFTCA9IGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBHQU1FX01PREVfREVDX0xBQkVMX0lELAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVYLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC51aS5sZWZ0KSwKICAgICAgICBldmVudFBsYXllciwKICAgICAgICBnYW1lTW9kZURlY0JvcmRlciA/PyBDT05UQUlORVJfQkFTRQogICAgKTsKICAgIGlmIChHQU1FX01PREVfREVDX0xBQkVMKSB7CiAgICAgICAgbW9kLlNldFVJVGV4dFNpemUoR0FNRV9NT0RFX0RFQ19MQUJFTCwgMTQpOwogICAgfQoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgR0FNRV9NT0RFX1ZBTFVFX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IobGVmdFNlY3Rpb25WYWx1ZVgsIGdhbWVNb2RlWSwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihsZWZ0U2VjdGlvblZhbHVlV2lkdGgsIGJlc3RPZkxhYmVsU2l6ZVksIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLmdhbWVNb2RlKSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IEdBTUVfTU9ERV9WQUxVRSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShHQU1FX01PREVfVkFMVUVfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKEdBTUVfTU9ERV9WQUxVRSwgMCk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShHQU1FX01PREVfVkFMVUUsIDEyKTsKICAgIGFwcGx5UmVhZHlEaWFsb2dMYWJlbFRleHRDb2xvcihHQU1FX01PREVfVkFMVUUpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KEdBTUVfTU9ERV9WQUxVRSwgQ09OVEFJTkVSX0JBU0UpOwoKICAgIGNvbnN0IGdhbWVNb2RlSW5jQm9yZGVyID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgR0FNRV9NT0RFX0lOQ19JRCwKICAgICAgICBsZWZ0U2VjdGlvblJpZ2h0QnV0dG9uWCwKICAgICAgICBnYW1lTW9kZVksCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVgsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIENPTlRBSU5FUl9CQVNFLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgR0FNRV9NT0RFX0lOQ19MQUJFTCA9IGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBHQU1FX01PREVfSU5DX0xBQkVMX0lELAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVYLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC51aS5yaWdodCksCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgZ2FtZU1vZGVJbmNCb3JkZXIgPz8gQ09OVEFJTkVSX0JBU0UKICAgICk7CiAgICBpZiAoR0FNRV9NT0RFX0lOQ19MQUJFTCkgewogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKEdBTUVfTU9ERV9JTkNfTEFCRUwsIDE0KTsKICAgIH0KCiAgICBhZGRSaWdodEFsaWduZWRMYWJlbCgKICAgICAgICBNT0RFX1NFVFRJTkdTX0xBQkVMX0lELAogICAgICAgIGxlZnRTZWN0aW9uTGFiZWxYLAogICAgICAgIG1vZGVTZXR0aW5nc1ksCiAgICAgICAgbGVmdFNlY3Rpb25MYWJlbFdpZHRoLAogICAgICAgIGJlc3RPZkxhYmVsU2l6ZVksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5tb2RlU2V0dGluZ3NMYWJlbCksCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgMTIKICAgICk7CgogICAgY29uc3QgbW9kZVNldHRpbmdzRGVjQm9yZGVyID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgTU9ERV9TRVRUSU5HU19ERUNfSUQsCiAgICAgICAgbGVmdFNlY3Rpb25MZWZ0QnV0dG9uWCwKICAgICAgICBtb2RlU2V0dGluZ3NZLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVYLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBDT05UQUlORVJfQkFTRSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IE1PREVfU0VUVElOR1NfREVDX0xBQkVMID0gYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIE1PREVfU0VUVElOR1NfREVDX0xBQkVMX0lELAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVYLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC51aS5sZWZ0KSwKICAgICAgICBldmVudFBsYXllciwKICAgICAgICBtb2RlU2V0dGluZ3NEZWNCb3JkZXIgPz8gQ09OVEFJTkVSX0JBU0UKICAgICk7CiAgICBpZiAoTU9ERV9TRVRUSU5HU19ERUNfTEFCRUwpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShNT0RFX1NFVFRJTkdTX0RFQ19MQUJFTCwgMTQpOwogICAgfQoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgTU9ERV9TRVRUSU5HU19WQUxVRV9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKGxlZnRTZWN0aW9uVmFsdWVYLCBtb2RlU2V0dGluZ3NZLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKGxlZnRTZWN0aW9uVmFsdWVXaWR0aCwgYmVzdE9mTGFiZWxTaXplWSwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5tb2RlU2V0dGluZ0FpcmNyYWZ0Q2VpbGluZ0Zvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLmFpcmNyYWZ0Q2VpbGluZykpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgTU9ERV9TRVRUSU5HU19WQUxVRSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShNT0RFX1NFVFRJTkdTX1ZBTFVFX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShNT0RFX1NFVFRJTkdTX1ZBTFVFLCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKE1PREVfU0VUVElOR1NfVkFMVUUsIDEyKTsKICAgIGFwcGx5UmVhZHlEaWFsb2dMYWJlbFRleHRDb2xvcihNT0RFX1NFVFRJTkdTX1ZBTFVFKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChNT0RFX1NFVFRJTkdTX1ZBTFVFLCBDT05UQUlORVJfQkFTRSk7CgogICAgY29uc3QgbW9kZVNldHRpbmdzSW5jQm9yZGVyID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgTU9ERV9TRVRUSU5HU19JTkNfSUQsCiAgICAgICAgbGVmdFNlY3Rpb25SaWdodEJ1dHRvblgsCiAgICAgICAgbW9kZVNldHRpbmdzWSwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBNT0RFX1NFVFRJTkdTX0lOQ19MQUJFTCA9IGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBNT0RFX1NFVFRJTkdTX0lOQ19MQUJFTF9JRCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudWkucmlnaHQpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIG1vZGVTZXR0aW5nc0luY0JvcmRlciA/PyBDT05UQUlORVJfQkFTRQogICAgKTsKICAgIGlmIChNT0RFX1NFVFRJTkdTX0lOQ19MQUJFTCkgewogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKE1PREVfU0VUVElOR1NfSU5DX0xBQkVMLCAxNCk7CiAgICB9CgogICAgYWRkUmlnaHRBbGlnbmVkTGFiZWwoCiAgICAgICAgVkVISUNMRVNfVDFfTEFCRUxfSUQsCiAgICAgICAgbGVmdFNlY3Rpb25MYWJlbFgsCiAgICAgICAgdmVoaWNsZXNUMVksCiAgICAgICAgbGVmdFNlY3Rpb25MYWJlbFdpZHRoLAogICAgICAgIGJlc3RPZkxhYmVsU2l6ZVksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy52ZWhpY2xlc0xhYmVsRm9ybWF0LCBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTEpKSwKICAgICAgICBldmVudFBsYXllciwKICAgICAgICBDT05UQUlORVJfQkFTRSwKICAgICAgICAxMgogICAgKTsKCiAgICBjb25zdCB2ZWhpY2xlc1QxRGVjQm9yZGVyID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgVkVISUNMRVNfVDFfREVDX0lELAogICAgICAgIGxlZnRTZWN0aW9uTGVmdEJ1dHRvblgsCiAgICAgICAgdmVoaWNsZXNUMVksCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVgsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIENPTlRBSU5FUl9CQVNFLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgVkVISUNMRVNfVDFfREVDX0xBQkVMID0gYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIFZFSElDTEVTX1QxX0RFQ19MQUJFTF9JRCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudWkubGVmdCksCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgdmVoaWNsZXNUMURlY0JvcmRlciA/PyBDT05UQUlORVJfQkFTRQogICAgKTsKICAgIGlmIChWRUhJQ0xFU19UMV9ERUNfTEFCRUwpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShWRUhJQ0xFU19UMV9ERUNfTEFCRUwsIDE0KTsKICAgIH0KCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIFZFSElDTEVTX1QxX1ZBTFVFX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IobGVmdFNlY3Rpb25WYWx1ZVgsIHZlaGljbGVzVDFZLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKGxlZnRTZWN0aW9uVmFsdWVXaWR0aCwgYmVzdE9mTGFiZWxTaXplWSwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIG1vZC5NZXNzYWdlKFN0YXRlLnJvdW5kLm1vZGVDb25maWcudmVoaWNsZXNUMSksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBWRUhJQ0xFU19UMV9WQUxVRSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShWRUhJQ0xFU19UMV9WQUxVRV9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoVkVISUNMRVNfVDFfVkFMVUUsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoVkVISUNMRVNfVDFfVkFMVUUsIDEyKTsKICAgIGFwcGx5UmVhZHlEaWFsb2dMYWJlbFRleHRDb2xvcihWRUhJQ0xFU19UMV9WQUxVRSk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoVkVISUNMRVNfVDFfVkFMVUUsIENPTlRBSU5FUl9CQVNFKTsKCiAgICBjb25zdCB2ZWhpY2xlc1QxSW5jQm9yZGVyID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgVkVISUNMRVNfVDFfSU5DX0lELAogICAgICAgIGxlZnRTZWN0aW9uUmlnaHRCdXR0b25YLAogICAgICAgIHZlaGljbGVzVDFZLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVYLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBDT05UQUlORVJfQkFTRSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IFZFSElDTEVTX1QxX0lOQ19MQUJFTCA9IGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBWRUhJQ0xFU19UMV9JTkNfTEFCRUxfSUQsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVgsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnVpLnJpZ2h0KSwKICAgICAgICBldmVudFBsYXllciwKICAgICAgICB2ZWhpY2xlc1QxSW5jQm9yZGVyID8/IENPTlRBSU5FUl9CQVNFCiAgICApOwogICAgaWYgKFZFSElDTEVTX1QxX0lOQ19MQUJFTCkgewogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKFZFSElDTEVTX1QxX0lOQ19MQUJFTCwgMTQpOwogICAgfQoKICAgIGFkZFJpZ2h0QWxpZ25lZExhYmVsKAogICAgICAgIFZFSElDTEVTX1QyX0xBQkVMX0lELAogICAgICAgIGxlZnRTZWN0aW9uTGFiZWxYLAogICAgICAgIHZlaGljbGVzVDJZLAogICAgICAgIGxlZnRTZWN0aW9uTGFiZWxXaWR0aCwKICAgICAgICBiZXN0T2ZMYWJlbFNpemVZLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cudmVoaWNsZXNMYWJlbEZvcm1hdCwgZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0yKSksCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgMTIKICAgICk7CgogICAgY29uc3QgdmVoaWNsZXNUMkRlY0JvcmRlciA9IGFkZE91dGxpbmVkQnV0dG9uKAogICAgICAgIFZFSElDTEVTX1QyX0RFQ19JRCwKICAgICAgICBsZWZ0U2VjdGlvbkxlZnRCdXR0b25YLAogICAgICAgIHZlaGljbGVzVDJZLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVYLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBDT05UQUlORVJfQkFTRSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IFZFSElDTEVTX1QyX0RFQ19MQUJFTCA9IGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBWRUhJQ0xFU19UMl9ERUNfTEFCRUxfSUQsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVgsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnVpLmxlZnQpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIHZlaGljbGVzVDJEZWNCb3JkZXIgPz8gQ09OVEFJTkVSX0JBU0UKICAgICk7CiAgICBpZiAoVkVISUNMRVNfVDJfREVDX0xBQkVMKSB7CiAgICAgICAgbW9kLlNldFVJVGV4dFNpemUoVkVISUNMRVNfVDJfREVDX0xBQkVMLCAxNCk7CiAgICB9CgogICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICBWRUhJQ0xFU19UMl9WQUxVRV9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKGxlZnRTZWN0aW9uVmFsdWVYLCB2ZWhpY2xlc1QyWSwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihsZWZ0U2VjdGlvblZhbHVlV2lkdGgsIGJlc3RPZkxhYmVsU2l6ZVksIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVzVDIpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgVkVISUNMRVNfVDJfVkFMVUUgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoVkVISUNMRVNfVDJfVkFMVUVfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKFZFSElDTEVTX1QyX1ZBTFVFLCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKFZFSElDTEVTX1QyX1ZBTFVFLCAxMik7CiAgICBhcHBseVJlYWR5RGlhbG9nTGFiZWxUZXh0Q29sb3IoVkVISUNMRVNfVDJfVkFMVUUpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFZFSElDTEVTX1QyX1ZBTFVFLCBDT05UQUlORVJfQkFTRSk7CgogICAgY29uc3QgdmVoaWNsZXNUMkluY0JvcmRlciA9IGFkZE91dGxpbmVkQnV0dG9uKAogICAgICAgIFZFSElDTEVTX1QyX0lOQ19JRCwKICAgICAgICBsZWZ0U2VjdGlvblJpZ2h0QnV0dG9uWCwKICAgICAgICB2ZWhpY2xlc1QyWSwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBWRUhJQ0xFU19UMl9JTkNfTEFCRUwgPSBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgVkVISUNMRVNfVDJfSU5DX0xBQkVMX0lELAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVYLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC51aS5yaWdodCksCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgdmVoaWNsZXNUMkluY0JvcmRlciA/PyBDT05UQUlORVJfQkFTRQogICAgKTsKICAgIGlmIChWRUhJQ0xFU19UMl9JTkNfTEFCRUwpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShWRUhJQ0xFU19UMl9JTkNfTEFCRUwsIDE0KTsKICAgIH0KCiAgICBjb25zdCBjb25maXJtQm9yZGVyID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgTU9ERV9DT05GSVJNX0lELAogICAgICAgIGNvbmZpcm1CdXR0b25YLAogICAgICAgIGNvbmZpcm1ZLAogICAgICAgIGNvbmZpcm1CdXR0b25XaWR0aCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBNT0RFX0NPTkZJUk1fTEFCRUwgPSBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgTU9ERV9DT05GSVJNX0xBQkVMX0lELAogICAgICAgIGNvbmZpcm1CdXR0b25XaWR0aCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuY29uZmlybVNldHRpbmdzTGFiZWwpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIGNvbmZpcm1Cb3JkZXIgPz8gQ09OVEFJTkVSX0JBU0UKICAgICk7CiAgICBpZiAoTU9ERV9DT05GSVJNX0xBQkVMKSB7CiAgICAgICAgbW9kLlNldFVJVGV4dFNpemUoTU9ERV9DT05GSVJNX0xBQkVMLCAxMik7CiAgICB9CgogICAgY29uc3QgcmVzZXRCb3JkZXIgPSBhZGRPdXRsaW5lZEJ1dHRvbigKICAgICAgICBNT0RFX1JFU0VUX0lELAogICAgICAgIHJlc2V0QnV0dG9uWCwKICAgICAgICBjb25maXJtWSwKICAgICAgICByZXNldEJ1dHRvbldpZHRoLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBDT05UQUlORVJfQkFTRSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IE1PREVfUkVTRVRfTEFCRUwgPSBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgTU9ERV9SRVNFVF9MQUJFTF9JRCwKICAgICAgICByZXNldEJ1dHRvbldpZHRoLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5yZXNldFNldHRpbmdzTGFiZWwpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIHJlc2V0Qm9yZGVyID8/IENPTlRBSU5FUl9CQVNFCiAgICApOwogICAgaWYgKE1PREVfUkVTRVRfTEFCRUwpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShNT0RFX1JFU0VUX0xBQkVMLCAxMik7CiAgICB9CgogICAgLy8gQmVzdC1vZjogbWludXMgYnV0dG9uIChsZWZ0IG9mIGxhYmVsKQogICAgY29uc3QgYmVzdE9mRGVjQm9yZGVyID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgQkVTVE9GX0RFQ19JRCwKICAgICAgICAxMjUsCiAgICAgICAgYmVzdE9mWSwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CgogICAgLy8gQmVzdC1vZjogbWludXMgbGFiZWwgKGxlZnQgb2YgbGFiZWwpCiAgICBjb25zdCBCRVNUT0ZfREVDX0xBQkVMID0gYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIEJFU1RPRl9ERUNfTEFCRUxfSUQsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVgsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnVpLm1pbnVzKSwKICAgICAgICBldmVudFBsYXllciwKICAgICAgICBiZXN0T2ZEZWNCb3JkZXIgPz8gQ09OVEFJTkVSX0JBU0UKICAgICk7CiAgICBpZiAoQkVTVE9GX0RFQ19MQUJFTCkgewogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKEJFU1RPRl9ERUNfTEFCRUwsIDE0KTsKICAgIH0KCiAgICAvLyBCZXN0LW9mOiBkeW5hbWljIGxhYmVsCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIEJFU1RPRl9MQUJFTF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC00MiwgYmVzdE9mWSwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihiZXN0T2ZMYWJlbFNpemVYLCBiZXN0T2ZMYWJlbFNpemVZLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJlc3RPZkxhYmVsLCBTdGF0ZS5yb3VuZC5tYXgpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgQkVTVE9GX0xBQkVMID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKEJFU1RPRl9MQUJFTF9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoQkVTVE9GX0xBQkVMLCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKEJFU1RPRl9MQUJFTCwgMTQpOwogICAgYXBwbHlSZWFkeURpYWxvZ0xhYmVsVGV4dENvbG9yKEJFU1RPRl9MQUJFTCk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoQkVTVE9GX0xBQkVMLCBDT05UQUlORVJfQkFTRSk7CgogICAgLy8gQmVzdC1vZjogcGx1cyBidXR0b24gKHJpZ2h0IG9mIGxhYmVsKQogICAgY29uc3QgYmVzdE9mSW5jQm9yZGVyID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgQkVTVE9GX0lOQ19JRCwKICAgICAgICAtMywKICAgICAgICBiZXN0T2ZZLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVYLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBDT05UQUlORVJfQkFTRSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKCiAgICAvLyBCZXN0LW9mOiBwbHVzIGxhYmVsIChyaWdodCBvZiBsYWJlbCkKICAgIGNvbnN0IEJFU1RPRl9JTkNfTEFCRUwgPSBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgQkVTVE9GX0lOQ19MQUJFTF9JRCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudWkucGx1cyksCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgYmVzdE9mSW5jQm9yZGVyID8/IENPTlRBSU5FUl9CQVNFCiAgICApOwogICAgaWYgKEJFU1RPRl9JTkNfTEFCRUwpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShCRVNUT0ZfSU5DX0xBQkVMLCAxNCk7CiAgICB9CiAgICB1cGRhdGVCZXN0T2ZSb3VuZHNMYWJlbEZvclBpZChwbGF5ZXJJZCk7CgogICAgLy8gTWF0Y2h1cCBwcmVzZXQgY29udHJvbCAoYmVsb3cgQmVzdC1vZik6IG1pbnVzIGJ1dHRvbiwgZHluYW1pYyBsYWJlbCwgcGx1cyBidXR0b24uCiAgICBjb25zdCBNQVRDSFVQX0RFQ19JRCA9IFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0RFQ19JRCArIHBsYXllcklkOwogICAgY29uc3QgTUFUQ0hVUF9ERUNfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9ERUNfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IE1BVENIVVBfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9MQUJFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgTUFUQ0hVUF9JTkNfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9JTkNfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IE1BVENIVVBfSU5DX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01BVENIVVBfSU5DX0xBQkVMX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBNQVRDSFVQX01JTlBMQVlFUlNfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9NSU5QTEFZRVJTX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBNQVRDSFVQX01JTlBMQVlFUlNfVE9UQUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9NSU5QTEFZRVJTX1RPVEFMX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBNQVRDSFVQX0tJTExTVEFSR0VUX0lEID0gVUlfUkVBRFlfRElBTE9HX01BVENIVVBfS0lMTFNUQVJHRVRfSUQgKyBwbGF5ZXJJZDsKCiAgICBjb25zdCBtYXRjaHVwWSA9IGJlc3RPZlkgKyBiZXN0T2ZCdXR0b25TaXplWSArIDQ7CiAgICBjb25zdCBtYXRjaHVwTGFiZWxTaXplWCA9IGJlc3RPZkxhYmVsU2l6ZVggKyAzMDsKICAgIGNvbnN0IG1hdGNodXBMYWJlbE9mZnNldFggPSAtNzI7CgogICAgLy8gTWF0Y2h1cDogbWludXMgYnV0dG9uIChsZWZ0IG9mIGxhYmVsKQogICAgY29uc3QgbWF0Y2h1cERlY0JvcmRlciA9IGFkZE91dGxpbmVkQnV0dG9uKAogICAgICAgIE1BVENIVVBfREVDX0lELAogICAgICAgIDEyNSwKICAgICAgICBtYXRjaHVwWSwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CgogICAgLy8gTWF0Y2h1cDogbWludXMgbGFiZWwKICAgIGNvbnN0IE1BVENIVVBfREVDX0xBQkVMID0gYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIE1BVENIVVBfREVDX0xBQkVMX0lELAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVYLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC51aS5taW51cyksCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgbWF0Y2h1cERlY0JvcmRlciA/PyBDT05UQUlORVJfQkFTRQogICAgKTsKICAgIGlmIChNQVRDSFVQX0RFQ19MQUJFTCkgewogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKE1BVENIVVBfREVDX0xBQkVMLCAxNCk7CiAgICB9CgogICAgLy8gTWF0Y2h1cDogZHluYW1pYyBsYWJlbAogICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICBNQVRDSFVQX0xBQkVMX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IobWF0Y2h1cExhYmVsT2Zmc2V0WCwgbWF0Y2h1cFksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IobWF0Y2h1cExhYmVsU2l6ZVgsIGJlc3RPZkxhYmVsU2l6ZVksIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cubWF0Y2h1cEZvcm1hdCwgMSwgMCksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBNQVRDSFVQX0xBQkVMID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKE1BVENIVVBfTEFCRUxfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKE1BVENIVVBfTEFCRUwsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoTUFUQ0hVUF9MQUJFTCwgMTQpOwogICAgYXBwbHlSZWFkeURpYWxvZ0xhYmVsVGV4dENvbG9yKE1BVENIVVBfTEFCRUwpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KE1BVENIVVBfTEFCRUwsIENPTlRBSU5FUl9CQVNFKTsKCiAgICAvLyBNYXRjaHVwOiBwbHVzIGJ1dHRvbiAocmlnaHQgb2YgbGFiZWwpCiAgICBjb25zdCBtYXRjaHVwSW5jQm9yZGVyID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgTUFUQ0hVUF9JTkNfSUQsCiAgICAgICAgLTMsCiAgICAgICAgbWF0Y2h1cFksCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVgsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIENPTlRBSU5FUl9CQVNFLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwoKICAgIC8vIE1hdGNodXA6IHBsdXMgbGFiZWwgKHJpZ2h0IG9mIGxhYmVsKQogICAgY29uc3QgTUFUQ0hVUF9JTkNfTEFCRUwgPSBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgTUFUQ0hVUF9JTkNfTEFCRUxfSUQsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVgsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnVpLnBsdXMpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIG1hdGNodXBJbmNCb3JkZXIgPz8gQ09OVEFJTkVSX0JBU0UKICAgICk7CiAgICBpZiAoTUFUQ0hVUF9JTkNfTEFCRUwpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShNQVRDSFVQX0lOQ19MQUJFTCwgMTQpOwogICAgfQoKICAgIC8vIE1hdGNodXAgcmVhZG91dHMgKGJlbG93IG1hdGNodXAgYnV0dG9ucykKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgTUFUQ0hVUF9LSUxMU1RBUkdFVF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC00MiAtIChiZXN0T2ZMYWJlbFNpemVYICsgODApIC8gNCwgbWF0Y2h1cFkgKyBiZXN0T2ZCdXR0b25TaXplWSAtIDEsIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoYmVzdE9mTGFiZWxTaXplWCArIDgwLCAxNiwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy50YXJnZXRLaWxsc1RvV2luRm9ybWF0LCBTdGF0ZS5yb3VuZC5raWxsc1RhcmdldCksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBNQVRDSFVQX0tJTExTVEFSR0VUID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKE1BVENIVVBfS0lMTFNUQVJHRVRfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKE1BVENIVVBfS0lMTFNUQVJHRVQsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoTUFUQ0hVUF9LSUxMU1RBUkdFVCwgMTIpOwogICAgYXBwbHlSZWFkeURpYWxvZ0xhYmVsVGV4dENvbG9yKE1BVENIVVBfS0lMTFNUQVJHRVQpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KE1BVENIVVBfS0lMTFNUQVJHRVQsIENPTlRBSU5FUl9CQVNFKTsKCiAgICBjb25zdCBQTEFZRVJTX0RFQ19JRCA9IFVJX1JFQURZX0RJQUxPR19NSU5QTEFZRVJTX0RFQ19JRCArIHBsYXllcklkOwogICAgY29uc3QgUExBWUVSU19ERUNfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTUlOUExBWUVSU19ERUNfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IFBMQVlFUlNfSU5DX0lEID0gVUlfUkVBRFlfRElBTE9HX01JTlBMQVlFUlNfSU5DX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBQTEFZRVJTX0lOQ19MQUJFTF9JRCA9IFVJX1JFQURZX0RJQUxPR19NSU5QTEFZRVJTX0lOQ19MQUJFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgcGxheWVyc1kgPSBtYXRjaHVwWSArIGJlc3RPZkJ1dHRvblNpemVZICsgMjA7CiAgICBjb25zdCBwbGF5ZXJzTGFiZWxTaXplWCA9IGJlc3RPZkxhYmVsU2l6ZVggKyAzMDsKICAgIGNvbnN0IHBsYXllcnNMYWJlbE9mZnNldFggPSAtNzI7CiAgICBjb25zdCBwbGF5ZXJzTGFiZWxPZmZzZXRZID0gNDsKCiAgICBjb25zdCBwbGF5ZXJzRGVjQm9yZGVyID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgUExBWUVSU19ERUNfSUQsCiAgICAgICAgMTI1LAogICAgICAgIHBsYXllcnNZLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVYLAogICAgICAgIGJlc3RPZkJ1dHRvblNpemVZLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBDT05UQUlORVJfQkFTRSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKCiAgICBjb25zdCBQTEFZRVJTX0RFQ19MQUJFTCA9IGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBQTEFZRVJTX0RFQ19MQUJFTF9JRCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudWkubWludXMpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIHBsYXllcnNEZWNCb3JkZXIgPz8gQ09OVEFJTkVSX0JBU0UKICAgICk7CiAgICBpZiAoUExBWUVSU19ERUNfTEFCRUwpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShQTEFZRVJTX0RFQ19MQUJFTCwgMTQpOwogICAgfQoKICAgIGNvbnN0IGF1dG9TdGFydENvdW50cyA9IGdldEF1dG9TdGFydE1pblBsYXllckNvdW50cygpOwogICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICBNQVRDSFVQX01JTlBMQVlFUlNfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihwbGF5ZXJzTGFiZWxPZmZzZXRYLCBwbGF5ZXJzWSArIHBsYXllcnNMYWJlbE9mZnNldFksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IocGxheWVyc0xhYmVsU2l6ZVgsIDE2LCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnBsYXllcnNGb3JtYXQsIGF1dG9TdGFydENvdW50cy5sZWZ0LCBhdXRvU3RhcnRDb3VudHMucmlnaHQpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgTUFUQ0hVUF9NSU5QTEFZRVJTID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKE1BVENIVVBfTUlOUExBWUVSU19JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoTUFUQ0hVUF9NSU5QTEFZRVJTLCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKE1BVENIVVBfTUlOUExBWUVSUywgMTQpOwogICAgYXBwbHlSZWFkeURpYWxvZ0xhYmVsVGV4dENvbG9yKE1BVENIVVBfTUlOUExBWUVSUyk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoTUFUQ0hVUF9NSU5QTEFZRVJTLCBDT05UQUlORVJfQkFTRSk7CgogICAgY29uc3QgcGxheWVyc1RvdGFsWSA9IHBsYXllcnNZICsgYmVzdE9mQnV0dG9uU2l6ZVkgLSAxOwogICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICBNQVRDSFVQX01JTlBMQVlFUlNfVE9UQUxfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtNDIgLSAoYmVzdE9mTGFiZWxTaXplWCArIDgwKSAvIDQsIHBsYXllcnNUb3RhbFksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoYmVzdE9mTGFiZWxTaXplWCArIDgwLCAxNiwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5taW5QbGF5ZXJzVG9TdGFydEZvcm1hdCwgYXV0b1N0YXJ0Q291bnRzLnRvdGFsKSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IE1BVENIVVBfTUlOUExBWUVSU19UT1RBTCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShNQVRDSFVQX01JTlBMQVlFUlNfVE9UQUxfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKE1BVENIVVBfTUlOUExBWUVSU19UT1RBTCwgMCk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShNQVRDSFVQX01JTlBMQVlFUlNfVE9UQUwsIDEyKTsKICAgIGFwcGx5UmVhZHlEaWFsb2dMYWJlbFRleHRDb2xvcihNQVRDSFVQX01JTlBMQVlFUlNfVE9UQUwpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KE1BVENIVVBfTUlOUExBWUVSU19UT1RBTCwgQ09OVEFJTkVSX0JBU0UpOwoKICAgIGNvbnN0IHBsYXllcnNJbmNCb3JkZXIgPSBhZGRPdXRsaW5lZEJ1dHRvbigKICAgICAgICBQTEFZRVJTX0lOQ19JRCwKICAgICAgICAtMywKICAgICAgICBwbGF5ZXJzWSwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWCwKICAgICAgICBiZXN0T2ZCdXR0b25TaXplWSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CgogICAgY29uc3QgUExBWUVSU19JTkNfTEFCRUwgPSBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgUExBWUVSU19JTkNfTEFCRUxfSUQsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVgsCiAgICAgICAgYmVzdE9mQnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnVpLnBsdXMpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIHBsYXllcnNJbmNCb3JkZXIgPz8gQ09OVEFJTkVSX0JBU0UKICAgICk7CiAgICBpZiAoUExBWUVSU19JTkNfTEFCRUwpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShQTEFZRVJTX0lOQ19MQUJFTCwgMTQpOwogICAgfQoKICAgIHVwZGF0ZU1hdGNodXBMYWJlbEZvclBpZChwbGF5ZXJJZCk7CiAgICB1cGRhdGVNYXRjaHVwUmVhZG91dHNGb3JQaWQocGxheWVySWQpOwogICAgdXBkYXRlUmVhZHlEaWFsb2dNb2RlQ29uZmlnRm9yUGlkKHBsYXllcklkKTsKCiAgICAvLyBMZWZ0IGFuZCByaWdodCByb3N0ZXIgY29udGFpbmVycyAoY2hpbGRyZW4gYXJlIHBhcmVudGVkIHRvIHRoZXNlIGNvbnRhaW5lcnMpLgogICAgY29uc3QgVDFfQ09OVEFJTkVSX0lEID0gVUlfUkVBRFlfRElBTE9HX1RFQU0xX0NPTlRBSU5FUl9JRCArIHBsYXllcklkOwogICAgY29uc3QgVDJfQ09OVEFJTkVSX0lEID0gVUlfUkVBRFlfRElBTE9HX1RFQU0yX0NPTlRBSU5FUl9JRCArIHBsYXllcklkOwoKICAgIG1vZC5BZGRVSUNvbnRhaW5lcigKICAgICAgICBUMV9DT05UQUlORVJfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihSRUFEWV9ST1NURVJfUEFORUxfTUFSR0lOLCBSRUFEWV9ST1NURVJfUEFORUxfWSwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihSRUFEWV9ST1NURVJfUEFORUxfV0lEVEgsIFJFQURZX1JPU1RFUl9QQU5FTF9IRUlHSFQsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIENPTlRBSU5FUl9CQVNFLAogICAgICAgIHRydWUsCiAgICAgICAgMSwKICAgICAgICBSRUFEWV9QQU5FTF9UMV9CR19DT0xPUiwKICAgICAgICBSRUFEWV9QQU5FTF9CR19BTFBIQSwKICAgICAgICBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBtb2QuQWRkVUlDb250YWluZXIoCiAgICAgICAgVDJfQ09OVEFJTkVSX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoUkVBRFlfUk9TVEVSX1BBTkVMX01BUkdJTiArIFJFQURZX1JPU1RFUl9QQU5FTF9XSURUSCArIFJFQURZX1JPU1RFUl9QQU5FTF9HQVAsIFJFQURZX1JPU1RFUl9QQU5FTF9ZLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKFJFQURZX1JPU1RFUl9QQU5FTF9XSURUSCwgUkVBRFlfUk9TVEVSX1BBTkVMX0hFSUdIVCwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgdHJ1ZSwKICAgICAgICAxLAogICAgICAgIFJFQURZX1BBTkVMX1QyX0JHX0NPTE9SLAogICAgICAgIFJFQURZX1BBTkVMX0JHX0FMUEhBLAogICAgICAgIG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKCiAgICBjb25zdCBUMV9DT05UQUlORVIgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoVDFfQ09OVEFJTkVSX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgY29uc3QgVDJfQ09OVEFJTkVSID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFQyX0NPTlRBSU5FUl9JRCwgbW9kLkdldFVJUm9vdCgpKTsKCiAgICAvLyBUZWFtIGxhYmVscyByZXVzZSBleGlzdGluZyB0ZWFtLW5hbWUgc3RyaW5ncy4KICAgIGNvbnN0IHRlYW1MYWJlbFkgPSAwOwogICAgY29uc3QgdGVhbUxhYmVsSGVpZ2h0ID0gMjQ7CiAgICBjb25zdCB0ZWFtTGFiZWxXaWR0aCA9IFJFQURZX1JPU1RFUl9QQU5FTF9XSURUSDsKICAgIGNvbnN0IFQxX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX1RFQU0xX0xBQkVMX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBUMl9MQUJFTF9JRCA9IFVJX1JFQURZX0RJQUxPR19URUFNMl9MQUJFTF9JRCArIHBsYXllcklkOwogICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICBUMV9MQUJFTF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIHRlYW1MYWJlbFksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IodGVhbUxhYmVsV2lkdGgsIHRlYW1MYWJlbEhlaWdodCwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICBtb2QuTWVzc2FnZShnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTEpKSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IFQxX0xBQkVMID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFQxX0xBQkVMX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShUMV9MQUJFTCwgMCk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShUMV9MQUJFTCwgMjApOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFQxX0xBQkVMLCBUMV9DT05UQUlORVIpOwoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgVDJfTEFCRUxfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigwLCB0ZWFtTGFiZWxZLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKHRlYW1MYWJlbFdpZHRoLCB0ZWFtTGFiZWxIZWlnaHQsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgbW9kLk1lc3NhZ2UoZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0yKSksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBUMl9MQUJFTCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShUMl9MQUJFTF9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoVDJfTEFCRUwsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoVDJfTEFCRUwsIDIwKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChUMl9MQUJFTCwgVDJfQ09OVEFJTkVSKTsKCiAgICAvLyBGaXhlZCByb3dzOiB1cCB0byAxNiBwbGF5ZXJzIHBlciB0ZWFtICgzMiBtYXgpLiBJZiB3ZSBldmVyIHdhbnQgdG8gZ28gYWJvdmUgMTYgcGVyIHRlYW0sIHdlIHNob3VsZCBpbnRyb2R1Y2UgYSBOZXh0IFBhZ2Ugb3IgUHJldmlvdXMgUGFnZSBidXR0b24/IFNsaWRlcj8KICAgIGNvbnN0IHJvd1N0YXJ0WSA9IHRlYW1MYWJlbFkgKyB0ZWFtTGFiZWxIZWlnaHQ7CiAgICBjb25zdCByb3dIID0gMjY7CiAgICBjb25zdCBjb2xOYW1lWCA9IDEwOwogICAgY29uc3QgY29sUmVhZHlYID0gMjgwOwogICAgY29uc3QgY29sQmFzZVggPSA0MjA7CiAgICBjb25zdCBjb2xOYW1lVyA9IDI2MDsKICAgIGNvbnN0IGNvbFN0YXR1c1cgPSAxNDA7CgogICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgVEVBTV9ST1NURVJfTUFYX1JPV1M7IHJvdysrKSB7CiAgICAgICAgY29uc3QgeSA9IHJvd1N0YXJ0WSArIChyb3cgKiByb3dIKTsKCiAgICAgICAgY29uc3QgdDFOYW1lSWQgPSBVSV9SRUFEWV9ESUFMT0dfVDFfUk9XX05BTUVfSUQgKyBwbGF5ZXJJZCArICJfIiArIHJvdzsKICAgICAgICBjb25zdCB0MVJlYWR5SWQgPSBVSV9SRUFEWV9ESUFMT0dfVDFfUk9XX1JFQURZX0lEICsgcGxheWVySWQgKyAiXyIgKyByb3c7CiAgICAgICAgY29uc3QgdDFCYXNlSWQgPSBVSV9SRUFEWV9ESUFMT0dfVDFfUk9XX0JBU0VfSUQgKyBwbGF5ZXJJZCArICJfIiArIHJvdzsKCiAgICAgICAgbW9kLkFkZFVJVGV4dCh0MU5hbWVJZCwgbW9kLkNyZWF0ZVZlY3Rvcihjb2xOYW1lWCwgeSwgMCksIG1vZC5DcmVhdGVWZWN0b3IoY29sTmFtZVcsIHJvd0gsIDApLCBtb2QuVUlBbmNob3IuVG9wTGVmdCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgIiIpLCBldmVudFBsYXllcik7CiAgICAgICAgY29uc3QgVDFfTkFNRSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZSh0MU5hbWVJZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKFQxX05BTUUsIDApOwogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKFQxX05BTUUsIDE0KTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoVDFfTkFNRSwgVDFfQ09OVEFJTkVSKTsKCiAgICAgICAgbW9kLkFkZFVJVGV4dCh0MVJlYWR5SWQsIG1vZC5DcmVhdGVWZWN0b3IoY29sUmVhZHlYLCB5LCAwKSwgbW9kLkNyZWF0ZVZlY3Rvcihjb2xTdGF0dXNXLCByb3dILCAwKSwgbW9kLlVJQW5jaG9yLlRvcExlZnQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsICIiKSwgZXZlbnRQbGF5ZXIpOwogICAgICAgIGNvbnN0IFQxX1JFQURZID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKHQxUmVhZHlJZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKFQxX1JFQURZLCAwKTsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShUMV9SRUFEWSwgMTQpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChUMV9SRUFEWSwgVDFfQ09OVEFJTkVSKTsKCiAgICAgICAgbW9kLkFkZFVJVGV4dCh0MUJhc2VJZCwgbW9kLkNyZWF0ZVZlY3Rvcihjb2xCYXNlWCwgeSwgMCksIG1vZC5DcmVhdGVWZWN0b3IoY29sU3RhdHVzVywgcm93SCwgMCksIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCAiIiksIGV2ZW50UGxheWVyKTsKICAgICAgICBjb25zdCBUMV9CQVNFID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKHQxQmFzZUlkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoVDFfQkFTRSwgMCk7CiAgICAgICAgbW9kLlNldFVJVGV4dFNpemUoVDFfQkFTRSwgMTQpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChUMV9CQVNFLCBUMV9DT05UQUlORVIpOwoKICAgICAgICBjb25zdCB0Mk5hbWVJZCA9IFVJX1JFQURZX0RJQUxPR19UMl9ST1dfTkFNRV9JRCArIHBsYXllcklkICsgIl8iICsgcm93OwogICAgICAgIGNvbnN0IHQyUmVhZHlJZCA9IFVJX1JFQURZX0RJQUxPR19UMl9ST1dfUkVBRFlfSUQgKyBwbGF5ZXJJZCArICJfIiArIHJvdzsKICAgICAgICBjb25zdCB0MkJhc2VJZCA9IFVJX1JFQURZX0RJQUxPR19UMl9ST1dfQkFTRV9JRCArIHBsYXllcklkICsgIl8iICsgcm93OwoKICAgICAgICBtb2QuQWRkVUlUZXh0KHQyTmFtZUlkLCBtb2QuQ3JlYXRlVmVjdG9yKGNvbE5hbWVYLCB5LCAwKSwgbW9kLkNyZWF0ZVZlY3Rvcihjb2xOYW1lVywgcm93SCwgMCksIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCAiIiksIGV2ZW50UGxheWVyKTsKICAgICAgICBjb25zdCBUMl9OQU1FID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKHQyTmFtZUlkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoVDJfTkFNRSwgMCk7CiAgICAgICAgbW9kLlNldFVJVGV4dFNpemUoVDJfTkFNRSwgMTQpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChUMl9OQU1FLCBUMl9DT05UQUlORVIpOwoKICAgICAgICBtb2QuQWRkVUlUZXh0KHQyUmVhZHlJZCwgbW9kLkNyZWF0ZVZlY3Rvcihjb2xSZWFkeVgsIHksIDApLCBtb2QuQ3JlYXRlVmVjdG9yKGNvbFN0YXR1c1csIHJvd0gsIDApLCBtb2QuVUlBbmNob3IuVG9wTGVmdCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgIiIpLCBldmVudFBsYXllcik7CiAgICAgICAgY29uc3QgVDJfUkVBRFkgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodDJSZWFkeUlkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoVDJfUkVBRFksIDApOwogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKFQyX1JFQURZLCAxNCk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFQyX1JFQURZLCBUMl9DT05UQUlORVIpOwoKICAgICAgICBtb2QuQWRkVUlUZXh0KHQyQmFzZUlkLCBtb2QuQ3JlYXRlVmVjdG9yKGNvbEJhc2VYLCB5LCAwKSwgbW9kLkNyZWF0ZVZlY3Rvcihjb2xTdGF0dXNXLCByb3dILCAwKSwgbW9kLlVJQW5jaG9yLlRvcExlZnQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsICIiKSwgZXZlbnRQbGF5ZXIpOwogICAgICAgIGNvbnN0IFQyX0JBU0UgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodDJCYXNlSWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShUMl9CQVNFLCAwKTsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShUMl9CQVNFLCAxNCk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFQyX0JBU0UsIFQyX0NPTlRBSU5FUik7CiAgICB9CgogICAgLy8gUG9wdWxhdGUgcm93cyBmb3IgdGhpcyB2aWV3ZXIgLgogICAgcmVmcmVzaFJlYWR5RGlhbG9nUm9zdGVyRm9yVmlld2VyKGV2ZW50UGxheWVyLCBwbGF5ZXJJZCk7CgogICAgLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAoUm9zdGVyIFVJKSAtICAoaGVhZGVyICsgdGVhbSByb3N0ZXJzKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIAoKICAgIC8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgLSBTd2FwIFRlYW1zIEJ1dHRvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIEJvdHRvbS1sZWZ0IHRvZ2dsZTogc3dhcHMgdGhlIHBsYXllcidzIGN1cnJlbnQgdGVhbSAoVGVhbSAxIDwtPiBUZWFtIDIpLgogICAgY29uc3QgU1dBUF9CVVRUT05fSUQgPSBVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1NXQVBfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IFNXQVBfQlVUVE9OX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9TV0FQX0xBQkVMX0lEICsgcGxheWVySWQ7CgogICAgY29uc3QgU1dBUF9CT1JERVIgPSBhZGRPdXRsaW5lZEJ1dHRvbigKICAgICAgICBTV0FQX0JVVFRPTl9JRCwKICAgICAgICAwLAogICAgICAgIDAsCiAgICAgICAgUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX1dJRFRILAogICAgICAgIFJFQURZX0RJQUxPR19NQUlOX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLlVJQW5jaG9yLkJvdHRvbUxlZnQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CgogICAgY29uc3QgU1dBUF9CVVRUT05fTEFCRUwgPSBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgU1dBUF9CVVRUT05fTEFCRUxfSUQsCiAgICAgICAgUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX1dJRFRILAogICAgICAgIFJFQURZX0RJQUxPR19NQUlOX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJ1dHRvbnMuc3dhcFRlYW1zKSwKICAgICAgICBldmVudFBsYXllciwKICAgICAgICBTV0FQX0JPUkRFUiA/PyBDT05UQUlORVJfQkFTRQogICAgKTsKCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIC0gU3dhcCBUZWFtcyBCdXR0b24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKICAgIC8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgIC0gUmVhZHkgVG9nZ2xlIEJ1dHRvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIEJvdHRvbS1jZW50ZXIgdG9nZ2xlOiBzdGFydHMgYXMgIlJlYWR5IiAocHJlc3NpbmcgaXQgc2V0cyBSRUFEWSksIHRoZW4gZmxpcHMgdG8gIk5vdCBSZWFkeSIuCiAgICBjb25zdCBSRUFEWV9CVVRUT05fSUQgPSBVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1JFQURZX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBSRUFEWV9CVVRUT05fTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1JFQURZX0xBQkVMX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBSRUFEWV9CVVRUT05fQk9SREVSID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgUkVBRFlfQlVUVE9OX0lELAogICAgICAgIFJFQURZX0RJQUxPR19SRUFEWV9CVVRUT05fT0ZGU0VUX1gsCiAgICAgICAgMCwKICAgICAgICBSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX0hFSUdIVCwKICAgICAgICBtb2QuVUlBbmNob3IuQm90dG9tQ2VudGVyLAogICAgICAgIENPTlRBSU5FUl9CQVNFLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwoKICAgIGNvbnN0IFJFQURZX0JVVFRPTl9MQUJFTCA9IGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBSRUFEWV9CVVRUT05fTEFCRUxfSUQsCiAgICAgICAgUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX1dJRFRILAogICAgICAgIFJFQURZX0RJQUxPR19NQUlOX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJ1dHRvbnMucmVhZHkpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIFJFQURZX0JVVFRPTl9CT1JERVIgPz8gQ09OVEFJTkVSX0JBU0UKICAgICk7CgogICAgLy8gRW5zdXJlIHRoZSBsYWJlbCBtYXRjaGVzIHRoZSBjdXJyZW50IHN0b3JlZCBzdGF0ZSBmb3IgdGhpcyB2aWV3ZXIgKGRlZmF1bHQgaXMgTk9UIFJFQURZKS4KICAgIHVwZGF0ZVJlYWR5VG9nZ2xlQnV0dG9uRm9yVmlld2VyKGV2ZW50UGxheWVyLCBwbGF5ZXJJZCk7CgogICAgLy8gQm90dG9tLWNlbnRlciByaWdodDogQXV0by1SZWFkeSB0b2dnbGUgKEVuYWJsZS9EaXNhYmxlKS4KICAgIGNvbnN0IEFVVE9fUkVBRFlfQlVUVE9OX0lEID0gVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9BVVRPX1JFQURZX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBBVVRPX1JFQURZX0JVVFRPTl9MQUJFTF9JRCA9IFVJX1JFQURZX0RJQUxPR19CVVRUT05fQVVUT19SRUFEWV9MQUJFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgQVVUT19SRUFEWV9CVVRUT05fQk9SREVSID0gYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgQVVUT19SRUFEWV9CVVRUT05fSUQsCiAgICAgICAgUkVBRFlfRElBTE9HX0FVVE9fUkVBRFlfQlVUVE9OX09GRlNFVF9YLAogICAgICAgIDAsCiAgICAgICAgUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX1dJRFRILAogICAgICAgIFJFQURZX0RJQUxPR19NQUlOX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLlVJQW5jaG9yLkJvdHRvbUNlbnRlciwKICAgICAgICBDT05UQUlORVJfQkFTRSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKCiAgICBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgQVVUT19SRUFEWV9CVVRUT05fTEFCRUxfSUQsCiAgICAgICAgUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX1dJRFRILAogICAgICAgIFJFQURZX0RJQUxPR19NQUlOX0JVVFRPTl9IRUlHSFQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJ1dHRvbnMuYXV0b1JlYWR5RW5hYmxlKSwKICAgICAgICBldmVudFBsYXllciwKICAgICAgICBBVVRPX1JFQURZX0JVVFRPTl9CT1JERVIgPz8gQ09OVEFJTkVSX0JBU0UKICAgICk7CiAgICB1cGRhdGVBdXRvUmVhZHlUb2dnbGVCdXR0b25Gb3JWaWV3ZXIoZXZlbnRQbGF5ZXIsIHBsYXllcklkKTsKCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nICAtIFJlYWR5IFRvZ2dsZSBCdXR0b24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKICAgIC8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBEZWJ1ZyBJbmZvIC0gVGltZSBMaW1pdCBTZWNvbmRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgY29uc3QgREVCVUdfVElNRUxJTUlUX0lEID0gVUlfVEVBTVNXSVRDSF9ERUJVR19USU1FTElNSVRfSUQgKyBwbGF5ZXJJZDsKICAgIGlmIChTSE9XX0RFQlVHX1RJTUVMSU1JVCkgewoKICAgIC8vIFNob3dzIHRoZSBjdXJyZW50IGluZmVycmVkIGdhbWVtb2RlIHRpbWUgbGltaXQgKHNlY29uZHMpIHdoaWxlIHRoZSB0ZWFtIHN3aXRjaCBkaWFsb2cgaXMgb3Blbi4KICAgIGNvbnN0IGRlYnVnVGltZUxpbWl0U2Vjb25kcyA9IE1hdGguZmxvb3IobW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKSArIG1vZC5HZXRNYXRjaFRpbWVSZW1haW5pbmcoKSk7CiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIERFQlVHX1RJTUVMSU1JVF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0zMjAsIC0xNjAsIDApLCAgLy9tb2QuQ3JlYXRlVmVjdG9yKC0yMjAsIDEwLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDgwLCAyOCwgMCksICAgIC8vbW9kLkNyZWF0ZVZlY3Rvcig4MCwgMjgsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudGVhbVN3aXRjaC5kZWJ1Z1RpbWVMaW1pdCwgZGVidWdUaW1lTGltaXRTZWNvbmRzKSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IERFQlVHX1RJTUVMSU1JVCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShERUJVR19USU1FTElNSVRfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAvLyBQYXJlbnQgdG8gdGhlIFRlYW0gU3dpdGNoIGNvbnRhaW5lciBzbyB0aGUgdGV4dCBpcyBhbHdheXMgZHJhd24gYWJvdmUgdGhlIGRpYWxvZyBiYWNrZ3JvdW5kLgogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KERFQlVHX1RJTUVMSU1JVCwgQ09OVEFJTkVSX0JBU0UpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShERUJVR19USU1FTElNSVQsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoREVCVUdfVElNRUxJTUlULCAxMik7CiAgICBhcHBseVJlYWR5RGlhbG9nTGFiZWxUZXh0Q29sb3IoREVCVUdfVElNRUxJTUlUKTsKCgogICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBleGlzdGluZ0RlYnVnID0gc2FmZUZpbmQoREVCVUdfVElNRUxJTUlUX0lEKTsKICAgICAgICBpZiAoZXhpc3RpbmdEZWJ1ZykgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShleGlzdGluZ0RlYnVnLCBmYWxzZSk7CiAgICB9CgogICAgLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIERlYnVnIEluZm8gLSBUaW1lIExpbWl0IFNlY29uZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgogICAgCiAgICAvLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gQWRtaW4gUGFuZWwgVG9nZ2xlIEJ1dHRvbiAoVG9wLVJpZ2h0LCBvbmx5IHdoaWxlIFJlYWR5IFVwIGRpYWxvZyBpcyBvcGVuKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIFVJIGNhY2hpbmcgbm90ZTogdGhlc2Ugd2lkZ2V0cyBhcmUgY3JlYXRlZCBvbmNlIGFuZCB0aGVuIGhpZGRlbi9zaG93biBvbiBvcGVuL2Nsb3NlLgogICAgZW5zdXJlQWRtaW5QYW5lbFdpZGdldHMoZXZlbnRQbGF5ZXIsIHBsYXllcklkKTsKCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gQWRtaW4gUGFuZWwgVG9nZ2xlIEJ1dHRvbiAoVG9wLVJpZ2h0LCBvbmx5IHdoaWxlIFJlYWR5IFVwIGRpYWxvZyBpcyBvcGVuKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIERpYWxvZyBCdXR0b25zIChMZWZ0IFNpZGUpIC0gQ2FuY2VsIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLy8gQ2FuY2VsIHJlbWFpbnMgYSBjb3JlIGZ1bmN0aW9uIHNvIHBsYXllcnMgY2FuIGRpc21pc3MgdGhlIGRpYWxvZyBhbmQgcmVnYWluIGNvbnRyb2wuCiAgICAvLyAoVGVhbSBzd2l0Y2hpbmcgLyBzcGVjdGF0ZSAvIG9wdC1vdXQgYnV0dG9ucyBhcmUgaW50ZW50aW9uYWxseSBub3QgZXhwb3NlZCBpbiB2MC41Kzsgc2VlIERlcHJlY2F0ZWQgVUkgYmxvY2sgYmVsb3cuKQogICAgY29uc3QgQlVUVE9OX0NBTkNFTF9CT1JERVIgPSBhZGRPdXRsaW5lZEJ1dHRvbigKICAgICAgICBCVVRUT05fQ0FOQ0VMX0lELAogICAgICAgIDAsCiAgICAgICAgMCwKICAgICAgICBSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fV0lEVEgsCiAgICAgICAgUkVBRFlfRElBTE9HX01BSU5fQlVUVE9OX0hFSUdIVCwKICAgICAgICBtb2QuVUlBbmNob3IuQm90dG9tUmlnaHQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CgogICAgY29uc3QgQlVUVE9OX0NBTkNFTF9MQUJFTCA9IGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBCVVRUT05fQ0FOQ0VMX0xBQkVMX0lELAogICAgICAgIFJFQURZX0RJQUxPR19NQUlOX0JVVFRPTl9XSURUSCwKICAgICAgICBSRUFEWV9ESUFMT0dfTUFJTl9CVVRUT05fSEVJR0hULAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtU3dpdGNoLmJ1dHRvbnMuY2FuY2VsKSwKICAgICAgICBldmVudFBsYXllciwKICAgICAgICBCVVRUT05fQ0FOQ0VMX0JPUkRFUiA/PyBDT05UQUlORVJfQkFTRQogICAgKTsKCiAgICAvLyBMYXlvdXQgY29uc3RhbnRzOiBhZGp1c3QgY2F1dGlvdXNseTsgdmVyaWZ5IGluLWdhbWUgZGlhbG9nIEFkbWluIHBhbmVsIHdpZGdldHMgYXJlIGJ1aWx0IGxhemlseSBvbiBmaXJzdCBvcGVuIChzZWUgYnVpbGRBZG1pblBhbmVsV2lkZ2V0cykgdG8gcHJldmVudCBhIG9uZS10aWNrIHJlbmRlciBmbGlja2VyLgogICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yUGxheWVyKGV2ZW50UGxheWVyKTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIERpYWxvZyBCdXR0b25zIChMZWZ0IFNpZGUpIC0gQ2FuY2VsIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBBZG1pbiBQYW5lbCBVSSAoUmlnaHQgU2lkZSkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIEJ1aWxkcyB0aGUgQWRtaW4gUGFuZWwgd2lkZ2V0cyBsYXppbHkgKHRvIGF2b2lkIGEgMS1mcmFtZSBmbGlja2VyIG9uIGRpYWxvZyBvcGVuKS4KZnVuY3Rpb24gYnVpbGRBZG1pblBhbmVsV2lkZ2V0cyhldmVudFBsYXllcjogbW9kLlBsYXllciwgYWRtaW5Db250YWluZXI6IG1vZC5VSVdpZGdldCwgcGxheWVySWQ6IG51bWJlcik6IHZvaWQgewoKICAgIC8vIEZpdCBhdCB0YXJnZXQgcmVzb2x1dGlvbnMuCiAgICBjb25zdCB0ZXN0ZXJCYXNlWCA9IEFETUlOX1BBTkVMX0JBU0VfWDsKICAgIGNvbnN0IHRlc3RlckJhc2VZID0gQURNSU5fUEFORUxfQkFTRV9ZOwoKICAgIGNvbnN0IGJ1dHRvblNpemVYID0gQURNSU5fUEFORUxfQlVUVE9OX1NJWkVfWDsKICAgIGNvbnN0IGJ1dHRvblNpemVZID0gQURNSU5fUEFORUxfQlVUVE9OX1NJWkVfWTsKICAgIGNvbnN0IGxhYmVsU2l6ZVggPSBBRE1JTl9QQU5FTF9MQUJFTF9TSVpFX1g7CiAgICBjb25zdCByb3dTcGFjaW5nWSA9IEFETUlOX1BBTkVMX1JPV19TUEFDSU5HX1k7CgogICAgY29uc3QgZGVjT2Zmc2V0WCA9IDA7CiAgICBjb25zdCBsYWJlbE9mZnNldFggPSBidXR0b25TaXplWCArIDg7CiAgICBjb25zdCBpbmNPZmZzZXRYID0gYnV0dG9uU2l6ZVggKyA4ICsgbGFiZWxTaXplWCArIDg7CgogICAgY29uc3QgaGVhZGVySWQgPSBVSV9URVNUX0hFQURFUl9MQUJFTF9JRCArIHBsYXllcklkOwoKICAgIG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICBuYW1lOiBoZWFkZXJJZCwKICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgcGxheWVySWQ6IGV2ZW50UGxheWVyLAogICAgICAgIHBvc2l0aW9uOiBbMCwgdGVzdGVyQmFzZVkgKyAyXSwKICAgICAgICBzaXplOiBbQURNSU5fUEFORUxfQ09OVEVOVF9XSURUSCwgMThdLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmhlYWRlciksCiAgICAgICAgdGV4dENvbG9yOiBBRE1JTl9QQU5FTF9MQUJFTF9URVhUX0NPTE9SX1JHQiwKICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICB9KTsKICAgIGNvbnN0IFRFU1RfSEVBREVSID0gc2FmZUZpbmQoaGVhZGVySWQpOwogICAgYXBwbHlBZG1pblBhbmVsTGFiZWxUZXh0Q29sb3IoVEVTVF9IRUFERVIpOwogICAgaWYgKFRFU1RfSEVBREVSKSBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoVEVTVF9IRUFERVIsIGFkbWluQ29udGFpbmVyKTsKCiAgICBjb25zdCByb3cwWSA9IHRlc3RlckJhc2VZICsgMjI7CgogICAgYWRkVGVzdGVyUm93KGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQsIHRlc3RlckJhc2VYLCByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDAsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fTEVGVF9XSU5TX0RFQ19JRCwgVUlfVEVTVF9CVVRUT05fTEVGVF9XSU5TX0lOQ19JRCwgVUlfVEVTVF9MQUJFTF9MRUZUX1dJTlNfSUQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmxhYmVscy5sZWZ0V2lucywgYnV0dG9uU2l6ZVgsIGJ1dHRvblNpemVZLCBsYWJlbFNpemVYLCBkZWNPZmZzZXRYLCBsYWJlbE9mZnNldFgsIGluY09mZnNldFgpOwoKICAgIGFkZFRlc3RlclJvdyhldmVudFBsYXllciwgYWRtaW5Db250YWluZXIsIHBsYXllcklkLCB0ZXN0ZXJCYXNlWCwgcm93MFkgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSkgKiAxLAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1JJR0hUX1dJTlNfREVDX0lELCBVSV9URVNUX0JVVFRPTl9SSUdIVF9XSU5TX0lOQ19JRCwgVUlfVEVTVF9MQUJFTF9SSUdIVF9XSU5TX0lELAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLnRlc3Rlci5sYWJlbHMucmlnaHRXaW5zLCBidXR0b25TaXplWCwgYnV0dG9uU2l6ZVksIGxhYmVsU2l6ZVgsIGRlY09mZnNldFgsIGxhYmVsT2Zmc2V0WCwgaW5jT2Zmc2V0WCk7CgogICAgYWRkVGVzdGVyUm93KGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQsIHRlc3RlckJhc2VYLCByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDIsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fTEVGVF9LSUxMU19ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX0xFRlRfS0lMTFNfSU5DX0lELCBVSV9URVNUX0xBQkVMX0xFRlRfS0lMTFNfSUQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmxhYmVscy5sZWZ0S2lsbHMsIGJ1dHRvblNpemVYLCBidXR0b25TaXplWSwgbGFiZWxTaXplWCwgZGVjT2Zmc2V0WCwgbGFiZWxPZmZzZXRYLCBpbmNPZmZzZXRYKTsKCiAgICBhZGRUZXN0ZXJSb3coZXZlbnRQbGF5ZXIsIGFkbWluQ29udGFpbmVyLCBwbGF5ZXJJZCwgdGVzdGVyQmFzZVgsIHJvdzBZICsgKGJ1dHRvblNpemVZICsgcm93U3BhY2luZ1kpICogMywKICAgICAgICBVSV9URVNUX0JVVFRPTl9SSUdIVF9LSUxMU19ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX1JJR0hUX0tJTExTX0lOQ19JRCwgVUlfVEVTVF9MQUJFTF9SSUdIVF9LSUxMU19JRCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC50ZXN0ZXIubGFiZWxzLnJpZ2h0S2lsbHMsIGJ1dHRvblNpemVYLCBidXR0b25TaXplWSwgbGFiZWxTaXplWCwgZGVjT2Zmc2V0WCwgbGFiZWxPZmZzZXRYLCBpbmNPZmZzZXRYKTsKCiAgICBhZGRUZXN0ZXJSb3coZXZlbnRQbGF5ZXIsIGFkbWluQ29udGFpbmVyLCBwbGF5ZXJJZCwgdGVzdGVyQmFzZVgsIHJvdzBZICsgKGJ1dHRvblNpemVZICsgcm93U3BhY2luZ1kpICogNCwKICAgICAgICBVSV9BRE1JTl9CVVRUT05fVDFfUk9VTkRfS0lMTFNfREVDX0lELCBVSV9BRE1JTl9CVVRUT05fVDFfUk9VTkRfS0lMTFNfSU5DX0lELCBVSV9BRE1JTl9MQUJFTF9UMV9ST1VORF9LSUxMU19JRCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5sYWJlbHMudDFSb3VuZEtpbGxzLCBidXR0b25TaXplWCwgYnV0dG9uU2l6ZVksIGxhYmVsU2l6ZVgsIGRlY09mZnNldFgsIGxhYmVsT2Zmc2V0WCwgaW5jT2Zmc2V0WCk7CgogICAgYWRkVGVzdGVyUm93KGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQsIHRlc3RlckJhc2VYLCByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDUsCiAgICAgICAgVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0RFQ19JRCwgVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0lOQ19JRCwgVUlfQURNSU5fTEFCRUxfVDJfUk9VTkRfS0lMTFNfSUQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwubGFiZWxzLnQyUm91bmRLaWxscywgYnV0dG9uU2l6ZVgsIGJ1dHRvblNpemVZLCBsYWJlbFNpemVYLCBkZWNPZmZzZXRYLCBsYWJlbE9mZnNldFgsIGluY09mZnNldFgpOwoKICAgIGFkZFRlc3RlclJvd1dpdGhWYWx1ZShldmVudFBsYXllciwgYWRtaW5Db250YWluZXIsIHBsYXllcklkLCB0ZXN0ZXJCYXNlWCwgcm93MFkgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSkgKiA2LAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1JPVU5EX0tJTExTX1RBUkdFVF9ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX1JPVU5EX0tJTExTX1RBUkdFVF9JTkNfSUQsIFVJX1RFU1RfTEFCRUxfUk9VTkRfS0lMTFNfVEFSR0VUX0lELCBVSV9URVNUX1ZBTFVFX1JPVU5EX0tJTExTX1RBUkdFVF9JRCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC50ZXN0ZXIubGFiZWxzLnJvdW5kS2lsbHNUYXJnZXQsIFN0YXRlLnJvdW5kLmtpbGxzVGFyZ2V0LCBidXR0b25TaXplWCwgYnV0dG9uU2l6ZVksIGxhYmVsU2l6ZVgsIEFETUlOX1BBTkVMX1ZBTFVFX1NJWkVfWCwgZGVjT2Zmc2V0WCwgbGFiZWxPZmZzZXRYLCBpbmNPZmZzZXRYKTsKCiAgICBzeW5jUm91bmRLaWxsc1RhcmdldFRlc3RlclZhbHVlRm9yQWxsUGxheWVycygpOwoKICAgIGFkZFRlc3RlclJvdyhldmVudFBsYXllciwgYWRtaW5Db250YWluZXIsIHBsYXllcklkLCB0ZXN0ZXJCYXNlWCwgcm93MFkgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSkgKiA3LAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1RJRVNfREVDX0lELCBVSV9URVNUX0JVVFRPTl9USUVTX0lOQ19JRCwgVUlfVEVTVF9MQUJFTF9USUVTX0lELAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLnRlc3Rlci5sYWJlbHMudGllcywgYnV0dG9uU2l6ZVgsIGJ1dHRvblNpemVZLCBsYWJlbFNpemVYLCBkZWNPZmZzZXRYLCBsYWJlbE9mZnNldFgsIGluY09mZnNldFgpOwoKICAgIGFkZFRlc3RlclJvdyhldmVudFBsYXllciwgYWRtaW5Db250YWluZXIsIHBsYXllcklkLCB0ZXN0ZXJCYXNlWCwgcm93MFkgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSkgKiA4LAogICAgICAgIFVJX1RFU1RfQlVUVE9OX0NVUl9ST1VORF9ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX0NVUl9ST1VORF9JTkNfSUQsIFVJX1RFU1RfTEFCRUxfQ1VSX1JPVU5EX0lELAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLnRlc3Rlci5sYWJlbHMuY3VycmVudFJvdW5kLCBidXR0b25TaXplWCwgYnV0dG9uU2l6ZVksIGxhYmVsU2l6ZVgsIGRlY09mZnNldFgsIGxhYmVsT2Zmc2V0WCwgaW5jT2Zmc2V0WCk7CgogICAgYWRkVGVzdGVyUm93KGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQsIHRlc3RlckJhc2VYLCByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDksCiAgICAgICAgVUlfVEVTVF9CVVRUT05fQ0xPQ0tfVElNRV9ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX0NMT0NLX1RJTUVfSU5DX0lELCBVSV9URVNUX0xBQkVMX0NMT0NLX1RJTUVfSUQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmxhYmVscy5jbG9ja1RpbWUsIGJ1dHRvblNpemVYLCBidXR0b25TaXplWSwgbGFiZWxTaXplWCwgZGVjT2Zmc2V0WCwgbGFiZWxPZmZzZXRYLCBpbmNPZmZzZXRYKTsKCiAgICBhZGRUZXN0ZXJSZXNldEJ1dHRvbihldmVudFBsYXllciwgYWRtaW5Db250YWluZXIsIHBsYXllcklkLCB0ZXN0ZXJCYXNlWCwKICAgICAgICByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDEwLCAoYnV0dG9uU2l6ZVggKyA4ICsgbGFiZWxTaXplWCArIDggKyBidXR0b25TaXplWCksIDM2KTsKCiAgICBhZGRUZXN0ZXJBY3Rpb25CdXR0b24oZXZlbnRQbGF5ZXIsIGFkbWluQ29udGFpbmVyLCBwbGF5ZXJJZCwgdGVzdGVyQmFzZVgsCiAgICAgICAgcm93MFkgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSkgKiAxMSwgKGJ1dHRvblNpemVYICsgOCArIGxhYmVsU2l6ZVggKyA4ICsgYnV0dG9uU2l6ZVgpLCAzNiwKICAgICAgICBVSV9URVNUX0JVVFRPTl9ST1VORF9TVEFSVF9JRCwgVUlfVEVTVF9ST1VORF9TVEFSVF9URVhUX0lELCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC50ZXN0ZXIuYnV0dG9ucy5yb3VuZFN0YXJ0KTsKCiAgICBhZGRUZXN0ZXJBY3Rpb25CdXR0b24oZXZlbnRQbGF5ZXIsIGFkbWluQ29udGFpbmVyLCBwbGF5ZXJJZCwgdGVzdGVyQmFzZVgsCiAgICAgICAgcm93MFkgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSkgKiAxMiwgKGJ1dHRvblNpemVYICsgOCArIGxhYmVsU2l6ZVggKyA4ICsgYnV0dG9uU2l6ZVgpLCAzNiwKICAgICAgICBVSV9URVNUX0JVVFRPTl9ST1VORF9FTkRfSUQsIFVJX1RFU1RfUk9VTkRfRU5EX1RFWFRfSUQsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLnRlc3Rlci5idXR0b25zLnJvdW5kRW5kKTsKCiAgICBhZGRUZXN0ZXJBY3Rpb25CdXR0b24oZXZlbnRQbGF5ZXIsIGFkbWluQ29udGFpbmVyLCBwbGF5ZXJJZCwgdGVzdGVyQmFzZVgsCiAgICAgICAgcm93MFkgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSkgKiAxMywgKGJ1dHRvblNpemVYICsgOCArIGxhYmVsU2l6ZVggKyA4ICsgYnV0dG9uU2l6ZVgpLCAzNiwKICAgICAgICBVSV9URVNUX0JVVFRPTl9QT1NfREVCVUdfSUQsIFVJX1RFU1RfUE9TX0RFQlVHX1RFWFRfSUQsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLnRlc3Rlci5idXR0b25zLnBvc2l0aW9uRGVidWcpOwoKICAgIGNvbnN0IG92ZXJyaWRlTGFiZWxJZCA9IFVJX0FETUlOX1RJRUJSRUFLRVJfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IG92ZXJyaWRlTGFiZWxZID0gcm93MFkgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSkgKiAxNCArIDI7CiAgICBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgbmFtZTogb3ZlcnJpZGVMYWJlbElkLAogICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICBwbGF5ZXJJZDogZXZlbnRQbGF5ZXIsCiAgICAgICAgcG9zaXRpb246IFswLCBvdmVycmlkZUxhYmVsWV0sCiAgICAgICAgc2l6ZTogW0FETUlOX1BBTkVMX0NPTlRFTlRfV0lEVEgsIEFETUlOX1BBTkVMX1RJRUJSRUFLRVJfTEFCRUxfSEVJR0hUXSwKICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmxhYmVscy50aWVCcmVha2VyT3ZlcnJpZGUpLAogICAgICAgIHRleHRDb2xvcjogQURNSU5fUEFORUxfTEFCRUxfVEVYVF9DT0xPUl9SR0IsCiAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgfSk7CiAgICBjb25zdCBPVkVSUklERV9MQUJFTCA9IHNhZmVGaW5kKG92ZXJyaWRlTGFiZWxJZCk7CiAgICBhcHBseUFkbWluUGFuZWxMYWJlbFRleHRDb2xvcihPVkVSUklERV9MQUJFTCk7CiAgICBpZiAoT1ZFUlJJREVfTEFCRUwpIG1vZC5TZXRVSVdpZGdldFBhcmVudChPVkVSUklERV9MQUJFTCwgYWRtaW5Db250YWluZXIpOwoKICAgIGNvbnN0IG92ZXJyaWRlQnV0dG9uc1kgPSBvdmVycmlkZUxhYmVsWSArIEFETUlOX1BBTkVMX1RJRUJSRUFLRVJfTEFCRUxfSEVJR0hUICsgNDsKICAgIGNvbnN0IG92ZXJyaWRlQnV0dG9uU2l6ZSA9IEFETUlOX1BBTkVMX1RJRUJSRUFLRVJfQlVUVE9OX1NJWkU7CiAgICBjb25zdCBvdmVycmlkZVNwYWNpbmcgPSBBRE1JTl9QQU5FTF9USUVCUkVBS0VSX0JVVFRPTl9TUEFDSU5HOwogICAgY29uc3Qgb3ZlcnJpZGVCdXR0b25zV2lkdGggPSAob3ZlcnJpZGVCdXR0b25TaXplICogQURNSU5fVElFQlJFQUtFUl9PVkVSUklERV9MRVRURVJTLmxlbmd0aCkKICAgICAgICArIChvdmVycmlkZVNwYWNpbmcgKiAoQURNSU5fVElFQlJFQUtFUl9PVkVSUklERV9MRVRURVJTLmxlbmd0aCAtIDEpKTsKICAgIGNvbnN0IG92ZXJyaWRlQmFzZVggPSBNYXRoLmZsb29yKChBRE1JTl9QQU5FTF9DT05URU5UX1dJRFRIIC0gb3ZlcnJpZGVCdXR0b25zV2lkdGgpIC8gMik7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBBRE1JTl9USUVCUkVBS0VSX09WRVJSSURFX0xFVFRFUlMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBsZXR0ZXIgPSBBRE1JTl9USUVCUkVBS0VSX09WRVJSSURFX0xFVFRFUlNbaV07CiAgICAgICAgY29uc3QgYnV0dG9uSWQgPSBVSV9BRE1JTl9USUVCUkVBS0VSX0JVVFRPTl9JRCArIGxldHRlciArICJfIiArIHBsYXllcklkOwogICAgICAgIGNvbnN0IHRleHRJZCA9IFVJX0FETUlOX1RJRUJSRUFLRVJfQlVUVE9OX1RFWFRfSUQgKyBsZXR0ZXIgKyAiXyIgKyBwbGF5ZXJJZDsKICAgICAgICBjb25zdCBidXR0b25YID0gb3ZlcnJpZGVCYXNlWCArIChvdmVycmlkZUJ1dHRvblNpemUgKyBvdmVycmlkZVNwYWNpbmcpICogaTsKCiAgICAgICAgYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgICAgIGJ1dHRvbklkLAogICAgICAgICAgICBidXR0b25YLAogICAgICAgICAgICBvdmVycmlkZUJ1dHRvbnNZLAogICAgICAgICAgICBvdmVycmlkZUJ1dHRvblNpemUsCiAgICAgICAgICAgIG92ZXJyaWRlQnV0dG9uU2l6ZSwKICAgICAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgIGFkbWluQ29udGFpbmVyLAogICAgICAgICAgICBldmVudFBsYXllcgogICAgICAgICk7CgogICAgICAgIGNvbnN0IEJVVFRPTl9CT1JERVIgPSBzYWZlRmluZChidXR0b25JZCArICJfQk9SREVSIik7CiAgICAgICAgY29uc3QgQlVUVE9OX1RFWFQgPSBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgICAgIHRleHRJZCwKICAgICAgICAgICAgb3ZlcnJpZGVCdXR0b25TaXplLAogICAgICAgICAgICBvdmVycmlkZUJ1dHRvblNpemUsCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKGdldE92ZXJ0aW1lRmxhZ0xldHRlcktleUZvckluZGV4KGkpKSwKICAgICAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgICAgIEJVVFRPTl9CT1JERVIgPz8gYWRtaW5Db250YWluZXIKICAgICAgICApOwogICAgICAgIGlmIChCVVRUT05fVEVYVCkgewogICAgICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShCVVRUT05fVEVYVCwgMTIpOwogICAgICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3IoQlVUVE9OX1RFWFQsIEFETUlOX1BBTkVMX0JVVFRPTl9URVhUX0NPTE9SKTsKICAgICAgICB9CiAgICB9CgogICAgY29uc3QgdGllQnJlYWtlck1vZGVSb3dZID0gb3ZlcnJpZGVCdXR0b25zWSArIG92ZXJyaWRlQnV0dG9uU2l6ZSArIHJvd1NwYWNpbmdZOwogICAgYWRkVGVzdGVyUm93KAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIGFkbWluQ29udGFpbmVyLAogICAgICAgIHBsYXllcklkLAogICAgICAgIHRlc3RlckJhc2VYLAogICAgICAgIHRpZUJyZWFrZXJNb2RlUm93WSwKICAgICAgICBVSV9BRE1JTl9USUVCUkVBS0VSX01PREVfREVDX0lELAogICAgICAgIFVJX0FETUlOX1RJRUJSRUFLRVJfTU9ERV9JTkNfSUQsCiAgICAgICAgVUlfQURNSU5fVElFQlJFQUtFUl9NT0RFX0xBQkVMX0lELAogICAgICAgIGdldFRpZUJyZWFrZXJNb2RlTGFiZWxLZXkoKSwKICAgICAgICBidXR0b25TaXplWCwKICAgICAgICBidXR0b25TaXplWSwKICAgICAgICBsYWJlbFNpemVYLAogICAgICAgIGRlY09mZnNldFgsCiAgICAgICAgbGFiZWxPZmZzZXRYLAogICAgICAgIGluY09mZnNldFgKICAgICk7CgogICAgY29uc3QgdGllQnJlYWtlckhlYWRlcklkID0gVUlfQURNSU5fVElFQlJFQUtFUl9NT0RFX0hFQURFUl9JRCArIHBsYXllcklkOwogICAgY29uc3QgdGllQnJlYWtlckhlYWRlclkgPSB0aWVCcmVha2VyTW9kZVJvd1kgKyAyOwogICAgY29uc3QgdGllQnJlYWtlckxhYmVsSGVpZ2h0ID0gMTI7CiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIHRpZUJyZWFrZXJIZWFkZXJJZCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKHRlc3RlckJhc2VYICsgbGFiZWxPZmZzZXRYLCB0aWVCcmVha2VySGVhZGVyWSwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihsYWJlbFNpemVYLCB0aWVCcmVha2VyTGFiZWxIZWlnaHQsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmxhYmVscy50aWVCcmVha2VyU2V0dGluZ0hlYWRlciksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCB0aWVCcmVha2VySGVhZGVyTGFiZWwgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodGllQnJlYWtlckhlYWRlcklkLCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYSh0aWVCcmVha2VySGVhZGVyTGFiZWwsIDApOwogICAgYXBwbHlBZG1pblBhbmVsTGFiZWxUZXh0Q29sb3IodGllQnJlYWtlckhlYWRlckxhYmVsKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKHRpZUJyZWFrZXJIZWFkZXJMYWJlbCwgMTEpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KHRpZUJyZWFrZXJIZWFkZXJMYWJlbCwgYWRtaW5Db250YWluZXIpOwoKICAgIGNvbnN0IHRpZUJyZWFrZXJNb2RlTGFiZWwgPSBzYWZlRmluZChVSV9BRE1JTl9USUVCUkVBS0VSX01PREVfTEFCRUxfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAodGllQnJlYWtlck1vZGVMYWJlbCkgewogICAgICAgIGNvbnN0IHRpZUJyZWFrZXJNb2RlTGFiZWxZID0gdGllQnJlYWtlck1vZGVSb3dZICsgYnV0dG9uU2l6ZVkgLSAxNDsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRQb3NpdGlvbih0aWVCcmVha2VyTW9kZUxhYmVsLCBtb2QuQ3JlYXRlVmVjdG9yKHRlc3RlckJhc2VYICsgbGFiZWxPZmZzZXRYLCB0aWVCcmVha2VyTW9kZUxhYmVsWSwgMCkpOwogICAgICAgIHNhZmVTZXRVSVdpZGdldFNpemUodGllQnJlYWtlck1vZGVMYWJlbCwgbW9kLkNyZWF0ZVZlY3RvcihsYWJlbFNpemVYLCB0aWVCcmVha2VyTGFiZWxIZWlnaHQsIDApKTsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZSh0aWVCcmVha2VyTW9kZUxhYmVsLCAxMSk7CiAgICB9CgogICAgY29uc3QgbGl2ZVJlc3Bhd25Sb3dZID0gdGllQnJlYWtlck1vZGVSb3dZICsgKGJ1dHRvblNpemVZICsgcm93U3BhY2luZ1kpOwogICAgYWRkVGVzdGVyQWN0aW9uQnV0dG9uKAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIGFkbWluQ29udGFpbmVyLAogICAgICAgIHBsYXllcklkLAogICAgICAgIHRlc3RlckJhc2VYLAogICAgICAgIGxpdmVSZXNwYXduUm93WSwKICAgICAgICAoYnV0dG9uU2l6ZVggKyA4ICsgbGFiZWxTaXplWCArIDggKyBidXR0b25TaXplWCksCiAgICAgICAgYnV0dG9uU2l6ZVksCiAgICAgICAgVUlfQURNSU5fTElWRV9SRVNQQVdOX0JVVFRPTl9JRCwKICAgICAgICBVSV9BRE1JTl9MSVZFX1JFU1BBV05fVEVYVF9JRCwKICAgICAgICBnZXRBZG1pbkxpdmVSZXNwYXduTGFiZWxLZXkoKQogICAgKTsKCiAgICBjb25zdCByb3VuZExlbmd0aFJvd1kgPSBsaXZlUmVzcGF3blJvd1kgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSk7CiAgICBhZGRUZXN0ZXJSb3coCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgYWRtaW5Db250YWluZXIsCiAgICAgICAgcGxheWVySWQsCiAgICAgICAgdGVzdGVyQmFzZVgsCiAgICAgICAgcm91bmRMZW5ndGhSb3dZLAogICAgICAgIFVJX0FETUlOX1JPVU5EX0xFTkdUSF9ERUNfSUQsCiAgICAgICAgVUlfQURNSU5fUk9VTkRfTEVOR1RIX0lOQ19JRCwKICAgICAgICBVSV9BRE1JTl9ST1VORF9MRU5HVEhfTEFCRUxfSUQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwubGFiZWxzLnJvdW5kTGVuZ3RoRm9ybWF0LAogICAgICAgIGJ1dHRvblNpemVYLAogICAgICAgIGJ1dHRvblNpemVZLAogICAgICAgIGxhYmVsU2l6ZVgsCiAgICAgICAgZGVjT2Zmc2V0WCwKICAgICAgICBsYWJlbE9mZnNldFgsCiAgICAgICAgaW5jT2Zmc2V0WAogICAgKTsKCiAgICBzeW5jQWRtaW5UaWVCcmVha2VyTW9kZUxhYmVsRm9yQWxsUGxheWVycygpOwogICAgc3luY0FkbWluTGl2ZVJlc3Bhd25MYWJlbEZvckFsbFBsYXllcnMoKTsKICAgIHN5bmNBZG1pblJvdW5kTGVuZ3RoTGFiZWxGb3JBbGxQbGF5ZXJzKCk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBBZG1pbiBQYW5lbCBVSSAoUmlnaHQgU2lkZSkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEFkbWluIFBhbmVsIFVJIGJ1aWxkZXIgaGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gYWRkVGVzdGVyUm93KAogICAgZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsCiAgICBjb250YWluZXJCYXNlOiBtb2QuVUlXaWRnZXQsCiAgICBwbGF5ZXJJZDogbnVtYmVyLAogICAgYmFzZVg6IG51bWJlciwKICAgIGJhc2VZOiBudW1iZXIsCiAgICBkZWNCdXR0b25CYXNlSWQ6IHN0cmluZywKICAgIGluY0J1dHRvbkJhc2VJZDogc3RyaW5nLAogICAgbGFiZWxCYXNlSWQ6IHN0cmluZywKICAgIGxhYmVsS2V5OiBudW1iZXIsCiAgICBidXR0b25TaXplWDogbnVtYmVyLAogICAgYnV0dG9uU2l6ZVk6IG51bWJlciwKICAgIGxhYmVsU2l6ZVg6IG51bWJlciwKICAgIGRlY09mZnNldFg6IG51bWJlciwKICAgIGxhYmVsT2Zmc2V0WDogbnVtYmVyLAogICAgaW5jT2Zmc2V0WDogbnVtYmVyCik6IHZvaWQgewogICAgLy8gU3RlcHM6CiAgICAvLyAxKSBFbnN1cmUgcGVyLXBsYXllciBkaWFsb2cgcm9vdCBleGlzdHMKICAgIC8vIDIpIEJ1aWxkIGxlZnQgdGVhbSBwYW5lbCB3aWRnZXRzCiAgICAvLyAzKSBCdWlsZCByaWdodCB0ZWFtIHBhbmVsIHdpZGdldHMKICAgIC8vIDQpIEJ1aWxkIGFkbWluIHBhbmVsIHdpZGdldHMgKyBiaW5kIGJ1dHRvbiBJRHMKICAgIC8vIDUpIEZpbmFsaXplIHZpc2liaWxpdHkgLyBkZWZhdWx0IHN0YXRlcwoKICAgIGNvbnN0IGRlY0J1dHRvbklkID0gZGVjQnV0dG9uQmFzZUlkICsgcGxheWVySWQ7CiAgICBjb25zdCBpbmNCdXR0b25JZCA9IGluY0J1dHRvbkJhc2VJZCArIHBsYXllcklkOwoKICAgIGNvbnN0IHBsdXNUZXh0SWQgPSBVSV9URVNUX1BMVVNfVEVYVF9JRCArIGluY0J1dHRvbklkOwogICAgY29uc3QgbWludXNUZXh0SWQgPSBVSV9URVNUX01JTlVTX1RFWFRfSUQgKyBkZWNCdXR0b25JZDsKCiAgICBjb25zdCBsYWJlbElkID0gbGFiZWxCYXNlSWQgKyBwbGF5ZXJJZDsKCiAgICBhZGRPdXRsaW5lZEJ1dHRvbigKICAgICAgICBkZWNCdXR0b25JZCwKICAgICAgICBiYXNlWCArIGRlY09mZnNldFgsCiAgICAgICAgYmFzZVksCiAgICAgICAgYnV0dG9uU2l6ZVgsCiAgICAgICAgYnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgY29udGFpbmVyQmFzZSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKCiAgICBjb25zdCBERUNfQk9SREVSID0gc2FmZUZpbmQoZGVjQnV0dG9uSWQgKyAiX0JPUkRFUiIpOwogICAgY29uc3QgTUlOVVNfVEVYVCA9IGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBtaW51c1RleHRJZCwKICAgICAgICBidXR0b25TaXplWCwKICAgICAgICBidXR0b25TaXplWSwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudWkubWludXMpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIERFQ19CT1JERVIgPz8gY29udGFpbmVyQmFzZQogICAgKTsKICAgIGlmIChNSU5VU19URVhUKSB7CiAgICAgICAgbW9kLlNldFVJVGV4dFNpemUoTUlOVVNfVEVYVCwgMTIpOwogICAgICAgIG1vZC5TZXRVSVRleHRDb2xvcihNSU5VU19URVhULCBBRE1JTl9QQU5FTF9CVVRUT05fVEVYVF9DT0xPUik7CiAgICB9CgogICAgbW9kLkFkZFVJVGV4dChsYWJlbElkLCBtb2QuQ3JlYXRlVmVjdG9yKGJhc2VYICsgbGFiZWxPZmZzZXRYLCBiYXNlWSArIDExLCAwKSwgbW9kLkNyZWF0ZVZlY3RvcihsYWJlbFNpemVYLCBidXR0b25TaXplWSAtIDIyLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wTGVmdCwgbW9kLk1lc3NhZ2UobGFiZWxLZXkpLCBldmVudFBsYXllcik7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUobGFiZWxJZCwgbW9kLkdldFVJUm9vdCgpKSwgMTIpOwogICAgY29uc3QgTEFCRUwgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUobGFiZWxJZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoTEFCRUwsIDApOwogICAgYXBwbHlBZG1pblBhbmVsTGFiZWxUZXh0Q29sb3IoTEFCRUwpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KExBQkVMLCBjb250YWluZXJCYXNlKTsKCiAgICBhZGRPdXRsaW5lZEJ1dHRvbigKICAgICAgICBpbmNCdXR0b25JZCwKICAgICAgICBiYXNlWCArIGluY09mZnNldFgsCiAgICAgICAgYmFzZVksCiAgICAgICAgYnV0dG9uU2l6ZVgsCiAgICAgICAgYnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgY29udGFpbmVyQmFzZSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKCiAgICBjb25zdCBJTkNfQk9SREVSID0gc2FmZUZpbmQoaW5jQnV0dG9uSWQgKyAiX0JPUkRFUiIpOwogICAgY29uc3QgUExVU19URVhUID0gYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIHBsdXNUZXh0SWQsCiAgICAgICAgYnV0dG9uU2l6ZVgsCiAgICAgICAgYnV0dG9uU2l6ZVksCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnVpLnBsdXMpLAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIElOQ19CT1JERVIgPz8gY29udGFpbmVyQmFzZQogICAgKTsKICAgIGlmIChQTFVTX1RFWFQpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShQTFVTX1RFWFQsIDEyKTsKICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3IoUExVU19URVhULCBBRE1JTl9QQU5FTF9CVVRUT05fVEVYVF9DT0xPUik7CiAgICB9Cn0KCmZ1bmN0aW9uIGFkZFRlc3RlclJvd1dpdGhWYWx1ZSgKICAgIGV2ZW50UGxheWVyOiBtb2QuUGxheWVyLAogICAgY29udGFpbmVyQmFzZTogbW9kLlVJV2lkZ2V0LAogICAgcGxheWVySWQ6IG51bWJlciwKICAgIGJhc2VYOiBudW1iZXIsCiAgICBiYXNlWTogbnVtYmVyLAogICAgZGVjQnV0dG9uQmFzZUlkOiBzdHJpbmcsCiAgICBpbmNCdXR0b25CYXNlSWQ6IHN0cmluZywKICAgIGxhYmVsQmFzZUlkOiBzdHJpbmcsCiAgICB2YWx1ZUJhc2VJZDogc3RyaW5nLAogICAgbGFiZWxLZXk6IG51bWJlciwKICAgIGluaXRpYWxWYWx1ZTogbnVtYmVyLAogICAgYnV0dG9uU2l6ZVg6IG51bWJlciwKICAgIGJ1dHRvblNpemVZOiBudW1iZXIsCiAgICBsYWJlbFNpemVYOiBudW1iZXIsCiAgICB2YWx1ZVNpemVYOiBudW1iZXIsCiAgICBkZWNPZmZzZXRYOiBudW1iZXIsCiAgICBsYWJlbE9mZnNldFg6IG51bWJlciwKICAgIGluY09mZnNldFg6IG51bWJlcgopOiB2b2lkIHsKICAgIGFkZFRlc3RlclJvdyhldmVudFBsYXllciwgY29udGFpbmVyQmFzZSwgcGxheWVySWQsIGJhc2VYLCBiYXNlWSwKICAgICAgICBkZWNCdXR0b25CYXNlSWQsIGluY0J1dHRvbkJhc2VJZCwgbGFiZWxCYXNlSWQsIGxhYmVsS2V5LAogICAgICAgIGJ1dHRvblNpemVYLCBidXR0b25TaXplWSwgbGFiZWxTaXplWCwgZGVjT2Zmc2V0WCwgbGFiZWxPZmZzZXRYLCBpbmNPZmZzZXRYKTsKCiAgICBjb25zdCB2YWx1ZUlkID0gdmFsdWVCYXNlSWQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IHZhbHVlWCA9IGJhc2VYICsgaW5jT2Zmc2V0WCAtIC0zIC0gdmFsdWVTaXplWDsKCiAgICBtb2QuQWRkVUlUZXh0KHZhbHVlSWQsIG1vZC5DcmVhdGVWZWN0b3IodmFsdWVYLCBiYXNlWSArIDExLCAwKSwgbW9kLkNyZWF0ZVZlY3Rvcih2YWx1ZVNpemVYLCBidXR0b25TaXplWSAtIDIyLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wTGVmdCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgTWF0aC5mbG9vcihpbml0aWFsVmFsdWUpKSwgZXZlbnRQbGF5ZXIpOwogICAgbW9kLlNldFVJVGV4dFNpemUobW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKHZhbHVlSWQsIG1vZC5HZXRVSVJvb3QoKSksIDEyKTsKICAgIGNvbnN0IFZBTFVFX1RFWFQgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodmFsdWVJZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoVkFMVUVfVEVYVCwgMCk7CiAgICBhcHBseUFkbWluUGFuZWxMYWJlbFRleHRDb2xvcihWQUxVRV9URVhUKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChWQUxVRV9URVhULCBjb250YWluZXJCYXNlKTsKfQoKZnVuY3Rpb24gc3luY1JvdW5kS2lsbHNUYXJnZXRUZXN0ZXJWYWx1ZUZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCBwaWQgPSBnZXRPYmpJZChwKTsKICAgICAgICBjb25zdCB3aWRnZXQgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoVUlfVEVTVF9WQUxVRV9ST1VORF9LSUxMU19UQVJHRVRfSUQgKyBwaWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgaWYgKCF3aWRnZXQpIGNvbnRpbnVlOwogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3aWRnZXQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsIE1hdGguZmxvb3IoU3RhdGUucm91bmQua2lsbHNUYXJnZXQpKSk7CiAgICB9CiAgICB1cGRhdGVNYXRjaHVwUmVhZG91dHNGb3JBbGxQbGF5ZXJzKCk7Cn0KCmZ1bmN0aW9uIGFkZFRlc3RlclJlc2V0QnV0dG9uKAogICAgZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsCiAgICBjb250YWluZXJCYXNlOiBtb2QuVUlXaWRnZXQsCiAgICBwbGF5ZXJJZDogbnVtYmVyLAogICAgYmFzZVg6IG51bWJlciwKICAgIGJhc2VZOiBudW1iZXIsCiAgICB3aWR0aDogbnVtYmVyLAogICAgaGVpZ2h0OiBudW1iZXIKKTogdm9pZCB7CiAgICBjb25zdCBidXR0b25JZCA9IFVJX1RFU1RfQlVUVE9OX0NMT0NLX1JFU0VUX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBsYWJlbElkID0gVUlfVEVTVF9SRVNFVF9URVhUX0lEICsgcGxheWVySWQ7CgogICAgYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgYnV0dG9uSWQsCiAgICAgICAgYmFzZVgsCiAgICAgICAgYmFzZVksCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIGNvbnRhaW5lckJhc2UsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CgogICAgY29uc3QgcmVzZXRQYXJlbnQgPSBzYWZlRmluZChidXR0b25JZCArICJfQk9SREVSIikgPz8gY29udGFpbmVyQmFzZTsKICAgIGNvbnN0IHJlc2V0TGFiZWwgPSBhZGRDZW50ZXJlZEJ1dHRvblRleHQoCiAgICAgICAgbGFiZWxJZCwKICAgICAgICB3aWR0aCwKICAgICAgICBoZWlnaHQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmJ1dHRvbnMuY2xvY2tSZXNldCksCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgcmVzZXRQYXJlbnQKICAgICk7CiAgICBpZiAocmVzZXRMYWJlbCkgewogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKHJlc2V0TGFiZWwsIDEyKTsKICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3IocmVzZXRMYWJlbCwgQURNSU5fUEFORUxfQlVUVE9OX1RFWFRfQ09MT1IpOwogICAgfQp9CgpmdW5jdGlvbiBhZGRUZXN0ZXJBY3Rpb25CdXR0b24oCiAgICBldmVudFBsYXllcjogbW9kLlBsYXllciwKICAgIGNvbnRhaW5lckJhc2U6IG1vZC5VSVdpZGdldCwKICAgIHBsYXllcklkOiBudW1iZXIsCiAgICBiYXNlWDogbnVtYmVyLAogICAgYmFzZVk6IG51bWJlciwKICAgIHdpZHRoOiBudW1iZXIsCiAgICBoZWlnaHQ6IG51bWJlciwKICAgIGJ1dHRvbkJhc2VJZDogc3RyaW5nLAogICAgbGFiZWxCYXNlSWQ6IHN0cmluZywKICAgIGxhYmVsS2V5OiBudW1iZXIKKTogdm9pZCB7CiAgICBjb25zdCBidXR0b25JZCA9IGJ1dHRvbkJhc2VJZCArIHBsYXllcklkOwogICAgY29uc3QgbGFiZWxJZCA9IGxhYmVsQmFzZUlkICsgcGxheWVySWQ7CgogICAgYWRkT3V0bGluZWRCdXR0b24oCiAgICAgICAgYnV0dG9uSWQsCiAgICAgICAgYmFzZVgsCiAgICAgICAgYmFzZVksCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIGNvbnRhaW5lckJhc2UsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CgogICAgY29uc3QgYWN0aW9uUGFyZW50ID0gc2FmZUZpbmQoYnV0dG9uSWQgKyAiX0JPUkRFUiIpID8/IGNvbnRhaW5lckJhc2U7CiAgICBjb25zdCBhY3Rpb25MYWJlbCA9IGFkZENlbnRlcmVkQnV0dG9uVGV4dCgKICAgICAgICBsYWJlbElkLAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShsYWJlbEtleSksCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgYWN0aW9uUGFyZW50CiAgICApOwogICAgaWYgKGFjdGlvbkxhYmVsKSB7CiAgICAgICAgbW9kLlNldFVJVGV4dFNpemUoYWN0aW9uTGFiZWwsIDEyKTsKICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3IoYWN0aW9uTGFiZWwsIEFETUlOX1BBTkVMX0JVVFRPTl9URVhUX0NPTE9SKTsKICAgIH0KfQoKZnVuY3Rpb24gZW5zdXJlUG9zaXRpb25EZWJ1Z1dpZGdldHMocGxheWVyOiBtb2QuUGxheWVyKTogeyB4OiBtb2QuVUlXaWRnZXQ7IHk6IG1vZC5VSVdpZGdldDsgejogbW9kLlVJV2lkZ2V0OyByb3RZOiBtb2QuVUlXaWRnZXQgfSB8IHVuZGVmaW5lZCB7CiAgICBjb25zdCBwaWQgPSBtb2QuR2V0T2JqSWQocGxheWVyKTsKICAgIGNvbnN0IGNvbnRhaW5lcklkID0gVUlfUE9TX0RFQlVHX0NPTlRBSU5FUl9JRCArIHBpZDsKICAgIGNvbnN0IHhJZCA9IFVJX1BPU19ERUJVR19YX0lEICsgcGlkOwogICAgY29uc3QgeUlkID0gVUlfUE9TX0RFQlVHX1lfSUQgKyBwaWQ7CiAgICBjb25zdCB6SWQgPSBVSV9QT1NfREVCVUdfWl9JRCArIHBpZDsKICAgIGNvbnN0IHJvdFlJZCA9IFVJX1BPU19ERUJVR19ST1RZX0lEICsgcGlkOwoKICAgIGxldCBjb250YWluZXIgPSBzYWZlRmluZChjb250YWluZXJJZCk7CiAgICBpZiAoIWNvbnRhaW5lcikgewogICAgICAgIG1vZC5BZGRVSUNvbnRhaW5lcigKICAgICAgICAgICAgY29udGFpbmVySWQsCiAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMzAwLCAxNywgMCksIC8vICtYIHRvIG1vdmUgbGVmdCwgK1kgdG8gbW92ZSBkb3duCiAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMjAwLCAxOCwgMCksCiAgICAgICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICAgICAgbW9kLkdldFVJUm9vdCgpLAogICAgICAgICAgICBmYWxzZSwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigwLCAwLCAwKSwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJLAogICAgICAgICAgICBwbGF5ZXIKICAgICAgICApOwogICAgICAgIGNvbnRhaW5lciA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShjb250YWluZXJJZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIH0KICAgIGlmIChjb250YWluZXIpIHsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGNvbnRhaW5lciwgdHJ1ZSk7CiAgICB9CgogICAgY29uc3QgbWFrZVRleHQgPSAoaWQ6IHN0cmluZywgcG9zWDogbnVtYmVyKSA9PiB7CiAgICAgICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICAgICAgaWQsCiAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IocG9zWCwgMCwgMCksCiAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoODAsIDE4LCAwKSwKICAgICAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsIDApLAogICAgICAgICAgICBwbGF5ZXIKICAgICAgICApOwogICAgICAgIGNvbnN0IHcgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoaWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYSh3LCAwKTsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZSh3LCAxMCk7CiAgICAgICAgbW9kLlNldFVJVGV4dENvbG9yKHcsIG1vZC5DcmVhdGVWZWN0b3IoMSwgMSwgMSkpOwogICAgICAgIGlmIChjb250YWluZXIpIG1vZC5TZXRVSVdpZGdldFBhcmVudCh3LCBjb250YWluZXIpOwogICAgICAgIHJldHVybiB3OwogICAgfTsKCiAgICAvLyAwLCA1MCwgOTAsIDE0MCBhcmUgc3BhY2luZyB2YWx1ZXMgZm9yIHRoZSA0IHRleHQgd2lkZ2V0cwogICAgbGV0IHggPSBzYWZlRmluZCh4SWQpOwogICAgaWYgKCF4KSB4ID0gbWFrZVRleHQoeElkLCAwKTsKICAgIGxldCB5ID0gc2FmZUZpbmQoeUlkKTsKICAgIGlmICgheSkgeSA9IG1ha2VUZXh0KHlJZCwgNTApOwogICAgbGV0IHogPSBzYWZlRmluZCh6SWQpOwogICAgaWYgKCF6KSB6ID0gbWFrZVRleHQoeklkLCA5MCk7CiAgICBsZXQgcm90WSA9IHNhZmVGaW5kKHJvdFlJZCk7CiAgICBpZiAoIXJvdFkpIHJvdFkgPSBtYWtlVGV4dChyb3RZSWQsIDE0MCk7CgogICAgaWYgKCF4IHx8ICF5IHx8ICF6IHx8ICFyb3RZKSByZXR1cm4gdW5kZWZpbmVkOwogICAgcmV0dXJuIHsgeCwgeSwgeiwgcm90WSB9Owp9Cgphc3luYyBmdW5jdGlvbiBwb3NpdGlvbkRlYnVnTG9vcChwbGF5ZXI6IG1vZC5QbGF5ZXIsIGV4cGVjdGVkVG9rZW46IG51bWJlcik6IFByb21pc2U8dm9pZD4gewogICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHBsYXllcik7CiAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgIGNvbnN0IHN0YXRlID0gU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwaWRdOwogICAgICAgIGlmICghc3RhdGUgfHwgIXN0YXRlLnBvc0RlYnVnVmlzaWJsZSB8fCBzdGF0ZS5wb3NEZWJ1Z1Rva2VuICE9PSBleHBlY3RlZFRva2VuKSByZXR1cm47CiAgICAgICAgaWYgKCFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXIpKSByZXR1cm47CiAgICAgICAgaWYgKCFpc1BsYXllckRlcGxveWVkKHBsYXllcikpIHJldHVybjsKCiAgICAgICAgY29uc3Qgd2lkZ2V0cyA9IGVuc3VyZVBvc2l0aW9uRGVidWdXaWRnZXRzKHBsYXllcik7CiAgICAgICAgaWYgKCF3aWRnZXRzKSByZXR1cm47CgogICAgICAgIGNvbnN0IHBvcyA9IHNhZmVHZXRTb2xkaWVyU3RhdGVWZWN0b3IocGxheWVyLCBtb2QuU29sZGllclN0YXRlVmVjdG9yLkdldFBvc2l0aW9uKTsKICAgICAgICBjb25zdCBmYWNpbmcgPSBzYWZlR2V0U29sZGllclN0YXRlVmVjdG9yKHBsYXllciwgbW9kLlNvbGRpZXJTdGF0ZVZlY3Rvci5HZXRGYWNpbmdEaXJlY3Rpb24pOwogICAgICAgIGlmICghcG9zIHx8ICFmYWNpbmcpIHJldHVybjsKCiAgICAgICAgY29uc3Qgcm91bmRUbzMgPSAodmFsdWU6IG51bWJlcikgPT4gTWF0aC5yb3VuZCh2YWx1ZSAqIDEwMDApIC8gMTAwMDsKICAgICAgICBjb25zdCB5YXdSYWQgPSBNYXRoLmF0YW4yKG1vZC5YQ29tcG9uZW50T2YoZmFjaW5nKSwgbW9kLlpDb21wb25lbnRPZihmYWNpbmcpKTsKICAgICAgICBjb25zdCB5YXdEZWcgPSAoeWF3UmFkICogMTgwKSAvIE1hdGguUEk7CgogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3aWRnZXRzLngsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsIHJvdW5kVG8zKG1vZC5YQ29tcG9uZW50T2YocG9zKSkpKTsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwod2lkZ2V0cy55LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCByb3VuZFRvMyhtb2QuWUNvbXBvbmVudE9mKHBvcykpKSk7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHdpZGdldHMueiwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgcm91bmRUbzMobW9kLlpDb21wb25lbnRPZihwb3MpKSkpOwogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3aWRnZXRzLnJvdFksIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsIHJvdW5kVG8zKHlhd0RlZykpKTsKCiAgICAgICAgYXdhaXQgbW9kLldhaXQoMi4wKTsKICAgIH0KfQoKZnVuY3Rpb24gc2V0UG9zaXRpb25EZWJ1Z1Zpc2libGVGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyLCB2aXNpYmxlOiBib29sZWFuKTogdm9pZCB7CiAgICBjb25zdCBwaWQgPSBtb2QuR2V0T2JqSWQocGxheWVyKTsKICAgIGNvbnN0IHN0YXRlID0gU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwaWRdOwogICAgaWYgKCFzdGF0ZSkgcmV0dXJuOwoKICAgIGNvbnN0IHdpZGdldHMgPSBlbnN1cmVQb3NpdGlvbkRlYnVnV2lkZ2V0cyhwbGF5ZXIpOwogICAgaWYgKCF3aWRnZXRzKSByZXR1cm47CgogICAgY29uc3QgY29udGFpbmVyID0gc2FmZUZpbmQoVUlfUE9TX0RFQlVHX0NPTlRBSU5FUl9JRCArIHBpZCk7CiAgICBpZiAoY29udGFpbmVyKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGNvbnRhaW5lciwgdmlzaWJsZSk7CgogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXRzLngsIHZpc2libGUpOwogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXRzLnksIHZpc2libGUpOwogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXRzLnosIHZpc2libGUpOwogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXRzLnJvdFksIHZpc2libGUpOwoKICAgIHN0YXRlLnBvc0RlYnVnVG9rZW4gPSAoc3RhdGUucG9zRGVidWdUb2tlbiArIDEpICUgMTAwMDAwMDAwMDsKICAgIGlmICh2aXNpYmxlKSB7CiAgICAgICAgdm9pZCBwb3NpdGlvbkRlYnVnTG9vcChwbGF5ZXIsIHN0YXRlLnBvc0RlYnVnVG9rZW4pOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gQWRtaW4gUGFuZWwgVUkgYnVpbGRlciBoZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgLSBSb3N0ZXIgUmVuZGVyICsgVG9nZ2xlIExhYmVscyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gQnVpbGRzIHRoZSBlbnRpcmUgVGVhbSBTd2l0Y2ggKyBBZG1pbiBQYW5lbCBkaWFsb2cuCi8vIFJlc3BvbnNpYmlsaXRpZXM6Ci8vIC0gQ3JlYXRlcyBsZWZ0IHRlYW0sIHJpZ2h0IHRlYW0sIGFuZCBhZG1pbiBwYW5lbCBVSSBzZWN0aW9ucwovLyAtIERlZmluZXMgbGF5b3V0IGNvbnN0YW50cyBhbmQgcm93IG1hdGggZm9yIHRoZSBhZG1pbiBwYW5lbAovLyAtIFdpcmVzIGFsbCBhZG1pbiBidXR0b25zIHRvIGF1dGhvcml0YXRpdmUgbWF0Y2ggc3RhdGUgbXV0YXRpb25zCi8vIC0gRW5zdXJlcyBwZXItcGxheWVyIFVJIHJvb3RzIGFyZSBjcmVhdGVkIG9uY2UgYW5kIHJldXNlZAoKLy8gUG9wdWxhdGVzIHRoZSByb3N0ZXIgVUkgZm9yIHRoZSBnaXZlbiB2aWV3ZXIuIAovLyAtIFJlYWwgYWN0aXZlIHBsYXllciBsaXN0cyArIHRlYW0gYXNzaWdubWVudAovLyAtIERlZmF1bHQgc3RhdHVzIHZhbHVlcyAoTk9UIFJFQURZIC8gSU4gTUFJTiBCQVNFKSBmb3IgYWxsIHJvd3MKLy8gTGF0ZXIgcGhhc2VzIHdpbGwgcmVwbGFjZSBkZWZhdWx0cyB3aXRoIGF1dGhvcml0YXRpdmUgcGVyLXBsYXllciBzdGF0ZSArIGdhdGluZyArIHJvdW5kIGludGVncmF0aW9uLgoKLy8gQXBwbGllcyBwZXItcm93IGNvbG9yIHBvbGljeSBmb3IgdGhlIFJlYWR5IGRpYWxvZzoKLy8gLSBQbGF5ZXIgbmFtZTogd2hpdGUgYnkgZGVmYXVsdDsgZ3JlZW4gb25seSB3aGVuIEJPVEggcmVhZHkgQU5EIGluIG1haW4gYmFzZS4KLy8gLSBSRUFEWSAvIElOIE1BSU4gQkFTRTogZ3JlZW4KLy8gLSBOT1QgUkVBRFkgLyBOT1QgSU4gTUFJTiBCQVNFOiByZWQKZnVuY3Rpb24gYXBwbHlSZWFkeURpYWxvZ1Jvd0NvbG9ycyhuYW1lV2lkZ2V0OiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQsIHJlYWR5V2lkZ2V0OiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQsIGJhc2VXaWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCwgaXNSZWFkeTogYm9vbGVhbiwgaXNJbkJhc2U6IGJvb2xlYW4pOiB2b2lkIHsKICAgIGlmIChyZWFkeVdpZGdldCkgbW9kLlNldFVJVGV4dENvbG9yKHJlYWR5V2lkZ2V0LCBpc1JlYWR5ID8gQ09MT1JfUkVBRFlfR1JFRU4gOiBDT0xPUl9OT1RfUkVBRFlfUkVEKTsKICAgIGlmIChiYXNlV2lkZ2V0KSBtb2QuU2V0VUlUZXh0Q29sb3IoYmFzZVdpZGdldCwgaXNJbkJhc2UgPyBDT0xPUl9SRUFEWV9HUkVFTiA6IENPTE9SX05PVF9SRUFEWV9SRUQpOwogICAgaWYgKG5hbWVXaWRnZXQpIG1vZC5TZXRVSVRleHRDb2xvcihuYW1lV2lkZ2V0LCAoaXNSZWFkeSAmJiBpc0luQmFzZSkgPyBDT0xPUl9SRUFEWV9HUkVFTiA6IENPTE9SX05PUk1BTCk7Cn0KCi8vIFJlbmRlcnMgdGhlIGVudGlyZSBSZWFkeSBVcCBkaWFsb2cgc3RhdGUgZm9yIGEgc2luZ2xlIHZpZXdlci4KLy8gQ2VudHJhbGl6aW5nIFVJIHVwZGF0ZXMgcmVkdWNlcyByZWZyZXNoIHJlZ3Jlc3Npb25zIGFzIHRoZSBkaWFsb2cgZ3Jvd3MgaW4gY29tcGxleGl0eS4KZnVuY3Rpb24gcmVuZGVyUmVhZHlEaWFsb2dGb3JWaWV3ZXIoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsIHZpZXdlclBpZDogbnVtYmVyKTogdm9pZCB7CiAgICByZWZyZXNoUmVhZHlEaWFsb2dSb3N0ZXJGb3JWaWV3ZXIoZXZlbnRQbGF5ZXIsIHZpZXdlclBpZCk7CiAgICB1cGRhdGVSZWFkeVRvZ2dsZUJ1dHRvbkZvclZpZXdlcihldmVudFBsYXllciwgdmlld2VyUGlkKTsKICAgIHVwZGF0ZUF1dG9SZWFkeVRvZ2dsZUJ1dHRvbkZvclZpZXdlcihldmVudFBsYXllciwgdmlld2VyUGlkKTsKCn0KCi8vIFJlbmRlcnMgdGhlIGRpYWxvZyBmb3IgYWxsIHBsYXllcnMgd2hvIGN1cnJlbnRseSBoYXZlIGl0IG9wZW4uCi8vIENvZGUgQ2xlYW51cDogT3ZlcmxhcHMgd2l0aCByZWZyZXNoUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VyczsgY29uc2lkZXIgY29uc29saWRhdGluZyB0byBvbmUgZW50cnlwb2ludC4KLyoqCiAqIEJyb2FkY2FzdC1zdHlsZSByZWZyZXNoIGZvciB0aGUgcmVhZHkgZGlhbG9nLgogKiBDYWxsIHdoZW5ldmVyIHJvc3RlciBtZW1iZXJzaGlwIG9yIHBlci1wbGF5ZXIgZGlzcGxheSBzdGF0ZSBjaGFuZ2VzIChyZWFkeSAvIGluLW1haW4tYmFzZSAvIHRlYW0pLgogKi8KZnVuY3Rpb24gcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycygpOiB2b2lkIHsKICAgIGZvciAoY29uc3QgcGlkU3RyIGluIFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGEpIHsKICAgICAgICBjb25zdCBwaWQgPSBOdW1iZXIocGlkU3RyKTsKICAgICAgICBjb25zdCBzdGF0ZSA9IFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGlkXTsKICAgICAgICBpZiAoIXN0YXRlIHx8ICFzdGF0ZS5kaWFsb2dWaXNpYmxlKSBjb250aW51ZTsKICAgICAgICBjb25zdCB2aWV3ZXIgPSBzYWZlRmluZFBsYXllcihwaWQpOwogICAgICAgIGlmICghdmlld2VyKSBjb250aW51ZTsKICAgICAgICByZW5kZXJSZWFkeURpYWxvZ0ZvclZpZXdlcih2aWV3ZXIsIHBpZCk7CiAgICB9Cn0KCmZ1bmN0aW9uIHJlZnJlc2hSZWFkeURpYWxvZ1Jvc3RlckZvclZpZXdlcih2aWV3ZXI6IG1vZC5QbGF5ZXIsIHZpZXdlclBsYXllcklkOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IHJvc3RlciA9IGdldFJvc3RlckRpc3BsYXlFbnRyaWVzKCk7CiAgICBjb25zdCB0MVBsYXllcnMgPSByb3N0ZXIudGVhbTE7CiAgICBjb25zdCB0MlBsYXllcnMgPSByb3N0ZXIudGVhbTI7CgogICAgY29uc3QgbWF4Um93c1BlclRlYW0gPSBURUFNX1JPU1RFUl9NQVhfUk9XUzsKICAgIGNvbnN0IGVtcHR5TXNnID0gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgIiIpOwogICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgbWF4Um93c1BlclRlYW07IHJvdysrKSB7CiAgICAgICAgY29uc3QgdDFOYW1lSWQgPSBVSV9SRUFEWV9ESUFMT0dfVDFfUk9XX05BTUVfSUQgKyB2aWV3ZXJQbGF5ZXJJZCArICJfIiArIHJvdzsKICAgICAgICBjb25zdCB0MVJlYWR5SWQgPSBVSV9SRUFEWV9ESUFMT0dfVDFfUk9XX1JFQURZX0lEICsgdmlld2VyUGxheWVySWQgKyAiXyIgKyByb3c7CiAgICAgICAgY29uc3QgdDFCYXNlSWQgPSBVSV9SRUFEWV9ESUFMT0dfVDFfUk9XX0JBU0VfSUQgKyB2aWV3ZXJQbGF5ZXJJZCArICJfIiArIHJvdzsKCiAgICAgICAgY29uc3QgdDJOYW1lSWQgPSBVSV9SRUFEWV9ESUFMT0dfVDJfUk9XX05BTUVfSUQgKyB2aWV3ZXJQbGF5ZXJJZCArICJfIiArIHJvdzsKICAgICAgICBjb25zdCB0MlJlYWR5SWQgPSBVSV9SRUFEWV9ESUFMT0dfVDJfUk9XX1JFQURZX0lEICsgdmlld2VyUGxheWVySWQgKyAiXyIgKyByb3c7CiAgICAgICAgY29uc3QgdDJCYXNlSWQgPSBVSV9SRUFEWV9ESUFMT0dfVDJfUk9XX0JBU0VfSUQgKyB2aWV3ZXJQbGF5ZXJJZCArICJfIiArIHJvdzsKCiAgICAgICAgY29uc3QgdDFOYW1lID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKHQxTmFtZUlkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIGNvbnN0IHQxUmVhZHkgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodDFSZWFkeUlkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIGNvbnN0IHQxQmFzZSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZSh0MUJhc2VJZCwgbW9kLkdldFVJUm9vdCgpKTsKCiAgICAgICAgY29uc3QgdDJOYW1lID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKHQyTmFtZUlkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIGNvbnN0IHQyUmVhZHkgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodDJSZWFkeUlkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIGNvbnN0IHQyQmFzZSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZSh0MkJhc2VJZCwgbW9kLkdldFVJUm9vdCgpKTsKCiAgICAgICAgY29uc3QgdDFFbnRyeSA9IChyb3cgPCB0MVBsYXllcnMubGVuZ3RoKSA/IHQxUGxheWVyc1tyb3ddIDogdW5kZWZpbmVkOwogICAgICAgIGNvbnN0IHQyRW50cnkgPSAocm93IDwgdDJQbGF5ZXJzLmxlbmd0aCkgPyB0MlBsYXllcnNbcm93XSA6IHVuZGVmaW5lZDsKICAgICAgICBjb25zdCBwMSA9IHQxRW50cnk/LnBsYXllcjsKICAgICAgICBjb25zdCBwMiA9IHQyRW50cnk/LnBsYXllcjsKCiAgICAgICAgLy8gSGlkZSB1bnVzZWQgcGxhY2Vob2xkZXIgcm93cyAocHJldmVudHMgJ3Vua25vd24gc3RyaW5nJyBhcnRpZmFjdHMgYW5kIHJlZHVjZXMgdmlzdWFsIG5vaXNlKS4KICAgICAgICBjb25zdCBoYXNQMSA9ICEhdDFFbnRyeTsKICAgICAgICBjb25zdCBoYXNQMiA9ICEhdDJFbnRyeTsKICAgICAgICBpZiAodDFOYW1lKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHQxTmFtZSwgaGFzUDEpOwogICAgICAgIGlmICh0MVJlYWR5KSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHQxUmVhZHksIGhhc1AxKTsKICAgICAgICBpZiAodDFCYXNlKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHQxQmFzZSwgaGFzUDEpOwogICAgICAgIGlmICh0Mk5hbWUpIG1vZC5TZXRVSVdpZGdldFZpc2libGUodDJOYW1lLCBoYXNQMik7CiAgICAgICAgaWYgKHQyUmVhZHkpIG1vZC5TZXRVSVdpZGdldFZpc2libGUodDJSZWFkeSwgaGFzUDIpOwogICAgICAgIGlmICh0MkJhc2UpIG1vZC5TZXRVSVdpZGdldFZpc2libGUodDJCYXNlLCBoYXNQMik7CgogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCh0MU5hbWUsIGhhc1AxID8gZ2V0Um9zdGVyRW50cnlOYW1lTWVzc2FnZSh0MUVudHJ5KSA6IGVtcHR5TXNnKTsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwoCiAgICAgICAgICAgIHQxUmVhZHksCiAgICAgICAgICAgIGhhc1AxCiAgICAgICAgICAgICAgICA/IChwMQogICAgICAgICAgICAgICAgICAgID8gKFN0YXRlLnBsYXllcnMucmVhZHlCeVBpZFttb2QuR2V0T2JqSWQocDEpXSA/IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5zdGF0dXMucmVhZHkpIDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnN0YXR1cy5ub3RSZWFkeSkpCiAgICAgICAgICAgICAgICAgICAgOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuc3RhdHVzLm5vdFJlYWR5KSkKICAgICAgICAgICAgICAgIDogZW1wdHlNc2cKICAgICAgICApOwogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAgdDFCYXNlLAogICAgICAgICAgICBoYXNQMQogICAgICAgICAgICAgICAgPyAocDEKICAgICAgICAgICAgICAgICAgICA/IChpc1BsYXllckluTWFpbkJhc2VGb3JSZWFkeShtb2QuR2V0T2JqSWQocDEpKSA/IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5iYXNlU3RhdHVzLmluKSA6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5iYXNlU3RhdHVzLm91dCkpCiAgICAgICAgICAgICAgICAgICAgOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuYmFzZVN0YXR1cy5vdXQpKQogICAgICAgICAgICAgICAgOiBlbXB0eU1zZwogICAgICAgICk7CiAgICAgICAgaWYgKHAxKSB7CiAgICAgICAgICAgIGNvbnN0IHAxSWQgPSBtb2QuR2V0T2JqSWQocDEpOwogICAgICAgICAgICBjb25zdCBwMVJlYWR5ID0gISFTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcDFJZF07CiAgICAgICAgICAgIGNvbnN0IHAxSW5CYXNlID0gaXNQbGF5ZXJJbk1haW5CYXNlRm9yUmVhZHkocDFJZCk7CiAgICAgICAgICAgIGFwcGx5UmVhZHlEaWFsb2dSb3dDb2xvcnModDFOYW1lLCB0MVJlYWR5LCB0MUJhc2UsIHAxUmVhZHksIHAxSW5CYXNlKTsKICAgICAgICB9IGVsc2UgaWYgKGhhc1AxKSB7CiAgICAgICAgICAgIGFwcGx5UmVhZHlEaWFsb2dSb3dDb2xvcnModDFOYW1lLCB0MVJlYWR5LCB0MUJhc2UsIGZhbHNlLCBmYWxzZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gRW1wdHkgcm93OiBkZWZhdWx0IHRvIHdoaXRlIGZvciBhbnkgcGxhY2Vob2xkZXIgdGV4dC4KICAgICAgICAgICAgaWYgKHQxTmFtZSkgbW9kLlNldFVJVGV4dENvbG9yKHQxTmFtZSwgQ09MT1JfTk9STUFMKTsKICAgICAgICAgICAgaWYgKHQxUmVhZHkpIG1vZC5TZXRVSVRleHRDb2xvcih0MVJlYWR5LCBDT0xPUl9OT1JNQUwpOwogICAgICAgICAgICBpZiAodDFCYXNlKSBtb2QuU2V0VUlUZXh0Q29sb3IodDFCYXNlLCBDT0xPUl9OT1JNQUwpOwogICAgICAgIH0KCiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHQyTmFtZSwgaGFzUDIgPyBnZXRSb3N0ZXJFbnRyeU5hbWVNZXNzYWdlKHQyRW50cnkpIDogZW1wdHlNc2cpOwogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAgdDJSZWFkeSwKICAgICAgICAgICAgaGFzUDIKICAgICAgICAgICAgICAgID8gKHAyCiAgICAgICAgICAgICAgICAgICAgPyAoU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW21vZC5HZXRPYmpJZChwMildID8gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnN0YXR1cy5yZWFkeSkgOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuc3RhdHVzLm5vdFJlYWR5KSkKICAgICAgICAgICAgICAgICAgICA6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5zdGF0dXMubm90UmVhZHkpKQogICAgICAgICAgICAgICAgOiBlbXB0eU1zZwogICAgICAgICk7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKAogICAgICAgICAgICB0MkJhc2UsCiAgICAgICAgICAgIGhhc1AyCiAgICAgICAgICAgICAgICA/IChwMgogICAgICAgICAgICAgICAgICAgID8gKGlzUGxheWVySW5NYWluQmFzZUZvclJlYWR5KG1vZC5HZXRPYmpJZChwMikpID8gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJhc2VTdGF0dXMuaW4pIDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJhc2VTdGF0dXMub3V0KSkKICAgICAgICAgICAgICAgICAgICA6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5iYXNlU3RhdHVzLm91dCkpCiAgICAgICAgICAgICAgICA6IGVtcHR5TXNnCiAgICAgICAgKTsKICAgICAgICBpZiAocDIpIHsKICAgICAgICAgICAgY29uc3QgcDJJZCA9IG1vZC5HZXRPYmpJZChwMik7CiAgICAgICAgICAgIGNvbnN0IHAyUmVhZHkgPSAhIVN0YXRlLnBsYXllcnMucmVhZHlCeVBpZFtwMklkXTsKICAgICAgICAgICAgY29uc3QgcDJJbkJhc2UgPSBpc1BsYXllckluTWFpbkJhc2VGb3JSZWFkeShwMklkKTsKICAgICAgICAgICAgYXBwbHlSZWFkeURpYWxvZ1Jvd0NvbG9ycyh0Mk5hbWUsIHQyUmVhZHksIHQyQmFzZSwgcDJSZWFkeSwgcDJJbkJhc2UpOwogICAgICAgIH0gZWxzZSBpZiAoaGFzUDIpIHsKICAgICAgICAgICAgYXBwbHlSZWFkeURpYWxvZ1Jvd0NvbG9ycyh0Mk5hbWUsIHQyUmVhZHksIHQyQmFzZSwgZmFsc2UsIGZhbHNlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAodDJOYW1lKSBtb2QuU2V0VUlUZXh0Q29sb3IodDJOYW1lLCBDT0xPUl9OT1JNQUwpOwogICAgICAgICAgICBpZiAodDJSZWFkeSkgbW9kLlNldFVJVGV4dENvbG9yKHQyUmVhZHksIENPTE9SX05PUk1BTCk7CiAgICAgICAgICAgIGlmICh0MkJhc2UpIG1vZC5TZXRVSVRleHRDb2xvcih0MkJhc2UsIENPTE9SX05PUk1BTCk7CiAgICAgICAgfQogICAgfQp9CgovLyBVcGRhdGVzIHRoZSBSZWFkeSB0b2dnbGUgYnV0dG9uIGxhYmVsIGZvciB0aGUgZ2l2ZW4gdmlld2VyIGJhc2VkIG9uIHRoYXQgdmlld2VyJ3MgY3VycmVudCByZWFkeSBzdGF0ZS4KZnVuY3Rpb24gdXBkYXRlUmVhZHlUb2dnbGVCdXR0b25Gb3JWaWV3ZXIodmlld2VyOiBtb2QuUGxheWVyLCB2aWV3ZXJQbGF5ZXJJZDogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCBidG5MYWJlbElkID0gVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9SRUFEWV9MQUJFTF9JRCArIHZpZXdlclBsYXllcklkOwogICAgY29uc3QgbGFiZWxXaWRnZXQgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoYnRuTGFiZWxJZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIGlmICghbGFiZWxXaWRnZXQpIHJldHVybjsKCiAgICBjb25zdCBpc1JlYWR5ID0gISFTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbdmlld2VyUGxheWVySWRdOwogICAgY29uc3QgbGFiZWxNc2cgPSBpc1JlYWR5CiAgICAgICAgPyBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuYnV0dG9ucy5ub3RSZWFkeSkKICAgICAgICA6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5idXR0b25zLnJlYWR5KTsKCiAgICBtb2QuU2V0VUlUZXh0TGFiZWwobGFiZWxXaWRnZXQsIGxhYmVsTXNnKTsKfQoKLy8gVXBkYXRlcyB0aGUgQXV0by1SZWFkeSB0b2dnbGUgYnV0dG9uIGxhYmVsIGZvciB0aGUgZ2l2ZW4gdmlld2VyIGJhc2VkIG9uIHRoYXQgdmlld2VyJ3MgY3VycmVudCBhdXRvLXJlYWR5IHN0YXRlLgpmdW5jdGlvbiB1cGRhdGVBdXRvUmVhZHlUb2dnbGVCdXR0b25Gb3JWaWV3ZXIodmlld2VyOiBtb2QuUGxheWVyLCB2aWV3ZXJQbGF5ZXJJZDogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCBidG5MYWJlbElkID0gVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9BVVRPX1JFQURZX0xBQkVMX0lEICsgdmlld2VyUGxheWVySWQ7CiAgICBjb25zdCBsYWJlbFdpZGdldCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShidG5MYWJlbElkLCBtb2QuR2V0VUlSb290KCkpOwogICAgaWYgKCFsYWJlbFdpZGdldCkgcmV0dXJuOwoKICAgIGNvbnN0IGlzQXV0b1JlYWR5ID0gISFTdGF0ZS5wbGF5ZXJzLmF1dG9SZWFkeUJ5UGlkW3ZpZXdlclBsYXllcklkXTsKICAgIGNvbnN0IGxhYmVsTXNnID0gaXNBdXRvUmVhZHkKICAgICAgICA/IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5idXR0b25zLmF1dG9SZWFkeURpc2FibGUpCiAgICAgICAgOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuYnV0dG9ucy5hdXRvUmVhZHlFbmFibGUpOwoKICAgIG1vZC5TZXRVSVRleHRMYWJlbChsYWJlbFdpZGdldCwgbGFiZWxNc2cpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIC0gUm9zdGVyIFJlbmRlciArIFRvZ2dsZSBMYWJlbHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIE1hcC9Nb2RlIENvbmZpZyBVSSBSZWFkb3V0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBVcGRhdGVzIHRoZSBSZWFkeSBVcCBkaWFsb2cgIkJlc3Qgb2YgezB9IFJvdW5kcyIgbGFiZWwgZm9yIGEgc2luZ2xlIHZpZXdlci4KZnVuY3Rpb24gdXBkYXRlQmVzdE9mUm91bmRzTGFiZWxGb3JQaWQocGlkOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IGxhYmVsSWQgPSBVSV9SRUFEWV9ESUFMT0dfQkVTVE9GX0xBQkVMX0lEICsgcGlkOwogICAgY29uc3QgbGFiZWxXaWRnZXQgPSBzYWZlRmluZChsYWJlbElkKTsKICAgIGlmICghbGFiZWxXaWRnZXQpIHJldHVybjsKICAgIG1vZC5TZXRVSVRleHRMYWJlbChsYWJlbFdpZGdldCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJlc3RPZkxhYmVsLCBNYXRoLmZsb29yKFN0YXRlLnJvdW5kLm1heCkpKTsKfQoKZnVuY3Rpb24gdXBkYXRlQmVzdE9mUm91bmRzTGFiZWxGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICB1cGRhdGVCZXN0T2ZSb3VuZHNMYWJlbEZvclBpZChtb2QuR2V0T2JqSWQocCkpOwogICAgfQp9CgpmdW5jdGlvbiB1cGRhdGVSZWFkeURpYWxvZ01hcExhYmVsRm9yUGlkKHBpZDogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCB2YWx1ZUlkID0gVUlfUkVBRFlfRElBTE9HX01BUF9WQUxVRV9JRCArIHBpZDsKICAgIGNvbnN0IHZhbHVlV2lkZ2V0ID0gc2FmZUZpbmQodmFsdWVJZCk7CiAgICBpZiAoIXZhbHVlV2lkZ2V0KSByZXR1cm47CiAgICBtb2QuU2V0VUlUZXh0TGFiZWwodmFsdWVXaWRnZXQsIG1vZC5NZXNzYWdlKGdldE1hcE5hbWVLZXkoQUNUSVZFX01BUF9LRVkpKSk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZVJlYWR5RGlhbG9nTWFwTGFiZWxGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICB1cGRhdGVSZWFkeURpYWxvZ01hcExhYmVsRm9yUGlkKG1vZC5HZXRPYmpJZChwKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIHVwZGF0ZVJlYWR5RGlhbG9nTW9kZUNvbmZpZ0ZvclBpZChwaWQ6IG51bWJlcik6IHZvaWQgewogICAgY29uc3QgY2ZnID0gU3RhdGUucm91bmQubW9kZUNvbmZpZzsKCiAgICBjb25zdCBnYW1lTGFiZWwgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTU9ERV9HQU1FX0xBQkVMX0lEICsgcGlkKTsKICAgIGlmIChnYW1lTGFiZWwpIG1vZC5TZXRVSVRleHRMYWJlbChnYW1lTGFiZWwsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5nYW1lTW9kZUxhYmVsKSk7CiAgICBjb25zdCBnYW1lVmFsdWUgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTU9ERV9HQU1FX1ZBTFVFX0lEICsgcGlkKTsKICAgIGlmIChnYW1lVmFsdWUpIG1vZC5TZXRVSVRleHRMYWJlbChnYW1lVmFsdWUsIG1vZC5NZXNzYWdlKGNmZy5nYW1lTW9kZSkpOwoKICAgIGNvbnN0IHNldHRpbmdzTGFiZWwgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTU9ERV9TRVRUSU5HU19MQUJFTF9JRCArIHBpZCk7CiAgICBpZiAoc2V0dGluZ3NMYWJlbCkgbW9kLlNldFVJVGV4dExhYmVsKHNldHRpbmdzTGFiZWwsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5tb2RlU2V0dGluZ3NMYWJlbCkpOwogICAgY29uc3Qgc2V0dGluZ3NWYWx1ZSA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19NT0RFX1NFVFRJTkdTX1ZBTFVFX0lEICsgcGlkKTsKICAgIGlmIChzZXR0aW5nc1ZhbHVlKSB7CiAgICAgICAgY29uc3QgYXBwbHlDdXN0b21DZWlsaW5nID0gc2hvdWxkQXBwbHlDdXN0b21DZWlsaW5nRm9yQ29uZmlnKGNmZy5nYW1lTW9kZSwgY2ZnLmFpcmNyYWZ0Q2VpbGluZ092ZXJyaWRlUGVuZGluZyk7CiAgICAgICAgY29uc3QgY2VpbGluZ1ZhbHVlID0gYXBwbHlDdXN0b21DZWlsaW5nCiAgICAgICAgICAgID8gTWF0aC5mbG9vcihjZmcuYWlyY3JhZnRDZWlsaW5nKQogICAgICAgICAgICA6IFNUUl9SRUFEWV9ESUFMT0dfQUlSQ1JBRlRfQ0VJTElOR19WQU5JTExBOwogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAgc2V0dGluZ3NWYWx1ZSwKICAgICAgICAgICAgbW9kLk1lc3NhZ2UoY2ZnLmdhbWVTZXR0aW5ncywgY2VpbGluZ1ZhbHVlKQogICAgICAgICk7CiAgICB9CgogICAgY29uc3QgdmVoaWNsZXNUMUxhYmVsID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfTEFCRUxfSUQgKyBwaWQpOwogICAgaWYgKHZlaGljbGVzVDFMYWJlbCkgewogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAgdmVoaWNsZXNUMUxhYmVsLAogICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cudmVoaWNsZXNMYWJlbEZvcm1hdCwgZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0xKSkKICAgICAgICApOwogICAgfQogICAgY29uc3QgdmVoaWNsZXNUMVZhbHVlID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01PREVfVkVISUNMRVNfVDFfVkFMVUVfSUQgKyBwaWQpOwogICAgaWYgKHZlaGljbGVzVDFWYWx1ZSkgbW9kLlNldFVJVGV4dExhYmVsKHZlaGljbGVzVDFWYWx1ZSwgbW9kLk1lc3NhZ2UoY2ZnLnZlaGljbGVzVDEpKTsKCiAgICBjb25zdCB2ZWhpY2xlc1QyTGFiZWwgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMl9MQUJFTF9JRCArIHBpZCk7CiAgICBpZiAodmVoaWNsZXNUMkxhYmVsKSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKAogICAgICAgICAgICB2ZWhpY2xlc1QyTGFiZWwsCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy52ZWhpY2xlc0xhYmVsRm9ybWF0LCBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTIpKQogICAgICAgICk7CiAgICB9CiAgICBjb25zdCB2ZWhpY2xlc1QyVmFsdWUgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTU9ERV9WRUhJQ0xFU19UMl9WQUxVRV9JRCArIHBpZCk7CiAgICBpZiAodmVoaWNsZXNUMlZhbHVlKSBtb2QuU2V0VUlUZXh0TGFiZWwodmVoaWNsZXNUMlZhbHVlLCBtb2QuTWVzc2FnZShjZmcudmVoaWNsZXNUMikpOwp9CgpmdW5jdGlvbiB1cGRhdGVSZWFkeURpYWxvZ01vZGVDb25maWdGb3JBbGxWaXNpYmxlVmlld2VycygpOiB2b2lkIHsKICAgIGZvciAoY29uc3QgcGlkU3RyIGluIFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGEpIHsKICAgICAgICBjb25zdCBwaWQgPSBOdW1iZXIocGlkU3RyKTsKICAgICAgICBjb25zdCBzdGF0ZSA9IFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGlkXTsKICAgICAgICBpZiAoIXN0YXRlIHx8ICFzdGF0ZS5kaWFsb2dWaXNpYmxlKSBjb250aW51ZTsKICAgICAgICB1cGRhdGVSZWFkeURpYWxvZ01vZGVDb25maWdGb3JQaWQocGlkKTsKICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIE1hcC9Nb2RlIENvbmZpZyBVSSBSZWFkb3V0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBBaXJjcmFmdCBDZWlsaW5nIChTb2Z0IEVuZm9yY2VtZW50KSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gVE9ETygxLjApOiBVbnVzZWQ7IHJlbW92ZSBiZWZvcmUgZmluYWwgMS4wIHJlbGVhc2UuCi8vIENvbnZlcnRzIHRoZSBIVUQgY2VpbGluZyB0byB3b3JsZCBZIHVzaW5nIHRoZSBwZXItbWFwIEhVRCBmbG9vciBvZmZzZXQuCmZ1bmN0aW9uIGdldEFpcmNyYWZ0U29mdENlaWxpbmdXb3JsZFkoKTogbnVtYmVyIHsKICAgIGNvbnN0IGZsb29yWSA9IE1hdGguZmxvb3IoU3RhdGUucm91bmQuYWlyY3JhZnRDZWlsaW5nLmh1ZEZsb29yWSk7CiAgICBjb25zdCBodWRDZWlsaW5nID0gTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLmNvbmZpcm1lZC5haXJjcmFmdENlaWxpbmcpOwogICAgcmV0dXJuIGZsb29yWSArIGh1ZENlaWxpbmc7Cn0KCi8vIEVuZ2luZSBsaW1pdGVyIGV4cGVjdHMgYSB3b3JsZC1ZIHNjYWxlOyBjb252ZXJ0IEhVRCBjZWlsaW5nIHVzaW5nIHRoZSBtYXAncyBIVUQgZmxvb3IvbWF4IG9mZnNldHMuCmZ1bmN0aW9uIGFwcGx5Q3VzdG9tQWlyY3JhZnRDZWlsaW5nSGFyZExpbWl0ZXIoKTogdm9pZCB7CiAgICBjb25zdCBmbG9vclkgPSBNYXRoLmZsb29yKFN0YXRlLnJvdW5kLmFpcmNyYWZ0Q2VpbGluZy5odWRGbG9vclkpOwogICAgY29uc3QgYmFzZUh1ZCA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IoU3RhdGUucm91bmQuYWlyY3JhZnRDZWlsaW5nLmh1ZE1heFkpKTsKICAgIGNvbnN0IHRhcmdldEh1ZCA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IoU3RhdGUucm91bmQubW9kZUNvbmZpZy5jb25maXJtZWQuYWlyY3JhZnRDZWlsaW5nKSk7CiAgICAvLyBDb252ZXJ0IEhVRCBjZWlsaW5nIHRvIHdvcmxkIFkgdXNpbmcgdGhlIG1hcC1zcGVjaWZpYyBIVUQgZmxvb3Igb2Zmc2V0LgogICAgY29uc3QgYmFzZVdvcmxkWSA9IE1hdGgubWF4KDEsIGZsb29yWSArIGJhc2VIdWQpOwogICAgY29uc3QgdGFyZ2V0V29ybGRZID0gTWF0aC5tYXgoMSwgZmxvb3JZICsgdGFyZ2V0SHVkKTsKICAgIGNvbnN0IHNjYWxlID0gdGFyZ2V0V29ybGRZIC8gYmFzZVdvcmxkWTsKICAgIG1vZC5TZXRNYXhWZWhpY2xlSGVpZ2h0TGltaXRTY2FsZShzY2FsZSk7Cn0KCi8vIFRPRE8oMS4wKTogVW51c2VkOyByZW1vdmUgYmVmb3JlIGZpbmFsIDEuMCByZWxlYXNlLgpmdW5jdGlvbiBnZXRWZWhpY2xlWWF3UmFkKHZlaGljbGU6IG1vZC5WZWhpY2xlKTogbnVtYmVyIHsKICAgIGNvbnN0IGZhY2luZyA9IG1vZC5HZXRWZWhpY2xlU3RhdGUodmVoaWNsZSwgbW9kLlZlaGljbGVTdGF0ZVZlY3Rvci5GYWNpbmdEaXJlY3Rpb24pOwogICAgY29uc3QgeCA9IG1vZC5YQ29tcG9uZW50T2YoZmFjaW5nKTsKICAgIGNvbnN0IHogPSBtb2QuWkNvbXBvbmVudE9mKGZhY2luZyk7CiAgICBpZiAoeCA9PT0gMCAmJiB6ID09PSAwKSByZXR1cm4gMDsKICAgIHJldHVybiBNYXRoLmF0YW4yKHgsIHopOwp9CgovLyBUT0RPKDEuMCk6IFVudXNlZDsgcmVtb3ZlIGJlZm9yZSBmaW5hbCAxLjAgcmVsZWFzZS4KZnVuY3Rpb24gaXNBaXJjcmFmdFZlaGljbGUodmVoaWNsZTogbW9kLlZlaGljbGUpOiBib29sZWFuIHsKICAgIC8vIEpldHMKICAgIGlmIChtb2QuQ29tcGFyZVZlaGljbGVOYW1lKHZlaGljbGUsIG1vZC5WZWhpY2xlTGlzdC5GMTYpKSByZXR1cm4gdHJ1ZTsKICAgIGlmIChtb2QuQ29tcGFyZVZlaGljbGVOYW1lKHZlaGljbGUsIG1vZC5WZWhpY2xlTGlzdC5GMjIpKSByZXR1cm4gdHJ1ZTsKICAgIGlmIChtb2QuQ29tcGFyZVZlaGljbGVOYW1lKHZlaGljbGUsIG1vZC5WZWhpY2xlTGlzdC5KQVMzOSkpIHJldHVybiB0cnVlOwogICAgaWYgKG1vZC5Db21wYXJlVmVoaWNsZU5hbWUodmVoaWNsZSwgbW9kLlZlaGljbGVMaXN0LlNVNTcpKSByZXR1cm4gdHJ1ZTsKICAgIC8vIEhlbGlzICsgdHJhbnNwb3J0cwogICAgaWYgKG1vZC5Db21wYXJlVmVoaWNsZU5hbWUodmVoaWNsZSwgbW9kLlZlaGljbGVMaXN0LkFINjQpKSByZXR1cm4gdHJ1ZTsKICAgIGlmIChtb2QuQ29tcGFyZVZlaGljbGVOYW1lKHZlaGljbGUsIG1vZC5WZWhpY2xlTGlzdC5FdXJvY29wdGVyKSkgcmV0dXJuIHRydWU7CiAgICBpZiAobW9kLkNvbXBhcmVWZWhpY2xlTmFtZSh2ZWhpY2xlLCBtb2QuVmVoaWNsZUxpc3QuVUg2MCkpIHJldHVybiB0cnVlOwogICAgaWYgKG1vZC5Db21wYXJlVmVoaWNsZU5hbWUodmVoaWNsZSwgbW9kLlZlaGljbGVMaXN0LlVINjBfUGF4KSkgcmV0dXJuIHRydWU7CiAgICBpZiAobW9kLkNvbXBhcmVWZWhpY2xlTmFtZSh2ZWhpY2xlLCBtb2QuVmVoaWNsZUxpc3QuQ2hlZXRhaCkpIHJldHVybiB0cnVlOwogICAgaWYgKG1vZC5Db21wYXJlVmVoaWNsZU5hbWUodmVoaWNsZSwgbW9kLlZlaGljbGVMaXN0LkZseWVyNjApKSByZXR1cm4gdHJ1ZTsKICAgIHJldHVybiBmYWxzZTsKfQoKLy8gVE9ETygxLjApOiBVbnVzZWQ7IHJlbW92ZSBiZWZvcmUgZmluYWwgMS4wIHJlbGVhc2UuCmZ1bmN0aW9uIHVwZGF0ZVNvZnRDZWlsaW5nRm9yVmVoaWNsZSgKICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlLAogICAgc3RhdGU6IEFpcmNyYWZ0Q2VpbGluZ1ZlaGljbGVTdGF0ZSwKICAgIG5vd1NlY29uZHM6IG51bWJlciwKICAgIHNvZnRZOiBudW1iZXIsCiAgICBoYXJkWTogbnVtYmVyCik6IHZvaWQgewogICAgY29uc3QgcG9zID0gbW9kLkdldFZlaGljbGVTdGF0ZSh2ZWhpY2xlLCBtb2QuVmVoaWNsZVN0YXRlVmVjdG9yLlZlaGljbGVQb3NpdGlvbik7CiAgICBjb25zdCBwb3NZID0gbW9kLllDb21wb25lbnRPZihwb3MpOwogICAgY29uc3QgdmVsID0gbW9kLkdldFZlaGljbGVTdGF0ZSh2ZWhpY2xlLCBtb2QuVmVoaWNsZVN0YXRlVmVjdG9yLkxpbmVhclZlbG9jaXR5KTsKICAgIGNvbnN0IHZlbFkgPSBtb2QuWUNvbXBvbmVudE9mKHZlbCk7CgogICAgY29uc3QgZW50ZXJZID0gc29mdFkgKyBBSVJDUkFGVF9TT0ZUX0NFSUxJTkdfRU5URVJfQlVGRkVSOwogICAgY29uc3QgZXhpdFkgPSBzb2Z0WSAtIEFJUkNSQUZUX1NPRlRfQ0VJTElOR19FWElUX0JVRkZFUjsKCiAgICBpZiAoIXN0YXRlLmVuZm9yY2luZyAmJiBwb3NZID4gZW50ZXJZICYmIHZlbFkgPiAwKSB7CiAgICAgICAgc3RhdGUuZW5mb3JjaW5nID0gdHJ1ZTsKICAgIH0KICAgIGlmIChzdGF0ZS5lbmZvcmNpbmcgJiYgcG9zWSA8IGV4aXRZKSB7CiAgICAgICAgc3RhdGUuZW5mb3JjaW5nID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKCFzdGF0ZS5lbmZvcmNpbmcgfHwgcG9zWSA8PSBzb2Z0WSkgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChub3dTZWNvbmRzIC0gc3RhdGUubGFzdE51ZGdlQXQgPCBBSVJDUkFGVF9TT0ZUX0NFSUxJTkdfTlVER0VfSU5URVJWQUxfU0VDT05EUykgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBkdFNlY29uZHMgPSBNYXRoLm1heChBSVJDUkFGVF9TT0ZUX0NFSUxJTkdfTlVER0VfSU5URVJWQUxfU0VDT05EUywgbm93U2Vjb25kcyAtIHN0YXRlLmxhc3ROdWRnZUF0KTsKICAgIGNvbnN0IHVwd2FyZFZlbCA9IE1hdGgubWF4KDAsIHZlbFkpOwogICAgbGV0IHN0ZXAgPQogICAgICAgIHVwd2FyZFZlbCAqIGR0U2Vjb25kcyAqIEFJUkNSQUZUX1NPRlRfQ0VJTElOR19WRUxPQ0lUWV9TQ0FMRTsKICAgIHN0ZXAgPSBNYXRoLm1heChBSVJDUkFGVF9TT0ZUX0NFSUxJTkdfTlVER0VfTUlOX1NURVAsIE1hdGgubWluKEFJUkNSQUZUX1NPRlRfQ0VJTElOR19OVURHRV9NQVhfU1RFUCwgc3RlcCkpOwogICAgaWYgKHBvc1kgPiBoYXJkWSkgewogICAgICAgIC8vIElmIHNvbWVvbmUgZ2V0cyBmYXIgYWJvdmUgdGhlIHNvZnQgY2VpbGluZywgaW5jcmVhc2UgdGhlIG51ZGdlIHRvIGF2b2lkIGEgc2xvdyBjbGltYi4KICAgICAgICBzdGVwID0gTWF0aC5taW4oQUlSQ1JBRlRfU09GVF9DRUlMSU5HX05VREdFX01BWF9TVEVQLCBzdGVwICogQUlSQ1JBRlRfU09GVF9DRUlMSU5HX0hBUkRfU1RFUF9NVUxUSVBMSUVSKTsKICAgIH0KICAgIGNvbnN0IHRhcmdldFkgPSBNYXRoLm1heChzb2Z0WSwgcG9zWSAtIHN0ZXApOwogICAgY29uc3QgbmV3UG9zID0gbW9kLkNyZWF0ZVZlY3Rvcihtb2QuWENvbXBvbmVudE9mKHBvcyksIHRhcmdldFksIG1vZC5aQ29tcG9uZW50T2YocG9zKSk7CiAgICBjb25zdCB5YXdSYWQgPSBnZXRWZWhpY2xlWWF3UmFkKHZlaGljbGUpOwogICAgbW9kLlRlbGVwb3J0KHZlaGljbGUsIG5ld1BvcywgeWF3UmFkKTsKICAgIHN0YXRlLmxhc3ROdWRnZUF0ID0gbm93U2Vjb25kczsKfQoKLy8gVE9ETygxLjApOiBVbnVzZWQ7IHJlbW92ZSBiZWZvcmUgZmluYWwgMS4wIHJlbGVhc2UuCmFzeW5jIGZ1bmN0aW9uIHJ1bkFpcmNyYWZ0Q2VpbGluZ1NvZnRFbmZvcmNlbWVudExvb3AoZXhwZWN0ZWRUb2tlbjogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7CiAgICB3aGlsZSAoU3RhdGUucm91bmQuYWlyY3JhZnRDZWlsaW5nLmVuZm9yY2VtZW50VG9rZW4gPT09IGV4cGVjdGVkVG9rZW4pIHsKICAgICAgICBpZiAoIVN0YXRlLnJvdW5kLmFpcmNyYWZ0Q2VpbGluZy5jdXN0b21FbmFibGVkIHx8IEFJUkNSQUZUX0NFSUxJTkdfRU5GT1JDRU1FTlRfTU9ERSAhPT0gInNvZnQiKSB7CiAgICAgICAgICAgIGF3YWl0IG1vZC5XYWl0KEFJUkNSQUZUX1NPRlRfQ0VJTElOR19USUNLX1NFQ09ORFMpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHNvZnRZID0gZ2V0QWlyY3JhZnRTb2Z0Q2VpbGluZ1dvcmxkWSgpOwogICAgICAgIGlmIChzb2Z0WSA8PSAwKSB7CiAgICAgICAgICAgIGF3YWl0IG1vZC5XYWl0KEFJUkNSQUZUX1NPRlRfQ0VJTElOR19USUNLX1NFQ09ORFMpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgY29uc3QgaGFyZFkgPSBzb2Z0WSArIEFJUkNSQUZUX1NPRlRfQ0VJTElOR19IQVJEX0JVRkZFUjsKICAgICAgICBjb25zdCBub3dTZWNvbmRzID0gbW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKTsKCiAgICAgICAgY29uc3QgdmVoaWNsZXMgPSBtb2QuQWxsVmVoaWNsZXMoKTsKICAgICAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHZlaGljbGVzKTsKICAgICAgICBjb25zdCBzZWVuOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPiA9IHt9OwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgICAgICBjb25zdCB2ZWhpY2xlID0gbW9kLlZhbHVlSW5BcnJheSh2ZWhpY2xlcywgaSkgYXMgbW9kLlZlaGljbGU7CiAgICAgICAgICAgIGlmICghdmVoaWNsZSB8fCAhaXNBaXJjcmFmdFZlaGljbGUodmVoaWNsZSkpIGNvbnRpbnVlOwogICAgICAgICAgICBjb25zdCB2ZWhpY2xlSWQgPSBnZXRWZWhpY2xlSWQodmVoaWNsZSk7CiAgICAgICAgICAgIHNlZW5bdmVoaWNsZUlkXSA9IHRydWU7CiAgICAgICAgICAgIGNvbnN0IHN0YXRlID0KICAgICAgICAgICAgICAgIFN0YXRlLnJvdW5kLmFpcmNyYWZ0Q2VpbGluZy52ZWhpY2xlU3RhdGVzW3ZlaGljbGVJZF0gPz8KICAgICAgICAgICAgICAgIChTdGF0ZS5yb3VuZC5haXJjcmFmdENlaWxpbmcudmVoaWNsZVN0YXRlc1t2ZWhpY2xlSWRdID0geyBlbmZvcmNpbmc6IGZhbHNlLCBsYXN0TnVkZ2VBdDogLTk5OSB9KTsKICAgICAgICAgICAgdXBkYXRlU29mdENlaWxpbmdGb3JWZWhpY2xlKHZlaGljbGUsIHN0YXRlLCBub3dTZWNvbmRzLCBzb2Z0WSwgaGFyZFkpOwogICAgICAgIH0KCiAgICAgICAgZm9yIChjb25zdCBpZFN0ciBpbiBTdGF0ZS5yb3VuZC5haXJjcmFmdENlaWxpbmcudmVoaWNsZVN0YXRlcykgewogICAgICAgICAgICBjb25zdCBpZCA9IE51bWJlcihpZFN0cik7CiAgICAgICAgICAgIGlmICghc2VlbltpZF0pIHsKICAgICAgICAgICAgICAgIGRlbGV0ZSBTdGF0ZS5yb3VuZC5haXJjcmFmdENlaWxpbmcudmVoaWNsZVN0YXRlc1tpZF07CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGF3YWl0IG1vZC5XYWl0KEFJUkNSQUZUX1NPRlRfQ0VJTElOR19USUNLX1NFQ09ORFMpOwogICAgfQp9CgovLyBUT0RPKDEuMCk6IFVudXNlZDsgcmVtb3ZlIGJlZm9yZSBmaW5hbCAxLjAgcmVsZWFzZS4KZnVuY3Rpb24gc3RhcnRBaXJjcmFmdENlaWxpbmdTb2Z0RW5mb3JjZW1lbnRMb29wKCk6IHZvaWQgewogICAgU3RhdGUucm91bmQuYWlyY3JhZnRDZWlsaW5nLmVuZm9yY2VtZW50VG9rZW4gKz0gMTsKICAgIHZvaWQgcnVuQWlyY3JhZnRDZWlsaW5nU29mdEVuZm9yY2VtZW50TG9vcChTdGF0ZS5yb3VuZC5haXJjcmFmdENlaWxpbmcuZW5mb3JjZW1lbnRUb2tlbik7Cn0KCmZ1bmN0aW9uIGVuYWJsZUN1c3RvbUFpcmNyYWZ0Q2VpbGluZygpOiB2b2lkIHsKICAgIFN0YXRlLnJvdW5kLmFpcmNyYWZ0Q2VpbGluZy5jdXN0b21FbmFibGVkID0gdHJ1ZTsKICAgIFN0YXRlLnJvdW5kLmFpcmNyYWZ0Q2VpbGluZy52ZWhpY2xlU3RhdGVzID0ge307Cn0KCmZ1bmN0aW9uIGRpc2FibGVDdXN0b21BaXJjcmFmdENlaWxpbmdBbmRSZXN0b3JlRGVmYXVsdCgpOiB2b2lkIHsKICAgIFN0YXRlLnJvdW5kLmFpcmNyYWZ0Q2VpbGluZy5jdXN0b21FbmFibGVkID0gZmFsc2U7CiAgICBTdGF0ZS5yb3VuZC5haXJjcmFmdENlaWxpbmcudmVoaWNsZVN0YXRlcyA9IHt9OwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5haXJjcmFmdENlaWxpbmcgPSBTdGF0ZS5yb3VuZC5haXJjcmFmdENlaWxpbmcubWFwRGVmYXVsdEh1ZENlaWxpbmc7CiAgICBTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLmdhbWVTZXR0aW5ncyA9IG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5tb2RlU2V0dGluZ0FpcmNyYWZ0Q2VpbGluZ0Zvcm1hdDsKICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcuY29uZmlybWVkLmFpcmNyYWZ0Q2VpbGluZyA9IFN0YXRlLnJvdW5kLmFpcmNyYWZ0Q2VpbGluZy5tYXBEZWZhdWx0SHVkQ2VpbGluZzsKICAgIG1vZC5TZXRNYXhWZWhpY2xlSGVpZ2h0TGltaXRTY2FsZSgxLjApOwogICAgdXBkYXRlUmVhZHlEaWFsb2dNb2RlQ29uZmlnRm9yQWxsVmlzaWJsZVZpZXdlcnMoKTsKfQoKZnVuY3Rpb24gc3luY0FpcmNyYWZ0Q2VpbGluZ0Zyb21NYXBDb25maWcoKTogdm9pZCB7CiAgICBjb25zdCBtYXBEZWZhdWx0ID0gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcihBQ1RJVkVfTUFQX0NPTkZJRy5haXJjcmFmdENlaWxpbmcpKTsKICAgIGNvbnN0IG1hcE1heEh1ZCA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IoQUNUSVZFX01BUF9DT05GSUcuaHVkTWF4WSkpOwogICAgY29uc3QgZmxvb3JZID0gTWF0aC5mbG9vcihBQ1RJVkVfTUFQX0NPTkZJRy5odWRGbG9vclkpOwogICAgU3RhdGUucm91bmQuYWlyY3JhZnRDZWlsaW5nLm1hcERlZmF1bHRIdWRDZWlsaW5nID0gbWFwRGVmYXVsdDsKICAgIFN0YXRlLnJvdW5kLmFpcmNyYWZ0Q2VpbGluZy5odWRNYXhZID0gbWFwTWF4SHVkOwogICAgU3RhdGUucm91bmQuYWlyY3JhZnRDZWlsaW5nLmh1ZEZsb29yWSA9IGZsb29yWTsKICAgIFN0YXRlLnJvdW5kLmFpcmNyYWZ0Q2VpbGluZy5jdXN0b21FbmFibGVkID0gZmFsc2U7CiAgICBTdGF0ZS5yb3VuZC5haXJjcmFmdENlaWxpbmcudmVoaWNsZVN0YXRlcyA9IHt9OwogICAgLy8gS2VlcCB0aGUgZW5naW5lIGNlaWxpbmcgYXQgdmFuaWxsYSBzY2FsZTsgc29mdCBlbmZvcmNlbWVudCBpcyBjb25maXJtLWdhdGVkLgogICAgbW9kLlNldE1heFZlaGljbGVIZWlnaHRMaW1pdFNjYWxlKDEuMCk7CgogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5haXJjcmFmdENlaWxpbmcgPSBtYXBEZWZhdWx0OwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5haXJjcmFmdENlaWxpbmdPdmVycmlkZVBlbmRpbmcgPSBmYWxzZTsKICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcuZ2FtZVNldHRpbmdzID0gbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLm1vZGVTZXR0aW5nQWlyY3JhZnRDZWlsaW5nRm9ybWF0OwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5jb25maXJtZWQuYWlyY3JhZnRDZWlsaW5nID0gbWFwRGVmYXVsdDsKICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcuY29uZmlybWVkLmFpcmNyYWZ0Q2VpbGluZ092ZXJyaWRlRW5hYmxlZCA9IGZhbHNlOwoKICAgIHVwZGF0ZVJlYWR5RGlhbG9nTW9kZUNvbmZpZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBBaXJjcmFmdCBDZWlsaW5nIChTb2Z0IEVuZm9yY2VtZW50KSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIC0gTW9kZSBQcmVzZXRzICsgQ29uZmlybSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gaXNSZWFkeURpYWxvZ0dhbWVNb2RlVmFuaWxsYShnYW1lTW9kZUtleTogbnVtYmVyKTogYm9vbGVhbiB7CiAgICByZXR1cm4gZ2FtZU1vZGVLZXkgPT09IG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5nYW1lTW9kZUhlbGlzUHJhY3RpY2U7Cn0KCmZ1bmN0aW9uIGlzUmVhZHlEaWFsb2dHYW1lTW9kZUxhZGRlcihnYW1lTW9kZUtleTogbnVtYmVyKTogYm9vbGVhbiB7CiAgICByZXR1cm4gZ2FtZU1vZGVLZXkgPT09IG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5nYW1lTW9kZUhlbGlzTGFkZGVyOwp9CgpmdW5jdGlvbiBpc1JlYWR5RGlhbG9nR2FtZU1vZGVUd2wxdjEoZ2FtZU1vZGVLZXk6IG51bWJlcik6IGJvb2xlYW4gewogICAgcmV0dXJuIGdhbWVNb2RlS2V5ID09PSBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuZ2FtZU1vZGVIZWxpc1R3bDF2MTsKfQoKZnVuY3Rpb24gaXNSZWFkeURpYWxvZ0dhbWVNb2RlQ3VzdG9tKGdhbWVNb2RlS2V5OiBudW1iZXIpOiBib29sZWFuIHsKICAgIHJldHVybiBnYW1lTW9kZUtleSA9PT0gbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmdhbWVNb2RlSGVsaXNDdXN0b207Cn0KCmZ1bmN0aW9uIGlzUmVhZHlEaWFsb2dHYW1lTW9kZVR3bFByZXNldChnYW1lTW9kZUtleTogbnVtYmVyKTogYm9vbGVhbiB7CiAgICByZXR1cm4gaXNSZWFkeURpYWxvZ0dhbWVNb2RlTGFkZGVyKGdhbWVNb2RlS2V5KSB8fCBpc1JlYWR5RGlhbG9nR2FtZU1vZGVUd2wxdjEoZ2FtZU1vZGVLZXkpOwp9CgpmdW5jdGlvbiBnZXRSZWFkeURpYWxvZ1ByZXNldFBsYXllcnNQZXJTaWRlKGdhbWVNb2RlS2V5OiBudW1iZXIpOiBudW1iZXIgewogICAgaWYgKGlzUmVhZHlEaWFsb2dHYW1lTW9kZVR3bDF2MShnYW1lTW9kZUtleSkpIHsKICAgICAgICByZXR1cm4gUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX1BMQVlFUlNfUEVSX1NJREVfVFdMXzFWMTsKICAgIH0KICAgIGlmIChpc1JlYWR5RGlhbG9nR2FtZU1vZGVMYWRkZXIoZ2FtZU1vZGVLZXkpKSB7CiAgICAgICAgcmV0dXJuIFJFQURZX0RJQUxPR19NT0RFX1BSRVNFVF9QTEFZRVJTX1BFUl9TSURFX1RXTF8yVjI7CiAgICB9CiAgICByZXR1cm4gUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX1BMQVlFUlNfUEVSX1NJREVfVkFOSUxMQTsKfQoKZnVuY3Rpb24gc2hvdWxkQXBwbHlDdXN0b21DZWlsaW5nRm9yR2FtZU1vZGUoZ2FtZU1vZGVLZXk6IG51bWJlcik6IGJvb2xlYW4gewogICAgaWYgKGlzUmVhZHlEaWFsb2dHYW1lTW9kZVZhbmlsbGEoZ2FtZU1vZGVLZXkpKSByZXR1cm4gZmFsc2U7CiAgICBpZiAoaXNSZWFkeURpYWxvZ0dhbWVNb2RlQ3VzdG9tKGdhbWVNb2RlS2V5KSkgcmV0dXJuIHRydWU7CiAgICBpZiAoaXNSZWFkeURpYWxvZ0dhbWVNb2RlVHdsUHJlc2V0KGdhbWVNb2RlS2V5KSkgcmV0dXJuICEhQUNUSVZFX01BUF9DT05GSUcudXNlQ3VzdG9tQ2VpbGluZzsKICAgIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBoYXNDdXN0b21DZWlsaW5nT3ZlcnJpZGUoY2VpbGluZ1ZhbHVlOiBudW1iZXIpOiBib29sZWFuIHsKICAgIHJldHVybiBNYXRoLmZsb29yKGNlaWxpbmdWYWx1ZSkgIT09IE1hdGguZmxvb3IoU3RhdGUucm91bmQuYWlyY3JhZnRDZWlsaW5nLm1hcERlZmF1bHRIdWRDZWlsaW5nKTsKfQoKLy8gQ3VzdG9tIG1vZGUgYWx3YXlzIGFwcGxpZXMgdGhlIG51bWVyaWMgY2VpbGluZzsgVmFuaWxsYS9MYWRkZXIgYXBwbHkgb25seSB3aGVuIGNvbmZpZ3VyZWQgdG8gZG8gc28uCmZ1bmN0aW9uIHNob3VsZEFwcGx5Q3VzdG9tQ2VpbGluZ0ZvckNvbmZpZyhnYW1lTW9kZUtleTogbnVtYmVyLCBvdmVycmlkZUVuYWJsZWQ6IGJvb2xlYW4pOiBib29sZWFuIHsKICAgIGlmIChpc1JlYWR5RGlhbG9nR2FtZU1vZGVDdXN0b20oZ2FtZU1vZGVLZXkpKSB7CiAgICAgICAgcmV0dXJuIG92ZXJyaWRlRW5hYmxlZDsKICAgIH0KICAgIHJldHVybiBzaG91bGRBcHBseUN1c3RvbUNlaWxpbmdGb3JHYW1lTW9kZShnYW1lTW9kZUtleSk7Cn0KCi8vIEZvcmNlcyBDdXN0b20gbW9kZSB3aXRob3V0IGFwcGx5aW5nIHByZXNldHMgb3IgbXV0YXRpbmcgb3RoZXIgc2V0dGluZ3MuCmZ1bmN0aW9uIGVuc3VyZUN1c3RvbUdhbWVNb2RlRm9yTWFudWFsQ2hhbmdlKCk6IHZvaWQgewogICAgaWYgKHN1cHByZXNzUmVhZHlEaWFsb2dNb2RlQXV0b1N3aXRjaCkgcmV0dXJuOwogICAgaWYgKFN0YXRlLnJvdW5kLm1vZGVDb25maWcuZ2FtZU1vZGVJbmRleCA9PT0gUkVBRFlfRElBTE9HX0dBTUVfTU9ERV9DVVNUT01fSU5ERVgpIHJldHVybjsKICAgIGNvbnN0IHByaW9yTW9kZSA9IFN0YXRlLnJvdW5kLm1vZGVDb25maWcuZ2FtZU1vZGU7CiAgICBjb25zdCBzaG91bGRLZWVwQ2VpbGluZ092ZXJyaWRlID0KICAgICAgICBzaG91bGRBcHBseUN1c3RvbUNlaWxpbmdGb3JHYW1lTW9kZShwcmlvck1vZGUpCiAgICAgICAgfHwgU3RhdGUucm91bmQubW9kZUNvbmZpZy5haXJjcmFmdENlaWxpbmdPdmVycmlkZVBlbmRpbmcKICAgICAgICB8fCBTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLmNvbmZpcm1lZC5haXJjcmFmdENlaWxpbmdPdmVycmlkZUVuYWJsZWQ7CiAgICBpZiAoc2hvdWxkS2VlcENlaWxpbmdPdmVycmlkZSkgewogICAgICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcuYWlyY3JhZnRDZWlsaW5nT3ZlcnJpZGVQZW5kaW5nID0gdHJ1ZTsKICAgIH0KICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcuZ2FtZU1vZGVJbmRleCA9IFJFQURZX0RJQUxPR19HQU1FX01PREVfQ1VTVE9NX0lOREVYOwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5nYW1lTW9kZSA9IFJFQURZX0RJQUxPR19HQU1FX01PREVfT1BUSU9OU1tSRUFEWV9ESUFMT0dfR0FNRV9NT0RFX0NVU1RPTV9JTkRFWF07CiAgICB1cGRhdGVSZWFkeURpYWxvZ01vZGVDb25maWdGb3JBbGxWaXNpYmxlVmlld2VycygpOwogICAgdXBkYXRlU2V0dGluZ3NTdW1tYXJ5SHVkRm9yQWxsUGxheWVycygpOwp9CgovLyBUcnVlIG9ubHkgd2hlbiBhbGwgcHJlc2V0IHZhbHVlcyBtYXRjaCB0aGUgc2VsZWN0ZWQgbW9kZSAoYmVzdC1vZiwgbWF0Y2h1cCwgcGxheWVycywgdmVoaWNsZXMsIGNlaWxpbmcpLgpmdW5jdGlvbiBpc1JlYWR5RGlhbG9nTW9kZVByZXNldEFjdGl2ZShnYW1lTW9kZUtleTogbnVtYmVyKTogYm9vbGVhbiB7CiAgICBpZiAoaXNSZWFkeURpYWxvZ0dhbWVNb2RlQ3VzdG9tKGdhbWVNb2RlS2V5KSkgcmV0dXJuIGZhbHNlOwogICAgY29uc3QgZXhwZWN0ZWRCZXN0T2YgPSBpc1JlYWR5RGlhbG9nR2FtZU1vZGVUd2xQcmVzZXQoZ2FtZU1vZGVLZXkpCiAgICAgICAgPyBSRUFEWV9ESUFMT0dfTU9ERV9QUkVTRVRfQkVTVF9PRl9MQURERVIKICAgICAgICA6IFJFQURZX0RJQUxPR19NT0RFX1BSRVNFVF9CRVNUX09GX1ZBTklMTEE7CiAgICBpZiAoTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5tYXgpICE9PSBleHBlY3RlZEJlc3RPZikgcmV0dXJuIGZhbHNlOwogICAgaWYgKFN0YXRlLnJvdW5kLm1hdGNodXBQcmVzZXRJbmRleCAhPT0gUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX01BVENIVVBfSU5ERVgpIHJldHVybiBmYWxzZTsKICAgIGlmIChTdGF0ZS5yb3VuZC5hdXRvU3RhcnRNaW5BY3RpdmVQbGF5ZXJzICE9PSBnZXRSZWFkeURpYWxvZ1ByZXNldFBsYXllcnNQZXJTaWRlKGdhbWVNb2RlS2V5KSkgcmV0dXJuIGZhbHNlOwogICAgaWYgKFN0YXRlLnJvdW5kLm1vZGVDb25maWcudmVoaWNsZUluZGV4VDEgIT09IFJFQURZX0RJQUxPR19NT0RFX1BSRVNFVF9WRUhJQ0xFX0lOREVYKSByZXR1cm4gZmFsc2U7CiAgICBpZiAoU3RhdGUucm91bmQubW9kZUNvbmZpZy52ZWhpY2xlSW5kZXhUMiAhPT0gUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX1ZFSElDTEVfSU5ERVgpIHJldHVybiBmYWxzZTsKICAgIGlmIChNYXRoLmZsb29yKFN0YXRlLnJvdW5kLm1vZGVDb25maWcuYWlyY3JhZnRDZWlsaW5nKSAhPT0gTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5haXJjcmFmdENlaWxpbmcubWFwRGVmYXVsdEh1ZENlaWxpbmcpKSByZXR1cm4gZmFsc2U7CiAgICByZXR1cm4gdHJ1ZTsKfQoKLy8gQXBwbGllcyB0aGUgZnVsbCBtb2RlIHByZXNldCAodGhlIG9ubHkgcGxhY2Ugd2UgaW50ZW50aW9uYWxseSBzeW5jIG11bHRpcGxlIHNldHRpbmdzIGF0IG9uY2UpLgpmdW5jdGlvbiBhcHBseVJlYWR5RGlhbG9nTW9kZVByZXNldEZvckdhbWVNb2RlKGdhbWVNb2RlS2V5OiBudW1iZXIpOiBib29sZWFuIHsKICAgIGlmIChpc1JlYWR5RGlhbG9nR2FtZU1vZGVDdXN0b20oZ2FtZU1vZGVLZXkpKSByZXR1cm4gZmFsc2U7CgogICAgc3VwcHJlc3NSZWFkeURpYWxvZ01vZGVBdXRvU3dpdGNoID0gdHJ1ZTsKICAgIGNvbnN0IGJlc3RPZlJvdW5kcyA9IGlzUmVhZHlEaWFsb2dHYW1lTW9kZVR3bFByZXNldChnYW1lTW9kZUtleSkKICAgICAgICA/IFJFQURZX0RJQUxPR19NT0RFX1BSRVNFVF9CRVNUX09GX0xBRERFUgogICAgICAgIDogUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX0JFU1RfT0ZfVkFOSUxMQTsKCiAgICBzZXRIdWRSb3VuZENvdW50ZXJzRm9yQWxsUGxheWVycyhTdGF0ZS5yb3VuZC5jdXJyZW50LCBiZXN0T2ZSb3VuZHMpOwogICAgYXBwbHlNYXRjaHVwUHJlc2V0SW50ZXJuYWwoUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX01BVENIVVBfSU5ERVgsIHVuZGVmaW5lZCwgZmFsc2UsIHRydWUpOwoKICAgIFN0YXRlLnJvdW5kLmF1dG9TdGFydE1pbkFjdGl2ZVBsYXllcnMgPSBnZXRSZWFkeURpYWxvZ1ByZXNldFBsYXllcnNQZXJTaWRlKGdhbWVNb2RlS2V5KTsKICAgIHVwZGF0ZU1hdGNodXBSZWFkb3V0c0ZvckFsbFBsYXllcnMoKTsKCiAgICBTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVJbmRleFQxID0gUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX1ZFSElDTEVfSU5ERVg7CiAgICBTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVJbmRleFQyID0gUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX1ZFSElDTEVfSU5ERVg7CiAgICBTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVzVDEgPSBSRUFEWV9ESUFMT0dfVkVISUNMRV9PUFRJT05TW1JFQURZX0RJQUxPR19NT0RFX1BSRVNFVF9WRUhJQ0xFX0lOREVYXTsKICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcudmVoaWNsZXNUMiA9IFJFQURZX0RJQUxPR19WRUhJQ0xFX09QVElPTlNbUkVBRFlfRElBTE9HX01PREVfUFJFU0VUX1ZFSElDTEVfSU5ERVhdOwoKICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcuYWlyY3JhZnRDZWlsaW5nID0gU3RhdGUucm91bmQuYWlyY3JhZnRDZWlsaW5nLm1hcERlZmF1bHRIdWRDZWlsaW5nOwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5haXJjcmFmdENlaWxpbmdPdmVycmlkZVBlbmRpbmcgPSBmYWxzZTsKICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcuZ2FtZVNldHRpbmdzID0gbW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLm1vZGVTZXR0aW5nQWlyY3JhZnRDZWlsaW5nRm9ybWF0OwoKICAgIHN1cHByZXNzUmVhZHlEaWFsb2dNb2RlQXV0b1N3aXRjaCA9IGZhbHNlOwoKICAgIHVwZGF0ZVJlYWR5RGlhbG9nTW9kZUNvbmZpZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk7CiAgICB1cGRhdGVTZXR0aW5nc1N1bW1hcnlIdWRGb3JBbGxQbGF5ZXJzKCk7CiAgICByZXR1cm4gdHJ1ZTsKfQoKZnVuY3Rpb24gc2V0UmVhZHlEaWFsb2dHYW1lTW9kZUluZGV4KG5leHRJbmRleDogbnVtYmVyLCBhcHBseVByZXNldDogYm9vbGVhbiA9IHRydWUpOiB2b2lkIHsKICAgIGNvbnN0IGNvdW50ID0gUkVBRFlfRElBTE9HX0dBTUVfTU9ERV9PUFRJT05TLmxlbmd0aDsKICAgIGlmIChjb3VudCA8PSAwKSByZXR1cm47CiAgICBjb25zdCBjbGFtcGVkID0gKChuZXh0SW5kZXggJSBjb3VudCkgKyBjb3VudCkgJSBjb3VudDsKICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcuZ2FtZU1vZGVJbmRleCA9IGNsYW1wZWQ7CiAgICBTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLmdhbWVNb2RlID0gUkVBRFlfRElBTE9HX0dBTUVfTU9ERV9PUFRJT05TW2NsYW1wZWRdOwogICAgaWYgKGFwcGx5UHJlc2V0KSB7CiAgICAgICAgY29uc3QgYXBwbGllZCA9IGFwcGx5UmVhZHlEaWFsb2dNb2RlUHJlc2V0Rm9yR2FtZU1vZGUoU3RhdGUucm91bmQubW9kZUNvbmZpZy5nYW1lTW9kZSk7CiAgICAgICAgaWYgKGFwcGxpZWQpIHJldHVybjsKICAgIH0KICAgIHVwZGF0ZVJlYWR5RGlhbG9nTW9kZUNvbmZpZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk7CiAgICB1cGRhdGVTZXR0aW5nc1N1bW1hcnlIdWRGb3JBbGxQbGF5ZXJzKCk7Cn0KCmZ1bmN0aW9uIHNldFJlYWR5RGlhbG9nQWlyY3JhZnRDZWlsaW5nKG5leHRWYWx1ZTogbnVtYmVyLCBfY2hhbmdlZEJ5PzogbW9kLlBsYXllcik6IHZvaWQgewogICAgZW5zdXJlQ3VzdG9tR2FtZU1vZGVGb3JNYW51YWxDaGFuZ2UoKTsKICAgIGNvbnN0IGNsYW1wZWQgPSBNYXRoLm1heCgKICAgICAgICBSRUFEWV9ESUFMT0dfQUlSQ1JBRlRfQ0VJTElOR19NSU4sCiAgICAgICAgTWF0aC5taW4oUkVBRFlfRElBTE9HX0FJUkNSQUZUX0NFSUxJTkdfTUFYLCBNYXRoLmZsb29yKG5leHRWYWx1ZSkpCiAgICApOwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5haXJjcmFmdENlaWxpbmcgPSBjbGFtcGVkOwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5haXJjcmFmdENlaWxpbmdPdmVycmlkZVBlbmRpbmcgPSB0cnVlOwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5nYW1lU2V0dGluZ3MgPSBtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cubW9kZVNldHRpbmdBaXJjcmFmdENlaWxpbmdGb3JtYXQ7CiAgICB1cGRhdGVSZWFkeURpYWxvZ01vZGVDb25maWdGb3JBbGxWaXNpYmxlVmlld2VycygpOwp9CgpmdW5jdGlvbiBzZXRSZWFkeURpYWxvZ1ZlaGljbGVJbmRleFQxKG5leHRJbmRleDogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCBjb3VudCA9IFJFQURZX0RJQUxPR19WRUhJQ0xFX09QVElPTlMubGVuZ3RoOwogICAgaWYgKGNvdW50IDw9IDApIHJldHVybjsKICAgIGVuc3VyZUN1c3RvbUdhbWVNb2RlRm9yTWFudWFsQ2hhbmdlKCk7CiAgICBjb25zdCBjbGFtcGVkID0gKChuZXh0SW5kZXggJSBjb3VudCkgKyBjb3VudCkgJSBjb3VudDsKICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcudmVoaWNsZUluZGV4VDEgPSBjbGFtcGVkOwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy52ZWhpY2xlc1QxID0gUkVBRFlfRElBTE9HX1ZFSElDTEVfT1BUSU9OU1tjbGFtcGVkXTsKICAgIHVwZGF0ZVJlYWR5RGlhbG9nTW9kZUNvbmZpZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk7Cn0KCmZ1bmN0aW9uIHNldFJlYWR5RGlhbG9nVmVoaWNsZUluZGV4VDIobmV4dEluZGV4OiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IGNvdW50ID0gUkVBRFlfRElBTE9HX1ZFSElDTEVfT1BUSU9OUy5sZW5ndGg7CiAgICBpZiAoY291bnQgPD0gMCkgcmV0dXJuOwogICAgZW5zdXJlQ3VzdG9tR2FtZU1vZGVGb3JNYW51YWxDaGFuZ2UoKTsKICAgIGNvbnN0IGNsYW1wZWQgPSAoKG5leHRJbmRleCAlIGNvdW50KSArIGNvdW50KSAlIGNvdW50OwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy52ZWhpY2xlSW5kZXhUMiA9IGNsYW1wZWQ7CiAgICBTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVzVDIgPSBSRUFEWV9ESUFMT0dfVkVISUNMRV9PUFRJT05TW2NsYW1wZWRdOwogICAgdXBkYXRlUmVhZHlEaWFsb2dNb2RlQ29uZmlnRm9yQWxsVmlzaWJsZVZpZXdlcnMoKTsKfQoKLy8gVE9ETygxLjApOiBEZXByZWNhdGVkIGJ5ICJGcmVzaCBSZXNwYXduIFNldHVwIiBidXR0b247IHJlbW92ZSBiZWZvcmUgZmluYWwgMS4wIHJlbGVhc2UuCmZ1bmN0aW9uIHJlc2V0UmVhZHlEaWFsb2dWZWhpY2xlT3ZlcnJpZGVzKCk6IHZvaWQgewogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy52ZWhpY2xlSW5kZXhUMSA9IFJFQURZX0RJQUxPR19WRUhJQ0xFX1QxX0RFRkFVTFRfSU5ERVg7CiAgICBTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVJbmRleFQyID0gUkVBRFlfRElBTE9HX1ZFSElDTEVfVDJfREVGQVVMVF9JTkRFWDsKICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcudmVoaWNsZXNUMSA9IFJFQURZX0RJQUxPR19WRUhJQ0xFX09QVElPTlNbUkVBRFlfRElBTE9HX1ZFSElDTEVfVDFfREVGQVVMVF9JTkRFWF07CiAgICBTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLnZlaGljbGVzVDIgPSBSRUFEWV9ESUFMT0dfVkVISUNMRV9PUFRJT05TW1JFQURZX0RJQUxPR19WRUhJQ0xFX1QyX0RFRkFVTFRfSU5ERVhdOwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5jb25maXJtZWQudmVoaWNsZUluZGV4VDEgPSBSRUFEWV9ESUFMT0dfVkVISUNMRV9UMV9ERUZBVUxUX0lOREVYOwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5jb25maXJtZWQudmVoaWNsZUluZGV4VDIgPSBSRUFEWV9ESUFMT0dfVkVISUNMRV9UMl9ERUZBVUxUX0lOREVYOwogICAgU3RhdGUucm91bmQubW9kZUNvbmZpZy5jb25maXJtZWQudmVoaWNsZXNUMSA9IFJFQURZX0RJQUxPR19WRUhJQ0xFX09QVElPTlNbUkVBRFlfRElBTE9HX1ZFSElDTEVfVDFfREVGQVVMVF9JTkRFWF07CiAgICBTdGF0ZS5yb3VuZC5tb2RlQ29uZmlnLmNvbmZpcm1lZC52ZWhpY2xlc1QyID0gUkVBRFlfRElBTE9HX1ZFSElDTEVfT1BUSU9OU1tSRUFEWV9ESUFMT0dfVkVISUNMRV9UMl9ERUZBVUxUX0lOREVYXTsKICAgIFN0YXRlLnJvdW5kLm1vZGVDb25maWcuY29uZmlybWVkLnZlaGljbGVPdmVycmlkZUVuYWJsZWQgPSBmYWxzZTsKICAgIHJlZnJlc2hWZWhpY2xlU3Bhd25TcGVjc0Zyb21Nb2RlQ29uZmlnKCk7CiAgICBhcHBseVZlaGljbGVTcGF3blNwZWNzVG9FeGlzdGluZ1Nsb3RzKCk7CiAgICB1cGRhdGVSZWFkeURpYWxvZ01vZGVDb25maWdGb3JBbGxWaXNpYmxlVmlld2VycygpOwogICAgdXBkYXRlU2V0dGluZ3NTdW1tYXJ5SHVkRm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiBjb25maXJtUmVhZHlEaWFsb2dNb2RlQ29uZmlnKGNoYW5nZWRCeT86IG1vZC5QbGF5ZXIpOiB2b2lkIHsKICAgIGNvbnN0IGNmZyA9IFN0YXRlLnJvdW5kLm1vZGVDb25maWc7CiAgICBjb25zdCBwcmV2Q29uZmlybWVkID0gY2ZnLmNvbmZpcm1lZC5haXJjcmFmdENlaWxpbmc7CiAgICBjb25zdCBwcmV2R2FtZU1vZGUgPSBjZmcuY29uZmlybWVkLmdhbWVNb2RlOwogICAgLy8gQ29uZmlybSBpcyBhdXRob3JpdGF0aXZlOiBpdCBjYW4gZm9yY2UgQ3VzdG9tIGlmIHNldHRpbmdzIGRpdmVyZ2UgZnJvbSBwcmVzZXRzCiAgICAvLyBhbmQgaXQgaXMgdGhlIG9ubHkgcGxhY2Ugd2UgYXBwbHkgY2VpbGluZyArIHZlaGljbGUgb3ZlcnJpZGVzLgogICAgaWYgKCFpc1JlYWR5RGlhbG9nR2FtZU1vZGVDdXN0b20oY2ZnLmdhbWVNb2RlKSAmJiAhaXNSZWFkeURpYWxvZ01vZGVQcmVzZXRBY3RpdmUoY2ZnLmdhbWVNb2RlKSkgewogICAgICAgIGNmZy5nYW1lTW9kZUluZGV4ID0gUkVBRFlfRElBTE9HX0dBTUVfTU9ERV9DVVNUT01fSU5ERVg7CiAgICAgICAgY2ZnLmdhbWVNb2RlID0gUkVBRFlfRElBTE9HX0dBTUVfTU9ERV9PUFRJT05TW1JFQURZX0RJQUxPR19HQU1FX01PREVfQ1VTVE9NX0lOREVYXTsKICAgIH0KICAgIGNvbnN0IG5leHRDZWlsaW5nT3ZlcnJpZGVFbmFibGVkID0KICAgICAgICBjZmcuY29uZmlybWVkLmFpcmNyYWZ0Q2VpbGluZ092ZXJyaWRlRW5hYmxlZCB8fCBjZmcuYWlyY3JhZnRDZWlsaW5nT3ZlcnJpZGVQZW5kaW5nOwogICAgY29uc3QgYXBwbHlDdXN0b21DZWlsaW5nID0gc2hvdWxkQXBwbHlDdXN0b21DZWlsaW5nRm9yQ29uZmlnKGNmZy5nYW1lTW9kZSwgbmV4dENlaWxpbmdPdmVycmlkZUVuYWJsZWQpOwogICAgY29uc3QgaXNNYXBEZWZhdWx0VmVoaWNsZSA9IGNmZy52ZWhpY2xlSW5kZXhUMSA9PT0gUkVBRFlfRElBTE9HX1ZFSElDTEVfTUFQX0RFRkFVTFRfSU5ERVg7CiAgICAvLyBLZWVwIHRoZSBzZWxlY3RlZCBoZWxpIG92ZXJyaWRlIGNvbnNpc3RlbnQgYWNyb3NzIHRlYW1zIHdoZW4gY29uZmlybWluZy4KICAgIGNmZy52ZWhpY2xlSW5kZXhUMiA9IGNmZy52ZWhpY2xlSW5kZXhUMTsKICAgIGNmZy52ZWhpY2xlc1QyID0gY2ZnLnZlaGljbGVzVDE7CiAgICBjZmcuY29uZmlybWVkID0gewogICAgICAgIGdhbWVNb2RlOiBjZmcuZ2FtZU1vZGUsCiAgICAgICAgZ2FtZVNldHRpbmdzOiBjZmcuZ2FtZVNldHRpbmdzLAogICAgICAgIHZlaGljbGVzVDE6IGNmZy52ZWhpY2xlc1QxLAogICAgICAgIHZlaGljbGVzVDI6IGNmZy52ZWhpY2xlc1QxLAogICAgICAgIGFpcmNyYWZ0Q2VpbGluZzogY2ZnLmFpcmNyYWZ0Q2VpbGluZywKICAgICAgICBhaXJjcmFmdENlaWxpbmdPdmVycmlkZUVuYWJsZWQ6IG5leHRDZWlsaW5nT3ZlcnJpZGVFbmFibGVkLAogICAgICAgIHZlaGljbGVJbmRleFQxOiBjZmcudmVoaWNsZUluZGV4VDEsCiAgICAgICAgdmVoaWNsZUluZGV4VDI6IGNmZy52ZWhpY2xlSW5kZXhUMSwKICAgICAgICB2ZWhpY2xlT3ZlcnJpZGVFbmFibGVkOiAhaXNNYXBEZWZhdWx0VmVoaWNsZSwKICAgIH07CiAgICByZWZyZXNoT3ZlcnRpbWVab25lc0Zyb21NYXBDb25maWcoKTsKICAgIC8vIEFwcGx5IGN1c3RvbSBjZWlsaW5nIG9ubHkgYWZ0ZXIgdGhlIHVzZXIgY29uZmlybXMgc2V0dGluZ3M7IGVuZm9yY2VtZW50IHJ1bnMgd2hpbGUgZW5hYmxlZC4KICAgIGlmICghYXBwbHlDdXN0b21DZWlsaW5nKSB7CiAgICAgICAgZGlzYWJsZUN1c3RvbUFpcmNyYWZ0Q2VpbGluZ0FuZFJlc3RvcmVEZWZhdWx0KCk7CiAgICB9IGVsc2UgewogICAgICAgIGVuYWJsZUN1c3RvbUFpcmNyYWZ0Q2VpbGluZygpOwogICAgICAgIGlmIChBSVJDUkFGVF9DRUlMSU5HX0VORk9SQ0VNRU5UX01PREUgPT09ICJoYXJkIikgewogICAgICAgICAgICBhcHBseUN1c3RvbUFpcmNyYWZ0Q2VpbGluZ0hhcmRMaW1pdGVyKCk7CiAgICAgICAgfQogICAgfQogICAgaWYgKGNoYW5nZWRCeSAmJiBjZmcuY29uZmlybWVkLmFpcmNyYWZ0Q2VpbGluZyAhPT0gcHJldkNvbmZpcm1lZCkgewogICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX1JFQURZX0RJQUxPR19BSVJDUkFGVF9DRUlMSU5HX0NIQU5HRUQsIGNoYW5nZWRCeSwgTWF0aC5mbG9vcihjZmcuY29uZmlybWVkLmFpcmNyYWZ0Q2VpbGluZykpLAogICAgICAgICAgICB0cnVlLAogICAgICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgICAgIFNUUl9SRUFEWV9ESUFMT0dfQUlSQ1JBRlRfQ0VJTElOR19DSEFOR0VECiAgICAgICAgKTsKICAgIH0KICAgIGlmIChjaGFuZ2VkQnkgJiYgY2ZnLmNvbmZpcm1lZC5nYW1lTW9kZSAhPT0gcHJldkdhbWVNb2RlKSB7CiAgICAgICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgICAgICBtb2QuTWVzc2FnZShTVFJfUkVBRFlfRElBTE9HX0dBTUVfTU9ERV9DSEFOR0VELCBjaGFuZ2VkQnksIGNmZy5jb25maXJtZWQuZ2FtZU1vZGUpLAogICAgICAgICAgICB0cnVlLAogICAgICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgICAgIFNUUl9SRUFEWV9ESUFMT0dfR0FNRV9NT0RFX0NIQU5HRUQKICAgICAgICApOwogICAgfQogICAgcmVmcmVzaFZlaGljbGVTcGF3blNwZWNzRnJvbU1vZGVDb25maWcoKTsKICAgIGFwcGx5VmVoaWNsZVNwYXduU3BlY3NUb0V4aXN0aW5nU2xvdHMoKTsKICAgIHVwZGF0ZVNldHRpbmdzU3VtbWFyeUh1ZEZvckFsbFBsYXllcnMoKTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIE1vZGUgUHJlc2V0cyArIENvbmZpcm0gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIFRlYW0vTWF0Y2h1cCBSZWFkb3V0cyArIFN1bW1hcnkgSFVEIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiB1cGRhdGVUZWFtTmFtZVdpZGdldHNGb3JQaWQocGlkOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IHQxTmFtZUtleSA9IGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMSk7CiAgICBjb25zdCB0Mk5hbWVLZXkgPSBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTIpOwoKICAgIGNvbnN0IGh1ZFQxID0gc2FmZUZpbmQoYFRlYW1MZWZ0X05hbWVfJHtwaWR9YCk7CiAgICBjb25zdCBodWRUMiA9IHNhZmVGaW5kKGBUZWFtUmlnaHRfTmFtZV8ke3BpZH1gKTsKICAgIGlmIChodWRUMSkgbW9kLlNldFVJVGV4dExhYmVsKGh1ZFQxLCBtb2QuTWVzc2FnZSh0MU5hbWVLZXkpKTsKICAgIGlmIChodWRUMikgbW9kLlNldFVJVGV4dExhYmVsKGh1ZFQyLCBtb2QuTWVzc2FnZSh0Mk5hbWVLZXkpKTsKCiAgICBjb25zdCByZWFkeVQxID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX1RFQU0xX0xBQkVMX0lEICsgcGlkKTsKICAgIGNvbnN0IHJlYWR5VDIgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfVEVBTTJfTEFCRUxfSUQgKyBwaWQpOwogICAgaWYgKHJlYWR5VDEpIG1vZC5TZXRVSVRleHRMYWJlbChyZWFkeVQxLCBtb2QuTWVzc2FnZSh0MU5hbWVLZXkpKTsKICAgIGlmIChyZWFkeVQyKSBtb2QuU2V0VUlUZXh0TGFiZWwocmVhZHlUMiwgbW9kLk1lc3NhZ2UodDJOYW1lS2V5KSk7CgogICAgdXBkYXRlUmVhZHlEaWFsb2dNb2RlQ29uZmlnRm9yUGlkKHBpZCk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZVRlYW1OYW1lV2lkZ2V0c0ZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIHVwZGF0ZVRlYW1OYW1lV2lkZ2V0c0ZvclBpZChtb2QuR2V0T2JqSWQocCkpOwogICAgfQogICAgdXBkYXRlU2V0dGluZ3NTdW1tYXJ5SHVkRm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiB1cGRhdGVNYXRjaHVwTGFiZWxGb3JQaWQocGlkOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IGxhYmVsSWQgPSBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9MQUJFTF9JRCArIHBpZDsKICAgIGNvbnN0IGxhYmVsV2lkZ2V0ID0gc2FmZUZpbmQobGFiZWxJZCk7CiAgICBpZiAoIWxhYmVsV2lkZ2V0KSByZXR1cm47CiAgICBjb25zdCBwcmVzZXQgPSBNQVRDSFVQX1BSRVNFVFNbU3RhdGUucm91bmQubWF0Y2h1cFByZXNldEluZGV4XTsKICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICBsYWJlbFdpZGdldCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cubWF0Y2h1cEZvcm1hdCwgcHJlc2V0LmxlZnRQbGF5ZXJzLCBwcmVzZXQucmlnaHRQbGF5ZXJzKQogICAgKTsKfQoKLy8gUmVmcmVzaGVzIHRoZSBtYXRjaHVwIGxhYmVsIChlLmcuLCAiMSB2cyAxIikgZm9yIGV2ZXJ5IGFjdGl2ZSBwbGF5ZXIgSFVELgpmdW5jdGlvbiB1cGRhdGVNYXRjaHVwTGFiZWxGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICB1cGRhdGVNYXRjaHVwTGFiZWxGb3JQaWQobW9kLkdldE9iaklkKHApKTsKICAgIH0KfQoKLy8gUmVzb2x2ZXMgdGhlIHBlci1zaWRlICsgdG90YWwgcGxheWVyIHJlcXVpcmVtZW50cyBmcm9tIHRoZSBhdXRvLXN0YXJ0IHNldHRpbmcuCi8vIFNwZWNpYWwgY2FzZTogdmFsdWUgMCByZXByZXNlbnRzICIxIHZzIDAiIHRvIGFsbG93IHNvbG8gc3RhcnRzLgpmdW5jdGlvbiBnZXRBdXRvU3RhcnRNaW5QbGF5ZXJDb3VudHMoKTogeyBsZWZ0OiBudW1iZXI7IHJpZ2h0OiBudW1iZXI7IHRvdGFsOiBudW1iZXIgfSB7CiAgICBjb25zdCBwZXJTaWRlID0gTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5hdXRvU3RhcnRNaW5BY3RpdmVQbGF5ZXJzKTsKICAgIGlmIChwZXJTaWRlIDw9IDApIHsKICAgICAgICByZXR1cm4geyBsZWZ0OiAxLCByaWdodDogMCwgdG90YWw6IDEgfTsKICAgIH0KICAgIHJldHVybiB7IGxlZnQ6IHBlclNpZGUsIHJpZ2h0OiBwZXJTaWRlLCB0b3RhbDogcGVyU2lkZSAqIDIgfTsKfQoKLy8gVXBkYXRlcyBwZXItcGxheWVyIFJlYWR5IGRpYWxvZyByZWFkb3V0cyAodGFyZ2V0IGtpbGxzICsgcGxheWVycy1wZXItc2lkZSkgZm9yIGEgc2luZ2xlIHBpZC4KZnVuY3Rpb24gdXBkYXRlTWF0Y2h1cFJlYWRvdXRzRm9yUGlkKHBpZDogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCBtaW5QbGF5ZXJzV2lkZ2V0ID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01BVENIVVBfTUlOUExBWUVSU19JRCArIHBpZCk7CiAgICBjb25zdCBtaW5QbGF5ZXJzVG90YWxXaWRnZXQgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9NSU5QTEFZRVJTX1RPVEFMX0lEICsgcGlkKTsKICAgIGNvbnN0IGtpbGxzVGFyZ2V0V2lkZ2V0ID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01BVENIVVBfS0lMTFNUQVJHRVRfSUQgKyBwaWQpOwogICAgY29uc3QgY291bnRzID0gZ2V0QXV0b1N0YXJ0TWluUGxheWVyQ291bnRzKCk7CiAgICBpZiAobWluUGxheWVyc1dpZGdldCkgewogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAgbWluUGxheWVyc1dpZGdldCwKICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnBsYXllcnNGb3JtYXQsIGNvdW50cy5sZWZ0LCBjb3VudHMucmlnaHQpCiAgICAgICAgKTsKICAgIH0KICAgIGlmIChtaW5QbGF5ZXJzVG90YWxXaWRnZXQpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwoCiAgICAgICAgICAgIG1pblBsYXllcnNUb3RhbFdpZGdldCwKICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLm1pblBsYXllcnNUb1N0YXJ0Rm9ybWF0LCBjb3VudHMudG90YWwpCiAgICAgICAgKTsKICAgIH0KICAgIGlmIChraWxsc1RhcmdldFdpZGdldCkgewogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAga2lsbHNUYXJnZXRXaWRnZXQsCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy50YXJnZXRLaWxsc1RvV2luRm9ybWF0LCBNYXRoLmZsb29yKFN0YXRlLnJvdW5kLmtpbGxzVGFyZ2V0KSkKICAgICAgICApOwogICAgfQp9CgovLyBSZWZyZXNoZXMgdGhlIG1hdGNodXAgcmVhZG91dHMgZm9yIGFsbCBwbGF5ZXJzIHdpdGggYSBSZWFkeSBkaWFsb2cgSFVELgpmdW5jdGlvbiB1cGRhdGVNYXRjaHVwUmVhZG91dHNGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICB1cGRhdGVNYXRjaHVwUmVhZG91dHNGb3JQaWQobW9kLkdldE9iaklkKHApKTsKICAgIH0KICAgIHVwZGF0ZVNldHRpbmdzU3VtbWFyeUh1ZEZvckFsbFBsYXllcnMoKTsKfQoKLy8gVXNlcyBjb25maXJtZWQgbW9kZSBzZXR0aW5ncyBvbmx5IChwZW5kaW5nIFJlYWR5IGRpYWxvZyB0d2Vha3MgYXJlIG5vdCBzaG93biBoZXJlKS4KZnVuY3Rpb24gdXBkYXRlU2V0dGluZ3NTdW1tYXJ5SHVkRm9yUGlkKHBpZDogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCByZWZzID0gU3RhdGUuaHVkQ2FjaGUuaHVkQnlQaWRbcGlkXTsKICAgIGlmICghcmVmcykgcmV0dXJuOwoKICAgIGNvbnN0IGNmZyA9IFN0YXRlLnJvdW5kLm1vZGVDb25maWc7CiAgICBjb25zdCBnYW1lTW9kZVZhbHVlID0gY2ZnLmNvbmZpcm1lZC5nYW1lTW9kZTsKICAgIGNvbnN0IGFwcGx5Q3VzdG9tQ2VpbGluZyA9IHNob3VsZEFwcGx5Q3VzdG9tQ2VpbGluZ0ZvckNvbmZpZyhnYW1lTW9kZVZhbHVlLCBjZmcuY29uZmlybWVkLmFpcmNyYWZ0Q2VpbGluZ092ZXJyaWRlRW5hYmxlZCk7CiAgICBjb25zdCBjZWlsaW5nVmFsdWUgPSBhcHBseUN1c3RvbUNlaWxpbmcKICAgICAgICA/IE1hdGguZmxvb3IoY2ZnLmNvbmZpcm1lZC5haXJjcmFmdENlaWxpbmcpCiAgICAgICAgOiBTVFJfUkVBRFlfRElBTE9HX0FJUkNSQUZUX0NFSUxJTkdfVkFOSUxMQTsKICAgIGNvbnN0IHZlaGljbGVzVDFWYWx1ZSA9IGNmZy5jb25maXJtZWQudmVoaWNsZXNUMTsKICAgIGNvbnN0IHZlaGljbGVzVDJWYWx1ZSA9IGNmZy5jb25maXJtZWQudmVoaWNsZXNUMjsKCiAgICBjb25zdCBwcmVzZXQgPSBNQVRDSFVQX1BSRVNFVFNbU3RhdGUucm91bmQubWF0Y2h1cFByZXNldEluZGV4XSA/PyBNQVRDSFVQX1BSRVNFVFNbMF07CiAgICBjb25zdCB2ZWhpY2xlc0xlZnQgPSBwcmVzZXQ/LmxlZnRQbGF5ZXJzID8/IDE7CiAgICBjb25zdCB2ZWhpY2xlc1JpZ2h0ID0gcHJlc2V0Py5yaWdodFBsYXllcnMgPz8gMTsKICAgIGNvbnN0IGF1dG9TdGFydENvdW50cyA9IGdldEF1dG9TdGFydE1pblBsYXllckNvdW50cygpOwoKICAgIGlmIChyZWZzLnNldHRpbmdzR2FtZU1vZGVUZXh0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHJlZnMuc2V0dGluZ3NHYW1lTW9kZVRleHQsIG1vZC5NZXNzYWdlKFNUUl9IVURfU0VUVElOR1NfR0FNRV9NT0RFX0ZPUk1BVCwgZ2FtZU1vZGVWYWx1ZSkpOwogICAgfQogICAgaWYgKHJlZnMuc2V0dGluZ3NBaXJjcmFmdENlaWxpbmdUZXh0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHJlZnMuc2V0dGluZ3NBaXJjcmFmdENlaWxpbmdUZXh0LCBtb2QuTWVzc2FnZShTVFJfSFVEX1NFVFRJTkdTX0FJUkNSQUZUX0NFSUxJTkdfRk9STUFULCBjZWlsaW5nVmFsdWUpKTsKICAgIH0KICAgIGlmIChyZWZzLnNldHRpbmdzVmVoaWNsZXNUMVRleHQpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwoCiAgICAgICAgICAgIHJlZnMuc2V0dGluZ3NWZWhpY2xlc1QxVGV4dCwKICAgICAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX0hVRF9TRVRUSU5HU19WRUhJQ0xFU19URUFNX0ZPUk1BVCwgZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0xKSwgdmVoaWNsZXNUMVZhbHVlKQogICAgICAgICk7CiAgICB9CiAgICBpZiAocmVmcy5zZXR0aW5nc1ZlaGljbGVzVDJUZXh0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKAogICAgICAgICAgICByZWZzLnNldHRpbmdzVmVoaWNsZXNUMlRleHQsCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKFNUUl9IVURfU0VUVElOR1NfVkVISUNMRVNfVEVBTV9GT1JNQVQsIGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMiksIHZlaGljbGVzVDJWYWx1ZSkKICAgICAgICApOwogICAgfQogICAgaWYgKHJlZnMuc2V0dGluZ3NWZWhpY2xlc01hdGNodXBUZXh0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHJlZnMuc2V0dGluZ3NWZWhpY2xlc01hdGNodXBUZXh0LCBtb2QuTWVzc2FnZShTVFJfSFVEX1NFVFRJTkdTX1ZFSElDTEVTX01BVENIVVBfRk9STUFULCB2ZWhpY2xlc0xlZnQsIHZlaGljbGVzUmlnaHQpKTsKICAgIH0KICAgIGlmIChyZWZzLnNldHRpbmdzUGxheWVyc1RleHQpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwocmVmcy5zZXR0aW5nc1BsYXllcnNUZXh0LCBtb2QuTWVzc2FnZShTVFJfSFVEX1NFVFRJTkdTX1BMQVlFUlNfRk9STUFULCBhdXRvU3RhcnRDb3VudHMubGVmdCwgYXV0b1N0YXJ0Q291bnRzLnJpZ2h0KSk7CiAgICB9Cn0KCmZ1bmN0aW9uIHVwZGF0ZVNldHRpbmdzU3VtbWFyeUh1ZEZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIHVwZGF0ZVNldHRpbmdzU3VtbWFyeUh1ZEZvclBpZChtb2QuR2V0T2JqSWQocCkpOwogICAgfQp9CgpmdW5jdGlvbiBzZXRBdXRvU3RhcnRNaW5BY3RpdmVQbGF5ZXJzKHZhbHVlOiBudW1iZXIsIGV2ZW50UGxheWVyPzogbW9kLlBsYXllcik6IHZvaWQgewogICAgY29uc3QgY2xhbXBlZCA9IE1hdGgubWF4KEFVVE9fU1RBUlRfTUlOX0FDVElWRV9QTEFZRVJTX01JTiwgTWF0aC5taW4oQVVUT19TVEFSVF9NSU5fQUNUSVZFX1BMQVlFUlNfTUFYLCBNYXRoLmZsb29yKHZhbHVlKSkpOwogICAgaWYgKGNsYW1wZWQgPT09IFN0YXRlLnJvdW5kLmF1dG9TdGFydE1pbkFjdGl2ZVBsYXllcnMpIHJldHVybjsKICAgIGVuc3VyZUN1c3RvbUdhbWVNb2RlRm9yTWFudWFsQ2hhbmdlKCk7CiAgICBTdGF0ZS5yb3VuZC5hdXRvU3RhcnRNaW5BY3RpdmVQbGF5ZXJzID0gY2xhbXBlZDsKICAgIHVwZGF0ZU1hdGNodXBSZWFkb3V0c0ZvckFsbFBsYXllcnMoKTsKICAgIGlmIChldmVudFBsYXllcikgewogICAgICAgIGNvbnN0IGNvdW50cyA9IGdldEF1dG9TdGFydE1pblBsYXllckNvdW50cygpOwogICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX1JFQURZX0RJQUxPR19QTEFZRVJTX0NIQU5HRUQsIGV2ZW50UGxheWVyLCBjb3VudHMubGVmdCwgY291bnRzLnJpZ2h0KSwKICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgdW5kZWZpbmVkLAogICAgICAgICAgICBTVFJfUkVBRFlfRElBTE9HX1BMQVlFUlNfQ0hBTkdFRAogICAgICAgICk7CiAgICAgICAgdHJ5QXV0b1N0YXJ0Um91bmRJZkFsbFJlYWR5KGV2ZW50UGxheWVyKTsKICAgIH0KfQoKLy8gQXBwbGllcyB0aGUgc2VsZWN0ZWQgbWF0Y2h1cCBwcmVzZXQsIHVwZGF0ZXMgVUkvc3RhdGUsIGFuZCByZS1lbmFibGVzIHNwYXduZXJzIChub3QtbGl2ZSBvbmx5KS4KZnVuY3Rpb24gYXBwbHlNYXRjaHVwUHJlc2V0SW50ZXJuYWwoCiAgICBpbmRleDogbnVtYmVyLAogICAgZXZlbnRQbGF5ZXI/OiBtb2QuUGxheWVyLAogICAgYW5ub3VuY2U6IGJvb2xlYW4gPSB0cnVlLAogICAgYnlwYXNzQ29vbGRvd246IGJvb2xlYW4gPSBmYWxzZQopOiB2b2lkIHsKICAgIGNvbnN0IGNsYW1wZWQgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihNQVRDSFVQX1BSRVNFVFMubGVuZ3RoIC0gMSwgTWF0aC5mbG9vcihpbmRleCkpKTsKICAgIGlmIChjbGFtcGVkID09PSBTdGF0ZS5yb3VuZC5tYXRjaHVwUHJlc2V0SW5kZXgpIHJldHVybjsKICAgIGlmIChTdGF0ZS52ZWhpY2xlcy5zcGF3blNlcXVlbmNlSW5Qcm9ncmVzcykgcmV0dXJuOwogICAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpKTsKICAgIGlmICghYnlwYXNzQ29vbGRvd24gJiYgbm93IC0gU3RhdGUucm91bmQubGFzdE1hdGNodXBDaGFuZ2VBdFNlY29uZHMgPCBNQVRDSFVQX0NIQU5HRV9DT09MRE9XTl9TRUNPTkRTKSByZXR1cm47CiAgICBpZiAoYW5ub3VuY2UpIHsKICAgICAgICBlbnN1cmVDdXN0b21HYW1lTW9kZUZvck1hbnVhbENoYW5nZSgpOwogICAgfQogICAgY29uc3QgcHJlc2V0ID0gTUFUQ0hVUF9QUkVTRVRTW2NsYW1wZWRdOwogICAgU3RhdGUucm91bmQubWF0Y2h1cFByZXNldEluZGV4ID0gY2xhbXBlZDsKICAgIFN0YXRlLnJvdW5kLmxhc3RNYXRjaHVwQ2hhbmdlQXRTZWNvbmRzID0gbm93OwogICAgU3RhdGUucm91bmQua2lsbHNUYXJnZXQgPSBwcmVzZXQucm91bmRLaWxsc1RhcmdldDsKCiAgICB1cGRhdGVNYXRjaHVwTGFiZWxGb3JBbGxQbGF5ZXJzKCk7CiAgICB1cGRhdGVNYXRjaHVwUmVhZG91dHNGb3JBbGxQbGF5ZXJzKCk7CiAgICBzZXRSb3VuZFN0YXRlVGV4dEZvckFsbFBsYXllcnMoKTsKICAgIHN5bmNSb3VuZEtpbGxzVGFyZ2V0VGVzdGVyVmFsdWVGb3JBbGxQbGF5ZXJzKCk7CgogICAgaWYgKGFubm91bmNlICYmIGV2ZW50UGxheWVyKSB7CiAgICAgICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgICAgICBtb2QuTWVzc2FnZShTVFJfUkVBRFlfRElBTE9HX01BVENIVVBfQ0hBTkdFRCwgZXZlbnRQbGF5ZXIsIHByZXNldC5sZWZ0UGxheWVycywgcHJlc2V0LnJpZ2h0UGxheWVycyksCiAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgIHVuZGVmaW5lZCwKICAgICAgICAgICAgU1RSX1JFQURZX0RJQUxPR19NQVRDSFVQX0NIQU5HRUQKICAgICAgICApOwogICAgfQoKICAgIGFwcGx5U3Bhd25lckVuYWJsZW1lbnRGb3JNYXRjaHVwKGNsYW1wZWQsIHRydWUpOwoKICAgIC8vIElmIHRoZSBuZXcgbWluaW11bSBpcyBzYXRpc2ZpZWQsIGF1dG8tc3RhcnQgd2hlbiBhbGwgYWN0aXZlIHBsYXllcnMgYXJlIHJlYWR5LgogICAgaWYgKGFubm91bmNlICYmIGV2ZW50UGxheWVyKSB7CiAgICAgICAgdHJ5QXV0b1N0YXJ0Um91bmRJZkFsbFJlYWR5KGV2ZW50UGxheWVyKTsKICAgIH0KfQoKLy8gQXBwbGllcyB0aGUgc2VsZWN0ZWQgbWF0Y2h1cCBwcmVzZXQsIHVwZGF0ZXMgVUkvc3RhdGUsIGFuZCByZS1lbmFibGVzIHNwYXduZXJzIChub3QtbGl2ZSBvbmx5KS4KZnVuY3Rpb24gYXBwbHlNYXRjaHVwUHJlc2V0KGluZGV4OiBudW1iZXIsIGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBhcHBseU1hdGNodXBQcmVzZXRJbnRlcm5hbChpbmRleCwgZXZlbnRQbGF5ZXIsIHRydWUsIGZhbHNlKTsKfQoKLyogRGVhZCBmdW5jdGlvbiAtIGNvbW1lbnRpbmcgb3V0IGZvciBub3cgdG8gZW5zdXJlIHdlIGNhbiBraWxsIGl0Ci8vIFJlZnJlc2hlcyB0aGUgcm9zdGVyIFVJIGZvciBldmVyeSBwbGF5ZXIgd2hvIGN1cnJlbnRseSBoYXMgdGhlIGRpYWxvZyBvcGVuLgovLyBQaGFzZSAzIHVzZXMgdGhpcyB0byByZWZsZWN0IG1haW4tYmFzZSBzdGF0ZSBjaGFuZ2VzIGxpdmUgd2l0aG91dCByZXF1aXJpbmcgdXNlcnMgdG8gcmVvcGVuIHRoZSBkaWFsb2cuCmZ1bmN0aW9uIHJlZnJlc2hSZWFkeURpYWxvZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk6IHZvaWQgewogICAgY29uc3Qgdmlld2VycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCB2aWV3ZXJDb3VudCA9IG1vZC5Db3VudE9mKHZpZXdlcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2aWV3ZXJDb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3Qgdmlld2VyID0gbW9kLlZhbHVlSW5BcnJheSh2aWV3ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGNvbnN0IHZpZCA9IG1vZC5HZXRPYmpJZCh2aWV3ZXIpOwogICAgICAgIGlmIChTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3ZpZF0gJiYgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVt2aWRdLmRpYWxvZ1Zpc2libGUpIHsKICAgICAgICAgICAgcmVmcmVzaFJlYWR5RGlhbG9nUm9zdGVyRm9yVmlld2VyKHZpZXdlciwgdmlkKTsKICAgICAgICAgICAgdXBkYXRlUmVhZHlUb2dnbGVCdXR0b25Gb3JWaWV3ZXIodmlld2VyLCB2aWQpOwogICAgICAgIH0KICAgIH0KfQoqLwoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIFRlYW0vTWF0Y2h1cCBSZWFkb3V0cyArIFN1bW1hcnkgSFVEIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBKb2luIFByb21wdCAtIElEcyArIEdhdGluZyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gam9pblByb21wdFJvb3ROYW1lKHBpZDogbnVtYmVyKTogc3RyaW5nIHsgcmV0dXJuICJqb2luX3Byb21wdF9yb290XyIgKyBwaWQ7IH0KZnVuY3Rpb24gam9pblByb21wdFBhbmVsTmFtZShwaWQ6IG51bWJlcik6IHN0cmluZyB7IHJldHVybiAiam9pbl9wcm9tcHRfcGFuZWxfIiArIHBpZDsgfQpmdW5jdGlvbiBqb2luUHJvbXB0VGl0bGVOYW1lKHBpZDogbnVtYmVyKTogc3RyaW5nIHsgcmV0dXJuICJqb2luX3Byb21wdF90aXRsZV8iICsgcGlkOyB9CmZ1bmN0aW9uIGpvaW5Qcm9tcHRCb2R5TmFtZShwaWQ6IG51bWJlcik6IHN0cmluZyB7IHJldHVybiAiam9pbl9wcm9tcHRfYm9keV8iICsgcGlkOyB9CmZ1bmN0aW9uIGpvaW5Qcm9tcHRCdXR0b25OYW1lKHBpZDogbnVtYmVyKTogc3RyaW5nIHsgcmV0dXJuICJqb2luX3Byb21wdF9kaXNtaXNzXyIgKyBwaWQ7IH0KZnVuY3Rpb24gam9pblByb21wdEJ1dHRvbkJvcmRlck5hbWUocGlkOiBudW1iZXIpOiBzdHJpbmcgeyByZXR1cm4gam9pblByb21wdEJ1dHRvbk5hbWUocGlkKSArICJfQk9SREVSIjsgfQpmdW5jdGlvbiBqb2luUHJvbXB0QnV0dG9uVGV4dE5hbWUocGlkOiBudW1iZXIpOiBzdHJpbmcgeyByZXR1cm4gImpvaW5fcHJvbXB0X2Rpc21pc3NfdGV4dF8iICsgcGlkOyB9CmZ1bmN0aW9uIGpvaW5Qcm9tcHROZXZlclNob3dCdXR0b25OYW1lKHBpZDogbnVtYmVyKTogc3RyaW5nIHsgcmV0dXJuICJqb2luX3Byb21wdF9uZXZlcl9zaG93XyIgKyBwaWQ7IH0KZnVuY3Rpb24gam9pblByb21wdE5ldmVyU2hvd0J1dHRvbkJvcmRlck5hbWUocGlkOiBudW1iZXIpOiBzdHJpbmcgeyByZXR1cm4gam9pblByb21wdE5ldmVyU2hvd0J1dHRvbk5hbWUocGlkKSArICJfQk9SREVSIjsgfQpmdW5jdGlvbiBqb2luUHJvbXB0TmV2ZXJTaG93QnV0dG9uVGV4dE5hbWUocGlkOiBudW1iZXIpOiBzdHJpbmcgeyByZXR1cm4gImpvaW5fcHJvbXB0X25ldmVyX3Nob3dfdGV4dF8iICsgcGlkOyB9CgpmdW5jdGlvbiBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KG5hbWU6IHN0cmluZyk6IHZvaWQgewogICAgY29uc3QgdyA9IHNhZmVGaW5kKG5hbWUpOwogICAgaWYgKCF3KSByZXR1cm47CiAgICAvLyBCZXN0LWVmZm9ydCBkZWxldGU6IHdpZGdldCBtYXkgYWxyZWFkeSBiZSBnb25lIGR1cmluZyB1bmRlcGxveS9yZWNvbm5lY3QgY2h1cm4uCiAgICB0cnkgewogICAgICAgIG1vZC5EZWxldGVVSVdpZGdldCh3KTsKICAgIH0gY2F0Y2ggewogICAgICAgIC8vIEludGVudGlvbmFsbHkgc2lsZW50IHRvIGF2b2lkIGVuZ2luZS1zaWRlIGNyYXNoZXMgb24gaW52YWxpZCBoYW5kbGVzLgogICAgfQp9CgpmdW5jdGlvbiBpc0pvaW5Qcm9tcHRTdXBwcmVzc2VkRm9yUGxheWVyKHBpZDogbnVtYmVyKTogYm9vbGVhbiB7CiAgICByZXR1cm4gISFTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHROZXZlclNob3dCeVBpZE1hcFtwaWRdPy5bQUNUSVZFX01BUF9LRVldOwp9CgovLyBQZXJzaXN0ICJOZXZlciBTaG93IEFnYWluIiBwZXItbWFwIHNvIG90aGVyIG1hcHMgY2FuIHN0aWxsIHNob3cgdGhlIHByb21wdApmdW5jdGlvbiBzZXRKb2luUHJvbXB0U3VwcHJlc3NlZEZvclBsYXllcihwaWQ6IG51bWJlcik6IHZvaWQgewogICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHROZXZlclNob3dCeVBpZE1hcFtwaWRdKSB7CiAgICAgICAgU3RhdGUucGxheWVycy5qb2luUHJvbXB0TmV2ZXJTaG93QnlQaWRNYXBbcGlkXSA9IHt9OwogICAgfQogICAgU3RhdGUucGxheWVycy5qb2luUHJvbXB0TmV2ZXJTaG93QnlQaWRNYXBbcGlkXVtBQ1RJVkVfTUFQX0tFWV0gPSB0cnVlOwp9CgovLyBMaWdodHdlaWdodCBnYXRpbmcgdXNlZCBmb3IgYm90aCBqb2luLXRpbWUgYW5kIHVuZGVwbG95IHByb21wdHMgKGpvaW4tdGltZSAib25seSBvbmNlIiBpcyB0cmFja2VkIHNlcGFyYXRlbHkpLgpmdW5jdGlvbiBzaG91bGRTaG93Sm9pblByb21wdEZvclBsYXllcihwbGF5ZXI6IG1vZC5QbGF5ZXIpOiBib29sZWFuIHsKICAgIGlmICghU0hPV19IRUxQX1RFWFRfUFJPTVBUX09OX0pPSU4pIHJldHVybiBmYWxzZTsKICAgIGlmICghcGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXIpKSByZXR1cm4gZmFsc2U7CiAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocGxheWVyKTsKICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlOwogICAgaWYgKGlzSm9pblByb21wdFN1cHByZXNzZWRGb3JQbGF5ZXIocGlkKSkgcmV0dXJuIGZhbHNlOwogICAgaWYgKHNhZmVGaW5kKGpvaW5Qcm9tcHRSb290TmFtZShwaWQpKSkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHRydWU7Cn0KCi8vIEpvaW4gcHJvbXB0IHNlcXVlbmNpbmcgaGVscGVyczoKLy8gVGhlc2Uga2VlcCB0aGUgcHJvbXB0IGZsb3cgZGV0ZXJtaW5pc3RpYyBhbmQgbG93LXJpc2sgYnkgb25seSBhZGp1c3RpbmcKLy8gaW4tbWVtb3J5IHBlci1wbGF5ZXIgc3RhdGUgYW5kIHNlbGVjdGluZyBzdHJpbmcga2V5cyBhY2NvcmRpbmdseS4KZnVuY3Rpb24gZW5zdXJlSm9pblByb21wdFN0YXRlRm9yUGlkKHBpZDogbnVtYmVyKTogdm9pZCB7CiAgICBpZiAoU3RhdGUucGxheWVycy5qb2luUHJvbXB0UmVhZHlEaWFsb2dPcGVuZWRCeVBpZFtwaWRdID09PSB1bmRlZmluZWQpIHsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHRSZWFkeURpYWxvZ09wZW5lZEJ5UGlkW3BpZF0gPSBmYWxzZTsKICAgIH0KICAgIGlmIChTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHRUaXBJbmRleEJ5UGlkW3BpZF0gPT09IHVuZGVmaW5lZCkgewogICAgICAgIFN0YXRlLnBsYXllcnMuam9pblByb21wdFRpcEluZGV4QnlQaWRbcGlkXSA9IDA7CiAgICB9CiAgICBpZiAoU3RhdGUucGxheWVycy5qb2luUHJvbXB0VGlwc1VubG9ja2VkQnlQaWRbcGlkXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgU3RhdGUucGxheWVycy5qb2luUHJvbXB0VGlwc1VubG9ja2VkQnlQaWRbcGlkXSA9IGZhbHNlOwogICAgfQp9CgovLyBNYXJrcyB0aGF0IHRoZSBwbGF5ZXIgc3VjY2Vzc2Z1bGx5IG9wZW5lZCB0aGUgUmVhZHkgVXAgZGlhbG9nICh0cnVlIHVubG9jayBldmVudCkuCi8vIEVuc3VyZXMgdGhlIG5leHQgcHJvbXB0IHNob3dzIG1hbmRhdG9yeTIgYmVmb3JlIHRpcHMgYmVnaW4uCmZ1bmN0aW9uIG1hcmtKb2luUHJvbXB0UmVhZHlEaWFsb2dPcGVuZWQocGlkOiBudW1iZXIpOiB2b2lkIHsKICAgIGVuc3VyZUpvaW5Qcm9tcHRTdGF0ZUZvclBpZChwaWQpOwogICAgaWYgKFN0YXRlLnBsYXllcnMuam9pblByb21wdFJlYWR5RGlhbG9nT3BlbmVkQnlQaWRbcGlkXSkgcmV0dXJuOwogICAgU3RhdGUucGxheWVycy5qb2luUHJvbXB0UmVhZHlEaWFsb2dPcGVuZWRCeVBpZFtwaWRdID0gdHJ1ZTsKICAgIGlmICgoU3RhdGUucGxheWVycy5qb2luUHJvbXB0VGlwSW5kZXhCeVBpZFtwaWRdID8/IDApIDwgMSkgewogICAgICAgIFN0YXRlLnBsYXllcnMuam9pblByb21wdFRpcEluZGV4QnlQaWRbcGlkXSA9IDE7CiAgICB9Cn0KCi8vIEFybXMgYSBvbmUtc2hvdCBmbGFnIHdoZW4gYSBwbGF5ZXIgdHJpZ2dlcnMgdGhlIHRyaXBsZS10YXAgZGV0ZWN0b3IuCi8vIFRoaXMgbGV0cyB1cyByZXF1aXJlIHRoZSBtdWx0aS1jbGljayBwYXRoIGJlZm9yZSB1bmxvY2tpbmcgam9pbiBwcm9tcHQgdGlwcy4KZnVuY3Rpb24gYXJtSm9pblByb21wdFRyaXBsZVRhcEZvclBpZChwaWQ6IG51bWJlcik6IHZvaWQgewogICAgU3RhdGUucGxheWVycy5qb2luUHJvbXB0VHJpcGxlVGFwQXJtZWRCeVBpZFtwaWRdID0gdHJ1ZTsKfQoKZnVuY3Rpb24gY29uc3VtZUpvaW5Qcm9tcHRUcmlwbGVUYXBGb3JQaWQocGlkOiBudW1iZXIpOiBib29sZWFuIHsKICAgIGlmICghU3RhdGUucGxheWVycy5qb2luUHJvbXB0VHJpcGxlVGFwQXJtZWRCeVBpZFtwaWRdKSByZXR1cm4gZmFsc2U7CiAgICBTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHRUcmlwbGVUYXBBcm1lZEJ5UGlkW3BpZF0gPSBmYWxzZTsKICAgIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBpc0pvaW5Qcm9tcHRCb2R5S2V5U2tpcHBlZChrZXk6IG51bWJlcik6IGJvb2xlYW4gewogICAgcmV0dXJuIEpPSU5fUFJPTVBUX0JPRFlfU0VRVUVOQ0VfU0tJUF9LRVlTLmluZGV4T2Yoa2V5KSAhPT0gLTE7Cn0KCmZ1bmN0aW9uIGZpbmROZXh0Sm9pblByb21wdFNlcXVlbmNlSW5kZXgoc3RhcnRJbmRleDogbnVtYmVyKTogbnVtYmVyIHsKICAgIGNvbnN0IG1heCA9IEpPSU5fUFJPTVBUX0JPRFlfU0VRVUVOQ0VfS0VZUy5sZW5ndGg7CiAgICBpZiAobWF4IDw9IDApIHJldHVybiAwOwogICAgZm9yIChsZXQgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgbWF4OyBvZmZzZXQrKykgewogICAgICAgIGNvbnN0IGlkeCA9IChzdGFydEluZGV4ICsgb2Zmc2V0KSAlIG1heDsKICAgICAgICBjb25zdCBrZXkgPSBKT0lOX1BST01QVF9CT0RZX1NFUVVFTkNFX0tFWVNbaWR4XTsKICAgICAgICBpZiAoIWlzSm9pblByb21wdEJvZHlLZXlTa2lwcGVkKGtleSkpIHJldHVybiBpZHg7CiAgICB9CiAgICByZXR1cm4gMDsKfQoKLy8gUmV0dXJucyB0aGUgY2xhbXBlZCBzZXF1ZW5jZSBpbmRleCBmb3IgdGhpcyBwbGF5ZXIuCmZ1bmN0aW9uIGdldEpvaW5Qcm9tcHRTZXF1ZW5jZUluZGV4Rm9yUGlkKHBpZDogbnVtYmVyKTogbnVtYmVyIHsKICAgIGVuc3VyZUpvaW5Qcm9tcHRTdGF0ZUZvclBpZChwaWQpOwogICAgY29uc3QgcmF3ID0gTWF0aC5mbG9vcihTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHRUaXBJbmRleEJ5UGlkW3BpZF0gPz8gMCk7CiAgICBjb25zdCBtYXggPSBKT0lOX1BST01QVF9CT0RZX1NFUVVFTkNFX0tFWVMubGVuZ3RoOwogICAgY29uc3QgY2xhbXBlZCA9IChyYXcgPj0gMCAmJiByYXcgPCBtYXgpID8gcmF3IDogMDsKICAgIGNvbnN0IHJlc29sdmVkID0gZmluZE5leHRKb2luUHJvbXB0U2VxdWVuY2VJbmRleChjbGFtcGVkKTsKICAgIFN0YXRlLnBsYXllcnMuam9pblByb21wdFRpcEluZGV4QnlQaWRbcGlkXSA9IHJlc29sdmVkOwogICAgcmV0dXJuIHJlc29sdmVkOwp9CgovLyBTZWxlY3RzIHRoZSBib2R5IGtleSBmb3IgdGhlIHByb21wdCBiYXNlZCBvbiB1bmxvY2sgKyBzZXF1ZW5jZSBzdGF0ZS4KZnVuY3Rpb24gZ2V0Sm9pblByb21wdEJvZHlLZXlGb3JQaWQocGlkOiBudW1iZXIpOiBudW1iZXIgewogICAgZW5zdXJlSm9pblByb21wdFN0YXRlRm9yUGlkKHBpZCk7CiAgICBpZiAoIVN0YXRlLnBsYXllcnMuam9pblByb21wdFJlYWR5RGlhbG9nT3BlbmVkQnlQaWRbcGlkXSkgewogICAgICAgIHJldHVybiBTVFJfSk9JTl9QUk9NUFRfQk9EWV9NQU5EQVRPUlkxOwogICAgfQogICAgY29uc3QgaW5kZXggPSBnZXRKb2luUHJvbXB0U2VxdWVuY2VJbmRleEZvclBpZChwaWQpOwogICAgaWYgKGluZGV4ID49IDIpIHsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHRUaXBzVW5sb2NrZWRCeVBpZFtwaWRdID0gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBKT0lOX1BST01QVF9CT0RZX1NFUVVFTkNFX0tFWVNbaW5kZXhdOwp9CgovLyBDaG9vc2VzIHRoZSBkaXNtaXNzIGxhYmVsIGJhc2VkIG9uIHdoZXRoZXIgdGlwcyBhcmUgdW5sb2NrZWQuCmZ1bmN0aW9uIGdldEpvaW5Qcm9tcHREaXNtaXNzTGFiZWxLZXlGb3JQaWQocGlkOiBudW1iZXIpOiBudW1iZXIgewogICAgZW5zdXJlSm9pblByb21wdFN0YXRlRm9yUGlkKHBpZCk7CiAgICByZXR1cm4gU3RhdGUucGxheWVycy5qb2luUHJvbXB0VGlwc1VubG9ja2VkQnlQaWRbcGlkXQogICAgICAgID8gU1RSX0pPSU5fUFJPTVBUX0RJU01JU1NfU0hPV19NT1JFX1RJUFMKICAgICAgICA6IFNUUl9KT0lOX1BST01QVF9ESVNNSVNTOwp9CgovLyBOZXZlciBTaG93IEFnYWluIGlzIG9ubHkgYXZhaWxhYmxlIGFmdGVyIHRpcHMgYXJlIHVubG9ja2VkLgpmdW5jdGlvbiBzaG91bGRTaG93Sm9pblByb21wdE5ldmVyU2hvd0J1dHRvbkZvclBpZChwaWQ6IG51bWJlcik6IGJvb2xlYW4gewogICAgZW5zdXJlSm9pblByb21wdFN0YXRlRm9yUGlkKHBpZCk7CiAgICByZXR1cm4gU3RhdGUucGxheWVycy5qb2luUHJvbXB0UmVhZHlEaWFsb2dPcGVuZWRCeVBpZFtwaWRdICYmIFN0YXRlLnBsYXllcnMuam9pblByb21wdFRpcHNVbmxvY2tlZEJ5UGlkW3BpZF07Cn0KCi8vIEFkdmFuY2VzIHRoZSBzZXF1ZW5jZSBvbmx5IGFmdGVyIHRoZSBwbGF5ZXIgaGFzIHVubG9ja2VkIHRpcHMuCmZ1bmN0aW9uIGFkdmFuY2VKb2luUHJvbXB0U2VxdWVuY2VPbkRpc21pc3MocGlkOiBudW1iZXIpOiB2b2lkIHsKICAgIGVuc3VyZUpvaW5Qcm9tcHRTdGF0ZUZvclBpZChwaWQpOwogICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHRSZWFkeURpYWxvZ09wZW5lZEJ5UGlkW3BpZF0pIHsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHRUaXBJbmRleEJ5UGlkW3BpZF0gPSAwOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnN0IGN1cnJlbnQgPSBnZXRKb2luUHJvbXB0U2VxdWVuY2VJbmRleEZvclBpZChwaWQpOwogICAgY29uc3QgbmV4dCA9IGZpbmROZXh0Sm9pblByb21wdFNlcXVlbmNlSW5kZXgoY3VycmVudCArIDEpOwogICAgU3RhdGUucGxheWVycy5qb2luUHJvbXB0VGlwSW5kZXhCeVBpZFtwaWRdID0gbmV4dDsKICAgIGlmIChuZXh0ID49IDIpIHsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHRUaXBzVW5sb2NrZWRCeVBpZFtwaWRdID0gdHJ1ZTsKICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEpvaW4gUHJvbXB0IC0gSURzICsgR2F0aW5nIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBKb2luIFByb21wdCAtIExheW91dCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gQnVpbGRzIHRoZSBqb2luIG92ZXJsYXksIGJsb2NrcyBkZXBsb3ksIGFuZCBlbmFibGVzIFVJIGlucHV0IHVudGlsIGRpc21pc3NlZC4KZnVuY3Rpb24gY3JlYXRlSm9pblByb21wdEZvclBsYXllcihwbGF5ZXI6IG1vZC5QbGF5ZXIpOiB2b2lkIHsKICAgIGNvbnN0IHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChwbGF5ZXIpOwogICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkKSByZXR1cm47CiAgICBjb25zdCB1aVJvb3QgPSBtb2QuR2V0VUlSb290KCk7CiAgICBjb25zdCBib2R5S2V5ID0gZ2V0Sm9pblByb21wdEJvZHlLZXlGb3JQaWQocGlkKTsKICAgIGNvbnN0IGRpc21pc3NMYWJlbEtleSA9IGdldEpvaW5Qcm9tcHREaXNtaXNzTGFiZWxLZXlGb3JQaWQocGlkKTsKICAgIGNvbnN0IHNob3dOZXZlclNob3cgPSBzaG91bGRTaG93Sm9pblByb21wdE5ldmVyU2hvd0J1dHRvbkZvclBpZChwaWQpOwoKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdFJvb3ROYW1lKHBpZCkpOwogICAgZGVsZXRlSm9pblByb21wdFdpZGdldChqb2luUHJvbXB0QnV0dG9uQm9yZGVyTmFtZShwaWQpKTsKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdE5ldmVyU2hvd0J1dHRvbkJvcmRlck5hbWUocGlkKSk7CgogICAgbW9kLkVuYWJsZVBsYXllckRlcGxveShwbGF5ZXIsIGZhbHNlKTsKICAgIHNldFVJSW5wdXRNb2RlRm9yUGxheWVyKHBsYXllciwgdHJ1ZSk7CgogICAgbW9kLkFkZFVJQ29udGFpbmVyKAogICAgICAgIGpvaW5Qcm9tcHRSb290TmFtZShwaWQpLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigxOTIwLCAxMDgwLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgIHVpUm9vdCwKICAgICAgICB0cnVlLAogICAgICAgIDAsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigwLCAwLCAwKSwKICAgICAgICAwLjU1LAogICAgICAgIG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSwKICAgICAgICBwbGF5ZXIKICAgICk7CgogICAgY29uc3Qgcm9vdCA9IHNhZmVGaW5kKGpvaW5Qcm9tcHRSb290TmFtZShwaWQpKTsKICAgIGlmIChyb290KSBtb2QuU2V0VUlXaWRnZXREZXB0aChyb290LCBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSk7CiAgICBpZiAocm9vdCkgcmVwYXJlbnRTcGF3bkRpc2FibGVkTGl2ZVRleHRGb3JQaWQocGlkLCByb290KTsKCiAgICBjb25zdCBqb2luUHJvbXB0UGFuZWxPZmZzZXRZID0gLTU0OwogICAgY29uc3Qgam9pblByb21wdEJ1dHRvbk9mZnNldFkgPSAxNzM7CgogICAgbW9kLkFkZFVJQ29udGFpbmVyKAogICAgICAgIGpvaW5Qcm9tcHRQYW5lbE5hbWUocGlkKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIGpvaW5Qcm9tcHRQYW5lbE9mZnNldFksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoOTAwLCA0NDQsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgcm9vdCA/PyB1aVJvb3QsCiAgICAgICAgdHJ1ZSwKICAgICAgICAwLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMC4wOCwgMC4wOCwgMC4wOCksCiAgICAgICAgMC45NSwKICAgICAgICBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgcGxheWVyCiAgICApOwoKICAgIGNvbnN0IHBhbmVsID0gc2FmZUZpbmQoam9pblByb21wdFBhbmVsTmFtZShwaWQpKTsKICAgIGlmIChwYW5lbCkgbW9kLlNldFVJV2lkZ2V0RGVwdGgocGFuZWwsIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJKTsKCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIGpvaW5Qcm9tcHRUaXRsZU5hbWUocGlkKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIC0xOTIsIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoODIwLCA2MCwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICBwYW5lbCA/PyB1aVJvb3QsCiAgICAgICAgdHJ1ZSwKICAgICAgICAwLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCksCiAgICAgICAgMCwKICAgICAgICBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICBtb2QuTWVzc2FnZShTVFJfSk9JTl9QUk9NUFRfVElUTEUpLAogICAgICAgIDQyLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMSwgMSwgMSksCiAgICAgICAgMSwKICAgICAgICBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJLAogICAgICAgIHBsYXllcgogICAgKTsKCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIGpvaW5Qcm9tcHRCb2R5TmFtZShwaWQpLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3Rvcig3NDAsIDMwMCwgMCksIC8vIDkwMC13aWRlIHBhbmVsIHdpdGggODBweCBzaWRlIGluc2V0IG9uIGVhY2ggc2lkZQogICAgICAgIG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgcGFuZWwgPz8gdWlSb290LAogICAgICAgIHRydWUsCiAgICAgICAgMCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDAsIDApLAogICAgICAgIDAsCiAgICAgICAgbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgbW9kLk1lc3NhZ2UoYm9keUtleSksCiAgICAgICAgMjIsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigxLCAxLCAxKSwKICAgICAgICAxLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJLAogICAgICAgIHBsYXllcgogICAgKTsKCiAgICBjb25zdCBuZXZlclNob3dCb3JkZXIgPSBhZGRPdXRsaW5lZEJ1dHRvbigKICAgICAgICBqb2luUHJvbXB0TmV2ZXJTaG93QnV0dG9uTmFtZShwaWQpLAogICAgICAgIC0yMDAsCiAgICAgICAgam9pblByb21wdEJ1dHRvbk9mZnNldFksCiAgICAgICAgMzYwLAogICAgICAgIDcwLAogICAgICAgIG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgcGFuZWwgPz8gdWlSb290LAogICAgICAgIHBsYXllcgogICAgKTsKCiAgICBjb25zdCBuZXZlclNob3dCdXR0b24gPSBzYWZlRmluZChqb2luUHJvbXB0TmV2ZXJTaG93QnV0dG9uTmFtZShwaWQpKTsKICAgIGlmIChuZXZlclNob3dCdXR0b24pIHsKICAgICAgICBtb2QuU2V0VUlXaWRnZXREZXB0aChuZXZlclNob3dCdXR0b24sIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJKTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKG5ldmVyU2hvd0J1dHRvbiwgc2hvd05ldmVyU2hvdyk7CiAgICAgICAgbW9kLkVuYWJsZVVJQnV0dG9uRXZlbnQobmV2ZXJTaG93QnV0dG9uLCBtb2QuVUlCdXR0b25FdmVudC5CdXR0b25VcCwgc2hvd05ldmVyU2hvdyk7CiAgICB9CiAgICBjb25zdCBuZXZlclNob3dCb3JkZXJXaWRnZXQgPSBzYWZlRmluZChqb2luUHJvbXB0TmV2ZXJTaG93QnV0dG9uQm9yZGVyTmFtZShwaWQpKTsKICAgIGlmIChuZXZlclNob3dCb3JkZXJXaWRnZXQpIHsKICAgICAgICBtb2QuU2V0VUlXaWRnZXREZXB0aChuZXZlclNob3dCb3JkZXJXaWRnZXQsIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJKTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKG5ldmVyU2hvd0JvcmRlcldpZGdldCwgc2hvd05ldmVyU2hvdyk7CiAgICB9CgogICAgY29uc3QgbmV2ZXJTaG93VGV4dFBhcmVudCA9IG5ldmVyU2hvd0JvcmRlciA/PyBwYW5lbCA/PyB1aVJvb3Q7CiAgICBjb25zdCBuZXZlclNob3dUZXh0ID0gYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIGpvaW5Qcm9tcHROZXZlclNob3dCdXR0b25UZXh0TmFtZShwaWQpLAogICAgICAgIDM2MCwKICAgICAgICA3MCwKICAgICAgICBtb2QuTWVzc2FnZShTVFJfSk9JTl9QUk9NUFRfTkVWRVJfU0hPVyksCiAgICAgICAgcGxheWVyLAogICAgICAgIG5ldmVyU2hvd1RleHRQYXJlbnQKICAgICk7CiAgICBpZiAobmV2ZXJTaG93VGV4dCkgewogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKG5ldmVyU2hvd1RleHQsIDI0KTsKICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3IobmV2ZXJTaG93VGV4dCwgbW9kLkNyZWF0ZVZlY3RvcigxLCAxLCAxKSk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0RGVwdGgobmV2ZXJTaG93VGV4dCwgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUkpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChuZXZlclNob3dUZXh0LCBuZXZlclNob3dUZXh0UGFyZW50KTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRQb3NpdGlvbigKICAgICAgICAgICAgbmV2ZXJTaG93VGV4dCwKICAgICAgICAgICAgbmV2ZXJTaG93Qm9yZGVyID8gbW9kLkNyZWF0ZVZlY3RvcigwLCAwLCAwKSA6IG1vZC5DcmVhdGVWZWN0b3IoLTIwMCwgam9pblByb21wdEJ1dHRvbk9mZnNldFksIDApCiAgICAgICAgKTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKG5ldmVyU2hvd1RleHQsIHNob3dOZXZlclNob3cpOwogICAgfQoKICAgIGNvbnN0IGRpc21pc3NCb3JkZXIgPSBhZGRPdXRsaW5lZEJ1dHRvbigKICAgICAgICBqb2luUHJvbXB0QnV0dG9uTmFtZShwaWQpLAogICAgICAgIDIwMCwKICAgICAgICBqb2luUHJvbXB0QnV0dG9uT2Zmc2V0WSwKICAgICAgICAzNjAsCiAgICAgICAgNzAsCiAgICAgICAgbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICBwYW5lbCA/PyB1aVJvb3QsCiAgICAgICAgcGxheWVyCiAgICApOwoKICAgIGNvbnN0IGRpc21pc3NCdXR0b24gPSBzYWZlRmluZChqb2luUHJvbXB0QnV0dG9uTmFtZShwaWQpKTsKICAgIGlmIChkaXNtaXNzQnV0dG9uKSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0RGVwdGgoZGlzbWlzc0J1dHRvbiwgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUkpOwogICAgICAgIG1vZC5FbmFibGVVSUJ1dHRvbkV2ZW50KGRpc21pc3NCdXR0b24sIG1vZC5VSUJ1dHRvbkV2ZW50LkJ1dHRvblVwLCB0cnVlKTsKICAgIH0KICAgIGNvbnN0IGRpc21pc3NCb3JkZXJXaWRnZXQgPSBzYWZlRmluZChqb2luUHJvbXB0QnV0dG9uQm9yZGVyTmFtZShwaWQpKTsKICAgIGlmIChkaXNtaXNzQm9yZGVyV2lkZ2V0KSBtb2QuU2V0VUlXaWRnZXREZXB0aChkaXNtaXNzQm9yZGVyV2lkZ2V0LCBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSk7CgogICAgY29uc3QgZGlzbWlzc1RleHRQYXJlbnQgPSBkaXNtaXNzQm9yZGVyID8/IHBhbmVsID8/IHVpUm9vdDsKICAgIGNvbnN0IGRpc21pc3NUZXh0ID0gYWRkQ2VudGVyZWRCdXR0b25UZXh0KAogICAgICAgIGpvaW5Qcm9tcHRCdXR0b25UZXh0TmFtZShwaWQpLAogICAgICAgIDM2MCwKICAgICAgICA3MCwKICAgICAgICBtb2QuTWVzc2FnZShkaXNtaXNzTGFiZWxLZXkpLAogICAgICAgIHBsYXllciwKICAgICAgICBkaXNtaXNzVGV4dFBhcmVudAogICAgKTsKICAgIGlmIChkaXNtaXNzVGV4dCkgewogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKGRpc21pc3NUZXh0LCAyNCk7CiAgICAgICAgbW9kLlNldFVJVGV4dENvbG9yKGRpc21pc3NUZXh0LCBtb2QuQ3JlYXRlVmVjdG9yKDEsIDEsIDEpKTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXREZXB0aChkaXNtaXNzVGV4dCwgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUkpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChkaXNtaXNzVGV4dCwgZGlzbWlzc1RleHRQYXJlbnQpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldFBvc2l0aW9uKAogICAgICAgICAgICBkaXNtaXNzVGV4dCwKICAgICAgICAgICAgZGlzbWlzc0JvcmRlciA/IG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCkgOiBtb2QuQ3JlYXRlVmVjdG9yKDIwMCwgam9pblByb21wdEJ1dHRvbk9mZnNldFksIDApCiAgICAgICAgKTsKICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEpvaW4gUHJvbXB0IC0gTGF5b3V0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBKb2luIFByb21wdCAtIExpZmVjeWNsZSArIEV2ZW50cyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gUmVzcGVjdHMgcm91bmQvY2xlYW51cCBsb2NrcyB3aGVuIHJlLWVuYWJsaW5nIGRlcGxveSBhZnRlciBkaXNtaXNzLgpmdW5jdGlvbiBjYW5FbmFibGVEZXBsb3lBZnRlckpvaW5Qcm9tcHQoKTogYm9vbGVhbiB7CiAgICBpZiAoU3RhdGUucm91bmQuZmxvdy5jbGVhbnVwQWN0aXZlICYmICFTdGF0ZS5yb3VuZC5mbG93LmNsZWFudXBBbGxvd0RlcGxveSkgcmV0dXJuIGZhbHNlOwogICAgaWYgKGlzTGl2ZVJlc3Bhd25EaXNhYmxlZCgpICYmIGlzUm91bmRMaXZlKCkpIHJldHVybiBmYWxzZTsKICAgIHJldHVybiB0cnVlOwp9CgovLyBEaXNtaXNzZXMgdGhlIG92ZXJsYXkgYW5kIHJlc3RvcmVzIGlucHV0L2RlcGxveSBiYXNlZCBvbiBjdXJyZW50IGxvY2tzLgpmdW5jdGlvbiBkaXNtaXNzSm9pblByb21wdEZvclBsYXllcihwbGF5ZXI6IG1vZC5QbGF5ZXIpOiB2b2lkIHsKICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChwbGF5ZXIpOwoKICAgIHNldFVJSW5wdXRNb2RlRm9yUGxheWVyKHBsYXllciwgZmFsc2UpOwogICAgbW9kLkVuYWJsZVBsYXllckRlcGxveShwbGF5ZXIsIGNhbkVuYWJsZURlcGxveUFmdGVySm9pblByb21wdCgpKTsKICAgIHJlcGFyZW50U3Bhd25EaXNhYmxlZExpdmVUZXh0Rm9yUGlkKHBpZCwgbW9kLkdldFVJUm9vdCgpKTsKCiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHRCdXR0b25UZXh0TmFtZShwaWQpKTsKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdEJ1dHRvbk5hbWUocGlkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHRCdXR0b25Cb3JkZXJOYW1lKHBpZCkpOwogICAgZGVsZXRlSm9pblByb21wdFdpZGdldChqb2luUHJvbXB0TmV2ZXJTaG93QnV0dG9uVGV4dE5hbWUocGlkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHROZXZlclNob3dCdXR0b25OYW1lKHBpZCkpOwogICAgZGVsZXRlSm9pblByb21wdFdpZGdldChqb2luUHJvbXB0TmV2ZXJTaG93QnV0dG9uQm9yZGVyTmFtZShwaWQpKTsKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdEJvZHlOYW1lKHBpZCkpOwogICAgZGVsZXRlSm9pblByb21wdFdpZGdldChqb2luUHJvbXB0VGl0bGVOYW1lKHBpZCkpOwogICAgZGVsZXRlSm9pblByb21wdFdpZGdldChqb2luUHJvbXB0UGFuZWxOYW1lKHBpZCkpOwogICAgZGVsZXRlSm9pblByb21wdFdpZGdldChqb2luUHJvbXB0Um9vdE5hbWUocGlkKSk7Cn0KCi8vIEhhcmQgY2xlYW51cCBmb3IgZGlzY29ubmVjdHMgKHJlbW92ZXMgYW55IHByb21wdCB3aWRnZXRzIGZvciB0aGF0IHBpZCkuCmZ1bmN0aW9uIGNsZWFySm9pblByb21wdEZvclBsYXllcklkKHBsYXllcklkOiBudW1iZXIpOiB2b2lkIHsKICAgIHJlcGFyZW50U3Bhd25EaXNhYmxlZExpdmVUZXh0Rm9yUGlkKHBsYXllcklkLCBtb2QuR2V0VUlSb290KCkpOwogICAgZGVsZXRlSm9pblByb21wdFdpZGdldChqb2luUHJvbXB0QnV0dG9uVGV4dE5hbWUocGxheWVySWQpKTsKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdEJ1dHRvbk5hbWUocGxheWVySWQpKTsKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdEJ1dHRvbkJvcmRlck5hbWUocGxheWVySWQpKTsKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdE5ldmVyU2hvd0J1dHRvblRleHROYW1lKHBsYXllcklkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHROZXZlclNob3dCdXR0b25OYW1lKHBsYXllcklkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHROZXZlclNob3dCdXR0b25Cb3JkZXJOYW1lKHBsYXllcklkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHRCb2R5TmFtZShwbGF5ZXJJZCkpOwogICAgZGVsZXRlSm9pblByb21wdFdpZGdldChqb2luUHJvbXB0VGl0bGVOYW1lKHBsYXllcklkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHRQYW5lbE5hbWUocGxheWVySWQpKTsKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdFJvb3ROYW1lKHBsYXllcklkKSk7Cn0KCi8vIEJ1dHRvbiBoYW5kbGVyOiBkaXNtaXNzZXMgd2hlbiB0aGUgT0sgYnV0dG9uIChvciBpdHMgY2hpbGRyZW4pIGlzIGNsaWNrZWQuCmZ1bmN0aW9uIHRyeUhhbmRsZUpvaW5Qcm9tcHRCdXR0b24oCiAgICBldmVudFBsYXllcjogbW9kLlBsYXllciwKICAgIGV2ZW50VUlXaWRnZXQ6IG1vZC5VSVdpZGdldCwKICAgIGV2ZW50VUlCdXR0b25FdmVudDogbW9kLlVJQnV0dG9uRXZlbnQKKTogYm9vbGVhbiB7CiAgICBpZiAoIVNIT1dfSEVMUF9URVhUX1BST01QVF9PTl9KT0lOKSByZXR1cm4gZmFsc2U7CiAgICBpZiAoIWV2ZW50UGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChldmVudFBsYXllcikpIHJldHVybiBmYWxzZTsKICAgIGlmICghbW9kLkVxdWFscyhldmVudFVJQnV0dG9uRXZlbnQsIG1vZC5VSUJ1dHRvbkV2ZW50LkJ1dHRvblVwKSkgcmV0dXJuIGZhbHNlOwoKICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChldmVudFBsYXllcik7CiAgICBjb25zdCBkaXNtaXNzSWQgPSBqb2luUHJvbXB0QnV0dG9uTmFtZShwaWQpOwogICAgY29uc3QgbmV2ZXJTaG93SWQgPSBqb2luUHJvbXB0TmV2ZXJTaG93QnV0dG9uTmFtZShwaWQpOwogICAgbGV0IHc6IG1vZC5VSVdpZGdldCA9IGV2ZW50VUlXaWRnZXQ7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkrKykgewogICAgICAgIGNvbnN0IG5hbWUgPSBtb2QuR2V0VUlXaWRnZXROYW1lKHcpOwogICAgICAgIGlmIChuYW1lID09PSBkaXNtaXNzSWQpIHsKICAgICAgICAgICAgYWR2YW5jZUpvaW5Qcm9tcHRTZXF1ZW5jZU9uRGlzbWlzcyhwaWQpOwogICAgICAgICAgICBkaXNtaXNzSm9pblByb21wdEZvclBsYXllcihldmVudFBsYXllcik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAobmFtZSA9PT0gbmV2ZXJTaG93SWQpIHsKICAgICAgICAgICAgc2V0Sm9pblByb21wdFN1cHByZXNzZWRGb3JQbGF5ZXIocGlkKTsKICAgICAgICAgICAgZGlzbWlzc0pvaW5Qcm9tcHRGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgY29uc3QgcGFyZW50ID0gbW9kLkdldFVJV2lkZ2V0UGFyZW50KHcpOwogICAgICAgIGlmICghcGFyZW50KSBicmVhazsKICAgICAgICB3ID0gcGFyZW50OwogICAgfQogICAgcmV0dXJuIGZhbHNlOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSm9pbiBQcm9tcHQgLSBMaWZlY3ljbGUgKyBFdmVudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIFJlYWR5IFN0YXRlIFJlc2V0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBSZXNldHMgYWxsIHBsYXllcnMgdG8gTk9UIFJFQURZLiBDYWxsZWQgd2hlbiBhIHJvdW5kIGVuZHMgKGluY2x1ZGluZyBtYXRjaC1lbmQgcGF0aHMpIHNvIHRoZSBuZXh0IHJvdW5kIHJlcXVpcmVzIGEgZnJlc2ggcmVhZHktdXAgY3ljbGUuCmZ1bmN0aW9uIHJlc2V0UmVhZHlTdGF0ZUZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChwKTsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSA9IGZhbHNlOwogICAgICAgIGRlbGV0ZSBTdGF0ZS5wbGF5ZXJzLm92ZXJUYWtlb2ZmTGltaXRCeVBpZFtwaWRdOwogICAgICAgIC8vIEtlZXAgdGhlIEhVRCAiWCAvIFkgUExBWUVSUyBSRUFEWSIgbGluZSBpbiBzeW5jIG9uIGV2ZXJ5IHJlYWR5LXN0YXRlIGNoYW5nZS4KICAgICAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgfQogICAgLy8gSWYgYW55IGRpYWxvZ3MgYXJlIG9wZW4sIHJlZmxlY3QgdGhlIHJlc2V0IGltbWVkaWF0ZWx5LgogICAgcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycygpOwogICAgdXBkYXRlUGxheWVyc1JlYWR5SHVkVGV4dEZvckFsbFBsYXllcnMoKTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIFJlYWR5IFN0YXRlIFJlc2V0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgLSBUYWtlb2ZmIExpbWl0IEdhdGluZyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gaXNQbGF5ZXJJbk1haW5CYXNlRm9yUmVhZHkocGlkOiBudW1iZXIpOiBib29sZWFuIHsKICAgIGNvbnN0IGluQmFzZSA9IChTdGF0ZS5wbGF5ZXJzLmluTWFpbkJhc2VCeVBpZFtwaWRdICE9PSB1bmRlZmluZWQpID8gU3RhdGUucGxheWVycy5pbk1haW5CYXNlQnlQaWRbcGlkXSA6IHRydWU7CiAgICBpZiAoU3RhdGUucGxheWVycy5vdmVyVGFrZW9mZkxpbWl0QnlQaWRbcGlkXSkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIGluQmFzZTsKfQoKYXN5bmMgZnVuY3Rpb24gc2hvd092ZXJUYWtlb2ZmTWVzc2FnZUZvckFsbFBsYXllcnMob2ZmZW5kZXI6IG1vZC5QbGF5ZXIpOiBQcm9taXNlPHZvaWQ+IHsKICAgIGNvbnN0IG9mZmVuZGVyVG9rZW4gPSAob2ZmZW5kZXIgJiYgbW9kLklzUGxheWVyVmFsaWQob2ZmZW5kZXIpKQogICAgICAgID8gb2ZmZW5kZXIKICAgICAgICA6IG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0udW5rbm93blBsYXllcjsKICAgIGF3YWl0IHNob3dHbG9iYWxUaXRsZVN1YnRpdGxlTWVzc2FnZUZvckFsbFBsYXllcnMoCiAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX09WRVJMSU5FX1RBS0VPRkZfVElUTEUsIG9mZmVuZGVyVG9rZW4pLAogICAgICAgIG1vZC5NZXNzYWdlKFNUUl9PVkVSTElORV9UQUtFT0ZGX1NVQlRJVExFLCBvZmZlbmRlclRva2VuKSwKICAgICAgICBDT0xPUl9OT1RfUkVBRFlfUkVELAogICAgICAgIENPTE9SX1dBUk5JTkdfWUVMTE9XCiAgICApOwp9CgpmdW5jdGlvbiBjaGVja1Rha2VvZmZMaW1pdEZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCkgcmV0dXJuOwogICAgaWYgKGlzUm91bmRMaXZlKCkpIHJldHVybjsKCiAgICBjb25zdCBmbG9vclkgPSBNYXRoLmZsb29yKFN0YXRlLnJvdW5kLmFpcmNyYWZ0Q2VpbGluZy5odWRGbG9vclkpOwogICAgY29uc3QgbGltaXRZID0gZmxvb3JZICsgVEFLRU9GRl9MSU1JVF9IVURfT0ZGU0VUOwoKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHApOwogICAgICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCkgY29udGludWU7CgogICAgICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChwKSkgewogICAgICAgICAgICBkZWxldGUgU3RhdGUucGxheWVycy5vdmVyVGFrZW9mZkxpbWl0QnlQaWRbcGlkXTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBwb3MgPSBzYWZlR2V0U29sZGllclN0YXRlVmVjdG9yKHAsIG1vZC5Tb2xkaWVyU3RhdGVWZWN0b3IuR2V0UG9zaXRpb24pOwogICAgICAgIGlmICghcG9zKSBjb250aW51ZTsKICAgICAgICBjb25zdCBwb3NZID0gbW9kLllDb21wb25lbnRPZihwb3MpOwogICAgICAgIGNvbnN0IGN1cnJlbnRseU92ZXIgPSAhIVN0YXRlLnBsYXllcnMub3ZlclRha2VvZmZMaW1pdEJ5UGlkW3BpZF07CiAgICAgICAgY29uc3Qgb3ZlckxpbWl0ID0gcG9zWSA+IGxpbWl0WTsKCiAgICAgICAgaWYgKG92ZXJMaW1pdCAmJiAhY3VycmVudGx5T3ZlciAmJiBpc1BsYXllckluTWFpbkJhc2VGb3JSZWFkeShwaWQpKSB7CiAgICAgICAgICAgIFN0YXRlLnBsYXllcnMub3ZlclRha2VvZmZMaW1pdEJ5UGlkW3BpZF0gPSB0cnVlOwogICAgICAgICAgICBTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSA9IGZhbHNlOwogICAgICAgICAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgICAgICAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JQaWQocGlkKTsKICAgICAgICAgICAgaWYgKFN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc1JlcXVlc3RlZCkgewogICAgICAgICAgICAgICAgY2FuY2VsUHJlZ2FtZUNvdW50ZG93bigpOwogICAgICAgICAgICAgICAgdm9pZCBzaG93T3ZlclRha2VvZmZNZXNzYWdlRm9yQWxsUGxheWVycyhwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgICAgICBtb2QuTWVzc2FnZShTVFJfUkVBRFlVUF9SRVRVUk5fVE9fQkFTRV9OT1RfTElWRSwgTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5jdXJyZW50KSksCiAgICAgICAgICAgICAgICBmYWxzZSwKICAgICAgICAgICAgICAgIHAsCiAgICAgICAgICAgICAgICBTVFJfUkVBRFlVUF9SRVRVUk5fVE9fQkFTRV9OT1RfTElWRQogICAgICAgICAgICApOwogICAgICAgICAgICByZW5kZXJSZWFkeURpYWxvZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFvdmVyTGltaXQgJiYgY3VycmVudGx5T3ZlcikgewogICAgICAgICAgICBkZWxldGUgU3RhdGUucGxheWVycy5vdmVyVGFrZW9mZkxpbWl0QnlQaWRbcGlkXTsKICAgICAgICAgICAgcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycygpOwogICAgICAgIH0KICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIFRha2VvZmYgTGltaXQgR2F0aW5nIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIEF1dG8tUmVhZHkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIEFwcGxpZXMgYXV0by1yZWFkeSBydWxlcyBmb3IgYSBzaW5nbGUgcGxheWVyLiBSZXR1cm5zIHRydWUgaWYgcmVhZHkgc3RhdGUgY2hhbmdlZC4KZnVuY3Rpb24gYXBwbHlBdXRvUmVhZHlGb3JQaWQocGxheWVyOiBtb2QuUGxheWVyLCBwaWQ6IG51bWJlcik6IGJvb2xlYW4gewogICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIHJldHVybiBmYWxzZTsKICAgIGlmICghU3RhdGUucGxheWVycy5hdXRvUmVhZHlCeVBpZFtwaWRdKSByZXR1cm4gZmFsc2U7CiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCB8fCBpc1JvdW5kTGl2ZSgpKSByZXR1cm4gZmFsc2U7CgogICAgY29uc3QgaW5WZWhpY2xlID0gaXNQbGF5ZXJEZXBsb3llZChwbGF5ZXIpCiAgICAgICAgPyBzYWZlR2V0U29sZGllclN0YXRlQm9vbChwbGF5ZXIsIG1vZC5Tb2xkaWVyU3RhdGVCb29sLklzSW5WZWhpY2xlKQogICAgICAgIDogZmFsc2U7CiAgICBjb25zdCBpbkJhc2UgPSBpc1BsYXllckluTWFpbkJhc2VGb3JSZWFkeShwaWQpOwogICAgY29uc3Qgc2hvdWxkQmVSZWFkeSA9ICEhaW5WZWhpY2xlICYmIGluQmFzZTsKICAgIGNvbnN0IGN1cnJlbnRseVJlYWR5ID0gISFTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXTsKCiAgICBpZiAoc2hvdWxkQmVSZWFkeSA9PT0gY3VycmVudGx5UmVhZHkpIHJldHVybiBmYWxzZTsKCiAgICBTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSA9IHNob3VsZEJlUmVhZHk7CiAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JQaWQocGlkKTsKCiAgICBpZiAoc2hvdWxkQmVSZWFkeSkgewogICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX1BMQVlFUl9BVVRPX1JFQURJRURfVVAsIHBsYXllciksCiAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgIHVuZGVmaW5lZCwKICAgICAgICAgICAgU1RSX1BMQVlFUl9BVVRPX1JFQURJRURfVVAKICAgICAgICApOwogICAgfQogICAgcmV0dXJuIHRydWU7Cn0KCi8vIEFwcGxpZXMgYXV0by1yZWFkeSBydWxlcyBmb3IgYWxsIHBsYXllcnMgd2hvIGhhdmUgYXV0by1yZWFkeSBlbmFibGVkLgpmdW5jdGlvbiBhcHBseUF1dG9SZWFkeUZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCB8fCBpc1JvdW5kTGl2ZSgpKSByZXR1cm47CgogICAgY29uc3Qgbm93U2Vjb25kcyA9IE1hdGguZmxvb3IobW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKSk7CiAgICBpZiAobm93U2Vjb25kcyAtIGxhc3RBdXRvUmVhZHlDaGVja0F0U2Vjb25kcyA8IEFVVE9fUkVBRFlfQ0hFQ0tfSU5URVJWQUxfU0VDT05EUykgcmV0dXJuOwogICAgbGFzdEF1dG9SZWFkeUNoZWNrQXRTZWNvbmRzID0gbm93U2Vjb25kczsKCiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBsZXQgYW55Q2hhbmdlZCA9IGZhbHNlOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHApOwogICAgICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCkgY29udGludWU7CiAgICAgICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLmF1dG9SZWFkeUJ5UGlkW3BpZF0pIGNvbnRpbnVlOwogICAgICAgIGlmIChhcHBseUF1dG9SZWFkeUZvclBpZChwLCBwaWQpKSBhbnlDaGFuZ2VkID0gdHJ1ZTsKICAgIH0KCiAgICBpZiAoIWFueUNoYW5nZWQpIHJldHVybjsKCiAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycygpOwogICAgdHJ5QXV0b1N0YXJ0Um91bmRJZkFsbFJlYWR5KCk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgLSBBdXRvLVJlYWR5IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgLSBBY3RpdmUgUGxheWVyIFJlc29sdXRpb24gKyBSb3N0ZXIgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIFJldHVybnMgdHJ1ZSB3aGVuIGV2ZXJ5IGFjdGl2ZSBwbGF5ZXIgb24gVGVhbSAxLzIgaXMgY3VycmVudGx5IFJFQURZLgoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gQWN0aXZlIFBsYXllciBSZXNvbHV0aW9uCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIFNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIHdobyBjb3VudHMgYXMgYW4gImFjdGl2ZSIgcGxheWVyIGFjcm9zczoKLy8gICAtIHJvc3RlciBwb3B1bGF0aW9uIChSZWFkeSBVcCBVSSkKLy8gICAtIGFsbC1yZWFkeSBjaGVja3MgLyBhdXRvLXN0YXJ0IGdhdGluZwovLyAgIC0gYW55IGZ1dHVyZSByb3VuZCBnYXRpbmcgbG9naWMKLy8KLy8gRGVmaW5pdGlvbiAobG93LXJpc2ssIGNvbnNlcnZhdGl2ZSk6Ci8vICAgLSBNdXN0IGJlIHByZXNlbnQgaW4gbW9kLkFsbFBsYXllcnMoKSAoYXZvaWRzIHN0YWxlL2Rpc2Nvbm5lY3RlZCBwaWRzKQovLyAgIC0gTXVzdCBiZSB2YWxpZCAobW9kLklzUGxheWVyVmFsaWQpCi8vICAgLSBNdXN0IGJlIGFzc2lnbmVkIHRvIFRlYW1JRC5UZWFtMSBvciBUZWFtSUQuVGVhbTIgKHNwZWN0YXRvcnMvbmV1dHJhbCBleGNsdWRlZCkKLy8KLy8gTm90ZTogV2UgaW50ZW50aW9uYWxseSBkbyBOT1QgZmlsdGVyIGJ5ICJkZXBsb3llZCIgc3RhdGUgaGVyZS4gU29tZSBBUElzIGV4cG9zZSBkZXBsb3ltZW50IHN0YXRlLAovLyBidXQgdGhpcyBjb2RlYmFzZSBkb2VzIG5vdCBjdXJyZW50bHkgaGF2ZSBhIHR5cGVkL3BvcnRhYmxlIGNoZWNrLiBUcmVhdGluZyB1bmRlcGxveWVkIHRlYW1tYXRlcyBhcwovLyBhY3RpdmUgaXMgc2FmZXIgZm9yIHJlYWRpbmVzcyBnYXRpbmcgYW5kIGF2b2lkcyBlZGdlLWNhc2UgbWlzbWF0Y2hlcyBkdXJpbmcgdGVhbSBzd2l0Y2hpbmcuCnR5cGUgQWN0aXZlUGxheWVyc190ID0gewogICAgYWxsOiBtb2QuUGxheWVyW107CiAgICB0ZWFtMTogbW9kLlBsYXllcltdOwogICAgdGVhbTI6IG1vZC5QbGF5ZXJbXTsKfTsKCnR5cGUgUm9zdGVyRGlzcGxheUVudHJ5ID0gewogICAgcGxheWVyPzogbW9kLlBsYXllcjsKICAgIG5hbWVLZXk/OiBudW1iZXI7Cn07Cgp0eXBlIFJvc3RlckRpc3BsYXlfdCA9IHsKICAgIHRlYW0xOiBSb3N0ZXJEaXNwbGF5RW50cnlbXTsKICAgIHRlYW0yOiBSb3N0ZXJEaXNwbGF5RW50cnlbXTsKICAgIG1heFJvd3M6IG51bWJlcjsKfTsKCi8qKgogKiBBY3RpdmUtcGxheWVyIGRlZmluaXRpb24gKHNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGgpLgogKiBVc2VkIGJ5OiByb3N0ZXIgcG9wdWxhdGlvbiwgYWxsLXJlYWR5IGNoZWNrcywgcm91bmQgc3RhcnQgZ2F0aW5nLCBhbmQgdGhlIEhVRCByZWFkeS1jb3VudCBsaW5lLgogKiBOb3RlczogZXhjbHVkZXMgdW5kZXBsb3llZC9uZXV0cmFsL3N0YWxlIHBsYXllcnMgYnkgcmVhZGluZyBjdXJyZW50IGVuZ2luZSB0ZWFtIHN0YXRlIGVhY2ggY2FsbDsgZG8gbm90IGNhY2hlIGxvbmctdGVybS4KICovCmZ1bmN0aW9uIGdldEFjdGl2ZVBsYXllcnMoKTogQWN0aXZlUGxheWVyc190IHsKICAgIGNvbnN0IGFsbDogbW9kLlBsYXllcltdID0gW107CiAgICBjb25zdCB0ZWFtMTogbW9kLlBsYXllcltdID0gW107CiAgICBjb25zdCB0ZWFtMjogbW9kLlBsYXllcltdID0gW107CiAgICBjb25zdCBwaWRCeVBsYXllciA9IG5ldyBNYXA8bW9kLlBsYXllciwgbnVtYmVyPigpOwoKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgbGV0IHBpZDogbnVtYmVyOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHBpZCA9IG1vZC5HZXRPYmpJZChwKTsKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGNvbnN0IHRlYW1OdW0gPSBnZXRUZWFtTnVtYmVyKG1vZC5HZXRUZWFtKHApKTsKICAgICAgICAvLyBPbmx5IFRlYW0gMS8yIGFyZSBjb25zaWRlcmVkIGFjdGl2ZSBmb3Igcm9zdGVycy9yZWFkeSBnYXRpbmcuCiAgICAgICAgaWYgKHRlYW1OdW0gIT09IFRlYW1JRC5UZWFtMSAmJiB0ZWFtTnVtICE9PSBUZWFtSUQuVGVhbTIpIGNvbnRpbnVlOwoKICAgICAgICBwaWRCeVBsYXllci5zZXQocCwgcGlkKTsKICAgICAgICBhbGwucHVzaChwKTsKICAgICAgICBpZiAodGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSB0ZWFtMS5wdXNoKHApOwogICAgICAgIGVsc2UgdGVhbTIucHVzaChwKTsKICAgIH0KCiAgICAvLyBTdGFibGUgVUkgb3JkZXJpbmc6IHNvcnQgYnkgcGlkIChvYmplY3QgaWQpLgogICAgLy8gVGhpcyBwcmV2ZW50cyByb3dzIGZyb20gc2h1ZmZsaW5nIGFjcm9zcyByZWZyZXNoZXMuCiAgICBjb25zdCBieVBpZENhY2hlZCA9IChhOiBtb2QuUGxheWVyLCBiOiBtb2QuUGxheWVyKSA9PiAocGlkQnlQbGF5ZXIuZ2V0KGEpID8/IDApIC0gKHBpZEJ5UGxheWVyLmdldChiKSA/PyAwKTsKICAgIGFsbC5zb3J0KGJ5UGlkQ2FjaGVkKTsKICAgIHRlYW0xLnNvcnQoYnlQaWRDYWNoZWQpOwogICAgdGVhbTIuc29ydChieVBpZENhY2hlZCk7CgogICAgcmV0dXJuIHsgYWxsLCB0ZWFtMSwgdGVhbTIgfTsKfQoKZnVuY3Rpb24gYnVpbGRSb3N0ZXJEaXNwbGF5RW50cmllcyhwbGF5ZXJzOiBtb2QuUGxheWVyW10sIGRlYnVnQ291bnQ6IG51bWJlcik6IFJvc3RlckRpc3BsYXlFbnRyeVtdIHsKICAgIGNvbnN0IGVudHJpZXM6IFJvc3RlckRpc3BsYXlFbnRyeVtdID0gW107CiAgICBmb3IgKGNvbnN0IHAgb2YgcGxheWVycykgZW50cmllcy5wdXNoKHsgcGxheWVyOiBwIH0pOwoKICAgIGNvbnN0IGV4dHJhQ291bnQgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKGRlYnVnQ291bnQpKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXh0cmFDb3VudDsgaSsrKSB7CiAgICAgICAgZW50cmllcy5wdXNoKHsgbmFtZUtleTogREVCVUdfVEVTVF9QTEFDRUhPTERFUl9OQU1FX0tFWSB9KTsKICAgIH0KICAgIHJldHVybiBlbnRyaWVzOwp9CgpmdW5jdGlvbiBnZXRSb3N0ZXJEaXNwbGF5RW50cmllcygpOiBSb3N0ZXJEaXNwbGF5X3QgewogICAgY29uc3QgYWN0aXZlID0gZ2V0QWN0aXZlUGxheWVycygpOwogICAgY29uc3QgdGVhbTEgPSBidWlsZFJvc3RlckRpc3BsYXlFbnRyaWVzKGFjdGl2ZS50ZWFtMSwgREVCVUdfVEVTVF9OQU1FU19URUFNXzEpOwogICAgY29uc3QgdGVhbTIgPSBidWlsZFJvc3RlckRpc3BsYXlFbnRyaWVzKGFjdGl2ZS50ZWFtMiwgREVCVUdfVEVTVF9OQU1FU19URUFNXzIpOwogICAgcmV0dXJuIHsgdGVhbTEsIHRlYW0yLCBtYXhSb3dzOiBNYXRoLm1heCh0ZWFtMS5sZW5ndGgsIHRlYW0yLmxlbmd0aCkgfTsKfQoKZnVuY3Rpb24gZ2V0Um9zdGVyRW50cnlOYW1lTWVzc2FnZShlbnRyeTogUm9zdGVyRGlzcGxheUVudHJ5IHwgdW5kZWZpbmVkKTogbW9kLk1lc3NhZ2UgewogICAgaWYgKCFlbnRyeSkgcmV0dXJuIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsICIiKTsKICAgIGlmIChlbnRyeS5wbGF5ZXIpIHJldHVybiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cucGxheWVyTmFtZUZvcm1hdCwgZW50cnkucGxheWVyKTsKICAgIGlmIChlbnRyeS5uYW1lS2V5KSByZXR1cm4gbW9kLk1lc3NhZ2UoZW50cnkubmFtZUtleSk7CiAgICByZXR1cm4gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgIiIpOwp9CgpmdW5jdGlvbiBhcmVBbGxBY3RpdmVQbGF5ZXJzUmVhZHkoKTogYm9vbGVhbiB7CiAgICBjb25zdCBhY3RpdmUgPSBnZXRBY3RpdmVQbGF5ZXJzKCk7CiAgICBjb25zdCBhY3RpdmVDb3VudCA9IGFjdGl2ZS5hbGwubGVuZ3RoOwogICAgY29uc3QgcmVxdWlyZWRUb3RhbFBsYXllcnMgPSBnZXRBdXRvU3RhcnRNaW5QbGF5ZXJDb3VudHMoKS50b3RhbDsKICAgIGlmIChhY3RpdmVDb3VudCA8IHJlcXVpcmVkVG90YWxQbGF5ZXJzKSB7CiAgICAgICAgaWYgKGFjdGl2ZUNvdW50ICE9PSAwKSByZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIEZhbGxiYWNrOiBpZiBubyBUZWFtIDEvMiBwbGF5ZXJzIGFyZSBhc3NpZ25lZCB5ZXQgKHRlYW0gMCBwcmUtZGVwbG95KSwKICAgICAgICAvLyBhbGxvdyB0aGUgcmVhZHkgY2hlY2sgdG8gdXNlIGFsbCB2YWxpZCBwbGF5ZXJzLgogICAgICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICAgICAgbGV0IHZhbGlkQ291bnQgPSAwOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICAgICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKHApOwogICAgICAgICAgICBpZiAocGlkID09PSB1bmRlZmluZWQpIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAoIVN0YXRlLnBsYXllcnMucmVhZHlCeVBpZFtwaWRdKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIHZhbGlkQ291bnQrKzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHZhbGlkQ291bnQgPj0gcmVxdWlyZWRUb3RhbFBsYXllcnM7CiAgICB9CgogICAgZm9yIChjb25zdCBwIG9mIGFjdGl2ZS5hbGwpIHsKICAgICAgICBjb25zdCBwaWQgPSBzYWZlR2V0UGxheWVySWQocCk7CiAgICAgICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkKSBjb250aW51ZTsKICAgICAgICBpZiAoIVN0YXRlLnBsYXllcnMucmVhZHlCeVBpZFtwaWRdKSByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIEFjdGl2ZSBQbGF5ZXIgUmVzb2x1dGlvbiArIFJvc3RlciAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIC0gUHJlZ2FtZSBDb3VudGRvd24gVUkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIEltcGxlbWVudHMgYSBzeW5jaHJvbml6ZWQgcHJlLXJvdW5kIDEwLTEtR08hIGNvdW50ZG93biB0aGF0IHN0YXJ0cyB0aGUgcm91bmQgb24gR08uCmludGVyZmFjZSBDb3VudGRvd25XaWRnZXRDYWNoZUVudHJ5IHsKICAgIHJvb3ROYW1lOiBzdHJpbmc7CiAgICB3aWRnZXQ/OiBtb2QuVUlXaWRnZXQ7Cn0KCmZ1bmN0aW9uIGVuc3VyZUNvdW50ZG93blVJQW5kR2V0V2lkZ2V0KHBsYXllcjogbW9kLlBsYXllcik6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCB7CiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChwbGF5ZXIpOwogICAgY29uc3Qgcm9vdE5hbWUgPSAiUHJlZ2FtZUNvdW50ZG93blRleHRfIiArIHBpZDsKCiAgICBjb25zdCBjYWNoZWQgPSBTdGF0ZS5odWRDYWNoZS5jb3VudGRvd25XaWRnZXRDYWNoZVtwaWRdOwogICAgaWYgKGNhY2hlZCkgewogICAgICAgIGlmIChjYWNoZWQud2lkZ2V0KSByZXR1cm4gY2FjaGVkLndpZGdldDsKCiAgICAgICAgY29uc3QgZm91bmQgPSBzYWZlRmluZChjYWNoZWQucm9vdE5hbWUpOwogICAgICAgIGlmIChmb3VuZCkgewogICAgICAgICAgICBjYWNoZWQud2lkZ2V0ID0gZm91bmQ7CiAgICAgICAgICAgIHJldHVybiBmb3VuZDsKICAgICAgICB9CiAgICB9CgogICAgbW9kbGliLlBhcnNlVUkoewogICAgICAgIG5hbWU6IHJvb3ROYW1lLAogICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgIHBvc2l0aW9uOiBbMCwgMF0sCiAgICAgICAgc2l6ZTogWzMyMCwgMTQwXSwKICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgcGFkZGluZzogMCwKICAgICAgICBiZ0NvbG9yOiBbMCwgMCwgMF0sCiAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5jb3VudGRvd24uZm9ybWF0LCBQUkVHQU1FX0NPVU5URE9XTl9TVEFSVF9OVU1CRVIpLAogICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgIHRleHRBbHBoYTogUFJFR0FNRV9BTEVSVF9URVhUX0FMUEhBLAogICAgICAgIHRleHRTaXplOiBQUkVHQU1FX0NPVU5URE9XTl9TSVpFX0RJR0lUX1NUQVJULAogICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICB9KTsKCiAgICBjb25zdCB3aWRnZXQgPSBzYWZlRmluZChyb290TmFtZSk7CiAgICBTdGF0ZS5odWRDYWNoZS5jb3VudGRvd25XaWRnZXRDYWNoZVtwaWRdID0geyByb290TmFtZSwgd2lkZ2V0IH07CiAgICByZXR1cm4gd2lkZ2V0Owp9CgpmdW5jdGlvbiBzZXRQcmVnYW1lQ291bnRkb3duVmlzdWFsRm9yQWxsUGxheWVycygKICAgIGxhYmVsS2V5OiBudW1iZXIsCiAgICBsYWJlbFZhbHVlOiBudW1iZXIgfCB1bmRlZmluZWQsCiAgICBjb2xvcjogbW9kLlZlY3RvciwKICAgIHNpemU6IG51bWJlciwKICAgIHZpc2libGU6IGJvb2xlYW4KKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHcgPSBlbnN1cmVDb3VudGRvd25VSUFuZEdldFdpZGdldChwKTsKICAgICAgICBpZiAoIXcpIGNvbnRpbnVlOwoKICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHcsIHZpc2libGUpOwogICAgICAgIGlmICh2aXNpYmxlKSB7CiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSAobGFiZWxWYWx1ZSAhPT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgICAgPyBtb2QuTWVzc2FnZShsYWJlbEtleSwgbGFiZWxWYWx1ZSkKICAgICAgICAgICAgICAgIDogbW9kLk1lc3NhZ2UobGFiZWxLZXkpOwogICAgICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwodywgbWVzc2FnZSk7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRDb2xvcih3LCBjb2xvcik7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRTaXplKHcsIHNpemUpOwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gc2V0UHJlZ2FtZUNvdW50ZG93blNpemVGb3JBbGxQbGF5ZXJzKHNpemU6IG51bWJlcik6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCB3ID0gZW5zdXJlQ291bnRkb3duVUlBbmRHZXRXaWRnZXQocCk7CiAgICAgICAgaWYgKCF3KSBjb250aW51ZTsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZSh3LCBzaXplKTsKICAgIH0KfQoKZnVuY3Rpb24gaGlkZVByZWdhbWVDb3VudGRvd25Gb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCB3ID0gZW5zdXJlQ291bnRkb3duVUlBbmRHZXRXaWRnZXQocCk7CiAgICAgICAgaWYgKCF3KSBjb250aW51ZTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHcsIGZhbHNlKTsKICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIFByZWdhbWUgQ291bnRkb3duIFVJIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgLSBPdmVyTGluZSBVSSBXaWRnZXRzICsgQmlnIE1lc3NhZ2VzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBlbnN1cmVPdmVyTGluZVRpdGxlU2hhZG93VUlBbmRHZXRXaWRnZXQocGxheWVyOiBtb2QuUGxheWVyKTogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkIHsKICAgIGlmICghcGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXIpKSByZXR1cm4gdW5kZWZpbmVkOwogICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHBsYXllcik7CiAgICBjb25zdCByb290TmFtZSA9IEJJR19USVRMRV9TSEFET1dfV0lER0VUX0lEICsgcGlkOwoKICAgIGNvbnN0IGNhY2hlZCA9IFN0YXRlLmh1ZENhY2hlLm92ZXJMaW5lVGl0bGVTaGFkb3dXaWRnZXRDYWNoZVtwaWRdOwogICAgaWYgKGNhY2hlZCkgewogICAgICAgIGlmIChjYWNoZWQud2lkZ2V0KSByZXR1cm4gY2FjaGVkLndpZGdldDsKCiAgICAgICAgY29uc3QgZm91bmQgPSBzYWZlRmluZChjYWNoZWQucm9vdE5hbWUpOwogICAgICAgIGlmIChmb3VuZCkgewogICAgICAgICAgICBjYWNoZWQud2lkZ2V0ID0gZm91bmQ7CiAgICAgICAgICAgIHJldHVybiBmb3VuZDsKICAgICAgICB9CiAgICB9CgogICAgbW9kbGliLlBhcnNlVUkoewogICAgICAgIG5hbWU6IHJvb3ROYW1lLAogICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgIHBvc2l0aW9uOiBbSFVEX1RFWFRfU0hBRE9XX09GRlNFVF9YLCBCSUdfVElUTEVfT0ZGU0VUX1kgKyBIVURfVEVYVF9TSEFET1dfT0ZGU0VUX1ldLAogICAgICAgIHNpemU6IFtCSUdfVElUTEVfQkdfV0lEVEgsIEJJR19USVRMRV9CR19IRUlHSFRdLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5vdmVyTGluZS50aXRsZSwgcGxheWVyKSwKICAgICAgICB0ZXh0Q29sb3I6IFswLCAwLCAwXSwKICAgICAgICB0ZXh0QWxwaGE6IFBSRUdBTUVfQUxFUlRfVEVYVF9BTFBIQSwKICAgICAgICB0ZXh0U2l6ZTogQklHX1RJVExFX1NJWkUsCiAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgIH0pOwoKICAgIGNvbnN0IHdpZGdldCA9IHNhZmVGaW5kKHJvb3ROYW1lKTsKICAgIFN0YXRlLmh1ZENhY2hlLm92ZXJMaW5lVGl0bGVTaGFkb3dXaWRnZXRDYWNoZVtwaWRdID0geyByb290TmFtZSwgd2lkZ2V0IH07CiAgICByZXR1cm4gd2lkZ2V0Owp9CgpmdW5jdGlvbiBlbnN1cmVPdmVyTGluZVN1YnRpdGxlU2hhZG93VUlBbmRHZXRXaWRnZXQocGxheWVyOiBtb2QuUGxheWVyKTogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkIHsKICAgIGlmICghcGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXIpKSByZXR1cm4gdW5kZWZpbmVkOwogICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHBsYXllcik7CiAgICBjb25zdCByb290TmFtZSA9IEJJR19TVUJUSVRMRV9TSEFET1dfV0lER0VUX0lEICsgcGlkOwoKICAgIGNvbnN0IGNhY2hlZCA9IFN0YXRlLmh1ZENhY2hlLm92ZXJMaW5lU3VidGl0bGVTaGFkb3dXaWRnZXRDYWNoZVtwaWRdOwogICAgaWYgKGNhY2hlZCkgewogICAgICAgIGlmIChjYWNoZWQud2lkZ2V0KSByZXR1cm4gY2FjaGVkLndpZGdldDsKCiAgICAgICAgY29uc3QgZm91bmQgPSBzYWZlRmluZChjYWNoZWQucm9vdE5hbWUpOwogICAgICAgIGlmIChmb3VuZCkgewogICAgICAgICAgICBjYWNoZWQud2lkZ2V0ID0gZm91bmQ7CiAgICAgICAgICAgIHJldHVybiBmb3VuZDsKICAgICAgICB9CiAgICB9CgogICAgbW9kbGliLlBhcnNlVUkoewogICAgICAgIG5hbWU6IHJvb3ROYW1lLAogICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgIHBvc2l0aW9uOiBbSFVEX1RFWFRfU0hBRE9XX09GRlNFVF9YLCBCSUdfU1VCVElUTEVfT0ZGU0VUX1kgKyBIVURfVEVYVF9TSEFET1dfT0ZGU0VUX1ldLAogICAgICAgIHNpemU6IFtCSUdfU1VCVElUTEVfQkdfV0lEVEgsIEJJR19TVUJUSVRMRV9CR19IRUlHSFRdLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5vdmVyTGluZS5zdWJ0aXRsZSwgcGxheWVyKSwKICAgICAgICB0ZXh0Q29sb3I6IFswLCAwLCAwXSwKICAgICAgICB0ZXh0QWxwaGE6IFBSRUdBTUVfQUxFUlRfVEVYVF9BTFBIQSwKICAgICAgICB0ZXh0U2l6ZTogQklHX1NVQlRJVExFX1NJWkUsCiAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgIH0pOwoKICAgIGNvbnN0IHdpZGdldCA9IHNhZmVGaW5kKHJvb3ROYW1lKTsKICAgIFN0YXRlLmh1ZENhY2hlLm92ZXJMaW5lU3VidGl0bGVTaGFkb3dXaWRnZXRDYWNoZVtwaWRdID0geyByb290TmFtZSwgd2lkZ2V0IH07CiAgICByZXR1cm4gd2lkZ2V0Owp9CgpmdW5jdGlvbiBlbnN1cmVPdmVyTGluZVRpdGxlVUlBbmRHZXRXaWRnZXQocGxheWVyOiBtb2QuUGxheWVyKTogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkIHsKICAgIGlmICghcGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwbGF5ZXIpKSByZXR1cm4gdW5kZWZpbmVkOwogICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHBsYXllcik7CiAgICBjb25zdCByb290TmFtZSA9IEJJR19USVRMRV9XSURHRVRfSUQgKyBwaWQ7CgogICAgY29uc3QgY2FjaGVkID0gU3RhdGUuaHVkQ2FjaGUub3ZlckxpbmVUaXRsZVdpZGdldENhY2hlW3BpZF07CiAgICBpZiAoY2FjaGVkKSB7CiAgICAgICAgaWYgKGNhY2hlZC53aWRnZXQpIHJldHVybiBjYWNoZWQud2lkZ2V0OwoKICAgICAgICBjb25zdCBmb3VuZCA9IHNhZmVGaW5kKGNhY2hlZC5yb290TmFtZSk7CiAgICAgICAgaWYgKGZvdW5kKSB7CiAgICAgICAgICAgIGNhY2hlZC53aWRnZXQgPSBmb3VuZDsKICAgICAgICAgICAgcmV0dXJuIGZvdW5kOwogICAgICAgIH0KICAgIH0KCiAgICBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgbmFtZTogcm9vdE5hbWUsCiAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgIHBsYXllcklkOiBwbGF5ZXIsCiAgICAgICAgcG9zaXRpb246IFswLCBCSUdfVElUTEVfT0ZGU0VUX1ldLAogICAgICAgIHNpemU6IFtCSUdfVElUTEVfQkdfV0lEVEgsIEJJR19USVRMRV9CR19IRUlHSFRdLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgIGJnQ29sb3I6IENPTE9SX0dSQVlfREFSSywKICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLkJsdXIsCiAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wub3ZlckxpbmUudGl0bGUsIHBsYXllciksCiAgICAgICAgdGV4dENvbG9yOiBbMSwgMCwgMF0sCiAgICAgICAgdGV4dEFscGhhOiBQUkVHQU1FX0FMRVJUX1RFWFRfQUxQSEEsCiAgICAgICAgdGV4dFNpemU6IEJJR19USVRMRV9TSVpFLAogICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICB9KTsKCiAgICBjb25zdCB3aWRnZXQgPSBzYWZlRmluZChyb290TmFtZSk7CiAgICBTdGF0ZS5odWRDYWNoZS5vdmVyTGluZVRpdGxlV2lkZ2V0Q2FjaGVbcGlkXSA9IHsgcm9vdE5hbWUsIHdpZGdldCB9OwogICAgcmV0dXJuIHdpZGdldDsKfQoKZnVuY3Rpb24gZW5zdXJlT3ZlckxpbmVTdWJ0aXRsZVVJQW5kR2V0V2lkZ2V0KHBsYXllcjogbW9kLlBsYXllcik6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCB7CiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChwbGF5ZXIpOwogICAgY29uc3Qgcm9vdE5hbWUgPSBCSUdfU1VCVElUTEVfV0lER0VUX0lEICsgcGlkOwoKICAgIGNvbnN0IGNhY2hlZCA9IFN0YXRlLmh1ZENhY2hlLm92ZXJMaW5lU3VidGl0bGVXaWRnZXRDYWNoZVtwaWRdOwogICAgaWYgKGNhY2hlZCkgewogICAgICAgIGlmIChjYWNoZWQud2lkZ2V0KSByZXR1cm4gY2FjaGVkLndpZGdldDsKCiAgICAgICAgY29uc3QgZm91bmQgPSBzYWZlRmluZChjYWNoZWQucm9vdE5hbWUpOwogICAgICAgIGlmIChmb3VuZCkgewogICAgICAgICAgICBjYWNoZWQud2lkZ2V0ID0gZm91bmQ7CiAgICAgICAgICAgIHJldHVybiBmb3VuZDsKICAgICAgICB9CiAgICB9CgogICAgbW9kbGliLlBhcnNlVUkoewogICAgICAgIG5hbWU6IHJvb3ROYW1lLAogICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgIHBvc2l0aW9uOiBbMCwgQklHX1NVQlRJVExFX09GRlNFVF9ZXSwKICAgICAgICBzaXplOiBbQklHX1NVQlRJVExFX0JHX1dJRFRILCBCSUdfU1VCVElUTEVfQkdfSEVJR0hUXSwKICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgcGFkZGluZzogMCwKICAgICAgICBiZ0NvbG9yOiBDT0xPUl9HUkFZX0RBUkssCiAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5CbHVyLAogICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm92ZXJMaW5lLnN1YnRpdGxlLCBwbGF5ZXIpLAogICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDBdLAogICAgICAgIHRleHRBbHBoYTogUFJFR0FNRV9BTEVSVF9URVhUX0FMUEhBLAogICAgICAgIHRleHRTaXplOiBCSUdfU1VCVElUTEVfU0laRSwKICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgfSk7CgogICAgY29uc3Qgd2lkZ2V0ID0gc2FmZUZpbmQocm9vdE5hbWUpOwogICAgU3RhdGUuaHVkQ2FjaGUub3ZlckxpbmVTdWJ0aXRsZVdpZGdldENhY2hlW3BpZF0gPSB7IHJvb3ROYW1lLCB3aWRnZXQgfTsKICAgIHJldHVybiB3aWRnZXQ7Cn0KCmZ1bmN0aW9uIGNhbmNlbFByZWdhbWVDb3VudGRvd24oKTogdm9pZCB7CiAgICBpZiAoIVN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc0FjdGl2ZSkgcmV0dXJuOwogICAgU3RhdGUucm91bmQuY291bnRkb3duLnRva2VuKys7CiAgICBTdGF0ZS5yb3VuZC5jb3VudGRvd24uaXNBY3RpdmUgPSBmYWxzZTsKICAgIGhpZGVQcmVnYW1lQ291bnRkb3duRm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiBoaWRlQmlnVGl0bGVTdWJ0aXRsZU1lc3NhZ2VGb3JQbGF5ZXIocGlkOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IHRpdGxlU2hhZG93ID0gc2FmZUZpbmQoQklHX1RJVExFX1NIQURPV19XSURHRVRfSUQgKyBwaWQpOwogICAgaWYgKHRpdGxlU2hhZG93KSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHRpdGxlU2hhZG93LCBmYWxzZSk7CgogICAgY29uc3QgdGl0bGUgPSBzYWZlRmluZChCSUdfVElUTEVfV0lER0VUX0lEICsgcGlkKTsKICAgIGlmICh0aXRsZSkgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh0aXRsZSwgZmFsc2UpOwoKICAgIGNvbnN0IHN1YnRpdGxlU2hhZG93ID0gc2FmZUZpbmQoQklHX1NVQlRJVExFX1NIQURPV19XSURHRVRfSUQgKyBwaWQpOwogICAgaWYgKHN1YnRpdGxlU2hhZG93KSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHN1YnRpdGxlU2hhZG93LCBmYWxzZSk7CgogICAgY29uc3Qgc3VidGl0bGUgPSBzYWZlRmluZChCSUdfU1VCVElUTEVfV0lER0VUX0lEICsgcGlkKTsKICAgIGlmIChzdWJ0aXRsZSkgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShzdWJ0aXRsZSwgZmFsc2UpOwp9Cgphc3luYyBmdW5jdGlvbiBzaG93T3ZlckxpbmVNZXNzYWdlRm9yQWxsUGxheWVycyhvZmZlbmRlcjogbW9kLlBsYXllcik6IFByb21pc2U8dm9pZD4gewogICAgY29uc3Qgb2ZmZW5kZXJUb2tlbiA9IChvZmZlbmRlciAmJiBtb2QuSXNQbGF5ZXJWYWxpZChvZmZlbmRlcikpCiAgICAgICAgPyBvZmZlbmRlcgogICAgICAgIDogbW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS51bmtub3duUGxheWVyOwogICAgYXdhaXQgc2hvd0dsb2JhbFRpdGxlU3VidGl0bGVNZXNzYWdlRm9yQWxsUGxheWVycygKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wub3ZlckxpbmUudGl0bGUsIG9mZmVuZGVyVG9rZW4pLAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5vdmVyTGluZS5zdWJ0aXRsZSwgb2ZmZW5kZXJUb2tlbiksCiAgICAgICAgQ09MT1JfTk9UX1JFQURZX1JFRCwKICAgICAgICBDT0xPUl9XQVJOSU5HX1lFTExPVwogICAgKTsKfQoKdHlwZSBCaWdNZXNzYWdlQnVpbGRlciA9IChyZW1haW5pbmdTZWNvbmRzOiBudW1iZXIpID0+IG1vZC5NZXNzYWdlIHwgdW5kZWZpbmVkOwp0eXBlIEJpZ01lc3NhZ2VQbGF5ZXJGaWx0ZXIgPSAocGxheWVyOiBtb2QuUGxheWVyKSA9PiBib29sZWFuOwoKZnVuY3Rpb24gcmVuZGVyQmlnVGl0bGVTdWJ0aXRsZU1lc3NhZ2VGb3JBbGxQbGF5ZXJzKAogICAgdGl0bGU6IG1vZC5NZXNzYWdlIHwgdW5kZWZpbmVkLAogICAgc3VidGl0bGU6IG1vZC5NZXNzYWdlIHwgdW5kZWZpbmVkLAogICAgdGl0bGVDb2xvcjogbW9kLlZlY3RvciwKICAgIHN1YnRpdGxlQ29sb3I6IG1vZC5WZWN0b3IsCiAgICBsYXlvdXQ6IEdsb2JhbE1lc3NhZ2VMYXlvdXQsCiAgICBwbGF5ZXJGaWx0ZXI/OiBCaWdNZXNzYWdlUGxheWVyRmlsdGVyCik6IHZvaWQgewogICAgY29uc3QgdGl0bGVCZ0FscGhhID0gbGF5b3V0LnVzZUJhY2tncm91bmQgPyBCSUdfTUVTU0FHRV9CR19BTFBIQSA6IDA7CiAgICBjb25zdCBzdWJ0aXRsZUJnQWxwaGEgPSAobGF5b3V0LnN1YnRpdGxlVXNlQmFja2dyb3VuZCA/PyBsYXlvdXQudXNlQmFja2dyb3VuZCkgPyBCSUdfTUVTU0FHRV9CR19BTFBIQSA6IDA7CiAgICBjb25zdCB0aXRsZUJnSGVpZ2h0ID0gbGF5b3V0LnRpdGxlQmdIZWlnaHQgPz8gQklHX1RJVExFX0JHX0hFSUdIVDsKICAgIGNvbnN0IHRpdGxlT2Zmc2V0WSA9IGxheW91dC50aXRsZU9mZnNldFkgKyAoQklHX1RJVExFX0JHX0hFSUdIVCAtIHRpdGxlQmdIZWlnaHQpIC8gMjsKCiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGlmIChwbGF5ZXJGaWx0ZXIgJiYgIXBsYXllckZpbHRlcihwKSkgewogICAgICAgICAgICBoaWRlQmlnVGl0bGVTdWJ0aXRsZU1lc3NhZ2VGb3JQbGF5ZXIoZ2V0T2JqSWQocCkpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHRpdGxlU2hhZG93V2lkZ2V0ID0gZW5zdXJlT3ZlckxpbmVUaXRsZVNoYWRvd1VJQW5kR2V0V2lkZ2V0KHApOwogICAgICAgIGlmICh0aXRsZVNoYWRvd1dpZGdldCkgewogICAgICAgICAgICBpZiAodGl0bGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHRpdGxlU2hhZG93V2lkZ2V0LCB0aXRsZSk7CiAgICAgICAgICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3IodGl0bGVTaGFkb3dXaWRnZXQsIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCkpOwogICAgICAgICAgICAgICAgbW9kLlNldFVJVGV4dFNpemUodGl0bGVTaGFkb3dXaWRnZXQsIGxheW91dC50aXRsZVNpemUpOwogICAgICAgICAgICAgICAgbW9kLlNldFVJV2lkZ2V0U2l6ZSh0aXRsZVNoYWRvd1dpZGdldCwgbW9kLkNyZWF0ZVZlY3RvcihCSUdfVElUTEVfQkdfV0lEVEgsIHRpdGxlQmdIZWlnaHQsIDApKTsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFBvc2l0aW9uKAogICAgICAgICAgICAgICAgICAgIHRpdGxlU2hhZG93V2lkZ2V0LAogICAgICAgICAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoSFVEX1RFWFRfU0hBRE9XX09GRlNFVF9YLCB0aXRsZU9mZnNldFkgKyBIVURfVEVYVF9TSEFET1dfT0ZGU0VUX1ksIDApCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh0aXRsZVNoYWRvd1dpZGdldCwgdHJ1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHRpdGxlU2hhZG93V2lkZ2V0LCBmYWxzZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnN0IHRpdGxlV2lkZ2V0ID0gZW5zdXJlT3ZlckxpbmVUaXRsZVVJQW5kR2V0V2lkZ2V0KHApOwogICAgICAgIGlmICh0aXRsZVdpZGdldCkgewogICAgICAgICAgICBpZiAodGl0bGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHRpdGxlV2lkZ2V0LCB0aXRsZSk7CiAgICAgICAgICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3IodGl0bGVXaWRnZXQsIHRpdGxlQ29sb3IpOwogICAgICAgICAgICAgICAgbW9kLlNldFVJVGV4dFNpemUodGl0bGVXaWRnZXQsIGxheW91dC50aXRsZVNpemUpOwogICAgICAgICAgICAgICAgbW9kLlNldFVJV2lkZ2V0U2l6ZSh0aXRsZVdpZGdldCwgbW9kLkNyZWF0ZVZlY3RvcihCSUdfVElUTEVfQkdfV0lEVEgsIHRpdGxlQmdIZWlnaHQsIDApKTsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFBvc2l0aW9uKHRpdGxlV2lkZ2V0LCBtb2QuQ3JlYXRlVmVjdG9yKDAsIHRpdGxlT2Zmc2V0WSwgMCkpOwogICAgICAgICAgICAgICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYSh0aXRsZVdpZGdldCwgdGl0bGVCZ0FscGhhKTsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFZpc2libGUodGl0bGVXaWRnZXQsIHRydWUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh0aXRsZVdpZGdldCwgZmFsc2UpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzdWJ0aXRsZVNoYWRvd1dpZGdldCA9IGVuc3VyZU92ZXJMaW5lU3VidGl0bGVTaGFkb3dVSUFuZEdldFdpZGdldChwKTsKICAgICAgICBpZiAoc3VidGl0bGVTaGFkb3dXaWRnZXQpIHsKICAgICAgICAgICAgaWYgKHN1YnRpdGxlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbChzdWJ0aXRsZVNoYWRvd1dpZGdldCwgc3VidGl0bGUpOwogICAgICAgICAgICAgICAgbW9kLlNldFVJVGV4dENvbG9yKHN1YnRpdGxlU2hhZG93V2lkZ2V0LCBtb2QuQ3JlYXRlVmVjdG9yKDAsIDAsIDApKTsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVRleHRTaXplKHN1YnRpdGxlU2hhZG93V2lkZ2V0LCBsYXlvdXQuc3VidGl0bGVTaXplKTsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFBvc2l0aW9uKAogICAgICAgICAgICAgICAgICAgIHN1YnRpdGxlU2hhZG93V2lkZ2V0LAogICAgICAgICAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoSFVEX1RFWFRfU0hBRE9XX09GRlNFVF9YLCBsYXlvdXQuc3VidGl0bGVPZmZzZXRZICsgSFVEX1RFWFRfU0hBRE9XX09GRlNFVF9ZLCAwKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFZpc2libGUoc3VidGl0bGVTaGFkb3dXaWRnZXQsIHRydWUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShzdWJ0aXRsZVNoYWRvd1dpZGdldCwgZmFsc2UpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzdWJ0aXRsZVdpZGdldCA9IGVuc3VyZU92ZXJMaW5lU3VidGl0bGVVSUFuZEdldFdpZGdldChwKTsKICAgICAgICBpZiAoc3VidGl0bGVXaWRnZXQpIHsKICAgICAgICAgICAgaWYgKHN1YnRpdGxlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbChzdWJ0aXRsZVdpZGdldCwgc3VidGl0bGUpOwogICAgICAgICAgICAgICAgbW9kLlNldFVJVGV4dENvbG9yKHN1YnRpdGxlV2lkZ2V0LCBzdWJ0aXRsZUNvbG9yKTsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVRleHRTaXplKHN1YnRpdGxlV2lkZ2V0LCBsYXlvdXQuc3VidGl0bGVTaXplKTsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFBvc2l0aW9uKHN1YnRpdGxlV2lkZ2V0LCBtb2QuQ3JlYXRlVmVjdG9yKDAsIGxheW91dC5zdWJ0aXRsZU9mZnNldFksIDApKTsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoc3VidGl0bGVXaWRnZXQsIHN1YnRpdGxlQmdBbHBoYSk7CiAgICAgICAgICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHN1YnRpdGxlV2lkZ2V0LCB0cnVlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFZpc2libGUoc3VidGl0bGVXaWRnZXQsIGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gaGlkZUJpZ1RpdGxlU3VidGl0bGVNZXNzYWdlRm9yQWxsUGxheWVycygpOiB2b2lkIHsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgaGlkZUJpZ1RpdGxlU3VidGl0bGVNZXNzYWdlRm9yUGxheWVyKG1vZC5HZXRPYmpJZChwKSk7CiAgICB9Cn0KCmFzeW5jIGZ1bmN0aW9uIHNob3dHbG9iYWxUaXRsZVN1YnRpdGxlTWVzc2FnZUZvckFsbFBsYXllcnMoCiAgICB0aXRsZTogbW9kLk1lc3NhZ2UgfCB1bmRlZmluZWQsCiAgICBzdWJ0aXRsZTogbW9kLk1lc3NhZ2UgfCB1bmRlZmluZWQsCiAgICB0aXRsZUNvbG9yOiBtb2QuVmVjdG9yLAogICAgc3VidGl0bGVDb2xvcjogbW9kLlZlY3RvciwKICAgIGR1cmF0aW9uU2Vjb25kczogbnVtYmVyID0gQklHX01FU1NBR0VfRFVSQVRJT05fU0VDT05EUywKICAgIGxheW91dDogR2xvYmFsTWVzc2FnZUxheW91dCA9IEJJR19NRVNTQUdFX0xBWU9VVCwKICAgIHBsYXllckZpbHRlcj86IEJpZ01lc3NhZ2VQbGF5ZXJGaWx0ZXIKKTogUHJvbWlzZTx2b2lkPiB7CiAgICBTdGF0ZS5yb3VuZC5jb3VudGRvd24ub3ZlckxpbmVNZXNzYWdlVG9rZW4gPSAoU3RhdGUucm91bmQuY291bnRkb3duLm92ZXJMaW5lTWVzc2FnZVRva2VuICsgMSkgJSAxMDAwMDAwMDAwOwogICAgY29uc3QgZXhwZWN0ZWRUb2tlbiA9IFN0YXRlLnJvdW5kLmNvdW50ZG93bi5vdmVyTGluZU1lc3NhZ2VUb2tlbjsKCiAgICByZW5kZXJCaWdUaXRsZVN1YnRpdGxlTWVzc2FnZUZvckFsbFBsYXllcnModGl0bGUsIHN1YnRpdGxlLCB0aXRsZUNvbG9yLCBzdWJ0aXRsZUNvbG9yLCBsYXlvdXQsIHBsYXllckZpbHRlcik7CgogICAgYXdhaXQgbW9kLldhaXQoZHVyYXRpb25TZWNvbmRzKTsKICAgIGlmIChleHBlY3RlZFRva2VuICE9PSBTdGF0ZS5yb3VuZC5jb3VudGRvd24ub3ZlckxpbmVNZXNzYWdlVG9rZW4pIHJldHVybjsKICAgIGhpZGVCaWdUaXRsZVN1YnRpdGxlTWVzc2FnZUZvckFsbFBsYXllcnMoKTsKfQoKYXN5bmMgZnVuY3Rpb24gc2hvd0R5bmFtaWNHbG9iYWxUaXRsZVN1YnRpdGxlTWVzc2FnZUZvckFsbFBsYXllcnMoCiAgICB0aXRsZUJ1aWxkZXI6IEJpZ01lc3NhZ2VCdWlsZGVyIHwgdW5kZWZpbmVkLAogICAgc3VidGl0bGVCdWlsZGVyOiBCaWdNZXNzYWdlQnVpbGRlciB8IHVuZGVmaW5lZCwKICAgIHRpdGxlQ29sb3I6IG1vZC5WZWN0b3IsCiAgICBzdWJ0aXRsZUNvbG9yOiBtb2QuVmVjdG9yLAogICAgZHVyYXRpb25TZWNvbmRzOiBudW1iZXIgPSBCSUdfTUVTU0FHRV9EVVJBVElPTl9TRUNPTkRTLAogICAgcmVmcmVzaEludGVydmFsU2Vjb25kczogbnVtYmVyID0gMSwKICAgIGxheW91dDogR2xvYmFsTWVzc2FnZUxheW91dCA9IEJJR19NRVNTQUdFX0xBWU9VVCwKICAgIHBsYXllckZpbHRlcj86IEJpZ01lc3NhZ2VQbGF5ZXJGaWx0ZXIKKTogUHJvbWlzZTx2b2lkPiB7CiAgICBTdGF0ZS5yb3VuZC5jb3VudGRvd24ub3ZlckxpbmVNZXNzYWdlVG9rZW4gPSAoU3RhdGUucm91bmQuY291bnRkb3duLm92ZXJMaW5lTWVzc2FnZVRva2VuICsgMSkgJSAxMDAwMDAwMDAwOwogICAgY29uc3QgZXhwZWN0ZWRUb2tlbiA9IFN0YXRlLnJvdW5kLmNvdW50ZG93bi5vdmVyTGluZU1lc3NhZ2VUb2tlbjsKICAgIGNvbnN0IGVuZEF0U2Vjb25kcyA9IG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCkgKyBNYXRoLm1heCgwLCBkdXJhdGlvblNlY29uZHMpOwogICAgbGV0IGxhc3RSZW1haW5pbmdTZWNvbmRzID0gLTE7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBpZiAoZXhwZWN0ZWRUb2tlbiAhPT0gU3RhdGUucm91bmQuY291bnRkb3duLm92ZXJMaW5lTWVzc2FnZVRva2VuKSByZXR1cm47CgogICAgICAgIGNvbnN0IHJlbWFpbmluZ1NlY29uZHMgPSBNYXRoLmZsb29yKGdldFJlbWFpbmluZ1NlY29uZHMoKSk7CiAgICAgICAgaWYgKHJlbWFpbmluZ1NlY29uZHMgIT09IGxhc3RSZW1haW5pbmdTZWNvbmRzKSB7CiAgICAgICAgICAgIGxhc3RSZW1haW5pbmdTZWNvbmRzID0gcmVtYWluaW5nU2Vjb25kczsKICAgICAgICAgICAgY29uc3QgdGl0bGUgPSB0aXRsZUJ1aWxkZXIgPyB0aXRsZUJ1aWxkZXIocmVtYWluaW5nU2Vjb25kcykgOiB1bmRlZmluZWQ7CiAgICAgICAgICAgIGNvbnN0IHN1YnRpdGxlID0gc3VidGl0bGVCdWlsZGVyID8gc3VidGl0bGVCdWlsZGVyKHJlbWFpbmluZ1NlY29uZHMpIDogdW5kZWZpbmVkOwogICAgICAgICAgICBpZiAodGl0bGUgfHwgc3VidGl0bGUpIHsKICAgICAgICAgICAgICAgIHJlbmRlckJpZ1RpdGxlU3VidGl0bGVNZXNzYWdlRm9yQWxsUGxheWVycyh0aXRsZSwgc3VidGl0bGUsIHRpdGxlQ29sb3IsIHN1YnRpdGxlQ29sb3IsIGxheW91dCwgcGxheWVyRmlsdGVyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmVtYWluaW5nRHVyYXRpb24gPSBlbmRBdFNlY29uZHMgLSBtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpOwogICAgICAgIGlmIChyZW1haW5pbmdEdXJhdGlvbiA8PSAwKSBicmVhazsKICAgICAgICBhd2FpdCBtb2QuV2FpdChNYXRoLm1pbihyZWZyZXNoSW50ZXJ2YWxTZWNvbmRzLCByZW1haW5pbmdEdXJhdGlvbikpOwogICAgfQoKICAgIGlmIChleHBlY3RlZFRva2VuICE9PSBTdGF0ZS5yb3VuZC5jb3VudGRvd24ub3ZlckxpbmVNZXNzYWdlVG9rZW4pIHJldHVybjsKICAgIGhpZGVCaWdUaXRsZVN1YnRpdGxlTWVzc2FnZUZvckFsbFBsYXllcnMoKTsKfQoKYXN5bmMgZnVuY3Rpb24gc2hvd1JvdW5kU3RhcnRNZXNzYWdlRm9yQWxsUGxheWVycyhkdXJhdGlvblNlY29uZHM/OiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHsKICAgIGF3YWl0IHNob3dHbG9iYWxUaXRsZVN1YnRpdGxlTWVzc2FnZUZvckFsbFBsYXllcnMoCiAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX1JPVU5EX1NUQVJUX1RJVExFKSwKICAgICAgICBtb2QuTWVzc2FnZShTVFJfUk9VTkRfU1RBUlRfU1VCVElUTEUpLAogICAgICAgIENPTE9SX1dISVRFLAogICAgICAgIENPTE9SX1dISVRFLAogICAgICAgIGR1cmF0aW9uU2Vjb25kcwogICAgKTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIE92ZXJMaW5lIFVJIFdpZGdldHMgKyBCaWcgTWVzc2FnZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIFByZWdhbWUgQ291bnRkb3duIEZsb3cgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIHN0YXJ0UHJlZ2FtZUNvdW50ZG93bih0cmlnZ2VyUGxheWVyPzogbW9kLlBsYXllciwgZm9yY2U/OiBib29sZWFuKTogdm9pZCB7CiAgICBpZiAoU3RhdGUucm91bmQuY291bnRkb3duLmlzQWN0aXZlKSByZXR1cm47CiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCB8fCBpc1JvdW5kTGl2ZSgpKSByZXR1cm47CiAgICBpZiAoIWZvcmNlICYmICFhcmVBbGxBY3RpdmVQbGF5ZXJzUmVhZHkoKSkgcmV0dXJuOwoKICAgIGNsb3NlUmVhZHlEaWFsb2dGb3JBbGxQbGF5ZXJzKCk7CiAgICBTdGF0ZS5yb3VuZC5jb3VudGRvd24uaXNBY3RpdmUgPSB0cnVlOwogICAgU3RhdGUucm91bmQuY291bnRkb3duLmlzUmVxdWVzdGVkID0gdHJ1ZTsKICAgIFN0YXRlLnJvdW5kLmNvdW50ZG93bi50b2tlbisrOwogICAgY29uc3QgZXhwZWN0ZWRUb2tlbiA9IFN0YXRlLnJvdW5kLmNvdW50ZG93bi50b2tlbjsKCiAgICB2b2lkIHJ1blByZWdhbWVDb3VudGRvd24oZXhwZWN0ZWRUb2tlbiwgdHJpZ2dlclBsYXllciwgZm9yY2UgPT09IHRydWUpOwp9CgpmdW5jdGlvbiBpc1ByZWdhbWVDb3VudGRvd25TdGlsbFZhbGlkKGV4cGVjdGVkVG9rZW46IG51bWJlciwgZm9yY2U/OiBib29sZWFuLCBhbGxvd1JvdW5kQWN0aXZlPzogYm9vbGVhbik6IGJvb2xlYW4gewogICAgaWYgKGV4cGVjdGVkVG9rZW4gIT09IFN0YXRlLnJvdW5kLmNvdW50ZG93bi50b2tlbikgcmV0dXJuIGZhbHNlOwogICAgaWYgKFN0YXRlLm1hdGNoLmlzRW5kZWQpIHJldHVybiBmYWxzZTsKICAgIGlmICghYWxsb3dSb3VuZEFjdGl2ZSAmJiBpc1JvdW5kTGl2ZSgpKSByZXR1cm4gZmFsc2U7CiAgICBpZiAoIWZvcmNlICYmICFhcmVBbGxBY3RpdmVQbGF5ZXJzUmVhZHkoKSkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIGdldFByZWdhbWVDb3VudGRvd25Db2xvcih2YWx1ZTogbnVtYmVyKTogbW9kLlZlY3RvciB7CiAgICByZXR1cm4gdmFsdWUgPT09IDEgPyBtb2QuQ3JlYXRlVmVjdG9yKDEsIDEsIDApIDogbW9kLkNyZWF0ZVZlY3RvcigxLCAwLCAwKTsKfQoKYXN5bmMgZnVuY3Rpb24gYW5pbWF0ZVByZWdhbWVDb3VudGRvd25TaXplKAogICAgZXhwZWN0ZWRUb2tlbjogbnVtYmVyLAogICAgZm9yY2U6IGJvb2xlYW4sCiAgICBzdGFydFNpemU6IG51bWJlciwKICAgIGVuZFNpemU6IG51bWJlciwKICAgIGFsbG93Um91bmRBY3RpdmU/OiBib29sZWFuCik6IFByb21pc2U8Ym9vbGVhbj4gewogICAgY29uc3Qgc3RlcFNlY29uZHMgPSBQUkVHQU1FX0NPVU5URE9XTl9TVEVQX1NFQ09ORFMgLyBQUkVHQU1FX0NPVU5URE9XTl9BTklNQVRJT05fU1RFUFM7CiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBQUkVHQU1FX0NPVU5URE9XTl9BTklNQVRJT05fU1RFUFM7IGkrKykgewogICAgICAgIGF3YWl0IG1vZC5XYWl0KHN0ZXBTZWNvbmRzKTsKICAgICAgICBpZiAoIWlzUHJlZ2FtZUNvdW50ZG93blN0aWxsVmFsaWQoZXhwZWN0ZWRUb2tlbiwgZm9yY2UsIGFsbG93Um91bmRBY3RpdmUpKSByZXR1cm4gZmFsc2U7CiAgICAgICAgY29uc3QgdCA9IGkgLyBQUkVHQU1FX0NPVU5URE9XTl9BTklNQVRJT05fU1RFUFM7CiAgICAgICAgY29uc3Qgc2l6ZSA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3Ioc3RhcnRTaXplICsgKGVuZFNpemUgLSBzdGFydFNpemUpICogdCkpOwogICAgICAgIHNldFByZWdhbWVDb3VudGRvd25TaXplRm9yQWxsUGxheWVycyhzaXplKTsKICAgIH0KICAgIHJldHVybiB0cnVlOwp9Cgphc3luYyBmdW5jdGlvbiBydW5QcmVnYW1lQ291bnRkb3duKGV4cGVjdGVkVG9rZW46IG51bWJlciwgdHJpZ2dlclBsYXllcj86IG1vZC5QbGF5ZXIsIGZvcmNlPzogYm9vbGVhbik6IFByb21pc2U8dm9pZD4gewogICAgYXdhaXQgbW9kLldhaXQoUFJFR0FNRV9DT1VOVERPV05fSU5JVElBTF9ERUxBWV9TRUNPTkRTKTsKCiAgICBpZiAoIWlzUHJlZ2FtZUNvdW50ZG93blN0aWxsVmFsaWQoZXhwZWN0ZWRUb2tlbiwgZm9yY2UpKSB7CiAgICAgICAgU3RhdGUucm91bmQuY291bnRkb3duLmlzQWN0aXZlID0gZmFsc2U7CiAgICAgICAgaGlkZVByZWdhbWVDb3VudGRvd25Gb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGZvciAobGV0IHZhbHVlID0gUFJFR0FNRV9DT1VOVERPV05fU1RBUlRfTlVNQkVSOyB2YWx1ZSA+PSAxOyB2YWx1ZS0tKSB7CiAgICAgICAgaWYgKCFpc1ByZWdhbWVDb3VudGRvd25TdGlsbFZhbGlkKGV4cGVjdGVkVG9rZW4sIGZvcmNlKSkgewogICAgICAgICAgICBTdGF0ZS5yb3VuZC5jb3VudGRvd24uaXNBY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgaGlkZVByZWdhbWVDb3VudGRvd25Gb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh2YWx1ZSA9PT0gNCkgewogICAgICAgICAgICAvLyBTdGFydCB0aGUgcm91bmQtc3RhcnQgbWVzc2FnaW5nIHNvIGl0IGVuZHMgd2l0aCB0aGUgR08hIGhpZGUuCiAgICAgICAgICAgIGNvbnN0IHJlbWFpbmluZ1NlY29uZHMgPSAoKHZhbHVlICsgMSkgKiBQUkVHQU1FX0NPVU5URE9XTl9TVEVQX1NFQ09ORFMpICsgUFJFR0FNRV9DT1VOVERPV05fR09fSE9MRF9TRUNPTkRTOwogICAgICAgICAgICB2b2lkIHNob3dSb3VuZFN0YXJ0TWVzc2FnZUZvckFsbFBsYXllcnMocmVtYWluaW5nU2Vjb25kcyk7CiAgICAgICAgfQoKICAgICAgICBzZXRQcmVnYW1lQ291bnRkb3duVmlzdWFsRm9yQWxsUGxheWVycygKICAgICAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmNvdW50ZG93bi5mb3JtYXQsCiAgICAgICAgICAgIHZhbHVlLAogICAgICAgICAgICBnZXRQcmVnYW1lQ291bnRkb3duQ29sb3IodmFsdWUpLAogICAgICAgICAgICBQUkVHQU1FX0NPVU5URE9XTl9TSVpFX0RJR0lUX1NUQVJULAogICAgICAgICAgICB0cnVlCiAgICAgICAgKTsKCiAgICAgICAgY29uc3Qgb2sgPSBhd2FpdCBhbmltYXRlUHJlZ2FtZUNvdW50ZG93blNpemUoCiAgICAgICAgICAgIGV4cGVjdGVkVG9rZW4sCiAgICAgICAgICAgIGZvcmNlID09PSB0cnVlLAogICAgICAgICAgICBQUkVHQU1FX0NPVU5URE9XTl9TSVpFX0RJR0lUX1NUQVJULAogICAgICAgICAgICBQUkVHQU1FX0NPVU5URE9XTl9TSVpFX0RJR0lUX0VORAogICAgICAgICk7CiAgICAgICAgaWYgKCFvaykgewogICAgICAgICAgICBTdGF0ZS5yb3VuZC5jb3VudGRvd24uaXNBY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgaGlkZVByZWdhbWVDb3VudGRvd25Gb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CgogICAgaWYgKCFpc1ByZWdhbWVDb3VudGRvd25TdGlsbFZhbGlkKGV4cGVjdGVkVG9rZW4sIGZvcmNlKSkgewogICAgICAgIFN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc0FjdGl2ZSA9IGZhbHNlOwogICAgICAgIGhpZGVQcmVnYW1lQ291bnRkb3duRm9yQWxsUGxheWVycygpOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBzZXRQcmVnYW1lQ291bnRkb3duVmlzdWFsRm9yQWxsUGxheWVycygKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuY291bnRkb3duLmdvLAogICAgICAgIHVuZGVmaW5lZCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDEsIDApLAogICAgICAgIFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfR09fU1RBUlQsCiAgICAgICAgdHJ1ZQogICAgKTsKICAgIHN0YXJ0Um91bmQodHJpZ2dlclBsYXllcik7CgogICAgY29uc3Qgb2sgPSBhd2FpdCBhbmltYXRlUHJlZ2FtZUNvdW50ZG93blNpemUoCiAgICAgICAgZXhwZWN0ZWRUb2tlbiwKICAgICAgICBmb3JjZSA9PT0gdHJ1ZSwKICAgICAgICBQUkVHQU1FX0NPVU5URE9XTl9TSVpFX0dPX1NUQVJULAogICAgICAgIFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfR09fRU5ELAogICAgICAgIHRydWUKICAgICk7CiAgICBpZiAoIW9rIHx8IGV4cGVjdGVkVG9rZW4gIT09IFN0YXRlLnJvdW5kLmNvdW50ZG93bi50b2tlbikgewogICAgICAgIC8vIElmIHRoZSBhbmltYXRpb24gYWJvcnRlZCwgaGlkZSBpbW1lZGlhdGVseSB0byBhdm9pZCBhIHN0dWNrIEdPLgogICAgICAgIGlmIChleHBlY3RlZFRva2VuID09PSBTdGF0ZS5yb3VuZC5jb3VudGRvd24udG9rZW4pIHsKICAgICAgICAgICAgaGlkZVByZWdhbWVDb3VudGRvd25Gb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIFN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc0FjdGl2ZSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICB9CgogICAgLy8gS2VlcCBHTyB2aXNpYmxlIGZvciBhIHNob3J0IGhvbGQgdG8gZmluaXNoIHRoZSB2aXN1YWwgYmVhdCAodW5wcmVkaWN0YWJsZSByZXBybyBpc3N1ZXMpLgogICAgaWYgKFN0YXRlLm1hdGNoLmlzRW5kZWQpIHsKICAgICAgICBoaWRlUHJlZ2FtZUNvdW50ZG93bkZvckFsbFBsYXllcnMoKTsKICAgICAgICBTdGF0ZS5yb3VuZC5jb3VudGRvd24uaXNBY3RpdmUgPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgYXdhaXQgbW9kLldhaXQoUFJFR0FNRV9DT1VOVERPV05fR09fSE9MRF9TRUNPTkRTKTsKICAgIGlmIChleHBlY3RlZFRva2VuICE9PSBTdGF0ZS5yb3VuZC5jb3VudGRvd24udG9rZW4pIHJldHVybjsKCiAgICBoaWRlUHJlZ2FtZUNvdW50ZG93bkZvckFsbFBsYXllcnMoKTsKICAgIFN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc0FjdGl2ZSA9IGZhbHNlOwoKICAgIGF3YWl0IG1vZC5XYWl0KDEpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIC0gUHJlZ2FtZSBDb3VudGRvd24gRmxvdyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIC0gQXV0by1TdGFydCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gU3RhcnRzIHRoZSByb3VuZCBhcyBzb29uIGFzIGFsbCBhY3RpdmUgcGxheWVycyBhcmUgUkVBRFkuCi8vIE5vdGVzOgovLyAtIE9ubHkgdHJpZ2dlcnMgd2hlbiByb3VuZCBpcyBOT1QgYWN0aXZlIGFuZCBtYXRjaCBpcyBOT1QgZW5kZWQuCi8vIC0gVXNlcyB0aGUgZXhpc3Rpbmcgc3RhcnRSb3VuZCgpIGZsb3c7IHdlIGRvIG5vdCBieXBhc3Mgb3IgcmVpbXBsZW1lbnQgcm91bmQgaW5pdCBsb2dpYy4KZnVuY3Rpb24gdHJ5QXV0b1N0YXJ0Um91bmRJZkFsbFJlYWR5KHRyaWdnZXJQbGF5ZXI/OiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCB8fCBpc1JvdW5kTGl2ZSgpKSByZXR1cm47CiAgICBpZiAoIWFyZUFsbEFjdGl2ZVBsYXllcnNSZWFkeSgpKSByZXR1cm47CiAgICAvLyBBbGwgcGxheWVycyByZWFkeTogc3RhcnQgdGhlIHJvdW5kIHVzaW5nIHRoZSBleGlzdGluZyBmdW5jdGlvbi4KICAgIHN0YXJ0UHJlZ2FtZUNvdW50ZG93bih0cmlnZ2VyUGxheWVyKTsgLy9vbGQ6IHN0YXJ0Um91bmQodHJpZ2dlclBsYXllcik7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgLSBBdXRvLVN0YXJ0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgLSBTd2FwIFRlYW1zIEJ1dHRvbiAoc2luZ2xlIHRvZ2dsZSkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIFN3YXBzIHRoZSBnaXZlbiBwbGF5ZXIgYmV0d2VlbiBUZWFtIDEgYW5kIFRlYW0gMi4gVGhpcyByZXVzZXMgdGhlIGV4aXN0aW5nIHRlYW0tYXNzaWdubWVudCBBUElzLAovLyBidXQgZXhwb3NlcyB0aGVtIGFzIGEgc2luZ2xlIHRvZ2dsZSBidXR0b24gcmF0aGVyIHRoYW4gc2VwYXJhdGUgVGVhbSAxIC8gVGVhbSAyIGJ1dHRvbnMuCmZ1bmN0aW9uIHN3YXBQbGF5ZXJUZWFtKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICAvLyBTd2FwIFRlYW1zIGJ1dHRvbjo6IHNpbmdsZS1idXR0b24gdGVhbSB0b2dnbGUgKFRlYW0gMSA8LT4gVGVhbSAyKS4KICAgIC8vIC0gQXBwbHkgdGhlIHRlYW0gYXNzaWdubWVudCBjaGFuZ2UKICAgIC8vIC0gVW5kZXBsb3kgKGZvcmNlcyByZWRlcGxveSkgc28gdGhlIHBsYXllciBhY3R1YWxseSByZXNwYXducyBvbiB0aGUgbmV3IHRlYW0KICAgIC8vIC0gQ2xvc2UgdGhlIGRpYWxvZyBhbmQgYnJvYWRjYXN0IHRoZSB0ZWFtLXN3aXRjaCBtZXNzYWdlCiAgICAvLyBXZSBhY2hpZXZlIHRoYXQgYnkgcmV1c2luZyB0aGUgcmV0YWluZWQgcHJvY2Vzc1RlYW1Td2l0Y2goKSBwYXRod2F5LgogICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKGV2ZW50UGxheWVyKTsKICAgIC8vIFN3YXBwaW5nIHRlYW1zIG11c3QgYWx3YXlzIGZvcmNlIHRoZSBwbGF5ZXIgYmFjayB0byBOT1QgUkVBRFkuCiAgICAvLyBUaGlzIHByZXZlbnRzIGEgcGxheWVyIGZyb20gY2FycnlpbmcgUkVBRFkgc3RhdHVzIGFjcm9zcyB0ZWFtIGFzc2lnbm1lbnQgY2hhbmdlcy4KICAgIFN0YXRlLnBsYXllcnMucmVhZHlCeVBpZFtwaWRdID0gZmFsc2U7CiAgICAvLyBLZWVwIHRoZSBIVUQgIlggLyBZIFBMQVlFUlMgUkVBRFkiIGxpbmUgaW4gc3luYyBvbiBldmVyeSByZWFkeS1zdGF0ZSBjaGFuZ2UuCiAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yUGlkKHBpZCk7CgogICAgcHJvY2Vzc1RlYW1Td2l0Y2goZXZlbnRQbGF5ZXIpOwoKICAgIC8vIElmIG90aGVyIHZpZXdlcnMgaGF2ZSB0aGUgcmVhZHkgZGlhbG9nIG9wZW4sIHJlZnJlc2ggdGhlaXIgcm9zdGVycyBzbyB0aGlzIHBsYXllciBtb3ZlcyBjb2x1bW5zIGltbWVkaWF0ZWx5LgogICAgcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycygpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIC0gU3dhcCBUZWFtcyBCdXR0b24gKHNpbmdsZSB0b2dnbGUpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBNdWx0aUNsaWNrRGV0ZWN0b3IgKHRyaXBsZSB0YXAgaW50ZXJhY3QpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovL0NvZGUgQ2xlYW51cDogUmVmYWN0b3IgdGhpcyByZWZlcmVuY2UgYW5kIHVzZSBUUyBUZW1wbGF0ZSBhcyBhIHRvb2wgaW1wb3J0IGR1cmluZyBidW5kbGluZyBhIG5ldyBkaXN0cmlidXRpb24gaW5zdGVhZApjbGFzcyBJbnRlcmFjdE11bHRpQ2xpY2tEZXRlY3RvciB7CiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBTVEFURVM6IFJlY29yZDxudW1iZXIsIHsgbGFzdElzSW50ZXJhY3Rpbmc6IGJvb2xlYW47IGNsaWNrQ291bnQ6IG51bWJlcjsgc2VxdWVuY2VTdGFydFRpbWU6IG51bWJlciB9PiA9IHt9OwogICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgV0lORE9XX01TID0gMl8wMDA7IC8vTmVlZHMgdG8gYmUgdHVuZWQgdG8gZmFjaWxpdGF0ZSBjbHVua3kgY29uc29sZSBjb250cm9scwogICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgUkVRVUlSRURfQ0xJQ0tTID0gMzsKCiAgICBwdWJsaWMgc3RhdGljIGNoZWNrTXVsdGlDbGljayhwbGF5ZXI6IG1vZC5QbGF5ZXIpOiBib29sZWFuIHsKICAgICAgICBjb25zdCBwbGF5ZXJJZCA9IG1vZC5HZXRPYmpJZChwbGF5ZXIpOwogICAgICAgIGNvbnN0IGlzSW50ZXJhY3RpbmcgPSBzYWZlR2V0U29sZGllclN0YXRlQm9vbChwbGF5ZXIsIG1vZC5Tb2xkaWVyU3RhdGVCb29sLklzSW50ZXJhY3RpbmcpOwoKICAgICAgICBsZXQgc3RhdGUgPSB0aGlzLlNUQVRFU1twbGF5ZXJJZF07CiAgICAgICAgaWYgKCFzdGF0ZSkgewogICAgICAgICAgICB0aGlzLlNUQVRFU1twbGF5ZXJJZF0gPSBzdGF0ZSA9IHsKICAgICAgICAgICAgICAgIGxhc3RJc0ludGVyYWN0aW5nOiBpc0ludGVyYWN0aW5nLAogICAgICAgICAgICAgICAgY2xpY2tDb3VudDogMCwKICAgICAgICAgICAgICAgIHNlcXVlbmNlU3RhcnRUaW1lOiAwLAogICAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgaWYgKGlzSW50ZXJhY3RpbmcgPT09IHN0YXRlLmxhc3RJc0ludGVyYWN0aW5nKSByZXR1cm4gZmFsc2U7CiAgICAgICAgc3RhdGUubGFzdElzSW50ZXJhY3RpbmcgPSBpc0ludGVyYWN0aW5nOwoKICAgICAgICBpZiAoIWlzSW50ZXJhY3RpbmcpIHJldHVybiBmYWxzZTsKCiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTsKCiAgICAgICAgaWYgKHN0YXRlLmNsaWNrQ291bnQgPiAwICYmIG5vdyAtIHN0YXRlLnNlcXVlbmNlU3RhcnRUaW1lID4gdGhpcy5XSU5ET1dfTVMpIHsKICAgICAgICAgICAgc3RhdGUuY2xpY2tDb3VudCA9IDA7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RhdGUuY2xpY2tDb3VudCA9PT0gMCkgewogICAgICAgICAgICBzdGF0ZS5zZXF1ZW5jZVN0YXJ0VGltZSA9IG5vdzsKICAgICAgICAgICAgc3RhdGUuY2xpY2tDb3VudCA9IDE7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmICgrK3N0YXRlLmNsaWNrQ291bnQgIT09IHRoaXMuUkVRVUlSRURfQ0xJQ0tTKSByZXR1cm4gZmFsc2U7CgogICAgICAgIHN0YXRlLmNsaWNrQ291bnQgPSAwOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gTXVsdGlDbGlja0RldGVjdG9yICh0cmlwbGUgdGFwIGludGVyYWN0KSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gTWFpbiBCYXNlIFJlc3RvY2sgKGFyZWEgdHJpZ2dlcnMpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBJc1BsYXllckluT3duTWFpbkJhc2UocGxheWVyOiBtb2QuUGxheWVyLCBhcmVhVHJpZ2dlcjogbW9kLkFyZWFUcmlnZ2VyKTogYm9vbGVhbiB7CiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuIGZhbHNlOwogICAgY29uc3QgdHJpZ2dlcklkID0gbW9kLkdldE9iaklkKGFyZWFUcmlnZ2VyKTsKICAgIGNvbnN0IHRlYW1JZCA9IG1vZC5HZXRPYmpJZChtb2QuR2V0VGVhbShwbGF5ZXIpKTsKCiAgICByZXR1cm4gbW9kLk9yKAogICAgICAgIG1vZC5BbmQobW9kLkVxdWFscyh0cmlnZ2VySWQsIFRFQU0xX01BSU5fQkFTRV9UUklHR0VSX0lEKSwgbW9kLkVxdWFscyh0ZWFtSWQsIG1vZC5HZXRPYmpJZChtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTEpKSkpLAogICAgICAgIG1vZC5BbmQobW9kLkVxdWFscyh0cmlnZ2VySWQsIFRFQU0yX01BSU5fQkFTRV9UUklHR0VSX0lEKSwgbW9kLkVxdWFscyh0ZWFtSWQsIG1vZC5HZXRPYmpJZChtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTIpKSkpCiAgICApOwp9CgpmdW5jdGlvbiBCcm9hZGNhc3RNYWluQmFzZUV2ZW50KAogICAgbWVzc2FnZUtleTogbnVtYmVyLAogICAgYXJnMD86IHN0cmluZyB8IG51bWJlciB8IG1vZC5QbGF5ZXIsCiAgICBhcmcxPzogc3RyaW5nIHwgbnVtYmVyIHwgbW9kLlBsYXllcgopOiB2b2lkIHsKICAgIGNvbnN0IHNhbml0aXplQXJnID0gKHZhbHVlPzogc3RyaW5nIHwgbnVtYmVyIHwgbW9kLlBsYXllcik6IHN0cmluZyB8IG51bWJlciB8IG1vZC5QbGF5ZXIgfCB1bmRlZmluZWQgPT4gewogICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgIGlmIChtb2QuSXNUeXBlKHZhbHVlLCBtb2QuVHlwZXMuUGxheWVyKSkgewogICAgICAgICAgICBjb25zdCBwbGF5ZXIgPSB2YWx1ZSBhcyBtb2QuUGxheWVyOwogICAgICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuIG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0udW5rbm93blBsYXllcjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgfTsKCiAgICBjb25zdCBzYWZlQXJnMCA9IHNhbml0aXplQXJnKGFyZzApOwogICAgY29uc3Qgc2FmZUFyZzEgPSBzYW5pdGl6ZUFyZyhhcmcxKTsKICAgIGNvbnN0IG1lc3NhZ2UgPSAoc2FmZUFyZzAgPT09IHVuZGVmaW5lZCkKICAgICAgICA/IG1vZC5NZXNzYWdlKG1lc3NhZ2VLZXkpCiAgICAgICAgOiAoc2FmZUFyZzEgPT09IHVuZGVmaW5lZCkKICAgICAgICAgICAgPyBtb2QuTWVzc2FnZShtZXNzYWdlS2V5LCBzYWZlQXJnMCkKICAgICAgICAgICAgOiBtb2QuTWVzc2FnZShtZXNzYWdlS2V5LCBzYWZlQXJnMCwgc2FmZUFyZzEpOwogICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKG1lc3NhZ2UsIGZhbHNlLCB1bmRlZmluZWQsIG1lc3NhZ2VLZXkpOwp9CgpmdW5jdGlvbiBOb3RpZnlBbW1vUmVzdG9ja2VkKHBsYXllcjogbW9kLlBsYXllcik6IHZvaWQgewogICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgIG1vZC5NZXNzYWdlKFNUUl9BTU1PX1JFU1RPQ0tFRCksCiAgICAgICAgdHJ1ZSwKICAgICAgICBwbGF5ZXIsCiAgICAgICAgU1RSX0FNTU9fUkVTVE9DS0VECiAgICApOwp9CgpmdW5jdGlvbiBSZXN0b2NrR2FkZ2V0QW1tbyhwbGF5ZXI6IG1vZC5QbGF5ZXIsIG1hZ0FtbW86IG51bWJlcik6IHZvaWQgewogICAgaWYgKCFpc1BsYXllckRlcGxveWVkKHBsYXllcikpIHJldHVybjsKICAgIG1vZC5TZXRJbnZlbnRvcnlNYWdhemluZUFtbW8ocGxheWVyLCBtb2QuSW52ZW50b3J5U2xvdHMuR2FkZ2V0T25lLCBtYWdBbW1vKTsKICAgIG1vZC5TZXRJbnZlbnRvcnlNYWdhemluZUFtbW8ocGxheWVyLCBtb2QuSW52ZW50b3J5U2xvdHMuR2FkZ2V0VHdvLCBtYWdBbW1vKTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIE1haW4gQmFzZSBSZXN0b2NrIChhcmVhIHRyaWdnZXJzKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gRXhwb3J0ZWQgRXZlbnQgSGFuZGxlcnMgLSBHYW1lIE1vZGUgU3RhcnQgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8qKgogKiBFbnRyeSBwb2ludCBmb3IgdGhpcyBleHBlcmllbmNlIHdoZW4gdGhlIGdhbWUgbW9kZSBzdGFydHMuCiAqCiAqIEhpZ2gtbGV2ZWwgZmxvdzoKICogMSkgSW5pdGlhbGl6ZSBhdXRob3JpdGF0aXZlIG1hdGNoL3JvdW5kIHN0YXRlIChjb3VudGVycywgZmxhZ3MsIGFuZCB0aW1lcnMpLgogKiAyKSBCdWlsZCBvciByZXBhaXIgYW55IGdsb2JhbCBVSS9zdGF0ZSB0aGF0IHNob3VsZCBleGlzdCBiZWZvcmUgcGxheWVycyBpbnRlcmFjdC4KICogMykgRW5zdXJlIGV2ZXJ5IGN1cnJlbnRseS1jb25uZWN0ZWQgcGxheWVyIGhhcyBhIEhVRCBhbmQgdGhhdCB0aGUgSFVEIHJlZmxlY3RzIHRoZSBpbml0aWFsIHN0YXRlLgogKiA0KSBBcm0gYW55IHJlY3VycmluZyBwcm9jZXNzZXMgKGNsb2NrIHRpY2ssIGNsZWFudXAgcGFzc2VzKSB0aGF0IGtlZXAgc3RhdGUgYW5kIFVJIGluIHN5bmMuCiAqCiAqIEltcG9ydGFudCBpbnZhcmlhbnRzOgogKiAtIERvIG5vdCBhd2FyZCBwb2ludHMgdW5sZXNzIGBpc1JvdW5kTGl2ZSgpYCBpcyB0cnVlLgogKiAtIFJvdW5kL21hdGNoIGNvdW50ZXJzIGFyZSBhdXRob3JpdGF0aXZlOyB0aGUgSFVEIGlzIGEgcHJvamVjdGlvbiBvZiB0aGF0IHN0YXRlLgogKiAtIEFueSBhc3luYyB3b3JrIHN0YXJ0ZWQgaGVyZSBtdXN0IHVzZSB0aGUgZ3VhcmQgdG9rZW5zIHRvIHByZXZlbnQgb3ZlcmxhcCBpZiB0aGUgbW9kZSByZXN0YXJ0cy4KICoKICogV2h5IGFzeW5jIGZ1bmN0aW9uczogdXNlcyBzbWFsbCBlbmdpbmUgd2FpdHMgKG1vZC5XYWl0L2F3YWl0KSB0byBzZXF1ZW5jZSBVSSByZWJ1aWxkcy90aW1lcnMgc2FmZWx5IHdpdGhvdXQgYmxvY2tpbmcgdGhlIG1haW4gdGhyZWFkLgogKi8KZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIE9uR2FtZU1vZGVTdGFydGVkKCk6IFByb21pc2U8dm9pZD4gewogICAgY29uc3QgZGV0ZWN0ZWRNYXBLZXkgPSBkZXRlY3RNYXBLZXlGcm9tSHFzKCk7CiAgICBpZiAoZGV0ZWN0ZWRNYXBLZXkpIHsKICAgICAgICBhcHBseU1hcENvbmZpZyhkZXRlY3RlZE1hcEtleSk7CiAgICB9CiAgICBTdGF0ZS52ZWhpY2xlcy5jb25maWdSZWFkeSA9IHRydWU7CgogICAgLy8gVmVoaWNsZSBzY29yaW5nIGluaXQgKyBsZWdhY3kgY2xlYW51cAogICAgLy8gUmVtb3ZlIGxlZ2FjeSBVSSByb290cyAoaWYgYW55KSBiZWZvcmUgd2UgYnVpbGQgZnJlc2ggSFVEczsgcHJldmVudHMgZHVwbGljYXRlZCBvdmVybGF5cyBhY3Jvc3MgcmVzdGFydHMuCiAgICBkZWxldGVMZWdhY3lTY29yZVJvb3RzRm9yQWxsUGxheWVycygpOwoKICAgIC8vIEFwcGx5IGluaXRpYWwgZW5naW5lIHZhcmlhYmxlcy9zZXR0aW5ncyB1c2VkIGJ5IHRoZSBtb2RlIChhdXRob3JpdGF0aXZlIGJhc2VsaW5lKS4KICAgIG1vZC5TZXRHYW1lTW9kZVRhcmdldFNjb3JlKEdBTUVNT0RFX1RBUkdFVF9TQ09SRV9TQUZFVFlfQ0FQKTsKICAgIG1vZC5TZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0xLCBtb2QuRW1wdHlBcnJheSgpKTsKICAgIG1vZC5TZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0yLCBtb2QuRW1wdHlBcnJheSgpKTsKCiAgICB2ZWhJZHMubGVuZ3RoID0gMDsKICAgIHZlaE93bmVycy5sZW5ndGggPSAwOwogICAgY2xlYXJTcGF3bkJhc2VUZWFtQ2FjaGUoKTsKICAgIGNsZWFyU3Bhd25CYXNlVGVhbUNhY2hlKCk7CgogICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy5pbml0KSwKICAgICAgICBmYWxzZSwKICAgICAgICBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTEpLAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy5pbml0CiAgICApOwogICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy5pbml0KSwKICAgICAgICBmYWxzZSwKICAgICAgICBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTIpLAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy5pbml0CiAgICApOwoKICAgIC8vIEVuc3VyZSBIVUQgZXhpc3RzIGZvciBhbnlvbmUgYWxyZWFkeSBpbi1nYW1lIGF0IHN0YXJ0CiAgICBhd2FpdCBtb2QuV2FpdCgwLjEpOwogICAgewogICAgICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgICAgICAvLyBCdWlsZC9yZWJ1aWxkIHRoZSBwbGF5ZXIncyBIVUQgKHdpZGdldHMpIGFuZCBpbW1lZGlhdGVseSByZWZsZWN0IGN1cnJlbnQgYXV0aG9yaXRhdGl2ZSBzdGF0ZS4KICAgICAgICAgICAgZW5zdXJlSHVkRm9yUGxheWVyKHApOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBSZXNldCBIVUQgc3RhdGUKICAgIFN0YXRlLm1hdGNoLmlzRW5kZWQgPSBmYWxzZTsKICAgIFN0YXRlLm1hdGNoLnZpY3RvcnlEaWFsb2dBY3RpdmUgPSBmYWxzZTsKICAgIFN0YXRlLnJvdW5kLnBoYXNlID0gUm91bmRQaGFzZS5Ob3RSZWFkeTsgLy8gUmVzZXQgcm91bmQgcGhhc2UgZm9yIGEgbmV3IG1hdGNoLgogICAgU3RhdGUucm91bmQuY3VycmVudCA9IDE7CiAgICByZXNldE92ZXJ0aW1lRmxhZ1N0YXRlKCk7CiAgICAvLyBQcmVnYW1lOiB0aWUtYnJlYWtlciBlbGlnaWJpbGl0eSBpcyBkZWNpZGVkIGF0IHJvdW5kIHN0YXJ0LgogICAgU3RhdGUuZmxhZy50aWVCcmVha2VyRW5hYmxlZFRoaXNSb3VuZCA9IGZhbHNlOwogICAgc2V0T3ZlcnRpbWVBbGxGbGFnVmlzaWJpbGl0eShmYWxzZSk7CgogICAgc2V0TWF0Y2hXaW5zVGVhbShUZWFtSUQuVGVhbTEsIDApOwogICAgc2V0TWF0Y2hXaW5zVGVhbShUZWFtSUQuVGVhbTIsIDApOwogICAgU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscyA9IDA7CiAgICBTdGF0ZS5zY29yZXMudDJUb3RhbEtpbGxzID0gMDsKCiAgICBTdGF0ZS5tYXRjaC53aW5uZXJUZWFtID0gdW5kZWZpbmVkOwogICAgU3RhdGUubWF0Y2guZW5kRWxhcHNlZFNlY29uZHNTbmFwc2hvdCA9IDA7CiAgICBTdGF0ZS5tYXRjaC52aWN0b3J5U3RhcnRFbGFwc2VkU2Vjb25kc1NuYXBzaG90ID0gMDsKICAgIFN0YXRlLmFkbWluLmFjdGlvbkNvdW50ID0gMDsKICAgIFN0YXRlLmFkbWluLnRpZUJyZWFrZXJPdmVycmlkZVVzZWQgPSBmYWxzZTsKICAgIFN0YXRlLmFkbWluLmxpdmVSZXNwYXduRW5hYmxlZCA9IERFRkFVTFRfTElWRV9SRVNQQVdOX0VOQUJMRUQ7CiAgICBzeW5jQWRtaW5MaXZlUmVzcGF3bkxhYmVsRm9yQWxsUGxheWVycygpOwogICAgdXBkYXRlU3Bhd25EaXNhYmxlZFdhcm5pbmdGb3JBbGxQbGF5ZXJzKCk7CgogICAgU3RhdGUuaHVkQ2FjaGUubGFzdEh1ZFNjb3JlVDEgPSB1bmRlZmluZWQ7CiAgICBTdGF0ZS5odWRDYWNoZS5sYXN0SHVkU2NvcmVUMiA9IHVuZGVmaW5lZDsKICAgIC8vIEluaXQgdmlzaWJsZSBjb3VudGVycwogICAgc2V0SHVkUm91bmRDb3VudGVyc0ZvckFsbFBsYXllcnMoU3RhdGUucm91bmQuY3VycmVudCwgTUFYX1JPVU5EUyk7CiAgICBzZXRIdWRXaW5Db3VudGVyc0ZvckFsbFBsYXllcnMoMCwgMCk7CiAgICBTdGF0ZS5tYXRjaC50aWVzVDEgPSAwOwogICAgU3RhdGUubWF0Y2gudGllc1QyID0gMDsKICAgIHN5bmNSb3VuZFJlY29yZEh1ZEZvckFsbFBsYXllcnMoKTsKICAgIHN5bmNXaW5Db3VudGVyc0h1ZEZyb21HYW1lTW9kZVNjb3JlKCk7CiAgICBzeW5jS2lsbHNIdWRGcm9tVHJhY2tlZFRvdGFscyh0cnVlKTsKICAgIHVwZGF0ZUFkbWluUGFuZWxBY3Rpb25Db3VudEZvckFsbFBsYXllcnMoKTsKICAgIC8vIEJyb2FkY2FzdCB0aGUgaW5pdGlhbCByb3VuZCBwaGFzZSBsYWJlbCAoZS5nLiwgTk9UIFJFQURZKSB0byBhbGwgSFVEcy4KICAgIHNldFJvdW5kU3RhdGVUZXh0Rm9yQWxsUGxheWVycygpOwogICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yQWxsUGxheWVycygpOwoKICAgIC8vIENsb2NrIGluaXQgKyBsb29wIChwcmVnYW1lIHByZXZpZXcsIGRvIG5vdCBjb3VudCBkb3duIHlldCkKICAgIHNldFJvdW5kQ2xvY2tQcmV2aWV3KGdldENvbmZpZ3VyZWRSb3VuZExlbmd0aFNlY29uZHMoKSk7CgogICAgLy8gVmVoaWNsZSBzcGF3bmVycyBydW4gb24gdGhlaXIgb3duIGxvb3Agc28gdGhleSBkb24ndCBibG9jayB0aGUgbWFpbiBjbG9jayBsb29wLgogICAgdm9pZCBzdGFydFZlaGljbGVTcGF3bmVyU3lzdGVtKCk7CiAgICAvLyBTb2Z0IGFpcmNyYWZ0IGNlaWxpbmcgZW5mb3JjZW1lbnQgcnVucyBvbiBpdHMgb3duIGxvb3AgYW5kIG9ubHkgYWN0aXZhdGVzIGFmdGVyIGNvbmZpcm0uCiAgICBzdGFydEFpcmNyYWZ0Q2VpbGluZ1NvZnRFbmZvcmNlbWVudExvb3AoKTsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgIC8vIFB1c2ggdGhlIGluaXRpYWwgY2xvY2sgZGlzcGxheSBzbyBldmVyeSBIVUQgc2hvd3MgdGhlIHNhbWUgc3RhcnRpbmcgdGltZS4KICAgICAgICB1cGRhdGVBbGxQbGF5ZXJzQ2xvY2soKTsKICAgICAgICB1cGRhdGVPdmVydGltZVN0YWdlKCk7CiAgICAgICAgY2hlY2tUYWtlb2ZmTGltaXRGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgYXBwbHlBdXRvUmVhZHlGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgc3luY0tpbGxzSHVkRnJvbVRyYWNrZWRUb3RhbHMoZmFsc2UpOwoKICAgICAgICBpZiAoU3RhdGUubWF0Y2gudmljdG9yeURpYWxvZ0FjdGl2ZSkgewogICAgICAgICAgICBjb25zdCBlbGFwc2VkU2luY2VWaWN0b3J5ID0gTWF0aC5mbG9vcihtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpKSAtIE1hdGguZmxvb3IoU3RhdGUubWF0Y2gudmljdG9yeVN0YXJ0RWxhcHNlZFNlY29uZHNTbmFwc2hvdCk7CiAgICAgICAgICAgIGNvbnN0IHJlbWFpbmluZyA9IE1BVENIX0VORF9ERUxBWV9TRUNPTkRTIC0gZWxhcHNlZFNpbmNlVmljdG9yeTsKICAgICAgICAgICAgdXBkYXRlVmljdG9yeURpYWxvZ0ZvckFsbFBsYXllcnMoTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihyZW1haW5pbmcpKSk7CiAgICAgICAgfQogICAgICAgIGF3YWl0IG1vZC5XYWl0KDEuMCk7CiAgICB9Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBFeHBvcnRlZCBFdmVudCBIYW5kbGVycyAtIEdhbWUgTW9kZSBTdGFydCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gRXhwb3J0ZWQgRXZlbnQgSGFuZGxlcnMgLSBQbGF5ZXIgSm9pbiArIExlYXZlIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiByZXNldFVpRm9yUGxheWVyT25Kb2luKHBsYXllcjogbW9kLlBsYXllcik6IHZvaWQgewogICAgaWYgKCFwbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHBsYXllcikpIHJldHVybjsKICAgIGNvbnN0IHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChwbGF5ZXIpOwogICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkKSByZXR1cm47CgogICAgc2V0VUlJbnB1dE1vZGVGb3JQbGF5ZXIocGxheWVyLCBmYWxzZSk7CgogICAgY29uc3QgdGl0bGVTaGFkb3cgPSBzYWZlRmluZChCSUdfVElUTEVfU0hBRE9XX1dJREdFVF9JRCArIHBpZCk7CiAgICBzYWZlU2V0VUlXaWRnZXRWaXNpYmxlKHRpdGxlU2hhZG93LCBmYWxzZSk7CiAgICBjb25zdCB0aXRsZSA9IHNhZmVGaW5kKEJJR19USVRMRV9XSURHRVRfSUQgKyBwaWQpOwogICAgc2FmZVNldFVJV2lkZ2V0VmlzaWJsZSh0aXRsZSwgZmFsc2UpOwogICAgY29uc3Qgc3VidGl0bGVTaGFkb3cgPSBzYWZlRmluZChCSUdfU1VCVElUTEVfU0hBRE9XX1dJREdFVF9JRCArIHBpZCk7CiAgICBzYWZlU2V0VUlXaWRnZXRWaXNpYmxlKHN1YnRpdGxlU2hhZG93LCBmYWxzZSk7CiAgICBjb25zdCBzdWJ0aXRsZSA9IHNhZmVGaW5kKEJJR19TVUJUSVRMRV9XSURHRVRfSUQgKyBwaWQpOwogICAgc2FmZVNldFVJV2lkZ2V0VmlzaWJsZShzdWJ0aXRsZSwgZmFsc2UpOwoKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdEJ1dHRvblRleHROYW1lKHBpZCkpOwogICAgZGVsZXRlSm9pblByb21wdFdpZGdldChqb2luUHJvbXB0QnV0dG9uTmFtZShwaWQpKTsKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdEJ1dHRvbkJvcmRlck5hbWUocGlkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHROZXZlclNob3dCdXR0b25UZXh0TmFtZShwaWQpKTsKICAgIGRlbGV0ZUpvaW5Qcm9tcHRXaWRnZXQoam9pblByb21wdE5ldmVyU2hvd0J1dHRvbk5hbWUocGlkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHROZXZlclNob3dCdXR0b25Cb3JkZXJOYW1lKHBpZCkpOwogICAgZGVsZXRlSm9pblByb21wdFdpZGdldChqb2luUHJvbXB0Qm9keU5hbWUocGlkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHRUaXRsZU5hbWUocGlkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHRQYW5lbE5hbWUocGlkKSk7CiAgICBkZWxldGVKb2luUHJvbXB0V2lkZ2V0KGpvaW5Qcm9tcHRSb290TmFtZShwaWQpKTsKCiAgICBkZWxldGVUZWFtU3dpdGNoVUkocGxheWVyKTsKfQoKZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIE9uUGxheWVySm9pbkdhbWUoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIpIHsKICAgIGluaXRUZWFtU3dpdGNoRGF0YShldmVudFBsYXllcik7CiAgICBjb25zdCBqb2luUGlkID0gc2FmZUdldFBsYXllcklkKGV2ZW50UGxheWVyKTsKICAgIGlmIChqb2luUGlkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBkZWxldGUgU3RhdGUucGxheWVycy5kaXNjb25uZWN0ZWRCeVBpZFtqb2luUGlkXTsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLmRlcGxveWVkQnlQaWRbam9pblBpZF0gPSBmYWxzZTsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLmF1dG9SZWFkeUJ5UGlkW2pvaW5QaWRdID0gZmFsc2U7CiAgICB9CgogICAgYXdhaXQgbW9kLldhaXQoMC4xKTsKICAgIGlmICghbW9kLklzUGxheWVyVmFsaWQoZXZlbnRQbGF5ZXIpKSByZXR1cm47CgogICAgcmVzZXRVaUZvclBsYXllck9uSm9pbihldmVudFBsYXllcik7CgogICAgY29uc3QgcmVmcyA9IGVuc3VyZUh1ZEZvclBsYXllcihldmVudFBsYXllcik7CgogICAgLy8gSm9pbi10aW1lIEhVRCBpbml0aWFsaXphdGlvbiB1c2VzIHNjcmlwdC1hdXRob3JpdGF0aXZlIGNvdW50ZXJzOyBkbyBub3QgcHVsbCBmcm9tIGVuZ2luZSBzY29yZXMgaGVyZS4KICAgIGlmIChyZWZzKSB7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5sZWZ0V2luc1RleHQsIFN0YXRlLm1hdGNoLndpbnNUMSk7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5yaWdodFdpbnNUZXh0LCBTdGF0ZS5tYXRjaC53aW5zVDIpOwogICAgICAgIHNldFJvdW5kUmVjb3JkVGV4dChyZWZzLmxlZnRSZWNvcmRUZXh0LCBTdGF0ZS5tYXRjaC53aW5zVDEsIFN0YXRlLm1hdGNoLmxvc3Nlc1QxLCBTdGF0ZS5tYXRjaC50aWVzVDEpOwogICAgICAgIHNldFJvdW5kUmVjb3JkVGV4dChyZWZzLnJpZ2h0UmVjb3JkVGV4dCwgU3RhdGUubWF0Y2gud2luc1QyLCBTdGF0ZS5tYXRjaC5sb3NzZXNUMiwgU3RhdGUubWF0Y2gudGllc1QyKTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLmxlZnRSb3VuZEtpbGxzVGV4dCwgU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscyk7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5yaWdodFJvdW5kS2lsbHNUZXh0LCBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzKTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLmxlZnRLaWxsc1RleHQsIFN0YXRlLnNjb3Jlcy50MVRvdGFsS2lsbHMpOwogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMucmlnaHRLaWxsc1RleHQsIFN0YXRlLnNjb3Jlcy50MlRvdGFsS2lsbHMpOwogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMucm91bmRDdXJUZXh0LCBTdGF0ZS5yb3VuZC5jdXJyZW50KTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJvdW5kTWF4VGV4dCwgU3RhdGUucm91bmQubWF4KTsKICAgIH0KICAgIHsKICAgICAgICBjb25zdCBjYWNoZSA9IGVuc3VyZUNsb2NrVUlBbmRHZXRDYWNoZShldmVudFBsYXllcik7CiAgICAgICAgaWYgKGNhY2hlKSBzZXRSb3VuZFN0YXRlVGV4dChjYWNoZS5yb3VuZFN0YXRlVGV4dCk7CiAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIpOwogICAgfQogICAgZGVsZXRlTGVnYWN5U2NvcmVSb290Rm9yUGxheWVyKGV2ZW50UGxheWVyKTsKICAgIGlmIChqb2luUGlkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB1cGRhdGVUZWFtTmFtZVdpZGdldHNGb3JQaWQoam9pblBpZCk7CiAgICB9CgogICAgLy8gU2Vjb25kIGpvaW4tdGltZSByZWZyZXNoIGFmdGVyIHRlYW0gYXNzaWdubWVudCBzZXR0bGVzIHRvIGF2b2lkIHN0YWxlIFJlYWR5IGRpYWxvZyByb3N0ZXJzLgogICAgYXdhaXQgbW9kLldhaXQoMC4xKTsKICAgIGlmICghbW9kLklzUGxheWVyVmFsaWQoZXZlbnRQbGF5ZXIpKSByZXR1cm47CiAgICByZW5kZXJSZWFkeURpYWxvZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk7CiAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yQWxsUGxheWVycygpOwogICAgcmVidWlsZE92ZXJ0aW1lVWlGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIpOwogICAgLy8gRW5zdXJlIHRoZSByb3VuZCBjbG9jayBkaWdpdHMgcmVmcmVzaCBmb3IgcmVjb25uZWN0aW5nIHBsYXllcnMuCiAgICBTdGF0ZS5yb3VuZC5jbG9jay5sYXN0RGlzcGxheWVkU2Vjb25kcyA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmxhc3RMb3dUaW1lU3RhdGUgPSB1bmRlZmluZWQ7CiAgICB1cGRhdGVBbGxQbGF5ZXJzQ2xvY2soKTsKCiAgICAvLyBKb2luLXRpbWUgcHJvbXB0IGlzIG9ubHkgc2hvd24gb25jZSBwZXIgcGxheWVyICh1bmRlcGxveSBwcm9tcHRzIGNhbiByZXBlYXQgdW5sZXNzIHN1cHByZXNzZWQpLgogICAgaWYgKCFzaG91bGRTaG93Sm9pblByb21wdEZvclBsYXllcihldmVudFBsYXllcikpIHJldHVybjsKICAgIGNvbnN0IGpvaW5Qcm9tcHRQaWQgPSBzYWZlR2V0UGxheWVySWQoZXZlbnRQbGF5ZXIpOwogICAgaWYgKGpvaW5Qcm9tcHRQaWQgPT09IHVuZGVmaW5lZCkgcmV0dXJuOwogICAgaWYgKFN0YXRlLnBsYXllcnMuam9pblByb21wdFNob3duQnlQaWRbam9pblByb21wdFBpZF0pIHJldHVybjsKICAgIFN0YXRlLnBsYXllcnMuam9pblByb21wdFNob3duQnlQaWRbam9pblByb21wdFBpZF0gPSB0cnVlOwoKICAgIGF3YWl0IG1vZC5XYWl0KDAuMik7CiAgICBpZiAoIW1vZC5Jc1BsYXllclZhbGlkKGV2ZW50UGxheWVyKSkgcmV0dXJuOwogICAgaWYgKCFzaG91bGRTaG93Sm9pblByb21wdEZvclBsYXllcihldmVudFBsYXllcikpIHJldHVybjsKICAgIGNyZWF0ZUpvaW5Qcm9tcHRGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIpOwp9CgovKioKICogRGlzY29ubmVjdCBoYW5kbGluZzoKICogLSBDbGVhcnMgcGVyLXBsYXllciBzdGF0ZSBtYXBzIHNvIHJlam9pbiBzdGFydHMgY2xlYW4gKE5PVCBSRUFEWSkuCiAqIC0gRm9yY2VzIFVJL0hVRCByZWZyZXNoIGZvciByZW1haW5pbmcgcGxheWVycyB0byBkcm9wIHRoZSBkZXBhcnRlZCBwbGF5ZXIgaW1tZWRpYXRlbHkuCiAqLwpleHBvcnQgZnVuY3Rpb24gT25QbGF5ZXJMZWF2ZUdhbWUoZXZlbnROdW1iZXI6IG51bWJlciB8IG1vZC5QbGF5ZXIpIHsKICAgIGxldCBwaWQ6IG51bWJlciB8IHVuZGVmaW5lZDsKICAgIGlmIChtb2QuSXNUeXBlKGV2ZW50TnVtYmVyLCBtb2QuVHlwZXMuUGxheWVyKSkgewogICAgICAgIHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChldmVudE51bWJlciBhcyBtb2QuUGxheWVyKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcGlkID0gZXZlbnROdW1iZXIgYXMgbnVtYmVyOwogICAgfQogICAgaWYgKHBpZCA9PT0gdW5kZWZpbmVkKSByZXR1cm47CgogICAgU3RhdGUucGxheWVycy5kaXNjb25uZWN0ZWRCeVBpZFtwaWRdID0gdHJ1ZTsKICAgIHJlbW92ZVRlYW1Td2l0Y2hJbnRlcmFjdFBvaW50KHBpZCk7CiAgICAvLyBDbGVhbnVwOiBkZWxldGUgY2FjaGVkIFVJIHdpZGdldHMgc28gd2UgZG8gbm90IGxlYWsgVUkgZm9yIGRpc2Nvbm5lY3RlZCBwbGF5ZXJzLgogICAgaWYgKCFzaG91bGREZWZlckRpc2Nvbm5lY3RVaURlbGV0ZXMoKSkgewogICAgICAgIGhhcmREZWxldGVUZWFtU3dpdGNoVUkocGlkKTsKICAgIH0KICAgIC8vIE9uIHVuZGVwbG95L2RlYXRoLCBhdm9pZCBoYXJkLWRlbGV0aW5nIG92ZXJ0aW1lIEhVRDsgaGlkZSArIGRyb3AgcmVmcyBmb3Igc2FmZSByZWJ1aWxkLgogICAgaGFuZGxlT3ZlcnRpbWVQbGF5ZXJMZWF2ZUJ5SWQocGlkLCBmYWxzZSk7CiAgICAvLyBSZW1vdmUgYW55IHBlcnNpc3RlZCBwZXItcGxheWVyIHN0YXRlIHNvIHJlam9pbiBzdGFydHMgY2xlYW4gKE5PVCBSRUFEWSBieSBkZWZhdWx0KS4KICAgIGRlbGV0ZSBTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXTsKICAgIGRlbGV0ZSBTdGF0ZS5wbGF5ZXJzLmF1dG9SZWFkeUJ5UGlkW3BpZF07CiAgICBkZWxldGUgU3RhdGUucGxheWVycy5yZWFkeU1lc3NhZ2VDb29sZG93bkJ5UGlkW3BpZF07CiAgICBkZWxldGUgU3RhdGUucGxheWVycy5qb2luUHJvbXB0U2hvd25CeVBpZFtwaWRdOwogICAgZGVsZXRlIFN0YXRlLnBsYXllcnMuam9pblByb21wdE5ldmVyU2hvd0J5UGlkTWFwW3BpZF07CiAgICBkZWxldGUgU3RhdGUucGxheWVycy5qb2luUHJvbXB0UmVhZHlEaWFsb2dPcGVuZWRCeVBpZFtwaWRdOwogICAgZGVsZXRlIFN0YXRlLnBsYXllcnMuam9pblByb21wdFRpcEluZGV4QnlQaWRbcGlkXTsKICAgIGRlbGV0ZSBTdGF0ZS5wbGF5ZXJzLmpvaW5Qcm9tcHRUaXBzVW5sb2NrZWRCeVBpZFtwaWRdOwogICAgZGVsZXRlIFN0YXRlLnBsYXllcnMuam9pblByb21wdFRyaXBsZVRhcEFybWVkQnlQaWRbcGlkXTsKICAgIGRlbGV0ZSBTdGF0ZS5wbGF5ZXJzLnVpSW5wdXRFbmFibGVkQnlQaWRbcGlkXTsKICAgIGRlbGV0ZSBTdGF0ZS5wbGF5ZXJzLmluTWFpbkJhc2VCeVBpZFtwaWRdOwogICAgZGVsZXRlIFN0YXRlLnBsYXllcnMub3ZlclRha2VvZmZMaW1pdEJ5UGlkW3BpZF07CiAgICBkZWxldGUgU3RhdGUucGxheWVycy5kZXBsb3llZEJ5UGlkW3BpZF07CiAgICBkZWxldGUgU3RhdGUucGxheWVycy5zcGF3bkRpc2FibGVkV2FybmluZ1Zpc2libGVCeVBpZFtwaWRdOwogICAgLy8gQWxzbyBkcm9wIGRpYWxvZy12aXNpYmxlIHRyYWNraW5nIGlmIHByZXNlbnQgKHZpZXdlciBpcyBnb25lKS4KICAgIGRlbGV0ZSBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BpZF07CiAgICBjbGVhckpvaW5Qcm9tcHRGb3JQbGF5ZXJJZChwaWQpOwoKICAgIC8vIFJlZnJlc2ggVUkgZm9yIHJlbWFpbmluZyBwbGF5ZXJzIHNvIHJvc3RlcnMgKyBIVUQgcmVhZHkgY291bnRzIGltbWVkaWF0ZWx5IHJlZmxlY3QgdGhlIGRpc2Nvbm5lY3QuCiAgICBpZiAoIWlzUm91bmRMaXZlKCkpIHsKICAgICAgICByZW5kZXJSZWFkeURpYWxvZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk7CiAgICAgICAgdXBkYXRlUGxheWVyc1JlYWR5SHVkVGV4dEZvckFsbFBsYXllcnMoKTsKICAgICAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7CiAgICB9Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBFeHBvcnRlZCBFdmVudCBIYW5kbGVycyAtIFBsYXllciBKb2luICsgTGVhdmUgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEV4cG9ydGVkIEV2ZW50IEhhbmRsZXJzIC0gUGxheWVyIERlcGxveSArIFVuZGVwbG95IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgphc3luYyBmdW5jdGlvbiBkZWZlckZvcmNlZFVuZGVwbG95KHBsYXllcjogbW9kLlBsYXllciwgcmVhc29uOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHsKICAgIC8vIERlZmVyIHVuZGVwbG95IGJ5IGEgdGljayB0byBhdm9pZCBlbmdpbmUgaW5zdGFiaWxpdHkgZHVyaW5nIGRlcGxveSB0cmFuc2l0aW9ucy4KICAgIHRyeSB7CiAgICAgICAgYXdhaXQgbW9kLldhaXQoMC4xKTsKICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuOwogICAgICAgIG1vZC5VbmRlcGxveVBsYXllcihwbGF5ZXIpOwogICAgfSBjYXRjaCB7CiAgICAgICAgLy8gSW50ZW50aW9uYWxseSBzaWxlbnQgdG8ga2VlcCB1bnN0YWJsZSB0cmFuc2l0aW9ucyBmcm9tIGNyYXNoaW5nIHRoZSBleHBlcmllbmNlLgogICAgfQp9CgpleHBvcnQgYXN5bmMgZnVuY3Rpb24gT25QbGF5ZXJEZXBsb3llZChldmVudFBsYXllcjogbW9kLlBsYXllcikgewogICAgY29uc3QgcGlkID0gc2FmZUdldFBsYXllcklkKGV2ZW50UGxheWVyKTsKICAgIGlmIChwaWQgPT09IHVuZGVmaW5lZCkgcmV0dXJuOwogICAgLy8gU2FmZXR5OiBhbHdheXMgcmVzdG9yZSBVSSBpbnB1dCBtb2RlIG9uIGRlcGxveSB0byBhdm9pZCBzdHVjayBVSSBzdXBwcmVzc2luZyBtZXNzYWdlcy4KICAgIHNldFVJSW5wdXRNb2RlRm9yUGxheWVyKGV2ZW50UGxheWVyLCBmYWxzZSk7CiAgICBpZiAoU3RhdGUucm91bmQuZmxvdy5jbGVhbnVwQWN0aXZlICYmICFTdGF0ZS5yb3VuZC5mbG93LmNsZWFudXBBbGxvd0RlcGxveSkgewogICAgICAgIFN0YXRlLnBsYXllcnMuZGVwbG95ZWRCeVBpZFtwaWRdID0gZmFsc2U7CiAgICAgICAgYXdhaXQgZGVmZXJGb3JjZWRVbmRlcGxveShldmVudFBsYXllciwgImNsZWFudXAiKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoaXNMaXZlUmVzcGF3bkRpc2FibGVkKCkgJiYgaXNSb3VuZExpdmUoKSkgewogICAgICAgIFN0YXRlLnBsYXllcnMuZGVwbG95ZWRCeVBpZFtwaWRdID0gZmFsc2U7CiAgICAgICAgdXBkYXRlU3Bhd25EaXNhYmxlZFdhcm5pbmdGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIpOwogICAgICAgIGF3YWl0IGRlZmVyRm9yY2VkVW5kZXBsb3koZXZlbnRQbGF5ZXIsICJsaXZlX3JvdW5kIik7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIFN0YXRlLnBsYXllcnMuZGVwbG95ZWRCeVBpZFtwaWRdID0gdHJ1ZTsKICAgIFN0YXRlLnBsYXllcnMuam9pblByb21wdFRyaXBsZVRhcEFybWVkQnlQaWRbcGlkXSA9IGZhbHNlOwogICAgdXBkYXRlU3Bhd25EaXNhYmxlZFdhcm5pbmdGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIpOwogICAgLy9SZW1vdmUgZXhpc3RpbmcgZ2FkZ2V0cyBhbmQgZ2l2ZSBkZXBsb3lhYmxlIHZlaGljbGUgc3VwcGx5IGNyYXRlcwogICAgbW9kLlJlbW92ZUVxdWlwbWVudChldmVudFBsYXllciwgbW9kLkludmVudG9yeVNsb3RzLkdhZGdldE9uZSk7CiAgICBtb2QuUmVtb3ZlRXF1aXBtZW50KGV2ZW50UGxheWVyLCBtb2QuSW52ZW50b3J5U2xvdHMuR2FkZ2V0VHdvKTsKICAgIG1vZC5BZGRFcXVpcG1lbnQoCiAgICAgICAgZXZlbnRQbGF5ZXIsCiAgICAgICAgbW9kLkdhZGdldHMuRGVwbG95YWJsZV9WZWhpY2xlX1N1cHBseV9DcmF0ZSwKICAgICAgICBtb2QuSW52ZW50b3J5U2xvdHMuR2FkZ2V0T25lCiAgICApOwogICAgbW9kLkFkZEVxdWlwbWVudCgKICAgICAgICBldmVudFBsYXllciwKICAgICAgICBtb2QuR2FkZ2V0cy5EZXBsb3lhYmxlX1ZlaGljbGVfU3VwcGx5X0NyYXRlLAogICAgICAgIG1vZC5JbnZlbnRvcnlTbG90cy5HYWRnZXRUd28KICAgICk7CiAgICAvLyBSZWpvaW4gLyBzcGF3biBiZWhhdmlvcjogcGxheWVycyBhbHdheXMgc3RhcnQgTk9UIFJFQURZIGZvciB0aGUgbmV4dCByb3VuZCBnYXRpbmcuCiAgICBTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSA9IGZhbHNlOwogICAgLy8gRGVzaWduIGFzc3VtcHRpb246IHBsYXllcnMgc3Bhd24gaW4gdGhlaXIgbWFpbiBiYXNlOyB1cGRhdGUgaW1tZWRpYXRlbHkgZm9yIHJvc3RlciBkaXNwbGF5LgogICAgU3RhdGUucGxheWVycy5pbk1haW5CYXNlQnlQaWRbcGlkXSA9IHRydWU7CiAgICBkZWxldGUgU3RhdGUucGxheWVycy5vdmVyVGFrZW9mZkxpbWl0QnlQaWRbcGlkXTsKICAgIHVwZGF0ZVBsYXllcnNSZWFkeUh1ZFRleHRGb3JBbGxQbGF5ZXJzKCk7CiAgICByZW5kZXJSZWFkeURpYWxvZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk7CiAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7CgogICAgZW5zdXJlSHVkRm9yUGxheWVyKGV2ZW50UGxheWVyKTsKICAgIGF3YWl0IHNwYXduVGVhbVN3aXRjaEludGVyYWN0UG9pbnQoZXZlbnRQbGF5ZXIpOwp9CgpleHBvcnQgZnVuY3Rpb24gT25QbGF5ZXJVbmRlcGxveShldmVudFBsYXllcjogbW9kLlBsYXllcikgewogICAgLy8gSWYgdGhlIHBsYXllciBpcyBsZWF2aW5nIHRoZSBkZXBsb3llZCBzdGF0ZSAoZGVhdGggLyBtYW51YWwgdW5kZXBsb3kgLyBmb3JjZWQgcmVkZXBsb3kpLAogICAgLy8gdGhlIFJlYWR5IFVwIGRpYWxvZyBzaG91bGQgYmUgY2xvc2VkLiBUaGlzIHByZXZlbnRzIGludGVyYWN0aW5nIHdpdGggdGhlIFVJIHdoaWxlIHVuZGVwbG95ZWQuCiAgICBpZiAoIWV2ZW50UGxheWVyIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChldmVudFBsYXllcikpIHJldHVybjsKICAgIGNvbnN0IHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChldmVudFBsYXllcik7CiAgICBpZiAocGlkID09PSB1bmRlZmluZWQpIHJldHVybjsKICAgIGlmIChpc1BpZERpc2Nvbm5lY3RlZChwaWQpKSByZXR1cm47CiAgICBTdGF0ZS5wbGF5ZXJzLmRlcGxveWVkQnlQaWRbcGlkXSA9IGZhbHNlOwogICAgU3RhdGUucGxheWVycy5qb2luUHJvbXB0VHJpcGxlVGFwQXJtZWRCeVBpZFtwaWRdID0gZmFsc2U7CiAgICBpZiAoU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwaWRdPy5kaWFsb2dWaXNpYmxlKSB7CiAgICAgICAgZGVsZXRlVGVhbVN3aXRjaFVJKGV2ZW50UGxheWVyKTsKICAgIH0KICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBpZChwaWQpOwoKICAgIHJlbW92ZVRlYW1Td2l0Y2hJbnRlcmFjdFBvaW50KHBpZCk7CiAgICAvLyBPbiB1bmRlcGxveS9kZWF0aCwgYXZvaWQgaGFyZC1kZWxldGluZyBvdmVydGltZSBIVUQ7IGhpZGUgKyBkcm9wIHJlZnMgZm9yIHNhZmUgcmVidWlsZC4KICAgIGhhbmRsZU92ZXJ0aW1lUGxheWVyTGVhdmVCeUlkKHBpZCwgZmFsc2UpOwoKICAgIGlmIChzaG91bGRTaG93Sm9pblByb21wdEZvclBsYXllcihldmVudFBsYXllcikpIHsKICAgICAgICBjcmVhdGVKb2luUHJvbXB0Rm9yUGxheWVyKGV2ZW50UGxheWVyKTsKICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEV4cG9ydGVkIEV2ZW50IEhhbmRsZXJzIC0gUGxheWVyIERlcGxveSArIFVuZGVwbG95IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBFeHBvcnRlZCBFdmVudCBIYW5kbGVycyAtIFBsYXllciBMb29wICsgVUkgSW5wdXRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBQZXJmb3JtYW5jZSBub3RlOgovLyAtIE9uZ29pbmdQbGF5ZXIgZXhlY3V0ZXMgZnJlcXVlbnRseTsga2VlcCBpdCBsaWdodHdlaWdodCEKLy8gLSBBdm9pZCBGaW5kVUlXaWRnZXQgY2FsbHMgb3IgcGVyLXRpY2sgbG9vcHMgb3ZlciBhbGwgcGxheWVycy92ZWhpY2xlcyB1bmxlc3Mgc3RyaWN0bHkgbmVjZXNzYXJ5LgovLyAtIFByZWZlciAidXBkYXRlIG9ubHkgd2hlbiBjaGFuZ2VkIiBwYXR0ZXJucyBmb3IgSFVEL2Nsb2NrIHJlZnJlc2hlcy4KZXhwb3J0IGZ1bmN0aW9uIE9uZ29pbmdQbGF5ZXIoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIpOiB2b2lkIHsKICAgIGlmICghZXZlbnRQbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKGV2ZW50UGxheWVyKSkgcmV0dXJuOwogICAgdXBkYXRlU3Bhd25EaXNhYmxlZFdhcm5pbmdGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIpOwogICAgaWYgKGlzUGxheWVyRGVwbG95ZWQoZXZlbnRQbGF5ZXIpKSB7CiAgICAgICAgY2hlY2tUZWFtU3dpdGNoSW50ZXJhY3RQb2ludFJlbW92YWwoZXZlbnRQbGF5ZXIpOwogICAgfQoKICAgIC8vIFVJIGNhY2hpbmcgd2FybS11cDogYnVpbGQgdGhlIFJlYWR5IFVwIGRpYWxvZyBvbmNlIHBlciBwbGF5ZXIgc28gdGhlIGZpcnN0IHJlYWwgb3BlbiBpcyBzbmFwcHkuCiAgICAvLyBXZSBidWlsZCBhbmQgaW1tZWRpYXRlbHkgaGlkZTsgdGhlIGRpYWxvZyBiZWNvbWVzIHZpc2libGUgb25seSB3aGVuIHRoZSBwbGF5ZXIgb3BlbnMgaXQgdmlhIHRoZSBpbnRlcmFjdCBwb2ludC4KICAgIGNvbnN0IHBpZCA9IHNhZmVHZXRQbGF5ZXJJZChldmVudFBsYXllcik7CiAgICBpZiAocGlkID09PSB1bmRlZmluZWQpIHJldHVybjsKICAgIGlmIChTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BpZF0gJiYgIVN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGlkXS51aUJ1aWx0KSB7CiAgICAgICAgY3JlYXRlVGVhbVN3aXRjaFVJKGV2ZW50UGxheWVyKTsKICAgICAgICAvLyBFbnN1cmUgdGhlIHdhcm0tdXAgYnVpbGQgZG9lcyBub3QgY291bnQgYXMgIm9wZW4iIGZvciByZWZyZXNoIGxvZ2ljLgogICAgICAgIFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGlkXS5kaWFsb2dWaXNpYmxlID0gZmFsc2U7CiAgICAgICAgZGVsZXRlVGVhbVN3aXRjaFVJKGV2ZW50UGxheWVyKTsgLy8gbm93IGhpZGVzIChjYWNoZWQpIHJhdGhlciB0aGFuIGRlbGV0aW5nCiAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwaWRdLnVpQnVpbHQgPSB0cnVlOwogICAgfQoKICAgIGlmIChpc1BsYXllckRlcGxveWVkKGV2ZW50UGxheWVyKSkgewogICAgICAgIGlmIChJbnRlcmFjdE11bHRpQ2xpY2tEZXRlY3Rvci5jaGVja011bHRpQ2xpY2soZXZlbnRQbGF5ZXIpKSB7CiAgICAgICAgICAgIGFybUpvaW5Qcm9tcHRUcmlwbGVUYXBGb3JQaWQocGlkKTsKICAgICAgICAgICAgc3Bhd25UZWFtU3dpdGNoSW50ZXJhY3RQb2ludChldmVudFBsYXllcik7CiAgICAgICAgICAgIC8vbW9kLkRpc3BsYXlIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5tdWx0aWNsaWNrRGV0ZWN0b3IpLCBtb2QuR2V0VGVhbShldmVudFBsYXllcikpOwogICAgICAgIH0KICAgIH0KfQoKZXhwb3J0IGZ1bmN0aW9uIE9uUGxheWVySW50ZXJhY3QoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsIGV2ZW50SW50ZXJhY3RQb2ludDogbW9kLkludGVyYWN0UG9pbnQpIHsKICAgIHRlYW1Td2l0Y2hJbnRlcmFjdFBvaW50QWN0aXZhdGVkKGV2ZW50UGxheWVyLCBldmVudEludGVyYWN0UG9pbnQpOwp9CgpleHBvcnQgZnVuY3Rpb24gT25QbGF5ZXJVSUJ1dHRvbkV2ZW50KGV2ZW50UGxheWVyOiBtb2QuUGxheWVyLCBldmVudFVJV2lkZ2V0OiBtb2QuVUlXaWRnZXQsIGV2ZW50VUlCdXR0b25FdmVudDogbW9kLlVJQnV0dG9uRXZlbnQpIHsKICAgIGlmICh0cnlIYW5kbGVKb2luUHJvbXB0QnV0dG9uKGV2ZW50UGxheWVyLCBldmVudFVJV2lkZ2V0LCBldmVudFVJQnV0dG9uRXZlbnQpKSByZXR1cm47CiAgICB0ZWFtU3dpdGNoQnV0dG9uRXZlbnQoZXZlbnRQbGF5ZXIsIGV2ZW50VUlXaWRnZXQsIGV2ZW50VUlCdXR0b25FdmVudCk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBFeHBvcnRlZCBFdmVudCBIYW5kbGVycyAtIFBsYXllciBMb29wICsgVUkgSW5wdXRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBFeHBvcnRlZCBFdmVudCBIYW5kbGVycyAtIFZlaGljbGUgRW50cnkgKyBFeGl0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBPblBsYXllckVudGVyVmVoaWNsZToKLy8gUmVnaXN0ZXJzIGEgdmVoaWNsZSB0byBhIHRlYW0gdGhlIGZpcnN0IHRpbWUgYSBwbGF5ZXIgZW50ZXJzIGl0LgovLyBUaGlzIGVzdGFibGlzaGVzIHdoaWNoIHRlYW0gd2lsbCBsb3NlIGEgcG9pbnQgaWYgdGhlIHZlaGljbGUgaXMgbGF0ZXIgZGVzdHJveWVkLgovLyBBbHNvIHJlY29yZHMgdGhlIGVudGVyaW5nIHBsYXllciBhcyB0aGUgJ2xhc3QgZHJpdmVyJyBmb3IgbWVzc2FnaW5nIHB1cnBvc2VzLgovLyBOb3RlczoKLy8gLSBSZWdpc3RyYXRpb24gaXMgaWRlbXBvdGVudDsgcmUtZW50ZXJpbmcgZG9lcyBub3QgZG91YmxlLXJlZ2lzdGVyLgovLyAtIExhc3QgZHJpdmVyIGlzIGJlc3QtZWZmb3J0IGFuZCBub3QgYXV0aG9yaXRhdGl2ZSBmb3Igc2NvcmluZy4KLy8gQ29kZSBDbGVhbnVwOiBLbm93biBmcmFnaWxpdHkgLSB3ZSBuZWVkIHRvIHJlZmFjdG9yIG9yIGlkZW50aWZ5IGEgZGlmZmVyZW50IG1ldGhvZCBlbnRpcmVseSBhcyBPblBsYXllckVudGVyVmVoaWNsZSBpcyBlcnJvciBwcm9uZS4KZnVuY3Rpb24gaXNWZWhpY2xlRW1wdHlGb3JFbnRyeShldmVudFZlaGljbGU6IG1vZC5WZWhpY2xlLCBlbnRlcmluZ1BsYXllcjogbW9kLlBsYXllcik6IGJvb2xlYW4gewogICAgY29uc3Qgc2VhdENvdW50ID0gbW9kLkdldFZlaGljbGVTZWF0Q291bnQoZXZlbnRWZWhpY2xlKTsKICAgIGlmIChzZWF0Q291bnQgPD0gMSkgcmV0dXJuIHRydWU7CiAgICBjb25zdCBlbnRlcmluZ1NlYXQgPSBtb2QuR2V0UGxheWVyVmVoaWNsZVNlYXQoZW50ZXJpbmdQbGF5ZXIpOwogICAgZm9yIChsZXQgc2VhdCA9IDA7IHNlYXQgPCBzZWF0Q291bnQ7IHNlYXQrKykgewogICAgICAgIGlmIChzZWF0ID09PSBlbnRlcmluZ1NlYXQpIGNvbnRpbnVlOwogICAgICAgIGlmIChtb2QuSXNWZWhpY2xlU2VhdE9jY3VwaWVkKGV2ZW50VmVoaWNsZSwgc2VhdCkpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiB0cnVlOwp9CgpleHBvcnQgZnVuY3Rpb24gT25QbGF5ZXJFbnRlclZlaGljbGUoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsIGV2ZW50VmVoaWNsZTogbW9kLlZlaGljbGUpIHsKICAgIGlmICghbW9kLklzUGxheWVyVmFsaWQoZXZlbnRQbGF5ZXIpKSByZXR1cm47CgogICAgY29uc3QgdGVhbU51bSA9IGdldFRlYW1OdW1iZXIobW9kLkdldFRlYW0oZXZlbnRQbGF5ZXIpKTsKICAgIGlmICh0ZWFtTnVtICE9PSBUZWFtSUQuVGVhbTEgJiYgdGVhbU51bSAhPT0gVGVhbUlELlRlYW0yKSB7CiAgICAgICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgICAgICBtb2QuTWVzc2FnZShTVFJfVkVISUNMRV9SRUdfUEVORElOR19URUFNLCBldmVudFBsYXllciksCiAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgIG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMSksCiAgICAgICAgICAgIFNUUl9WRUhJQ0xFX1JFR19QRU5ESU5HX1RFQU0KICAgICAgICApOwogICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX1ZFSElDTEVfUkVHX1BFTkRJTkdfVEVBTSwgZXZlbnRQbGF5ZXIpLAogICAgICAgICAgICB0cnVlLAogICAgICAgICAgICBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTIpLAogICAgICAgICAgICBTVFJfVkVISUNMRV9SRUdfUEVORElOR19URUFNCiAgICAgICAgKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgaW5UMSA9IGFycmF5Q29udGFpbnNWZWhpY2xlKG1vZC5HZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0xKSwgZXZlbnRWZWhpY2xlKTsKICAgIGNvbnN0IGluVDIgPSBhcnJheUNvbnRhaW5zVmVoaWNsZShtb2QuR2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMiksIGV2ZW50VmVoaWNsZSk7CiAgICBjb25zdCB3YXNSZWdpc3RlcmVkID0gaW5UMSB8fCBpblQyOwoKICAgIC8vIENhY2hlZCBsYXN0IGRyaXZlciBmb3IgdGhpcyB2ZWhpY2xlIChpZiBhbnkpLgogICAgY29uc3QgcHJpb3JPd25lciA9IGdldExhc3REcml2ZXIoZXZlbnRWZWhpY2xlKTsgCgogICAgLy8gT25seSB0cnVzdCB0aGUgb3duZXIgaWYgdGhlIHBsYXllciBpcyBzdGlsbCB2YWxpZC4KICAgIGNvbnN0IHByaW9yT3duZXJWYWxpZCA9ICEhcHJpb3JPd25lciAmJiBtb2QuSXNQbGF5ZXJWYWxpZChwcmlvck93bmVyKTsgCgogICAgLy8gU2FtZSBwbGF5ZXIgcmUtZW50ZXJpbmcgdGhlaXIgbGFzdC1kcml2ZW4gdmVoaWNsZS4KICAgIGNvbnN0IGlzUmV0dXJuVG9TYW1lT3duZXIgPSBwcmlvck93bmVyVmFsaWQgJiYgKGdldE9iaklkKHByaW9yT3duZXIpID09PSBnZXRPYmpJZChldmVudFBsYXllcikpOyAKCiAgICAvLyBDdXJyZW50IHJlZ2lzdHJ5IHRlYW0gZm9yIHRoaXMgdmVoaWNsZSwgaWYgYW55LgogICAgY29uc3QgcmVnaXN0ZXJlZFRlYW0gPSBpblQxID8gVGVhbUlELlRlYW0xIDogKGluVDIgPyBUZWFtSUQuVGVhbTIgOiAwKTsgCgogICAgY29uc3QgaXNFbXB0eVZlaGljbGUgPSBpc1ZlaGljbGVFbXB0eUZvckVudHJ5KGV2ZW50VmVoaWNsZSwgZXZlbnRQbGF5ZXIpOwoKICAgIC8vIFRyYW5zZmVyIG9uIGVtcHR5IHZlaGljbGUgZW50cnksIG1pc3Npbmcgb3duZXIsIG9yIGNyb3NzLXRlYW0gcmVnaXN0cnkgbWlzbWF0Y2guCiAgICBjb25zdCBzaG91bGRUcmFuc2Zlck93bmVyc2hpcCA9IGlzRW1wdHlWZWhpY2xlIHx8ICFwcmlvck93bmVyVmFsaWQgfHwgKHJlZ2lzdGVyZWRUZWFtICE9PSAwICYmIHJlZ2lzdGVyZWRUZWFtICE9PSB0ZWFtTnVtKTsgCgogICAgLy8gUmVjb25jaWxlIGJhc2VsaW5lIHRlYW0gZm9yIHVub3duZWQgdmVoaWNsZXMgYmVmb3JlIGFwcGx5aW5nICJlbnRlciA9IGNsYWltL3N0ZWFsIi4KICAgIGlmICghcHJpb3JPd25lclZhbGlkKSB7CiAgICAgICAgY29uc3QgdmVoaWNsZU9iaklkID0gZ2V0T2JqSWQoZXZlbnRWZWhpY2xlKTsKICAgICAgICBsZXQgaW5mZXJyZWRCYXNlVGVhbSA9IHZlaGljbGVTcGF3bkJhc2VUZWFtQnlPYmpJZFt2ZWhpY2xlT2JqSWRdOwogICAgICAgIGlmIChpbmZlcnJlZEJhc2VUZWFtICE9PSBUZWFtSUQuVGVhbTEgJiYgaW5mZXJyZWRCYXNlVGVhbSAhPT0gVGVhbUlELlRlYW0yKSB7CiAgICAgICAgICAgIGluZmVycmVkQmFzZVRlYW0gPSBpbmZlckJhc2VUZWFtRnJvbVBvc2l0aW9uKG1vZC5HZXRPYmplY3RQb3NpdGlvbihldmVudFZlaGljbGUpKSBhcyBUZWFtSUQ7CiAgICAgICAgfQoKICAgICAgICBpZiAoaW5mZXJyZWRCYXNlVGVhbSA9PT0gVGVhbUlELlRlYW0xIHx8IGluZmVycmVkQmFzZVRlYW0gPT09IFRlYW1JRC5UZWFtMikgewogICAgICAgICAgICBjb25zdCByZWdpc3RlcmVkVGVhbSA9IGluVDEgPyBUZWFtSUQuVGVhbTEgOiAoaW5UMiA/IFRlYW1JRC5UZWFtMiA6IDApOwogICAgICAgICAgICBpZiAocmVnaXN0ZXJlZFRlYW0gIT09IGluZmVycmVkQmFzZVRlYW0pIHsKICAgICAgICAgICAgICAgIHJlZ2lzdGVyVmVoaWNsZVRvVGVhbShldmVudFZlaGljbGUsIGluZmVycmVkQmFzZVRlYW0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGlmIChzaG91bGRUcmFuc2Zlck93bmVyc2hpcCkgewogICAgICAgIHNldExhc3REcml2ZXIoZXZlbnRWZWhpY2xlLCBldmVudFBsYXllcik7CiAgICAgICAgcmVnaXN0ZXJWZWhpY2xlVG9UZWFtKGV2ZW50VmVoaWNsZSwgdGVhbU51bSk7CiAgICB9IGVsc2UgaWYgKCF3YXNSZWdpc3RlcmVkKSB7CiAgICAgICAgLy8gU2FmZXR5OiBlbnN1cmUgbWVtYmVyc2hpcCBleGlzdHMgZXZlbiBpZiB0aGUgcmVnaXN0cnkgZGVzeW5jZWQuCiAgICAgICAgcmVnaXN0ZXJWZWhpY2xlVG9UZWFtKGV2ZW50VmVoaWNsZSwgdGVhbU51bSk7CiAgICB9CgogICAgY29uc3QgdGVhbU5hbWVLZXkgPSBnZXRUZWFtTmFtZUtleSh0ZWFtTnVtKTsKCiAgICAvL1NlbmQgbm90aWZpY2F0aW9ucyBhcm91bmQgZGlmZmVyZW50IHZlaGljbGUgcmVnaXN0cmF0aW9uIGV2ZW50cyBzbyBwbGF5ZXJzIGNhbiBzcG90IGtub3duIGlzc3VlIHdpdGggVmVoaWNsZSBSZWdpc3RyYXRpb25zCiAgICBsZXQgbWVzc2FnZUtleTogbnVtYmVyID0gU1RSX1ZFSElDTEVfUkVHX05PX0NIQU5HRTsKICAgIGxldCBhcmcwOiBhbnkgPSBldmVudFBsYXllcjsKICAgIGxldCBhcmcxOiBhbnkgPSB0ZWFtTmFtZUtleTsKICAgIGlmICghd2FzUmVnaXN0ZXJlZCkgeyAvL05ldyBWZWhpY2xlCiAgICAgICAgbWVzc2FnZUtleSA9IG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy52ZWhpY2xlUmVnaXN0ZXJlZE5ldzsKICAgICAgICBhcmcwID0gdGVhbU5hbWVLZXk7CiAgICAgICAgYXJnMSA9IGV2ZW50UGxheWVyOwogICAgfSBlbHNlIGlmIChpc1JldHVyblRvU2FtZU93bmVyKSB7IC8vT2xkIFZlaGljbGUgU2FtZSBQbGF5ZXIKICAgICAgICBtZXNzYWdlS2V5ID0gKHJlZ2lzdGVyZWRUZWFtICE9PSAwICYmIHJlZ2lzdGVyZWRUZWFtICE9PSB0ZWFtTnVtKQogICAgICAgICAgICA/IFNUUl9WRUhJQ0xFX1NUT0xFTl9SRUdJU1RFUgogICAgICAgICAgICA6IG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy52ZWhpY2xlUmV0dXJuZWQ7CiAgICAgICAgYXJnMCA9IGV2ZW50UGxheWVyOwogICAgICAgIGFyZzEgPSB0ZWFtTmFtZUtleTsKICAgIH0gZWxzZSBpZiAoc2hvdWxkVHJhbnNmZXJPd25lcnNoaXApIHsgLy9PbGQgVmVoaWNsZSBEaWZmZXJlbnQgUGxheWVyCiAgICAgICAgbWVzc2FnZUtleSA9IChyZWdpc3RlcmVkVGVhbSAhPT0gMCAmJiByZWdpc3RlcmVkVGVhbSAhPT0gdGVhbU51bSkKICAgICAgICAgICAgPyBTVFJfVkVISUNMRV9TVE9MRU5fUkVHSVNURVIKICAgICAgICAgICAgOiBtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMudmVoaWNsZVJlUmVnaXN0ZXJlZDsKICAgICAgICBhcmcwID0gdGVhbU5hbWVLZXk7CiAgICAgICAgYXJnMSA9IGV2ZW50UGxheWVyOwogICAgfQoKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICBtb2QuTWVzc2FnZShtZXNzYWdlS2V5LCBhcmcwLCBhcmcxKSwKICAgICAgICB0cnVlLAogICAgICAgIG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMSksCiAgICAgICAgbWVzc2FnZUtleQogICAgKTsKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICBtb2QuTWVzc2FnZShtZXNzYWdlS2V5LCBhcmcwLCBhcmcxKSwKICAgICAgICB0cnVlLAogICAgICAgIG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMiksCiAgICAgICAgbWVzc2FnZUtleQogICAgKTsKCiAgICBoYW5kbGVPdmVydGltZVBsYXllckVudGVyVmVoaWNsZShldmVudFBsYXllciwgZXZlbnRWZWhpY2xlKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIE9uUGxheWVyRXhpdFZlaGljbGUoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsIGV2ZW50VmVoaWNsZTogbW9kLlZlaGljbGUpIHsKICAgIGlmICghbW9kLklzUGxheWVyVmFsaWQoZXZlbnRQbGF5ZXIpKSByZXR1cm47CiAgICBoYW5kbGVPdmVydGltZVBsYXllckV4aXRWZWhpY2xlKGV2ZW50UGxheWVyLCBldmVudFZlaGljbGUpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gRXhwb3J0ZWQgRXZlbnQgSGFuZGxlcnMgLSBWZWhpY2xlIEVudHJ5ICsgRXhpdCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gRXhwb3J0ZWQgRXZlbnQgSGFuZGxlcnMgLSBWZWhpY2xlIFNwYXduICsgRGVzdHJveSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gT25WZWhpY2xlU3Bhd25lZDoKLy8gUmVnaXN0ZXJzIGEgc3Bhd25lZCB2ZWhpY2xlIHRvIHRoZSBuZWFyZXN0IG1haW4gYmFzZSB0ZWFtIHVzaW5nIGl0cyB3b3JsZCBwb3NpdGlvbi4KZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIE9uVmVoaWNsZVNwYXduZWQoZXZlbnRWZWhpY2xlOiBtb2QuVmVoaWNsZSk6IFByb21pc2U8dm9pZD4gewogICAgLy8gQmluZCB2ZWhpY2xlIHRvIGEgc3Bhd25lciBzbG90IGZpcnN0OyBmYWxsIGJhY2sgdG8gYmFzZSBpbmZlcmVuY2UgaWYgbm90IHNwYXduZWQgYnkgb3VyIHNwYXduZXJzLgogICAgY29uc3QgcG9zT2JqZWN0ID0gbW9kLkdldE9iamVjdFBvc2l0aW9uKGV2ZW50VmVoaWNsZSk7CiAgICBsZXQgc2xvdEluZGV4ID0gLTE7CiAgICBjb25zdCBhY3RpdmVJbmRleCA9IFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduU2xvdEluZGV4OwogICAgY29uc3QgYWN0aXZlVG9rZW4gPSBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blRva2VuOwogICAgY29uc3QgYWN0aXZlQXQgPSBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blJlcXVlc3RlZEF0U2Vjb25kczsKICAgIGlmIChhY3RpdmVJbmRleCAhPT0gdW5kZWZpbmVkICYmIGFjdGl2ZVRva2VuICE9PSB1bmRlZmluZWQgJiYgYWN0aXZlQXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnN0IG5vdyA9IE1hdGguZmxvb3IobW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKSk7CiAgICAgICAgY29uc3QgZXhwaXJlZCA9IChub3cgLSBhY3RpdmVBdCkgPiBWRUhJQ0xFX1NQQVdORVJfQklORF9USU1FT1VUX1NFQ09ORFM7CiAgICAgICAgY29uc3QgYWN0aXZlU2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW2FjdGl2ZUluZGV4XTsKICAgICAgICBpZiAoIWV4cGlyZWQgJiYgYWN0aXZlU2xvdCAmJiBhY3RpdmVTbG90LmV4cGVjdGluZ1NwYXduICYmIGFjdGl2ZVNsb3Quc3Bhd25SZXF1ZXN0VG9rZW4gPT09IGFjdGl2ZVRva2VuKSB7CiAgICAgICAgICAgIHNsb3RJbmRleCA9IGFjdGl2ZUluZGV4OwogICAgICAgIH0KICAgIH0KICAgIGlmIChzbG90SW5kZXggPT09IC0xKSB7CiAgICAgICAgc2xvdEluZGV4ID0gZmluZFNwYXduZXJTbG90QnlQb3NpdGlvbihwb3NPYmplY3QpOwogICAgfQogICAgaWYgKHNsb3RJbmRleCA+PSAwKSB7CiAgICAgICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW3Nsb3RJbmRleF07CiAgICAgICAgaWYgKCFzbG90LmVuYWJsZWQpIHsKICAgICAgICAgICAgbW9kLlVuc3Bhd25PYmplY3QoZXZlbnRWZWhpY2xlKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoIXNsb3QuZXhwZWN0aW5nU3Bhd24gJiYgc2xvdC52ZWhpY2xlSWQgPT09IC0xKSB7CiAgICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIHNwYXduZXIncyBpbml0aWFsIGRlZmF1bHQgc3Bhd24gd2l0aCBhIGZvcmNlZCBzcGF3biB1c2luZyB0aGUgY29uZmlndXJlZCB0eXBlLgogICAgICAgICAgICBtb2QuVW5zcGF3bk9iamVjdChldmVudFZlaGljbGUpOwogICAgICAgICAgICBhd2FpdCBtb2QuV2FpdCgwLjEpOyAvLyBHaXZlIHRoZSBlbmdpbmUgYSBtb21lbnQgdG8gY2xlYXIgdGhlIHNwYXduIGJlZm9yZSBmb3JjaW5nIGFnYWluLgogICAgICAgICAgICBjb25maWd1cmVWZWhpY2xlU3Bhd25lcihzbG90LnNwYXduZXIsIHNsb3QudmVoaWNsZVR5cGUpOwogICAgICAgICAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgZm9yY2VTcGF3bldpdGhSZXRyeShzbG90SW5kZXgpOwogICAgICAgICAgICBpZiAoIXN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIHZvaWQgc2NoZWR1bGVCbG9ja2VkU3Bhd25SZXRyeShzbG90SW5kZXgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8vIFByaW1hcnkgcGF0aDogYmluZCB0byBhIHNwYXduZXIgc2xvdCB0aGF0IGlzIGV4cGVjdGluZyB0aGlzIHNwYXduLgogICAgbGV0IGluZmVycmVkVGVhbSA9IGJpbmRTcGF3bmVkVmVoaWNsZVRvU2xvdChldmVudFZlaGljbGUsIHBvc09iamVjdCk7CgogICAgaWYgKGluZmVycmVkVGVhbSA9PT0gMCkgewogICAgICAgIC8vIFJldHJ5IG9uY2UgYWZ0ZXIgYSBzaG9ydCBkZWxheSBpbiBjYXNlIHRoZSBzcGF3biBwb3NpdGlvbiBoYXNuJ3Qgc2V0dGxlZCB5ZXQuCiAgICAgICAgYXdhaXQgbW9kLldhaXQoMC4yKTsKICAgICAgICBjb25zdCBwb3NSZXRyeSA9IG1vZC5HZXRPYmplY3RQb3NpdGlvbihldmVudFZlaGljbGUpOwogICAgICAgIGluZmVycmVkVGVhbSA9IGJpbmRTcGF3bmVkVmVoaWNsZVRvU2xvdChldmVudFZlaGljbGUsIHBvc1JldHJ5KTsKICAgIH0KCiAgICBjb25zdCBwb3MgPSBtb2QuR2V0VmVoaWNsZVN0YXRlKGV2ZW50VmVoaWNsZSwgbW9kLlZlaGljbGVTdGF0ZVZlY3Rvci5WZWhpY2xlUG9zaXRpb24pOwogICAgY29uc3QgdmVoaWNsZU9iaklkID0gZ2V0T2JqSWQoZXZlbnRWZWhpY2xlKTsKCiAgICBpZiAoaW5mZXJyZWRUZWFtID09PSAwKSB7CiAgICAgICAgLy8gRmFsbGJhY2sgcGF0aDogYXNzaWduIHRvIHRoZSBuZWFyZXN0IG1haW4gYmFzZSBpZiB3aXRoaW4gYmluZCByYWRpdXMuCiAgICAgICAgaW5mZXJyZWRUZWFtID0gaW5mZXJCYXNlVGVhbUZyb21Qb3NpdGlvbihwb3MpOwoKICAgICAgICAvLyBJZiB0aGUgc3Bhd24gbWF0Y2hlZCBhIGtub3duIHNwYXduZXIgYnV0IGZhaWxlZCB0byBiaW5kLCBiaW5kIHRoZSBzbG90IGV4cGxpY2l0bHkuCiAgICAgICAgaWYgKHNsb3RJbmRleCA+PSAwKSB7CiAgICAgICAgICAgIGNvbnN0IHNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1tzbG90SW5kZXhdOwogICAgICAgICAgICBpZiAoc2xvdCAmJiBzbG90LmVuYWJsZWQgJiYgc2xvdC52ZWhpY2xlSWQgPT09IC0xKSB7CiAgICAgICAgICAgICAgICBzbG90LmV4cGVjdGluZ1NwYXduID0gZmFsc2U7CiAgICAgICAgICAgICAgICBzbG90LnZlaGljbGVJZCA9IHZlaGljbGVPYmpJZDsKICAgICAgICAgICAgICAgIHNsb3QucmVzcGF3blJ1bm5pbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHNsb3Quc3Bhd25SZXRyeVNjaGVkdWxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgU3RhdGUudmVoaWNsZXMudmVoaWNsZVRvU2xvdFt2ZWhpY2xlT2JqSWRdID0gc2xvdEluZGV4OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vIEJhaWwgb3V0IGlmIHRoZSB2ZWhpY2xlIGRpZG4ndCBzcGF3biBuZWFyIGEga25vd24gdGVhbSBiYXNlLgogICAgLy8gVW5hc3NpZ25lZCBzcGF3bnMgYXJlIG5vdCByZWdpc3RlcmVkIGFuZCB3aWxsIG5vdCBjb3VudCB0b3dhcmQgc2NvcmluZy9IVUQuCiAgICBpZiAoaW5mZXJyZWRUZWFtICE9PSBUZWFtSUQuVGVhbTEgJiYgaW5mZXJyZWRUZWFtICE9PSBUZWFtSUQuVGVhbTIpIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgLy8gQ2FjaGUgYmFzZS10ZWFtIGluZmVyZW5jZSBmb3IgbGF0ZXIgcmVjb25jaWxpYXRpb24gb24gZW50ZXIuCiAgICB2ZWhpY2xlU3Bhd25CYXNlVGVhbUJ5T2JqSWRbdmVoaWNsZU9iaklkXSA9IGluZmVycmVkVGVhbTsgCgogICAgLy8gUmVzZXQgY2FjaGVkIG93bmVyIHNvIGVudGVyIGV2ZW50cyBjYW4gZXN0YWJsaXNoIGEgbmV3IG93bmVyLgogICAgY2xlYXJMYXN0RHJpdmVyQnlWZWhpY2xlT2JqSWQodmVoaWNsZU9iaklkKTsgCgogICAgLy8gU3Bhd24tdGltZSByZWdpc3RyYXRpb24gaXMgYXV0aG9yaXRhdGl2ZSBvbmx5IGFmdGVyIGEgc2xvdCBiaW5kcyAoYmVmb3JlIGFueSBwbGF5ZXIgZW50ZXJzKS4KICAgIHJlZ2lzdGVyVmVoaWNsZVRvVGVhbShldmVudFZlaGljbGUsIGluZmVycmVkVGVhbSk7CgogICAgY29uc3QgdGVhbU5hbWVLZXkgPSBnZXRUZWFtTmFtZUtleShpbmZlcnJlZFRlYW0pOwogICAgY29uc3QgeCA9IE1hdGguZmxvb3IobW9kLlhDb21wb25lbnRPZihwb3MpKTsKICAgIGNvbnN0IHogPSBNYXRoLmZsb29yKG1vZC5aQ29tcG9uZW50T2YocG9zKSk7CiAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnZlaGljbGVTcGF3bmVkLCB0ZWFtTmFtZUtleSwgeCwgeiksCiAgICAgICAgdHJ1ZSwKICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnZlaGljbGVTcGF3bmVkCiAgICApOwp9CgovLyBPblZlaGljbGVEZXN0cm95ZWQ6Ci8vIEhhbmRsZXMgdmVoaWNsZS1kZXN0cnVjdGlvbiBzY29yaW5nIGxvZ2ljLgovLyBJZiB0aGUgZGVzdHJveWVkIHZlaGljbGUgaXMgcmVnaXN0ZXJlZCB0byBhIHRlYW0gQU5EIHRoZSByb3VuZCBpcyBMSVZFOgovLyAtIEF3YXJkICsxIFJvdW5kIEtpbGwgdG8gdGhlIG9wcG9zaW5nIHRlYW0uCi8vIC0gRW1pdCBpbmZvcm1hdGlvbmFsIHdvcmxkIGxvZyBtZXNzYWdlcy4KLy8gSWYgdGhlIHJvdW5kIGlzIG5vdCBsaXZlOgovLyAtIE5vIHBvaW50cyBhcmUgYXdhcmRlZDsgdGhlIHZlaGljbGUgaXMgc2ltcGx5IGRlcmVnaXN0ZXJlZC4KLy8gSW1wb3J0YW50OgovLyAtIEluZmFudHJ5IGRlYXRocyBhcmUgaWdub3JlZCBlbnRpcmVseS4KLy8gLSBUaGlzIGZ1bmN0aW9uIGlzIHRoZSBPTkxZIHBsYWNlIHJvdW5kIHZlaGljbGUga2lsbHMgYXJlIGF3YXJkZWQuCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBPblZlaGljbGVEZXN0cm95ZWQoZXZlbnRWZWhpY2xlOiBtb2QuVmVoaWNsZSkgewogICAgaGFuZGxlT3ZlcnRpbWVWZWhpY2xlRGVzdHJveWVkKGV2ZW50VmVoaWNsZSk7CiAgICBjb25zdCBpblQxID0gYXJyYXlDb250YWluc1ZlaGljbGUobW9kLkdldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTEpLCBldmVudFZlaGljbGUpOwogICAgY29uc3QgaW5UMiA9IGFycmF5Q29udGFpbnNWZWhpY2xlKG1vZC5HZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0yKSwgZXZlbnRWZWhpY2xlKTsKCiAgICAvLyBSZWdpc3RyYXRpb24gaXMgdGhlIHNjb3JpbmcgZ2F0ZTsgdW5yZWdpc3RlcmVkIHZlaGljbGVzIGFyZSBpZ25vcmVkLgogICAgaWYgKCFpblQxICYmICFpblQyKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGRlc3Ryb3llZFRlYW1OdW0gPSBpblQxID8gVGVhbUlELlRlYW0xIDogVGVhbUlELlRlYW0yOwogICAgY29uc3Qgc2NvcmluZ1RlYW1OdW0gPSBvcHBvc2luZ1RlYW0oZGVzdHJveWVkVGVhbU51bSk7CgogICAgaWYgKGlzUm91bmRMaXZlKCkpIHsKICAgICAgICBjb25zdCB2ZWhpY2xlT2JqSWQgPSBnZXRPYmpJZChldmVudFZlaGljbGUpOwogICAgICAgIC8vIE5PVEU6IHZlaGljbGVUb1Nsb3QgY2FuIGJlIGNsZWFyZWQgYnkgdGhlIHNwYXduZXIgcG9sbCBsb29wICgxcyB0aWNrKSBiZWZvcmUgdGhpcyBydW5zLgogICAgICAgIC8vIElmIHRoYXQgaGFwcGVucywgdGhlIGNhbXBlZCBsb2cgbWF5IGJlIHNraXBwZWQgZm9yIHRoYXQgZGVzdHJ1Y3Rpb24uCiAgICAgICAgY29uc3Qgc2xvdEluZGV4ID0gU3RhdGUudmVoaWNsZXMudmVoaWNsZVRvU2xvdFt2ZWhpY2xlT2JqSWRdOwogICAgICAgIGxldCB3YXNTcGF3bkNhbXBlZCA9IGZhbHNlOwogICAgICAgIGlmIChzbG90SW5kZXggIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbc2xvdEluZGV4XTsKICAgICAgICAgICAgaWYgKHNsb3QpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHNwYXduZXJQb3MgPSBzbG90LnNwYXduUG9zOwogICAgICAgICAgICAgICAgY29uc3QgZGVhdGhQb3MgPSBtb2QuR2V0VmVoaWNsZVN0YXRlKGV2ZW50VmVoaWNsZSwgbW9kLlZlaGljbGVTdGF0ZVZlY3Rvci5WZWhpY2xlUG9zaXRpb24pOwogICAgICAgICAgICAgICAgY29uc3QgZmFsbGJhY2tQb3MgPSBtb2QuR2V0T2JqZWN0UG9zaXRpb24oZXZlbnRWZWhpY2xlKTsKICAgICAgICAgICAgICAgIGxldCByZXNvbHZlZFBvcyA9IGRlYXRoUG9zOwogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIG1vZC5YQ29tcG9uZW50T2YoZGVhdGhQb3MpID09PSAwICYmCiAgICAgICAgICAgICAgICAgICAgbW9kLllDb21wb25lbnRPZihkZWF0aFBvcykgPT09IDAgJiYKICAgICAgICAgICAgICAgICAgICBtb2QuWkNvbXBvbmVudE9mKGRlYXRoUG9zKSA9PT0gMAogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRQb3MgPSBmYWxsYmFja1BvczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IGQgPSBtb2QuRGlzdGFuY2VCZXR3ZWVuKHJlc29sdmVkUG9zLCBzcGF3bmVyUG9zKTsKICAgICAgICAgICAgICAgIGlmIChkIDw9IFZFSElDTEVfQ0FNUEVEX0RJU1RBTkNFX01FVEVSUykgewogICAgICAgICAgICAgICAgICAgIHdhc1NwYXduQ2FtcGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZWFtTmFtZUtleSA9IGdldFRlYW1OYW1lS2V5KGRlc3Ryb3llZFRlYW1OdW0pOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHggPSBNYXRoLmZsb29yKG1vZC5YQ29tcG9uZW50T2YocmVzb2x2ZWRQb3MpKTsKICAgICAgICAgICAgICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy52ZWhpY2xlQ2FtcGVkSW5NYWluQmFzZSwgdGVhbU5hbWVLZXksIHgpLAogICAgICAgICAgICAgICAgICAgICAgICB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy52ZWhpY2xlQ2FtcGVkSW5NYWluQmFzZQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICghd2FzU3Bhd25DYW1wZWQpIHsKICAgICAgICAgICAgaWYgKHNjb3JpbmdUZWFtTnVtID09PSBUZWFtSUQuVGVhbTEpIHsKICAgICAgICAgICAgICAgIFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgPSBTdGF0ZS5zY29yZXMudDFSb3VuZEtpbGxzICsgMTsKICAgICAgICAgICAgfSBlbHNlIGlmIChzY29yaW5nVGVhbU51bSA9PT0gVGVhbUlELlRlYW0yKSB7CiAgICAgICAgICAgICAgICBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzID0gU3RhdGUuc2NvcmVzLnQyUm91bmRLaWxscyArIDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFVwZGF0ZSByb3VuZCBraWxscyBIVUQgaW1tZWRpYXRlbHkuCiAgICAgICAgICAgIHN5bmNSb3VuZEtpbGxzSHVkKCk7CgogICAgICAgICAgICAvLyBFbmQgdGhlIHJvdW5kIGltbWVkaWF0ZWx5IGlmIGEgdGVhbSByZWFjaGVzIHRoZSBjb25maWd1cmVkIHJvdW5kLWtpbGxzIHRhcmdldC4KICAgICAgICAgICAgaWYgKFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgPj0gU3RhdGUucm91bmQua2lsbHNUYXJnZXQgfHwgU3RhdGUuc2NvcmVzLnQyUm91bmRLaWxscyA+PSBTdGF0ZS5yb3VuZC5raWxsc1RhcmdldCkgewogICAgICAgICAgICAgICAgZW5kUm91bmQodW5kZWZpbmVkLCBnZXRSZW1haW5pbmdTZWNvbmRzKCkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2NvcmluZ1RlYW1OdW0gPT09IFRlYW1JRC5UZWFtMSkgewogICAgICAgICAgICAgICAgU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscyA9IE1hdGguZmxvb3IoU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscykgKyAxOwogICAgICAgICAgICB9IGVsc2UgaWYgKHNjb3JpbmdUZWFtTnVtID09PSBUZWFtSUQuVGVhbTIpIHsKICAgICAgICAgICAgICAgIFN0YXRlLnNjb3Jlcy50MlRvdGFsS2lsbHMgPSBNYXRoLmZsb29yKFN0YXRlLnNjb3Jlcy50MlRvdGFsS2lsbHMpICsgMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gVXBkYXRlIHRvcCBIVUQga2lsbHMgY291bnRlcnMuCiAgICAgICAgICAgIHN5bmNLaWxsc0h1ZEZyb21UcmFja2VkVG90YWxzKGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIG1vZC5TZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0xLCBhcnJheVJlbW92ZVZlaGljbGUobW9kLkdldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTEpLCBldmVudFZlaGljbGUpKTsKICAgICAgICBtb2QuU2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMiwgYXJyYXlSZW1vdmVWZWhpY2xlKG1vZC5HZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0yKSwgZXZlbnRWZWhpY2xlKSk7CgogICAgICAgIGNvbnN0IG93bmVyID0gcG9wTGFzdERyaXZlcihldmVudFZlaGljbGUpOwoKICAgICAgICAvLyBMZWdhY3kgZGVsYXkgcmVtb3ZlZDsgc2VuZCBraWxsIG1lc3NhZ2UgaW1tZWRpYXRlbHkgdG8gYXZvaWQgZGVmZXJyZWQgY3Jhc2ggd2luZG93LgogICAgICAgIC8vIGF3YWl0IG1vZC5XYWl0KDMuMCk7CgogICAgICAgIGlmICghd2FzU3Bhd25DYW1wZWQpIHsKICAgICAgICAgICAgY29uc3Qgcm91bmRLaWxscyA9IChzY29yaW5nVGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSA/IFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgOiBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzOwogICAgICAgICAgICBjb25zdCB0ZWFtTmFtZUtleSA9IChzY29yaW5nVGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSA/IGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMSkgOiBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTIpOwogICAgICAgICAgICBjb25zdCBvd25lck5hbWVPcktleSA9IG93bmVyCiAgICAgICAgICAgICAgICA/IChtb2QuSXNQbGF5ZXJWYWxpZChvd25lcikgPyBvd25lciA6IG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0udW5rbm93blBsYXllcikKICAgICAgICAgICAgICAgIDogbW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS51bmFzc2lnbmVkOwoKICAgICAgICAgICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnBvaW50QXdhcmRlZFdpdGhPd25lciwgdGVhbU5hbWVLZXksIG93bmVyTmFtZU9yS2V5LCBNYXRoLmZsb29yKHJvdW5kS2lsbHMpKSwKICAgICAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgICAgICBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTEpLAogICAgICAgICAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnBvaW50QXdhcmRlZFdpdGhPd25lcgogICAgICAgICAgICApOwogICAgICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMucG9pbnRBd2FyZGVkV2l0aE93bmVyLCB0ZWFtTmFtZUtleSwgb3duZXJOYW1lT3JLZXksIE1hdGguZmxvb3Iocm91bmRLaWxscykpLAogICAgICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgICAgIG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMiksCiAgICAgICAgICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMucG9pbnRBd2FyZGVkV2l0aE93bmVyCiAgICAgICAgICAgICk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm47CiAgICB9CgogICAgLy8gUm91bmQgaXMgbm90IGxpdmU6IGNsZWFuIHVwIHJlZ2lzdHJhdGlvbiwgYnV0IGRvIG5vdCBhd2FyZCBwb2ludHMgb3IgaW5jcmVtZW50IGNvdW50ZXJzLgogICAgbW9kLlNldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTEsIGFycmF5UmVtb3ZlVmVoaWNsZShtb2QuR2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMSksIGV2ZW50VmVoaWNsZSkpOwogICAgbW9kLlNldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTIsIGFycmF5UmVtb3ZlVmVoaWNsZShtb2QuR2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMiksIGV2ZW50VmVoaWNsZSkpOwoKICAgIGNvbnN0IG93bmVyID0gcG9wTGFzdERyaXZlcihldmVudFZlaGljbGUpOwoKICAgIC8vIExlZ2FjeSBkZWxheSByZW1vdmVkOyBzZW5kIGtpbGwgbWVzc2FnZSBpbW1lZGlhdGVseSB0byBhdm9pZCBkZWZlcnJlZCBjcmFzaCB3aW5kb3cuCiAgICAvLyBhd2FpdCBtb2QuV2FpdCgzLjApOwoKICAgIGNvbnN0IGRlc3Ryb3llZFRlYW1OYW1lS2V5ID0gKGRlc3Ryb3llZFRlYW1OdW0gPT09IFRlYW1JRC5UZWFtMSkgPyBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTEpIDogZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0yKTsKICAgIGNvbnN0IG93bmVyTmFtZU9yS2V5ID0gb3duZXIKICAgICAgICA/IChtb2QuSXNQbGF5ZXJWYWxpZChvd25lcikgPyBvd25lciA6IG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0udW5rbm93blBsYXllcikKICAgICAgICA6IG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0udW5hc3NpZ25lZDsKCiAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnZlaGljbGVEZXN0cm95ZWROb3RMaXZlLCBvd25lck5hbWVPcktleSwgZGVzdHJveWVkVGVhbU5hbWVLZXkpLAogICAgICAgIHRydWUsCiAgICAgICAgbW9kLkdldFRlYW0oVGVhbUlELlRlYW0xKSwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMudmVoaWNsZURlc3Ryb3llZE5vdExpdmUKICAgICk7CiAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnZlaGljbGVEZXN0cm95ZWROb3RMaXZlLCBvd25lck5hbWVPcktleSwgZGVzdHJveWVkVGVhbU5hbWVLZXkpLAogICAgICAgIHRydWUsCiAgICAgICAgbW9kLkdldFRlYW0oVGVhbUlELlRlYW0yKSwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMudmVoaWNsZURlc3Ryb3llZE5vdExpdmUKICAgICk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBFeHBvcnRlZCBFdmVudCBIYW5kbGVycyAtIFZlaGljbGUgU3Bhd24gKyBEZXN0cm95IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBFbnRlci9FeGl0IFRyaWdnZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBDYXB0dXJlUG9pbnQgdGljazoga2VlcCBlbmdpbmUgY2FwdHVyZSBzdXBwcmVzc2VkIHdoaWxlIHdlIHVzZSBDUHMgYXMgbWFya2VycyBvbmx5LgpleHBvcnQgZnVuY3Rpb24gT25nb2luZ0NhcHR1cmVQb2ludChldmVudENhcHR1cmVQb2ludDogbW9kLkNhcHR1cmVQb2ludCk6IHZvaWQgewogICAgdHJ5IHsKICAgICAgICBpZiAoIWV2ZW50Q2FwdHVyZVBvaW50KSByZXR1cm47CiAgICAgICAgaWYgKCFTdGF0ZS5mbGFnLmNvbmZpZ1ZhbGlkKSByZXR1cm47CiAgICAgICAgaWYgKFN0YXRlLmZsYWcuc3RhZ2UgPCBPdmVydGltZVN0YWdlLlZpc2libGUpIHJldHVybjsKICAgICAgICBpZiAoIWlzQWN0aXZlT3ZlcnRpbWVDYXB0dXJlUG9pbnQoZXZlbnRDYXB0dXJlUG9pbnQpKSByZXR1cm47CiAgICAgICAgYXBwbHlPdmVydGltZUNhcHR1cmVQb2ludFN1cHByZXNzaW9uKGV2ZW50Q2FwdHVyZVBvaW50KTsKICAgICAgICBzZXRPdmVydGltZUNhcHR1cmVQb2ludE93bmVyKGV2ZW50Q2FwdHVyZVBvaW50LCAwKTsKICAgIH0gY2F0Y2ggewogICAgICAgIHJldHVybjsKICAgIH0KfQoKZXhwb3J0IGZ1bmN0aW9uIE9uUGxheWVyRW50ZXJBcmVhVHJpZ2dlcihldmVudFBsYXllcjogbW9kLlBsYXllciwgZXZlbnRBcmVhVHJpZ2dlcjogbW9kLkFyZWFUcmlnZ2VyKSB7CiAgICB0cnkgewogICAgICAgIGlmICghZXZlbnRQbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKGV2ZW50UGxheWVyKSkgcmV0dXJuOwoKICAgICAgICBjb25zdCB0cmlnZ2VySWQgPSBzYWZlR2V0T2JqSWQoZXZlbnRBcmVhVHJpZ2dlcik7CiAgICAgICAgaWYgKHRyaWdnZXJJZCA9PT0gdW5kZWZpbmVkKSByZXR1cm47CiAgICAgICAgaWYgKFN0YXRlLmZsYWcuYWN0aXZlQXJlYVRyaWdnZXJJZCAhPT0gdW5kZWZpbmVkICYmIHRyaWdnZXJJZCA9PT0gU3RhdGUuZmxhZy5hY3RpdmVBcmVhVHJpZ2dlcklkKSB7CiAgICAgICAgICAgIC8vIE92ZXJ0aW1lIHpvbmVzIGFyZSBBcmVhVHJpZ2dlci1kcml2ZW47IHRyYWNraW5nIGlzIGVuYWJsZWQgZnJvbSByb3VuZCBzdGFydC4KICAgICAgICAgICAgaWYgKG1vZC5Jc1BsYXllclZhbGlkKGV2ZW50UGxheWVyKSkgewogICAgICAgICAgICAgICAgaGFuZGxlT3ZlcnRpbWVQbGF5ZXJFbnRlclpvbmUoZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoSXNQbGF5ZXJJbk93bk1haW5CYXNlKGV2ZW50UGxheWVyLCBldmVudEFyZWFUcmlnZ2VyKSkgewogICAgICAgICAgICAvLyB0cmFjayBwZXItcGxheWVyIG1haW4gYmFzZSBzdGF0ZSBmb3IgVUkgZGlzcGxheSAoYXV0aG9yaXRhdGl2ZSBnYXRpbmcgY29tZXMgbGF0ZXIpLgogICAgICAgICAgICBTdGF0ZS5wbGF5ZXJzLmluTWFpbkJhc2VCeVBpZFttb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpXSA9IHRydWU7CiAgICAgICAgICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yQWxsVmlzaWJsZVZpZXdlcnMoKTsKICAgICAgICAgICAgQnJvYWRjYXN0TWFpbkJhc2VFdmVudChTVFJfRU5URVJFRF9NQUlOX0JBU0UsIGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgUmVzdG9ja0dhZGdldEFtbW8oZXZlbnRQbGF5ZXIsIFJFU1RPQ0tfTUFHX0FNTU9fRU5URVIpOwogICAgICAgICAgICBOb3RpZnlBbW1vUmVzdG9ja2VkKGV2ZW50UGxheWVyKTsKICAgICAgICB9CiAgICB9IGNhdGNoIHsKICAgICAgICByZXR1cm47CiAgICB9Cn0KCmV4cG9ydCBmdW5jdGlvbiBPblBsYXllckV4aXRBcmVhVHJpZ2dlcihldmVudFBsYXllcjogbW9kLlBsYXllciwgZXZlbnRBcmVhVHJpZ2dlcjogbW9kLkFyZWFUcmlnZ2VyKSB7CiAgICB0cnkgewogICAgICAgIGlmICghZXZlbnRQbGF5ZXIgfHwgIW1vZC5Jc1BsYXllclZhbGlkKGV2ZW50UGxheWVyKSkgcmV0dXJuOwoKICAgICAgICBjb25zdCB0cmlnZ2VySWQgPSBzYWZlR2V0T2JqSWQoZXZlbnRBcmVhVHJpZ2dlcik7CiAgICAgICAgaWYgKHRyaWdnZXJJZCA9PT0gdW5kZWZpbmVkKSByZXR1cm47CiAgICAgICAgaWYgKFN0YXRlLmZsYWcuYWN0aXZlQXJlYVRyaWdnZXJJZCAhPT0gdW5kZWZpbmVkICYmIHRyaWdnZXJJZCA9PT0gU3RhdGUuZmxhZy5hY3RpdmVBcmVhVHJpZ2dlcklkKSB7CiAgICAgICAgICAgIC8vIE92ZXJ0aW1lIHpvbmVzIGFyZSBBcmVhVHJpZ2dlci1kcml2ZW47IHRyYWNraW5nIGlzIGVuYWJsZWQgZnJvbSByb3VuZCBzdGFydC4KICAgICAgICAgICAgaWYgKG1vZC5Jc1BsYXllclZhbGlkKGV2ZW50UGxheWVyKSkgewogICAgICAgICAgICAgICAgaGFuZGxlT3ZlcnRpbWVQbGF5ZXJFeGl0Wm9uZShldmVudFBsYXllcik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChldmVudFBsYXllcikpIHJldHVybjsKCiAgICAgICAgaWYgKElzUGxheWVySW5Pd25NYWluQmFzZShldmVudFBsYXllciwgZXZlbnRBcmVhVHJpZ2dlcikpIHsKICAgICAgICAgICAgU3RhdGUucGxheWVycy5pbk1haW5CYXNlQnlQaWRbbW9kLkdldE9iaklkKGV2ZW50UGxheWVyKV0gPSBmYWxzZTsKICAgICAgICAgICAgLy8gUHJlLXJvdW5kIGdhdGluZzo6IGlmIHRoZSByb3VuZCBpcyBOT1QgYWN0aXZlLCBsZWF2aW5nIHRoZSBtYWluIGJhc2UgZm9yY2VzIHRoZSBwbGF5ZXIgYmFjayB0byBOT1QgUkVBRFkuCiAgICAgICAgICAgIGlmICghaXNSb3VuZExpdmUoKSkgewogICAgICAgICAgICAgICAgU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW21vZC5HZXRPYmpJZChldmVudFBsYXllcildID0gZmFsc2U7CiAgICAgICAgICAgICAgICAvLyBLZWVwIHRoZSBIVUQgIlggLyBZIFBMQVlFUlMgUkVBRFkiIGxpbmUgaW4gc3luYyB3aGVuIGxlYXZpbmcgbWFpbiBiYXNlIGZvcmNlcyBOT1QgUkVBRFkuCiAgICAgICAgICAgICAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgICAgICAgICAgICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yUGxheWVyKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgICAgIGlmIChTdGF0ZS5yb3VuZC5jb3VudGRvd24uaXNSZXF1ZXN0ZWQpIHsKICAgICAgICAgICAgICAgICAgICBjYW5jZWxQcmVnYW1lQ291bnRkb3duKCk7CiAgICAgICAgICAgICAgICAgICAgdm9pZCBzaG93T3ZlckxpbmVNZXNzYWdlRm9yQWxsUGxheWVycyhldmVudFBsYXllcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBQbGF5ZXItb25seSB3YXJuaW5nOiB0aGV5IHdlcmUgcmVhZHksIGJ1dCBsZWZ0IG1haW4gYmFzZSBiZWZvcmUgdGhlIHJvdW5kIHdlbnQgbGl2ZS4KICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgaW50ZW50aW9uYWxseSBub3QgYnJvYWRjYXN0IGdsb2JhbGx5OyBpdCBpcyBhY3Rpb25hYmxlIGd1aWRhbmNlIGZvciB0aGUgaW5kaXZpZHVhbCBwbGF5ZXIuCiAgICAgICAgICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX1JFQURZVVBfUkVUVVJOX1RPX0JBU0VfTk9UX0xJVkUsIE1hdGguZmxvb3IoU3RhdGUucm91bmQuY3VycmVudCkpLAogICAgICAgICAgICAgICAgICAgIGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgICAgICAgICAgICAgIFNUUl9SRUFEWVVQX1JFVFVSTl9UT19CQVNFX05PVF9MSVZFCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yQWxsVmlzaWJsZVZpZXdlcnMoKTsKICAgICAgICAgICAgQnJvYWRjYXN0TWFpbkJhc2VFdmVudChTVFJfRVhJVEVEX01BSU5fQkFTRSwgZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICBSZXN0b2NrR2FkZ2V0QW1tbyhldmVudFBsYXllciwgUkVTVE9DS19NQUdfQU1NT19FWElUKTsKICAgICAgICAgICAgTm90aWZ5QW1tb1Jlc3RvY2tlZChldmVudFBsYXllcik7CiAgICAgICAgfQogICAgfSBjYXRjaCB7CiAgICAgICAgcmV0dXJuOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gRW50ZXIvRXhpdCBUcmlnZ2VycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gRU9GIE1ldGFkYXRhIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBFT0YgdmVyc2lvbjogMC42MjEgfCBEYXRlOiAwMi4wNy4yNiB8IFRpbWU6IDE2OjUyIFVUQwoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEVPRiBNZXRhZGF0YSAtLS0tLS0tLS0tLS0tLS0tLS0tLQo=","compiled":""},"attachmentType":2,"errors":[]},{"id":"51f557aa-dba2-4c78-af77-0e8cf0914d01","version":"345","filename":"Strings.json","isProcessable":false,"processingStatus":2,"attachmentData":{"original":"eyJ0d2wiOnsiaHVkIjp7ImJyYW5kaW5nIjp7InRpdGxlIjoidGVhbXdhcmZhcmUgLiBuZXQgfCBUV0wgSGVsaXMgKHYwLjYyMSkiLCJzdWJ0aXRsZSI6Ik1pcmFrIFZhbGxleSBFeHBlcmllbmNlIENvZGU6IFogUSBYIEQgWSJ9LCJyb3VuZFRleHQiOiJST1VORCIsImhlbHBUZXh0IjoiU3RhbmQgc3RpbGwsIHRoZW4gdHJpcGxlIHRhcCB5b3VyIGludGVyYWN0IGtleWJpbmQgdG8gJ1JlYWR5IFVwJyBvciBjb25maWd1cmUgTWF0Y2ggU2V0dGluZ3MiLCJzcGF3bkRpc2FibGVkTGl2ZSI6IlNQQVdOSU5HIERJU0FCTEVEIERVUklORyBMSVZFIFJPVU5EIiwicmVhZHlUZXh0IjoiWW91IGFyZSBSZWFkeSIsImF1dG9SZWFkeVRleHQiOiJZb3UgYXJlIEF1dG8tUmVhZHkiLCJhdXRvUmVhZHlIZWxwVGV4dCI6IllvdSBlbmFibGVkIEF1dG8tUmVhZHk6IEdldCBpbiB5b3VyIHZlaGljbGUgaW5zaWRlIHlvdXIgbWFpbiBiYXNlIHRvIGJlIGZsYWdnZWQgYXMgUmVhZHkiLCJsYWJlbHMiOnsidG90YWxLaWxscyI6IlRvdGFsIEtpbGxzIiwicm91bmRLaWxscyI6IlJvdW5kIEtpbGxzIiwicm91bmRLaWxsc1dpdGhSb3VuZEZvcm1hdCI6IlJvdW5kIHswfSBLaWxscyIsInJvdW5kV2lucyI6IlJvdW5kIFdpbnMifSwicm91bmRTdGF0ZUZvcm1hdCI6InswfSB7MX0gezJ9Iiwicm91bmRTdGF0ZUxpdmUiOiJMSVZFIiwicm91bmRTdGF0ZU5vdFJlYWR5IjoiTk9UIFJFQURZIiwicm91bmRTdGF0ZUdhbWVPdmVyIjoiR0FNRSBPVkVSIiwicm91bmRSZWNvcmRGb3JtYXQiOiJ7MH0gLSB7MX0gLSB7Mn0iLCJyb3VuZExpdmVIZWxwRm9ybWF0IjoiRmlyc3QgdG8gezB9IFZlaGljbGUgS2lsbHMgV2lucyB0aGUgUm91bmQiLCJwbGF5ZXJzUmVhZHlGb3JtYXQiOiJ7MH0gLyB7MX0gUExBWUVSUyBSRUFEWSIsInZlaGljbGVzQWxpdmVGb3JtYXQiOiJ7MH0gVmVoaWNsZXMgQWxpdmUiLCJjbG9jayI6eyJkaWdpdCI6InswfSIsImNvbG9uIjoiOiJ9LCJzZXR0aW5ncyI6eyJnYW1lTW9kZUZvcm1hdCI6IkdhbWUgTW9kZTogezB9IiwiYWlyY3JhZnRDZWlsaW5nRm9ybWF0IjoiQWlyY3JhZnQgQ2VpbGluZzogezB9IiwidmVoaWNsZXNUZWFtRm9ybWF0IjoiVmVoaWNsZXMgezB9OiB7MX0iLCJ2ZWhpY2xlc01hdGNodXBGb3JtYXQiOiJWZWhpY2xlczogezB9dnsxfSIsInBsYXllcnNGb3JtYXQiOiJQbGF5ZXJzOiB7MH12ezF9IiwiZ2FtZU1vZGVEZWZhdWx0IjoiSGVsaXMgT25seSAtIEJGNiBWYW5pbGxhIiwidmFsdWVEZWZhdWx0IjoiRGVmYXVsdCIsInZhbHVlTWFwRGVmYXVsdCI6Ik1hcCBEZWZhdWx0In19LCJyb3VuZEVuZCI6eyJkcmF3IjoiRFJBVyIsInJvdW5kTnVtYmVyIjoiUk9VTkQgezB9IiwiZGV0YWlsIjp7IndpbkVsaW1pbmF0aW9uIjoiV0UgRUxJTUlOQVRFRCBUSEUgRU5FTVkgVEVBTSIsImxvc2VFbGltaW5hdGlvbiI6IlRIRSBFTkVNWSBFTElNSU5BVEVEIE9VUiBURUFNIiwid2luT2JqZWN0aXZlQ2FwdHVyZWQiOiJXRSBTRUNVUkVEIFRIRSBPQkpFQ1RJVkUiLCJsb3NlT2JqZWN0aXZlQ2FwdHVyZWQiOiJUSEUgRU5FTVkgU0VDVVJFRCBUSEUgT0JKRUNUSVZFIiwid2luT2JqZWN0aXZlUHJvZ3Jlc3MiOiJUSU1FIE9WRVI6IFdFIFNFQ1VSRUQgVEhFIE1PU1QgT0JKRUNUSVZFIFBST0dSRVNTIC0gezB9JSIsImxvc2VPYmplY3RpdmVQcm9ncmVzcyI6IlRJTUUgT1ZFUjogVEhFIEVORU1ZIFNFQ1VSRUQgVEhFIE1PU1QgT0JKRUNUSVZFIFBST0dSRVNTIC0gezB9JSIsIndpblRpbWVPdmVyS2lsbHMiOiJUSU1FIE9WRVI6IFdFIEVMSU1JTkFURUQgTU9SRSBFTkVNSUVTIiwibG9zZVRpbWVPdmVyS2lsbHMiOiJUSU1FIE9WRVI6IFRIRSBFTkVNWSBFTElNSU5BVEVEIE1PUkUgT0YgVVMiLCJkcmF3RXZlbkVsaW1zIjoiVElNRSBPVkVSOiBXRSBBUkUgRVZFTiBJTiBFTElNSU5BVElPTlMiLCJkcmF3Tm9BY3Rpb24iOiJUSU1FIE9WRVI6IE5PIE9ORSBESUQgQU5ZVEhJTkcgT0YgTk9URSJ9fSwicm91bmRTdGFydCI6eyJ0aXRsZSI6IkVMSU1JTkFURSBUSEUgRU5FTVkgVEVBTSIsInN1YnRpdGxlIjoiTk8gVkVISUNMRSBSRURFUExPWVMgLSBPTkUgVkVISUNMRSBQRVIgUk9VTkQifSwiZmxhZ0NhcHR1cmUiOnsidGl0bGUiOiJPQkpFQ1RJVkUiLCJsb2NrZWRUaXRsZUZvcm1hdCI6Ik9CSkVDVElWRSB7MH0gLSBVTkxPQ0tTIElOIHsxfVMiLCJhY3RpdmVUaXRsZUZvcm1hdCI6Ik9CSkVDVElWRSB7MH0iLCJhY3RpdmF0ZXNJbkZvcm1hdCI6IklOU0lERSBPQkpFQ1RJVkUgLSBMT0NLRUQiLCJzdGF0dXMiOnsiY2FwdHVyaW5nIjoiV0lOTklORyIsImxvc2luZyI6IkxPU0lORyIsInN0YWxsZWQiOiJDT05URVNURUQiLCJyZXNldHRpbmciOiJSRVNFVFRJTkcifSwiY291bnRzIjp7ImxlZnRGb3JtYXQiOiJ7MH0iLCJyaWdodEZvcm1hdCI6InswfSJ9LCJwcm9ncmVzcyI6eyJmb3JtYXQiOiJ7MH0lIn0sInByZXZpZXdBY3RpdmVGb3JtYXQiOiJDQVBUVVJFIiwidmVoaWNsZVJlcXVpcmVkIjoiVmVoaWNsZSBuZWVkZWQgdG8gY2FwdHVyZSBvYmplY3RpdmUhIiwibGV0dGVycyI6eyJ1bmtub3duIjoiPyIsIkEiOiJBIiwiQiI6IkIiLCJDIjoiQyIsIkQiOiJEIiwiRSI6IkUiLCJGIjoiRiIsIkciOiJHIiwiSCI6IkgifX0sIm92ZXJ0aW1lIjp7InRpdGxlIjp7InZpc2libGUiOiJPQkpFQ1RJVkUgJ3swfScgV0FTIFJBTkRPTUxZIENIT1NFTiBBUyBUSEUgVElFLUJSRUFLRVIhIiwidmlzaWJsZUFkbWluIjoiT0JKRUNUSVZFICd7MH0nIFdBUyBQSUNLRUQgVEhST1VHSCBBTiBBRE1JTiBPVkVSUklERSJ9LCJzdWJ0aXRsZSI6eyJub3RpY2UiOiJ7MH06ezF9ezJ9IFJlbWFpbmluZyIsInVubG9ja3NJbiI6IklOIENBUFRVUkUgUkFESVVTIChMT0NLRUQpIiwidW5sb2Nrc05vdyI6IlNFQ1VSRSBPQkpFQ1RJVkUgJ3swfScgQkVGT1JFIFRIRSBFTkVNWSEgKE9SIEpVU1QgS0lMTCBUSEVNKSJ9fSwib3ZlckxpbmUiOnsidGl0bGUiOiJ7MH0gSVMgT1ZFUiBUSEUgTElORSEiLCJzdWJ0aXRsZSI6IkV2ZXJ5b25lIG11c3QgcmV0dXJuIHRvIHRoZWlyIG1haW4gYmFzZSBhbmQgcmVhZHkgYmFjayB1cC4iLCJ0YWtlb2ZmVGl0bGUiOiJ7MH0gVE9PSyBPRkYgVE9PIFNPT04hIiwidGFrZW9mZlN1YnRpdGxlIjoiRXZlcnlvbmUgbXVzdCBsYW5kIGluIHRoZWlyIG1haW4gYmFzZSBhbmQgcmVhZHkgYmFjayB1cC4ifSwidGVhbXMiOnsiV0VTVCI6IldFU1QiLCJFQVNUIjoiRUFTVCIsIk5PUlRIIjoiTk9SVEgiLCJTT1VUSCI6IlNPVVRIIn0sIm1hcHMiOnsiYmxhY2t3ZWxsRmllbGRzIjoiQmxhY2t3ZWxsIEZpZWxkcyIsImRlZmVuc2VOZXh1cyI6IkRlZmVuc2UgTmV4dXMiLCJnb2xmQ291cnNlIjoiR29sZiBDb3Vyc2UiLCJtaXJha1ZhbGxleSI6Ik1pcmFrIFZhbGxleSIsIm9wZXJhdGlvbkZpcmVzdG9ybSI6Ik9wZXJhdGlvbiBGaXJlc3Rvcm0iLCJsaWJlcmF0aW9uUGVhayI6IkxpYmVyYXRpb24gUGVhayIsIm1hbmhhdHRhbkJyaWRnZSI6Ik1hbmhhdHRhbiBCcmlkZ2UiLCJzb2Jla0NpdHkiOiJTb2JlayBDaXR5IiwiYXJlYTIyQiI6IkFyZWEgMjJCIn0sIm5vdGlmaWNhdGlvbnMiOnsiYW1tb1Jlc3RvY2tlZCI6IllvdXIgZ2FkZ2V0IGFtbW8gaXMgcmVzdG9ja2VkIiwiZW50ZXJlZE1haW5CYXNlIjoiezB9IGVudGVyZWQgdGhlaXIgbWFpbiBiYXNlIiwiZXhpdGVkTWFpbkJhc2UiOiJ7MH0gZXhpdGVkIHRoZWlyIG1haW4gYmFzZSIsInJlYWR5dXBSZXR1cm5Ub0Jhc2VOb3RMaXZlIjoiUmV0dXJuIHRvIG1haW4gYmFzZSBhbmQgcmVhZHkgYmFjayB1cCAtIFJvdW5kIHswfSBpcyBub3QgbGl2ZSEiLCJhdXRvUmVhZGllZFVwIjoiezB9IGhhcyBhdXRvLXJlYWRpZWQgdXAiLCJyb3VuZEVuZFRpZSI6IlJvdW5kIGVuZGVkOiBUaWUgezB9LXsxfS4iLCJyb3VuZEVuZFdpbiI6InswfSB3aW5zIHsxfS17Mn0uIiwicm91bmRPdmVyUmVkZXBsb3lpbmciOiJSb3VuZCBvdmVyLCByZWRlcGxveWluZyB0byByZXNldCBpbiB7MH1zLi4uIiwicm91bmRTdGFydGVkIjoiUm91bmQgc3RhcnRlZC4iLCJyb3VuZFdpbnMiOiJDdXJyZW50IHJvdW5kIHNjb3JlIGlzIHswfS17MX0iLCJ0ZWFtU3dpdGNoIjoiWW91IGhhdmUgc3dpdGNoZWQgdGVhbXMhIiwicm91bmRDbGVhbnVwU3Bhd25UaW1lb3V0IjoiU3Bhd24gdGltZW91dCBhZnRlciB7MH1zIC0gZGVwbG95aW5nIGFueXdheS4iLCJwbGF5ZXJSZWFkaWVkVXAiOiJ7MH0gaGFzIHJlYWRpZWQgdXA6IHsxfSAvIHsyfSBQbGF5ZXJzIFJlYWR5In0sImpvaW5Qcm9tcHQiOnsidGl0bGUiOiJUV0wgUHJlc2VudHM6IFZlaGljbGUgT25seSBDb21iYXQiLCJib2R5Ijp7Im1hbmRhdG9yeTEiOiJJTVBPUlRBTlQ6IHRvIHN0YXJ0IHRoZSBnYW1lLi4uXG4gLSBXaGlsZSBvbiBmb290OiBzdGFuZCBzdGlsbCEgVGhlbiBUUklQTEUgVEFQIFlPVVIgSU5URVJBQ1QgS0VZQklORCB3aXRoaW4gMiBzZWNvbmRzXG4gLSBUaGUgaW50ZXJhY3Qga2V5YmluZCBkZWZhdWx0cyB0byAnRScgb24gUENcbiAtIEZvciBjb25zb2xlczogaW50ZXJhY3QgZGVmYXVsdHMgdG8gJ1NxdWFyZScgKFBTNSkgb3IgJ1gnIChYLUJveClcblxuSWYgeW91IGhhdmUgaXNzdWVzIHdpdGggdGhpcywgZW5zdXJlIHlvdXIgaW50ZXJhY3Qga2V5YmluZCBpcyBzZXQgdG8gJ3RhcCcsIG5vdCAnaG9sZCc6XG5TZXR0aW5ncyA+IENvbnRyb2xsZXIgPiBJbmZhbnRyeSA+IEVkaXQgU2V0dGluZ3MgPiBJbmZhbnRyeSA+IEVkaXQgQ29udHJvbCBTZXR0aW5ncyA+IE90aGVyXG4gLSBFbnN1cmUgdGhhdCB5b3VyIFwiSW50ZXJhY3RcIiBpcyBzZXQgdG8gXCJUYXBcIi5cbiAtIElmIHRoaXMgU1RJTEwgZG9lcyBub3Qgd29yayBmb3IgeW91LCBpbnRlcmFjdCBpcyBpbW1lZGlhdGVseSBhdmFpbGFibGUgb24gcmVzcGF3biBvbmx5LlxuXG5UaGlzIGRpYWxvZyB3aWxsIGNvbnRpbnVlIHRvIHNob3cuLi5cbi4uLnVudGlsIHlvdSBzdWNjZXNzZnVsbHkgdHJpcGxlIHRhcCBpbnRlcmFjdC4iLCJtYW5kYXRvcnkyIjoiXG5UaXAgMjogVGhpcyBpcyByb3VuZCBiYXNlZCBWZWhpY3VsYXIgQ29tYmF0OlxuIC0gJ1JlYWR5IFVwJyB0byBzdGFydCB0aGUgZ2FtZS4gRG9uJ3QgbGVhdmUgdGhlIG1haW4gYmFzZSB1bnRpbCBjb3VudGRvd24gZW5kcy4uLlxuIC0gRXZlcnlvbmUgZ2V0cyAxIGxpZmUsIGFuZCAxIHZlaGljbGUgb25seSFcbiAtIFJvdW5kcyBhcmUgNSBtaW51dGVzIGxvbmcuXG4gLSBJdCdzIGEgXCJCZXN0IG9mIFhcIiBmb3JtYXQsIHlvdSBkZWNpZGUgaG93IG1hbnkgUm91bmRzIHRvIHBsYXkgKERlZmF1bHQ6IDMpLlxuIC0gTWFwIHZpY3RvcnkgaXMgZGVjaWRlZCBieSByb3VuZHMgd29uIChlLmcuIGlmIHlvdSB3aW4gMiBvdXQgb2YgMyByb3VuZHMpLlxuIC0gT24gdGhlIGxhc3Qgcm91bmQsIGZpZ2h0IGZvciB0aGUgT2JqZWN0aXZlIGlmIDE6MDAgcmVtYWlucyBvbiB0aGUgUm91bmQgY2xvY2suIiwidGlwMyI6IlRpcCAzOiBUaWUtQnJlYWtlciBPYmplY3RpdmUgKEgpIGlzIHZpc2libGUgYmVmb3JlIFJvdW5kczpcbiAtIFRoaXMgb25lIFRpZS1CcmVha2VyIE9iamVjdGl2ZSBieSBkZWZhdWx0IG9ubHkgYXBwZWFycyBpbiB0aGUgTEFTVCBST1VORC5cbiAtIFRoZSBvYmplY3RpdmUgdW5sb2NrcyB3aXRoIDE6MDAgcmVtYWluaW5nIGFuZCBiZWNvbWVzIGNhcHR1cmFibGUuXG4gICAgLSBDYXB0dXJpbmcgYXdhcmRzIGEgUm91bmQgd2luIGlmIGJvdGggdGVhbXMgYXJlIHN0aWxsIGFsaXZlLlxuIC0gVmVoaWNsZXMgYXJlIHJlcXVpcmVkIHRvIGNhcHR1cmUgdGhlIFRpZS1CcmVha2VyIE9iamVjdGl2ZS5cbiAtIElmIHRoZSBSb3VuZCBjbG9jayBlbmRzIGF0IDA6MDAsIHJlc3VsdHMgd2l0aCBUaWUtQnJlYWtlcnMgYXJlOlxuICAgICAxOiBNb3JlIG9iamVjdGl2ZSBwcm9ncmVzcyAoaW5kaWNhdGVkIGJ5IHByb2dyZXNzIGJhciBhbmQgY3Jvd24gaWNvbikuXG4gICAgIDI6IElmIGVxdWFsIG9iamVjdGl2ZSBwcm9ncmVzczogd2hvZXZlciBoYXMgbW9yZSBraWxscy5cbiAgICAgMzogSWYgZXF1YWwgb2JqZWN0aXZlIHByb2dyZXNzIGFuZCBraWxscyBhcmUgdGllZDogUm91bmQgRHJhdy4iLCJ0aXA0IjoiVGlwIDQ6IFRoaXMgZXhwZXJpZW5jZSBzdXBwb3J0cyAxdjEsIDJ2MiwgM3YzIGFuZCA0djQgY29uZmlndXJhdGlvbnMhXG4gLSBTZWxlY3QgdGhlIGRlc2lyZWQgZm9ybWF0IHdoaWxlIHRoZSAnUmVhZHkgVXAnIHNjcmVlbiBpcyB2aXNpYmxlLCAodXBwZXIgcmlnaHQgY29ybmVyKS5cbiAtIFZlaGljbGVzIHRha2UgYSBtb21lbnQgdG8gc3Bhd24sIHNvIHdhaXQgYSBtb21lbnQgd2hpbGUgdGhlIG1vZGUgY2hhbmdlcy5cbiAtIElmIHlvdSBnbyBkb3duIGluIHNpemUgKGUuZy4gZnJvbSAnM3YzJyB0byAnMnYyJykgdGhlIGV4dHJhIHZlaGljbGVzIHdpbGwgbm90IHJlc3Bhd24gYWdhaW4uXG4gLSBWZWhpY2xlcyBhcmUgY3VyYXRlZCBmb3IgdGhlc2UgbWFwcywgdXNlIHdoYXQgaXMgcHJvdmlkZWQhXG4gLSBUZWFtcyBnZXQgbWlycm9yIG1hdGNoLXVwcywgdGhlIHNhbWUgdmVoaWNsZSB0eXBlcyBzcGF3biBmb3IgYm90aCB0ZWFtcy4iLCJ0aXA1IjoiVGlwIDU6IFdlIGFyZSBsaW1pdGVkIGJ5IHRoZSBpbmFiaWxpdHkgdG8gY2hhbmdlIHZlaGljbGUgbG9hZG91dHMgbWlkLWdhbWU6XG4gLSBZb3VyIGxvYWRvdXQgaXMgbG9ja2VkIG9uY2UgaW4tZ2FtZTsgcmVjb25uZWN0IHRvIGNob29zZSBhIGRpZmZlcmVudCB2ZWhpY2xlIGxvYWRvdXQuXG4gLSBZb3UgY2FuIGNoYW5nZSB5b3VyIEVuZ2luZWVyIHN1Yi1jbGFzcyAoQ29tYmF0IEVuZ2luZWVyIGlzIG9wdGltYWwpLlxuIC0gVmVoaWNsZSBwZXJmb3JtYW5jZSBhbmQgZGFtYWdlIG1vZGVsaW5nIGlzIHVuY2hhbmdlZCBmcm9tIHZhbmlsbGEgQkY2LiIsInRpcDYiOiJUaXAgNjogUG9zaXRpb25pbmcgYXQgdGhlIHJvdW5kIHN0YXJ0IGlzIHVwIHRvIHRoZSBwbGF5ZXJzOlxuIC0gVGhlIG9wZW5pbmcgbW9tZW50cyBvZiBhIHJvdW5kIGFyZSBpbXBhY3RmdWwhXG4gLSBQb3NpdGlvbiBpbnRlbGxpZ2VudGx5IGF0IHRoZSBzdGFydCB0byBmbGFuaywgb3Igc2V0dXAgYW1idXNoZXMuXG4gLSBJZiB5b3UgY3Jvc3MgdGhlIG1haW4gYmFzZSB0aHJlc2hvbGRzIGJlZm9yZSBjb3VudGRvd24gZW5kcywgcmV0dXJuIHRvIHRoZSBtYWluIGJhc2UuIiwidGlwNyI6IlRpcCA3OiBBbGwgZ2FkZ2V0cyBleGNlcHQgdG9yY2ggYW5kIHN1cHBseSBjcmF0ZXMgYXJlIGJhbm5lZDpcbiAtIERlc3BpdGUgd2hhdCBpcyBzZWxlY3RlZCwgeW91IHdpbGwgb25seSBnZXQgdGhlc2UgdHdvIGdhZGdldHMgYnkgZGVzaWduLlxuIC0gTGVhdmluZyBvciBlbnRlcmluZyB5b3VyIG1haW4gYmFzZSByZXN1cHBsaWVzIHlvdXIgdmVoaWNsZSBhbW1vIGNyYXRlcy5cbiAtIEFtbW8gcmVzdXBwbHkgYm94ZXMsIGlmIHVudXNlZCwgd2lsbCBwZXJzaXN0IGJldHdlZW4gcm91bmRzLiIsInRpcDgiOiJUaXAgODogVmVoaWNsZXMgbWFya2VkICdhYmFuZG9uZWQnIHNsb3dseSB0YWtlIGRhbWFnZSBvdmVyIHRpbWU6XG4gLSBUaGlzIGV4cGVyaWVuY2UgaXMgY3VyYXRlZCBmb3IgVmVoaWNsZXMgb25seSwgZG8gbm90IHN0cmF5IHRvbyBmYXIgZnJvbSB0aGVtLlxuIC0gQWZ0ZXIgNW0sIGlmIG5vIHBsYXllcnMgYXJlIHdpdGhpbiB0aGlzIHJhbmdlIHRoZXkgYXJlIGNsYXNzaWZpZWQgYXMgJ2FiYW5kb25lZCcuXG4gLSBBYmFuZG9uZWQgVmVoaWNsZXMgdGFrZSBkYW1hZ2Ugc2xvd2x5OyB0aGV5IGNhbiBiZSByZXBhaXJlZCBiYWNrIHVwIGlmIG5lZWRlZC5cbiAtIFZlaGljbGVzIGRlc3Ryb3llZCBieSBhYmFuZG9ubWVudCBzdGlsbCBhd2FyZCBwb2ludHMgZHVyaW5nIGEgbGl2ZSByb3VuZC4iLCJ0aXA5IjoiVGlwIDk6IFRoZSBjYXB0YWluIGdvZXMgZG93biB3aXRoIGhpcyBzaGlwOlxuIC0gUmVwYWlyaW5nIHlvdXIgZnJpZW5kcyBpcyBhbGxvd2VkLCBhcyBsb25nIGFzIHlvdXIgdmVoaWNsZSBpcyBzdGlsbCBzdGFuZGluZy5cbiAtIElmIHlvdSBsb3NlIHlvdXIgdmVoaWNsZSwgcGxlYXNlIHJlZGVwbG95IGFuZCBsZXQgdGhlIHJvdW5kIHBsYXkgb3V0IHdpdGhvdXQgeW91LlxuIC0gWW91IGNhbiByZXBhaXIgdG9yY2ggZW5lbXkgdmVoaWNsZXMgYnV0IG9ubHkgYXMgbG9uZyBhcyB5b3VyIG93biB2ZWhpY2xlIGlzIHN0aWxsIGluIHBsYXkuIiwidGlwMTAiOiJUaXAgMTA6IFZlaGljbGUgUmVnaXN0cmF0aW9uIGlzIHJlcXVpcmVkIGZvciBzY29yaW5nIGFjY3VyYWN5OlxuIC0gSWYgeW91IHNlZSBubyAncmVnaXN0cmF0aW9uJyBtZXNzYWdlIHdoZW4gZW50ZXJpbmcgYSB2ZWhpY2xlLCBnZXQgb3V0IGFuZCBnZXQgYmFjayBpbi5cbiAtIElmIHJvdW5kIHJlc3VsdHMgYXJlIGlubmFjY3VyYXRlLCB5b3UgY2FuIGFkZHJlc3MgdGhpcyB3aXRoIHRoZSBhZG1pbiBwYW5lbC4iLCJ0aXAxMSI6IlRpcCAxMTogQmUgYSBzcG9ydHNtYW4sIG5vdCBhIGRpbmd1czpcbiAtIEl0IGlzIGVuY291cmFnZWQgdG8gc2V0IHlvdXIgY2hhdCB0byBjb25maWd1cmUgdG8gZGlzcGxheSB3aGVuIHRoZXJlIGlzIGFjdGl2aXR5LlxuIC0gQ29tbXVuaWNhdGUgd2l0aCB5b3VyIG9wcG9uZW50IHdoZW4geW91IGhhdmUgYnVncywgaXNzdWVzLCBvciBuZWVkIHRvIHBhdXNlLlxuIC0gQWdyZWVtZW50cyBtYWRlIGluIGNoYXQgc2hvdWxkIGJlIGJpbmRpbmc6IGhhdmUgZnVuIGFuZCB0cnkgZGlmZmVyZW50IHRoaW5ncy4iLCJ0aXAxMiI6IlRpcCAxMjogVGhpcyBFeHBlcmllbmNlIGlzIGluIGFjdGl2ZSBkZXZlbG9wbWVudCEgSWYgYnVncyBvY2N1ci4uLlxuIC0gQWNjZXNzIHRoZSBBZG1pbiBQYW5lbCBpbiB0aGUgdG9wIHJpZ2h0IHdoaWxlIHRoZSAnUmVhZHkgVXAnIHNjcmVlbiBpcyB2aXNpYmxlLlxuIC0gVGhlIEFkbWluIHBhbmVsIGhhcyBnbG9iYWwgYXVkaXQgbWVzc2FnaW5nIGFuZCBhZG1pbiBhY3Rpb24gY291bnRzLlxuIC0gT3BlbmluZyBvciB1c2luZyB0aGUgQWRtaW4gcGFuZWwgZ2l2ZXMgYSBnbG9iYWwgbm90aWZpY2F0aW9uIGZvciBhbGwgdG8gc2VlLlxuIC0gSWYgYW55IEFkbWluIGJ1dHRvbnMgYXJlIHVzZWQsIHRoZSB2aWN0b3J5IGRpYWxvZyBzaG93cyB0aGlzIGZvciBhd2FyZW5lc3MgLyB2aXNpYmlsaXR5LlxuIC0gVGhlIEFkbWluIHBhbmVsIGlzIGZvciBmaXhpbmcgaW5ub2NlbnQgbWlzdGFrZXMgb25seSAoYXZvaWQgdXNpbmcgaXQgdW5sZXNzIG5lY2Vzc2FyeSkuIiwidGlwMTMiOiJUaXAgMTM6IE1hbnkgZXhwZXJpZW5jZSBjb2RlcyBhdmFpbGFibGUgZm9yIHRoaXMgZ2FtZSBtb2RlIChaTUNZVzogQWxsIDggTWFwcylcbiAtIFpNQzNBOiBBcmVhIDIyQlxuIC0gWk1DNDQ6IEJsYWNrd2VsbCBGaWVsZHNcbiAtIFpNQzUyOiBEZWZlbnNlIE5leHVzXG4gLSBaTUM1UDogR29sZiBDb3Vyc2VcbiAtIFpNQzdZOiBMaWJlcmF0aW9uIFBlYWtcbiAtIFpNQzg3OiBNYWhhdHRhbiBCcmlkZ2VcbiAtIFpNQzlTOiBPcGVyYXRpb24gRmlyZXN0b3JtXG4gLSBaTUM5WTogTWlyYWsgVmFsbGV5IiwidGlwMTQiOiJUaXAgMTQ6IElmIGV4dHJhIHZlaGljbGVzIHJlbWFpbiBpbiB0aGUgbWFpbiBiYXNlIGZyb20gdG9nZ2xpbmcgZG93biBhIG1vZGUuXG4oZS5nLiBnb2luZyBmcm9tIDN2MyB0byAydjIpXG4gLSBJdCdzIGJlc3QgdG8gYmxvdyB0aGVzZSB2ZWhpY2xlcyB1cCBiZWZvcmUgdGhlIHJvdW5kIHN0YXJ0cy5cbiAtIEFudGktc3Bhd24gY2FtcCBkZXRlY3Rpb24gcHJvdGVjdHMgYWdhaW5zdCBnZXR0aW5nIHBvaW50c1xuIC0gQnV0IHRoaXMgdHJpZ2dlcnMgb25seSBpZiB0aGV5J3JlIGRlc3Ryb3llZCBkdXJpbmcgdGhlaXIgb3JpZ2luLlxuIC0gRG8gbm90IGFidXNlIHRoaXMgZmVhdHVyZSwgdGhhdCdkIGJlIGEgZG91Y2hleSB0aGluZyB0byBkby4iLCJ0aXAxNSI6IjE1LXNraXA6IHJlbW92ZSBmcm9tIEpPSU5fUFJPTVBUX0JPRFlfU0VRVUVOQ0VfU0tJUF9LRVlTIGluIG9yZGVyIHRvIGRpc3BsYXkiLCJ0aXAxNiI6IjE2LXNraXA6IHJlbW92ZSBmcm9tIEpPSU5fUFJPTVBUX0JPRFlfU0VRVUVOQ0VfU0tJUF9LRVlTIGluIG9yZGVyIHRvIGRpc3BsYXkiLCJ0aXAxNyI6IjE3LXNraXA6IHJlbW92ZSBmcm9tIEpPSU5fUFJPTVBUX0JPRFlfU0VRVUVOQ0VfU0tJUF9LRVlTIGluIG9yZGVyIHRvIGRpc3BsYXkiLCJ0aXAxOCI6IjE4LXNraXA6IHJlbW92ZSBmcm9tIEpPSU5fUFJPTVBUX0JPRFlfU0VRVUVOQ0VfU0tJUF9LRVlTIGluIG9yZGVyIHRvIGRpc3BsYXkiLCJ0aXAxOSI6IjE5LXNraXA6IHJlbW92ZSBmcm9tIEpPSU5fUFJPTVBUX0JPRFlfU0VRVUVOQ0VfU0tJUF9LRVlTIGluIG9yZGVyIHRvIGRpc3BsYXkiLCJ0aXAyMCI6IjIwLXNraXA6IHJlbW92ZSBmcm9tIEpPSU5fUFJPTVBUX0JPRFlfU0VRVUVOQ0VfU0tJUF9LRVlTIGluIG9yZGVyIHRvIGRpc3BsYXkifSwiZGlzbWlzcyI6IkRpc21pc3MiLCJkaXNtaXNzU2hvd01vcmVUaXBzIjoiU2hvdyBNb3JlIFRpcHMgTmV4dCBUaW1lIiwibmV2ZXJTaG93QWdhaW4iOiJOZXZlciBTaG93IEFnYWluIn0sInJlYWR5RGlhbG9nIjp7ImhlYWRlciI6IkV2ZXJ5b25lIG5lZWRzIHRvIHByZXNzICdSZWFkeScgYW5kIHN0YXkgaW5zaWRlIHRoZWlyIG1haW4gYmFzZSB1bnRpbCB0aGUgcm91bmQgc3RhcnRzLiIsImhlYWRlcjIiOiJZb3UgZ2V0IE9ORSB2ZWhpY2xlICYgT05FIGxpZmUgcGVyIHJvdW5kLiBPbmx5IHZlaGljbGUga2lsbHMgYXdhcmQgcG9pbnRzISIsImhlYWRlcjMiOiJSZXBhaXIgdmVoaWNsZXMgd2l0aCB5b3VyIHRvcmNoICYgcmVzdXBwbHkgdmVoaWNsZSBhbW1vIHdpdGggc3VwcGx5IGNyYXRlcyBhcyBuZWVkZWQuIiwiaGVhZGVyNCI6IlN0YXkgY2xvc2UgdG8geW91ciB2ZWhpY2xlcy4uLiBWZWhpY2xlcyB3aWxsIGJlY29tZSAnYWJhbmRvbmVkJyBpZiBpdCdzID57MH1tIGZyb20gYW55IHBsYXllci4iLCJoZWFkZXI1IjoiQWJhbmRvbmVkIHZlaGljbGVzIHRha2UgZGFtYWdlIG92ZXIgdGltZSwgZXZlbiBiZWNvbWluZyBkZXN0cm95ZWQuIiwiaGVhZGVyNiI6IkNoYW5nZSBtYXRjaCBzZXR0aW5ncyB0byB0aGUgcmlnaHQsIHRoZW4gY29uZmlybSB0byBpbml0aWF0ZSBzZXR1cCBhbmQgZ2FtZSBtb2RlIHN0YXJ0LiIsIm1hcExhYmVsIjoiTWFwOiIsImdhbWVNb2RlTGFiZWwiOiJHYW1lIE1vZGU6IiwibW9kZVNldHRpbmdzTGFiZWwiOiJNb2RlIFNldHRpbmdzOiIsInZlaGljbGVzTGFiZWxGb3JtYXQiOiJWZWhpY2xlcyB7MH06IiwiY29uZmlybVNldHRpbmdzTGFiZWwiOiJDT05GSVJNICYgQVBQTFkgTU9ERSBDSEFOR0VTIiwicmVzZXRTZXR0aW5nc0xhYmVsIjoiUkVTVEFSVCAvIEZSRVNIIFNFVFVQIiwiZ2FtZU1vZGVIZWxpc0xhZGRlciI6IkhlbGlzIE9ubHkgLSBUV0wgMnYyIiwiZ2FtZU1vZGVIZWxpc1R3bDF2MSI6IkhlbGlzIE9ubHkgLSBUV0wgMXYxIiwiZ2FtZU1vZGVIZWxpc1ByYWN0aWNlIjoiSGVsaXMgT25seSAtIEJGNiBWYW5pbGxhIiwiZ2FtZU1vZGVIZWxpc0N1c3RvbSI6IkhlbGlzIE9ubHkgLSBDdXN0b20iLCJhaXJjcmFmdENlaWxpbmdWYW5pbGxhIjoiVmFuaWxsYSIsIm1vZGVTZXR0aW5nQWlyY3JhZnRDZWlsaW5nRm9ybWF0IjoiQWlyY3JhZnQgQ2VpbGluZzogezB9IiwidmVoaWNsZU9wdGlvbkZhbGNoaW9uIjoiTTc3RSBGYWxjaGlvbiAoQXBhY2hlKSIsInZlaGljbGVPcHRpb25QYW50aGVyYSI6IlBhbnRoZXJhIEtIVCAoRXVybykiLCJ2ZWhpY2xlT3B0aW9uQmxhY2tIYXdrIjoiVUgtNjAgQmxhY2sgSGF3ayIsInZlaGljbGVPcHRpb25NYXBEZWZhdWx0IjoiTWFwIERlZmF1bHQiLCJiZXN0T2ZMYWJlbCI6IkJlc3Qgb2YgezB9IFJvdW5kcyIsImJlc3RPZkNoYW5nZWQiOiJ7MH0gY2hhbmdlZCBpdCB0byBiZXN0IG9mIHsxfSByb3VuZHMiLCJtYXRjaHVwRm9ybWF0IjoiVmVoaWNsZXM6IHswfSB2cyB7MX0iLCJtYXRjaHVwQ2hhbmdlZCI6InswfSBjaGFuZ2VkIHZlaGljbGVzIG1hdGNodXAgdG8gezF9IHZzIHsyfSIsImdhbWVNb2RlQ2hhbmdlZCI6InswfSBjaGFuZ2VkIGdhbWUgbW9kZSB0byB7MX0iLCJhaXJjcmFmdENlaWxpbmdDaGFuZ2VkIjoiezB9IGNoYW5nZWQgdGhlIEFpcmNyYWZ0IENlaWxpbmcgdG8gezF9IiwicGxheWVyc0NoYW5nZWQiOiJ7MH0gY2hhbmdlZCBwbGF5ZXJzIG1pbmltdW0gdG8gezF9IHZzIHsyfSIsInBsYXllcnNGb3JtYXQiOiJQbGF5ZXJzOiB7MH0gdnMgezF9IiwibWluUGxheWVyc1RvU3RhcnRGb3JtYXQiOiJNaW5pbXVtIFBsYXllcnMgdG8gU3RhcnQ6IHswfSIsInRhcmdldEtpbGxzVG9XaW5Gb3JtYXQiOiJUYXJnZXQgS2lsbHMgdG8gd2luIFJvdW5kOiB7MH0iLCJwbGF5ZXJOYW1lRm9ybWF0IjoiezB9Iiwic3RhdHVzIjp7InJlYWR5IjoiUkVBRFkiLCJub3RSZWFkeSI6Ik5PVCBSRUFEWSJ9LCJiYXNlU3RhdHVzIjp7ImluIjoiSU4gTUFJTiBCQVNFIiwib3V0IjoiTk9UIElOIE1BSU4gQkFTRSJ9LCJidXR0b25zIjp7InJlYWR5IjoiUkVBRFkiLCJub3RSZWFkeSI6Ik5PVCBSRUFEWSIsInN3YXBUZWFtcyI6IkNIQU5HRSBURUFNUyIsImF1dG9SZWFkeUVuYWJsZSI6IkVOQUJMRSBBVVRPLVJFQURZIiwiYXV0b1JlYWR5RGlzYWJsZSI6IkRJU0FCTEUgQVVUTy1SRUFEWSJ9fSwiYWRtaW5QYW5lbCI6eyJhY2Nlc3NlZCI6InswfSBhY2Nlc3NlZCB0aGUgQWRtaW4gUGFuZWwiLCJhY3Rpb25QcmVzc2VkIjoiezB9IHByZXNzZWQgezF9IGluIHRoZSBhZG1pbiBwYW5lbCIsImFjdGlvbkNvdW50Rm9ybWF0IjoiKHswfSkiLCJhY3Rpb25Db3VudFZpY3RvcnlGb3JtYXQiOiJBZG1pbiBQYW5lbCBCdXR0b25zIHVzZWQgezB9IHRpbWVzIiwiYWN0aW9uQ291bnRWaWN0b3J5Rm9ybWF0UmFuZG9tT3ZlcnJpZGUiOiJBZG1pbiBQYW5lbCBCdXR0b25zIHVzZWQgezB9IHRpbWVzIHdpdGggYSBSYW5kb20gT3ZlcnJpZGUhIiwiYWN0aW9ucyI6eyJ0MVdpbnNJbmMiOiJUMSBXaW5zICsiLCJ0MVdpbnNEZWMiOiJUMSBXaW5zIC0iLCJ0MldpbnNJbmMiOiJUMiBXaW5zICsiLCJ0MldpbnNEZWMiOiJUMiBXaW5zIC0iLCJ0MVRvdGFsS2lsbHNJbmMiOiJUMSBUb3RhbCBLaWxscyArIiwidDFUb3RhbEtpbGxzRGVjIjoiVDEgVG90YWwgS2lsbHMgLSIsInQyVG90YWxLaWxsc0luYyI6IlQyIFRvdGFsIEtpbGxzICsiLCJ0MlRvdGFsS2lsbHNEZWMiOiJUMiBUb3RhbCBLaWxscyAtIiwidDFSb3VuZEtpbGxzSW5jIjoiVDEgUm91bmQgS2lsbHMgKyIsInQxUm91bmRLaWxsc0RlYyI6IlQxIFJvdW5kIEtpbGxzIC0iLCJ0MlJvdW5kS2lsbHNJbmMiOiJUMiBSb3VuZCBLaWxscyArIiwidDJSb3VuZEtpbGxzRGVjIjoiVDIgUm91bmQgS2lsbHMgLSIsInRhcmdldFJvdW5kS2lsbHNJbmMiOiJUYXJnZXQgUm91bmQgS2lsbHMgKyIsInRhcmdldFJvdW5kS2lsbHNEZWMiOiJUYXJnZXQgUm91bmQgS2lsbHMgLSIsInRpZXNJbmMiOiJUaWVzICsiLCJ0aWVzRGVjIjoiVGllcyAtIiwiY3VycmVudFJvdW5kSW5jIjoiQ3VycmVudCBSb3VuZCArIiwiY3VycmVudFJvdW5kRGVjIjoiQ3VycmVudCBSb3VuZCAtIiwiY2xvY2tUaW1lSW5jIjoiQ2xvY2sgVGltZSArIiwiY2xvY2tUaW1lRGVjIjoiQ2xvY2sgVGltZSAtIiwiY2xvY2tSZXNldCI6IkNsb2NrIFJlc2V0Iiwicm91bmRTdGFydCI6IlN0YXJ0IFJvdW5kIiwicm91bmRFbmQiOiJFbmQgUm91bmQiLCJwb3NpdGlvbkRlYnVnIjoiVG9nZ2xlIFBvc2l0aW9uIERlYnVnIiwidGllQnJlYWtlck92ZXJyaWRlQSI6IlRpZS1CcmVha2VyIE92ZXJyaWRlOiBBIiwidGllQnJlYWtlck92ZXJyaWRlQiI6IlRpZS1CcmVha2VyIE92ZXJyaWRlOiBCIiwidGllQnJlYWtlck92ZXJyaWRlQyI6IlRpZS1CcmVha2VyIE92ZXJyaWRlOiBDIiwidGllQnJlYWtlck92ZXJyaWRlRCI6IlRpZS1CcmVha2VyIE92ZXJyaWRlOiBEIiwidGllQnJlYWtlck92ZXJyaWRlRSI6IlRpZS1CcmVha2VyIE92ZXJyaWRlOiBFIiwidGllQnJlYWtlck92ZXJyaWRlRiI6IlRpZS1CcmVha2VyIE92ZXJyaWRlOiBGIiwidGllQnJlYWtlck92ZXJyaWRlRyI6IlRpZS1CcmVha2VyIE92ZXJyaWRlOiBHIiwidGllQnJlYWtlck1vZGVMYXN0Um91bmRPbmx5IjoiVGllLUJyZWFrZXIgU2V0dGluZzogTGFzdCBSb3VuZCBPTkxZIiwidGllQnJlYWtlck1vZGVBbGxSb3VuZHMiOiJUaWUtQnJlYWtlciBTZXR0aW5nOiBBbGwgUm91bmRzIC8gT04iLCJ0aWVCcmVha2VyTW9kZURpc2FibGVkIjoiVGllLUJyZWFrZXIgU2V0dGluZzogRGlzYWJsZWQgLyBPRkYiLCJyb3VuZExlbmd0aERlYyI6IlJvdW5kIExlbmd0aCAtIiwicm91bmRMZW5ndGhJbmMiOiJSb3VuZCBMZW5ndGggKyIsImxpdmVSZXNwYXduT24iOiJMaXZlICMjIyMjIyMgT04iLCJsaXZlUmVzcGF3bk9mZiI6IkxpdmUgIyMjIyMjIyBPRkYifSwibGFiZWxzIjp7InQxUm91bmRLaWxscyI6IlQxIFJvdW5kIEtpbGxzIiwidDJSb3VuZEtpbGxzIjoiVDIgUm91bmQgS2lsbHMiLCJ0aWVCcmVha2VyT3ZlcnJpZGUiOiJUaWUtQnJlYWtlciBSYW5kb21pemF0aW9uIE92ZXJyaWRlOiIsInRpZUJyZWFrZXJTZXR0aW5nSGVhZGVyIjoiVGllLUJyZWFrZXIgU2V0dGluZyIsInRpZUJyZWFrZXJTZXR0aW5nRm9ybWF0IjoiVGllLUJyZWFrZXIgU2V0dGluZ1xuezB9IiwidGllQnJlYWtlck1vZGVMYXN0Um91bmRPbmx5IjoiTGFzdCBSb3VuZCBPTkxZIiwidGllQnJlYWtlck1vZGVBbGxSb3VuZHMiOiJBbGwgUm91bmRzIC8gT04iLCJ0aWVCcmVha2VyTW9kZURpc2FibGVkIjoiRGlzYWJsZWQgLyBPRkYiLCJyb3VuZExlbmd0aEZvcm1hdCI6IlJvdW5kIExlbmd0aDogezB9OnsxfXsyfSIsImxpdmVSZXNwYXduT24iOiJMaXZlIFJlZGVwbG95IE9OIiwibGl2ZVJlc3Bhd25PZmYiOiJMaXZlIFJlZGVwbG95IE9GRiJ9LCJidXR0b25zIjp7InBhbmVsIjoiQWRtaW4gUGFuZWwifSwidGVzdGVyIjp7ImhlYWRlciI6InQxID0gbGVmdCB0ZWFtOyB0MiA9IHJpZ2h0IHRlYW0iLCJidXR0b25zIjp7ImNsb2NrUmVzZXQiOiJSZXNldCBDbG9jayIsInJvdW5kRW5kIjoiRW5kIFJvdW5kIiwicm91bmRTdGFydCI6IlN0YXJ0IFJvdW5kIiwicG9zaXRpb25EZWJ1ZyI6IlRvZ2dsZSBQb3NpdGlvbiBEZWJ1ZyJ9LCJsYWJlbHMiOnsiY2xvY2tUaW1lIjoiQ2xvY2sgVGltZSAtLysgMW0iLCJjdXJyZW50Um91bmQiOiJDdXJyZW50IFJvdW5kIiwibGVmdEtpbGxzIjoiVDEgVG90YWwgS2lsbHMiLCJsZWZ0V2lucyI6IlQxIFdpbnMiLCJ0aWVzIjoiVDEgKyBUMiBSb3VuZCBUaWVzIiwicmlnaHRLaWxscyI6IlQyIFRvdGFsIEtpbGxzIiwicmlnaHRXaW5zIjoiVDIgV2lucyIsInJvdW5kS2lsbHNUYXJnZXQiOiJUYXJnZXQgUm91bmQgS2lsbHM6In19fSwidGVhbVN3aXRjaCI6eyJidXR0b25zIjp7ImNhbmNlbCI6IkNMT1NFIn0sImRlYnVnVGltZUxpbWl0IjoiezB9In0sInVpIjp7InBsdXMiOiIrIiwibWludXMiOiItIiwibGVmdCI6IjwiLCJyaWdodCI6Ij4iLCJ4IjoiPz8ifSwidmljdG9yeSI6eyJkcmF3cyI6IkRSQVdTIiwibG9zZXMiOiJMT1NFUyIsIndpbnMiOiJXSU5TISIsInJlc3RhcnRJbkZvcm1hdCI6Ik1hcCB3aWxsIHJlc3RhcnQvcm90YXRlIGluIHswfXMiLCJyb3VuZExvc3Nlc0Zvcm1hdCI6InswfSBSb3VuZCBMb3NzZXMiLCJyb3VuZFRpZXNGb3JtYXQiOiJ7MH0gUm91bmQgVGllcyIsInJvdW5kV2luc0Zvcm1hdCI6InswfSBSb3VuZCBXaW5zIiwicm91bmRzU3VtbWFyeUZvcm1hdCI6InswfSBSb3VuZHMgcGxheWVkIGluIGEgYmVzdCBvZiB7MX0gUm91bmRzIG1hdGNodXAiLCJzY3JlZW5zaG90UHJvbXB0IjoiU2NyZWVuc2hvdCB0aGlzIHRvIHJlY29yZCBtYXRjaCByZXN1bHRzIiwidGVhbU91dGNvbWVGb3JtYXQiOiJ7MH0gezF9IiwidG90YWxLaWxsc0Zvcm1hdCI6InswfSBUb3RhbCBLaWxscyIsInRvdGFsTWF0Y2hUaW1lTGFiZWwiOiJUb3RhbCBNYXRjaCB0aW1lOiJ9LCJjb3VudGRvd24iOnsiZm9ybWF0IjoiezB9IiwiZ28iOiJHTyEifSwiZGVidWciOnsiYWRtaW5Qb3MiOiJBRE1JTiBQT1MgWDp7MH0gWTp7MX0gWjp7Mn0iLCJhZG1pbkZhY2luZyI6IkFETUlOIEZBQ0lORyBYOnswfSBZOnsxfSBaOnsyfSIsImNwVmlzUmVzZXQiOiIjIyBWSVM6IHJlc2V0IC0+IGhpZGUgYWxsIEJFRk9SRSBoYXJkUmVzZXQvY29uZmlnIiwiY3BWaXNIYXJkUmVzZXQiOiIjIyBWSVM6IGhhcmRSZXNldCAtPiBwdWxzZSBlbmFibGUvZGlzYWJsZSBvYmplY3RpdmVzIn0sIm1lc3NhZ2VzIjp7ImluaXQiOiJWZWhpY2xlIHNjb3JpbmcgaW5pdGlhbGl6ZWQuIiwidmVoaWNsZVNwYXduZWQiOiJWZWhpY2xlIHNwYXduZWQgZm9yIHswfSBhdCBYOnsxfS9aOnsyfSIsInBvaW50QXdhcmRlZFdpdGhPd25lciI6IisxIEtpbGwgZm9yIHswfSAtIHsxfSdzIHZlaGljbGUgd2FzIGRlc3Ryb3llZCEgKHsyfSBSb3VuZCBLaWxscykiLCJ2ZWhpY2xlRGVzdHJveWVkTm90TGl2ZSI6InswfSdzIHsxfSB2ZWhpY2xlIHdhcyBkZXN0cm95ZWQgLSBidXQgcm91bmQgd2FzIG5vdCBsaXZlIChubyBwb2ludHMgYXdhcmRlZCkiLCJ2ZWhpY2xlU3Bhd25SZXRyeSI6IlZlaGljbGUgc3Bhd24gYmxvY2tlZCBmb3IgezB9LiBSZXRyeWluZyBpbiB7MX1zLiIsInZlaGljbGVDYW1wZWRJbk1haW5CYXNlIjoiVmVoaWNsZSB3YXMgc3Bhd24gY2FtcGVkIGluIHswfSBNYWluIEJhc2UgYXQgWDp7MX0iLCJ2ZWhpY2xlUmVSZWdpc3RlcmVkIjoiVmVoaWNsZSByZS1yZWdpc3RlcmVkIGFnYWluLCBmb3IgezB9IGJ5IHsxfS4iLCJ2ZWhpY2xlU3RvbGVuUmVnaXN0ZXIiOiJWZWhpY2xlIHN0b2xlbiBhbmQgcmVnaXN0ZXJlZCBmb3IgezB9IGJ5IHsxfS4iLCJ2ZWhpY2xlUmVnaXN0cmF0aW9uTm9DaGFuZ2UiOiJ7MH0gZW50ZXJlZCBhIHJlZ2lzdGVyZWQgdmVoaWNsZSBmb3IgezF9IChubyBjaGFuZ2UpLiIsInZlaGljbGVSZWdpc3RyYXRpb25QZW5kaW5nVGVhbSI6InswfSBlbnRlcmVkIGEgdmVoaWNsZSwgcmVnaXN0cmF0aW9uIHBlbmRpbmcgdGVhbSBhc3NpZ25tZW50LiIsInZlaGljbGVSZWdpc3RlcmVkTmV3IjoiVmVoaWNsZSByZWdpc3RlcmVkIGZvciB7MH0gYnkgezF9IChzcGF3biBBdXRvLXJlZ2lzdHJhdGlvbiBmYWlsZWQ/ISkuIiwidmVoaWNsZVJldHVybmVkIjoiezB9IGhhcyByZXR1cm5lZCB0byB0aGVpciByZWdpc3RlcmVkIHZlaGljbGUgZm9yIHsxfS4ifSwic3lzdGVtIjp7ImdlbmVyaWNDb3VudGVyIjoiezB9Iiwic2xhc2giOiIvIiwidW5rbm93blBsYXllciI6IlVua25vd24iLCJ1bmFzc2lnbmVkIjoiVW5hc3NpZ25lZCIsImRlYnVnUGxhY2Vob2xkZXJOYW1lIjoiUExBQ0VSSE9MREVSX1BMQVlFUl9OQU1FX0hFUkUifX19","compiled":""},"attachmentType":4,"errors":[]},{"id":"c097d687-f56b-4003-b760-b7f4bada9dec","version":"123","filename":"MP_TWL_AircraftOnly_Tungsten.spatial.json","isProcessable":true,"processingStatus":2,"attachmentData":{"original":"ew0KICAgICJQb3J0YWxfRHluYW1pYyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiVEVBTV8xX0hRIiwNCiAgICAgICAgICAgICJBbHRUZWFtIjogIlRlYW1OZXV0cmFsIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDEsDQogICAgICAgICAgICAiSW5mYW50cnlTcGF3bnMiOiBbDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMSIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMiIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMyIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfNCINCiAgICAgICAgICAgIF0sDQogICAgICAgICAgICAiSFFBcmVhIjogIlRFQU1fMV9IUS9IUV9UZWFtMSIsDQogICAgICAgICAgICAidHlwZSI6ICJIUV9QbGF5ZXJTcGF3bmVyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC01MDUuNjQxLA0KICAgICAgICAgICAgICAgICJ5IjogODIuNTcxNCwNCiAgICAgICAgICAgICAgICAieiI6IC0zMjkuMDM0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMV9IUSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJIUUFyZWEiLA0KICAgICAgICAgICAgICAgICJJbmZhbnRyeVNwYXducyINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiSFFfVGVhbTEiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8xX0hRL0hRX1RlYW0xIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAwLA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTUwMC42NDEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODcuNTcxNCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzI0LjAzNA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDAuNjQxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg3LjU3MTQsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMzNC4wMzQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNTEwLjY0MSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4Ny41NzE0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMzQuMDM0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTUxMC42NDEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODcuNTcxNCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzI0LjAzNA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8xXzEiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMC4wNDYxODI1LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjk5ODkzMw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuOTk4OTMzLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjA0NjE4MjUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNTA1LjY0MSwNCiAgICAgICAgICAgICAgICAieSI6IDgyLjU3MTQsDQogICAgICAgICAgICAgICAgInoiOiAtMzMyLjAzNA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNwYXduUG9pbnRfMV8yIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNwYXduUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC40NDI5MTUsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogLTAuODk2NTY0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC44OTY1NjQsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC40NDI5MTUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNTAyLjY0MSwNCiAgICAgICAgICAgICAgICAieSI6IDgyLjU3MTQsDQogICAgICAgICAgICAgICAgInoiOiAtMzI5LjAzNA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNwYXduUG9pbnRfMV8zIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNwYXduUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC4zMDQ2MTUsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogLTAuOTUyNDc2DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC45NTI0NzYsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC4zMDQ2MTUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNTA4LjY0MSwNCiAgICAgICAgICAgICAgICAieSI6IDgyLjU3MTQsDQogICAgICAgICAgICAgICAgInoiOiAtMzI5LjAzNA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzMiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNwYXduUG9pbnRfMV80IiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNwYXduUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC42NzU4MzUsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogLTAuNzM3MDUzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC43MzcwNTMsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC42NzU4MzUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNTA1LjY0MSwNCiAgICAgICAgICAgICAgICAieSI6IDgyLjU3MTQsDQogICAgICAgICAgICAgICAgInoiOiAtMzI2LjAzNA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRFQU1fMl9IUSIsDQogICAgICAgICAgICAiVGVhbSI6ICJUZWFtMiIsDQogICAgICAgICAgICAiQWx0VGVhbSI6ICJUZWFtTmV1dHJhbCIsDQogICAgICAgICAgICAiT2JqSWQiOiAyLA0KICAgICAgICAgICAgIkluZmFudHJ5U3Bhd25zIjogWw0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzEiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzIiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzMiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzQiDQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgIkhRQXJlYSI6ICJURUFNXzJfSFEvSFFfVGVhbTIiLA0KICAgICAgICAgICAgInR5cGUiOiAiSFFfUGxheWVyU3Bhd25lciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiA0MjguMzIsDQogICAgICAgICAgICAgICAgInkiOiA4NS4yMTQ2LA0KICAgICAgICAgICAgICAgICJ6IjogLTYxOS4zMzkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8yX0hRIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkhRQXJlYSIsDQogICAgICAgICAgICAgICAgIkluZmFudHJ5U3Bhd25zIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJIUV9UZWFtMiIsDQogICAgICAgICAgICAidHlwZSI6ICJQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzJfSFEvSFFfVGVhbTIiLA0KICAgICAgICAgICAgImhlaWdodCI6IDAsDQogICAgICAgICAgICAicG9pbnRzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA0MzMuMzIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogOTAuMjE0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNjE0LjMzOQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDQzMy4zMiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA5MC4yMTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC02MjQuMzM5DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogNDIzLjMyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDkwLjIxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTYyNC4zMzkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA0MjMuMzIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogOTAuMjE0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNjE0LjMzOQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8yXzEiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjk4MzUyNSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjE4MDc3Nw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjE4MDc3NywNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjk4MzUyNQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDQyOC4zMiwNCiAgICAgICAgICAgICAgICAieSI6IDg1LjIxNDYsDQogICAgICAgICAgICAgICAgInoiOiAtNjIyLjMzOQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNwYXduUG9pbnRfMl8yIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNwYXduUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC45NTEyMTgsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC4zMDg1MTkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMC4zMDg1MTksDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC45NTEyMTgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiA0MzEuMzIsDQogICAgICAgICAgICAgICAgInkiOiA4NS4yMTQ2LA0KICAgICAgICAgICAgICAgICJ6IjogLTYxOS4zMzkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8yX0hRL1NwYXduUG9pbnRfMl8yIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTcGF3blBvaW50XzJfMyIsDQogICAgICAgICAgICAidHlwZSI6ICJTcGF3blBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuOTk3Mzk2LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuMDcyMTI0NA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjA3MjEyNDQsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC45OTczOTYNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiA0MjUuMzIsDQogICAgICAgICAgICAgICAgInkiOiA4NS4yMTQ2LA0KICAgICAgICAgICAgICAgICJ6IjogLTYxOS4zMzkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8yX0hRL1NwYXduUG9pbnRfMl8zIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTcGF3blBvaW50XzJfNCIsDQogICAgICAgICAgICAidHlwZSI6ICJTcGF3blBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuOTkwMzg2LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuMTM4MzI3DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuMTM4MzI3LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuOTkwMzg2DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogNDI4LjMyLA0KICAgICAgICAgICAgICAgICJ5IjogODUuMjE0NiwNCiAgICAgICAgICAgICAgICAieiI6IC02MTYuMzM5DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMl9IUS9TcGF3blBvaW50XzJfNCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ29tYmF0QXJlYSIsDQogICAgICAgICAgICAiQ29tYmF0Vm9sdW1lIjogIkNvbWJhdEFyZWEvQ29tYmF0Vm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkNvbWJhdEFyZWEiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNvbWJhdEFyZWEiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiQ29tYmF0Vm9sdW1lIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDb21iYXRWb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ29tYmF0QXJlYS9Db21iYXRWb2x1bWUiLA0KICAgICAgICAgICAgImhlaWdodCI6IDEwMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDgxNy44NjYsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNzg3LjY1NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDU1Ni4wMDk4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDYzLjczNjQsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTk4NC4wMjQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNTMxLjEzOSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0xMDE0Ljk2NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xMDUxLjU4OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC05MjEuNjk0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTEyMjkuMDA5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDYzLjczNjQsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTY2OC43MDUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMTI0My44MDksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA2Ni41MTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMTEyNy4xMTksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAzNzcuNzEzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTkxOS4wNjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA1MDMuNzkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDY1Ljg2OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IDUwOC41DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTExNy43NDUsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA1MjUuNzE4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjg1LjI5MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IDUyMC43ODMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA0NjIuMjUwMywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IDUyMi4yODgNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA5NDUuNzIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NTQuNzc2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMTE1MC4xNDEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjMuNzM2NCwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAyMzYuMDMwOQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDExNzAuMzIxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDYzLjczNjQsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTIyNS4zNTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAxMDI4Ljc2NywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2My43MzY0LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01NDkuNjYyDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJEZXBsb3lDYW0iLA0KICAgICAgICAgICAgInR5cGUiOiAiRGVwbG95Q2FtIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLjEwMTA1NiwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjk5NDg4MQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLjk5NDg4MSwNCiAgICAgICAgICAgICAgICAieiI6IDAuMTAxMDU2DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTE1LjUyMzYsDQogICAgICAgICAgICAgICAgInkiOiA0MDguNTQsDQogICAgICAgICAgICAgICAgInoiOiAtMjY1LjI5Mw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYW1lcmEzRC9EZXBsb3lDYW0iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRlYW0xQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgIk9iaklkIjogNTAxLA0KICAgICAgICAgICAgIkFyZWEiOiAiVGVhbTFBcmVhVHJpZ2dlci9UZWFtMU9PQlZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNDU5LjEzNCwNCiAgICAgICAgICAgICAgICAieSI6IDg3LjQ2NjIsDQogICAgICAgICAgICAgICAgInoiOiAtMzM1LjY1NQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJUZWFtMUFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRlYW0xT09CVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgImlkIjogIlRlYW0xQXJlYVRyaWdnZXIvVGVhbTFPT0JWb2x1bWUiLA0KICAgICAgICAgICAgImhlaWdodCI6IDAsDQogICAgICAgICAgICAicG9pbnRzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDg2LjMzOTU4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjM4MDM3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MjAuNjIxNQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MzMuNDYxODgsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODQuMzgwMzcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI2NS43NjAzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTQ4Ny4zNjE1OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC4zODAzNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjQ1LjM1NTYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDMyLjgxNTc4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjM4MDM3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MDguODQ2Nw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiVGVhbTFTZWN0b3IiLA0KICAgICAgICAgICAgIlNlY3RvckFyZWEiOiAiVGVhbTFBcmVhVHJpZ2dlci9UZWFtMU9PQlZvbHVtZSIsDQogICAgICAgICAgICAiUmV0cmVhdEFyZWEiOiAiVGVhbTFBcmVhVHJpZ2dlci9UZWFtMU9PQlZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJTZWN0b3IiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTQ3NC40MjU2LA0KICAgICAgICAgICAgICAgICJ5IjogODIuNzY3NTEsDQogICAgICAgICAgICAgICAgInoiOiAtMzM1LjYwMjQ0ODcNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVGVhbTFBcmVhVHJpZ2dlci9UZWFtMVNlY3RvciIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJTZWN0b3JBcmVhIiwNCiAgICAgICAgICAgICAgICAiUmV0cmVhdEFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRlYW0yQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgIk9iaklkIjogNTAwLA0KICAgICAgICAgICAgIkFyZWEiOiAiVGVhbTJBcmVhVHJpZ2dlci9UZWFtMk9PQlZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiA0MzUuMjc3LA0KICAgICAgICAgICAgICAgICJ5IjogODUuOTcyMiwNCiAgICAgICAgICAgICAgICAieiI6IC01ODEuMTg0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRlYW0yQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiVGVhbTJPT0JWb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiVGVhbTJBcmVhVHJpZ2dlci9UZWFtMk9PQlZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDM1Ny43OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC44OTg5MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNjM0LjQ3NDgNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAzNTIuMTkyOSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC44OTg5MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNTgwLjQ3MDENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA0OTcuMzU5NywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC44OTg5MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNTcwLjQ5MDcNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA1MDguMTk3MywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC44OTg5MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNjI3LjUyNjINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRlYW0yU2VjdG9yIiwNCiAgICAgICAgICAgICJTZWN0b3JBcmVhIjogIlRlYW0yQXJlYVRyaWdnZXIvVGVhbTJPT0JWb2x1bWUiLA0KICAgICAgICAgICAgIlJldHJlYXRBcmVhIjogIlRlYW0yQXJlYVRyaWdnZXIvVGVhbTJPT0JWb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDQzNS44NDk0NDksDQogICAgICAgICAgICAgICAgInkiOiA4Ni4wODMyNzYsDQogICAgICAgICAgICAgICAgInoiOiAtNTg4Ljk1ODk2DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRlYW0yQXJlYVRyaWdnZXIvVGVhbTJTZWN0b3IiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSIsDQogICAgICAgICAgICAgICAgIlJldHJlYXRBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgSCIsDQogICAgICAgICAgICAiT2JqSWQiOiAyMDcsDQogICAgICAgICAgICAiQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgSC9DYXBIIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMjguMzk4OCwNCiAgICAgICAgICAgICAgICAieSI6IDEyNS4yMzQsDQogICAgICAgICAgICAgICAgInoiOiAtMzUzLjM5Mg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgSCIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXBIIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEgvQ2FwSCBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiA1NSwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yMS40OTU0NDksDQogICAgICAgICAgICAgICAgICAgICJ5IjogOTQuNDcxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMDIuOTI2MjQxDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogNzguNTA0NTUxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDk0LjQ3MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzAyLjkyNjI0MQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDc4LjUwNDU1MSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA5NC40NzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQwMi45MjYyNDENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjEuNDk1NDQ5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDk0LjQ3MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDAyLjkyNjI0MQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU2VjdG9yIEgiLA0KICAgICAgICAgICAgIk9iaklkIjogMzA3LA0KICAgICAgICAgICAgIlNlY3RvckFyZWEiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEgvQ2FwSCBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNlY3RvciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAyOC4zOTg4LA0KICAgICAgICAgICAgICAgICJ5IjogMTE1LjIzNCwNCiAgICAgICAgICAgICAgICAieiI6IC0zNTMuMzkyDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBIL1NlY3RvciBIIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIlNlY3RvckFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIldvcmxkSWNvbiBIIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDQwNywNCiAgICAgICAgICAgICJ0eXBlIjogIldvcmxkSWNvbiIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAyOC4zOTg4LA0KICAgICAgICAgICAgICAgICJ5IjogMTI1LjIzNCwNCiAgICAgICAgICAgICAgICAieiI6IC0zNTMuMzkyDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBIL1dvcmxkSWNvbiBIIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXB0dXJlUG9pbnQgSCIsDQogICAgICAgICAgICAiT2JqSWQiOiA2MDcsDQogICAgICAgICAgICAiQ2FwdHVyZUFyZWEiOiBudWxsLA0KICAgICAgICAgICAgInR5cGUiOiAiQ2FwdHVyZVBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDI4LjM5ODgsDQogICAgICAgICAgICAgICAgInkiOiAxMzUuMjM0LA0KICAgICAgICAgICAgICAgICJ6IjogLTM1My4zOTINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEgvQ2FwdHVyZVBvaW50IEgiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiQ2FwdHVyZUFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBHIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDIwNiwNCiAgICAgICAgICAgICJBcmVhIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBHL0NhcEcgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAyNjguMzQyLA0KICAgICAgICAgICAgICAgICJ5IjogOTMuMTg4MiwNCiAgICAgICAgICAgICAgICAieiI6IC00MjIuMDUxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBHIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcEcgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRy9DYXBHIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgImhlaWdodCI6IDIwLA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjYwLjg2MjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzk1LjA1NTE2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjY4LjMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzk2LjUxNjA2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMzAzLjAyNDUsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDEyLjI3ODA1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjk5LjQ2NTEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDI0LjAyNjIyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjk3LjU4NDQsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDQwLjQwMjQ2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjg5LjI1NjYsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDU4Ljk3NTA2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjcyLjAwMDksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDUyLjY5ODY2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjU0Ljg3OTcyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc4LjkzNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ1MS44NzMxNg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDI0MS4yODM2OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OC45MzQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00NTEuNTgwNDYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAyMjguNDQyNCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OC45MzQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00NTAuOTQ2MTYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAyMjEuNTIzOCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OC45MzQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00NDIuNTg4MDYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAyMTkuNzY3MSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OC45MzQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MzMuMDc0NTYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAyNDQuNjgyMzIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzguOTM0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDEzLjI1MTkzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjQ5LjI3OTgyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc4LjkzNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQwOS4wNDI0NQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDI1Mi43MzYxOCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OC45MzQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zOTcuMzY2MzYNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNlY3RvciBHIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDMwNiwNCiAgICAgICAgICAgICJTZWN0b3JBcmVhIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBHL0NhcEcgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJTZWN0b3IiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMjY4LjM0MiwNCiAgICAgICAgICAgICAgICAieSI6IDgzLjE4ODIsDQogICAgICAgICAgICAgICAgInoiOiAtNDIyLjA1MQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRy9TZWN0b3IgRyIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJTZWN0b3JBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJXb3JsZEljb24gRyIsDQogICAgICAgICAgICAiT2JqSWQiOiA0MDYsDQogICAgICAgICAgICAidHlwZSI6ICJXb3JsZEljb24iLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMjY4LjM0MiwNCiAgICAgICAgICAgICAgICAieSI6IDkzLjE4ODIsDQogICAgICAgICAgICAgICAgInoiOiAtNDIyLjA1MQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRy9Xb3JsZEljb24gRyINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZVBvaW50IEciLA0KICAgICAgICAgICAgIk9iaklkIjogNjA2LA0KICAgICAgICAgICAgInR5cGUiOiAiQ2FwdHVyZVBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDI2OC4zNDIsDQogICAgICAgICAgICAgICAgInkiOiAxMDMuMTg4MiwNCiAgICAgICAgICAgICAgICAieiI6IC00MjIuMDUxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBHL0NhcHR1cmVQb2ludCBHIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRiIsDQogICAgICAgICAgICAiT2JqSWQiOiAyMDUsDQogICAgICAgICAgICAiQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRi9DYXBGIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMTA1LjIwMywNCiAgICAgICAgICAgICAgICAieSI6IDk5LjEzMTYsDQogICAgICAgICAgICAgICAgInoiOiAtNDEzLjk3NQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRiIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXBGIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEYvQ2FwRiBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAyMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDk5LjIwNDU0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgzLjMwNTEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ0Mi4wNDk3DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogNzYuNTYxOCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4My4zMDUxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MjguODExNQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDc3LjMxMTEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODMuMzA1MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDExLjY5MDQ1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogODAuNjgwMiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4My4zMDUxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MDEuMjkyOQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDkwLjAwODksDQogICAgICAgICAgICAgICAgICAgICJ5IjogODMuMzA1MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzc2LjkzMzYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAxMDcuNTI5ODQsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODMuMzA1MSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzgyLjIyNzQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAxMTguNjIzNSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4My4zMDUxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zODkuMTIyMw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDEzMy43MDMyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgzLjMwNTEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQwNy45MDczNA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDEzNi45NjAyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgzLjMwNTEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQxOS4yNDUyNg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDEzMS42MzI3LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgzLjMwNTEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQzMi4yNjU4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMTEzLjc4MzE1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgzLjMwNTEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQzOC42MDc4DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTZWN0b3IgRiIsDQogICAgICAgICAgICAiT2JqSWQiOiAzMDUsDQogICAgICAgICAgICAiU2VjdG9yQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRi9DYXBGIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEwNS4yMDMsDQogICAgICAgICAgICAgICAgInkiOiA4OS4xMzE2LA0KICAgICAgICAgICAgICAgICJ6IjogLTQxMy45NzUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEYvU2VjdG9yIEYiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiV29ybGRJY29uIEYiLA0KICAgICAgICAgICAgIk9iaklkIjogNDA1LA0KICAgICAgICAgICAgInR5cGUiOiAiV29ybGRJY29uIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEwNS4yMDMsDQogICAgICAgICAgICAgICAgInkiOiA5OS4xMzE2LA0KICAgICAgICAgICAgICAgICJ6IjogLTQxMy45NzUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEYvV29ybGRJY29uIEYiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVQb2ludCBGIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDYwNSwNCiAgICAgICAgICAgICJ0eXBlIjogIkNhcHR1cmVQb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAxMDUuMjAzLA0KICAgICAgICAgICAgICAgICJ5IjogMTA5LjEzMTYsDQogICAgICAgICAgICAgICAgInoiOiAtNDEzLjk3NQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRi9DYXB0dXJlUG9pbnQgRiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEUiLA0KICAgICAgICAgICAgIk9iaklkIjogMjA0LA0KICAgICAgICAgICAgIkFyZWEiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEUvQ2FwRSBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDgzLjQ1MywNCiAgICAgICAgICAgICAgICAieSI6IDk2LjA2MDMsDQogICAgICAgICAgICAgICAgInoiOiAtMTU3LjUwNw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXBFIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEUvQ2FwRSBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAyMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDY0LjIxODEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzkuNjcxNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMTMxLjkzMzgNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA3MS4xOTIyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc5LjY3MTcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTEzMS4zNTk0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogODkuOTM2ODksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzkuNjcxNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMTMzLjIwOTUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAxMTAuOTI3NywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OS42NzE3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0xNTAuNDAzNjUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAxMTAuMzQ1OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OS42NzE3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0xNzIuMDA1Mg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDg5Ljg2Nzk2NiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OS42NzE3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0xODIuNTE2Mg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDczLjI3MzEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzkuNjcxNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMTgzLjU0NDcNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA2MC45MDI0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc5LjY3MTcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTE3Ny44MjMzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogNTkuNDAzNywNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3OS42NzE3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0xNjUuNjc2MTQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA2Mi4yMzM1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc5LjY3MTcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTEzNC40MTMyDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTZWN0b3IgRSIsDQogICAgICAgICAgICAiT2JqSWQiOiAzMDQsDQogICAgICAgICAgICAiU2VjdG9yQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRS9DYXBFIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDgzLjQ1MywNCiAgICAgICAgICAgICAgICAieSI6IDg2LjA2MDMsDQogICAgICAgICAgICAgICAgInoiOiAtMTU3LjUwNw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRS9TZWN0b3IgRSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJTZWN0b3JBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJXb3JsZEljb24gRSIsDQogICAgICAgICAgICAiT2JqSWQiOiA0MDQsDQogICAgICAgICAgICAidHlwZSI6ICJXb3JsZEljb24iLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogODMuNDUzLA0KICAgICAgICAgICAgICAgICJ5IjogOTYuMDYwMywNCiAgICAgICAgICAgICAgICAieiI6IC0xNTcuNTA3DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBFL1dvcmxkSWNvbiBFIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXB0dXJlUG9pbnQgRSIsDQogICAgICAgICAgICAiT2JqSWQiOiA2MDQsDQogICAgICAgICAgICAidHlwZSI6ICJDYXB0dXJlUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogODMuNDUzLA0KICAgICAgICAgICAgICAgICJ5IjogMTA2LjA2MDMsDQogICAgICAgICAgICAgICAgInoiOiAtMTU3LjUwNw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRS9DYXB0dXJlUG9pbnQgRSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEQiLA0KICAgICAgICAgICAgIk9iaklkIjogMjAzLA0KICAgICAgICAgICAgIkFyZWEiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEQvQ2FwRCBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDI5LjY1MzksDQogICAgICAgICAgICAgICAgInkiOiA5OS4wNDA2LA0KICAgICAgICAgICAgICAgICJ6IjogLTM0OS4zMTkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEQiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwRCBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBEL0NhcEQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMjUsDQogICAgICAgICAgICAicG9pbnRzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA2MC42MTI0OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA3Ny4wMzg3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMTMuMDQwNw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDIzLjI2ODc1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc3LjAzODcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQwNi45ODM0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTUuOTk1MjEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzcuMDM4NywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzk1LjgzMDINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAwLjIzNDg5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc3LjAzODcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTM2OC44MTI3NQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDI0LjA1NDkyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDc3LjAzODcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMxMC45Mzc3DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMzcuMzY3NjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogNzcuMDM4NywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjk5Ljk0OTINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNlY3RvciBEIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDMwMywNCiAgICAgICAgICAgICJTZWN0b3JBcmVhIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBEL0NhcEQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJTZWN0b3IiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMjkuNjUzOSwNCiAgICAgICAgICAgICAgICAieSI6IDg5LjA0MDYsDQogICAgICAgICAgICAgICAgInoiOiAtMzQ5LjMxOQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRC9TZWN0b3IgRCIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJTZWN0b3JBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJXb3JsZEljb24gRCIsDQogICAgICAgICAgICAiT2JqSWQiOiA0MDMsDQogICAgICAgICAgICAidHlwZSI6ICJXb3JsZEljb24iLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMjkuNjUzOSwNCiAgICAgICAgICAgICAgICAieSI6IDk5LjA0MDYsDQogICAgICAgICAgICAgICAgInoiOiAtMzQ5LjMxOQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgRC9Xb3JsZEljb24gRCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZVBvaW50IEQiLA0KICAgICAgICAgICAgIk9iaklkIjogNjAzLA0KICAgICAgICAgICAgInR5cGUiOiAiQ2FwdHVyZVBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDI5LjY1MzksDQogICAgICAgICAgICAgICAgInkiOiAxMDkuMDQwNiwNCiAgICAgICAgICAgICAgICAieiI6IC0zNDkuMzE5DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBEL0NhcHR1cmVQb2ludCBEIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQyIsDQogICAgICAgICAgICAiT2JqSWQiOiAyMDIsDQogICAgICAgICAgICAiQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQy9DYXBDIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTM2LjQ3OTcsDQogICAgICAgICAgICAgICAgInkiOiA5NS42MzIsDQogICAgICAgICAgICAgICAgInoiOiAtNTMwLjY1MQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQyIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDYXBDIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEMvQ2FwQyBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAxNSwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDIyLjg1NDk0OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01MDQuNTgxMg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDMxLjkzNDI0OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01MTkuMTIwNA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDM1LjY5Mzg0OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01MzMuMjk2Mzg4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjkuMzEyNzQ4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU0OS40OTAzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMjAuNjQ5ODQ4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU2My4wNzENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiA4Ljk0MDY0OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01NzcuNjkwMQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03LjIxNTQ1MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01ODUuOTI1NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yNy43NDI4MTIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODQuOTE0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNTg2LjE4MjYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNTIuOTk0MjUyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU4My4zNDcNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzcuNjQ4NzUyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU3My4zNjQ0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTk1LjE0MjU1MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01NTguNTA2OA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xMDIuMTk5MTUyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU0MC4yMzU0OA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xMDAuODU3OTUyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTUyNC44NDk1NQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC05Ni42NjI4NTIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODQuOTE0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNTA2LjE5MDkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtODQuODM2ODUyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ5NS41NzgzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTczLjM2ODc1MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00ODQuMzA5OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01Ni44NTUzNTIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODQuOTE0NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDc3LjcwNTYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMzguNTA1OTQyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ2OS44ODM5DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE4LjcyMjY1MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4NC45MTQ2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00NzAuNDAzNA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IDEuMTI2NjQ4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ3OC4wMjY1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogMTQuODMwNzQ4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDg0LjkxNDYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ5MS41NzEzDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTZWN0b3IgQyIsDQogICAgICAgICAgICAiT2JqSWQiOiAzMDIsDQogICAgICAgICAgICAiU2VjdG9yQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQy9DYXBDIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0zNi40Nzk3LA0KICAgICAgICAgICAgICAgICJ5IjogODUuNjMyLA0KICAgICAgICAgICAgICAgICJ6IjogLTUzMC42NTENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEMvU2VjdG9yIEMiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiV29ybGRJY29uIEMiLA0KICAgICAgICAgICAgIk9iaklkIjogNDAyLA0KICAgICAgICAgICAgInR5cGUiOiAiV29ybGRJY29uIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0zNi40Nzk3LA0KICAgICAgICAgICAgICAgICJ5IjogOTUuNjMyLA0KICAgICAgICAgICAgICAgICJ6IjogLTUzMC42NTENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEMvV29ybGRJY29uIEMiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVQb2ludCBDIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDYwMiwNCiAgICAgICAgICAgICJ0eXBlIjogIkNhcHR1cmVQb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMzYuNDc5NywNCiAgICAgICAgICAgICAgICAieSI6IDEwNS42MzIsDQogICAgICAgICAgICAgICAgInoiOiAtNTMwLjY1MQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQy9DYXB0dXJlUG9pbnQgQyINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIiLA0KICAgICAgICAgICAgIk9iaklkIjogMjAxLA0KICAgICAgICAgICAgIkFyZWEiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIvQ2FwQiBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC02My44MzQ1LA0KICAgICAgICAgICAgICAgICJ5IjogOTcuNjE3NiwNCiAgICAgICAgICAgICAgICAieiI6IC0yODIuOTk1DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBCIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcEIgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQi9DYXBCIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgImhlaWdodCI6IDE1LA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTk4Ljc2MTUsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODEuMzUwMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjY0LjIyNzgNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtODguMjkyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI0Ny45NTA3DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTc1Ljg3NDUsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODEuMzUwMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjU2LjI3OTkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjEuODI3MTYsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODEuMzUwMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjY4LjE2OTkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDUuMzQwMiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4MS4zNTAxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNjkuNzUzNA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yNS4zODc5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI3MC40ODk4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI4Ni4zOTM3Nw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0zMy4zMTg0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI5Ny4wMDI0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTUyLjAyNSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4MS4zNTAxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMDUuMzU4Mg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC02NS44NTI0NSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA4MS4zNTAxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMjkuODc2Mg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC04Ni4zMjk1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMyMi43OTU4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTk0LjEzODcsDQogICAgICAgICAgICAgICAgICAgICJ5IjogODEuMzUwMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzA5LjIyMDYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtOTAuMjQxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDgxLjM1MDEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI4MS42NDg5Ng0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU2VjdG9yIEIiLA0KICAgICAgICAgICAgIk9iaklkIjogMzAxLA0KICAgICAgICAgICAgIlNlY3RvckFyZWEiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIvQ2FwQiBQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNlY3RvciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNjMuODM0NSwNCiAgICAgICAgICAgICAgICAieSI6IDg3LjYxNzYsDQogICAgICAgICAgICAgICAgInoiOiAtMjgyLjk5NQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQi9TZWN0b3IgQiIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJTZWN0b3JBcmVhIg0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJXb3JsZEljb24gQiIsDQogICAgICAgICAgICAiT2JqSWQiOiA0MDEsDQogICAgICAgICAgICAidHlwZSI6ICJXb3JsZEljb24iLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTYzLjgzNDUsDQogICAgICAgICAgICAgICAgInkiOiA5Ny42MTc2LA0KICAgICAgICAgICAgICAgICJ6IjogLTI4Mi45OTUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIvV29ybGRJY29uIEIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVQb2ludCBCIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDYwMSwNCiAgICAgICAgICAgICJ0eXBlIjogIkNhcHR1cmVQb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNjMuODM0NSwNCiAgICAgICAgICAgICAgICAieSI6IDEwNy42MTc2LA0KICAgICAgICAgICAgICAgICJ6IjogLTI4Mi45OTUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIvQ2FwdHVyZVBvaW50IEIiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBBIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDIwMCwNCiAgICAgICAgICAgICJBcmVhIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBBL0NhcEEgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMjExLjE1LA0KICAgICAgICAgICAgICAgICJ5IjogOTQuMDY2OSwNCiAgICAgICAgICAgICAgICAieiI6IC0zMDAuNzE4DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVBcmVhVHJpZ2dlciBBIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcEEgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQS9DYXBBIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgImhlaWdodCI6IDM1LA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE3My4wMzc5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI2OS45MDY5NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xNzAuODIxNSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2NC41NjkyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNzQuNTUxNjINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMTY4LjEzNjUsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjQuNTY5MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjg0LjU5NDY4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE2OS4zOTI3LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI5MS43NTY1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE3My44NjgyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMwMi40NTQxDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE3Ni44NTg1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMxMi42MzE2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE4Ny41MjkyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMyNS41MzA4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTIwMS45NDg5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMzMi44NTAzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTIzNC45NTkzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMzMS43OTIxDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI0OC4zNzE3LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMyNy45ODU5DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI2MS44MDY5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMyMy44Nzc5DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI2Mi40MTIyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMwNy45NjIzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI1OS4zMzM0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI4OS43MTgzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI1OS40MzY5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI3Ni4yMzY4Mw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yNDAuNjE0NCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2NC41NjkyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNzUuNDQ4MjMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjI2LjM0Njc4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI3NS4zMzM5Nw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yMjAuMTE2MDYsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjQuNTY5MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjczLjY0ODMzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTIxNS45NTIxNSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2NC41NjkyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNzAuNTk2MTUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjA1LjExNTIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNjQuNTY5MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjY5LjUxODI0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE5NC40NTA5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDY0LjU2OTIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI2OC4xMDU0NQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xODEuMjk5MiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiA2NC41NjkyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNjcuMjI5DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTZWN0b3IgQSIsDQogICAgICAgICAgICAiT2JqSWQiOiAzMDAsDQogICAgICAgICAgICAiU2VjdG9yQXJlYSI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQS9DYXBBIFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0yMTEuMTUsDQogICAgICAgICAgICAgICAgInkiOiA4NC4wNjY5LA0KICAgICAgICAgICAgICAgICJ6IjogLTMwMC43MTgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEEvU2VjdG9yIEEiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiV29ybGRJY29uIEEiLA0KICAgICAgICAgICAgIk9iaklkIjogNDAwLA0KICAgICAgICAgICAgInR5cGUiOiAiV29ybGRJY29uIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0yMTEuMTUsDQogICAgICAgICAgICAgICAgInkiOiA5NC4wNjY5LA0KICAgICAgICAgICAgICAgICJ6IjogLTMwMC43MTgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEEvV29ybGRJY29uIEEiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNhcHR1cmVQb2ludCBBIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDYwMCwNCiAgICAgICAgICAgICJ0eXBlIjogIkNhcHR1cmVQb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMjExLjE1LA0KICAgICAgICAgICAgICAgICJ5IjogMTA0LjA2NjksDQogICAgICAgICAgICAgICAgInoiOiAtMzAwLjcxOA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJDYXB0dXJlQXJlYVRyaWdnZXIgQS9DYXB0dXJlUG9pbnQgQSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZyIsDQogICAgICAgICAgICAiT2JqSWQiOiAxMDAwLA0KICAgICAgICAgICAgIkNhcHR1cmVQb2ludHMiOiBbDQogICAgICAgICAgICAgICAgIkNhcHR1cmVBcmVhVHJpZ2dlciBBL0NhcHR1cmVQb2ludCBBIiwNCiAgICAgICAgICAgICAgICAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEIvQ2FwdHVyZVBvaW50IEIiLA0KICAgICAgICAgICAgICAgICJDYXB0dXJlQXJlYVRyaWdnZXIgQy9DYXB0dXJlUG9pbnQgQyIsDQogICAgICAgICAgICAgICAgIkNhcHR1cmVBcmVhVHJpZ2dlciBEL0NhcHR1cmVQb2ludCBEIiwNCiAgICAgICAgICAgICAgICAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEUvQ2FwdHVyZVBvaW50IEUiLA0KICAgICAgICAgICAgICAgICJDYXB0dXJlQXJlYVRyaWdnZXIgRi9DYXB0dXJlUG9pbnQgRiIsDQogICAgICAgICAgICAgICAgIkNhcHR1cmVBcmVhVHJpZ2dlciBHL0NhcHR1cmVQb2ludCBHIiwNCiAgICAgICAgICAgICAgICAiQ2FwdHVyZUFyZWFUcmlnZ2VyIEgvQ2FwdHVyZVBvaW50IEgiDQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgInR5cGUiOiAiU2VjdG9yIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC01OS44NjkzLA0KICAgICAgICAgICAgICAgICJ5IjogMjE0LjA5MiwNCiAgICAgICAgICAgICAgICAieiI6IC0zNTcuMDMxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkNhcHR1cmVQb2ludCBTZWN0b3IgT3JkZXJpbmciLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiQ2FwdHVyZVBvaW50cyINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgQSBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBBIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgQiBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBCIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgQyBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBDIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgRCBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBEIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgRSBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBFIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgRiBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBGIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRHVtbXkgRyBDYXB0dXJlIFBvaW50IFBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiQ2FwdHVyZVBvaW50IFNlY3RvciBPcmRlcmluZy9EdW1teSBHIENhcHR1cmUgUG9pbnQgUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDY0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjQ3Ljk2OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MDU0Ljg2OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogNDE3LjQzMiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiA0NjM3Ljk2OQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfQ0KICAgIF0sDQogICAgIlN0YXRpYyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiTVBfVHVuZ3N0ZW5fVGVycmFpbiIsDQogICAgICAgICAgICAibWV0YWRhdGEvX2VkaXRfbG9ja18iOiB0cnVlLA0KICAgICAgICAgICAgInR5cGUiOiAiTVBfVHVuZ3N0ZW5fVGVycmFpbiIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiU3RhdGljL01QX1R1bmdzdGVuX1RlcnJhaW4iDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIk1QX1R1bmdzdGVuX0Fzc2V0cyIsDQogICAgICAgICAgICAibWV0YWRhdGEvX2VkaXRfbG9ja18iOiB0cnVlLA0KICAgICAgICAgICAgInR5cGUiOiAiTVBfVHVuZ3N0ZW5fQXNzZXRzIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJTdGF0aWMvTVBfVHVuZ3N0ZW5fQXNzZXRzIg0KICAgICAgICB9DQogICAgXQ0KfQ==","compiled":""},"attachmentType":1,"metadata":"mapIdx=0","errors":[]}]}