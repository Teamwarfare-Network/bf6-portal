{"mutators":{"MaxPlayerCount_PerTeam":32,"FriendlyFireAllowed_PerTeam":true,"SquadSpawnMode_PerTeam":3,"ManDownExperienceType_PerTeam":2,"SquadReviveAllowed_PerTeam":false,"AI_ManDownExperienceType_PerTeam":1,"fPortalExperienceGameTime":60,"EnableClassLockedWeaponLoadouts":true},"assetRestrictions":{"AssaultClass":false,"ReconClass":false,"SupportClass":false,"Portal_WebApp_AR":false,"Portal_WebApp_Carbine":false,"Portal_WebApp_DMR":false,"Portal_WebApp_MG":false,"Portal_WebApp_Pistol":false,"Portal_WebApp_SR":false,"Portal_WebApp_SG":false,"Portal_WebApp_PDW":false,"U_TUGS":false,"U_Gadget_SupplyCrate":false,"U_AdrenalineShot":false,"Portal_WebApp_Explosive":false,"Portal_WebApp_GrenadeLauncher":false,"Portal_WebApp_Gadget_Misc":false,"Portal_WebApp_StrikePackage":false,"Portal_WebApp_Throwable":false,"Portal_WebApp_Armor":false},"name":"TWL Tanks Only - Golf Course v0.259","description":"Source Code on github and competitive ruleset available on the TWL website\nAny feedback, questions or issues can be raised on our discord server\nTeamwarfare . net - Compete in competitive tanks ladders today!","mapRotation":[{"id":"MP_Granite_ClubHouse_Portal-ModBuilderCustom0","spatialAttachment":{"id":"2aa61c44-30ac-4353-ba33-565750c7bca0","filename":"MP_TWL2v2Tanks_Granite_ClubHouse_Portal.spatial.json","metadata":"mapIdx=0","version":"123","isProcessable":true,"processingStatus":2,"attachmentData":{"original":"ew0KICAgICJQb3J0YWxfRHluYW1pYyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiVEVBTV8xX0hRIiwNCiAgICAgICAgICAgICJBbHRUZWFtIjogIlRlYW1OZXV0cmFsIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDEsDQogICAgICAgICAgICAiSW5mYW50cnlTcGF3bnMiOiBbDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMSIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMiIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMyIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfNCINCiAgICAgICAgICAgIF0sDQogICAgICAgICAgICAiSFFBcmVhIjogIlRFQU1fMV9IUS9IUV9UZWFtMSIsDQogICAgICAgICAgICAidHlwZSI6ICJIUV9QbGF5ZXJTcGF3bmVyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03NjQuNTA4LA0KICAgICAgICAgICAgICAgICJ5IjogMTQ2LjY5NiwNCiAgICAgICAgICAgICAgICAieiI6IC04NTYuMTkzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMV9IUSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJIUUFyZWEiLA0KICAgICAgICAgICAgICAgICJJbmZhbnRyeVNwYXducyINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiSFFfVGVhbTEiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8xX0hRL0hRX1RlYW0xIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAwLA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTc1OS41MDgsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTUxLjY5NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtODUxLjE5Mw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NTkuNTA4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDE1MS42OTYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTg2MS4xOTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzY5LjUwOCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxNTEuNjk2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04NjEuMTkzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTc2OS41MDgsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTUxLjY5NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtODUxLjE5Mw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8xXzEiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjk5OTg4NCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjAxNTI1MzUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMC4wMTUyNTM1LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuOTk5ODg0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTc2NC41MDgsDQogICAgICAgICAgICAgICAgInkiOiAxNDYuNjk2LA0KICAgICAgICAgICAgICAgICJ6IjogLTg1OS4xOTMNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8xX0hRL1NwYXduUG9pbnRfMV8xIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTcGF3blBvaW50XzFfMiIsDQogICAgICAgICAgICAidHlwZSI6ICJTcGF3blBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjk5OTUsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC4wMzE2MTk4DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuMDMxNjE5OCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAtMC45OTk1DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTc2MS41MDgsDQogICAgICAgICAgICAgICAgInkiOiAxNDYuNjk2LA0KICAgICAgICAgICAgICAgICJ6IjogLTg1Ni4xOTMNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8xX0hRL1NwYXduUG9pbnRfMV8yIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTcGF3blBvaW50XzFfMyIsDQogICAgICAgICAgICAidHlwZSI6ICJTcGF3blBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjA0Mjg4NzEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogLTAuOTk5MDgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjk5OTA4LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjA0Mjg4NzENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzY3LjUwOCwNCiAgICAgICAgICAgICAgICAieSI6IDE0Ni42OTYsDQogICAgICAgICAgICAgICAgInoiOiAtODU2LjE5Mw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzMiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNwYXduUG9pbnRfMV80IiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNwYXduUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC4wODQxODE5LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuOTk2NDUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMC45OTY0NSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjA4NDE4MTkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzY0LjUwOCwNCiAgICAgICAgICAgICAgICAieSI6IDE0Ni42OTYsDQogICAgICAgICAgICAgICAgInoiOiAtODUzLjE5Mw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRFQU1fMl9IUSIsDQogICAgICAgICAgICAiVGVhbSI6ICJUZWFtMiIsDQogICAgICAgICAgICAiQWx0VGVhbSI6ICJUZWFtTmV1dHJhbCIsDQogICAgICAgICAgICAiT2JqSWQiOiAyLA0KICAgICAgICAgICAgIkluZmFudHJ5U3Bhd25zIjogWw0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzEiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzIiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzMiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzQiDQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgIkhRQXJlYSI6ICJURUFNXzJfSFEvSFFfVGVhbTIiLA0KICAgICAgICAgICAgInR5cGUiOiAiSFFfUGxheWVyU3Bhd25lciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjk4MzA2NywNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAtMC4xODMyNDgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjE4MzI0OCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjk4MzA2Nw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03MjQuNzY5LA0KICAgICAgICAgICAgICAgICJ5IjogMTQxLjMxNywNCiAgICAgICAgICAgICAgICAieiI6IC0yNzEuNjUzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMl9IUSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJIUUFyZWEiLA0KICAgICAgICAgICAgICAgICJJbmZhbnRyeVNwYXducyINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiSFFfVGVhbTIiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8yX0hRL0hRX1RlYW0yIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAwLA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTcxOS43NjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTQ2LjMxNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjY2LjY1Mw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03MTkuNzY5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDE0Ni4zMTcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI3Ni42NTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzI5Ljc2OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxNDYuMzE3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNzYuNjUzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTcyOS43NjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTQ2LjMxNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjY2LjY1Mw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8yXzEiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjkzMTYwNDY4NTE4LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjM2MzQ3ODU4MTkzMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuMzYzNDc4NTgxOTMxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuOTMxNjA0Njg1MTgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzExLjE4NTg1NTE4MjksDQogICAgICAgICAgICAgICAgInkiOiAxNDEuMTM1MzE0LA0KICAgICAgICAgICAgICAgICJ6IjogLTI4NC41MzQ4MTc1OTU4DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMl9IUS9TcGF3blBvaW50XzJfMSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8yXzIiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjc4NjgzODY1MjAzMiwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAtMC42MTcxNjAyNDA4MjUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjYxNzE2MDI0MDgyNSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjc4NjgzODY1MjAzMg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03MTQuMTk2ODQ3MTA5MiwNCiAgICAgICAgICAgICAgICAieSI6IDE0MS4xMzUzMTQsDQogICAgICAgICAgICAgICAgInoiOiAtMjgxLjU0NTk5ODM0NDA1DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMl9IUS9TcGF3blBvaW50XzJfMiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8yXzMiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjkwMTg4NTUxNzUwOCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAtMC40MzE5NzU1MDI3Mg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuNDMxOTc1NTAyNzIsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC45MDE4ODU1MTc1MDgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzE0LjE3NDg0MDIxOTUsDQogICAgICAgICAgICAgICAgInkiOiAxNDEuMTM1MzE0LA0KICAgICAgICAgICAgICAgICJ6IjogLTI4Ny41NDU4ODAzNDE2DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMl9IUS9TcGF3blBvaW50XzJfMyINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8yXzQiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjQ1NTA0ODQ4MjUyNSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAtMC44OTA0NjY0MzI3NzkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjg5MDQ2NjQzMjc3OSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjQ1NTA0ODQ4MjUyNQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03MTcuMTg1Nzg2MzMzOCwNCiAgICAgICAgICAgICAgICAieSI6IDE0MS4xMzUzMTQsDQogICAgICAgICAgICAgICAgInoiOiAtMjg0LjU1NjgxNTMyMzENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8yX0hRL1NwYXduUG9pbnRfMl80Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDb21iYXRBcmVhIiwNCiAgICAgICAgICAgICJDb21iYXRWb2x1bWUiOiAiQ29tYmF0QXJlYS9Db21iYXRWb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiQ29tYmF0QXJlYSIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ29tYmF0QXJlYSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJDb21iYXRWb2x1bWUiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNvbWJhdFZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJpZCI6ICJDb21iYXRBcmVhL0NvbWJhdFZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMTAsDQogICAgICAgICAgICAicG9pbnRzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjMwLjc5OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04NzUuNTUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjg4Ljc0MywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04NzMuNTcNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzcxLjA1MSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04NjcuMDM0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTgwMS40MjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNzg5Ljg3Ng0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC04MzcuMzMyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTYzMC41NTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtODE5LjUyMSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01NjEuNjI0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTgxNC4xNywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00ODMuMDU4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTgyOC43NTEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzc4Ljk1Nw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC04MjEuODY0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMyMi44MzMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzUwLjg1NSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yODcuMTE2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTcxMy42NSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNTkuMzENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjgxLjM4OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yMzcuNDIyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTY1Mi45NTksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjI2LjQ5Nw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC02MTMuODY5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTIzNS4zNzENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNTY1LjczNiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNDAuNjM1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTUxNy41ODksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjI0LjU5Nw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC00NjEuMzI4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTIwMi40NjINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDA1LjM0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTIwNC4zNTkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMzQyLjQzNiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNDYuNjg1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI2Mi4xODcsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjM4Ljc5OA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yMzMuOTU3LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI5NS43OTUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjE5LjEyMiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMzEuODk3DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE4Mi42ODksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzc5LjM2NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xNjAuNDgsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDI1LjYxNQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xNDYuNzUzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQyNS42NzQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMTIzLjg2NSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MjkuNDE2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTExMS45NzEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDUzLjI3MQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xMDQuOTU4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ3Ny44MzQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtODYuNjcyMiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00OTEuMDU4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTczLjg4MjIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNTQ1Ljc5OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01OC42MTc1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU5MS42OTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDkuMzU2OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC02NjIuMjA5DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTQ4LjY4MzcsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNzM5LjQ2NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03Ni44MzU1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTgzMS41MzgNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMTYyLjYzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTkzMS42NjUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjAxLjM2OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC05NTYuNjMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjc0LjgzMywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC05ODQuNDg1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTM2NC43NCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC05OTMuMTE0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTQ2Ny40ODYsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtOTg2LjQzNw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MTkuMDc4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTk1NC4yNg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRGVwbG95Q2FtIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkRlcGxveUNhbSIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMC4xMDEwNTYsDQogICAgICAgICAgICAgICAgInoiOiAtMC45OTQ4ODENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMC45OTQ4ODEsDQogICAgICAgICAgICAgICAgInoiOiAwLjEwMTA1Ng0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC00OTAuODgsDQogICAgICAgICAgICAgICAgInkiOiA1MDguNDI2LA0KICAgICAgICAgICAgICAgICJ6IjogLTU5OC4xODMNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FtZXJhM0QvRGVwbG95Q2FtIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJOb3J0aEJhc2VBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAiT2JqSWQiOiA1MDEsDQogICAgICAgICAgICAiQXJlYSI6ICJOb3J0aEJhc2VBcmVhVHJpZ2dlci9Ob3J0aEJhc2VPT0JQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03NDkuNjU5LA0KICAgICAgICAgICAgICAgICJ5IjogMTQ4LjM3MiwNCiAgICAgICAgICAgICAgICAieiI6IC04NDMuNDA3DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIk5vcnRoQmFzZUFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIk5vcnRoQmFzZU9PQlBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiTm9ydGhCYXNlQXJlYVRyaWdnZXIvTm9ydGhCYXNlT09CUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NzIuNjY5OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTQ4LjM3MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtODY2LjQ0OTAyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTc5Mi44MjQ0MywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxNDguMzcyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04MTEuMTExMzINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzY0LjY5NTgzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDE0OC4zNzIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTgwMC4zMzI1Mg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NDcuNzU3NjMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTQ4LjM3MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtODA2LjkzNjAyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTc0MC41MTcxMywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxNDguMzcyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04MjQuODE4NzINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzI2LjcwMzUzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDE0OC4zNzIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTgzMS4yMjgwMg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC02OTcuNzI2MTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTQ4LjM3MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtODMzLjA2NDkyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTY4OC41NTg0MywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxNDguMzcyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04NzMuNTExNzINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIk5vcnRoQmFzZVNlY3RvciIsDQogICAgICAgICAgICAiU2VjdG9yQXJlYSI6ICJOb3J0aEJhc2VBcmVhVHJpZ2dlci9Ob3J0aEJhc2VPT0JQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNlY3RvciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzQ5LjY1OSwNCiAgICAgICAgICAgICAgICAieSI6IDE0OC4zNzIsDQogICAgICAgICAgICAgICAgInoiOiAtODQzLjQwNw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJOb3J0aEJhc2VBcmVhVHJpZ2dlci9Ob3J0aEJhc2VTZWN0b3IiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU291dGhCYXNlQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgIk9iaklkIjogNTAwLA0KICAgICAgICAgICAgIkFyZWEiOiAiU291dGhCYXNlQXJlYVRyaWdnZXIvU291dGhCYXNlT09CUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzA0LjQyLA0KICAgICAgICAgICAgICAgICJ5IjogMTQ4LjM3MiwNCiAgICAgICAgICAgICAgICAieiI6IC0yODQuMzExDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlNvdXRoQmFzZUFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNvdXRoQmFzZU9PQlBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiU291dGhCYXNlQXJlYVRyaWdnZXIvU291dGhCYXNlT09CUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NTEuODAzODMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTM3LjE0MTMsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMxNy45NjEzMg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NjguNDczNjMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTM3LjE0MTMsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI5Ni4wMDYyOA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NTAuODgyMzMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTM3LjE0MTMsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI4Ny4xNjA5MTYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjgxLjE2MjIzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yMzcuMzQ2MjINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjY3LjQ5OTYzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNTEuNzQ5NzINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjg1LjY1NTYzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yODkuODQ3NTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzAwLjI2NjMxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMDIuMTI3MTINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzEyLjI4ODcxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yODguNTIyNDkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzE3Ljg4NzMzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yODcuNzUwNjk4DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTb3V0aEJhc2VTZWN0b3IiLA0KICAgICAgICAgICAgIlNlY3RvckFyZWEiOiAiU291dGhCYXNlQXJlYVRyaWdnZXIvU291dGhCYXNlT09CUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJTZWN0b3IiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTcwNC40MiwNCiAgICAgICAgICAgICAgICAieSI6IDE0OC4zNzIsDQogICAgICAgICAgICAgICAgInoiOiAtMjg0LjMxMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJTb3V0aEJhc2VBcmVhVHJpZ2dlci9Tb3V0aEJhc2VTZWN0b3IiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ29udGFpbmVyXzAyX09wZW5fQSIsDQogICAgICAgICAgICAidHlwZSI6ICJDb250YWluZXJfMDJfT3Blbl9BIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuNzIwNzIxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjY5MzIyNg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuNjkzMjI2LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuNzIwNzIxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTc2My4wODgsDQogICAgICAgICAgICAgICAgInkiOiAxNDEuNTY5LA0KICAgICAgICAgICAgICAgICJ6IjogLTU2OS4zMTkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ29udGFpbmVyXzAyX09wZW5fQSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRm9ya2xpZnRfMDEiLA0KICAgICAgICAgICAgInR5cGUiOiAiRm9ya2xpZnRfMDEiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuMzYyMTk0LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuOTMyMTAzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuOTMyMTAzLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjM2MjE5NA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03NjQuODQ0LA0KICAgICAgICAgICAgICAgICJ5IjogMTQxLjU4NiwNCiAgICAgICAgICAgICAgICAieiI6IC01NzIuNDE0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkZvcmtsaWZ0XzAxIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJGb3JrbGlmdF8wMV9ERFBGIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkZvcmtsaWZ0XzAxX0REUEYiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuNjQyMzczLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuNzY2MzkyDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuNzY2MzkyLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjY0MjM3Mw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03NjguNDczLA0KICAgICAgICAgICAgICAgICJ5IjogMTQxLjU5NCwNCiAgICAgICAgICAgICAgICAieiI6IC01NzcuNDgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiRm9ya2xpZnRfMDFfRERQRiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU2Npc3NvckxpZnRfMDEiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2Npc3NvckxpZnRfMDEiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC43MDg1ODYsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC43MDU2MjQNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMC43MDU2MjQsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC43MDg1ODYNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzcyLjQ2LA0KICAgICAgICAgICAgICAgICJ5IjogMTQxLjYyOSwNCiAgICAgICAgICAgICAgICAieiI6IC01ODAuMzMzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlNjaXNzb3JMaWZ0XzAxIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJHVHJ1Y2tQaWNrdXBfMDEiLA0KICAgICAgICAgICAgInR5cGUiOiAiR1RydWNrUGlja3VwXzAxIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjk0NzU2NCwNCiAgICAgICAgICAgICAgICAieSI6IC0wLjAzODYzNjYsDQogICAgICAgICAgICAgICAgInoiOiAwLjMxNzIyMw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjAwNDQxNTc3LA0KICAgICAgICAgICAgICAgICJ5IjogMC45OTQxNTMsDQogICAgICAgICAgICAgICAgInoiOiAwLjEwNzg5NA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjMxOTUzNywNCiAgICAgICAgICAgICAgICAieSI6IDAuMTAwODM2LA0KICAgICAgICAgICAgICAgICJ6IjogLTAuOTQyMTk0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTc4NC4yODIsDQogICAgICAgICAgICAgICAgInkiOiAxNDIuOTkxLA0KICAgICAgICAgICAgICAgICJ6IjogLTYwMS44OTcNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiR1RydWNrUGlja3VwXzAxIg0KICAgICAgICB9DQogICAgXSwNCiAgICAiU3RhdGljIjogWw0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJNUF9HcmFuaXRlX0NsdWJIb3VzZV9Qb3J0YWxfVGVycmFpbiIsDQogICAgICAgICAgICAibWV0YWRhdGEvX2VkaXRfbG9ja18iOiB0cnVlLA0KICAgICAgICAgICAgInR5cGUiOiAiTVBfR3Jhbml0ZV9DbHViSG91c2VfUG9ydGFsX1RlcnJhaW4iLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlN0YXRpYy9NUF9HcmFuaXRlX0NsdWJIb3VzZV9Qb3J0YWxfVGVycmFpbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiTVBfR3Jhbml0ZV9DbHViSG91c2VfUG9ydGFsX0Fzc2V0cyIsDQogICAgICAgICAgICAibWV0YWRhdGEvX2VkaXRfbG9ja18iOiB0cnVlLA0KICAgICAgICAgICAgInR5cGUiOiAiTVBfR3Jhbml0ZV9DbHViSG91c2VfUG9ydGFsX0Fzc2V0cyIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiU3RhdGljL01QX0dyYW5pdGVfQ2x1YkhvdXNlX1BvcnRhbF9Bc3NldHMiDQogICAgICAgIH0NCiAgICBdDQp9","compiled":""},"attachmentType":1,"errors":[]}}],"workspace":{"mod":{"blocks":{"languageVersion":0,"blocks":[{"type":"modBlock","id":"f`y}HF2MN[sU5oXf5Fi8","x":10,"y":10,"deletable":false,"inputs":{"RULES":{"block":{"type":"ruleBlock","id":"%8VOTreQ9~!6,MNruG]A","extraState":{"isOngoingEvent":true},"fields":{"NAME":"New Rule","EVENTTYPE":"Ongoing","OBJECTTYPE":"Global"}}}}}]}}},"teamComposition":[[1,{"humanCapacity":32}],[2,{"humanCapacity":32}]],"gameMode":"ModBuilderCustom","attachments":[{"id":"2aa61c44-30ac-4353-ba33-565750c7bca0","version":"123","filename":"MP_TWL2v2Tanks_Granite_ClubHouse_Portal.spatial.json","isProcessable":true,"processingStatus":2,"attachmentData":{"original":"ew0KICAgICJQb3J0YWxfRHluYW1pYyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiVEVBTV8xX0hRIiwNCiAgICAgICAgICAgICJBbHRUZWFtIjogIlRlYW1OZXV0cmFsIiwNCiAgICAgICAgICAgICJPYmpJZCI6IDEsDQogICAgICAgICAgICAiSW5mYW50cnlTcGF3bnMiOiBbDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMSIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMiIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfMyIsDQogICAgICAgICAgICAgICAgIlRFQU1fMV9IUS9TcGF3blBvaW50XzFfNCINCiAgICAgICAgICAgIF0sDQogICAgICAgICAgICAiSFFBcmVhIjogIlRFQU1fMV9IUS9IUV9UZWFtMSIsDQogICAgICAgICAgICAidHlwZSI6ICJIUV9QbGF5ZXJTcGF3bmVyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03NjQuNTA4LA0KICAgICAgICAgICAgICAgICJ5IjogMTQ2LjY5NiwNCiAgICAgICAgICAgICAgICAieiI6IC04NTYuMTkzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMV9IUSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJIUUFyZWEiLA0KICAgICAgICAgICAgICAgICJJbmZhbnRyeVNwYXducyINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiSFFfVGVhbTEiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8xX0hRL0hRX1RlYW0xIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAwLA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTc1OS41MDgsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTUxLjY5NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtODUxLjE5Mw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NTkuNTA4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDE1MS42OTYsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTg2MS4xOTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzY5LjUwOCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxNTEuNjk2LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04NjEuMTkzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTc2OS41MDgsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTUxLjY5NiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtODUxLjE5Mw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8xXzEiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjk5OTg4NCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjAxNTI1MzUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMC4wMTUyNTM1LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuOTk5ODg0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTc2NC41MDgsDQogICAgICAgICAgICAgICAgInkiOiAxNDYuNjk2LA0KICAgICAgICAgICAgICAgICJ6IjogLTg1OS4xOTMNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8xX0hRL1NwYXduUG9pbnRfMV8xIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTcGF3blBvaW50XzFfMiIsDQogICAgICAgICAgICAidHlwZSI6ICJTcGF3blBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjk5OTUsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC4wMzE2MTk4DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuMDMxNjE5OCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAtMC45OTk1DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTc2MS41MDgsDQogICAgICAgICAgICAgICAgInkiOiAxNDYuNjk2LA0KICAgICAgICAgICAgICAgICJ6IjogLTg1Ni4xOTMNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8xX0hRL1NwYXduUG9pbnRfMV8yIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTcGF3blBvaW50XzFfMyIsDQogICAgICAgICAgICAidHlwZSI6ICJTcGF3blBvaW50IiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjA0Mjg4NzEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogLTAuOTk5MDgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjk5OTA4LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjA0Mjg4NzENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzY3LjUwOCwNCiAgICAgICAgICAgICAgICAieSI6IDE0Ni42OTYsDQogICAgICAgICAgICAgICAgInoiOiAtODU2LjE5Mw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzMiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNwYXduUG9pbnRfMV80IiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNwYXduUG9pbnQiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC4wODQxODE5LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuOTk2NDUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMC45OTY0NSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjA4NDE4MTkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzY0LjUwOCwNCiAgICAgICAgICAgICAgICAieSI6IDE0Ni42OTYsDQogICAgICAgICAgICAgICAgInoiOiAtODUzLjE5Mw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJURUFNXzFfSFEvU3Bhd25Qb2ludF8xXzQiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlRFQU1fMl9IUSIsDQogICAgICAgICAgICAiVGVhbSI6ICJUZWFtMiIsDQogICAgICAgICAgICAiQWx0VGVhbSI6ICJUZWFtTmV1dHJhbCIsDQogICAgICAgICAgICAiT2JqSWQiOiAyLA0KICAgICAgICAgICAgIkluZmFudHJ5U3Bhd25zIjogWw0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzEiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzIiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzMiLA0KICAgICAgICAgICAgICAgICJURUFNXzJfSFEvU3Bhd25Qb2ludF8yXzQiDQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgIkhRQXJlYSI6ICJURUFNXzJfSFEvSFFfVGVhbTIiLA0KICAgICAgICAgICAgInR5cGUiOiAiSFFfUGxheWVyU3Bhd25lciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjk4MzA2NywNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAtMC4xODMyNDgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjE4MzI0OCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjk4MzA2Nw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03MjQuNzY5LA0KICAgICAgICAgICAgICAgICJ5IjogMTQxLjMxNywNCiAgICAgICAgICAgICAgICAieiI6IC0yNzEuNjUzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMl9IUSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJIUUFyZWEiLA0KICAgICAgICAgICAgICAgICJJbmZhbnRyeVNwYXducyINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiSFFfVGVhbTIiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8yX0hRL0hRX1RlYW0yIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAwLA0KICAgICAgICAgICAgInBvaW50cyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTcxOS43NjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTQ2LjMxNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjY2LjY1Mw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03MTkuNzY5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDE0Ni4zMTcsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI3Ni42NTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzI5Ljc2OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxNDYuMzE3LA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNzYuNjUzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTcyOS43NjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTQ2LjMxNywNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjY2LjY1Mw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8yXzEiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjkzMTYwNDY4NTE4LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjM2MzQ3ODU4MTkzMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuMzYzNDc4NTgxOTMxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuOTMxNjA0Njg1MTgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzExLjE4NTg1NTE4MjksDQogICAgICAgICAgICAgICAgInkiOiAxNDEuMTM1MzE0LA0KICAgICAgICAgICAgICAgICJ6IjogLTI4NC41MzQ4MTc1OTU4DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMl9IUS9TcGF3blBvaW50XzJfMSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8yXzIiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjc4NjgzODY1MjAzMiwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAtMC42MTcxNjAyNDA4MjUNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjYxNzE2MDI0MDgyNSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjc4NjgzODY1MjAzMg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03MTQuMTk2ODQ3MTA5MiwNCiAgICAgICAgICAgICAgICAieSI6IDE0MS4xMzUzMTQsDQogICAgICAgICAgICAgICAgInoiOiAtMjgxLjU0NTk5ODM0NDA1DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMl9IUS9TcGF3blBvaW50XzJfMiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8yXzMiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjkwMTg4NTUxNzUwOCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAtMC40MzE5NzU1MDI3Mg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuNDMxOTc1NTAyNzIsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC45MDE4ODU1MTc1MDgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzE0LjE3NDg0MDIxOTUsDQogICAgICAgICAgICAgICAgInkiOiAxNDEuMTM1MzE0LA0KICAgICAgICAgICAgICAgICJ6IjogLTI4Ny41NDU4ODAzNDE2DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlRFQU1fMl9IUS9TcGF3blBvaW50XzJfMyINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3Bhd25Qb2ludF8yXzQiLA0KICAgICAgICAgICAgInR5cGUiOiAiU3Bhd25Qb2ludCIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjQ1NTA0ODQ4MjUyNSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAtMC44OTA0NjY0MzI3NzkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLjg5MDQ2NjQzMjc3OSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwLjQ1NTA0ODQ4MjUyNQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03MTcuMTg1Nzg2MzMzOCwNCiAgICAgICAgICAgICAgICAieSI6IDE0MS4xMzUzMTQsDQogICAgICAgICAgICAgICAgInoiOiAtMjg0LjU1NjgxNTMyMzENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiVEVBTV8yX0hRL1NwYXduUG9pbnRfMl80Ig0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJDb21iYXRBcmVhIiwNCiAgICAgICAgICAgICJDb21iYXRWb2x1bWUiOiAiQ29tYmF0QXJlYS9Db21iYXRWb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiQ29tYmF0QXJlYSIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ29tYmF0QXJlYSIsDQogICAgICAgICAgICAibGlua2VkIjogWw0KICAgICAgICAgICAgICAgICJDb21iYXRWb2x1bWUiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIkNvbWJhdFZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJpZCI6ICJDb21iYXRBcmVhL0NvbWJhdFZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMTAsDQogICAgICAgICAgICAicG9pbnRzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjMwLjc5OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04NzUuNTUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjg4Ljc0MywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04NzMuNTcNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzcxLjA1MSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04NjcuMDM0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTgwMS40MjksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNzg5Ljg3Ng0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC04MzcuMzMyLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTYzMC41NTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtODE5LjUyMSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC01NjEuNjI0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTgxNC4xNywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00ODMuMDU4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTgyOC43NTEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzc4Ljk1Nw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC04MjEuODY0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMyMi44MzMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzUwLjg1NSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yODcuMTE2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTcxMy42NSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNTkuMzENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjgxLjM4OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yMzcuNDIyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTY1Mi45NTksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjI2LjQ5Nw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC02MTMuODY5LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTIzNS4zNzENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNTY1LjczNiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNDAuNjM1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTUxNy41ODksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjI0LjU5Nw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC00NjEuMzI4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTIwMi40NjINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDA1LjM0LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTIwNC4zNTkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMzQyLjQzNiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNDYuNjg1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTI2Mi4xODcsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMjM4Ljc5OA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0yMzMuOTU3LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI5NS43OTUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjE5LjEyMiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMzEuODk3DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTE4Mi42ODksDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtMzc5LjM2NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xNjAuNDgsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDI1LjYxNQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xNDYuNzUzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQyNS42NzQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMTIzLjg2NSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00MjkuNDE2DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTExMS45NzEsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNDUzLjI3MQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC0xMDQuOTU4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTQ3Ny44MzQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtODYuNjcyMiwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC00OTEuMDU4DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTczLjg4MjIsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNTQ1Ljc5OQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01OC42MTc1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTU5MS42OTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNDkuMzU2OCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC02NjIuMjA5DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTQ4LjY4MzcsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtNzM5LjQ2NA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03Ni44MzU1LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTgzMS41MzgNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMTYyLjYzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTkzMS42NjUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjAxLjM2OSwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC05NTYuNjMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtMjc0LjgzMywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC05ODQuNDg1DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTM2NC43NCwNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxMzMuOTMxLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC05OTMuMTE0DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTQ2Ny40ODYsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTMzLjkzMSwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtOTg2LjQzNw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC01MTkuMDc4LA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzMy45MzEsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTk1NC4yNg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRGVwbG95Q2FtIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkRlcGxveUNhbSIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMC4xMDEwNTYsDQogICAgICAgICAgICAgICAgInoiOiAtMC45OTQ4ODENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMC45OTQ4ODEsDQogICAgICAgICAgICAgICAgInoiOiAwLjEwMTA1Ng0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC00OTAuODgsDQogICAgICAgICAgICAgICAgInkiOiA1MDguNDI2LA0KICAgICAgICAgICAgICAgICJ6IjogLTU5OC4xODMNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ2FtZXJhM0QvRGVwbG95Q2FtIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJOb3J0aEJhc2VBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAiT2JqSWQiOiA1MDEsDQogICAgICAgICAgICAiQXJlYSI6ICJOb3J0aEJhc2VBcmVhVHJpZ2dlci9Ob3J0aEJhc2VPT0JQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDEsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03NDkuNjU5LA0KICAgICAgICAgICAgICAgICJ5IjogMTQ4LjM3MiwNCiAgICAgICAgICAgICAgICAieiI6IC04NDMuNDA3DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIk5vcnRoQmFzZUFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIk5vcnRoQmFzZU9PQlBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiTm9ydGhCYXNlQXJlYVRyaWdnZXIvTm9ydGhCYXNlT09CUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NzIuNjY5OTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTQ4LjM3MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtODY2LjQ0OTAyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTc5Mi44MjQ0MywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxNDguMzcyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04MTEuMTExMzINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzY0LjY5NTgzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDE0OC4zNzIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTgwMC4zMzI1Mg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NDcuNzU3NjMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTQ4LjM3MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtODA2LjkzNjAyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTc0MC41MTcxMywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxNDguMzcyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04MjQuODE4NzINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzI2LjcwMzUzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDE0OC4zNzIsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTgzMS4yMjgwMg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC02OTcuNzI2MTMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTQ4LjM3MiwNCiAgICAgICAgICAgICAgICAgICAgInoiOiAtODMzLjA2NDkyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJ4IjogLTY4OC41NTg0MywNCiAgICAgICAgICAgICAgICAgICAgInkiOiAxNDguMzcyLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC04NzMuNTExNzINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIk5vcnRoQmFzZVNlY3RvciIsDQogICAgICAgICAgICAiU2VjdG9yQXJlYSI6ICJOb3J0aEJhc2VBcmVhVHJpZ2dlci9Ob3J0aEJhc2VPT0JQb2x5Z29uVm9sdW1lIiwNCiAgICAgICAgICAgICJ0eXBlIjogIlNlY3RvciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzQ5LjY1OSwNCiAgICAgICAgICAgICAgICAieSI6IDE0OC4zNzIsDQogICAgICAgICAgICAgICAgInoiOiAtODQzLjQwNw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJOb3J0aEJhc2VBcmVhVHJpZ2dlci9Ob3J0aEJhc2VTZWN0b3IiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU291dGhCYXNlQXJlYVRyaWdnZXIiLA0KICAgICAgICAgICAgIk9iaklkIjogNTAwLA0KICAgICAgICAgICAgIkFyZWEiOiAiU291dGhCYXNlQXJlYVRyaWdnZXIvU291dGhCYXNlT09CUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJBcmVhVHJpZ2dlciIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzA0LjQyLA0KICAgICAgICAgICAgICAgICJ5IjogMTQ4LjM3MiwNCiAgICAgICAgICAgICAgICAieiI6IC0yODQuMzExDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlNvdXRoQmFzZUFyZWFUcmlnZ2VyIiwNCiAgICAgICAgICAgICJsaW5rZWQiOiBbDQogICAgICAgICAgICAgICAgIkFyZWEiDQogICAgICAgICAgICBdDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICAgICJuYW1lIjogIlNvdXRoQmFzZU9PQlBvbHlnb25Wb2x1bWUiLA0KICAgICAgICAgICAgInR5cGUiOiAiUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaWQiOiAiU291dGhCYXNlQXJlYVRyaWdnZXIvU291dGhCYXNlT09CUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAiaGVpZ2h0IjogMCwNCiAgICAgICAgICAgICJwb2ludHMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NTEuODAzODMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTM3LjE0MTMsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTMxNy45NjEzMg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NjguNDczNjMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTM3LjE0MTMsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI5Ni4wMDYyOA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAieCI6IC03NTAuODgyMzMsDQogICAgICAgICAgICAgICAgICAgICJ5IjogMTM3LjE0MTMsDQogICAgICAgICAgICAgICAgICAgICJ6IjogLTI4Ny4xNjA5MTYNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjgxLjE2MjIzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yMzcuMzQ2MjINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjY3LjQ5OTYzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yNTEuNzQ5NzINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNjg1LjY1NTYzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yODkuODQ3NTMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzAwLjI2NjMxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0zMDIuMTI3MTINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzEyLjI4ODcxLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yODguNTIyNDkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIngiOiAtNzE3Ljg4NzMzLA0KICAgICAgICAgICAgICAgICAgICAieSI6IDEzNy4xNDEzLA0KICAgICAgICAgICAgICAgICAgICAieiI6IC0yODcuNzUwNjk4DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJTb3V0aEJhc2VTZWN0b3IiLA0KICAgICAgICAgICAgIlNlY3RvckFyZWEiOiAiU291dGhCYXNlQXJlYVRyaWdnZXIvU291dGhCYXNlT09CUG9seWdvblZvbHVtZSIsDQogICAgICAgICAgICAidHlwZSI6ICJTZWN0b3IiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTcwNC40MiwNCiAgICAgICAgICAgICAgICAieSI6IDE0OC4zNzIsDQogICAgICAgICAgICAgICAgInoiOiAtMjg0LjMxMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpZCI6ICJTb3V0aEJhc2VBcmVhVHJpZ2dlci9Tb3V0aEJhc2VTZWN0b3IiLA0KICAgICAgICAgICAgImxpbmtlZCI6IFsNCiAgICAgICAgICAgICAgICAiU2VjdG9yQXJlYSINCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiQ29udGFpbmVyXzAyX09wZW5fQSIsDQogICAgICAgICAgICAidHlwZSI6ICJDb250YWluZXJfMDJfT3Blbl9BIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuNzIwNzIxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjY5MzIyNg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAsDQogICAgICAgICAgICAgICAgInkiOiAxLA0KICAgICAgICAgICAgICAgICJ6IjogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IDAuNjkzMjI2LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuNzIwNzIxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTc2My4wODgsDQogICAgICAgICAgICAgICAgInkiOiAxNDEuNTY5LA0KICAgICAgICAgICAgICAgICJ6IjogLTU2OS4zMTkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiQ29udGFpbmVyXzAyX09wZW5fQSINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiRm9ya2xpZnRfMDEiLA0KICAgICAgICAgICAgInR5cGUiOiAiRm9ya2xpZnRfMDEiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuMzYyMTk0LA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuOTMyMTAzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuOTMyMTAzLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjM2MjE5NA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03NjQuODQ0LA0KICAgICAgICAgICAgICAgICJ5IjogMTQxLjU4NiwNCiAgICAgICAgICAgICAgICAieiI6IC01NzIuNDE0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIkZvcmtsaWZ0XzAxIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJGb3JrbGlmdF8wMV9ERFBGIiwNCiAgICAgICAgICAgICJ0eXBlIjogIkZvcmtsaWZ0XzAxX0REUEYiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuNjQyMzczLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDAuNzY2MzkyDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogLTAuNzY2MzkyLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IC0wLjY0MjM3Mw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC03NjguNDczLA0KICAgICAgICAgICAgICAgICJ5IjogMTQxLjU5NCwNCiAgICAgICAgICAgICAgICAieiI6IC01NzcuNDgNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiRm9ya2xpZnRfMDFfRERQRiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiU2Npc3NvckxpZnRfMDEiLA0KICAgICAgICAgICAgInR5cGUiOiAiU2Npc3NvckxpZnRfMDEiLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMC43MDg1ODYsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC43MDU2MjQNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAtMC43MDU2MjQsDQogICAgICAgICAgICAgICAgInkiOiAwLA0KICAgICAgICAgICAgICAgICJ6IjogMC43MDg1ODYNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAtNzcyLjQ2LA0KICAgICAgICAgICAgICAgICJ5IjogMTQxLjYyOSwNCiAgICAgICAgICAgICAgICAieiI6IC01ODAuMzMzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlNjaXNzb3JMaWZ0XzAxIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJHVHJ1Y2tQaWNrdXBfMDEiLA0KICAgICAgICAgICAgInR5cGUiOiAiR1RydWNrUGlja3VwXzAxIiwNCiAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjk0NzU2NCwNCiAgICAgICAgICAgICAgICAieSI6IC0wLjAzODYzNjYsDQogICAgICAgICAgICAgICAgInoiOiAwLjMxNzIyMw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJ1cCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjAwNDQxNTc3LA0KICAgICAgICAgICAgICAgICJ5IjogMC45OTQxNTMsDQogICAgICAgICAgICAgICAgInoiOiAwLjEwNzg5NA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJmcm9udCI6IHsNCiAgICAgICAgICAgICAgICAieCI6IC0wLjMxOTUzNywNCiAgICAgICAgICAgICAgICAieSI6IDAuMTAwODM2LA0KICAgICAgICAgICAgICAgICJ6IjogLTAuOTQyMTk0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogLTc4NC4yODIsDQogICAgICAgICAgICAgICAgInkiOiAxNDIuOTkxLA0KICAgICAgICAgICAgICAgICJ6IjogLTYwMS44OTcNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiR1RydWNrUGlja3VwXzAxIg0KICAgICAgICB9DQogICAgXSwNCiAgICAiU3RhdGljIjogWw0KICAgICAgICB7DQogICAgICAgICAgICAibmFtZSI6ICJNUF9HcmFuaXRlX0NsdWJIb3VzZV9Qb3J0YWxfVGVycmFpbiIsDQogICAgICAgICAgICAibWV0YWRhdGEvX2VkaXRfbG9ja18iOiB0cnVlLA0KICAgICAgICAgICAgInR5cGUiOiAiTVBfR3Jhbml0ZV9DbHViSG91c2VfUG9ydGFsX1RlcnJhaW4iLA0KICAgICAgICAgICAgInJpZ2h0Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMSwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInVwIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDEsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZyb250Ijogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBvc2l0aW9uIjogew0KICAgICAgICAgICAgICAgICJ4IjogMCwNCiAgICAgICAgICAgICAgICAieSI6IDAsDQogICAgICAgICAgICAgICAgInoiOiAwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImlkIjogIlN0YXRpYy9NUF9HcmFuaXRlX0NsdWJIb3VzZV9Qb3J0YWxfVGVycmFpbiINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgICAgIm5hbWUiOiAiTVBfR3Jhbml0ZV9DbHViSG91c2VfUG9ydGFsX0Fzc2V0cyIsDQogICAgICAgICAgICAibWV0YWRhdGEvX2VkaXRfbG9ja18iOiB0cnVlLA0KICAgICAgICAgICAgInR5cGUiOiAiTVBfR3Jhbml0ZV9DbHViSG91c2VfUG9ydGFsX0Fzc2V0cyIsDQogICAgICAgICAgICAicmlnaHQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAxLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidXAiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMSwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZnJvbnQiOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicG9zaXRpb24iOiB7DQogICAgICAgICAgICAgICAgIngiOiAwLA0KICAgICAgICAgICAgICAgICJ5IjogMCwNCiAgICAgICAgICAgICAgICAieiI6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiaWQiOiAiU3RhdGljL01QX0dyYW5pdGVfQ2x1YkhvdXNlX1BvcnRhbF9Bc3NldHMiDQogICAgICAgIH0NCiAgICBdDQp9","compiled":""},"attachmentType":1,"metadata":"mapIdx=0","errors":[]},{"id":"c0eb7382-29dc-443a-803e-8b4211240513","version":"234","filename":"Script.ts","isProcessable":true,"processingStatus":2,"attachmentData":{"original":"Ly8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFZlcnNpb25pbmcgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIHZlcnNpb246IDAuMjU5IHwgRGF0ZTogMDEuMDMuMjYgfCBUaW1lOiAyMTo0NiBVVEMKLy8gbmFtZSBvZiBzY3JpcHQ6IFRXTF9UYW5rc19TYW5kYm94X0JldGFfU2NyaXB0LnRzCi8vIG5hbWUgb2YgcGFpcmVkIHN0cmluZ3MgZmlsZTogVFdMX1RhbmtzX1NhbmRib3hfQmV0YV9TdHJpbmdzLnN0cmluZ3MuanNvbgovLyBwb2xpY3k6IHRoZSBzdHJpbmcgaHVkLmJyYW5kaW5nLnRpdGxlIHNob3VsZCBkaXNwbGF5IHRoaXMgc2FtZSB2ZXJzaW9uIGF0IHRoZSBlbmQgb2YgdGhlIHRpdGxlCi8vIHBvbGljeTogaW5jcmVtZW50IG1pbm9yIHZlcnNpb24gb24gZXZlcnkgY2hhbmdlIChVVEMpCi8vIHBvbGljeTogbWFqb3IgdmVyc2lvbnMgcmVzZXJ2ZWQgZm9yIG1pbGVzdG9uZSBmZWF0dXJlIHJlbGVhc2VzIChwcmltYXJ5IGF1dGhvcnMgb25seSkKLy8gcG9saWN5OiBFT0YgdmVyc2lvbiBsaW5lIG11c3QgbWF0Y2ggdGhlIGhlYWRlciB2ZXJzaW9uIGFuZCB0aW1lc3RhbXAKCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBWZXJzaW9uaW5nIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBBdXRob3JzIC8gQXR0cmlidXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIE9yaWdpbmFsIFByaW1hcnkgQXV0aG9yczogUG9seW5vcmJsdSwgVWJlckR1YmVyU29sZGF0LCBEb3gKLy8gQ29kZSBnZW5lcmF0aW9uLCBhc3Npc3RhbmNlIGFuZCBzdXBwb3J0IGJ5OiBDaGF0R1BUIChPcGVuQUksIEdQVC01LjIsIEdQVC01LjItQ29kZXgpCi8vIEJGNiBQb3J0YWwgQ29tbXVuaXR5IFRvb2xzIHVzZWQvcmVmZXJlbmNlZDoKLy8gIC0gUG9ydGFsIENvbW11bml0eSBEaXNjb3JkOiBodHRwczovL2Rpc2NvcmQuY29tL2ludml0ZS9iYXR0bGVmaWVsZC1wb3J0YWwtY29tbXVuaXR5LTg3MDI0NjE0NzQ1NTg3NzE4MQovLyAgLSBUeXBlU2NyaXB0IFByb2plY3QgVGVtcGxhdGUgZm9yIEJhdHRsZWZpZWxkIDYgUG9ydGFsIFNjcmlwdGluZyBieSBNaWtlIERlTHVjYTogaHR0cHM6Ly9naXRodWIuY29tL2RlbHVjYS1taWtlL2JmNi1wb3J0YWwtc2NyaXB0aW5nLXRlbXBsYXRlCi8vICAgICAtIE11bHRpLUNsaWNrIGRldGVjdG9yIGJ5IE1pa2UgRGVMdWNhOiBodHRwczovL2dpdGh1Yi5jb20vZGVsdWNhLW1pa2UvYmY2LXBvcnRhbC11dGlscy90cmVlL21hc3Rlci9pbnRlcmFjdC1tdWx0aS1jbGljay1kZXRlY3RvcgovLyAgICAgLSBNYXAgZGV0ZWN0b3IgYnkgTWlrZSBEZUx1Y2E6IGh0dHBzOi8vZ2l0aHViLmNvbS9kZWx1Y2EtbWlrZS9iZjYtcG9ydGFsLXV0aWxzL3RyZWUvbWFzdGVyL21hcC1kZXRlY3RvcgovLyAgLSBUZWFtIFN3aXRjaCBVSSBUZW1wbGF0ZSBieSBUaGVPenp5OiBodHRwczovL2dpdGh1Yi5jb20vVGhlMHp6eS9CRjYtUG9ydGFsLVRlYW1Td2l0Y2hVSQovLyAgLSBCRjYgUG9ydGFsIEFzc2lzdGFudCBieSBRdW9laXphOiBodHRwczovL2NoYXRncHQuY29tL2cvZy02OGYyODU4MGVlZmM4MTkxYjRjZjQwYmJmMjMwNWRiMy1iZjYtcG9ydGFsLWFzc2lzdGFudAovLyAgICAgLSBHUFQgUHJvbXB0OiBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9RdW9laXphLzgwODVmMTQyYWQ4YTA1ZWUwNGI3OWFkY2M0YWQ4ZmQ3Ci8vICAtIEJGNiBVc2VyIEludGVyZmFjZSBUb29sIGJ1aWxkZXIgYnkgRWFnbGVOYWl0OiBodHRwczovL3Rvb2xzLmJmcG9ydGFsLmdnL3VpLWJ1aWxkZXIvCi8vICAtIEN1c3RvbSBDb25xdWVzdCBUZW1wbGF0ZSBieSBhbmR5NjE3MDogaHR0cHM6Ly9iZnBvcnRhbC5nZy9leHBlcmllbmNlcy9jdXN0b20tY29ucXVlc3QtdGVtcGxhdGUvCgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gQXV0aG9ycyAvIEF0dHJpYnV0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBDaGFuZ2Vsb2cgLyBIaXN0b3J5IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyB2MC4yNTk6IFJlbGVhc2UgdmVyc2lvbiBmb3IgTGFkZGVyIHdpdGggOCBtYXBzCi8vIHYwLjI1ODogQWRkZWQgTWFwQ29uZmlnIHNldHRpbmdzIGZvciBBcmVhIDIyQgovLyB2MC4yNTc6IEZpeGVkIHJhY2UgY29uZGl0aW9uIG9uIGZpcnN0IHRhbmsgc3Bhd25lZCAtIG5lZWQgdG8gY2xlYXIgaXQgYW5kIHNwYXduIGNvcnJlY3QgdmVoaWNsZSB0byBhdm9pZCBkZWZhdWx0IEFicmFtcyBzcGF3bgovLyB2MC4yNDc6IEFkZGVkIHRlYW0gbmFtZXMgdG8gTWFwQ29uZmlnLCBmaXhlZCBiYWNrZW5kIEpTIEVycm9ycyBvbiBwbGF5ZXIgYmVpbmcgZGVwbG95ZWQgb3Igbm90IChlbXB0eSBzdHJpbmcgYXJncyB7fSB2cyB7MH0pCi8vIHYwLjI0MDogRml4ZWQgc3Bhd25lciBsb2dpYyByZWdyZXNzaW9ucyAoc3Bhd24gYmxvY2sgYW5kIGZhaWxlZCB0byBzcGF3biB3aXRoIHJhcGlkIG1vZGUgaW5jcmVhc2UpCi8vIHYwLjIzODogU3VibWl0dGVkIGZvciBDb2RlIFJldmlldyBieSBEb3ggJiBQb2x5Ci8vIHYwLjIzMzogQ29kZSBjbGVhbnVwLCByZW9yZ2FuaXphdGlvbiBhbmQgY29tbWVudCBjbGFyaXR5LCBwcmVwcGluZyBmb3IgMS4wIFJlbGVhc2UgdmVyc2lvbgovLyB2MC4yMjg6IEFkZGVkIGR5bmFtaWMgYmluZGluZyB0byBtb2RlczogMXYxIG9ubHkgc3Bhd25zIDEgdGFuaywgNHY0IHNwYXducyA0IHRhbmtzLiBDb25maWd1cmFibGUgd2hlbiByb3VuZCBpcyBub3QgbGl2ZS4KLy8gdjAuMjI0OiBBZGRlZCBNYXAgRGV0ZWN0b3IgbG9naWMgdG8gYXV0by1kZXRlY3Qgd2hpY2ggTWFwQ29uZmlnIGFuZCBzcGF3bmVycyB0byB1c2UsIHRoZW4gZGlzcGxheSB0aGUgTWFwIG5hbWUgb24gdGhlIFJlYWR5IFVwIHNjcmVlbgovLyB2MC4yMTg6IEZpcnN0IHBhc3Mgb24gU3Bhd24gcG9pbnRzIGZvciBhbGwgNyBtYXBzIGluIExhZGRlciByb3RhdGlvbiwgdXNpbmcgQWRtaW4gRGVidWcgUG9zaXRpb24gdG9vbAovLyB2MC4yMTc6IEFkZGVkIEFkbWluIERlYnVnIFBvc2l0aW9uIGJ1dHRvbiB0byBkaXNwbGF5IFgvWS9aIGNvb3JkaW5hdGVzIGFuZCBZIHJvdGF0aW9uIG9mIHBsYXllcgovLyB2MC4yMDU6IEFkZGVkIHNwYXduIGNhbXAgc2NvcmluZyBwcm90ZWN0aW9uIGlmIGEgbGVmdG92ZXIgdmVoaWNsZSByZW1haW5zIGluIG1haW4gYmFzZSBkdXJpbmcgcm91bmQgc2V0dXAKLy8gdjAuMTk3OiBBZGp1c3RlZCBzb21lIEhVRC9VSSBwb3NpdGlvbnMsIGFkZGVkIG5ldyBsYWJlbHMgYW5kIGFkZGVkICIxdjEiIHVwIHRvICI0djQiIG1hdGNodXAgY29uZmlndXJhdGlvbiBidXR0b25zIHRvIFJlYWR5IHNjcmVlbgovLyB2MC4xODI6IEZ1bmN0aW9uYWwgdmVyc2lvbiBvZiBCYWRsYW5kcyB3b3JraW5nIHdpdGggcmVzcGF3biBsb2dpYywgb3JpZW50YXRpb24gYW5kIHZlaGljbGUgYXNzaWdubWVudHMgd29ya2luZwovLyB2MC4xNzc6IEN1c3RvbSByZXNwYXduIGxvZ2ljIGltcGxlbWVudGVkIHdpdGggdW5pcXVlIGRhdGEgc3RydWN0dXJlcyBwZXIgbWFwOyBjdXN0b20gdmVoaWNsZSBhbmQgSFEgc3Bhd24gcG9pbnRzIG5lZWRlZCBwZXIgbWFwIAovLyB2MC4xNTI6IEZvcmNpbmcgc3VwcGx5IGJveGVzIG9uIGV2ZXJ5IHNwYXduLCB0byBlbnN1cmUgbm8gb3RoZXIgZ2FkZ2V0IGxvb3Bob2xlCi8vIHYwLjE1MTogRmluYWxpemVkIHN0cmluZy5qc29uIGludG8gbmV3IGZvcm1hdCB3aXRoIHVwZGF0ZWQgc3RyaW5ncyBwb2xpY3kKLy8gdjAuMTQ4OiBBZGRlZCBDaGFuZ2Vsb2cgLyBIaXN0b3J5IHNlY3Rpb24gdG8gc2NyaXB0IGhlYWRlciBhbmQgZmluYWxpemVkIGVudW0vaW50ZXJmYWNlIHJlZmFjdG9yIGJ1Z3MKLy8gdjAuMTM0OiBMYXN0IHdvcmtpbmcgdmVyc2lvbiBiZWZvcmUgZW51bS9pbnRlcmZhY2UgcmVmYWN0b3IgKHNlZSBhcmNoaXZlXGVudW1faW50ZXJmYWNlX2ltcGxlbWVudGF0aW9uX3BsYW4ubWQpCi8vIHYwLjEyOTogUmVsZWFzZSB2ZXJzaW9uIGZvciBMYWRkZXIgd2l0aCA3IG1hcHMKLy8gdjAuMDU5OiBMYXN0IHZlcnNpb24gYmVmb3JlIHN3aXRjaGluZyBwcmltYXJseSBmcm9tIEdQVC01LjIgd2ViIGNsaWVudCB0byBHUFQtNS4yLUNvZGV4IGluIFZTIENvZGUKCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBDaGFuZ2Vsb2cgLyBIaXN0b3J5IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBHYW1lbW9kZSBEZXNjcmlwdGlvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gVGhpcyBzY3JpcHQgaW1wbGVtZW50czoKLy8gICAtIFZlaGljbGUgc2NvcmluZyArIHJvdW5kL21hdGNoIGZsb3cgKHN0YXJ0L2VuZCwgdGltZXJzLCB2aWN0b3J5IGRpYWxvZykKLy8gICAtIE1haW4tYmFzZSBlbnRlci9leGl0IHRyYWNraW5nIChhbW1vIHJlc3RvY2sgKyBiYXNlIHN0YXRlKQovLyAgIC0gVHJpcGxlLXRhcCAiUmVhZHkgVXAiIGRpYWxvZyAocm9zdGVyLCByZWFkeSBzdGF0ZXMsIGJhc2UgZ2F0aW5nLCBhdXRvLXN0YXJ0KQovLyAgIC0gVGVhbSBzd2l0Y2hpbmcgdmlhIGEgc2luZ2xlICJTd2FwIFRlYW1zIiBidXR0b24gKGZvcmNlcyB1bmRlcGxveSkKLy8gVGhpcyBleHBlcmllbmNlIGlzIGEgcm91bmQtYmFzZWQsIHZlaGljbGUtb25seSBzY29yaW5nIG1vZGU6Ci8vIC0gVmVoaWNsZXMgYmVjb21lICJyZWdpc3RlcmVkIiB0byBhIHRlYW0gd2hlbiB0aGV5IHNwYXduIGFuZC9vciB0aGUgZmlyc3QgdGltZSBhIHBsYXllciBlbnRlcnMgdGhlbS4KLy8gLSBXaGVuIGEgcmVnaXN0ZXJlZCB2ZWhpY2xlIGlzIGRlc3Ryb3llZCBkdXJpbmcgYSBMSVZFIHJvdW5kLCB0aGUgb3Bwb3NpbmcgdGVhbSBlYXJucyArMSBSb3VuZCBLaWxsLgovLyAtIEEgcm91bmQgZW5kcyB3aGVuIGEgdGVhbSByZWFjaGVzIHRoZSBSb3VuZCBLaWxsIHRhcmdldCAoZS5nLiAyIGtpbGxzIGZvciAydjIpIG9yIHRoZSByb3VuZCBjbG9jayBleHBpcmVzLgovLyAtIEVudGVyaW5nL0V4aXRpbmcgbWFpbi1iYXNlIHByb3ZpZGVzIGEgZ2FkZ2V0IGFtbW8gcmVzdG9jayBzbyBwbGF5ZXJzIGNhbiByZWFybS9yZXN1cHBseSBpZiBuZWVkZWQgbWlkIG1hdGNoIG9yIHBvc3QgbWF0Y2gKLy8gLSBNYXRjaCByZWNvcmQgKHdpbnMvbG9zc2VzL3RpZXMpIGlzIHRyYWNrZWQgYWNyb3NzIHJvdW5kczsgSFVEIGlzIGEgcHJvamVjdGlvbiBvZiB0aGF0IGF1dGhvcml0YXRpdmUgc3RhdGUuCi8vIC0gUm91bmQgZW5kIGFuZCBWaWN0b3J5IGVuZCBkaWFsb2dzIGNvbW11bmljYXRlIHJlc3VsdHMgaW4gdGltZWQgd2luZG93cyBmb3IgY2xhcml0eQovLwovLyBHbG9zc2FyeSAodGVybXMpOgovLyAtICJSb3VuZCBLaWxscyI6IHBvaW50cyBlYXJuZWQgdGhpcyByb3VuZCAodmVoaWNsZS1kZXN0cnVjdGlvbiBwb2ludHMpLgovLyAtICJUb3RhbCBLaWxscyI6IGxpZmV0aW1lIG1hdGNoIHRvdGFsIChpZiB1c2VkL3Nob3duKTsgbm90IHJlcXVpcmVkIGZvciB3aW4gY29uZGl0aW9uLgovLyAtICJSZWdpc3RlcmVkIHZlaGljbGUiOiBhIHZlaGljbGUgY3VycmVudGx5IHN0b3JlZCBpbiB0aGUgdGVhbSdzIHJlZ2lzdGVyZWQgbGlzdCAoR2xvYmFsVmFyaWFibGVzIDAvMSkuCi8vIC0gIkxhc3QgZHJpdmVyIjogYmVzdC1lZmZvcnQgb3duZXIgdXNlZCBmb3IgbWVzc2FnaW5nIG9ubHk7IG5vdCBhdXRob3JpdGF0aXZlIGZvciBzY29yaW5nLgovLyAtICJIVUQiOiBhbHdheXMtb24gcGVyLXBsYXllciBvdmVybGF5IChjYWNoZWQgYnkgcGlkKS4KLy8gLSAiRGlhbG9nIjogbW9kYWwgVUkgdGhhdCBlbmFibGVzIFVJIGlucHV0IG1vZGUgKFRlYW0gU3dpdGNoIC8gVmljdG9yeSkuCi8vCi8vIEdsb3NzYXJ5IChzY3JpcHQgc2VtYW50aWNzKQovLyAtIFQxIC8gVDI6IFRoZSB0d28gY29tcGV0aW5nIHRlYW1zIGluIHRoaXMgbW9kZTsgVUkgbWF5IHN0aWxsIHVzZSBMZWZ0L1JpZ2h0IGZvciBsYXlvdXQgb25seS4KLy8gLSBNYXRjaCB0b3RhbHM6IENvdW50ZXJzIHRoYXQgcGVyc2lzdCBhY3Jvc3Mgcm91bmRzIChlLmcuLCB0b3RhbCBraWxscywgbWF0Y2ggd2lucykuCi8vIC0gUm91bmQgY291bnRlcnM6IENvdW50ZXJzIHRoYXQgcmVzZXQgb24gcm91bmQgc3RhcnQgKGUuZy4sIHJvdW5kIGtpbGxzLCByb3VuZCBjbG9jaykuCi8vIC0gQXV0aG9yaXRhdGl2ZSBzdGF0ZTogVGhlIHNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIG1hdGNoLWNyaXRpY2FsIGNvdW50ZXJzOyBIVUQgaXMgYSBwcm9qZWN0aW9uIG9mIHRoaXMgc3RhdGUuCi8vCi8vIFJlY29tbWVuZGF0aW9ucyBvbiB0d2Vha2luZy9hZGp1c3RpbmcvY3VzdG9taXppbmcgdGhpcyBleHBlcmllbmNlCi8vIC0gR2VuZXJhbCBVSSBsYXlvdXQgdGlwOiBNb3N0IHdpZGdldHMgZGVmaW5lIGFuIG9mZnNldCB2aWEgYHBvc2l0aW9uOiBbeCwgeV1gLgovLyAtIENoYW5nZSB0aG9zZSBudW1iZXJzIHRvIG51ZGdlIHRoYXQgd2lkZ2V0IHJlbGF0aXZlIHRvIGl0cyBhbmNob3I7IHRoZSBwZXJjZWl2ZWQgZGlyZWN0aW9uIGNhbiB2YXJ5IGJ5IGFuY2hvcmluZywgc28gdmVyaWZ5IGluLWdhbWUgYWZ0ZXIgZWRpdHMuCgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gR2FtZW1vZGUgRGVzY3JpcHRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEltcHJvdmVtZW50cyBwdW5jaGxpc3QgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8qCiAqIFBhaXJlZCBGaWxlcyB3aXRoIG5vdGVzIG9uIGltcHJvdmVtZW50cyBhbmQgdGVzdGluZzogCiAqIC0gc3JjXE9QVElNSVpBVElPTi5tZAogKiAtIHNyY1xURVNURVJfR1VJREUubWQKICogCiAqIE5leHQgVGFyZ2V0OiBVSSBQb2xpc2g6IEJpZ2dlciBUcmlwbGUgVGFwIERpYWxvZyBIZWxwIFRleHQgKHJlYWRhYmlsaXR5KQogKgogKiBMaXN0IG9mIGltcHJvdmVtZW50cyAoZm9yIG9ubHkgaHVtYW5zIGFuZCBub3QgTExNcywgQ09ERVggb3IgR1BUIHRvIGRlc2lnbiBhbmQgaW1wbGVtZW50KToKICogLS0tIENvZGUgQ2xlYW51cDogQ2VudHJhbGl6ZSBjb2xvciBuYW1lIGNvbnN0YW50cyB0byBiZSBnbG9iYWwsIG5vdCBzcGVjaWZpYyB0byBmdW5jdGlvbnMsIHNvIHRoZXkncmUgZWFzaWVyIHRvIHJldXNlCiAqIC0tLSBDb2RlIENsZWFudXA6IEd1dCB1bnVzZWQgZnVuY3Rpb25zIC8gY29tbWVudGVkIG91dCBmdW5jdGlvbnMgZnJvbSBzY3JpcHQgZmlsZSAoZG9uZT8pCiAqIC0tLSBDb2RlIENsZWFudXA6IEFkZHJlc3MgcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycyB2cyByZWZyZXNoUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycyAob3ZlcmxhcC9kdXBsaWNhdGlvbj8pCiAqIC0tLSBDb2RlIENsZWFudXA6IFRoZSBVSSBwYXR0ZXJucyBhcmUgYm9ua2Vycy4gV2UgZG9udCBuZWVkIHVuaXF1ZSBmdW5jdGlvbnMgZm9yIHNpbmdsZSBtZXNzYWdlIHN0cmluZ3M/IGNhbiB3ZSBzaW1wbGlmeSB0aGlzIHR5cGUgb2YgcGF0dGVybjogTm90aWZ5QW1tb1Jlc3RvY2tlZChldmVudFBsYXllcik7CiAqIC0tLSBDb2RlIENsZWFudXA6IFRoZXJlIGFyZSBtYW55IHZhcmlvdXMgZnVuY3Rpb25zIHdoaWNoIGdlbmVyYWxseSBkbyB0aGUgc2FtZSB0aGluZywgY2FuIHdlIGNvbnNpZGVyIGhvdyB0byB1bmlmeSBVSSB1cGRhdGVzL3JlZnJlc2hlcyBvciB1c2UgVFMgdGVtcGxhdGUgVUkgbGlicmFyeSAobWFqb3IgcmVmYWN0b3IpCiAqIC0tLSBDb2RlIENsZWFudXA6IEVtYnJhY2UgVFMgVGVtcGxhdGUgcHJvamVjdCBhbmQgYnJlYWsgbWVnYSBmaWxlIGludG8gbW9kdWxhciBmaWxlcy4uLgogKiAKICogTGlzdCBvZiBOaWNlIHRvIEhhdmVzIChmb3Igb25seSBodW1hbnMgYW5kIG5vdCBMTE1zLCBDT0RFWCBvciBHUFQgdG8gZGVzaWduIGFuZCBpbXBsZW1lbnQpOgogKiAtIFJldmlldyB1c2VyIGRpc2Nvbm5lY3RpbmcgZHVyaW5nIHJvdW5kIGNvdW50ZG93biB0byBzdG9wIGNvdW50ZG93bj8KICogLSBPbmx5IGxldCByb3VuZCBtYXggZGVjcmVtZW50IHdoZW4gcm91bmQgaXMgbm90IGxpdmUgKGR1cmluZyBsaXZlIHJvdW5kIGVuZHMgZ2FtZSBlYXJseT8pIAogKiAtIEdhbWVwbGF5OiBEaXNhYmxlIHJlc3Bhd24gdW50aWwgcm91bmQgaXMgb3ZlciAob3IgbG9jayBwbGF5ZXIgbW92ZW1lbnQgd2hlbiBzcGF3bmluZyk/IChwcmV2ZW50cyBncmllZmluZykKICogLSBVSSBQb2xpc2g6IEFkZCAiUmVzcGF3biBpbiAxMHMuLi4iIG1lc3NhZ2Ugc3luY2VkIHdpdGggY2xvY2sgdG8gYXBwZWFyIGluIHBsYWNlIGF0IHRvcCBpbiB5ZWxsb3cgaW5zdGVhZCBvZiAicmVhZHkgdXAiIGRpYWxvZywgZHVyaW5nIHRoZSB3aW5kb3cgb2Ygcm91bmQgZW5kaW5nCiAqIC0gVUkgUG9saXNoOiBSb3VuZCB7MH0gU3RhcnRpbmcuLi4gbWVzc2FnZSB0d2VhayBkdXJpbmcgcm91bmQgc3RhcnQgY291bnRkb3duCiAqIC0gVUkgUG9saXNoOiBEaXNwbGF5IHVzZXIgbmFtZXMgb24gVmljdG9yeSBkaWFsb2cgdG8gdGhlIGxlZnQgYW5kIHJpZ2h0IGZvciBlYWNoIHRlYW0gCiAqIC0gVUkgUG9saXNoOiBSZXN0YXJ0IGluIFhzIHN0aWxsIHJvbGxzIG92ZXIgb24gdG9wIG1hdGNoIGNsb2NrIAogKiAtIFVJIFBvbGlzaDogSFVEIG1vdmVzIGRvd24gc28gY29tcGFzcyBjYW4gYnJlYXRoZSAKICogLSBTRlggUG9saXNoOiBBZGQgc291bmQgZWZmZWN0cyBmb3IgcmVhZHkgdXAsIHJvdW5kIHN0YXJ0IGNvdW50ZG93biwgcm91bmQgZW5kIGRpc3BsYXksIHZpY3RvcnkgZGlzcGxheSAKICogLSBTRlggUG9saXNoOiBBZGQgc291bmQgZWZmZWN0IG9uIHZlaGljbGUgcmVnaXN0cmF0aW9uIAogKiAtIFNGWCBQb2xpc2g6IEFkZCBzb3VuZCBlZmZlY3Qgb24gdmVoaWNsZSBkZXN0cnVjdGlvbiBmb3Igc2NvcmluZyAKICogLSBSb3VuZCBFbmQgRGlhbG9nOiBTaG93IGl0IHdhcyB3b24gZHVlIHRvIHRpbWUgb3IgdGltZWQgb3V0CiAqIAogKiBQb3NzaWJsZSBCdWdzIHRvIGlkZW50aWZ5L3JlcG86CiAqIC0gM3JkIHRhbmsgaXMgc3dhcHBlZC93cm9uZz8gRGVmZW5zZSBOZXh1cywgQmxhY2t3ZWxsIE9pbCBmaWVsZHMsIC0gTGVvcGFyZCBhbmQgQWJyYW1zIHN3YXBwZWQKICogLSBBdHRyaWJ1dGlvbiB3ZW50IHRvIG9sZCBwZXJzb24gd2hvIG93bmVkIHRhbmsgcHJldmlvdXNseSAobWF5YmUgYmVmb3JlIHNpZGUgc3dhcHBpbmc/IC0gQlVUIHRoZSBwb2ludCBkaWQgYXR0cmlidXRlIGNvcnJlY3RseSkKICogLSBBbW1vIHJlc3RvY2tlZCBpbiB0aGUgbWlkZGxlIG9mIHRoZSBtYXA/IEhvdz8/IEFyZWEgMjJCCiAqIC0gQWRkIGEgZGlhbG9nIG9uIHRvcCBvZiBTcGF3biBzY3JlZW4gdG8gZXhwbGFpbiBtb2RlIGJldHRlcj8gZmlyc3QgdGltZSBzcGF3bj8KICovCgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSW1wcm92ZW1lbnRzIHB1bmNobGlzdCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gUG9ydGFsIE5hbWluZyBOb3RlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLyogTGlzdCBvZiBWZWhpY2xlcyBpbiBCRjYgUG9ydGFsIChmb3IgcmVmZXJlbmNlKToKCi8vIE1haW4gQmF0dGxlIFRhbmsKbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICAvLyBBYnJhbXMgLSBNMUEyIFNFUHYzIChOQVRPKQptb2QuVmVoaWNsZUxpc3QuTGVvcGFyZCAgICAgIC8vIExlb3BhcmQgLSBMZW8gQTQgKFBBWCkKCi8vIEluZmFudHJ5IEZpZ2h0aW5nIFZlaGljbGUKbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICAvLyBNMiBCcmFkbGV5IC0gTTNBMyBCcmFkbGV5IChOQVRPKQptb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIC8vIENWOTAgLSBTVFJGIDA5IEE0IChQQVgpCgovLyBBbnRpIEFpciBWZWhpY2xlCm1vZC5WZWhpY2xlTGlzdC5DaGVldGFoICAgICAgLy8gQ2hlZXRhaCAxQTIgKE5BVE8pCm1vZC5WZWhpY2xlTGlzdC5HZXBhcmQgICAgICAgLy8gR2VwYXJkIC0gR0UtMjYgUEFYIChQQVgpCgovLyBHcm91bmQgVmVoaWNsZSAodHJhbnNwb3J0IC8gbGlnaHQpCm1vZC5WZWhpY2xlTGlzdC5NYXJhdWRlciAgICAgLy8gTWFyYXVkZXIgKE5BVE8pCm1vZC5WZWhpY2xlTGlzdC5NYXJhdWRlcl9QYXggLy8gTWFyYXVkZXIgKFBBWCkKbW9kLlZlaGljbGVMaXN0LlF1YWRiaWtlICAgICAvLyBRdWFkIEJpa2UKbW9kLlZlaGljbGVMaXN0LkdvbGZDYXJ0ICAgICAvLyBHb2xmIENhcnQKCi8vIEF0dGFjayBIZWxpY29wdGVyCm1vZC5WZWhpY2xlTGlzdC5BSDY0ICAgICAgICAgLy8gQUgtNjQgQXBhY2hlIC0gTTc3RSBGYWxjaGlvbiAoTkFUTykKbW9kLlZlaGljbGVMaXN0LkV1cm9jb3B0ZXIgICAvLyBFdXJvY29wdGVyIFRpZ2VyIC0gUGFudGhlcmEgS0hUIChQYXgpCgovLyBUcmFuc3BvcnQgSGVsaWNvcHRlcgptb2QuVmVoaWNsZUxpc3QuVUg2MCAgICAgICAgIC8vIFVILTYwIEJsYWNrIEhhd2sgKE5BVE8pCm1vZC5WZWhpY2xlTGlzdC5VSDYwX1BheCAgICAgLy8gVUgtNjAgQmxhY2sgSGF3ayAoUEFYKQoKLy8gSmV0cyAtIG5lZWQgdG8gc29ydCBpbnRvIFBBWC9OQVRPIGFuZCBGaWdodGVyIC8gR3JvdW5kIEF0dGFjawptb2QuVmVoaWNsZUxpc3QuRjE2ICAgICAgICAgIC8vIEYtMTYgKE5BVE8pCm1vZC5WZWhpY2xlTGlzdC5KQVMzOSAgICAgICAgLy8gSkFTIDM5IEdyaXBlbiAoUEFYKQptb2QuVmVoaWNsZUxpc3QuRjIyICAgICAgICAgIC8vIEYtMjIgKE5BVE8pCm1vZC5WZWhpY2xlTGlzdC5TVTU3ICAgICAgICAgLy8gU1UtNTcgKFBBWCkKbW9kLlZlaGljbGVMaXN0LkZseWVyNjAgICAgICAvLyBGbHllciA2MD8KCi8vIEludGVybmFsIC8gVGVzdAptb2QuVmVoaWNsZUxpc3QuVmVjdG9yICAgICAgIC8vIFZlY3RvciAoaW50ZXJuYWwgb3IgdGVzdCkKCiovCgovKgogKiBQbGF5ZXIgRmFjaW5nIE1hcCBOYW1lcyA9IEdvZG90IE1hcCBSZWZlcmVuY2UgTmFtZXMKICogCiAqIEJsYWNrd2VsbEZpZWxkcyA9IEJhZGxhbmRzCiAqIERlZmVuc2VOZXh1cyA9IEdyYW5pdGVfVGVjaENhbXB1cwogKiBEb3dudG93biA9IEdyYW5pdGVfTWFpblN0cmVldAogKiBFYXN0d29vZCA9IEVhc3R3b29kCiAqIEVtcGlyZVN0YXRlID0gQWZ0ZXJtYXRoCiAqIEdvbGZDb3Vyc2UgPSBHcmFuaXRlX0NsdWJIb3VzZQogKiBJYmVyaWFuT2ZmZW5zaXZlID0gQmF0dGVyeQogKiBMaWJlcmF0aW9uUGVhayA9IENhcHN0b25lCiAqIE1hbmhhdHRhbkJyaWRnZSA9IER1bWJvCiAqIE1hcmluYSA9IEdyYW5pdGVfTWFyaW5hCiAqIE1pcmFrVmFsbGV5ID0gVHVuZ3N0ZW4KICogTmV3U29iZWtDaXR5ID0gT3V0c2tpcnRzCiAqIE9wZXJhdGlvbkZpcmVzdG9ybSA9IEZpcmVzdG9ybQogKiBQb3J0YWxTYW5kYm94ID0gU2FuZAogKiBTYWludHNRdWFydGVyID0gTGltZXN0b25lCiAqIFNpZWdlT2ZDYWlybyA9IEFiYmFzaWQKICovCgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gUG9ydGFsIE5hbWluZyBOb3RlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gTW9kbGliIGltcG9ydCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gSWYgbm90IHVzaW5nIGJ1bmRsZWQgVFMgcHJvamVjdCB5b3UgbmVlZCB0byB1c2UgbW9kbGliIGltcG9ydAovLyBAdHMtaWdub3JlIC0gaWdub3JlcyBlcnJvciBvbiBQb3J0YWwgd2ViY2xpZW50IHdpdGggaW1wb3J0aW5nIG1vZGxpYgppbXBvcnQgKiBhcyBtb2RsaWIgZnJvbSAibW9kbGliIjsKLy8gVFMgcHJvamVjdCBjb21lcyB3aXRoIGxvY2FsIG1vZGxpYiBmdW5jdGlvbnMsIGlmIHVzaW5nIHRoYXQgdGhlbiBubyBuZWVkIHRvIGltcG9ydCBtb2RsaWIKLy8gLSBUaGVyZSBzZWVtcyB0byBiZSBhbiBlcnJvciB3aXRoIFRTIHRlbXBsYXRlJ3MgcHJvamVjdCBsb2NhbCBtb2RsaWIgRmlsdGVyZWRBcnJheSBmdW5jdGlvbiAoZHJvcHMgYWxsIHZlaGljbGVzIGluIHZlaGljbGUgYXJyYXk/ISkKCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBNb2RsaWIgaW1wb3J0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBDb25zdGFudCwgRW51bXMgYW5kIFR5cGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBDb3JlIGdhbWVwbGF5IHR1bmluZyBkZWZhdWx0cyAoc2FmZSB0byBlZGl0KS4KLy8gVW5pdHM6IHNlY29uZHMgdW5sZXNzIG90aGVyd2lzZSBub3RlZC4KY29uc3QgREVGQVVMVF9NQVhfUk9VTkRTID0gMzsgLy8gQmVzdC1vZiByb3VuZHMgZm9yIGEgZnVsbCBtYXRjaC4KY29uc3QgTUFYX1JPVU5EUyA9IERFRkFVTFRfTUFYX1JPVU5EUzsKY29uc3QgREVGQVVMVF9ST1VORF9LSUxMU19UQVJHRVQgPSAxOyAvLyAxIGZvciAxdjEsIDIgZm9yIDJ2MiwgZXRjLgpjb25zdCBST1VORF9LSUxMU19UQVJHRVQgPSBERUZBVUxUX1JPVU5EX0tJTExTX1RBUkdFVDsKY29uc3QgUk9VTkRfU1RBUlRfU0VDT05EUyA9IDUgKiA2MDsgLy8gUm91bmQgY2xvY2sgc3RhcnRpbmcgdGltZS4KY29uc3QgTUFUQ0hfRU5EX0RFTEFZX1NFQ09ORFMgPSA0NTsgLy8gVmljdG9yeSBkaWFsb2cgZHVyYXRpb24gYmVmb3JlIG1hdGNoIGVuZC4KY29uc3QgUk9VTkRfRU5EX1JFREVQTE9ZX0RFTEFZX1NFQ09ORFMgPSAxMDsgLy8gUmVkZXBsb3kgZGVsYXkgYmV0d2VlbiByb3VuZHMuCmNvbnN0IFJPVU5EX0NMT0NLX0RFRkFVTFRfU0VDT05EUyA9IFJPVU5EX1NUQVJUX1NFQ09ORFM7IC8vIFNvdXJjZSBvZiB0cnV0aCBmb3IgY2xvY2sgcmVzZXQuCgovLyBEZWJ1Zy9nYW1lcGxheSBtZXNzYWdlIHRvZ2dsZXM6Ci8vIC0gIkRlYnVnIiBtZXNzYWdlcyBhcmUgZGV2ZWxvcG1lbnQvZGlhZ25vc3RpYyBVWCAod2hpdGUgbG9nIC8gZ3JlZW4gYm94KS4KLy8gLSAiR2FtZXBsYXkiIG1lc3NhZ2VzIGFyZSBwbGF5ZXItZmFjaW5nIHJvdW5kL21vZGUgaW5mb3JtYXRpb24uCmNvbnN0IEVOQUJMRV9HQU1FUExBWV9NRVNTQUdFUyA9IHRydWU7IC8vIEdhbWVwbGF5LWNyaXRpY2FsIG1lc3NhZ2luZyAoYm90aCBjaGFubmVscykuIFRoaXMgc2hvdWxkIGJlIG9uIGF0IGFsbCB0aW1lcwpjb25zdCBFTkFCTEVfREVCVUdfTk9USUZJQ0FUSU9OX01FU1NBR0VTID0gZmFsc2U7IC8vIEdyZWVuIGJveCBub3RpZmljYXRpb25zLiBEZWZhdWx0cyB0byBmYWxzZS4KY29uc3QgRU5BQkxFX0RFQlVHX0hJR0hMSUdIVEVEX01FU1NBR0VTID0gZmFsc2U7IC8vIFdoaXRlIGhpZ2hsaWdodGVkIHdvcmxkIGxvZy4gRGVmYXVsdHMgdG8gZmFsc2UuCgovLyBUZWFtIGlkZW50aWZpZXJzIChzY3JpcHQgdXNlcyBUMS9UMiBzZW1hbnRpY3MpLgplbnVtIFRlYW1JRCB7CiAgICBUZWFtMSA9IDEsCiAgICBUZWFtMiA9IDIsCn0KCi8vIFJvdW5kIHBoYXNlIGZvciBzY29yaW5nICsgSFVEIHN0YXRlLgplbnVtIFJvdW5kUGhhc2UgewogICAgTm90UmVhZHkgPSAwLAogICAgTGl2ZSA9IDEsCiAgICBHYW1lT3ZlciA9IDIsCn0KCi8vIFZlaGljbGUgcmVnaXN0cnkgc3RvcmFnZSAoR2xvYmFsVmFyaWFibGVzKS4KLy8gS2VwdCBhdCAwLzEgdG8gbWF0Y2ggbGVnYWN5IHZlcnNpb25zIGFuZCBzaW1wbGlmeSBleHRlcm5hbCB0b29saW5nLgpjb25zdCBSRUdJU1RSWV9URUFNMV9WQVIgPSAwOwpjb25zdCBSRUdJU1RSWV9URUFNMl9WQVIgPSAxOwoKLy8gUmVnaXN0ZXJlZCB2ZWhpY2xlIGFycmF5cyBwZXJzaXN0IGFjcm9zcyByb3VuZHMgdW50aWwgZXhwbGljaXRseSBjbGVhcmVkLgpjb25zdCByZWdWZWhpY2xlc1RlYW0xID0gbW9kLkdsb2JhbFZhcmlhYmxlKFJFR0lTVFJZX1RFQU0xX1ZBUik7CmNvbnN0IHJlZ1ZlaGljbGVzVGVhbTIgPSBtb2QuR2xvYmFsVmFyaWFibGUoUkVHSVNUUllfVEVBTTJfVkFSKTsKCi8vIFZlaGljbGUgb3duZXJzaGlwIHRyYWNraW5nIChiZXN0LWVmZm9ydCBoZXVyaXN0aWMpOgovLyAtIHZlaElkcyBhbmQgdmVoT3duZXJzIGFyZSBwYXJhbGxlbCBhcnJheXMga2V5ZWQgYnkgdmVoaWNsZSBPYmpJZC4KLy8gLSBnZXRMYXN0RHJpdmVyIG1heSByZXR1cm4gdW5kZWZpbmVkIGlmIG5vIGVudGVyIGV2ZW50IHdhcyBvYnNlcnZlZCBmb3IgdGhlIHZlaGljbGUuCi8vIC0gRG8gbm90IHRyZWF0IHRoaXMgYXMgYXV0aG9yaXRhdGl2ZSBraWxsZXIgYXR0cmlidXRpb247IGl0IGlzIHVzZWQgb25seSBmb3IgaW5mb3JtYXRpdmUgbWVzc2FnaW5nLgpjb25zdCB2ZWhJZHM6IG51bWJlcltdID0gW107CmNvbnN0IHZlaE93bmVyczogbW9kLlBsYXllcltdID0gW107CgovLyBCYXNpYyBWZWhpY2xlIFNwYXduZXIgY29uc3RhbnRzLCBjYW4gYmUgdHVuZWQgZm9yIGJhbGFuY2UuCmNvbnN0IFZFSElDTEVfU1BBV05FUl9SRVNQQVdOX0RFTEFZX1NFQ09ORFMgPSAxNTsKY29uc3QgVkVISUNMRV9TUEFXTkVSX1RJTUVfVU5USUxfQUJBTkRPTl9TRUNPTkRTID0gMjsKY29uc3QgVkVISUNMRV9TUEFXTkVSX0tFRVBfQUxJVkVfQUJBTkRPTl9SQURJVVMgPSA1Owpjb25zdCBWRUhJQ0xFX1NQQVdORVJfS0VFUF9BTElWRV9TUEFXTkVSX1JBRElVUyA9IDI1OwoKLy8gVmVoaWNsZSBzcGF3bmVyIGJhY2tlbmQgbG9naWMuIFRoZXNlIGFyZSBxdWl0ZSBwYXJ0aWN1bGFyLCBjaGFuZ2luZyBjYW4gY2F1c2UgYnVncwpjb25zdCBWRUhJQ0xFX1NQQVdORVJfU1RBUlRfREVMQVlfU0VDT05EUyA9IDE7Ci8vIFN0YXJ0dXAgY2xlYW51cCByYWRpdXMgaXMgaW50ZW50aW9uYWxseSBsYXJnZXIgdGhhbiBiaW5kIHJhZGl1cyB0byBjYXRjaCBkZWZhdWx0IHNwYXducwovLyB0aGF0IGFwcGVhciBvZmZzZXQgZnJvbSB0aGUgY29uZmlndXJlZCBzcGF3biBwb2ludHMgKERlZmVuc2UgTmV4dXMvR29sZiBDb3Vyc2UvQmxhY2t3ZWxsIHNsb3QgMSkuCmNvbnN0IFZFSElDTEVfU1BBV05FUl9TVEFSVFVQX0NMRUFOVVBfUkFESVVTX01FVEVSUyA9IDUwLjA7CmNvbnN0IFZFSElDTEVfU1BBV05FUl9QT0xMX0lOVEVSVkFMX1NFQ09ORFMgPSAxLjA7CmNvbnN0IFZFSElDTEVfU1BBV05FUl9CSU5EX0RJU1RBTkNFX01FVEVSUyA9IDcuMDsKY29uc3QgVkVISUNMRV9TUEFXTkVSX0JJTkRfVElNRU9VVF9TRUNPTkRTID0gMi4wOwpjb25zdCBWRUhJQ0xFX0NBTVBFRF9ESVNUQU5DRV9NRVRFUlMgPSAyNS4wOyAvLyBUaGlzIHNob3VsZCBub3QgYmUgc21hbGxlciB0aGFuIFZFSElDTEVfU1BBV05FUl9LRUVQX0FMSVZFX1NQQVdORVJfUkFESVVTCgovLyBNYWluIGJhc2UgdHJpZ2dlcnMgKyBhbW1vIHJlc3RvY2sgdHVuaW5nLgovLyBUcmlnZ2VyIElEcyBtdXN0IG1hdGNoIHRoZSBtYXAncyBzcGF0aWFsIGRhdGEgb2JqZWN0IElEcy4KY29uc3QgQkFDS0dST1VORF9USU1FX0xJTUlUX1JFU0VUX1NFQ09ORFMgPSA2MCAqIDYwOyAvLyBFeHRlbmRzIGVuZ2luZSB0aW1lIGxpbWl0IG9uIHJvdW5kIHN0YXJ0Lgpjb25zdCBURUFNMV9NQUlOX0JBU0VfVFJJR0dFUl9JRCA9IDUwMTsgLy8gRG8gbm90IGNoYW5nZSB3aXRob3V0IHVwZGF0aW5nIHNwYXRpYWwgZGF0YS4KY29uc3QgVEVBTTJfTUFJTl9CQVNFX1RSSUdHRVJfSUQgPSA1MDA7IC8vIERvIG5vdCBjaGFuZ2Ugd2l0aG91dCB1cGRhdGluZyBzcGF0aWFsIGRhdGEuCmNvbnN0IFJFU1RPQ0tfTUFHX0FNTU9fRU5URVIgPSA2OTsgLy8gTWFnYXppbmVzIGdyYW50ZWQgb24gYmFzZSBlbnRyeS4KY29uc3QgUkVTVE9DS19NQUdfQU1NT19FWElUID0gMTsgLy8gTWFnYXppbmVzIGdyYW50ZWQgb24gYmFzZSBleGl0LgoKLy8gUmVhZHktdXAgYXV0by1zdGFydCBnYXRpbmc6Ci8vIFNldCB0byAxIGZvciBzb2xvIGRlYnVnLCAyIGZvciAxdjEsIDQgZm9yIDJ2MiwgZXRjLgpjb25zdCBERUZBVUxUX0FVVE9fU1RBUlRfTUlOX0FDVElWRV9QTEFZRVJTID0gMjsKY29uc3QgTUFUQ0hVUF9DSEFOR0VfQ09PTERPV05fU0VDT05EUyA9IDEuMDsKCi8vIFVzZWQgZm9yIE1vZGUgc2VsZWN0aW9uLCBlLmcuIDF2MSBkcml2aW5nIDEgcGxheWVyIHBlciBzaWRlIHRvIHJlYWR5IHVwIGFuZCAxIGtpbGwgdG8gd2luIGEgcm91bmQuCnR5cGUgTWF0Y2h1cFByZXNldCA9IHsKICAgIGxlZnRQbGF5ZXJzOiBudW1iZXI7CiAgICByaWdodFBsYXllcnM6IG51bWJlcjsKICAgIG1pbkFjdGl2ZVBsYXllcnM6IG51bWJlcjsKICAgIHJvdW5kS2lsbHNUYXJnZXQ6IG51bWJlcjsKfTsKCi8vIE1hdGNodXAgcHJlc2V0cyBkcml2ZSBtaW4gcGxheWVycyArIHJvdW5kIGtpbGwgdGFyZ2V0czsgc2xvdCBlbmFibGVtZW50IHVzZXMgbGVmdC9yaWdodCBjb3VudHMuCmNvbnN0IE1BVENIVVBfUFJFU0VUUzogTWF0Y2h1cFByZXNldFtdID0gWwogICAgeyBsZWZ0UGxheWVyczogMSwgcmlnaHRQbGF5ZXJzOiAwLCBtaW5BY3RpdmVQbGF5ZXJzOiAxLCByb3VuZEtpbGxzVGFyZ2V0OiAxIH0sCiAgICB7IGxlZnRQbGF5ZXJzOiAxLCByaWdodFBsYXllcnM6IDEsIG1pbkFjdGl2ZVBsYXllcnM6IDIsIHJvdW5kS2lsbHNUYXJnZXQ6IDEgfSwKICAgIHsgbGVmdFBsYXllcnM6IDIsIHJpZ2h0UGxheWVyczogMiwgbWluQWN0aXZlUGxheWVyczogNCwgcm91bmRLaWxsc1RhcmdldDogMiB9LAogICAgeyBsZWZ0UGxheWVyczogMywgcmlnaHRQbGF5ZXJzOiAzLCBtaW5BY3RpdmVQbGF5ZXJzOiA2LCByb3VuZEtpbGxzVGFyZ2V0OiAzIH0sCiAgICB7IGxlZnRQbGF5ZXJzOiA0LCByaWdodFBsYXllcnM6IDQsIG1pbkFjdGl2ZVBsYXllcnM6IDgsIHJvdW5kS2lsbHNUYXJnZXQ6IDQgfSwKXTsKCi8vIERlcml2ZSB0aGUgaW5pdGlhbCBwcmVzZXQgZnJvbSB0aGUgZGVmYXVsdCBtaW4tcGxheWVyICsga2lsbC10YXJnZXQgdmFsdWVzLgpjb25zdCBERUZBVUxUX01BVENIVVBfUFJFU0VUX0lOREVYID0gZmluZE1hdGNodXBQcmVzZXRJbmRleCgKICAgIERFRkFVTFRfQVVUT19TVEFSVF9NSU5fQUNUSVZFX1BMQVlFUlMsCiAgICBST1VORF9LSUxMU19UQVJHRVQKKTsKCi8vIFByZWdhbWUgY291bnRkb3duIHR1bmluZyAoUmVhZHkgVXAgLT4gcm91bmQgc3RhcnQpLgovLyBVbml0czogc2Vjb25kcyBhbmQgVUkgc2NhbGUgdW5pdHMuCmNvbnN0IFBSRUdBTUVfQ09VTlRET1dOX0lOSVRJQUxfREVMQVlfU0VDT05EUyA9IDAuNTsKY29uc3QgUFJFR0FNRV9DT1VOVERPV05fU1RFUF9TRUNPTkRTID0gMS4wOwpjb25zdCBQUkVHQU1FX0NPVU5URE9XTl9TVEFSVF9OVU1CRVIgPSAxMDsKY29uc3QgUFJFR0FNRV9DT1VOVERPV05fU0laRV9ESUdJVF9TVEFSVCA9IDYyMDsKY29uc3QgUFJFR0FNRV9DT1VOVERPV05fU0laRV9ESUdJVF9FTkQgPSAzNjA7CmNvbnN0IFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfR09fU1RBUlQgPSA2NTA7CmNvbnN0IFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfR09fRU5EID0gNDIwOwpjb25zdCBQUkVHQU1FX0NPVU5URE9XTl9HT19IT0xEX1NFQ09ORFMgPSAwLjc1Owpjb25zdCBQUkVHQU1FX0NPVU5URE9XTl9BTklNQVRJT05fU1RFUFMgPSAxMDsKY29uc3QgUFJFR0FNRV9BTEVSVF9URVhUX0FMUEhBID0gMC44NTsgLy8gVUkgdGV4dCBhbHBoYSAoMC4uMSkuCgovLyBUZWFtIHN3aXRjaCBiZWhhdmlvciBjb25maWd1cmF0aW9uIChzYWZlIHRvIHR3ZWFrKS4KLy8gLSBlbmFibGVUZWFtU3dpdGNoOiBtYXN0ZXIgdG9nZ2xlIGZvciB0aGUgaW50ZXJhY3QtYmFzZWQgdGVhbSBzd2l0Y2ggZGlhbG9nLgovLyAtIGludGVyYWN0UG9pbnRNaW5MaWZldGltZS9NYXhMaWZldGltZTogbGlmZXRpbWUgd2luZG93IGJlZm9yZSBhdXRvLWRlc3Bhd24uCi8vIC0gdmVsb2NpdHlUaHJlc2hvbGQ6IHJlbW92ZSBpbnRlcmFjdCBwb2ludCB3aGlsZSBwbGF5ZXIgaXMgbW92aW5nLgpjb25zdCBURUFNU1dJVENIQ09ORklHOiBUZWFtU3dpdGNoQ29uZmlnID0gewogICAgZW5hYmxlVGVhbVN3aXRjaDogdHJ1ZSwKICAgIGludGVyYWN0UG9pbnRNaW5MaWZldGltZTogMSwKICAgIGludGVyYWN0UG9pbnRNYXhMaWZldGltZTogMywKICAgIHZlbG9jaXR5VGhyZXNob2xkOiAzLAp9OwoKLy8gQWRtaW4gcGFuZWwgdG9nZ2xlIGRlYm91bmNlIChzZWNvbmRzKS4gUHJldmVudHMgZG91YmxlLXRvZ2dsZSBmcm9tIHByZXNzL3JlbGVhc2UgZXZlbnRzLgpjb25zdCBBRE1JTl9QQU5FTF9UT0dHTEVfQ09PTERPV05fU0VDT05EUyA9IDAuMjsKCi8vIENsb2NrICsgSFVEIGxheW91dCBjb25zdGFudHMgKHBpeGVscyB1bmxlc3Mgbm90ZWQpLgpjb25zdCBDTE9DS19QT1NJVElPTl9YID0gMDsKY29uc3QgQ0xPQ0tfUE9TSVRJT05fWSA9IDUzOwpjb25zdCBDTE9DS19XSURUSCA9IDIyMDsKY29uc3QgQ0xPQ0tfSEVJR0hUID0gNDQ7CmNvbnN0IFJPVU5EX0xJVkVfSEVMUF9XSURUSCA9IDMwMDsKY29uc3QgUk9VTkRfTElWRV9IRUxQX0hFSUdIVCA9IDE4Owpjb25zdCBDTE9DS19GT05UX1NJWkUgPSAzMjsKY29uc3QgTE9XX1RJTUVfVEhSRVNIT0xEX1NFQ09ORFMgPSA2MDsgLy8gTG93LXRpbWUgY29sb3IgdGhyZXNob2xkIGluIHNlY29uZHMuCgovLyBIVUQgc3RhdHVzIGNvbG9ycyAodmVjdG9ycyBhcmUgUkdCIDAuLjEpLgpjb25zdCBDT0xPUl9OT1JNQUwgPSBtb2QuQ3JlYXRlVmVjdG9yKDEsIDEsIDEpOwpjb25zdCBDT0xPUl9MT1dfVElNRSA9IG1vZC5DcmVhdGVWZWN0b3IoMSwgMTMxIC8gMjU1LCA5NyAvIDI1NSk7CmNvbnN0IENPTE9SX1JFQURZX0dSRUVOID0gbW9kLkNyZWF0ZVZlY3RvcigxNzMgLyAyNTUsIDI1MyAvIDI1NSwgMTM0IC8gMjU1KTsgLy8gI0FERkQ4NgoKLy8gU3RhdHVzIC8gZW1waGFzaXMgY29sb3JzICh1c2UgY29uc3RhbnRzOyBkbyBub3QgaW5saW5lIENyZWF0ZVZlY3RvcigpIGluIFVJIGNvZGUpLgpjb25zdCBDT0xPUl9OT1RfUkVBRFlfUkVEID0gbW9kLkNyZWF0ZVZlY3RvcigxLCAwLCAwKTsKY29uc3QgQ09MT1JfV0FSTklOR19ZRUxMT1cgPSBtb2QuQ3JlYXRlVmVjdG9yKDEsIDEsIDApOwoKLy8gVmljdG9yeSBkaWFsb2cgdGhlbWUgY29sb3JzIChQYXJzZVVJIGV4cGVjdHMgUkdCIHR1cGxlcywgbm90IHZlY3RvcnMpLgpjb25zdCBWSUNUT1JZX0JHX1JHQjogW251bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWzAuMDMxNCwgMC4wNDMxLCAwLjA0MzFdOwpjb25zdCBWSUNUT1JZX1RFQU0xX0JHX1JHQjogW251bWJlciwgbnVtYmVyLCBudW1iZXJdID0gWzAuMTA5OCwgMC4yMzA0LCAwLjI1XTsKY29uc3QgVklDVE9SWV9URUFNMl9CR19SR0I6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFswLjI1LCAwLjEyODQsIDAuMDk1MV07CmNvbnN0IFZJQ1RPUllfVEVBTTFfVEVYVF9SR0I6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFswLjQzOTIsIDAuOTIxNiwgMV07CmNvbnN0IFZJQ1RPUllfVEVBTTJfVEVYVF9SR0I6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFsxLCAwLjUxMzcsIDAuMzgwNF07CgovLyBNYWluIGJhc2UgbWVzc2FnaW5nIHN0cmluZyBrZXlzIChTdHJpbmdzLmpzb24pLgpjb25zdCBTVFJfRU5URVJFRF9NQUlOX0JBU0UgPSBtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5lbnRlcmVkTWFpbkJhc2U7CmNvbnN0IFNUUl9FWElURURfTUFJTl9CQVNFID0gbW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMuZXhpdGVkTWFpbkJhc2U7CmNvbnN0IFNUUl9BTU1PX1JFU1RPQ0tFRCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5ub3RpZmljYXRpb25zLmFtbW9SZXN0b2NrZWQ7CmNvbnN0IFNUUl9SRUFEWVVQX1JFVFVSTl9UT19CQVNFX05PVF9MSVZFID0gbW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMucmVhZHl1cFJldHVyblRvQmFzZU5vdExpdmU7CmNvbnN0IFNUUl9WRUhJQ0xFX1NQQVdOX1JFVFJZID0gbW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnZlaGljbGVTcGF3blJldHJ5Owpjb25zdCBTVFJfVkVISUNMRV9TVE9MRU5fUkVHSVNURVIgPSBtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMudmVoaWNsZVN0b2xlblJlZ2lzdGVyOwpjb25zdCBTVFJfUkVBRFlfRElBTE9HX01BVENIVVBfQ0hBTkdFRCA9IG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5tYXRjaHVwQ2hhbmdlZDsKCi8vICJPdmVyIHRoZSBsaW5lIiBnbG9iYWwgd2FybmluZyAocHJlLXJvdW5kIGNvdW50ZG93biBvbmx5KS4KY29uc3QgT1ZFUl9MSU5FX1RJVExFX1NJWkUgPSA5NjsgLy8gRm9udCBzaXplIGluIFVJIHNjYWxlIHVuaXRzLgpjb25zdCBPVkVSX0xJTkVfU1VCVElUTEVfU0laRSA9IDMyOwpjb25zdCBPVkVSX0xJTkVfU1VCVElUTEVfT0ZGU0VUX1kgPSA2MDsgLy8gVmVydGljYWwgb2Zmc2V0IGZyb20gdGl0bGUuCmNvbnN0IE9WRVJfTElORV9NRVNTQUdFX0RVUkFUSU9OX1NFQ09ORFMgPSA1OyAvLyBEdXJhdGlvbiBpbiBzZWNvbmRzLgoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIENvbnN0YW50cywgRW51bXMgYW5kIFR5cGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBNYXAgQ29uZmlnIChDb25zdGFudHMgKyBUeXBlcykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIFN1cHBvcnQgbWFwcyBmb3IgdGhpcyBnYW1lbW9kZSwgc2hvdWxkIGhhdmUgYSBsaXN0aW5nIGluIE1hcEtleSwgYW5kIGEgY29ycmVzcG9uZGluZyBsaXN0IG9mIHNwYXduZXJzIGluIE1hcENvbmZpZwp0eXBlIE1hcEtleSA9ICJCbGFja3dlbGxfRmllbGRzIiB8ICJEZWZlbnNlX05leHVzIiB8ICJHb2xmX0NvdXJzZSIgfCAiTWlyYWtfVmFsbGV5IiB8ICJPcGVyYXRpb25fRmlyZXN0b3JtIiB8ICJMaWJlcmF0aW9uX1BlYWsiIHwgIk1hbmhhdHRhbl9CcmlkZ2UiIHwgIkFyZWFfMjJCIjsKCi8vIHNsb3ROdW1iZXIgZGVmaW5lcyB0aGUgZXhwbGljaXQgc3Bhd24gcHJpb3JpdHkgcGVyIHRlYW0gKHVzZWQgZm9yIDF2MS8ydjIvM3YzLzR2NCBlbmFibGVtZW50KS4KdHlwZSBWZWhpY2xlU3Bhd25TcGVjID0geyBzbG90TnVtYmVyOiBudW1iZXI7IHBvczogbW9kLlZlY3Rvcjsgcm90OiBtb2QuVmVjdG9yOyB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QgfTsKCi8vIEV2ZXJ5IG1hcCBuZWVkcyBhIHRlYW0gMSBhbmQgdGVhbSAyIEhRIG9iamVjdCBpbiB0aGUgc3BhdGlhbCBkYXRhLCBzbyB0aGlzIGxpc3Qgb2YgdmVoaWNsZXMgY2FuIHNwYXduIGFuZCBkeW5hbWljYWxseSBnZXQgcmVmZXJlbmNlZCBvbiBtYXAgbG9hZAp0eXBlIE1hcENvbmZpZyA9IHsKICAgIHRlYW0xQmFzZTogbW9kLlZlY3RvcjsKICAgIHRlYW0yQmFzZTogbW9kLlZlY3RvcjsKICAgIHRlYW0xTmFtZTogbnVtYmVyOwogICAgdGVhbTJOYW1lOiBudW1iZXI7CiAgICB0ZWFtMVNwYXduczogVmVoaWNsZVNwYXduU3BlY1tdOwogICAgdGVhbTJTcGF3bnM6IFZlaGljbGVTcGF3blNwZWNbXTsKICAgIHZlaGljbGVTcGF3bllhd09mZnNldERlZzogbnVtYmVyOyAvL1RoaXMgaXMgbm90IHVzZWQgYW55bW9yZSwgYnV0IHdlJ3JlIGtlZXBpbmcgaXQgaW4gY2FzZSBpdHMgbmVlZGVkIGluIHRoZSBmdXR1cmUKfTsKCi8vIENoYW5nZSB0aGlzIE1hcEtleSB0byBzd2l0Y2ggYWN0aXZlIG1hcCBjb25maWd1cmF0aW9uIGZvciB0aGF0IG1hcCwgb25seSBvbmUgbWFwIGNhbiBiZSBhY3RpdmUgYXQgYSB0aW1lISBUaGlzIGhhcHBlbnMgaW5zaWRlIGdldE1hcE5hbWVLZXkgJiBhcHBseU1hcENvbmZpZwpsZXQgQUNUSVZFX01BUF9LRVk6IE1hcEtleSA9ICJCbGFja3dlbGxfRmllbGRzIjsgLy9OZWVkIHRvIHBpY2sgb25lIHRvIGJlIGRlZmF1bHQKCi8vIE1hcC1zcGVjaWZpYyBiYXNlcyArIHNwYXduIHNsb3RzLiBLZWVwIHNsb3ROdW1iZXIgdW5pcXVlIHdpdGhpbiBhIHRlYW07IFNsb3RzIGFyZSBwYXJhbGxlbCwgZS5nLiBTbG90IDIgb24gVGVhbSAxIGFuZCBTbG90IDIgb24gVGVhbSAyIC0gYm90aCB2ZWhpY2xlcyBzcGF3biBpbiB3aGVuIHRoZSAydjIgbW9kZSBpcyB0b2dnbGVkCmNvbnN0IE1BUF9DT05GSUdTOiBSZWNvcmQ8TWFwS2V5LCBNYXBDb25maWc+ID0gewoKICAgIC8vQmFkbGFuZHMKICAgIEJsYWNrd2VsbF9GaWVsZHM6IHsgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogCiAgICAgICAgdGVhbTFCYXNlOiBtb2QuQ3JlYXRlVmVjdG9yKC0xNTEuMzY0LCAgODYuOTQ4LCAgLTU2Ny42NzIpLCB0ZWFtMU5hbWU6IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5XRVNULAogICAgICAgIHRlYW0yQmFzZTogbW9kLkNyZWF0ZVZlY3RvciggMzg4LjIzMSwgIDcxLjY1MiwgICAxMzYuNTQpLCAgdGVhbTJOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuRUFTVCwKICAgICAgIAogICAgICAgIHZlaGljbGVTcGF3bllhd09mZnNldERlZzogMCwKCiAgICAgICAgdGVhbTFTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1ggICAgICBwb3NZICAgICAgcG9zWgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMTYzLjI4NSwgIDg2Ljk2LCAgIC01NzAuMjU0KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNDUuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BYnJhbXMgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTE2OS41NTksICA4Ni45MTUsICAtNTYwLjE2OCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDQ1LjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTTJCcmFkbGV5ICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0xNzguMTc0LCAgODcuMTU5LCAgLTU1MS4yMDYpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA0NS4wLCAgICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMTg1LjgzMywgIDg3LjE1OSwgIC01NDAuOTQ5KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNDUuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICBdLAogICAgICAgIHRlYW0yU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NYICAgICAgcG9zWSAgICAgIHBvc1oKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDQwMy41NzUsICA3MS4yMjcsICAgMTQ0LjU5NCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTkwLjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTGVvcGFyZCAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA0MDQuMDU0LCAgNzEuMjI3LCAgIDEzMS45NjYpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC05MC4wLCAgICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkNWOTAgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNDAzLjU3NSwgIDcxLjIyNywgICAxMTguNTcxKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtOTAuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDQwMy4yNzQsICA3MS4yMjcsICAgMTA1Ljg4NiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTkwLjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgXSwKICAgIH0sCgogICAgLy9HcmFuaXRlX1RlY2hDYW1wdXMKICAgIERlZmVuc2VfTmV4dXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAKICAgICAgICB0ZWFtMUJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoLTE1MS4wODYyLCAxMzMuNjk0LCAgNDI4LjAxOCksIHRlYW0xTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLlNPVVRILAogICAgICAgIHRlYW0yQmFzZTogbW9kLkNyZWF0ZVZlY3RvcigtMTA3LjcyNywgIDEzOS4yOTMsICAxMjMuMjQ4KSwgdGVhbTJOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuTk9SVEgsCiAgICAKICAgICAgICB2ZWhpY2xlU3Bhd25ZYXdPZmZzZXREZWc6IDAsIAoKICAgICAgICB0ZWFtMVNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90WCAgICAgIHJvdFkgICAgICByb3RaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0xODUuNTAzLCAgMTM2LjU5NiwgIDQ1NC42MTcpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xNjUuODM0LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMTc5LjEwOSwgIDEzNi4xNDYsICA0NTMuMzI3KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTU4LjUyNiwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTE3NC4xNzIsICAxMzUuMTQwLCAgNDQ5LjM4MCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTE0OS4yNTYsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0xNjguMjkzLCAgMTM0LjA2NywgIDQ0Mi45MzUpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xMzUuNDQyLCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICB9LAogICAgICAgIF0sCiAgICAgICAgdGVhbTJTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1ggICAgICBwb3NZICAgICAgcG9zWgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMTA4LjgyNCwgIDEzOC44MTUsICAxMTIuMjA5KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtNDQuOTg0LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5DVjkwICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTEwNC4xNTMsICAxMzguNTMwLCAgMTE1LjAzNCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTQ0LjcxNywgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0xMDEuMzc4LCAgMTM4LjU0NCwgIDExOS4yNjMpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC00NC44MDYsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMTE2LjU2NiwgIDEzOC44NTIsICAxMDQuMTc1KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtNDQuODk1LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5DVjkwICAgICAgICAgfSwKICAgICAgICBdLAogICAgfSwKCiAgICAvL0dyYW5pdGVfQ2x1YkhvdXNlCiAgICBHb2xmX0NvdXJzZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgcG9zWSAgICAgIHBvc1ogCiAgICAgICAgdGVhbTFCYXNlOiBtb2QuQ3JlYXRlVmVjdG9yKC03NjQuNTA4LCAxNDYuNjk2LCAtODU2LjE5MyksIHRlYW0xTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLk5PUlRILAogICAgICAgIHRlYW0yQmFzZTogbW9kLkNyZWF0ZVZlY3RvcigtNzI0Ljc2OSwgMTQxLjMxNywgLTI3MS42NTMpLCB0ZWFtMk5hbWU6IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5TT1VUSCwKICAgICAgICAKICAgICAgICB2ZWhpY2xlU3Bhd25ZYXdPZmZzZXREZWc6IDAsCgogICAgICAgIHRlYW0xU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RYICAgICAgcm90WSAgICAgIHJvdFoKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTc2NS4wMzIsICAxNDYuMDY4LCAtODYzLjMwNyksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTIxLjkwOCwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTTJCcmFkbGV5ICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC03NTguMzk4LCAgMTQ2LjUyNCwgLTg2MS44OTApLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA5LjI4NywgICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNzUxLjIzNCwgIDE0Ny4zNzMsIC04NTkuMDA5KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTAuMDAwLCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BYnJhbXMgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTc0MS43NzksICAxNDguOTE5LCAtODU2Ljc1MSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDIwLjAwMCwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTTJCcmFkbGV5ICAgIH0sCiAgICAgICAgXSwKICAgICAgICB0ZWFtMlNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zWCAgICAgIHBvc1kgICAgICBwb3NaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC03MjIuODAwLCAgMTQwLjk5NywgLTI3NS45ODApLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxMzguMzU3LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkNWOTAgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNzE2LjA0NSwgIDE0MC41NTUsIC0yNzAuMjE5KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTM4LjM1NywgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5DVjkwICAgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTcwOS4zMjcsICAxNDAuNjgwLCAtMjY0Ljk2OCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDEzOC4xNzksICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTGVvcGFyZCAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC03MDIuMDgwLCAgMTQwLjYyNSwgLTI1OS43NzIpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxMzkuMjQ4LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkNWOTAgICAgICAgICB9LAogICAgICAgIF0sCiAgICB9LAoKICAgIC8vVHVuZ3N0ZW4KICAgIE1pcmFrX1ZhbGxleTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaIAogICAgICAgIHRlYW0xQmFzZTogbW9kLkNyZWF0ZVZlY3RvcigtNTA1LjY0MSwgIDgyLjU3MSwgIC0zMjkuMDM0KSwgdGVhbTFOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuV0VTVCwKICAgICAgICB0ZWFtMkJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoIDQyOC4zMiwgICA4NS4yMTUsICAtNjE5LjMzOSksIHRlYW0yTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLkVBU1QsCiAgICAgICAKICAgICAgICB2ZWhpY2xlU3Bhd25ZYXdPZmZzZXREZWc6IDAsCgogICAgICAgIHRlYW0xU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RYICAgICAgcm90WSAgICAgIHJvdFoKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTQ5Ny4zMjgsICA4MS45MDksICAtMzIwLjA1OCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDkwLjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC00OTMuNjk5LCAgODIuMTY3LCAgLTMzMC42MTYpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA4Ny4wLCAgICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNDg4Ljg2OSwgIDgyLjU1NiwgIC0zNDAuNzIzKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgODUuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTQ4NS4zMzUsICA4My4yNDQsICAtMzUxLjMyNyksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDg0LjUwMCwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgXSwKICAgICAgICB0ZWFtMlNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zWCAgICAgIHBvc1kgICAgICBwb3NaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA0MjMuMTU1LCAgODUuMTYwLCAgLTYwOS41OTMpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC00MS4yMTIsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNDEyLjQxNiwgIDg1LjQ0MiwgIC02MTAuMDQ0KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtNDUuNTgwLCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDQwMC4zOTYsICA4NS43NzUsICAtNjEwLjU3NiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTQ3LjcxOSwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAzODguNjY3LCAgODYuMDg1LCAgLTYxMS41OTYpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC00NC45NTYsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgIF0sCiAgICB9LAoKICAgIC8vRmlyZXN0b3JtCiAgICBPcGVyYXRpb25fRmlyZXN0b3JtOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogCiAgICAgICAgdGVhbTFCYXNlOiBtb2QuQ3JlYXRlVmVjdG9yKCA1NzAuNjkyLCAgMTEwLjIwNSwgLTIzMi4zNDEpLCB0ZWFtMU5hbWU6IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5XRVNULAogICAgICAgIHRlYW0yQmFzZTogbW9kLkNyZWF0ZVZlY3RvcigtNzYxLjg2OSwgIDEzMy4wOTEsICAyMjMuMDM4KSwgdGVhbTJOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuRUFTVCwKCiAgICAgICAgdmVoaWNsZVNwYXduWWF3T2Zmc2V0RGVnOiAwLAoKICAgICAgICB0ZWFtMVNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdFggICAgICByb3RZICAgICAgcm90WgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNzkwLjgzNywgIDEzMi45NzEsICAyNDQuNjE2KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTQzLjg0OSwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BYnJhbXMgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTc4NS4wMjIsICAxMzIuOTczLCAgMjQ2Ljk1MyksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDE0MC4wNDcsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC03NzUuMTQwLCAgMTMyLjk3MSwgIDI1NS4zMTIpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxNDMuODc5LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtNzcwLjI3NywgIDEzMi45NzEsICAyNTkuMjk2KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTQxLjY1MSwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BYnJhbXMgICAgICAgfSwKCiAgICAgICAgXSwKICAgICAgICB0ZWFtMlNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zWCAgICAgIHBvc1kgICAgICBwb3NaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA2MDEuNzM1LCAgMTEwLjI4MywgLTIzMC4yNDYpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xMTkuNDYzLCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNjA4LjM3OSwgIDExMC4yODMsIC0yMzMuNTY5KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTMwLjQyNSwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDYxNS4zNjYsICAxMTAuMjgzLCAtMjQzLjI4OCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTEyNC4xODcsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA2MTcuOTA0LCAgMTEwLjI5NywgLTI0OS44MjMpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xMjUuNzAyLCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgIF0sCiAgICB9LAoKICAgIC8vQ2Fwc3RvbmUKICAgIExpYmVyYXRpb25fUGVhazogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaIAogICAgICAgIHRlYW0xQmFzZTogbW9kLkNyZWF0ZVZlY3RvcigtMzIzLjM2NSwgIDEzMC40NTIsICA4My4yMTEpLCAgdGVhbTFOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuV0VTVCwKICAgICAgICB0ZWFtMkJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoIDI4MS44ODcsICAxMzkuMDk1LCAgNDY0LjE4NyksIHRlYW0yTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLkVBU1QsCiAgICAgICAgCiAgICAgICAgdmVoaWNsZVNwYXduWWF3T2Zmc2V0RGVnOiAwLAoKICAgICAgICB0ZWFtMVNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90WCAgICAgIHJvdFkgICAgICByb3RaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0zMTMuMTIyLCAgMTMwLjEwOSwgIDkxLjMxNyksICByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA2Ny42ODEsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMzA2Ljg1NywgIDEyOS45OTgsICA4NC41MDApLCAgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNDkuMzIxLCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTMwOS44NTgsICAxMzAuMzE2LCAgMTAyLjEyNCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDYxLjQ0MiwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQWJyYW1zICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0zMTAuODY1LCAgMTMwLjgyNSwgIDExNS4wOTgpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA4My4yNzgsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lk0yQnJhZGxleSAgICB9LAogICAgICAgIF0sCiAgICAgICAgdGVhbTJTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1ggICAgICBwb3NZICAgICAgcG9zWgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMjc3LjA5NywgIDEzOS43MjUsICA0NTEuMDI3KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTU3LjE3NiwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDI4NS40NjQsICAxMzkuNDQ5LCAgNDQ2LjgyMyksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTEzNy45MjQsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAyNzAuMDIzLCAgMTM5LjkxNywgIDQ1Ny41MzgpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xNTYuODE5LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0Lkxlb3BhcmQgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMjU3LjkzOCwgIDEzOS40MDMsICA0NTkuMDMyKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTYyLjA5NCwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5DVjkwICAgICAgICAgfSwKICAgICAgICBdLAogICAgfSwKCiAgICAvL0R1bWJvCiAgICBNYW5oYXR0YW5fQnJpZGdlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogCiAgICAgICAgdGVhbTFCYXNlOiBtb2QuQ3JlYXRlVmVjdG9yKC0yNjMuMzEyLCAgNTIuMzA4LCAgLTQ2MC42MTIpLCB0ZWFtMU5hbWU6IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5XRVNULAogICAgICAgIHRlYW0yQmFzZTogbW9kLkNyZWF0ZVZlY3RvciggMTc2LjA1MywgIDU3LjQ3NCwgIC0yNDMuODQzKSwgdGVhbTJOYW1lOiBtb2Quc3RyaW5na2V5cy50d2wudGVhbXMuRUFTVCwKICAgICAgIAogICAgICAgIHZlaGljbGVTcGF3bllhd09mZnNldERlZzogMCwKCiAgICAgICAgdGVhbTFTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdFggICAgICByb3RZICAgICAgcm90WgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMjYwLjMxNywgIDUyLjA3OSwgIC00NTEuNDc1KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMzQuNjg3LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5BYnJhbXMgICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoLTI3MC4wNjEsICA1Mi4wNzksICAtNDQ4LjY4MCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDUyLjI0NSwgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTTJCcmFkbGV5ICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKC0yODEuOTYyLCAgNTIuMDc5LCAgLTQ0OC42MDQpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICA1Mi4wNjcsICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvcigtMjk0LjQyOCwgIDUyLjA3OSwgIC00NDguNzcyKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgNDAuNjU5LCAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICBdLAogICAgICAgIHRlYW0yU3Bhd25zOiBbICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcG9zWCAgICAgIHBvc1kgICAgICBwb3NaICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NYICAgICAgcG9zWSAgICAgIHBvc1oKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAxLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDIwNS4yNzEsICA1Ny4zNTgsICAtMjM5Ljc3NCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTkwLjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTGVvcGFyZCAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMiwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAyMDUuNTQ5LCAgNTcuMzU4LCAgLTI0Ny44MjIpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC05MC4wLCAgICAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkNWOTAgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDMsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMjA1LjI5NCwgIDU3LjM1OCwgIC0yNTEuOTg2KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtOTAuMCwgICAgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiA0LCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDIwMi43MDcsICA1Ny4zNTgsICAtMjU3LjI0MCksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTkwLjAsICAgICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgXSwKICAgIH0sCiAgICAKICAgIC8vR3Jhbml0ZSBNaWxpdGFyeSBSTkQgUG9ydAogICAgQXJlYV8yMkI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAKICAgICAgICB0ZWFtMUJhc2U6IG1vZC5DcmVhdGVWZWN0b3IoIDE4MS4zMjcsICAxNzMuMTkzLCAtMzk5LjIwMSksIHRlYW0xTmFtZTogbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLldFU1QsCiAgICAgICAgdGVhbTJCYXNlOiBtb2QuQ3JlYXRlVmVjdG9yKCA3ODIuMDEzLCAgMTc4LjAyOCwgLTUwOC43OTIpLCB0ZWFtMk5hbWU6IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5FQVNULAogICAgICAgCiAgICAgICAgdmVoaWNsZVNwYXduWWF3T2Zmc2V0RGVnOiAwLAoKICAgICAgICB0ZWFtMVNwYXduczogWyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Bvc1ggICAgICBwb3NZICAgICAgcG9zWiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90WCAgICAgIHJvdFkgICAgICByb3RaCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMSwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAyMDMuNDY0LCAgMTczLjY1MSwgLTQwNC40OTYpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxNTIuNzIxLCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDIsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggMTk4LjE1NywgIDE3My42NTEsIC00MTEuODA0KSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAgMTUyLjYzMiwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5NMkJyYWRsZXkgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAzLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDE5Ni42MDYsICAxNzMuNTIxLCAtNDI2LjQ4OSksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgIDE1Mi44OTksICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuTTJCcmFkbGV5ICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogNCwgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCAxOTUuMDE4LCAgMTczLjY1NSwgLTQ0MC42OTkpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgICAxNTIuNTQzLCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkFicmFtcyAgICAgICB9LAogICAgICAgIF0sCiAgICAgICAgdGVhbTJTcGF3bnM6IFsgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wb3NYICAgICAgcG9zWSAgICAgIHBvc1ogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1ggICAgICBwb3NZICAgICAgcG9zWgogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDEsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggODA1LjcwNiwgIDE3Ny42MjQsIC00NzQuNDgxKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTU5LjQxOSwgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICAgICAgeyBzbG90TnVtYmVyOiAyLCBwb3M6IG1vZC5DcmVhdGVWZWN0b3IoIDc5OS41MDYsICAxNzcuNjY5LCAtNDkwLjE1NiksIHJvdDogbW9kLkNyZWF0ZVZlY3RvciggMC4wLCAgICAgLTE1Ny41NDgsICAwLjApLCAgICAgICB2ZWhpY2xlOiBtb2QuVmVoaWNsZUxpc3QuQ1Y5MCAgICAgICAgIH0sCiAgICAgICAgICAgIHsgc2xvdE51bWJlcjogMywgcG9zOiBtb2QuQ3JlYXRlVmVjdG9yKCA3OTIuNTYxLCAgMTc3LjYyOCwgLTUwNi42NDUpLCByb3Q6IG1vZC5DcmVhdGVWZWN0b3IoIDAuMCwgICAgIC0xNTYuOTI0LCAgMC4wKSwgICAgICAgdmVoaWNsZTogbW9kLlZlaGljbGVMaXN0LkNWOTAgICAgICAgICB9LAogICAgICAgICAgICB7IHNsb3ROdW1iZXI6IDQsIHBvczogbW9kLkNyZWF0ZVZlY3RvciggNzg2LjM0MCwgIDE3Ny42MDUsIC01MjAuNjEzKSwgcm90OiBtb2QuQ3JlYXRlVmVjdG9yKCAwLjAsICAgICAtMTU1LjA4MywgIDAuMCksICAgICAgIHZlaGljbGU6IG1vZC5WZWhpY2xlTGlzdC5MZW9wYXJkICAgICAgfSwKICAgICAgICBdLAogICAgfSwKfTsKCi8vIE1hcEtleSAtPiBTdHJpbmdzLmpzb24ga2V5IG1hcHBpbmcgZm9yIHRoZSBSZWFkeSBkaWFsb2cgbWFwIGxhYmVsLgpjb25zdCBNQVBfTkFNRV9TVFJJTkdLRVlTOiBSZWNvcmQ8TWFwS2V5LCBudW1iZXI+ID0gewogICAgQmxhY2t3ZWxsX0ZpZWxkczogbW9kLnN0cmluZ2tleXMudHdsLm1hcHMuYmxhY2t3ZWxsRmllbGRzLAogICAgRGVmZW5zZV9OZXh1czogbW9kLnN0cmluZ2tleXMudHdsLm1hcHMuZGVmZW5zZU5leHVzLAogICAgR29sZl9Db3Vyc2U6IG1vZC5zdHJpbmdrZXlzLnR3bC5tYXBzLmdvbGZDb3Vyc2UsCiAgICBNaXJha19WYWxsZXk6IG1vZC5zdHJpbmdrZXlzLnR3bC5tYXBzLm1pcmFrVmFsbGV5LAogICAgT3BlcmF0aW9uX0ZpcmVzdG9ybTogbW9kLnN0cmluZ2tleXMudHdsLm1hcHMub3BlcmF0aW9uRmlyZXN0b3JtLAogICAgTGliZXJhdGlvbl9QZWFrOiBtb2Quc3RyaW5na2V5cy50d2wubWFwcy5saWJlcmF0aW9uUGVhaywKICAgIE1hbmhhdHRhbl9CcmlkZ2U6IG1vZC5zdHJpbmdrZXlzLnR3bC5tYXBzLm1hbmhhdHRhbkJyaWRnZSwKICAgIEFyZWFfMjJCOiBtb2Quc3RyaW5na2V5cy50d2wubWFwcy5hcmVhMjJCLAp9OwoKLy8gRXhwZWN0ZWQgdG8gaW5jbHVkZSB0ZWFtIGJhc2VzICsgYXQgbGVhc3Qgb25lIHNwYXduIHBlciB0ZWFtLCB3aXRoIHVuaXF1ZSBzbG90TnVtYmVyIHZhbHVlcyBtYXRjaGluZyBwZXIgc2lkZS4KbGV0IEFDVElWRV9NQVBfQ09ORklHID0gTUFQX0NPTkZJR1NbQUNUSVZFX01BUF9LRVldOwoKLy8gQmFzZWxpbmUgdGVhbSBpbmZlcmVuY2UgZnJvbSBzdGF0aWMgbWFpbi1iYXNlIGFuY2hvciBjb29yZGluYXRlcyAoT3B0aW9uIEEpLgovLyAtIFJlcGxhY2UgdGhlc2UgdmVjdG9ycyB3aXRoIGV4YWN0IG1hcCBjb29yZGluYXRlcyB0aHJvdWdoIE1hcENvbmZpZzsgdGhlc2UgcG9zaXRpb25zIGRyaXZlIGZhbGxiYWNrIHRlYW0gcmVnaXN0cmF0aW9uLgovLyAtIEEgc3Bhd25lZCB2ZWhpY2xlIGlzIGFzc2lnbmVkIHRvIHRoZSBuZWFyZXN0IGJhc2UgYW5jaG9yIGlmIHdpdGhpbiBNQUlOX0JBU0VfQklORF9SQURJVVNfTUVURVJTLgpsZXQgTUFJTl9CQVNFX1RFQU0xX1BPUyA9IEFDVElWRV9NQVBfQ09ORklHLnRlYW0xQmFzZTsKbGV0IE1BSU5fQkFTRV9URUFNMl9QT1MgPSBBQ1RJVkVfTUFQX0NPTkZJRy50ZWFtMkJhc2U7CmNvbnN0IE1BSU5fQkFTRV9CSU5EX1JBRElVU19NRVRFUlMgPSAxNTAuMDsKCi8vIENhY2hlZCBwZXItdmVoaWNsZSBzcGF3biBpbmZlcmVuY2UgZm9yIGxhdGVyIHJlY29uY2lsaWF0aW9uIG9uIHNlYXQgZW50cnkuCmNvbnN0IHZlaGljbGVTcGF3bkJhc2VUZWFtQnlPYmpJZDogUmVjb3JkPG51bWJlciwgVGVhbUlEPiA9IHt9OwoKLy8gVmVoaWNsZSBzcGF3bmVyIGRlZmF1bHRzIChwZXItbWFwIHNwYXduIHNwZWNzKS4KbGV0IFRFQU0xX1ZFSElDTEVfU1BBV05fU1BFQ1MgPSBBQ1RJVkVfTUFQX0NPTkZJRy50ZWFtMVNwYXduczsKbGV0IFRFQU0yX1ZFSElDTEVfU1BBV05fU1BFQ1MgPSBBQ1RJVkVfTUFQX0NPTkZJRy50ZWFtMlNwYXduczsKbGV0IFZFSElDTEVfU1BBV05fWUFXX09GRlNFVF9ERUcgPSBBQ1RJVkVfTUFQX0NPTkZJRy52ZWhpY2xlU3Bhd25ZYXdPZmZzZXREZWc7Cgpjb25zdCBNQVBfREVURUNUX0RJU1RBTkNFX01FVEVSUyA9IDUuMDsKCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBNYXAgQ29uZmlnIChDb25zdGFudHMgKyBUeXBlcykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE1hcCArIE1hdGNodXAgSGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gUmV0dXJucyB0aGUgUmVhZHktZGlhbG9nIGRpc3BsYXkgc3RyaW5na2V5IGZvciB0aGUgY3VycmVudCBtYXAuCmZ1bmN0aW9uIGdldE1hcE5hbWVLZXkobWFwS2V5OiBNYXBLZXkpOiBudW1iZXIgewogICAgcmV0dXJuIE1BUF9OQU1FX1NUUklOR0tFWVNbbWFwS2V5XSA/PyBtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLnVua25vd25QbGF5ZXI7Cn0KCi8vIEFwcGxpZXMgdGhlIHNlbGVjdGVkIG1hcCdzIGJhc2UgYW5jaG9ycywgc3Bhd24gc3BlY3MsIGFuZCB5YXcgb2Zmc2V0cyB0byB0aGUgYWN0aXZlIHJ1bnRpbWUgY29uZmlnLgovLyBBbHNvIHJlZnJlc2hlcyB0aGUgUmVhZHkgZGlhbG9nIG1hcCBsYWJlbCBzbyB0aGUgVUkgbWF0Y2hlcyB0aGUgYWN0aXZlIG1hcC4KZnVuY3Rpb24gYXBwbHlNYXBDb25maWcobWFwS2V5OiBNYXBLZXkpOiB2b2lkIHsKICAgIEFDVElWRV9NQVBfS0VZID0gbWFwS2V5OwogICAgQUNUSVZFX01BUF9DT05GSUcgPSBNQVBfQ09ORklHU1tBQ1RJVkVfTUFQX0tFWV07CiAgICBNQUlOX0JBU0VfVEVBTTFfUE9TID0gQUNUSVZFX01BUF9DT05GSUcudGVhbTFCYXNlOwogICAgTUFJTl9CQVNFX1RFQU0yX1BPUyA9IEFDVElWRV9NQVBfQ09ORklHLnRlYW0yQmFzZTsKICAgIFRFQU0xX1ZFSElDTEVfU1BBV05fU1BFQ1MgPSBBQ1RJVkVfTUFQX0NPTkZJRy50ZWFtMVNwYXduczsKICAgIFRFQU0yX1ZFSElDTEVfU1BBV05fU1BFQ1MgPSBBQ1RJVkVfTUFQX0NPTkZJRy50ZWFtMlNwYXduczsKICAgIFZFSElDTEVfU1BBV05fWUFXX09GRlNFVF9ERUcgPSBBQ1RJVkVfTUFQX0NPTkZJRy52ZWhpY2xlU3Bhd25ZYXdPZmZzZXREZWc7CgogICAgdXBkYXRlUmVhZHlEaWFsb2dNYXBMYWJlbEZvckFsbFBsYXllcnMoKTsKICAgIHVwZGF0ZVRlYW1OYW1lV2lkZ2V0c0ZvckFsbFBsYXllcnMoKTsKfQoKLy8gQmVzdC1lZmZvcnQgbWFwIGRldGVjdGlvbiBieSBjb21wYXJpbmcgSFEgcG9zaXRpb25zIHRvIG1hcCBiYXNlIGFuY2hvcnMgKGJpZGlyZWN0aW9uYWwgY2hlY2spLgpmdW5jdGlvbiBkZXRlY3RNYXBLZXlGcm9tSHFzKCk6IE1hcEtleSB8IHVuZGVmaW5lZCB7CiAgICBjb25zdCBocTFQb3MgPSBtb2QuR2V0T2JqZWN0UG9zaXRpb24obW9kLkdldEhRKDEpKTsKICAgIGNvbnN0IGhxMlBvcyA9IG1vZC5HZXRPYmplY3RQb3NpdGlvbihtb2QuR2V0SFEoMikpOwoKICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhNQVBfQ09ORklHUykgYXMgTWFwS2V5W107CiAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7CiAgICAgICAgY29uc3QgY2ZnID0gTUFQX0NPTkZJR1Nba2V5XTsKICAgICAgICBjb25zdCBkMTEgPSBtb2QuRGlzdGFuY2VCZXR3ZWVuKGhxMVBvcywgY2ZnLnRlYW0xQmFzZSk7CiAgICAgICAgY29uc3QgZDIyID0gbW9kLkRpc3RhbmNlQmV0d2VlbihocTJQb3MsIGNmZy50ZWFtMkJhc2UpOwogICAgICAgIGlmIChkMTEgPD0gTUFQX0RFVEVDVF9ESVNUQU5DRV9NRVRFUlMgJiYgZDIyIDw9IE1BUF9ERVRFQ1RfRElTVEFOQ0VfTUVURVJTKSB7CiAgICAgICAgICAgIHJldHVybiBrZXk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkMTIgPSBtb2QuRGlzdGFuY2VCZXR3ZWVuKGhxMVBvcywgY2ZnLnRlYW0yQmFzZSk7CiAgICAgICAgY29uc3QgZDIxID0gbW9kLkRpc3RhbmNlQmV0d2VlbihocTJQb3MsIGNmZy50ZWFtMUJhc2UpOwogICAgICAgIGlmIChkMTIgPD0gTUFQX0RFVEVDVF9ESVNUQU5DRV9NRVRFUlMgJiYgZDIxIDw9IE1BUF9ERVRFQ1RfRElTVEFOQ0VfTUVURVJTKSB7CiAgICAgICAgICAgIHJldHVybiBrZXk7CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7Cn0KCi8vIEZpbmRzIHRoZSBwcmVzZXQgaW5kZXggbWF0Y2hpbmcgbWluIHBsYXllcnMgKyBraWxsIHRhcmdldDsgcmV0dXJucyAwIGlmIG5vIGV4YWN0IG1hdGNoLgpmdW5jdGlvbiBmaW5kTWF0Y2h1cFByZXNldEluZGV4KG1pbkFjdGl2ZVBsYXllcnM6IG51bWJlciwgcm91bmRLaWxsc1RhcmdldDogbnVtYmVyKTogbnVtYmVyIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTUFUQ0hVUF9QUkVTRVRTLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgcHJlc2V0ID0gTUFUQ0hVUF9QUkVTRVRTW2ldOwogICAgICAgIGlmIChwcmVzZXQubWluQWN0aXZlUGxheWVycyA9PT0gbWluQWN0aXZlUGxheWVycyAmJiBwcmVzZXQucm91bmRLaWxsc1RhcmdldCA9PT0gcm91bmRLaWxsc1RhcmdldCkgewogICAgICAgICAgICByZXR1cm4gaTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gMDsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIE1hcCArIE1hdGNodXAgSGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gU3RyaW5nIFZhcmlhYmxlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0gU3RyaW5ncy5qc29uIGtleSBwb2xpY3kgLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8KLy8gLSBVSSBsYWJlbHMgKHN0YXRpYyB0ZXh0KSBzaG91bGQgYmUgc2hhcmVkIChlLmcuLCBMYWJlbF9Ub3RhbEtpbGxzKSByYXRoZXIgdGhhbiBkdXBsaWNhdGVkIHBlciB0ZWFtLgovLyAtIFBlci10ZWFtIGRpZmZlcmVuY2VzIGJlbG9uZyBpbiBsYXlvdXQvd2lkZ2V0IHBsYWNlbWVudCwgbm90IGluIGR1cGxpY2F0ZWQgbGFiZWwgc3RyaW5ncy4KLy8gLSBEeW5hbWljIHZhbHVlcyAobnVtYmVycykgYXJlIHVzdWFsbHkgd3JpdHRlbiBpbnRvIHZhbHVlIHdpZGdldHMgZGlyZWN0bHk7IGF2b2lkIGNyZWF0aW5nIG1hbnkgb25lLW9mZiBzdHJpbmdzLgovLyAtIElmIHlvdSBtdXN0IHVzZSBwbGFjZWhvbGRlcnMsIGtlZXAgZm9ybWF0dGluZyBjb25zaXN0ZW50IGFjcm9zcyB0aGUgZmlsZS4KLy8gLSBSZW1pbmRlcjogVUkgd2lkZ2V0IGBuYW1lOmAgdmFsdWVzIGFyZSBOT1QgU3RyaW5ncy5qc29uIGtleXM7IHRoZXkgYXJlIHJ1bnRpbWUgd2lkZ2V0IElEcy4KLy8KLy8gUG9saWN5IGNvbXBsaWFuY2UgY2hlY2tsaXN0OgovLyAtIE5ldyBVSSB0ZXh0IGFkZGVkPyBQdXQgaXQgaW4gU3RyaW5ncy5qc29uIHVuZGVyIGEgc2hhcmVkIGtleSAobm8gcGVyLXRlYW0gZHVwbGljYXRpb24pLgovLyAtIFVzaW5nIHBsYWNlaG9sZGVycz8gTWF0Y2ggZXhpc3RpbmcgZm9ybWF0dGluZyBwYXR0ZXJucyBmb3IgdGhhdCBzZWN0aW9uLgovLyAtIFJldXNpbmcgYW4gZXhpc3RpbmcgbGFiZWw/IFVzZSB0aGUgZXhpc3Rpbmcgc3RyaW5nIGtleSByYXRoZXIgdGhhbiBhIG5ldyBhbGlhcy4KLy8gLSBBdm9pZCBjcmVhdGluZyBzdHJpbmcga2V5IGNvbnN0YW50cyB1bmxlc3MgcmV1c2VkIGluIG11bHRpcGxlIHBsYWNlcy4KLy8KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBVSSB3aWRnZXQgSUQgY29uc3RhbnRzIChzdHJpbmcgcHJlZml4ZXMgdXNlZCB0byBmaW5kIHdpZGdldHMpLgovLyBBbGwgVUkgd2lkZ2V0IElEcyBhcmUgcGVyLXBsYXllcjsgdGhlIHZpZXdlcidzIHBpZCBpcyBhcHBlbmRlZCBhdCB1c2Ugc2l0ZXMuCmNvbnN0IFVJX1RFQU1TV0lUQ0hfQ09OVEFJTkVSX0JBU0VfSUQgPSAiVUlfVEVBTVNXSVRDSF9DT05UQUlORVJfQkFTRV8iOwpjb25zdCBVSV9URUFNU1dJVENIX0JVVFRPTl9URUFNMV9JRCA9ICJVSV9URUFNU1dJVENIX0JVVFRPTl9URUFNMV8iOwovL2NvbnN0IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX1RFQU0xX0xBQkVMX0lEID0gIlVJX1RFQU1TV0lUQ0hfQlVUVE9OX1RFQU0xX0xBQkVMXyI7CmNvbnN0IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX1RFQU0yX0lEID0gIlVJX1RFQU1TV0lUQ0hfQlVUVE9OX1RFQU0yXyI7Ci8vY29uc3QgVUlfVEVBTVNXSVRDSF9CVVRUT05fVEVBTTJfTEFCRUxfSUQgPSAiVUlfVEVBTVNXSVRDSF9CVVRUT05fVEVBTTJfTEFCRUxfIjsKLy9jb25zdCBVSV9URUFNU1dJVENIX0JVVFRPTl9TUEVDVEFURV9JRCA9ICJVSV9URUFNU1dJVENIX0JVVFRPTl9TUEVDVEFURV8iOwovL2NvbnN0IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX1NQRUNUQVRFX0xBQkVMX0lEID0gIlVJX1RFQU1TV0lUQ0hfQlVUVE9OX1NQRUNUQVRFX0xBQkVMXyI7CmNvbnN0IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX0NBTkNFTF9JRCA9ICJVSV9URUFNU1dJVENIX0JVVFRPTl9DQU5DRUxfIjsKY29uc3QgVUlfVEVBTVNXSVRDSF9CVVRUT05fQ0FOQ0VMX0xBQkVMX0lEID0gIlVJX1RFQU1TV0lUQ0hfQlVUVE9OX0NBTkNFTF9MQUJFTF8iOwpjb25zdCBVSV9URUFNU1dJVENIX0JVVFRPTl9PUFRPVVRfSUQgPSAiVUlfVEVBTVNXSVRDSF9CVVRUT05fT1BUT1VUXyI7Ci8vY29uc3QgVUlfVEVBTVNXSVRDSF9CVVRUT05fT1BUT1VUX0xBQkVMX0lEID0gIlVJX1RFQU1TV0lUQ0hfQlVUVE9OX09QVE9VVF9MQUJFTF8iOwpjb25zdCBVSV9URUFNU1dJVENIX0RFQlVHX1RJTUVMSU1JVF9JRCA9ICJVSV9URUFNU1dJVENIX0RFQlVHX1RJTUVMSU1JVF8iOwoKLy8gUmVhZHkgRGlhbG9nIChSb3N0ZXIgVUkpIC0gV2lkZ2V0IElEIGJhc2VzIChwZXItcGxheWVyIElEcyBhcHBlbmQgdmlld2VyIHBsYXllcklkKS4KY29uc3QgVUlfUkVBRFlfRElBTE9HX0hFQURFUl9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfSEVBREVSXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19IRUFERVIyX0lEID0gIlVJX1JFQURZX0RJQUxPR19IRUFERVIyXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19IRUFERVIzX0lEID0gIlVJX1JFQURZX0RJQUxPR19IRUFERVIzXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19URUFNMV9DT05UQUlORVJfSUQgPSAiVUlfUkVBRFlfRElBTE9HX1RFQU0xX0NPTlRBSU5FUl8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfVEVBTTJfQ09OVEFJTkVSX0lEID0gIlVJX1JFQURZX0RJQUxPR19URUFNMl9DT05UQUlORVJfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX1RFQU0xX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19URUFNMV9MQUJFTF8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfVEVBTTJfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX1RFQU0yX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19UMV9ST1dfTkFNRV9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfVDFfUk9XX05BTUVfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX1QxX1JPV19SRUFEWV9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfVDFfUk9XX1JFQURZXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19UMV9ST1dfQkFTRV9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfVDFfUk9XX0JBU0VfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX1QyX1JPV19OQU1FX0lEID0gIlVJX1JFQURZX0RJQUxPR19UMl9ST1dfTkFNRV8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfVDJfUk9XX1JFQURZX0lEID0gIlVJX1JFQURZX0RJQUxPR19UMl9ST1dfUkVBRFlfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX1QyX1JPV19CQVNFX0lEID0gIlVJX1JFQURZX0RJQUxPR19UMl9ST1dfQkFTRV8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1JFQURZX0lEID0gIlVJX1JFQURZX0RJQUxPR19CVVRUT05fUkVBRFlfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9SRUFEWV9MQUJFTF9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1JFQURZX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19CVVRUT05fU1dBUF9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1NXQVBfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9TV0FQX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19CVVRUT05fU1dBUF9MQUJFTF8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfQkVTVE9GX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19CRVNUT0ZfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfTEFCRUxfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01BVENIVVBfREVDX0lEID0gIlVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0RFQ18iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9ERUNfTEFCRUxfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01BVENIVVBfREVDX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0lOQ19JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9JTkNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01BVENIVVBfSU5DX0xBQkVMX0lEID0gIlVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0lOQ19MQUJFTF8iOwpjb25zdCBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9NSU5QTEFZRVJTX0lEID0gIlVJX1JFQURZX0RJQUxPR19NQVRDSFVQX01JTlBMQVlFUlNfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01BVENIVVBfS0lMTFNUQVJHRVRfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01BVENIVVBfS0lMTFNUQVJHRVRfIjsKY29uc3QgVUlfUkVBRFlfRElBTE9HX01BUF9MQUJFTF9JRCA9ICJVSV9SRUFEWV9ESUFMT0dfTUFQX0xBQkVMXyI7CmNvbnN0IFVJX1JFQURZX0RJQUxPR19NQVBfVkFMVUVfSUQgPSAiVUlfUkVBRFlfRElBTE9HX01BUF9WQUxVRV8iOwoKLy8gQWRtaW4vVGVzdGVyIFVJIC0gV2lkZ2V0IElEIGJhc2VzIChwZXItcGxheWVyIElEcyBhcHBlbmQgdmlld2VyIHBsYXllcklkKS4KY29uc3QgVUlfVEVTVF9IRUFERVJfTEFCRUxfSUQgPSAiVUlfVEVTVF9IRUFERVJfTEFCRUxfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fTEVGVF9XSU5TX0RFQ19JRCA9ICJVSV9URVNUX0JVVFRPTl9MRUZUX1dJTlNfREVDXyI7CmNvbnN0IFVJX1RFU1RfQlVUVE9OX0xFRlRfV0lOU19JTkNfSUQgPSAiVUlfVEVTVF9CVVRUT05fTEVGVF9XSU5TX0lOQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9SSUdIVF9XSU5TX0RFQ19JRCA9ICJVSV9URVNUX0JVVFRPTl9SSUdIVF9XSU5TX0RFQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9SSUdIVF9XSU5TX0lOQ19JRCA9ICJVSV9URVNUX0JVVFRPTl9SSUdIVF9XSU5TX0lOQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9MRUZUX0tJTExTX0RFQ19JRCA9ICJVSV9URVNUX0JVVFRPTl9MRUZUX0tJTExTX0RFQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9MRUZUX0tJTExTX0lOQ19JRCA9ICJVSV9URVNUX0JVVFRPTl9MRUZUX0tJTExTX0lOQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9SSUdIVF9LSUxMU19ERUNfSUQgPSAiVUlfVEVTVF9CVVRUT05fUklHSFRfS0lMTFNfREVDXyI7CmNvbnN0IFVJX1RFU1RfQlVUVE9OX1JJR0hUX0tJTExTX0lOQ19JRCA9ICJVSV9URVNUX0JVVFRPTl9SSUdIVF9LSUxMU19JTkNfIjsKY29uc3QgVUlfQURNSU5fQlVUVE9OX1QxX1JPVU5EX0tJTExTX0RFQ19JRCA9ICJVSV9BRE1JTl9CVVRUT05fVDFfUk9VTkRfS0lMTFNfREVDXyI7CmNvbnN0IFVJX0FETUlOX0JVVFRPTl9UMV9ST1VORF9LSUxMU19JTkNfSUQgPSAiVUlfQURNSU5fQlVUVE9OX1QxX1JPVU5EX0tJTExTX0lOQ18iOwpjb25zdCBVSV9BRE1JTl9CVVRUT05fVDJfUk9VTkRfS0lMTFNfREVDX0lEID0gIlVJX0FETUlOX0JVVFRPTl9UMl9ST1VORF9LSUxMU19ERUNfIjsKY29uc3QgVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0lOQ19JRCA9ICJVSV9BRE1JTl9CVVRUT05fVDJfUk9VTkRfS0lMTFNfSU5DXyI7CmNvbnN0IFVJX1RFU1RfQlVUVE9OX1JPVU5EX0tJTExTX1RBUkdFVF9ERUNfSUQgPSAiVUlfVEVTVF9CVVRUT05fUk9VTkRfS0lMTFNfVEFSR0VUX0RFQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9ST1VORF9LSUxMU19UQVJHRVRfSU5DX0lEID0gIlVJX1RFU1RfQlVUVE9OX1JPVU5EX0tJTExTX1RBUkdFVF9JTkNfIjsKY29uc3QgVUlfVEVTVF9MQUJFTF9ST1VORF9LSUxMU19UQVJHRVRfSUQgPSAiVUlfVEVTVF9MQUJFTF9ST1VORF9LSUxMU19UQVJHRVRfIjsKY29uc3QgVUlfVEVTVF9WQUxVRV9ST1VORF9LSUxMU19UQVJHRVRfSUQgPSAiVUlfVEVTVF9WQUxVRV9ST1VORF9LSUxMU19UQVJHRVRfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fVElFU19ERUNfSUQgPSAiVUlfVEVTVF9CVVRUT05fVElFU19ERUNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fVElFU19JTkNfSUQgPSAiVUlfVEVTVF9CVVRUT05fVElFU19JTkNfIjsKY29uc3QgVUlfVEVTVF9CVVRUT05fQ1VSX1JPVU5EX0RFQ19JRCA9ICJVSV9URVNUX0JVVFRPTl9DVVJfUk9VTkRfREVDXyI7CmNvbnN0IFVJX1RFU1RfQlVUVE9OX0NVUl9ST1VORF9JTkNfSUQgPSAiVUlfVEVTVF9CVVRUT05fQ1VSX1JPVU5EX0lOQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9DTE9DS19USU1FX0RFQ19JRCA9ICJVSV9URVNUX0JVVFRPTl9DTE9DS19USU1FX0RFQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9DTE9DS19USU1FX0lOQ19JRCA9ICJVSV9URVNUX0JVVFRPTl9DTE9DS19USU1FX0lOQ18iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9DTE9DS19SRVNFVF9JRCA9ICJVSV9URVNUX0JVVFRPTl9DTE9DS19SRVNFVF8iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9ST1VORF9TVEFSVF9JRCA9ICJVSV9URVNUX0JVVFRPTl9ST1VORF9TVEFSVF8iOwpjb25zdCBVSV9URVNUX0JVVFRPTl9ST1VORF9FTkRfSUQgPSAiVUlfVEVTVF9CVVRUT05fUk9VTkRfRU5EXyI7CmNvbnN0IFVJX1RFU1RfQlVUVE9OX1BPU19ERUJVR19JRCA9ICJVSV9URVNUX0JVVFRPTl9QT1NfREVCVUdfIjsKY29uc3QgVUlfVEVTVF9MQUJFTF9MRUZUX1dJTlNfSUQgPSAiVUlfVEVTVF9MQUJFTF9MRUZUX1dJTlNfIjsKY29uc3QgVUlfVEVTVF9MQUJFTF9SSUdIVF9XSU5TX0lEID0gIlVJX1RFU1RfTEFCRUxfUklHSFRfV0lOU18iOwpjb25zdCBVSV9URVNUX0xBQkVMX0xFRlRfS0lMTFNfSUQgPSAiVUlfVEVTVF9MQUJFTF9MRUZUX0tJTExTXyI7CmNvbnN0IFVJX1RFU1RfTEFCRUxfUklHSFRfS0lMTFNfSUQgPSAiVUlfVEVTVF9MQUJFTF9SSUdIVF9LSUxMU18iOwpjb25zdCBVSV9BRE1JTl9MQUJFTF9UMV9ST1VORF9LSUxMU19JRCA9ICJVSV9BRE1JTl9MQUJFTF9UMV9ST1VORF9LSUxMU18iOwpjb25zdCBVSV9BRE1JTl9MQUJFTF9UMl9ST1VORF9LSUxMU19JRCA9ICJVSV9BRE1JTl9MQUJFTF9UMl9ST1VORF9LSUxMU18iOwpjb25zdCBVSV9URVNUX0xBQkVMX1RJRVNfSUQgPSAiVUlfVEVTVF9MQUJFTF9USUVTXyI7CmNvbnN0IFVJX1RFU1RfTEFCRUxfQ1VSX1JPVU5EX0lEID0gIlVJX1RFU1RfTEFCRUxfQ1VSX1JPVU5EXyI7CmNvbnN0IFVJX1RFU1RfTEFCRUxfQ0xPQ0tfVElNRV9JRCA9ICJVSV9URVNUX0xBQkVMX0NMT0NLX1RJTUVfIjsKY29uc3QgVUlfVEVTVF9QTFVTX1RFWFRfSUQgPSAiVUlfVEVTVF9QTFVTX1RFWFRfIjsKY29uc3QgVUlfVEVTVF9NSU5VU19URVhUX0lEID0gIlVJX1RFU1RfTUlOVVNfVEVYVF8iOwpjb25zdCBVSV9URVNUX1JFU0VUX1RFWFRfSUQgPSAiVUlfVEVTVF9SRVNFVF9URVhUXyI7CmNvbnN0IFVJX1RFU1RfUk9VTkRfU1RBUlRfVEVYVF9JRCA9ICJVSV9URVNUX1JPVU5EX1NUQVJUX1RFWFRfIjsKY29uc3QgVUlfVEVTVF9ST1VORF9FTkRfVEVYVF9JRCA9ICJVSV9URVNUX1JPVU5EX0VORF9URVhUXyI7CmNvbnN0IFVJX1RFU1RfUE9TX0RFQlVHX1RFWFRfSUQgPSAiVUlfVEVTVF9QT1NfREVCVUdfVEVYVF8iOwoKLy8gRGVidWcgUG9zaXRpb25pbmcgVUkKY29uc3QgVUlfUE9TX0RFQlVHX0NPTlRBSU5FUl9JRCA9ICJVSV9QT1NfREVCVUdfQ09OVEFJTkVSXyI7CmNvbnN0IFVJX1BPU19ERUJVR19YX0lEID0gIlVJX1BPU19ERUJVR19YXyI7CmNvbnN0IFVJX1BPU19ERUJVR19ZX0lEID0gIlVJX1BPU19ERUJVR19ZXyI7CmNvbnN0IFVJX1BPU19ERUJVR19aX0lEID0gIlVJX1BPU19ERUJVR19aXyI7CmNvbnN0IFVJX1BPU19ERUJVR19ST1RZX0lEID0gIlVJX1BPU19ERUJVR19ST1RZXyI7CgovLyBBZG1pbiBQYW5lbCAoZGVjb3VwbGVkIGZyb20gbWFpbiBUZWFtIFN3aXRjaCBkaWFsb2cpCmNvbnN0IFVJX0FETUlOX1BBTkVMX0JVVFRPTl9JRCA9ICJVSV9BRE1JTl9QQU5FTF9CVVRUT05fIjsKY29uc3QgVUlfQURNSU5fUEFORUxfQlVUVE9OX0xBQkVMX0lEID0gIlVJX0FETUlOX1BBTkVMX0JVVFRPTl9MQUJFTF8iOwpjb25zdCBVSV9BRE1JTl9QQU5FTF9DT05UQUlORVJfSUQgPSAiVUlfQURNSU5fUEFORUxfQ09OVEFJTkVSXyI7CgovLyAiT3ZlciB0aGUgbGluZSIgbWVzc2FnaW5nIHN0cmluZ3MKY29uc3QgT1ZFUl9MSU5FX1RJVExFX0lEID0gIk92ZXJMaW5lX1RpdGxlXyI7IApjb25zdCBPVkVSX0xJTkVfU1VCVElUTEVfSUQgPSAiT3ZlckxpbmVfU3VidGl0bGVfIjsgCgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0gU3RyaW5nIFZhcmlhYmxlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ29yZSBnYW1lcGxheSBzdGF0ZSBoZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBDb3JlIGdhbWVwbGF5IGhlbHBlciB1dGlsaXRpZXMgKHN0YXRlIHN5bmMgKyBtZXNzYWdpbmcgZ2F0ZXMpLgoKZnVuY3Rpb24gZ2V0TWF0Y2hXaW5zVGVhbSh0ZWFtTnVtOiBUZWFtSUQpOiBudW1iZXIgewogICAgLy8gRGVidWctb25seTogZW5naW5lIEdhbWVNb2RlU2NvcmUgY2FuIGJlIHRyYW5zaWVudCBkdXJpbmcgcmVjb25uZWN0cyAvIHRlYW0gc3dhcHMuCiAgICByZXR1cm4gTWF0aC5mbG9vcihtb2QuR2V0R2FtZU1vZGVTY29yZShtb2QuR2V0VGVhbSh0ZWFtTnVtKSkpOwp9CgpmdW5jdGlvbiBzZXRNYXRjaFdpbnNUZWFtKHRlYW1OdW06IFRlYW1JRCwgd2luczogbnVtYmVyKTogdm9pZCB7CiAgICBtb2QuU2V0R2FtZU1vZGVTY29yZShtb2QuR2V0VGVhbSh0ZWFtTnVtKSwgTWF0aC5tYXgoMCwgTWF0aC5mbG9vcih3aW5zKSkpOwp9CgovLyBDZW50cmFsIG1lc3NhZ2UtZ2F0aW5nIHBvbGljeTogZ2FtZXBsYXkgdnMgZGVidWcsIGFuZCBoaWdobGlnaHRlZCB2cyBub3RpZmljYXRpb24uCmZ1bmN0aW9uIHNob3VsZFNlbmRNZXNzYWdlKGlzR2FtZXBsYXk6IGJvb2xlYW4sIGlzSGlnaGxpZ2h0ZWQ6IGJvb2xlYW4pOiBib29sZWFuIHsKICAgIGlmIChpc0dhbWVwbGF5KSByZXR1cm4gRU5BQkxFX0dBTUVQTEFZX01FU1NBR0VTOwogICAgcmV0dXJuIGlzSGlnaGxpZ2h0ZWQgPyBFTkFCTEVfREVCVUdfSElHSExJR0hURURfTUVTU0FHRVMgOiBFTkFCTEVfREVCVUdfTk9USUZJQ0FUSU9OX01FU1NBR0VTOwp9CgovLyBSb3VuZCBwaGFzZSBoZWxwZXIgZm9yIHJlYWRhYmlsaXR5IChhdm9pZHMgc2NhdHRlcmVkIGVudW0gY29tcGFyaXNvbnMpLgpmdW5jdGlvbiBpc1JvdW5kTGl2ZSgpOiBib29sZWFuIHsKICAgIHJldHVybiBTdGF0ZS5yb3VuZC5waGFzZSA9PT0gUm91bmRQaGFzZS5MaXZlOwp9CgovLyBOb3RpZmljYXRpb24gY2hhbm5lbCB3cmFwcGVyOyByZXNwZWN0cyBnYW1lcGxheS9kZWJ1ZyBnYXRlcyBhbmQgb3B0aW9uYWwgdGFyZ2V0LgpmdW5jdGlvbiBzZW5kTm90aWZpY2F0aW9uTWVzc2FnZShtZXNzYWdlOiBtb2QuTWVzc2FnZSwgaXNHYW1lcGxheTogYm9vbGVhbiwgdGFyZ2V0PzogbW9kLlBsYXllciB8IG1vZC5UZWFtKTogdm9pZCB7CiAgICBpZiAoIXNob3VsZFNlbmRNZXNzYWdlKGlzR2FtZXBsYXksIGZhbHNlKSkgcmV0dXJuOwogICAgaWYgKHRhcmdldCkgewogICAgICAgIG1vZC5EaXNwbGF5Tm90aWZpY2F0aW9uTWVzc2FnZShtZXNzYWdlLCB0YXJnZXQgYXMgbW9kLlBsYXllcik7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgbW9kLkRpc3BsYXlOb3RpZmljYXRpb25NZXNzYWdlKG1lc3NhZ2UpOwp9CgovLyBXb3JsZC1sb2cgd3JhcHBlcjsgcmVzcGVjdHMgZ2FtZXBsYXkvZGVidWcgZ2F0ZXMgYW5kIG9wdGlvbmFsIHRhcmdldC4KZnVuY3Rpb24gc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKG1lc3NhZ2U6IG1vZC5NZXNzYWdlLCBpc0dhbWVwbGF5OiBib29sZWFuLCB0YXJnZXQ/OiBtb2QuUGxheWVyIHwgbW9kLlRlYW0pOiB2b2lkIHsKICAgIGlmICghc2hvdWxkU2VuZE1lc3NhZ2UoaXNHYW1lcGxheSwgdHJ1ZSkpIHJldHVybjsKICAgIGlmICh0YXJnZXQpIHsKICAgICAgICBtb2QuRGlzcGxheUhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKG1lc3NhZ2UsIHRhcmdldCBhcyBtb2QuUGxheWVyKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBtb2QuRGlzcGxheUhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKG1lc3NhZ2UpOwp9CgovLyBTeW5jaHJvbml6ZXMgSFVEIHdpbiBjb3VudGVycyBmcm9tIGF1dGhvcml0YXRpdmUgbWF0Y2ggc3RhdGUuCi8vIFRoaXMgc2hvdWxkIGJlIGNhbGxlZCBhZnRlciBhbnkgYWRtaW4gb3IgZ2FtZXBsYXkgbXV0YXRpb24gb2YgU3RhdGUubWF0Y2gud2luc1QxL1QyLgpmdW5jdGlvbiBzeW5jV2luQ291bnRlcnNIdWRGcm9tR2FtZU1vZGVTY29yZSgpOiB2b2lkIHsKICAgIC8vIERlYnVnLW9ubHk6IGRvIG5vdCB1c2UgZm9yIGF1dGhvcml0YXRpdmUgc3RhdGU7IHB1bGxpbmcgZnJvbSBlbmdpbmUgaGVyZSBjYW4gbGF0Y2ggdHJhbnNpZW50IHZhbHVlcy4KICAgIGNvbnN0IHQxV2lucyA9IGdldE1hdGNoV2luc1RlYW0oVGVhbUlELlRlYW0xKTsKICAgIGNvbnN0IHQyV2lucyA9IGdldE1hdGNoV2luc1RlYW0oVGVhbUlELlRlYW0yKTsKCiAgICBTdGF0ZS5tYXRjaC53aW5zVDEgPSB0MVdpbnM7CiAgICBTdGF0ZS5tYXRjaC53aW5zVDIgPSB0MldpbnM7CiAgICBzeW5jUm91bmRSZWNvcmRIdWRGb3JBbGxQbGF5ZXJzKCk7CgogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCByZWZzID0gZW5zdXJlSHVkRm9yUGxheWVyKHApOwogICAgICAgIGlmICghcmVmcykgY29udGludWU7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5sZWZ0V2luc1RleHQsIHQxV2lucyk7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5yaWdodFdpbnNUZXh0LCB0MldpbnMpOwogICAgfQp9CgpmdW5jdGlvbiBlbmRHYW1lTW9kZUZvclRlYW1OdW0odGVhbU51bTogVGVhbUlEIHwgMCk6IHZvaWQgewogICAgY29uc3Qgd2lubmluZ1RlYW0gPSBtb2QuR2V0VGVhbSh0ZWFtTnVtKTsKCiAgICAvLyBFbmQgdGhlIG1hdGNoIGJ5IHRlYW0gY29uc2lzdGVudGx5OyBlbmRpbmcgImJ5IHBsYXllciIgY2FuIHlpZWxkIGluY29uc2lzdGVudCBlbmdpbmUgZmluYWxpemF0aW9uCiAgICAvLyB3aGVuIHBsYXllcnMgcmVjb25uZWN0IG9yIGJyaWVmbHkgam9pbiBkaWZmZXJlbnQgdGVhbXMuCiAgICBtb2QuRW5kR2FtZU1vZGUod2lubmluZ1RlYW0pOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gQ29yZSBnYW1lcGxheSBzdGF0ZSBoZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBTaGFyZWQgSUQgaGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gZ2V0T2JqSWQob2JqOiBhbnkpOiBudW1iZXIgewogICAgcmV0dXJuIG1vZC5HZXRPYmpJZChvYmopOwp9CgpmdW5jdGlvbiBnZXRUZWFtTnVtYmVyKHRlYW06IG1vZC5UZWFtKTogVGVhbUlEIHwgMCB7CiAgICBpZiAobW9kLkVxdWFscyh0ZWFtLCBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTEpKSkgcmV0dXJuIFRlYW1JRC5UZWFtMTsKICAgIGlmIChtb2QuRXF1YWxzKHRlYW0sIG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMikpKSByZXR1cm4gVGVhbUlELlRlYW0yOwogICAgcmV0dXJuIDA7Cn0KCmZ1bmN0aW9uIGlzUGxheWVyRGVwbG95ZWQocGxheWVyOiBtb2QuUGxheWVyKTogYm9vbGVhbiB7CiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuICEhU3RhdGUucGxheWVycy5kZXBsb3llZEJ5UGlkW2dldE9iaklkKHBsYXllcildOwp9CgpmdW5jdGlvbiBnZXRUZWFtTmFtZUtleSh0ZWFtTnVtOiBUZWFtSUQgfCAwKTogbnVtYmVyIHsKICAgIGlmICh0ZWFtTnVtID09PSBUZWFtSUQuVGVhbTEpIHJldHVybiBBQ1RJVkVfTUFQX0NPTkZJRz8udGVhbTFOYW1lID8/IG1vZC5zdHJpbmdrZXlzLnR3bC50ZWFtcy5XRVNUOwogICAgaWYgKHRlYW1OdW0gPT09IFRlYW1JRC5UZWFtMikgcmV0dXJuIEFDVElWRV9NQVBfQ09ORklHPy50ZWFtMk5hbWUgPz8gbW9kLnN0cmluZ2tleXMudHdsLnRlYW1zLkVBU1Q7CiAgICByZXR1cm4gbW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS51bmtub3duUGxheWVyOwp9CgpmdW5jdGlvbiBvcHBvc2luZ1RlYW0odGVhbU51bTogVGVhbUlEIHwgMCk6IFRlYW1JRCB8IDAgewogICAgaWYgKHRlYW1OdW0gPT09IFRlYW1JRC5UZWFtMSkgcmV0dXJuIFRlYW1JRC5UZWFtMjsKICAgIGlmICh0ZWFtTnVtID09PSBUZWFtSUQuVGVhbTIpIHJldHVybiBUZWFtSUQuVGVhbTE7CiAgICByZXR1cm4gMDsKfQoKZnVuY3Rpb24gc2FmZUZpbmQobmFtZTogc3RyaW5nKTogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkIHsKICAgIHRyeSB7CiAgICAgICAgcmV0dXJuIG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShuYW1lLCBtb2QuR2V0VUlSb290KCkpIGFzIG1vZC5VSVdpZGdldDsKICAgIH0gY2F0Y2ggewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUobmFtZSkgYXMgbW9kLlVJV2lkZ2V0OwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgIH0KICAgIH0KfQoKLy8gU2FmZWx5IHJlc29sdmUgYSBQbGF5ZXIgYnkgcGlkIChtb2QuR2V0T2JqSWQocGxheWVyKSkuIFJldHVybnMgdW5kZWZpbmVkIGlmIG5vdCBmb3VuZC4KZnVuY3Rpb24gc2FmZUZpbmRQbGF5ZXIocGlkOiBudW1iZXIpOiBtb2QuUGxheWVyIHwgdW5kZWZpbmVkIHsKICAgIHRyeSB7CiAgICAgICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICAgICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgaWYgKG1vZC5HZXRPYmpJZChwKSA9PT0gcGlkKSByZXR1cm4gcDsKICAgIH0KICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9IGNhdGNoIHsKICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gU2hhcmVkIElEIGhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBUeXBlcyArIENhY2hlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gV2UgYnVpbGQgSFVEIHBlci1wbGF5ZXIgKHBsYXllcklkIHJlY2VpdmVyKSBhbmQgc3VmZml4IG5hbWVzIHdpdGggcGlkIHRvIGF2b2lkIGNvbGxpc2lvbnMuCnR5cGUgSHVkUmVmcyA9IHsKICAgIHBpZDogbnVtYmVyOwoKICAgIC8vIENvdW50ZXIgdGV4dCB3aWRnZXRzICh3ZSBvbmx5IG5lZWQgdG8gdXBkYXRlIHRoZXNlKQogICAgcm91bmRDdXJUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgcm91bmRNYXhUZXh0PzogbW9kLlVJV2lkZ2V0OwoKICAgIGxlZnRXaW5zVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHJpZ2h0V2luc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CgogICAgbGVmdFJlY29yZFRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICByaWdodFJlY29yZFRleHQ/OiBtb2QuVUlXaWRnZXQ7CgogICAgbGVmdFJvdW5kS2lsbHNUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgcmlnaHRSb3VuZEtpbGxzVGV4dD86IG1vZC5VSVdpZGdldDsKCiAgICBsZWZ0S2lsbHNUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgcmlnaHRLaWxsc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CgogICAgLy8gVmljdG9yeSByZXN1bHRzIGRpYWxvZyB3aWRnZXRzIChzaG93biBkdXJpbmcgbWF0Y2ggZW5kIGNvdW50ZG93bikKICAgIHZpY3RvcnlSb290PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVJlc3RhcnRUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVRpbWVIb3Vyc1RlbnM/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5VGltZUhvdXJzT25lcz86IG1vZC5VSVdpZGdldDsKICAgIHZpY3RvcnlUaW1lTWludXRlc1RlbnM/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5VGltZU1pbnV0ZXNPbmVzPzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVRpbWVTZWNvbmRzVGVucz86IG1vZC5VSVdpZGdldDsKICAgIHZpY3RvcnlUaW1lU2Vjb25kc09uZXM/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5Um91bmRzU3VtbWFyeVRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5QWRtaW5BY3Rpb25zVGV4dD86IG1vZC5VSVdpZGdldDsKCiAgICB2aWN0b3J5TGVmdE91dGNvbWVUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeUxlZnRSZWNvcmRUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeUxlZnRSb3VuZFdpbnNUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeUxlZnRSb3VuZExvc3Nlc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5TGVmdFJvdW5kVGllc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5TGVmdFRvdGFsS2lsbHNUZXh0PzogbW9kLlVJV2lkZ2V0OwoKICAgIHZpY3RvcnlSaWdodE91dGNvbWVUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVJpZ2h0UmVjb3JkVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHZpY3RvcnlSaWdodFJvdW5kV2luc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5UmlnaHRSb3VuZExvc3Nlc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICB2aWN0b3J5UmlnaHRSb3VuZFRpZXNUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgdmljdG9yeVJpZ2h0VG90YWxLaWxsc1RleHQ/OiBtb2QuVUlXaWRnZXQ7CgogICAgLy8gUm91bmQtZW5kIGRpYWxvZyB3aWRnZXRzIChzaG93biBkdXJpbmcgdGhlIHJvdW5kLWVuZCByZWRlcGxveSB3aW5kb3cpCiAgICByb3VuZEVuZFJvb3Q/OiBtb2QuVUlXaWRnZXQ7CiAgICByb3VuZEVuZFJvdW5kVGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHJvdW5kRW5kT3V0Y29tZVRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICByb3VuZEVuZExlZnRTdW1tYXJ5VGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHJvdW5kRW5kQ29sb25UZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgcm91bmRFbmRSaWdodFN1bW1hcnlUZXh0PzogbW9kLlVJV2lkZ2V0OwoKICAgIGFkbWluUGFuZWxBY3Rpb25Db3VudFRleHQ/OiBtb2QuVUlXaWRnZXQ7CgogICAgaGVscFRleHRDb250YWluZXI/OiBtb2QuVUlXaWRnZXQ7CgogICAgLy8gT3B0aW9uYWwgcm9vdHMgKGZvciBjbGVhbnVwIGlmIG5lZWRlZCkKICAgIHJvb3RzOiBtb2QuVUlXaWRnZXRbXTsKfTsKCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBIVUQgVHlwZXMgKyBDYWNoZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEdhbWUgU3RhdGUgRGVmaW5pdGlvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKdHlwZSBWZWhpY2xlU3Bhd25lclNsb3QgPSB7CiAgICB0ZWFtSWQ6IFRlYW1JRDsKICAgIHNsb3ROdW1iZXI6IG51bWJlcjsKICAgIHNwYXduZXI6IG1vZC5WZWhpY2xlU3Bhd25lcjsKICAgIHNwYXduZXJPYmpJZDogbnVtYmVyOwogICAgc3Bhd25Qb3M6IG1vZC5WZWN0b3I7CiAgICBzcGF3blJvdDogbW9kLlZlY3RvcjsKICAgIHZlaGljbGVUeXBlOiBtb2QuVmVoaWNsZUxpc3Q7CiAgICBlbmFibGVkOiBib29sZWFuOwogICAgZW5hYmxlVG9rZW46IG51bWJlcjsKICAgIHNwYXduUmVxdWVzdFRva2VuOiBudW1iZXI7CiAgICBzcGF3blJlcXVlc3RBdFNlY29uZHM6IG51bWJlcjsKICAgIGV4cGVjdGluZ1NwYXduOiBib29sZWFuOwogICAgdmVoaWNsZUlkOiBudW1iZXI7CiAgICByZXNwYXduUnVubmluZzogYm9vbGVhbjsKICAgIHNwYXduUmV0cnlTY2hlZHVsZWQ6IGJvb2xlYW47Cn07CgovLyBHYW1lU3RhdGUgY2VudHJhbGl6ZXMgYWxsIG11dGFibGUgbWF0Y2gvcm91bmQvVUkgc3RhdGUgc28gd3JpdGVzIGFyZSBleHBsaWNpdCBhbmQgc2VhcmNoYWJsZS4KaW50ZXJmYWNlIEdhbWVTdGF0ZSB7CiAgICByb3VuZDogewogICAgICAgIGN1cnJlbnQ6IG51bWJlcjsKICAgICAgICBtYXg6IG51bWJlcjsKICAgICAgICBraWxsc1RhcmdldDogbnVtYmVyOwogICAgICAgIGF1dG9TdGFydE1pbkFjdGl2ZVBsYXllcnM6IG51bWJlcjsKICAgICAgICBtYXRjaHVwUHJlc2V0SW5kZXg6IG51bWJlcjsKICAgICAgICBsYXN0TWF0Y2h1cENoYW5nZUF0U2Vjb25kczogbnVtYmVyOwogICAgICAgIHBoYXNlOiBSb3VuZFBoYXNlOwogICAgICAgIGNsb2NrOiB7CiAgICAgICAgICAgIGR1cmF0aW9uU2Vjb25kczogbnVtYmVyOwogICAgICAgICAgICBtYXRjaFN0YXJ0RWxhcHNlZFNlY29uZHM/OiBudW1iZXI7CiAgICAgICAgICAgIHBhdXNlZFJlbWFpbmluZ1NlY29uZHM/OiBudW1iZXI7CiAgICAgICAgICAgIGlzUGF1c2VkOiBib29sZWFuOwogICAgICAgICAgICBsYXN0RGlzcGxheWVkU2Vjb25kcz86IG51bWJlcjsKICAgICAgICAgICAgbGFzdExvd1RpbWVTdGF0ZT86IGJvb2xlYW47CiAgICAgICAgICAgIGV4cGlyeUZpcmVkOiBib29sZWFuOwogICAgICAgICAgICBleHBpcnlIYW5kbGVyczogQXJyYXk8KCkgPT4gdm9pZD47CiAgICAgICAgfTsKICAgICAgICBmbG93OiB7CiAgICAgICAgICAgIHJvdW5kRW5kUmVkZXBsb3lUb2tlbjogbnVtYmVyOwogICAgICAgICAgICBjbG9ja0V4cGlyeUJvdW5kOiBib29sZWFuOwogICAgICAgIH07CiAgICAgICAgY291bnRkb3duOiB7CiAgICAgICAgICAgIGlzQWN0aXZlOiBib29sZWFuOwogICAgICAgICAgICBpc1JlcXVlc3RlZDogYm9vbGVhbjsKICAgICAgICAgICAgdG9rZW46IG51bWJlcjsKICAgICAgICAgICAgb3ZlckxpbmVNZXNzYWdlVG9rZW46IG51bWJlcjsKICAgICAgICB9OwogICAgfTsKICAgIHNjb3JlczogewogICAgICAgIHQxUm91bmRLaWxsczogbnVtYmVyOwogICAgICAgIHQyUm91bmRLaWxsczogbnVtYmVyOwogICAgICAgIHQxVG90YWxLaWxsczogbnVtYmVyOwogICAgICAgIHQyVG90YWxLaWxsczogbnVtYmVyOwogICAgfTsKICAgIG1hdGNoOiB7CiAgICAgICAgd2luc1QxOiBudW1iZXI7CiAgICAgICAgd2luc1QyOiBudW1iZXI7CiAgICAgICAgbG9zc2VzVDE6IG51bWJlcjsKICAgICAgICBsb3NzZXNUMjogbnVtYmVyOwogICAgICAgIHRpZXNUMTogbnVtYmVyOwogICAgICAgIHRpZXNUMjogbnVtYmVyOwogICAgICAgIGlzRW5kZWQ6IGJvb2xlYW47CiAgICAgICAgdmljdG9yeURpYWxvZ0FjdGl2ZTogYm9vbGVhbjsKICAgICAgICB3aW5uZXJUZWFtPzogVGVhbUlEIHwgMDsKICAgICAgICBlbmRFbGFwc2VkU2Vjb25kc1NuYXBzaG90OiBudW1iZXI7CiAgICAgICAgdmljdG9yeVN0YXJ0RWxhcHNlZFNlY29uZHNTbmFwc2hvdDogbnVtYmVyOwogICAgICAgIGZsb3c6IHsKICAgICAgICAgICAgbWF0Y2hFbmREZWxheVRva2VuOiBudW1iZXI7CiAgICAgICAgfTsKICAgIH07CiAgICBhZG1pbjogewogICAgICAgIGFjdGlvbkNvdW50OiBudW1iZXI7CiAgICAgICAgZGVidWdMb29wQWN0aXZlOiBib29sZWFuOwogICAgfTsKICAgIHBsYXllcnM6IHsKICAgICAgICB0ZWFtU3dpdGNoRGF0YTogUmVjb3JkPG51bWJlciwgdGVhbVN3aXRjaERhdGFfdD47CiAgICAgICAgcmVhZHlCeVBpZDogUmVjb3JkPG51bWJlciwgYm9vbGVhbj47CiAgICAgICAgaW5NYWluQmFzZUJ5UGlkOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPjsKICAgICAgICBkZXBsb3llZEJ5UGlkOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPjsKICAgIH07CiAgICB2ZWhpY2xlczogewogICAgICAgIHNsb3RzOiBWZWhpY2xlU3Bhd25lclNsb3RbXTsKICAgICAgICB2ZWhpY2xlVG9TbG90OiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+OwogICAgICAgIHNwYXduU2VxdWVuY2VUb2tlbjogbnVtYmVyOwogICAgICAgIHNwYXduU2VxdWVuY2VJblByb2dyZXNzOiBib29sZWFuOwogICAgICAgIGFjdGl2ZVNwYXduU2xvdEluZGV4PzogbnVtYmVyOwogICAgICAgIGFjdGl2ZVNwYXduVG9rZW4/OiBudW1iZXI7CiAgICAgICAgYWN0aXZlU3Bhd25SZXF1ZXN0ZWRBdFNlY29uZHM/OiBudW1iZXI7CiAgICAgICAgY29uZmlnUmVhZHk6IGJvb2xlYW47CiAgICAgICAgc3RhcnR1cENsZWFudXBEb25lOiBib29sZWFuOwogICAgfTsKICAgIGh1ZENhY2hlOiB7CiAgICAgICAgbGFzdEh1ZFNjb3JlVDE/OiBudW1iZXI7CiAgICAgICAgbGFzdEh1ZFNjb3JlVDI/OiBudW1iZXI7CiAgICAgICAgbGFzdEh1ZFJvdW5kS2lsbHNUMT86IG51bWJlcjsKICAgICAgICBsYXN0SHVkUm91bmRLaWxsc1QyPzogbnVtYmVyOwogICAgICAgIGh1ZEJ5UGlkOiBSZWNvcmQ8bnVtYmVyLCBIdWRSZWZzPjsKICAgICAgICBjbG9ja1dpZGdldENhY2hlOiBSZWNvcmQ8bnVtYmVyLCBDbG9ja1dpZGdldENhY2hlRW50cnk+OwogICAgICAgIGNvdW50ZG93bldpZGdldENhY2hlOiBSZWNvcmQ8bnVtYmVyLCBDb3VudGRvd25XaWRnZXRDYWNoZUVudHJ5PjsKICAgICAgICBvdmVyTGluZVRpdGxlV2lkZ2V0Q2FjaGU6IFJlY29yZDxudW1iZXIsIENvdW50ZG93bldpZGdldENhY2hlRW50cnk+OwogICAgICAgIG92ZXJMaW5lU3VidGl0bGVXaWRnZXRDYWNoZTogUmVjb3JkPG51bWJlciwgQ291bnRkb3duV2lkZ2V0Q2FjaGVFbnRyeT47CiAgICB9Owp9CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBBdXRob3JpdGF0aXZlIFN0YXRlIE1hcCAtLS0tLS0tLS0tLS0tLS0tLS0tLQovLwovLyBSb3VuZCBzdGF0ZSAocmVzZXRzIGF0IHJvdW5kIHN0YXJ0KToKLy8gLSBTdGF0ZS5yb3VuZC5jdXJyZW50OiBjdXJyZW50IHJvdW5kIGluZGV4ICgxLWJhc2VkIGRpc3BsYXkpLgovLyAtIFN0YXRlLnJvdW5kLm1heDogbnVtYmVyIG9mIHJvdW5kcyBpbiB0aGUgbWF0Y2guCi8vIC0gU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscyAvIFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHM6IHBvaW50cyBlYXJuZWQgdGhpcyByb3VuZCBieSBlYWNoIHRlYW0uCi8vIC0gU3RhdGUucm91bmQua2lsbHNUYXJnZXQ6IHBvaW50cyBuZWVkZWQgdG8gd2luIHRoZSByb3VuZC4KLy8gLSBTdGF0ZS5yb3VuZC5waGFzZTogUm91bmRQaGFzZS5Ob3RSZWFkeSB8IFJvdW5kUGhhc2UuTGl2ZSB8IFJvdW5kUGhhc2UuR2FtZU92ZXIuCi8vIC0gU3RhdGUucm91bmQuY2xvY2suZHVyYXRpb25TZWNvbmRzOiBhdXRob3JpdGF0aXZlIHJlbWFpbmluZyBzZWNvbmRzIGluIHRoZSByb3VuZC4KLy8KLy8gTWF0Y2ggc3RhdGUgKHJlc2V0cyBhdCBtYXRjaCBzdGFydCk6Ci8vIC0gU3RhdGUubWF0Y2gud2luc1QxL1QyLCBTdGF0ZS5tYXRjaC5sb3NzZXNUMS9UMiwgU3RhdGUubWF0Y2gudGllc1QxL1QyOiBtYXRjaCByZWNvcmQgYWNyb3NzIHJvdW5kcy4KLy8gLSBTdGF0ZS5tYXRjaC5pc0VuZGVkOiBpbmRpY2F0ZXMgbWF0Y2ggaXMgb3ZlciBhbmQgdmljdG9yeSBkaWFsb2cgc2hvdWxkIGJlIHNob3duLgovLwovLyBWZWhpY2xlIHJlZ2lzdHJhdGlvbiAocGVyc2lzdHMgYWNyb3NzIHJvdW5kIHRyYW5zaXRpb25zIHVubGVzcyBleHBsaWNpdGx5IGNsZWFyZWQpOgovLyAtIHJlZ1ZlaGljbGVzVGVhbTEgKEdsb2JhbFZhcmlhYmxlIDApOiBhcnJheSBvZiB2ZWhpY2xlcyByZWdpc3RlcmVkIHRvIFRlYW0gMS4KLy8gLSByZWdWZWhpY2xlc1RlYW0yIChHbG9iYWxWYXJpYWJsZSAxKTogYXJyYXkgb2YgdmVoaWNsZXMgcmVnaXN0ZXJlZCB0byBUZWFtIDIuCi8vIC0gdmVoSWRzL3ZlaE93bmVyczogYmVzdC1lZmZvcnQgJ2xhc3QgZHJpdmVyJyBtYXBwaW5nIHVzZWQgZm9yIG1lc3NhZ2VzIG9ubHkuCi8vCi8vIFVJIGNhY2hlcyAocGVyLXBsYXllciwgcmVidWlsdCBhcyBuZWVkZWQpOgovLyAtIFN0YXRlLmh1ZENhY2hlLmh1ZEJ5UGlkW3BpZF06IGNhY2hlZCBIVUQgd2lkZ2V0IHJlZmVyZW5jZXMuCi8vIC0gZGlhbG9nL3dpZGdldCBjYWNoZXM6IGNhY2hlZCByZWZlcmVuY2VzIHRvIG1vZGFsIFVJIGVsZW1lbnRzICh0ZWFtIHN3aXRjaCwgdmljdG9yeSwgY2xvY2sgZGlnaXRzKS4KLy8KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBDZW50cmFsaXplZCBtdXRhYmxlIHN0YXRlIGZvciBtYXRjaC9yb3VuZCBmbG93IGFuZCBVSSBjYWNoZXMuCmNvbnN0IFN0YXRlOiBHYW1lU3RhdGUgPSB7CiAgICByb3VuZDogewogICAgICAgIGN1cnJlbnQ6IDEsCiAgICAgICAgbWF4OiBNQVhfUk9VTkRTLAogICAgICAgIGtpbGxzVGFyZ2V0OiBST1VORF9LSUxMU19UQVJHRVQsCiAgICAgICAgYXV0b1N0YXJ0TWluQWN0aXZlUGxheWVyczogREVGQVVMVF9BVVRPX1NUQVJUX01JTl9BQ1RJVkVfUExBWUVSUywKICAgICAgICBtYXRjaHVwUHJlc2V0SW5kZXg6IERFRkFVTFRfTUFUQ0hVUF9QUkVTRVRfSU5ERVgsCiAgICAgICAgbGFzdE1hdGNodXBDaGFuZ2VBdFNlY29uZHM6IC05OTksCiAgICAgICAgcGhhc2U6IFJvdW5kUGhhc2UuTm90UmVhZHksCiAgICAgICAgY2xvY2s6IHsKICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzOiBST1VORF9DTE9DS19ERUZBVUxUX1NFQ09ORFMsCiAgICAgICAgICAgIG1hdGNoU3RhcnRFbGFwc2VkU2Vjb25kczogdW5kZWZpbmVkLAogICAgICAgICAgICBwYXVzZWRSZW1haW5pbmdTZWNvbmRzOiB1bmRlZmluZWQsCiAgICAgICAgICAgIGlzUGF1c2VkOiBmYWxzZSwKICAgICAgICAgICAgbGFzdERpc3BsYXllZFNlY29uZHM6IHVuZGVmaW5lZCwKICAgICAgICAgICAgbGFzdExvd1RpbWVTdGF0ZTogdW5kZWZpbmVkLAogICAgICAgICAgICBleHBpcnlGaXJlZDogZmFsc2UsCiAgICAgICAgICAgIGV4cGlyeUhhbmRsZXJzOiBbXSwKICAgICAgICB9LAogICAgICAgIGZsb3c6IHsKICAgICAgICAgICAgcm91bmRFbmRSZWRlcGxveVRva2VuOiAwLAogICAgICAgICAgICBjbG9ja0V4cGlyeUJvdW5kOiBmYWxzZSwKICAgICAgICB9LAogICAgICAgIGNvdW50ZG93bjogewogICAgICAgICAgICBpc0FjdGl2ZTogZmFsc2UsCiAgICAgICAgICAgIGlzUmVxdWVzdGVkOiBmYWxzZSwKICAgICAgICAgICAgdG9rZW46IDAsCiAgICAgICAgICAgIG92ZXJMaW5lTWVzc2FnZVRva2VuOiAwLAogICAgICAgIH0sCiAgICB9LAogICAgc2NvcmVzOiB7CiAgICAgICAgdDFSb3VuZEtpbGxzOiAwLAogICAgICAgIHQyUm91bmRLaWxsczogMCwKICAgICAgICB0MVRvdGFsS2lsbHM6IDAsCiAgICAgICAgdDJUb3RhbEtpbGxzOiAwLAogICAgfSwKICAgIG1hdGNoOiB7CiAgICAgICAgd2luc1QxOiAwLAogICAgICAgIHdpbnNUMjogMCwKICAgICAgICBsb3NzZXNUMTogMCwKICAgICAgICBsb3NzZXNUMjogMCwKICAgICAgICB0aWVzVDE6IDAsCiAgICAgICAgdGllc1QyOiAwLAogICAgICAgIGlzRW5kZWQ6IGZhbHNlLAogICAgICAgIHZpY3RvcnlEaWFsb2dBY3RpdmU6IGZhbHNlLAogICAgICAgIHdpbm5lclRlYW06IHVuZGVmaW5lZCwKICAgICAgICBlbmRFbGFwc2VkU2Vjb25kc1NuYXBzaG90OiAwLAogICAgICAgIHZpY3RvcnlTdGFydEVsYXBzZWRTZWNvbmRzU25hcHNob3Q6IDAsCiAgICAgICAgZmxvdzogewogICAgICAgICAgICBtYXRjaEVuZERlbGF5VG9rZW46IDAsCiAgICAgICAgfSwKICAgIH0sCiAgICBhZG1pbjogewogICAgICAgIGFjdGlvbkNvdW50OiAwLAogICAgICAgIGRlYnVnTG9vcEFjdGl2ZTogZmFsc2UsCiAgICB9LAogICAgcGxheWVyczogewogICAgICAgIHRlYW1Td2l0Y2hEYXRhOiB7fSwKICAgICAgICByZWFkeUJ5UGlkOiB7fSwKICAgICAgICBpbk1haW5CYXNlQnlQaWQ6IHt9LAogICAgICAgIGRlcGxveWVkQnlQaWQ6IHt9LAogICAgfSwKICAgIHZlaGljbGVzOiB7CiAgICAgICAgc2xvdHM6IFtdLAogICAgICAgIHZlaGljbGVUb1Nsb3Q6IHt9LAogICAgICAgIHNwYXduU2VxdWVuY2VUb2tlbjogMCwKICAgICAgICBzcGF3blNlcXVlbmNlSW5Qcm9ncmVzczogZmFsc2UsCiAgICAgICAgYWN0aXZlU3Bhd25TbG90SW5kZXg6IHVuZGVmaW5lZCwKICAgICAgICBhY3RpdmVTcGF3blRva2VuOiB1bmRlZmluZWQsCiAgICAgICAgYWN0aXZlU3Bhd25SZXF1ZXN0ZWRBdFNlY29uZHM6IHVuZGVmaW5lZCwKICAgICAgICBjb25maWdSZWFkeTogZmFsc2UsCiAgICAgICAgc3RhcnR1cENsZWFudXBEb25lOiBmYWxzZSwKICAgIH0sCiAgICBodWRDYWNoZTogewogICAgICAgIGxhc3RIdWRTY29yZVQxOiB1bmRlZmluZWQsCiAgICAgICAgbGFzdEh1ZFNjb3JlVDI6IHVuZGVmaW5lZCwKICAgICAgICBsYXN0SHVkUm91bmRLaWxsc1QxOiB1bmRlZmluZWQsCiAgICAgICAgbGFzdEh1ZFJvdW5kS2lsbHNUMjogdW5kZWZpbmVkLAogICAgICAgIGh1ZEJ5UGlkOiB7fSwKICAgICAgICBjbG9ja1dpZGdldENhY2hlOiB7fSwKICAgICAgICBjb3VudGRvd25XaWRnZXRDYWNoZToge30sCiAgICAgICAgb3ZlckxpbmVUaXRsZVdpZGdldENhY2hlOiB7fSwKICAgICAgICBvdmVyTGluZVN1YnRpdGxlV2lkZ2V0Q2FjaGU6IHt9LAogICAgfSwKfTsKCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBHYW1lIFN0YXRlIERlZmluaXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBDb3VudGVyIEhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIHNldENvdW50ZXJUZXh0KHdpZGdldDogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkLCB2YWx1ZTogbnVtYmVyKTogdm9pZCB7CiAgICBpZiAoIXdpZGdldCkgcmV0dXJuOwogICAgbW9kLlNldFVJVGV4dExhYmVsKHdpZGdldCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgTWF0aC5mbG9vcih2YWx1ZSkpKTsKfQoKZnVuY3Rpb24gc2V0Um91bmRSZWNvcmRUZXh0KHdpZGdldDogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkLCB3aW5zOiBudW1iZXIsIGxvc3NlczogbnVtYmVyLCB0aWVzOiBudW1iZXIpOiB2b2lkIHsKICAgIGlmICghd2lkZ2V0KSByZXR1cm47CiAgICBtb2QuU2V0VUlUZXh0TGFiZWwod2lkZ2V0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kUmVjb3JkRm9ybWF0LCBNYXRoLmZsb29yKHdpbnMpLCBNYXRoLmZsb29yKGxvc3NlcyksIE1hdGguZmxvb3IodGllcykpKTsKfQoKZnVuY3Rpb24gc2V0QWRtaW5QYW5lbEFjdGlvbkNvdW50VGV4dCh3aWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCwgdmFsdWU6IG51bWJlcik6IHZvaWQgewogICAgaWYgKCF3aWRnZXQpIHJldHVybjsKICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3aWRnZXQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbkNvdW50Rm9ybWF0LCBNYXRoLmZsb29yKHZhbHVlKSkpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIENvdW50ZXIgSGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gSFVEIFJvdW5kIFN0YXRlICsgSGVscCBUZXh0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBzZXRSb3VuZFN0YXRlVGV4dCh3aWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCk6IHZvaWQgewogICAgaWYgKCF3aWRnZXQpIHJldHVybjsKCiAgICBpZiAoU3RhdGUucm91bmQucGhhc2UgPT09IFJvdW5kUGhhc2UuR2FtZU92ZXIpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwod2lkZ2V0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kU3RhdGVHYW1lT3ZlcikpOwogICAgICAgIG1vZC5TZXRVSVRleHRDb2xvcih3aWRnZXQsIENPTE9SX1dBUk5JTkdfWUVMTE9XKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgaXNMaXZlID0gaXNSb3VuZExpdmUoKTsKICAgIGNvbnN0IHN0YXRlS2V5ID0gaXNMaXZlID8gbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFN0YXRlTGl2ZSA6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQucm91bmRTdGF0ZU5vdFJlYWR5OwoKICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICB3aWRnZXQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFN0YXRlRm9ybWF0LCBtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kVGV4dCwgTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5jdXJyZW50KSwgc3RhdGVLZXkpCiAgICApOwoKICAgIC8vIENvbG9yOiB3aGl0ZSB3aGVuIExJVkUsIHJlZCB3aGVuIE5PVCBSRUFEWQogICAgbW9kLlNldFVJVGV4dENvbG9yKHdpZGdldCwgaXNMaXZlID8gbW9kLkNyZWF0ZVZlY3RvcigxLCAxLCAxKSA6IENPTE9SX05PVF9SRUFEWV9SRUQpOwp9CgpmdW5jdGlvbiBzZXRSb3VuZExpdmVIZWxwVGV4dChyb290OiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQsIHRleHQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCk6IHZvaWQgewogICAgaWYgKCFyb290IHx8ICF0ZXh0KSByZXR1cm47CgogICAgY29uc3Qgc2hvdyA9ICghU3RhdGUubWF0Y2guaXNFbmRlZCkgJiYgKGlzUm91bmRMaXZlKCkpOwogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShyb290LCBzaG93KTsKCiAgICBpZiAoIXNob3cpIHJldHVybjsKCiAgICBtb2QuU2V0VUlUZXh0TGFiZWwoCiAgICAgICAgdGV4dCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kTGl2ZUhlbHBGb3JtYXQsIE1hdGguZmxvb3IoU3RhdGUucm91bmQua2lsbHNUYXJnZXQpKQogICAgKTsKICAgIG1vZC5TZXRVSVRleHRDb2xvcih0ZXh0LCBtb2QuQ3JlYXRlVmVjdG9yKDEsIDEsIDEpKTsKfQoKLy8gVUkgaGFyZGVuaW5nIGhlbHBlcnMgc2tpcCB3b3JrIGlmIGEgd2lkZ2V0IGlzIG1pc3NpbmcgKFBhcnNlVUkgYW5kIHNhZmVGaW5kIGNhbiB5aWVsZCB1bmRlZmluZWQpLgovLyBUaGlzIHByZXZlbnRzIHJ1bnRpbWUgaXNzdWVzIGFuZCBhbHNvIGF2b2lkcyBUUyBlcnJvcnMgZnJvbSBwYXNzaW5nIFVJV2lkZ2V0IHwgdW5kZWZpbmVkIGludG8gbW9kLiogVUkgY2FsbHMuCmZ1bmN0aW9uIHNldFdpZGdldFZpc2libGUod2lkZ2V0OiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQsIHZpc2libGU6IGJvb2xlYW4pOiB2b2lkIHsKICAgIGlmICghd2lkZ2V0KSByZXR1cm47CiAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHdpZGdldCwgdmlzaWJsZSk7Ci8vIFNldFVJVGV4dExhYmVsIG9ubHkgYWNjZXB0cyBtb2QuTWVzc2FnZTsgc3RyaW5nIGlucHV0cyBhcmUgdHJlYXRlZCBhcyBzdHJpbmcga2V5cyBhbmQgd3JhcHBlZCB3aXRoIG1vZC5NZXNzYWdlKGtleSkuCn0KCmZ1bmN0aW9uIHNldFdpZGdldFRleHQod2lkZ2V0OiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQsIGxhYmVsOiBzdHJpbmcgfCBtb2QuTWVzc2FnZSk6IHZvaWQgewogICAgaWYgKCF3aWRnZXQpIHJldHVybjsKICAgIGlmICh0eXBlb2YgbGFiZWwgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHdpZGdldCwgbW9kLk1lc3NhZ2UobGFiZWwpKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBtb2QuU2V0VUlUZXh0TGFiZWwod2lkZ2V0LCBsYWJlbCk7Cn0KCi8qKgogKiBTZXRzIHRoZSBzaGFyZWQgcm91bmQgc3RhdGUgdGV4dCAoZS5nLiwgTk9UIFJFQURZIC8gTElWRSAvIEdBTUUgT1ZFUikgZm9yIGV2ZXJ5IHBsYXllcidzIEhVRC4KICogVGhpcyBpcyBhIGJyb2FkY2FzdC1zdHlsZSBVSSB1cGRhdGU6CiAqIC0gSXQgZG9lcyBub3QgbXV0YXRlIHJvdW5kIHN0YXRlOyBpdCByZWZsZWN0cyB3aGF0ZXZlciBhdXRob3JpdGF0aXZlIHN0YXRlIGFscmVhZHkgZXhpc3RzLgogKiAtIEl0IHNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgYW55IGNoYW5nZSB0aGF0IGFmZmVjdHMgdGhlIHJvdW5kIHBoYXNlIHNvIEhVRHMgcmVtYWluIGNvbnNpc3RlbnQuCiAqLwoKZnVuY3Rpb24gc2V0Um91bmRTdGF0ZVRleHRGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCBjYWNoZSA9IGVuc3VyZUNsb2NrVUlBbmRHZXRDYWNoZShwKTsKICAgICAgICBpZiAoIWNhY2hlKSBjb250aW51ZTsKICAgICAgICBzZXRSb3VuZFN0YXRlVGV4dChjYWNoZS5yb3VuZFN0YXRlVGV4dCk7CiAgICAgICAgc2V0Um91bmRMaXZlSGVscFRleHQoY2FjaGUucm91bmRMaXZlSGVscFJvb3QsIGNhY2hlLnJvdW5kTGl2ZUhlbHBUZXh0KTsKICAgIH0KICAgIC8vIEtlZXAgdGhlIHByZS1yb3VuZCByZWFkeSBjb3VudCBsaW5lIGluIHN5bmMgd2l0aCBhbnkgcm91bmQtcGhhc2UgSFVEIHJlZnJlc2guCiAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIFJvdW5kIFN0YXRlICsgSGVscCBUZXh0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBIVUQgUmVhZHkgQ291bnQgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8qKgogKiBVcGRhdGVzIHRoZSB5ZWxsb3cgSFVEIGxpbmU6ICJYIC8gWSBQTEFZRVJTIFJFQURZIiAocHJlLXJvdW5kIG9ubHkpLgogKiBWaXNpYmlsaXR5IHJ1bGVzOgogKiAtIE9ubHkgc2hvd24gd2hpbGUgcHJlcGFyaW5nIGZvciBhIG5ldyByb3VuZCAocm91bmQgTk9UIGxpdmUpLgogKiAtIEhpZGRlbiBkdXJpbmcgZ2FtZS1vdmVyIC8gdmljdG9yeSBkaWFsb2cgcGhhc2VzLgogKiAtIFJlbWFpbnMgdmlzaWJsZSB1bnRpbCB0aGUgcm91bmQgaXMgYWN0dWFsbHkgbGl2ZSAoaXNSb3VuZExpdmUoKSA9PT0gdHJ1ZSkuCiAqIElNUE9SVEFOVDogQW55IGNvZGUgcGF0aCB0aGF0IGNoYW5nZXMgU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkIE1VU1QgYWxzbyByZWZyZXNoOgogKiAgIC0gdXBkYXRlUGxheWVyc1JlYWR5SHVkVGV4dEZvckFsbFBsYXllcnMoKQogKiAgIC0gcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycygpIChpZiB0aGUgZGlhbG9nIGNhbiBiZSBvcGVuKQogKiB0byBwcmV2ZW50IHN0YWxlIEhVRC9yb3N0ZXIgc3RhdGUgKGUuZy4sIGFmdGVyIHN3YXAgdGVhbXMgb3IgbGVhdmluZyBiYXNlIGZvcmNlcyBOT1QgUkVBRFkpLgogKi8KZnVuY3Rpb24gdXBkYXRlUGxheWVyc1JlYWR5SHVkVGV4dEZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICAvLyBDb21wdXRlIGNvdW50cyBvbmNlLCB0aGVuIGJyb2FkY2FzdCB0aGUgc2FtZSBsYWJlbCB0byBhbGwgdmlld2Vycy4KICAgIGNvbnN0IGFjdGl2ZSA9IGdldEFjdGl2ZVBsYXllcnMoKTsKICAgIGNvbnN0IHRvdGFsID0gYWN0aXZlLmFsbC5sZW5ndGg7CgogICAgbGV0IHJlYWR5Q291bnQgPSAwOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbDsgaSsrKSB7CiAgICAgICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKGFjdGl2ZS5hbGxbaV0pOwogICAgICAgIGlmIChTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSkgcmVhZHlDb3VudCsrOwogICAgfQoKICAgIGNvbnN0IHNob3VsZFNob3cgPSAhU3RhdGUubWF0Y2guaXNFbmRlZCAmJiAhU3RhdGUubWF0Y2gudmljdG9yeURpYWxvZ0FjdGl2ZTsKCiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IGNhY2hlID0gZW5zdXJlQ2xvY2tVSUFuZEdldENhY2hlKHApOwogICAgICAgIGlmICghY2FjaGUgfHwgIWNhY2hlLnBsYXllcnNSZWFkeVRleHQpIGNvbnRpbnVlOwoKICAgICAgICAvLyBUb2dnbGUgdmlzaWJpbGl0eSBmaXJzdCBzbyB3ZSBjYW4gYXZvaWQgdW5uZWNlc3NhcnkgbGFiZWwgY2h1cm4gd2hlbiBoaWRkZW4uCiAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShjYWNoZS5wbGF5ZXJzUmVhZHlUZXh0LCBzaG91bGRTaG93KTsKICAgICAgICBpZiAoIXNob3VsZFNob3cpIGNvbnRpbnVlOwoKICAgICAgICBpZiAoaXNSb3VuZExpdmUoKSkgewogICAgICAgICAgICBjb25zdCBwcmVzZXQgPSBNQVRDSFVQX1BSRVNFVFNbU3RhdGUucm91bmQubWF0Y2h1cFByZXNldEluZGV4XTsKICAgICAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKAogICAgICAgICAgICAgICAgY2FjaGUucGxheWVyc1JlYWR5VGV4dCwKICAgICAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5tYXRjaHVwRm9ybWF0LCBwcmVzZXQubGVmdFBsYXllcnMsIHByZXNldC5yaWdodFBsYXllcnMpCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRDb2xvcihjYWNoZS5wbGF5ZXJzUmVhZHlUZXh0LCBDT0xPUl9OT1JNQUwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAgICAgIGNhY2hlLnBsYXllcnNSZWFkeVRleHQsCiAgICAgICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnBsYXllcnNSZWFkeUZvcm1hdCwgcmVhZHlDb3VudCwgdG90YWwpCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRDb2xvcihjYWNoZS5wbGF5ZXJzUmVhZHlUZXh0LCBDT0xPUl9XQVJOSU5HX1lFTExPVyk7CiAgICAgICAgfQogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIFJlYWR5IENvdW50IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBIVUQgVmljdG9yeSBEaWFsb2cgVXBkYXRlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gZ2V0RWxhcHNlZEhtc1BhcnRzKHRvdGFsU2Vjb25kczogbnVtYmVyKTogeyBob3VyczogbnVtYmVyOyBtaW51dGVzOiBudW1iZXI7IHNlY29uZHM6IG51bWJlciB9IHsKICAgIGNvbnN0IHNlYyA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IodG90YWxTZWNvbmRzKSk7CiAgICBjb25zdCBob3VycyA9IE1hdGguZmxvb3Ioc2VjIC8gMzYwMCk7CiAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcigoc2VjICUgMzYwMCkgLyA2MCk7CiAgICBjb25zdCBzZWNvbmRzID0gc2VjICUgNjA7CiAgICByZXR1cm4geyBob3VycywgbWludXRlcywgc2Vjb25kcyB9Owp9CgpmdW5jdGlvbiBjb21wdXRlVGVhbU91dGNvbWVLZXkodGVhbU51bTogVGVhbUlEKTogbnVtYmVyIHsKICAgIGlmIChTdGF0ZS5tYXRjaC53aW5uZXJUZWFtID09PSB1bmRlZmluZWQgfHwgU3RhdGUubWF0Y2gud2lubmVyVGVhbSA9PT0gMCkgewogICAgICAgIHJldHVybiBtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS5kcmF3czsKICAgIH0KICAgIHJldHVybiBTdGF0ZS5tYXRjaC53aW5uZXJUZWFtID09PSB0ZWFtTnVtID8gbW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkud2lucyA6IG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5Lmxvc2VzOwp9CgovKioKICogVXBkYXRlcyBwZXItcGxheWVyIFZpY3RvcnkgZGlhbG9nIHdpZGdldHMgdG8gcmVmbGVjdCBjdXJyZW50IG1hdGNoLWVuZCBzdGF0ZS4KICogTm90ZXM6CiAqIC0gVGhpcyBvbmx5IHVwZGF0ZXMgVUkgdGV4dC92aXNpYmlsaXR5OyBpdCBkb2VzIG5vdCBkZWNpZGUgd2lubmVycy4KICogLSBDYWxsZXIgbXVzdCBlbnN1cmUgdGhlIGRpYWxvZyBpcyBidWlsdCBiZWZvcmUgdXBkYXRpbmcuCiAqIC0gUmVtYWluaW5nIHNlY29uZHMgY2FuIHdyYXAgYXQgMCAoZW5naW5lIHF1aXJrKTsgd2UgY2xhbXAgdG8gMCB0byBhdm9pZCBodWdlIHZhbHVlcy4KICovCmZ1bmN0aW9uIHVwZGF0ZVZpY3RvcnlEaWFsb2dGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyLCByZW1haW5pbmdTZWNvbmRzOiBudW1iZXIpOiB2b2lkIHsKICAgIC8vIFBlci1wbGF5ZXIgdXBkYXRlIGZvciB0aGUgbWF0Y2gtZW5kIHZpY3RvcnkgbW9kYWw6IHdpbm5lciBsYWJlbCwgc2NvcmVzLCBhbmQgcmVzdGFydC9yb3RhdGUgY291bnRkb3duLgogICAgLy8gVGhpcyBpcyBjYWxsZWQgb25jZSBwZXIgc2Vjb25kIHdoaWxlIHRoZSB2aWN0b3J5IGRpYWxvZyBpcyBhY3RpdmUuCiAgICAvLyBEZXRlcm1pbmUgdGhlIHRhcmdldCBwbGF5ZXIgaWQ7IGRpYWxvZyB3aWRnZXRzIGFyZSBrZXllZCBwZXItcGxheWVyLgpjb25zdCBwaWQgPSBtb2QuR2V0T2JqSWQocGxheWVyKTsKICAgIC8vIExvb2sgdXAgY2FjaGVkIFVJIHJlZmVyZW5jZXMgZm9yIHRoaXMgcGxheWVyIChpZiBtaXNzaW5nLCB0aGlzIHVwZGF0ZSBiZWNvbWVzIGEgbm8tb3ApLgpjb25zdCByZWZzID0gU3RhdGUuaHVkQ2FjaGUuaHVkQnlQaWRbcGlkXTsKICAgIGlmICghcmVmcykgcmV0dXJuOwoKICAgIGlmIChyZWZzLnZpY3RvcnlSb290KSB7CiAgICAgICAgLy8gQXBwbHkgdmlzaWJpbGl0eSBydWxlcyBmb3IgdGhlIGRpYWxvZyBwYXJ0cyBiYXNlZCBvbiBtYXRjaC1lbmQgc3RhdGUuCiAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShyZWZzLnZpY3RvcnlSb290LCBTdGF0ZS5tYXRjaC52aWN0b3J5RGlhbG9nQWN0aXZlKTsKICAgIH0KCiAgICBpZiAoIVN0YXRlLm1hdGNoLnZpY3RvcnlEaWFsb2dBY3RpdmUpIHsKICAgICAgICByZXR1cm47CiAgICB9CmlmIChyZWZzLnZpY3RvcnlSZXN0YXJ0VGV4dCkgewogICAgICAgIC8vIFVwZGF0ZSBzdHJpbmcta2V5IGxhYmVscyAoU3RyaW5ncy5qc29uKSBzbyB0aGUgZGlhbG9nIHJlZmxlY3RzIHRoZSBsYXRlc3Qgb3V0Y29tZS9jb3VudGRvd24uCiAgICAgICAgLy8gUmVtYWluaW5nIHNlY29uZHMgY2FuIHdyYXAvcm9sbCBvdmVyIG9uIHNvbWUgZW5naW5lIHRpbWVycyBhdCB0aGUgbW9tZW50IGl0IGhpdHMgMC4KICAgICAgICAvLyBUcmVhdCBhbnkgb3V0LW9mLXJhbmdlIHZhbHVlIGFzIDAgdG8gYXZvaWQgZGlzcGxheWluZyBhIGh1Z2UgbnVtYmVyIGF0IHRoZSBlbmQuCiAgICAgICAgbGV0IGRpc3BsYXlTZWNvbmRzID0gTWF0aC5mbG9vcihyZW1haW5pbmdTZWNvbmRzKTsKICAgICAgICBpZiAoZGlzcGxheVNlY29uZHMgPCAwKSBkaXNwbGF5U2Vjb25kcyA9IDA7CiAgICAgICAgaWYgKGRpc3BsYXlTZWNvbmRzID4gTUFUQ0hfRU5EX0RFTEFZX1NFQ09ORFMpIGRpc3BsYXlTZWNvbmRzID0gMDsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5UmVzdGFydFRleHQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJlc3RhcnRJbkZvcm1hdCwgZGlzcGxheVNlY29uZHMpKTsKICAgIH0KICAgIGNvbnN0IHBhcnRzID0gZ2V0RWxhcHNlZEhtc1BhcnRzKFN0YXRlLm1hdGNoLmVuZEVsYXBzZWRTZWNvbmRzU25hcHNob3QpOwogICAgY29uc3QgaG91cnMgPSBNYXRoLm1pbig5OSwgTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihwYXJ0cy5ob3VycykpKTsKICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLm1pbig1OSwgTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihwYXJ0cy5taW51dGVzKSkpOwogICAgY29uc3Qgc2Vjb25kcyA9IE1hdGgubWluKDU5LCBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHBhcnRzLnNlY29uZHMpKSk7CgogICAgY29uc3QgaFQgPSBNYXRoLmZsb29yKGhvdXJzIC8gMTApOwogICAgY29uc3QgaE8gPSBob3VycyAlIDEwOwogICAgY29uc3QgbVQgPSBNYXRoLmZsb29yKG1pbnV0ZXMgLyAxMCk7CiAgICBjb25zdCBtTyA9IG1pbnV0ZXMgJSAxMDsKICAgIGNvbnN0IHNUID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gMTApOwogICAgY29uc3Qgc08gPSBzZWNvbmRzICUgMTA7CgogICAgaWYgKHJlZnMudmljdG9yeVRpbWVIb3Vyc1RlbnMpIG1vZC5TZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlUaW1lSG91cnNUZW5zLCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCBoVCkpOwogICAgaWYgKHJlZnMudmljdG9yeVRpbWVIb3Vyc09uZXMpIG1vZC5TZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlUaW1lSG91cnNPbmVzLCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCBoTykpOwogICAgaWYgKHJlZnMudmljdG9yeVRpbWVNaW51dGVzVGVucykgbW9kLlNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeVRpbWVNaW51dGVzVGVucywgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5kaWdpdCwgbVQpKTsKICAgIGlmIChyZWZzLnZpY3RvcnlUaW1lTWludXRlc09uZXMpIG1vZC5TZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlUaW1lTWludXRlc09uZXMsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suZGlnaXQsIG1PKSk7CiAgICBpZiAocmVmcy52aWN0b3J5VGltZVNlY29uZHNUZW5zKSBtb2QuU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5VGltZVNlY29uZHNUZW5zLCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCBzVCkpOwogICAgaWYgKHJlZnMudmljdG9yeVRpbWVTZWNvbmRzT25lcykgbW9kLlNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeVRpbWVTZWNvbmRzT25lcywgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5kaWdpdCwgc08pKTsKCiAgICBpZiAocmVmcy52aWN0b3J5Um91bmRzU3VtbWFyeVRleHQpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5Um91bmRzU3VtbWFyeVRleHQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kc1N1bW1hcnlGb3JtYXQsIE1hdGguZmxvb3IoU3RhdGUucm91bmQuY3VycmVudCksIE1hdGguZmxvb3IoU3RhdGUucm91bmQubWF4KSkpOwogICAgfQogICAgaWYgKHJlZnMudmljdG9yeUFkbWluQWN0aW9uc1RleHQpIHsKICAgICAgICBjb25zdCBhY3Rpb25Db3VudCA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IoU3RhdGUuYWRtaW4uYWN0aW9uQ291bnQpKTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHJlZnMudmljdG9yeUFkbWluQWN0aW9uc1RleHQsIGFjdGlvbkNvdW50ID4gMCk7CiAgICAgICAgaWYgKGFjdGlvbkNvdW50ID4gMCkgewogICAgICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwoCiAgICAgICAgICAgICAgICByZWZzLnZpY3RvcnlBZG1pbkFjdGlvbnNUZXh0LAogICAgICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9uQ291bnRWaWN0b3J5Rm9ybWF0LCBhY3Rpb25Db3VudCkKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICB9CgogICAgY29uc3QgdDFPdXRjb21lS2V5ID0gY29tcHV0ZVRlYW1PdXRjb21lS2V5KFRlYW1JRC5UZWFtMSk7CiAgICBjb25zdCB0Mk91dGNvbWVLZXkgPSBjb21wdXRlVGVhbU91dGNvbWVLZXkoVGVhbUlELlRlYW0yKTsKCiAgICBpZiAocmVmcy52aWN0b3J5TGVmdE91dGNvbWVUZXh0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeUxlZnRPdXRjb21lVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudGVhbU91dGNvbWVGb3JtYXQsIGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMSksIHQxT3V0Y29tZUtleSkpOwogICAgfQogICAgaWYgKHJlZnMudmljdG9yeVJpZ2h0T3V0Y29tZVRleHQpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5UmlnaHRPdXRjb21lVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudGVhbU91dGNvbWVGb3JtYXQsIGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMiksIHQyT3V0Y29tZUtleSkpOwogICAgfQoKICAgIGlmIChyZWZzLnZpY3RvcnlMZWZ0UmVjb3JkVGV4dCkgewogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlMZWZ0UmVjb3JkVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFJlY29yZEZvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5tYXRjaC53aW5zVDEpLCBNYXRoLmZsb29yKFN0YXRlLm1hdGNoLndpbnNUMiksIE1hdGguZmxvb3IoU3RhdGUubWF0Y2gudGllc1QxKSkpOwogICAgfQogICAgaWYgKHJlZnMudmljdG9yeVJpZ2h0UmVjb3JkVGV4dCkgewogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlSaWdodFJlY29yZFRleHQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQucm91bmRSZWNvcmRGb3JtYXQsIE1hdGguZmxvb3IoU3RhdGUubWF0Y2gud2luc1QyKSwgTWF0aC5mbG9vcihTdGF0ZS5tYXRjaC53aW5zVDEpLCBNYXRoLmZsb29yKFN0YXRlLm1hdGNoLnRpZXNUMikpKTsKICAgIH0KCiAgICBpZiAocmVmcy52aWN0b3J5TGVmdFJvdW5kV2luc1RleHQpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5TGVmdFJvdW5kV2luc1RleHQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kV2luc0Zvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5tYXRjaC53aW5zVDEpKSk7CiAgICB9CiAgICBpZiAocmVmcy52aWN0b3J5UmlnaHRSb3VuZFdpbnNUZXh0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeVJpZ2h0Um91bmRXaW5zVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkucm91bmRXaW5zRm9ybWF0LCBNYXRoLmZsb29yKFN0YXRlLm1hdGNoLndpbnNUMikpKTsKICAgIH0KCiAgICBjb25zdCBsb3NzZXNUMSA9IFN0YXRlLm1hdGNoLmxvc3Nlc1QxOwogICAgY29uc3QgbG9zc2VzVDIgPSBTdGF0ZS5tYXRjaC5sb3NzZXNUMjsKCiAgICBpZiAocmVmcy52aWN0b3J5TGVmdFJvdW5kTG9zc2VzVGV4dCkgewogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlMZWZ0Um91bmRMb3NzZXNUZXh0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS5yb3VuZExvc3Nlc0Zvcm1hdCwgTWF0aC5mbG9vcihsb3NzZXNUMSkpKTsKICAgIH0KICAgIGlmIChyZWZzLnZpY3RvcnlSaWdodFJvdW5kTG9zc2VzVGV4dCkgewogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbChyZWZzLnZpY3RvcnlSaWdodFJvdW5kTG9zc2VzVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkucm91bmRMb3NzZXNGb3JtYXQsIE1hdGguZmxvb3IobG9zc2VzVDIpKSk7CiAgICB9CiAgICBpZiAocmVmcy52aWN0b3J5TGVmdFJvdW5kVGllc1RleHQpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5TGVmdFJvdW5kVGllc1RleHQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kVGllc0Zvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5tYXRjaC50aWVzVDEpKSk7CiAgICB9CiAgICBpZiAocmVmcy52aWN0b3J5UmlnaHRSb3VuZFRpZXNUZXh0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeVJpZ2h0Um91bmRUaWVzVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkucm91bmRUaWVzRm9ybWF0LCBNYXRoLmZsb29yKFN0YXRlLm1hdGNoLnRpZXNUMikpKTsKICAgIH0KCiAgICBpZiAocmVmcy52aWN0b3J5TGVmdFRvdGFsS2lsbHNUZXh0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHJlZnMudmljdG9yeUxlZnRUb3RhbEtpbGxzVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudG90YWxLaWxsc0Zvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5zY29yZXMudDFUb3RhbEtpbGxzKSkpOwogICAgfQogICAgaWYgKHJlZnMudmljdG9yeVJpZ2h0VG90YWxLaWxsc1RleHQpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwocmVmcy52aWN0b3J5UmlnaHRUb3RhbEtpbGxzVGV4dCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudG90YWxLaWxsc0Zvcm1hdCwgTWF0aC5mbG9vcihTdGF0ZS5zY29yZXMudDJUb3RhbEtpbGxzKSkpOwogICAgfQp9CgpmdW5jdGlvbiB1cGRhdGVWaWN0b3J5RGlhbG9nRm9yQWxsUGxheWVycyhyZW1haW5pbmdTZWNvbmRzOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgdXBkYXRlVmljdG9yeURpYWxvZ0ZvclBsYXllcihwLCByZW1haW5pbmdTZWNvbmRzKTsKICAgIH0KfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEhVRCBWaWN0b3J5IERpYWxvZyBVcGRhdGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBIVUQgUm91bmQtRW5kIERpYWxvZyBVcGRhdGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBzZXRSb3VuZEVuZERpYWxvZ1Zpc2libGVGb3JBbGxQbGF5ZXJzKHZpc2libGU6IGJvb2xlYW4pOiB2b2lkIHsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHApOwogICAgICAgIGNvbnN0IHJlZnMgPSBTdGF0ZS5odWRDYWNoZS5odWRCeVBpZFtwaWRdOwogICAgICAgIGlmICghcmVmcykgY29udGludWU7CiAgICAgICAgaWYgKHJlZnMucm91bmRFbmRSb290KSB7CiAgICAgICAgICAgIHNldFdpZGdldFZpc2libGUocmVmcy5yb3VuZEVuZFJvb3QsIHZpc2libGUpOwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gdXBkYXRlUm91bmRFbmREaWFsb2dGb3JBbGxQbGF5ZXJzKHdpbm5lclRlYW1OdW06IFRlYW1JRCB8IDApOiB2b2lkIHsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgdXBkYXRlUm91bmRFbmREaWFsb2dGb3JQbGF5ZXIocCwgd2lubmVyVGVhbU51bSk7CiAgICB9Cn0KCmZ1bmN0aW9uIHVwZGF0ZVJvdW5kRW5kRGlhbG9nRm9yUGxheWVyKHBsYXllcjogbW9kLlBsYXllciwgd2lubmVyVGVhbU51bTogVGVhbUlEIHwgMCk6IHZvaWQgewogICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHBsYXllcik7CiAgICBjb25zdCByZWZzID0gU3RhdGUuaHVkQ2FjaGUuaHVkQnlQaWRbcGlkXTsKICAgIGlmICghcmVmcykgcmV0dXJuOwoKICAgIC8vIEVuc3VyZSBsYWJlbHMgYXJlIGFsd2F5cyBhdXRob3JpdGF0aXZlIGF0IHRoZSB0aW1lIHRoZSBkaWFsb2cgaXMgc2hvd24uCiAgICBpZiAocmVmcy5yb3VuZEVuZFJvdW5kVGV4dCkgewogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAgcmVmcy5yb3VuZEVuZFJvdW5kVGV4dCwKICAgICAgICAgICAgLy8gUm91bmRFbmRfUm91bmROdW1iZXIgaXMgYSBkZWRpY2F0ZWQgZm9ybWF0IGtleSAoIlJPVU5EIHswfSIpIHRvIGF2b2lkIHBhc3NpbmcgYW4gZW1wdHkgc3RyaW5nIGludG8gUm91bmRTdGF0ZV9Gb3JtYXQsCiAgICAgICAgICAgIC8vIHdoaWNoIFBvcnRhbCByZW5kZXJzIGFzIDx1bmtub3duIHN0cmluZz4gd2hlbiB0aGUga2V5IGNhbm5vdCBiZSByZXNvbHZlZC4KICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJvdW5kRW5kLnJvdW5kTnVtYmVyLCBTdGF0ZS5yb3VuZC5jdXJyZW50KQogICAgICAgICk7CiAgICB9CgogICAgaWYgKHJlZnMucm91bmRFbmRPdXRjb21lVGV4dCkgewogICAgICAgIGlmICh3aW5uZXJUZWFtTnVtID09PSBUZWFtSUQuVGVhbTEpIHsKICAgICAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKAogICAgICAgICAgICAgICAgcmVmcy5yb3VuZEVuZE91dGNvbWVUZXh0LAogICAgICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudGVhbU91dGNvbWVGb3JtYXQsIGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMSksIG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LndpbnMpCiAgICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIGlmICh3aW5uZXJUZWFtTnVtID09PSBUZWFtSUQuVGVhbTIpIHsKICAgICAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKAogICAgICAgICAgICAgICAgcmVmcy5yb3VuZEVuZE91dGNvbWVUZXh0LAogICAgICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudGVhbU91dGNvbWVGb3JtYXQsIGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMiksIG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LndpbnMpCiAgICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2V0V2lkZ2V0VGV4dChyZWZzLnJvdW5kRW5kT3V0Y29tZVRleHQsIG1vZC5zdHJpbmdrZXlzLnR3bC5yb3VuZEVuZC5kcmF3KTsKICAgICAgICB9CiAgICB9CgogICAgaWYgKHJlZnMucm91bmRFbmRMZWZ0U3VtbWFyeVRleHQpIHsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwoCiAgICAgICAgICAgIHJlZnMucm91bmRFbmRMZWZ0U3VtbWFyeVRleHQsCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKAogICAgICAgICAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFN0YXRlRm9ybWF0LAogICAgICAgICAgICAgICAgU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscywKICAgICAgICAgICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5odWQubGFiZWxzLnJvdW5kS2lsbHMsCiAgICAgICAgICAgICAgICBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTEpCiAgICAgICAgICAgICkKICAgICAgICApOwogICAgfQogICAgaWYgKHJlZnMucm91bmRFbmRSaWdodFN1bW1hcnlUZXh0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKAogICAgICAgICAgICByZWZzLnJvdW5kRW5kUmlnaHRTdW1tYXJ5VGV4dCwKICAgICAgICAgICAgbW9kLk1lc3NhZ2UoCiAgICAgICAgICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kU3RhdGVGb3JtYXQsCiAgICAgICAgICAgICAgICBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzLAogICAgICAgICAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMucm91bmRLaWxscywKICAgICAgICAgICAgICAgIGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMikKICAgICAgICAgICAgKQogICAgICAgICk7CiAgICB9Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBIVUQgUm91bmQtRW5kIERpYWxvZyBVcGRhdGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBIVUQgQnVpbGQvRW5zdXJlIC0gRGlhbG9nIE9wZW4gKyBIZWxwIFRleHQgVmlzaWJpbGl0eSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gaXNUZWFtU3dpdGNoRGlhbG9nT3BlbkZvclBpZChwaWQ6IG51bWJlcik6IGJvb2xlYW4gewogICAgLy8gV2l0aCBVSSBjYWNoaW5nLCB0aGUgZGlhbG9nIHJvb3Qgd2lkZ2V0IG1heSBjb250aW51ZSB0byBleGlzdCB3aGlsZSBoaWRkZW4uCiAgICAvLyBVc2UgdGhlIGV4cGxpY2l0IHBlci1wbGF5ZXIgc3RhdGUgZmxhZyBhcyB0aGUgc291cmNlIG9mIHRydXRoIGZvciAib3BlbiIuCiAgICByZXR1cm4gISFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BpZF0/LmRpYWxvZ1Zpc2libGU7Cn0KCi8qKgogKiBBcHBsaWVzIHRoZSBjdXJyZW50ICdoZWxwIHRleHQnIHZpc2liaWxpdHkgcnVsZXMgdG8gb25lIHNwZWNpZmljIHBsYXllciBpZC4KICogVGhpcyBpcyBpbnRlbnRpb25hbGx5IHBpZC1iYXNlZCAobm90IFBsYXllci1iYXNlZCkgc28gaXQgY2FuIGJlIHVzZWQgZHVyaW5nIGpvaW4vbGVhdmUgYW5kIFVJIHJlYnVpbGRzLgogKiBLZWVwIGluIG1pbmQ6CiAqIC0gVGhlIHBsYXllciBtYXkgbm90IGJlIHByZXNlbnQgYXQgdGhlIHRpbWUgb2YgdGhlIGNhbGw7IHRoaXMgZnVuY3Rpb24gc2hvdWxkIHRvbGVyYXRlIG1pc3NpbmcgVUkgcmVmcy4KICogLSBWaXNpYmlsaXR5IHJ1bGVzIHR5cGljYWxseSBkZXBlbmQgb24gcGVyLXBsYXllciBmbGFncyAoZS5nLiwgJ2RvbnQgc2hvdyBhZ2FpbicpIGFuZCBjdXJyZW50IHJvdW5kIHN0YXRlLgogKi8KCmZ1bmN0aW9uIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBpZChwaWQ6IG51bWJlcik6IHZvaWQgewogICAgLy8gRmV0Y2ggdGhpcyBwbGF5ZXIncyBIVUQvd2lkZ2V0IHJlZnM7IGlmIG1pc3NpbmcgKGUuZy4sIGR1cmluZyBqb2luKSwgYmFpbCBvdXQgc2FmZWx5Lgpjb25zdCByZWZzID0gU3RhdGUuaHVkQ2FjaGUuaHVkQnlQaWRbcGlkXTsKICAgIGlmICghcmVmcykgcmV0dXJuOwoKICAgIGNvbnN0IHNob3cgPSAoIVN0YXRlLm1hdGNoLmlzRW5kZWQpICYmICghaXNSb3VuZExpdmUoKSkgJiYgKCFTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSkgJiYgKGlzVGVhbVN3aXRjaERpYWxvZ09wZW5Gb3JQaWQocGlkKSA9PT0gZmFsc2UpOwogICAgaWYgKHJlZnMuaGVscFRleHRDb250YWluZXIpIHsKICAgICAgICAvLyBBcHBseSB0aGUgY29tcHV0ZWQgdmlzaWJpbGl0eSB0byB0aGUgaGVscCB0ZXh0IHdpZGdldC4KbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShyZWZzLmhlbHBUZXh0Q29udGFpbmVyLCBzaG93KTsKICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3Qgd2lkZ2V0ID0gc2FmZUZpbmQoYENvbnRhaW5lcl9IZWxwVGV4dF8ke3BpZH1gKTsKICAgICAgICBpZiAod2lkZ2V0KSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHdpZGdldCwgc2hvdyk7CiAgICB9Cn0KCmZ1bmN0aW9uIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBsYXllcihwbGF5ZXI6IG1vZC5QbGF5ZXIpOiB2b2lkIHsKICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBpZChtb2QuR2V0T2JqSWQocGxheWVyKSk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBpZChtb2QuR2V0T2JqSWQocCkpOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIERpYWxvZyBPcGVuICsgSGVscCBUZXh0IFZpc2liaWxpdHkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgRnVuY3Rpb24gU3RhcnQgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIENvZGUgQ2xlYW51cDogVGhpcyBpcyBhbiBhYnN1cmQgbWVnYS1mdW5jdGlvbiAtIHdlIHNob3VsZCByZWZhY3RvciBhbmQgYnJlYWsgZG93bgovLyBFbnN1cmVzIGFsbCBwZXJzaXN0ZW50IEhVRCB3aWRnZXRzIGV4aXN0IGZvciBhIHBsYXllci4KLy8gVGhpcyBmdW5jdGlvbiBpcyBpZGVtcG90ZW50IGFuZCBzYWZlIHRvIGNhbGwgb24gam9pbiwgcmVzcGF3biwgb3IgcmVjb25uZWN0LgovLyBXaWRnZXQgcmVmZXJlbmNlcyBjcmVhdGVkIGhlcmUgYXJlIHJldXNlZCBhbmQgdXBkYXRlZCBlbHNld2hlcmUuCgpmdW5jdGlvbiBlbnN1cmVIdWRGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyKTogSHVkUmVmcyB8IHVuZGVmaW5lZCB7CiAgICAvLyBQZXItcGxheWVyIEhVRCBsaWZlY3ljbGU6CiAgICAvLyAtIEhVRCB3aWRnZXRzIGFyZSBjcmVhdGVkIG9uY2UgcGVyIHBsYXllciBhbmQgdGhlbiBvbmx5IHVwZGF0ZWQgKG5ldmVyIHJlY3JlYXRlZCkgZHVyaW5nIHRoZSBtYXRjaC4KICAgIC8vIC0gVGhpcyBmdW5jdGlvbiBpcyBzYWZlIHRvIGNhbGwgcmVwZWF0ZWRseSAoam9pbiwgcmVzcGF3biwgcmVjb25uZWN0LCBhZG1pbiBhY3Rpb25zKS4KICAgIC8vIC0gSWYgYSB3aWRnZXQgaXMgbWlzc2luZywgY3JlYXRlIGl0IGFuZCBzdG9yZS9maW5kIGl0IHZpYSB0aGUgVUkgcm9vdC4KCiAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuIHVuZGVmaW5lZDsKCiAgICBjb25zdCBwaWQgPSBnZXRPYmpJZChwbGF5ZXIpOwoKICAgIC8vIElmIGNhY2hlZCBhbmQgc3RpbGwgdmFsaWQsIHJldHVybiBpdAogICAgY29uc3QgY2FjaGVkID0gU3RhdGUuaHVkQ2FjaGUuaHVkQnlQaWRbcGlkXTsKICAgIGlmIChjYWNoZWQgJiYgY2FjaGVkLmxlZnRLaWxsc1RleHQgJiYgY2FjaGVkLnJpZ2h0S2lsbHNUZXh0KSB7CiAgICAgICAgY29uc3QgaGVscENvbnRhaW5lciA9IHNhZmVGaW5kKGBDb250YWluZXJfSGVscFRleHRfJHtwaWR9YCk7CiAgICAgICAgaWYgKGhlbHBDb250YWluZXIpIHsKICAgICAgICAgICAgbW9kLlNldFVJV2lkZ2V0UG9zaXRpb24oaGVscENvbnRhaW5lciwgbW9kLkNyZWF0ZVZlY3RvcigtMTY1LjUsIDc1LjI1LCAwKSk7IC8vLTExNi41LCA3NS4yNSwgMAogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGNhY2hlZDsKICAgIH0KCiAgICBjb25zdCByZWZzOiBIdWRSZWZzID0geyBwaWQsIHJvb3RzOiBbXSB9OwoKICAgIC8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBIVUQgQnVpbGQvRW5zdXJlIEZ1bmN0aW9uIFN0YXJ0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCiAgICAvLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIFVwcGVyLUxlZnQgSFVEIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLy8gLS0tIFN0YXRpYyBIVUQ6IFVwcGVyLWxlZnQgc21hbGwgYm94IC0tLQogICAgewogICAgICAgIGNvbnN0IHJvb3ROYW1lID0gYFVwcGVyX0xlZnRfQ29udGFpbmVyXyR7cGlkfWA7CiAgICAgICAgY29uc3QgdXBwZXJMZWZ0ID0gbW9kbGliLlBhcnNlVUkoewogICAgICAgICAgICBuYW1lOiByb290TmFtZSwKICAgICAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgICAgIHBsYXllcklkOiBwbGF5ZXIsCiAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgIHBvc2l0aW9uOiBbNSwgNV0sCiAgICAgICAgICAgIHNpemU6IFsyMDAsIDMwXSwKICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgcGFkZGluZzogMSwKICAgICAgICAgICAgYmdDb2xvcjogWzAuMjUxLCAwLjA5NDEsIDAuMDY2N10sCiAgICAgICAgICAgIGJnQWxwaGE6IDAuNDUsCiAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLkJsdXIsCiAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVXBwZXJfTGVmdF9UZXh0XyR7cGlkfQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBVcHBlcl9MZWZ0X1RleHRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzUsIC01LjVdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFsyMDAsIDE3XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXJMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC44MzUzLCAwLjkyMTYsIDAuOTc2NV0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5CbHVyLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5icmFuZGluZy50aXRsZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFswLjY3ODQsIDAuOTkyMiwgMC41MjU1XSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDksCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVXBwZXJfTGVmdF9UZXh0XzJfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFVwcGVyX0xlZnRfVGV4dF8yXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFs3LjI1LCAxMi41XSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbMjAwLCAxNi41XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5icmFuZGluZy5zdWJ0aXRsZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFswLjY3ODQsIDAuOTkyMiwgMC41MjU1XSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDksCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF0sCiAgICAgICAgfSk7CiAgICAgICAgaWYgKHVwcGVyTGVmdCkgcmVmcy5yb290cy5wdXNoKHVwcGVyTGVmdCk7CiAgICB9CgogICAgLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgLSBVcHBlci1MZWZ0IEhVRCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgLSBUb3AtQ2VudGVyIFBhbmVscyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIC0tLSBTdGF0aWMgSFVEOiBUb3AtY2VudGVyIHBhbmVscyAoVGVhbUxlZnQgLyBNaWRkbGUgLyBUZWFtUmlnaHQpIC0tLQogICAgewogICAgICAgIGNvbnN0IG1pZCA9IG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogQ29udGFpbmVyX1RvcE1pZGRsZV9Db3JlVUlfJHtwaWR9CiAgICAgICAgICAgIG5hbWU6IGBDb250YWluZXJfVG9wTWlkZGxlX0NvcmVVSV8ke3BpZH1gLAogICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgcG9zaXRpb246IFs5MDIuNzUsIDQ0Ljc1XSwKICAgICAgICAgICAgc2l6ZTogWzExNC41LCA3NF0sCiAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQ29sb3I6IFswLjAzMTQsIDAuMDQzMSwgMC4wNDMxXSwKICAgICAgICAgICAgYmdBbHBoYTogMC41LAogICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5CbHVyLAogICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFJvdW5kVGV4dF8ke3BpZH0KICAgICAgICAgICAgICAgICAgICBuYW1lOiBgUm91bmRUZXh0XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFs1LjUsIC0zXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbNzIuNSwgMjRdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFswLjIsIDAuMiwgMC4yXSwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kVGV4dCwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDE2LAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIEhlbHAvaW5zdHJ1Y3Rpb25zIHRleHQgc2hvd24gd2hlbiBlbmFibGVkIGZvciB0aGlzIHBsYXllcgogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBDb250YWluZXJfSGVscFRleHRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbLTE2NS41LCA5Ml0sIC8vWy0xMTYuNSwgOTJdCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzQ1MCwgMjBdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFsxLCAwLjk4ODIsIDAuNjExOF0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Tb2xpZCwKICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBIZWxwL2luc3RydWN0aW9ucyB0ZXh0IHNob3duIHdoZW4gZW5hYmxlZCBmb3IgdGhpcyBwbGF5ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBIZWxwVGV4dF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbNDUwLCAxNF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5oZWxwVGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzAuMjUxLCAwLjA5NDEsIDAuMDY2N10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFNsYXNoXyR7cGlkfQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBTbGFzaF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbNzAuNSwgLTNdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszMSwgMjFdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFswLjIsIDAuMiwgMC4yXSwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLnNsYXNoLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTYsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF0sCiAgICAgICAgfSk7CiAgICAgICAgaWYgKG1pZCkgcmVmcy5yb290cy5wdXNoKG1pZCk7CgogICAgICAgIGNvbnN0IHQxUGFuZWwgPSBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IENvbnRhaW5lcl9Ub3BMZWZ0X0NvcmVVSV8ke3BpZH0KICAgICAgICAgICAgbmFtZTogYENvbnRhaW5lcl9Ub3BMZWZ0X0NvcmVVSV8ke3BpZH1gLAogICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgcG9zaXRpb246IFs3ODMuODYsIDQ0Ljc1XSwKICAgICAgICAgICAgc2l6ZTogWzExNC41LCA3NF0sCiAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQ29sb3I6IFswLjQzOTIsIDAuOTIxNiwgMV0sCiAgICAgICAgICAgIGJnQWxwaGE6IDAuNSwKICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBUZWFtIG5hbWUgbGFiZWwgZm9yIFRlYW0gMSAobGVmdCBzaWRlKQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBUZWFtTGVmdF9OYW1lXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFsyMy4yNSwgLTNdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFs2OCwgMjRdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFswLjIsIDAuMiwgMC4yXSwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTEpLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTYsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVGVhbUxlZnRfUmVjb3JkXyR7cGlkfQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBUZWFtTGVmdF9SZWNvcmRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzI0LCAxNS41XSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbNjMsIDE0LjVdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFswLjIsIDAuMiwgMC4yXSwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kUmVjb3JkRm9ybWF0LCAwLCAwLCAwKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDExLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIERpc3BsYXkgdmFyaWFibGUgZm9yIHJvdW5kIHdpbnMgb24gVGVhbSAxIChsZWZ0IHNpZGUpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1MZWZ0X1dpbnNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzMxLCAyOV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzYzLCAxNC41XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMucm91bmRXaW5zLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTEsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gRGlzcGxheSB2YXJpYWJsZSBmb3Igcm91bmQga2lsbHMgb24gVGVhbSAxIChsZWZ0IHNpZGUpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1MZWZ0X1JvdW5kS2lsbHNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGluY3JlYXNlIFggdG8gbW92ZSByaWdodCwgaW5jcmVhc2UgWSB0byBtb3ZlIGRvd24KICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzI5LCA0Mi41XSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbNjMsIDE0LjVdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFswLjIsIDAuMiwgMC4yXSwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2Quc3RyaW5na2V5cy50d2wuaHVkLmxhYmVscy5yb3VuZEtpbGxzLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTEsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gRGlzcGxheSB2YXJpYWJsZSBmb3IgdG90YWwga2lsbHMgb24gVGVhbSAxIChsZWZ0IHNpZGUpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1MZWZ0X0tpbGxzXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFsyNi41LCA1Nl0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzYzLCAxNC41XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMudG90YWxLaWxscywKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDExLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgIH0pOwogICAgICAgIGlmICh0MVBhbmVsKSByZWZzLnJvb3RzLnB1c2godDFQYW5lbCk7CgogICAgICAgIGNvbnN0IHQyUGFuZWwgPSBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IENvbnRhaW5lcl9Ub3BSaWdodF9Db3JlVUlfJHtwaWR9CiAgICAgICAgICAgIG5hbWU6IGBDb250YWluZXJfVG9wUmlnaHRfQ29yZVVJXyR7cGlkfWAsCiAgICAgICAgICAgIHR5cGU6ICJDb250YWluZXIiLAogICAgICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICBwb3NpdGlvbjogWzEwMjEuNjQsIDQ0Ljc1XSwKICAgICAgICAgICAgc2l6ZTogWzExNC41LCA3NF0sCiAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQ29sb3I6IFsxLCAwLjUxMzcsIDAuMzgwNF0sCiAgICAgICAgICAgIGJnQWxwaGE6IDAuNSwKICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBUZWFtIG5hbWUgbGFiZWwgZm9yIFRlYW0gMiAocmlnaHQgc2lkZSkKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVGVhbVJpZ2h0X05hbWVfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzIzLjI1LCAtM10sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzY4LCAyNF0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogWzAuMiwgMC4yLCAwLjJdLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMiksCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxNiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBUZWFtUmlnaHRfUmVjb3JkXyR7cGlkfQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBUZWFtUmlnaHRfUmVjb3JkXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFsyNCwgMTUuNV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzYzLCAxNC41XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFJlY29yZEZvcm1hdCwgMCwgMCwgMCksCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBEaXNwbGF5IHZhcmlhYmxlIGZvciByb3VuZCB3aW5zIG9uIFRlYW0gMiAocmlnaHQgc2lkZSkKICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVGVhbVJpZ2h0X1dpbnNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzMxLCAyOV0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzYzLCAxNC41XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMucm91bmRXaW5zLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTEsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gRGlzcGxheSB2YXJpYWJsZSBmb3Igcm91bmQga2lsbHMgb24gVGVhbSAyIChyaWdodCBzaWRlKQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBUZWFtUmlnaHRfUm91bmRLaWxsc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgaW5jcmVhc2UgWCB0byBtb3ZlIHJpZ2h0LCBpbmNyZWFzZSBZIHRvIG1vdmUgZG93bgogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMzAsIDQyLjVdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFs2MywgMTQuNV0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogWzAuMiwgMC4yLCAwLjJdLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQubGFiZWxzLnJvdW5kS2lsbHMsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBEaXNwbGF5IHZhcmlhYmxlIGZvciB0b3RhbCBraWxscyBvbiBUZWFtIDIgKHJpZ2h0IHNpZGUpCiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFRlYW1SaWdodF9LaWxsc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMjYuNSwgNTZdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFs2MywgMTQuNV0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogWzAuMiwgMC4yLCAwLjJdLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQubGFiZWxzLnRvdGFsS2lsbHMsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXSwKICAgICAgICB9KTsKICAgIH0KCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIFRvcC1DZW50ZXIgUGFuZWxzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCiAgICAvLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIEFkbWluIEFjdGlvbiBDb3VudGVyIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgewogICAgICAgIC8vIEFkbWluIGFjdGlvbiBhdWRpdCBjb3VudGVyICh0b3AtcmlnaHQpCiAgICAgICAgY29uc3QgYXVkaXRDb3VudGVyID0gbW9kbGliLlBhcnNlVUkoewogICAgICAgICAgICBuYW1lOiBgQWRtaW5QYW5lbEFjdGlvbkNvdW50XyR7cGlkfWAsCiAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGluY3JlYXNlIFggdG8gbW92ZSByaWdodCwgaW5jcmVhc2UgWSB0byBtb3ZlIGRvd24KICAgICAgICAgICAgcG9zaXRpb246IFsyMCwgMjBdLAogICAgICAgICAgICBzaXplOiBbNjAsIDEyXSwKICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9uQ291bnRGb3JtYXQsIDApLAogICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICB0ZXh0U2l6ZTogMTAsCiAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXJSaWdodCwKICAgICAgICB9KTsKICAgICAgICBpZiAoYXVkaXRDb3VudGVyKSByZWZzLnJvb3RzLnB1c2goYXVkaXRDb3VudGVyKTsKICAgIH0KCiAgICByZWZzLmxlZnRSZWNvcmRUZXh0ID0gc2FmZUZpbmQoYFRlYW1MZWZ0X1JlY29yZF8ke3BpZH1gKTsKICAgIHJlZnMucmlnaHRSZWNvcmRUZXh0ID0gc2FmZUZpbmQoYFRlYW1SaWdodF9SZWNvcmRfJHtwaWR9YCk7CiAgICByZWZzLmFkbWluUGFuZWxBY3Rpb25Db3VudFRleHQgPSBzYWZlRmluZChgQWRtaW5QYW5lbEFjdGlvbkNvdW50XyR7cGlkfWApOwoKICAgIC8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBIVUQgQnVpbGQvRW5zdXJlIC0gQWRtaW4gQWN0aW9uIENvdW50ZXIgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKICAgIC8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBIVUQgQnVpbGQvRW5zdXJlIC0gQ291bnRlciBXaWRnZXRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLy8gLS0tIENvdW50ZXIgd2lkZ2V0cyAoZGlnaXRzKSAtLS0KICAgIHsKICAgICAgICBjb25zdCBta0NvdW50ZXIgPSAoCiAgICAgICAgICAgIGNvbnRhaW5lck5hbWU6IHN0cmluZywKICAgICAgICAgICAgdGV4dE5hbWU6IHN0cmluZywKICAgICAgICAgICAgcG9zOiBbbnVtYmVyLCBudW1iZXJdLAogICAgICAgICAgICBzaXplOiBbbnVtYmVyLCBudW1iZXJdLAogICAgICAgICAgICB0ZXh0U2l6ZTogbnVtYmVyCiAgICAgICAgKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJvb3QgPSBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgICAgICAgICBuYW1lOiBjb250YWluZXJOYW1lLAogICAgICAgICAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgICAgICAgICAgcG9zaXRpb246IHBvcywKICAgICAgICAgICAgICAgIHNpemU6IHNpemUsCiAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbMC4yLCAwLjIsIDAuMl0sCiAgICAgICAgICAgICAgICBiZ0FscGhhOiAxLAogICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0ZXh0TmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbc2l6ZVswXSwgc2l6ZVsxXV0sCiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogWzAuMiwgMC4yLCAwLjJdLAogICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsIDApLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogdGV4dFNpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAocm9vdCkgcmVmcy5yb290cy5wdXNoKHJvb3QpOwogICAgICAgICAgICByZXR1cm4gc2FmZUZpbmQodGV4dE5hbWUpOwogICAgICAgIH07CgogICAgICAgIHJlZnMucm91bmRDdXJUZXh0ID0gbWtDb3VudGVyKGBSb3VuZENvdW50ZXJDb250YWluZXJfJHtwaWR9YCwgYFJvdW5kQ291bnRlclRleHRfJHtwaWR9YCwgWzk3My45MywgNDIuNzVdLCBbMTMuOTUsIDE4LjE1XSwgMTYpOwogICAgICAgIHJlZnMucm91bmRNYXhUZXh0ID0gbWtDb3VudGVyKGBSb3VuZENvdW50ZXJNYXhDb250YWluZXJfJHtwaWR9YCwgYFJvdW5kQ291bnRlck1heFRleHRfJHtwaWR9YCwgWzk5MC4wMywgNDIuNzVdLCBbMTMuOTUsIDE4LjE1XSwgMTYpOwoKICAgICAgICByZWZzLmxlZnRXaW5zVGV4dCA9IG1rQ291bnRlcihgVGVhbUxlZnRfV2luc19Db3VudGVyXyR7cGlkfWAsIGBUZWFtTGVmdF9XaW5zX0NvdW50ZXJUZXh0XyR7cGlkfWAsIFs4MDMuMDMsIDcyLjFdLCBbMTMuOTUsIDE4LjE1XSwgMTEpOwogICAgICAgIHJlZnMucmlnaHRXaW5zVGV4dCA9IG1rQ291bnRlcihgVGVhbVJpZ2h0X1dpbnNfQ291bnRlcl8ke3BpZH1gLCBgVGVhbVJpZ2h0X1dpbnNfQ291bnRlclRleHRfJHtwaWR9YCwgWzEwMzkuNzYsIDcyLjFdLCBbMTMuOTUsIDE4LjE1XSwgMTEpOwoKICAgICAgICByZWZzLmxlZnRSb3VuZEtpbGxzVGV4dCA9IG1rQ291bnRlcihgVGVhbUxlZnRfUm91bmRLaWxsc19Db3VudGVyXyR7cGlkfWAsIGBUZWFtTGVmdF9Sb3VuZEtpbGxzX0NvdW50ZXJUZXh0XyR7cGlkfWAsIFs4MDMuMDMsIDg1Ljc3XSwgWzEzLjk1LCAxOC4xNV0sIDExKTsKICAgICAgICByZWZzLnJpZ2h0Um91bmRLaWxsc1RleHQgPSBta0NvdW50ZXIoYFRlYW1SaWdodF9Sb3VuZEtpbGxzX0NvdW50ZXJfJHtwaWR9YCwgYFRlYW1SaWdodF9Sb3VuZEtpbGxzX0NvdW50ZXJUZXh0XyR7cGlkfWAsIFsxMDM5Ljc2LCA4NS43N10sIFsxMy45NSwgMTguMTVdLCAxMSk7CgogICAgICAgIHJlZnMubGVmdEtpbGxzVGV4dCA9IG1rQ291bnRlcihgVGVhbUxlZnRfS2lsbHNfQ291bnRlcl8ke3BpZH1gLCBgVGVhbUxlZnRfS2lsbHNfQ291bnRlclRleHRfJHtwaWR9YCwgWzgwMy4wMywgOTkuNDRdLCBbMTMuOTUsIDE4LjE1XSwgMTEpOwogICAgICAgIHJlZnMucmlnaHRLaWxsc1RleHQgPSBta0NvdW50ZXIoYFRlYW1SaWdodF9LaWxsc19Db3VudGVyXyR7cGlkfWAsIGBUZWFtUmlnaHRfS2lsbHNfQ291bnRlclRleHRfJHtwaWR9YCwgWzEwMzkuNzYsIDk5LjQ0XSwgWzEzLjk1LCAxOC4xNV0sIDExKTsKICAgIH0KCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIENvdW50ZXIgV2lkZ2V0cyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgLSBSb3VuZC1FbmQgRGlhbG9nIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLy9Db2RlIENsZWFudXA6IE5lZWQgdG8gcmVkdWNlIHJlZHVuZGFudCBjb21tZW50cywgYW5kIHdoZW4gbWFudWFsbHkgYWRqdXN0aW5nIHBvc2l0aW9uL3NpemVzIHVwZGF0ZSBkaXJlY3Rpb25zIChlLmcuICtYIGlzIHJpZ2h0IG9yIGxlZnQpCiAgICB7CiAgICAgICAgY29uc3Qgcm91bmRFbmRNb2RhbCA9IG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogUm91bmRFbmREaWFsb2dSb290XyR7cGlkfQogICAgICAgICAgICBuYW1lOiBgUm91bmRFbmREaWFsb2dSb290XyR7cGlkfWAsCiAgICAgICAgICAgIHR5cGU6ICJDb250YWluZXIiLAogICAgICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICBwb3NpdGlvbjogWzAsIDE1MF0sCiAgICAgICAgICAgIHNpemU6IFszNjAsIDExMl0sCiAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQ29sb3I6IFtWSUNUT1JZX0JHX1JHQlswXSwgVklDVE9SWV9CR19SR0JbMV0sIFZJQ1RPUllfQkdfUkdCWzJdXSwKICAgICAgICAgICAgYmdBbHBoYTogMC45NSwKICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogUm91bmRFbmREaWFsb2dfUm91bmRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFJvdW5kRW5kRGlhbG9nX1JvdW5kXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCAxNF0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzM0MCwgMThdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJvdW5kRW5kLnJvdW5kTnVtYmVyLCBTdGF0ZS5yb3VuZC5jdXJyZW50KSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDE0LAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFJvdW5kRW5kRGlhbG9nX091dGNvbWVfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFJvdW5kRW5kRGlhbG9nX091dGNvbWVfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDQwXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbMzQwLCAyMl0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2Quc3RyaW5na2V5cy50d2wucm91bmRFbmQuZHJhdywKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDE4LAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFJvdW5kRW5kRGlhbG9nX1N1bW1hcnlSb3dfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFJvdW5kRW5kRGlhbG9nX1N1bW1hcnlSb3dfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgNzRdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszNDAsIDE4XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBSb3VuZEVuZERpYWxvZ19MZWZ0U3VtbWFyeV8ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBSb3VuZEVuZERpYWxvZ19MZWZ0U3VtbWFyeV8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbLTcyLCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNjAsIDE4XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQucm91bmRTdGF0ZUZvcm1hdCwgMCwgbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5sYWJlbHMucm91bmRLaWxscywgZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0xKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFtWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzBdLCBWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzFdLCBWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFJvdW5kRW5kRGlhbG9nX0NvbG9uXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFJvdW5kRW5kRGlhbG9nX0NvbG9uXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsyMCwgMThdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5jb2xvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogUm91bmRFbmREaWFsb2dfUmlnaHRTdW1tYXJ5XyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFJvdW5kRW5kRGlhbG9nX1JpZ2h0U3VtbWFyeV8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbNzIsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE2MCwgMThdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFN0YXRlRm9ybWF0LCAwLCBtb2Quc3RyaW5na2V5cy50d2wuaHVkLmxhYmVscy5yb3VuZEtpbGxzLCBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTIpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXSwKICAgICAgICB9KTsKCiAgICAgICAgcmVmcy5yb3VuZEVuZFJvb3QgPSByb3VuZEVuZE1vZGFsOwogICAgICAgIHJlZnMucm91bmRFbmRSb3VuZFRleHQgPSBzYWZlRmluZChgUm91bmRFbmREaWFsb2dfUm91bmRfJHtwaWR9YCk7CiAgICAgICAgcmVmcy5yb3VuZEVuZE91dGNvbWVUZXh0ID0gc2FmZUZpbmQoYFJvdW5kRW5kRGlhbG9nX091dGNvbWVfJHtwaWR9YCk7CiAgICAgICAgcmVmcy5yb3VuZEVuZExlZnRTdW1tYXJ5VGV4dCA9IHNhZmVGaW5kKGBSb3VuZEVuZERpYWxvZ19MZWZ0U3VtbWFyeV8ke3BpZH1gKTsKICAgICAgICByZWZzLnJvdW5kRW5kQ29sb25UZXh0ID0gc2FmZUZpbmQoYFJvdW5kRW5kRGlhbG9nX0NvbG9uXyR7cGlkfWApOwogICAgICAgIHJlZnMucm91bmRFbmRSaWdodFN1bW1hcnlUZXh0ID0gc2FmZUZpbmQoYFJvdW5kRW5kRGlhbG9nX1JpZ2h0U3VtbWFyeV8ke3BpZH1gKTsKICAgICAgICBpZiAocm91bmRFbmRNb2RhbCkgcmVmcy5yb290cy5wdXNoKHJvdW5kRW5kTW9kYWwpOwogICAgfQoKICAgIC8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBIVUQgQnVpbGQvRW5zdXJlIC0gUm91bmQtRW5kIERpYWxvZyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRCBCdWlsZC9FbnN1cmUgLSBWaWN0b3J5IERpYWxvZyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIHsKICAgICAgICBjb25zdCBtb2RhbCA9IG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ1Jvb3RfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nUm9vdF8ke3BpZH1gLAogICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgcG9zaXRpb246IFswLCAzMF0sCiAgICAgICAgICAgIHNpemU6IFszNjAsIDI5MF0sCiAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgIGJnQ29sb3I6IFtWSUNUT1JZX0JHX1JHQlswXSwgVklDVE9SWV9CR19SR0JbMV0sIFZJQ1RPUllfQkdfUkdCWzJdXSwKICAgICAgICAgICAgYmdBbHBoYTogMC45NSwKICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfSGVhZGVyMV8ke3BpZH0KICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfSGVhZGVyMV8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTRdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszNDAsIDIyXSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuYnJhbmRpbmcudGl0bGUsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxOCwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX0hlYWRlcjJfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfSGVhZGVyMl8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMzZdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszNDAsIDIyXSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuYnJhbmRpbmcuc3VidGl0bGUsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxOCwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1NjcmVlbnNob3RfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfU2NyZWVuc2hvdF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgNjJdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszNDAsIDE2XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnNjcmVlbnNob3RQcm9tcHQsCiAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMF0sCiAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1Jlc3RhcnRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfUmVzdGFydF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgODJdLAogICAgICAgICAgICAgICAgICAgIHNpemU6IFszNDAsIDE2XSwKICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJlc3RhcnRJbkZvcm1hdCwgTUFUQ0hfRU5EX0RFTEFZX1NFQ09ORFMpLAogICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19Ub3RhbFRpbWVSb3dfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVG90YWxUaW1lUm93XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDEwMl0sCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzM0MCwgMTZdLAogICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVG90YWxUaW1lTGFiZWxfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19Ub3RhbFRpbWVMYWJlbF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbLTQ1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxMzAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnRvdGFsTWF0Y2hUaW1lTGFiZWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVG90YWxUaW1lRGlnaXRzXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVG90YWxUaW1lRGlnaXRzXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzU1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxMjAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UaW1lSFRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1RpbWVIVF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbLTQ1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzEwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1RpbWVIT18ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVGltZUhPXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFstMzUsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suZGlnaXQsIDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVGltZUMxXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19UaW1lQzFfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWy0yNSwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxMCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5jb2xvbiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UaW1lTVRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1RpbWVNVF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbLTE1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzEwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1RpbWVNT18ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVGltZU1PXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFstNSwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxMCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5kaWdpdCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UaW1lQzJfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1RpbWVDMl8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbNSwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxMCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5jbG9jay5jb2xvbiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UaW1lU1RfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1RpbWVTVF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMTUsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suZGlnaXQsIDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVGltZVNPXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19UaW1lU09fJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzI1LCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzEwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmRpZ2l0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfUm91bmRzXyR7cGlkfQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1JvdW5kc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTIyXSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbMzQwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS5yb3VuZHNTdW1tYXJ5Rm9ybWF0LCAwLCAwKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfQWRtaW5BY3Rpb25zXyR7cGlkfQogICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX0FkbWluQWN0aW9uc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTM4XSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbMzQwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9uQ291bnRWaWN0b3J5Rm9ybWF0LCAwKSwKICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAwXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfVGVhbXNSb3dfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfVGVhbXNSb3dfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTU0XSwKICAgICAgICAgICAgICAgICAgICBzaXplOiBbMzQwLCA3MF0sCiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UZWFtTGVmdF8ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1RlYW1MZWZ0XyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWy04NSwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTYwLCAxMjJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0NvbG9yOiBbVklDVE9SWV9URUFNMV9CR19SR0JbMF0sIFZJQ1RPUllfVEVBTTFfQkdfUkdCWzFdLCBWSUNUT1JZX1RFQU0xX0JHX1JHQlsyXV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLjk1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19MZWZ0T3V0Y29tZV8ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfTGVmdE91dGNvbWVfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTUwLCAyMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS50ZWFtT3V0Y29tZUZvcm1hdCwgZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0xKSwgbW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkubG9zZXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFtWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzBdLCBWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzFdLCBWSUNUT1JZX1RFQU0xX1RFWFRfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfTGVmdFJlY29yZF8ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfTGVmdFJlY29yZF8ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMzBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTUwLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLnJvdW5kUmVjb3JkRm9ybWF0LCAwLCAwLCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbVklDVE9SWV9URUFNMV9URVhUX1JHQlswXSwgVklDVE9SWV9URUFNMV9URVhUX1JHQlsxXSwgVklDVE9SWV9URUFNMV9URVhUX1JHQlsyXV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDE4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX0xlZnRSb3VuZFdpbnNfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX0xlZnRSb3VuZFdpbnNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDUwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE1MCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkucm91bmRXaW5zRm9ybWF0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbVklDVE9SWV9URUFNMV9URVhUX1JHQlswXSwgVklDVE9SWV9URUFNMV9URVhUX1JHQlsxXSwgVklDVE9SWV9URUFNMV9URVhUX1JHQlsyXV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX0xlZnRSb3VuZExvc3Nlc18ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfTGVmdFJvdW5kTG9zc2VzXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCA2OF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kTG9zc2VzRm9ybWF0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbVklDVE9SWV9URUFNMV9URVhUX1JHQlswXSwgVklDVE9SWV9URUFNMV9URVhUX1JHQlsxXSwgVklDVE9SWV9URUFNMV9URVhUX1JHQlsyXV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX0xlZnRSb3VuZFRpZXNfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX0xlZnRSb3VuZFRpZXNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDg2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE1MCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkucm91bmRUaWVzRm9ybWF0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbVklDVE9SWV9URUFNMV9URVhUX1JHQlswXSwgVklDVE9SWV9URUFNMV9URVhUX1JHQlsxXSwgVklDVE9SWV9URUFNMV9URVhUX1JHQlsyXV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX0xlZnRUb3RhbEtpbGxzXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19MZWZ0VG90YWxLaWxsc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTA0XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE1MCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudG90YWxLaWxsc0Zvcm1hdCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTFfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19UZWFtUmlnaHRfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19UZWFtUmlnaHRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJDb250YWluZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbODUsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE2MCwgMTIyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogW1ZJQ1RPUllfVEVBTTJfQkdfUkdCWzBdLCBWSUNUT1JZX1RFQU0yX0JHX1JHQlsxXSwgVklDVE9SWV9URUFNMl9CR19SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMC45NSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLlNvbGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfUmlnaHRPdXRjb21lXyR7cGlkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBgVmljdG9yeURpYWxvZ19SaWdodE91dGNvbWVfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBbMTUwLCAyMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dExhYmVsOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudmljdG9yeS50ZWFtT3V0Y29tZUZvcm1hdCwgZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0yKSwgbW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkud2lucyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxOCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19SaWdodFJlY29yZF8ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfUmlnaHRSZWNvcmRfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDMwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE1MCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFJlY29yZEZvcm1hdCwgMCwgMCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxOCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19SaWdodFJvdW5kV2luc18ke3BpZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYFZpY3RvcnlEaWFsb2dfUmlnaHRSb3VuZFdpbnNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDUwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE1MCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkucm91bmRXaW5zRm9ybWF0LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dENvbG9yOiBbVklDVE9SWV9URUFNMl9URVhUX1JHQlswXSwgVklDVE9SWV9URUFNMl9URVhUX1JHQlsxXSwgVklDVE9SWV9URUFNMl9URVhUX1JHQlsyXV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFNpemU6IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVSSBlbGVtZW50OiBWaWN0b3J5RGlhbG9nX1JpZ2h0Um91bmRMb3NzZXNfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1JpZ2h0Um91bmRMb3NzZXNfJHtwaWR9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDY4XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE1MCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3Rvcnkucm91bmRMb3NzZXNGb3JtYXQsIDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFtWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzBdLCBWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzFdLCBWSUNUT1JZX1RFQU0yX1RFWFRfUkdCWzJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFscGhhOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U2l6ZTogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVJIGVsZW1lbnQ6IFZpY3RvcnlEaWFsb2dfUmlnaHRSb3VuZFRpZXNfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1JpZ2h0Um91bmRUaWVzXyR7cGlkfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJUZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCA4Nl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IFsxNTAsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC52aWN0b3J5LnJvdW5kVGllc0Zvcm1hdCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVUkgZWxlbWVudDogVmljdG9yeURpYWxvZ19SaWdodFRvdGFsS2lsbHNfJHtwaWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGBWaWN0b3J5RGlhbG9nX1JpZ2h0VG90YWxLaWxsc18ke3BpZH1gLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uOiBbeCwgeV0gb2Zmc2V0OyBkaXJlY3Rpb24gZGVwZW5kcyBvbiBhbmNob3IsIHNvIHZlcmlmeSB2aXN1YWxseSBpbi1nYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMTA0XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzE1MCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnZpY3RvcnkudG90YWxLaWxsc0Zvcm1hdCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRDb2xvcjogW1ZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMF0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMV0sIFZJQ1RPUllfVEVBTTJfVEVYVF9SR0JbMl1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxwaGE6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXSwKICAgICAgICB9KTsKCiAgICAgICAgaWYgKG1vZGFsKSByZWZzLnJvb3RzLnB1c2gobW9kYWwpOwoKICAgICAgICByZWZzLnZpY3RvcnlSb290ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dSb290XyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeVJlc3RhcnRUZXh0ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfUmVzdGFydF8ke3BpZH1gKTsKCiAgICAgICAgcmVmcy52aWN0b3J5VGltZUhvdXJzVGVucyA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX1RpbWVIVF8ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlUaW1lSG91cnNPbmVzID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfVGltZUhPXyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeVRpbWVNaW51dGVzVGVucyA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX1RpbWVNVF8ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlUaW1lTWludXRlc09uZXMgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19UaW1lTU9fJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5VGltZVNlY29uZHNUZW5zID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfVGltZVNUXyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeVRpbWVTZWNvbmRzT25lcyA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX1RpbWVTT18ke3BpZH1gKTsKCiAgICAgICAgcmVmcy52aWN0b3J5Um91bmRzU3VtbWFyeVRleHQgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19Sb3VuZHNfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5QWRtaW5BY3Rpb25zVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX0FkbWluQWN0aW9uc18ke3BpZH1gKTsKCiAgICAgICAgcmVmcy52aWN0b3J5TGVmdE91dGNvbWVUZXh0ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfTGVmdE91dGNvbWVfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5TGVmdFJvdW5kV2luc1RleHQgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19MZWZ0Um91bmRXaW5zXyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeUxlZnRSb3VuZExvc3Nlc1RleHQgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19MZWZ0Um91bmRMb3NzZXNfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5TGVmdFJvdW5kVGllc1RleHQgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19MZWZ0Um91bmRUaWVzXyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeUxlZnRUb3RhbEtpbGxzVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX0xlZnRUb3RhbEtpbGxzXyR7cGlkfWApOwoKICAgICAgICByZWZzLnZpY3RvcnlSaWdodE91dGNvbWVUZXh0ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfUmlnaHRPdXRjb21lXyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeVJpZ2h0Um91bmRXaW5zVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX1JpZ2h0Um91bmRXaW5zXyR7cGlkfWApOwogICAgICAgIHJlZnMudmljdG9yeVJpZ2h0Um91bmRMb3NzZXNUZXh0ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfUmlnaHRSb3VuZExvc3Nlc18ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlSaWdodFJvdW5kVGllc1RleHQgPSBzYWZlRmluZChgVmljdG9yeURpYWxvZ19SaWdodFJvdW5kVGllc18ke3BpZH1gKTsKICAgICAgICByZWZzLnZpY3RvcnlMZWZ0UmVjb3JkVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX0xlZnRSZWNvcmRfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5UmlnaHRSZWNvcmRUZXh0ID0gc2FmZUZpbmQoYFZpY3RvcnlEaWFsb2dfUmlnaHRSZWNvcmRfJHtwaWR9YCk7CiAgICAgICAgcmVmcy52aWN0b3J5UmlnaHRUb3RhbEtpbGxzVGV4dCA9IHNhZmVGaW5kKGBWaWN0b3J5RGlhbG9nX1JpZ2h0VG90YWxLaWxsc18ke3BpZH1gKTsKICAgIH0KCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIFZpY3RvcnkgRGlhbG9nIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCiAgICAvLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gSFVEIEJ1aWxkL0Vuc3VyZSAtIENhY2hlIEluaXQgKyBEZWZhdWx0cyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIHJlZnMuaGVscFRleHRDb250YWluZXIgPSBzYWZlRmluZChgQ29udGFpbmVyX0hlbHBUZXh0XyR7cGlkfWApOwogICAgU3RhdGUuaHVkQ2FjaGUuaHVkQnlQaWRbcGlkXSA9IHJlZnM7CgogICAgLy8gSW5pdGlhbGl6ZSB2aXNpYmxlIG51bWJlcnMgaW1tZWRpYXRlbHkKICAgIHNldENvdW50ZXJUZXh0KHJlZnMucm91bmRDdXJUZXh0LCBTdGF0ZS5yb3VuZC5jdXJyZW50KTsKICAgIHNldENvdW50ZXJUZXh0KHJlZnMucm91bmRNYXhUZXh0LCBTdGF0ZS5yb3VuZC5tYXgpOwogICAgc2V0Q291bnRlclRleHQocmVmcy5sZWZ0V2luc1RleHQsIFN0YXRlLm1hdGNoLndpbnNUMSk7CiAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJpZ2h0V2luc1RleHQsIFN0YXRlLm1hdGNoLndpbnNUMik7CgogICAgc2V0Q291bnRlclRleHQocmVmcy5sZWZ0Um91bmRLaWxsc1RleHQsIFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMpOwogICAgc2V0Q291bnRlclRleHQocmVmcy5yaWdodFJvdW5kS2lsbHNUZXh0LCBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzKTsKCiAgICAvLyBUb3RhbCBraWxscyBhcmUgdHJhY2tlZCBzZXBhcmF0ZWx5IGZyb20gR2FtZU1vZGVTY29yZSAod2hpY2ggaXMgdXNlZCBmb3IgbWF0Y2ggd2lucykKICAgIHNldENvdW50ZXJUZXh0KHJlZnMubGVmdEtpbGxzVGV4dCwgU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscyk7CiAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJpZ2h0S2lsbHNUZXh0LCBTdGF0ZS5zY29yZXMudDJUb3RhbEtpbGxzKTsKICAgIHNldEFkbWluUGFuZWxBY3Rpb25Db3VudFRleHQocmVmcy5hZG1pblBhbmVsQWN0aW9uQ291bnRUZXh0LCBTdGF0ZS5hZG1pbi5hY3Rpb25Db3VudCk7CgogICAgdXBkYXRlVmljdG9yeURpYWxvZ0ZvclBsYXllcihwbGF5ZXIsIGdldFJlbWFpbmluZ1NlY29uZHMoKSk7CgogICAgcmV0dXJuIHJlZnM7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBIVUQgQnVpbGQvRW5zdXJlIC0gQ2FjaGUgSW5pdCArIERlZmF1bHRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBIVUQgVXBkYXRlIEhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIHNldEh1ZFJvdW5kQ291bnRlcnNGb3JBbGxQbGF5ZXJzKGN1cjogbnVtYmVyLCBtYXg6IG51bWJlcik6IHZvaWQgewogICAgLy8gU2V0cyBhdXRob3JpdGF0aXZlIHJvdW5kIGN1cnJlbnQvbWF4IHZhbHVlcyBhbmQgc3luY3MgSFVEICsgUmVhZHkgZGlhbG9nICJCZXN0IG9mIi4KICAgIFN0YXRlLnJvdW5kLmN1cnJlbnQgPSBNYXRoLm1heCgxLCBNYXRoLmZsb29yKGN1cikpOwogICAgU3RhdGUucm91bmQubWF4ID0gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcihtYXgpKTsKICAgIGlmIChTdGF0ZS5yb3VuZC5tYXggPCBTdGF0ZS5yb3VuZC5jdXJyZW50KSB7CiAgICAgICAgU3RhdGUucm91bmQubWF4ID0gU3RhdGUucm91bmQuY3VycmVudDsKICAgIH0KCiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHJlZnMgPSBlbnN1cmVIdWRGb3JQbGF5ZXIocCk7CiAgICAgICAgaWYgKCFyZWZzKSBjb250aW51ZTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJvdW5kQ3VyVGV4dCwgU3RhdGUucm91bmQuY3VycmVudCk7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5yb3VuZE1heFRleHQsIFN0YXRlLnJvdW5kLm1heCk7CiAgICB9CgogICAgc2V0Um91bmRTdGF0ZVRleHRGb3JBbGxQbGF5ZXJzKCk7CiAgICAvLyBLZWVwIFJlYWR5IFVwIGRpYWxvZyAiQmVzdCBvZiIgbGFiZWwgaW4gc3luYyB3aXRoIFN0YXRlLnJvdW5kLm1heC4KICAgIHVwZGF0ZUJlc3RPZlJvdW5kc0xhYmVsRm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiBzZXRIdWRXaW5Db3VudGVyc0ZvckFsbFBsYXllcnModDFXaW5zOiBudW1iZXIsIHQyV2luczogbnVtYmVyKTogdm9pZCB7CiAgICAvLyBVcGRhdGVzIG1hdGNoIHdpbiBjb3VudGVycyBpbiBzY3JpcHQgc3RhdGUgYW5kIEdhbWVNb2RlU2NvcmUsIHRoZW4gcmVmcmVzaGVzIEhVRC4KICAgIGNvbnN0IGx3ID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcih0MVdpbnMpKTsKICAgIGNvbnN0IHJ3ID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcih0MldpbnMpKTsKCiAgICAvLyBNYXRjaCB3aW5zIGFyZSBhdXRob3JpdGF0aXZlIGluIHNjcmlwdCBzdGF0ZTsgR2FtZU1vZGVTY29yZSBpcyBtaXJyb3JlZCBmb3Igc2NvcmVib2FyZCBkaXNwbGF5LgogICAgc2V0TWF0Y2hXaW5zVGVhbShUZWFtSUQuVGVhbTEsIGx3KTsKICAgIHNldE1hdGNoV2luc1RlYW0oVGVhbUlELlRlYW0yLCBydyk7CgogICAgLy8gQ2FjaGUgbG9jYWxseSBmb3IgaW1tZWRpYXRlIFVJICsgbG9naWMuCiAgICBTdGF0ZS5tYXRjaC53aW5zVDEgPSBsdzsKICAgIFN0YXRlLm1hdGNoLndpbnNUMiA9IHJ3OwoKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcmVmcyA9IGVuc3VyZUh1ZEZvclBsYXllcihwKTsKICAgICAgICBpZiAoIXJlZnMpIGNvbnRpbnVlOwogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMubGVmdFdpbnNUZXh0LCBsdyk7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5yaWdodFdpbnNUZXh0LCBydyk7CiAgICB9CgogICAgc3luY1JvdW5kUmVjb3JkSHVkRm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiBzeW5jUm91bmRSZWNvcmRIdWRGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgLy8gRGVyaXZlcyBsb3NzZXMgZnJvbSB3aW5zL3RpZXMgYW5kIHN5bmNzIHRoZSBSb3VuZCBSZWNvcmQgSFVEIGZvciBib3RoIHRlYW1zLgogICAgLy8gTG9zc2VzIGFyZSBkZXJpdmVkIGZyb20gdGhlIG9wcG9uZW50J3Mgd2luIGNvdW50IHdoZW4gcm91bmRzIGVuZCB3aXRoIGEgc2luZ2xlIHdpbm5lci4KICAgIFN0YXRlLm1hdGNoLmxvc3Nlc1QxID0gU3RhdGUubWF0Y2gud2luc1QyOwogICAgU3RhdGUubWF0Y2gubG9zc2VzVDIgPSBTdGF0ZS5tYXRjaC53aW5zVDE7CgogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCByZWZzID0gZW5zdXJlSHVkRm9yUGxheWVyKHApOwogICAgICAgIGlmICghcmVmcykgY29udGludWU7CiAgICAgICAgc2V0Um91bmRSZWNvcmRUZXh0KHJlZnMubGVmdFJlY29yZFRleHQsIFN0YXRlLm1hdGNoLndpbnNUMSwgU3RhdGUubWF0Y2gubG9zc2VzVDEsIFN0YXRlLm1hdGNoLnRpZXNUMSk7CiAgICAgICAgc2V0Um91bmRSZWNvcmRUZXh0KHJlZnMucmlnaHRSZWNvcmRUZXh0LCBTdGF0ZS5tYXRjaC53aW5zVDIsIFN0YXRlLm1hdGNoLmxvc3Nlc1QyLCBTdGF0ZS5tYXRjaC50aWVzVDIpOwogICAgfQp9CgpmdW5jdGlvbiBhZGp1c3RNYXRjaFRpZXNGb3JCb3RoVGVhbXMoZGVsdGE6IG51bWJlcik6IHZvaWQgewogICAgLy8gQXBwbGllcyBhIGRlbHRhIHRvIG1hdGNoIHRpZXMgZm9yIGJvdGggdGVhbXMgYW5kIHJlZnJlc2hlcyB0aGUgUm91bmQgUmVjb3JkIEhVRC4KICAgIGNvbnN0IGN1cnJlbnQgPSBNYXRoLm1pbihTdGF0ZS5tYXRjaC50aWVzVDEsIFN0YXRlLm1hdGNoLnRpZXNUMik7CiAgICBjb25zdCBuZXh0ID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihjdXJyZW50ICsgZGVsdGEpKTsKICAgIFN0YXRlLm1hdGNoLnRpZXNUMSA9IG5leHQ7CiAgICBTdGF0ZS5tYXRjaC50aWVzVDIgPSBuZXh0OwogICAgc3luY1JvdW5kUmVjb3JkSHVkRm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiB1cGRhdGVBZG1pblBhbmVsQWN0aW9uQ291bnRGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgLy8gUHVzaGVzIHRoZSBhZG1pbiBhY3Rpb24gY291bnQgdG8gZXZlcnkgcGxheWVyJ3MgSFVEIHdpZGdldC4KICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcmVmcyA9IGVuc3VyZUh1ZEZvclBsYXllcihwKTsKICAgICAgICBpZiAoIXJlZnMpIGNvbnRpbnVlOwogICAgICAgIHNldEFkbWluUGFuZWxBY3Rpb25Db3VudFRleHQocmVmcy5hZG1pblBhbmVsQWN0aW9uQ291bnRUZXh0LCBTdGF0ZS5hZG1pbi5hY3Rpb25Db3VudCk7CiAgICB9Cn0KCmZ1bmN0aW9uIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsIGFjdGlvbktleTogbnVtYmVyKTogdm9pZCB7CiAgICAvLyBJbmNyZW1lbnRzIHRoZSBhZG1pbiBhY3Rpb24gY291bnRlciBhbmQgYnJvYWRjYXN0cyB0aGUgYWN0aW9uIHRvIHRoZSB3b3JsZCBsb2cuCiAgICBTdGF0ZS5hZG1pbi5hY3Rpb25Db3VudCA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IoU3RhdGUuYWRtaW4uYWN0aW9uQ291bnQpICsgMSk7CiAgICB1cGRhdGVBZG1pblBhbmVsQWN0aW9uQ291bnRGb3JBbGxQbGF5ZXJzKCk7CiAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UobW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9uUHJlc3NlZCwgZXZlbnRQbGF5ZXIsIGFjdGlvbktleSksIHRydWUpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gSFVEIFVwZGF0ZSBIZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBMZWdhY3kgVUkgQ2xlYW51cCAob2xkIHNjb3JlX3Jvb3RfKiBjb250YWluZXJzKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gQ29kZSBDbGVhbnVwOiBJcyB0aGlzIHN0aWxsIG5lZWRlZD8/PwpmdW5jdGlvbiBkZWxldGVMZWdhY3lTY29yZVJvb3RGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBjb25zdCBuYW1lID0gInNjb3JlX3Jvb3RfIiArIGdldE9iaklkKHBsYXllcik7CiAgICB0cnkgewogICAgICAgIG1vZC5EZWxldGVVSVdpZGdldChtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUobmFtZSkpOwogICAgfSBjYXRjaCB7IH0KfQoKZnVuY3Rpb24gZGVsZXRlTGVnYWN5U2NvcmVSb290c0ZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXApIGNvbnRpbnVlOwogICAgICAgIGlmICghbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGRlbGV0ZUxlZ2FjeVNjb3JlUm9vdEZvclBsYXllcihwKTsKICAgIH0KfQovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gTGVnYWN5IFVJIENsZWFudXAgKG9sZCBzY29yZV9yb290XyogY29udGFpbmVycykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFBvcnRhbCBBcnJheSBIZWxwZXJzIChlbmdpbmUgYXJyYXlzKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gYXJyYXlDb250YWluc1ZlaGljbGUoYXJyOiBhbnksIHZlaGljbGU6IG1vZC5WZWhpY2xlKTogYm9vbGVhbiB7CiAgICByZXR1cm4gbW9kbGliLklzVHJ1ZUZvckFueShhcnIsIChlbDogYW55KSA9PiBtb2QuRXF1YWxzKGVsLCB2ZWhpY2xlKSk7Cn0KCmZ1bmN0aW9uIGFycmF5UmVtb3ZlVmVoaWNsZShhcnI6IGFueSwgdmVoaWNsZTogbW9kLlZlaGljbGUpOiBhbnkgewogICAgLy8gRmlsdGVyZWRBcnJheSBtdXN0IHJlbWFpbiBzdGFibGUgYWNyb3NzIGVuZ2luZSB1cGRhdGVzOyByZWdpc3RyeSBjb3JyZWN0bmVzcyBkZXBlbmRzIG9uIGl0LgogICAgcmV0dXJuIG1vZGxpYi5GaWx0ZXJlZEFycmF5KGFyciwgKGVsOiBhbnkpID0+IG1vZC5Ob3RFcXVhbFRvKGVsLCB2ZWhpY2xlKSk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBQb3J0YWwgQXJyYXkgSGVscGVycyAoZW5naW5lIGFycmF5cykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFZlaGljbGUgT3duZXJzaGlwIFRyYWNraW5nICh2ZWhJZHMvdmVoT3duZXJzKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBWZWhpY2xlIG93bmVyIGNhY2hlIGxpZmVjeWNsZToKLy8gLSBzZXRMYXN0RHJpdmVyIG9uIGVudHJ5LCBwb3BMYXN0RHJpdmVyIG9uIGRlc3RydWN0aW9uLCBjbGVhckxhc3REcml2ZXJCeVZlaGljbGVPYmpJZCBvbiBzcGF3bi9yZXNwYXduLgoKZnVuY3Rpb24gZ2V0VmVoaWNsZUlkKHY6IG1vZC5WZWhpY2xlKTogbnVtYmVyIHsgcmV0dXJuIGdldE9iaklkKHYpOyB9CgpmdW5jdGlvbiBnZXRMYXN0RHJpdmVyKHZlaGljbGU6IG1vZC5WZWhpY2xlKTogbW9kLlBsYXllciB7CiAgICBjb25zdCB2aWQgPSBnZXRWZWhpY2xlSWQodmVoaWNsZSk7CiAgICAvLyBMaW5lYXIgc2NhbiBvZiB0aGUgY2FjaGVkIHZlaGljbGUtaWQgbGlzdCB0byBmaW5kIGl0cyBsYXN0IGtub3duIGRyaXZlci4KICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVoSWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgLy8gUGFyYWxsZWwgYXJyYXlzOiB2ZWhJZHNbaV0gbWFwcyB0byB2ZWhPd25lcnNbaV0uCiAgICAgICAgaWYgKHZlaElkc1tpXSA9PT0gdmlkKSByZXR1cm4gdmVoT3duZXJzW2ldOwogICAgfQogICAgLy8gTm8gY2FjaGVkIGVudHJ5IGZvdW5kLgogICAgcmV0dXJuIHVuZGVmaW5lZCBhcyBhbnk7Cn0KCmZ1bmN0aW9uIHNldExhc3REcml2ZXIodmVoaWNsZTogbW9kLlZlaGljbGUsIHBsYXllcjogbW9kLlBsYXllcik6IHZvaWQgewogICAgY29uc3QgdmlkID0gZ2V0VmVoaWNsZUlkKHZlaGljbGUpOwogICAgLy8gVXBkYXRlIGV4aXN0aW5nIGVudHJ5IGlmIHRoaXMgdmVoaWNsZSBpcyBhbHJlYWR5IHRyYWNrZWQuCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZlaElkcy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmICh2ZWhJZHNbaV0gPT09IHZpZCkgewogICAgICAgICAgICB2ZWhPd25lcnNbaV0gPSBwbGF5ZXI7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CiAgICAvLyBGaXJzdCB0aW1lIHdlIHNlZSB0aGlzIHZlaGljbGU6IGFwcGVuZCB0byB0aGUgcGFyYWxsZWwgYXJyYXlzLgogICAgdmVoSWRzLnB1c2godmlkKTsKICAgIHZlaE93bmVycy5wdXNoKHBsYXllcik7Cn0KCmZ1bmN0aW9uIHBvcExhc3REcml2ZXIodmVoaWNsZTogbW9kLlZlaGljbGUpOiBtb2QuUGxheWVyIHsKICAgIGNvbnN0IHZpZCA9IGdldFZlaGljbGVJZCh2ZWhpY2xlKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZlaElkcy5sZW5ndGg7IGkrKykgewogICAgICAgIC8vIEZpbmQgdGhlIHZlaGljbGUgZW50cnksIHJldHVybiBpdHMgb3duZXIsIHRoZW4gcmVtb3ZlIGl0IGZyb20gdGhlIGNhY2hlLgogICAgICAgIGlmICh2ZWhJZHNbaV0gPT09IHZpZCkgewogICAgICAgICAgICBjb25zdCBvd25lciA9IHZlaE93bmVyc1tpXTsKCiAgICAgICAgICAgIC8vIFN3YXAtcmVtb3ZlIHRvIGF2b2lkIHNoaWZ0aW5nIHRoZSBhcnJheXMuCiAgICAgICAgICAgIGNvbnN0IGxhc3RJZHggPSB2ZWhJZHMubGVuZ3RoIC0gMTsKICAgICAgICAgICAgdmVoSWRzW2ldID0gdmVoSWRzW2xhc3RJZHhdOwogICAgICAgICAgICB2ZWhPd25lcnNbaV0gPSB2ZWhPd25lcnNbbGFzdElkeF07CiAgICAgICAgICAgIHZlaElkcy5wb3AoKTsKICAgICAgICAgICAgdmVoT3duZXJzLnBvcCgpOwoKICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSByZW1vdmVkIG93bmVyIChjYWxsZXIgbWF5IHVzZSBmb3IgbWVzc2FnaW5nKS4KICAgICAgICAgICAgcmV0dXJuIG93bmVyOwogICAgICAgIH0KICAgIH0KICAgIC8vIE5vIGNhY2hlZCBlbnRyeSBmb3VuZC4KICAgIHJldHVybiB1bmRlZmluZWQgYXMgYW55Owp9CgpmdW5jdGlvbiBjbGVhckxhc3REcml2ZXJCeVZlaGljbGVPYmpJZCh2ZWhpY2xlT2JqSWQ6IG51bWJlcik6IHZvaWQgewogICAgLy8gUmVtb3ZlIHRoZSBsYXN0LWRyaXZlciBlbnRyeSBmb3IgYSBzcGVjaWZpYyB2ZWhpY2xlIE9iaklkIChpZiBpdCBleGlzdHMpLgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZWhJZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBGaW5kIHRoZSBtYXRjaGluZyB2ZWhpY2xlIGlkIGluIHRoZSBwYXJhbGxlbCBhcnJheXMuCiAgICAgICAgaWYgKHZlaElkc1tpXSA9PT0gdmVoaWNsZU9iaklkKSB7CiAgICAgICAgICAgIC8vIFN3YXAtcmVtb3ZlIHRvIGtlZXAgYXJyYXlzIGNvbXBhY3Qgd2l0aG91dCBwcmVzZXJ2aW5nIG9yZGVyLgogICAgICAgICAgICBjb25zdCBsYXN0SWR4ID0gdmVoSWRzLmxlbmd0aCAtIDE7CiAgICAgICAgICAgIHZlaElkc1tpXSA9IHZlaElkc1tsYXN0SWR4XTsKICAgICAgICAgICAgdmVoT3duZXJzW2ldID0gdmVoT3duZXJzW2xhc3RJZHhdOwogICAgICAgICAgICB2ZWhJZHMucG9wKCk7CiAgICAgICAgICAgIHZlaE93bmVycy5wb3AoKTsKICAgICAgICAgICAgLy8gRG9uZTogdGhlcmUgaXMgbm8gbG9uZ2VyIGEgY2FjaGVkIG93bmVyIGZvciB0aGlzIHZlaGljbGUuCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBWZWhpY2xlIE93bmVyc2hpcCBUcmFja2luZyAodmVoSWRzL3ZlaE93bmVycykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFZlaGljbGUgUmVnaXN0cmF0aW9uICh0ZWFtIGFycmF5cykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIFJlZ2lzdGVycyB2ZWhpY2xlIG93bmVyc2hpcCB0byBhIHRlYW0gZm9yIGtpbGwgYXR0cmlidXRpb24uCi8vIElNUE9SVEFOVDoKLy8gLSBWZWhpY2xlIElEIGFuZCBvd25pbmcgdGVhbSBtdXN0IHN0YXkgaW4gc3luYwovLyAtIFJlYXNzaWdubWVudHMgbXVzdCBvdmVyd3JpdGUgcHJldmlvdXMgb3duZXJzaGlwCgpmdW5jdGlvbiByZWdpc3RlclZlaGljbGVUb1RlYW0odmVoaWNsZTogbW9kLlZlaGljbGUsIHRlYW1OdW06IFRlYW1JRCk6IHZvaWQgewogICAgLy8gRW5zdXJlIHRoZSB2ZWhpY2xlIGV4aXN0cyBpbiBleGFjdGx5IG9uZSByZWdpc3RyeSBieSByZW1vdmluZyBpdCBmcm9tIGJvdGggZmlyc3QuCiAgICBtb2QuU2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMSwgYXJyYXlSZW1vdmVWZWhpY2xlKG1vZC5HZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0xKSwgdmVoaWNsZSkpOwogICAgbW9kLlNldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTIsIGFycmF5UmVtb3ZlVmVoaWNsZShtb2QuR2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMiksIHZlaGljbGUpKTsKCiAgICAvLyBBcHBlbmQgdGhlIHZlaGljbGUgdG8gdGhlIGNob3NlbiB0ZWFtJ3MgcmVnaXN0cnkgYXJyYXkuCiAgICBpZiAodGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSB7CiAgICAgICAgbW9kLlNldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTEsIG1vZC5BcHBlbmRUb0FycmF5KG1vZC5HZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0xKSwgdmVoaWNsZSkpOwogICAgfSBlbHNlIGlmICh0ZWFtTnVtID09PSBUZWFtSUQuVGVhbTIpIHsKICAgICAgICBtb2QuU2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMiwgbW9kLkFwcGVuZFRvQXJyYXkobW9kLkdldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTIpLCB2ZWhpY2xlKSk7CiAgICB9Cn0KCi8qIERlYWQgZnVuY3Rpb24sIG5vdCB1c2VkIGFueW1vcmUgLSBjYW4gcmVtb3ZlPwpmdW5jdGlvbiBkZXJlZ2lzdGVyVmVoaWNsZUZyb21BbGxUZWFtcyh2ZWhpY2xlOiBtb2QuVmVoaWNsZSk6IHZvaWQgewogICAgbW9kLlNldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTEsIGFycmF5UmVtb3ZlVmVoaWNsZShtb2QuR2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMSksIHZlaGljbGUpKTsKICAgIG1vZC5TZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0yLCBhcnJheVJlbW92ZVZlaGljbGUobW9kLkdldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTIpLCB2ZWhpY2xlKSk7Cn0KICovCgpmdW5jdGlvbiBjbGVhclNwYXduQmFzZVRlYW1DYWNoZSgpOiB2b2lkIHsKICAgIGZvciAoY29uc3QgayBpbiB2ZWhpY2xlU3Bhd25CYXNlVGVhbUJ5T2JqSWQpIGRlbGV0ZSB2ZWhpY2xlU3Bhd25CYXNlVGVhbUJ5T2JqSWRbayBhcyBhbnldOwp9CgpmdW5jdGlvbiBpbmZlckJhc2VUZWFtRnJvbVBvc2l0aW9uKHBvczogbW9kLlZlY3Rvcik6IFRlYW1JRCB8IDAgewogICAgY29uc3QgZDEgPSBtb2QuRGlzdGFuY2VCZXR3ZWVuKHBvcywgTUFJTl9CQVNFX1RFQU0xX1BPUyk7IC8vIERpc3RhbmNlIGZyb20gdmVoaWNsZSB0byBUZWFtIDEgYmFzZSBhbmNob3IuCiAgICBjb25zdCBkMiA9IG1vZC5EaXN0YW5jZUJldHdlZW4ocG9zLCBNQUlOX0JBU0VfVEVBTTJfUE9TKTsgLy8gRGlzdGFuY2UgZnJvbSB2ZWhpY2xlIHRvIFRlYW0gMiBiYXNlIGFuY2hvci4KICAgIGNvbnN0IGJlc3QgPSBkMSA8PSBkMiA/IFRlYW1JRC5UZWFtMSA6IFRlYW1JRC5UZWFtMjsgLy8gUGljayB0aGUgbmVhcmVyIGJhc2UgYXMgdGhlIGluZmVycmVkIHRlYW0uCiAgICBjb25zdCBiZXN0RGlzdCA9IGQxIDw9IGQyID8gZDEgOiBkMjsgLy8gVHJhY2sgdGhlIGRpc3RhbmNlIHRvIHRoYXQgbmVhcmVzdCBiYXNlLgoKICAgIGlmIChiZXN0RGlzdCA+IE1BSU5fQkFTRV9CSU5EX1JBRElVU19NRVRFUlMpIHsgLy8gT3V0c2lkZSBiaW5kIHJhZGl1czogdHJlYXQgYXMgdW5hc3NpZ25lZC4KICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICByZXR1cm4gYmVzdDsgLy8gV2l0aGluIHJhZGl1czogcmV0dXJuIHRoZSBpbmZlcnJlZCB0ZWFtIGlkLgp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gVmVoaWNsZSBSZWdpc3RyYXRpb24gKHRlYW0gYXJyYXlzKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gVmVoaWNsZSBTcGF3bmVyIFN5c3RlbSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gVmVoaWNsZSBTcGF3bmVyIFN5c3RlbSBhcmNoaXRlY3R1cmU6Ci8vIC0gU2xvdCA9ICh0ZWFtLCBzbG90TnVtYmVyLCBzcGF3bmVyLCBkZXNpcmVkIHZlaGljbGUgdHlwZSwgbGl2ZSBzdGF0ZSkuCi8vIC0gRW5hYmxlbWVudCBpcyB0aWVkIHRvIG1hdGNodXAgcHJlc2V0cyBhbmQgb25seSBhcHBsaWVzIHdoZW4gdGhlIHJvdW5kIGlzIE5PVCBsaXZlLgovLyAtIFNwYXducyBhcmUgZm9yY2VkIHNlcXVlbnRpYWxseSB0byBhdm9pZCBjcm9zcy1iaW5kaW5nIGJldHdlZW4gc3Bhd25lcnMuCi8vIC0gU3Bhd24gYmluZGluZyBpcyBwb3NpdGlvbi1iYXNlZDogdGhlIGZpcnN0IGV4cGVjdGluZyBzbG90IHdpdGhpbiBiaW5kIGRpc3RhbmNlIGNsYWltcyB0aGUgdmVoaWNsZS4KLy8gLSBEaXNhYmxlZCBzbG90cyBuZXZlciByZXNwYXduOyBleGlzdGluZyB2ZWhpY2xlcyBhcmUgbGVmdCBhbG9uZSB1bnRpbCBkZXN0cm95ZWQuCi8vIC0gQWxsIGRlbGF5ZWQgd29yayBpcyB0b2tlbi1nYXRlZCBzbyBzdGFsZSB0aW1lcnMvc2VxdWVuY2VzIGFib3J0IHdoZW4gc2xvdHMgY2hhbmdlLgoKLy8gRWFjaCBzcGF3bmVyIGlzIGNvbmZpZ3VyZWQgb25jZSBvbiBjcmVhdGlvbiB3aXRoIGl0cyB2ZWhpY2xlIHR5cGUgYW5kIGFiYW5kb25tZW50L3Jlc3Bhd24gcGFyYW1ldGVycy4KZnVuY3Rpb24gY29uZmlndXJlVmVoaWNsZVNwYXduZXIoc3Bhd25lcjogbW9kLlZlaGljbGVTcGF3bmVyLCB2ZWhpY2xlVHlwZTogbW9kLlZlaGljbGVMaXN0KTogdm9pZCB7CiAgICAvLyBTcGF3bmVyIHNldHRpbmdzIGFyZSB0dW5lZCBmb3IgY29uc2lzdGVudCByZXNwYXduIGJlaGF2aW9yOyBhZGp1c3Qgd2l0aCBjYXV0aW9uLgogICAgbW9kLlNldFZlaGljbGVTcGF3bmVyVmVoaWNsZVR5cGUoc3Bhd25lciwgdmVoaWNsZVR5cGUpOwogICAgbW9kLlNldFZlaGljbGVTcGF3bmVyQXV0b1NwYXduKHNwYXduZXIsIGZhbHNlKTsKICAgIG1vZC5TZXRWZWhpY2xlU3Bhd25lclJlc3Bhd25UaW1lKHNwYXduZXIsIFZFSElDTEVfU1BBV05FUl9SRVNQQVdOX0RFTEFZX1NFQ09ORFMpOwogICAgbW9kLlNldFZlaGljbGVTcGF3bmVyQXBwbHlEYW1hZ2VUb0FiYW5kb25WZWhpY2xlKHNwYXduZXIsIHRydWUpOwogICAgbW9kLlNldFZlaGljbGVTcGF3bmVyQWJhbmRvblZlaGljbGVzT3V0T2ZDb21iYXRBcmVhKHNwYXduZXIsIHRydWUpOwogICAgbW9kLlNldFZlaGljbGVTcGF3bmVyVGltZVVudGlsQWJhbmRvbihzcGF3bmVyLCBWRUhJQ0xFX1NQQVdORVJfVElNRV9VTlRJTF9BQkFORE9OX1NFQ09ORFMpOwogICAgbW9kLlNldFZlaGljbGVTcGF3bmVyS2VlcEFsaXZlQWJhbmRvblJhZGl1cyhzcGF3bmVyLCBWRUhJQ0xFX1NQQVdORVJfS0VFUF9BTElWRV9BQkFORE9OX1JBRElVUyk7CiAgICBtb2QuU2V0VmVoaWNsZVNwYXduZXJLZWVwQWxpdmVTcGF3bmVyUmFkaXVzKHNwYXduZXIsIFZFSElDTEVfU1BBV05FUl9LRUVQX0FMSVZFX1NQQVdORVJfUkFESVVTKTsKfQoKLy8gUG9sbCBoZWxwZXI6IHJldHVybnMgdW5kZWZpbmVkIGlmIHRoZSB2ZWhpY2xlIG5vIGxvbmdlciBleGlzdHMgKGRlc3Ryb3llZC91bnNwYXduZWQvT09CKS4KZnVuY3Rpb24gZmluZFZlaGljbGVCeUlkKHZlaGljbGVJZDogbnVtYmVyKTogbW9kLlZlaGljbGUgfCB1bmRlZmluZWQgewogICAgY29uc3QgdmVoaWNsZXMgPSBtb2QuQWxsVmVoaWNsZXMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YodmVoaWNsZXMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgdiA9IG1vZC5WYWx1ZUluQXJyYXkodmVoaWNsZXMsIGkpIGFzIG1vZC5WZWhpY2xlOwogICAgICAgIGlmIChtb2QuR2V0T2JqSWQodikgPT09IHZlaGljbGVJZCkgcmV0dXJuIHY7CiAgICB9CiAgICByZXR1cm4gdW5kZWZpbmVkOwp9CgovLyBDcmVhdGVzIGEgc3Bhd25lciBvYmplY3QsIGFwcGxpZXMgbWFwLXNwZWNpZmljIHlhdywgY29uZmlndXJlcyB2ZWhpY2xlIHR5cGUsIGFuZCByZWdpc3RlcnMgdGhlIHNsb3Qgc3RhdGUuCmZ1bmN0aW9uIGFkZFZlaGljbGVTcGF3bmVyU2xvdCh0ZWFtSWQ6IFRlYW1JRCwgc2xvdE51bWJlcjogbnVtYmVyLCBzcGF3blBvczogbW9kLlZlY3Rvciwgc3Bhd25Sb3Q6IG1vZC5WZWN0b3IsIHZlaGljbGVUeXBlOiBtb2QuVmVoaWNsZUxpc3QpOiBudW1iZXIgewogICAgY29uc3QgeWF3ID0gbW9kLllDb21wb25lbnRPZihzcGF3blJvdCkgKyBWRUhJQ0xFX1NQQVdOX1lBV19PRkZTRVRfREVHOwogICAgY29uc3Qgc3Bhd25lclJvdCA9IG1vZC5DcmVhdGVWZWN0b3IobW9kLlhDb21wb25lbnRPZihzcGF3blJvdCksIHlhdywgbW9kLlpDb21wb25lbnRPZihzcGF3blJvdCkpOwogICAgY29uc3Qgc3Bhd25lciA9IG1vZC5TcGF3bk9iamVjdCgKICAgICAgICBtb2QuUnVudGltZVNwYXduX0NvbW1vbi5WZWhpY2xlU3Bhd25lciwKICAgICAgICBzcGF3blBvcywKICAgICAgICBzcGF3bmVyUm90CiAgICApIGFzIG1vZC5WZWhpY2xlU3Bhd25lcjsKCiAgICAvLyBEaXNhYmxlIGF1dG9zIHJpZ2h0IGF3YXkgdG8gYXZvaWQgdGhlIGRlZmF1bHQgdmVoaWNsZSBzcGF3bmluZyBiZWZvcmUgd2UgY29uZmlndXJlIHRoZSBzcGF3bmVyLgogICAgbW9kLlNldFZlaGljbGVTcGF3bmVyQXV0b1NwYXduKHNwYXduZXIsIGZhbHNlKTsKCiAgICBjb25maWd1cmVWZWhpY2xlU3Bhd25lcihzcGF3bmVyLCB2ZWhpY2xlVHlwZSk7CgogICAgY29uc3Qgc2xvdDogVmVoaWNsZVNwYXduZXJTbG90ID0gewogICAgICAgIHRlYW1JZCwKICAgICAgICBzbG90TnVtYmVyLAogICAgICAgIHNwYXduZXIsCiAgICAgICAgc3Bhd25lck9iaklkOiBnZXRPYmpJZChzcGF3bmVyKSwKICAgICAgICBzcGF3blBvcywKICAgICAgICBzcGF3blJvdDogc3Bhd25lclJvdCwKICAgICAgICB2ZWhpY2xlVHlwZSwKICAgICAgICBlbmFibGVkOiBmYWxzZSwKICAgICAgICBlbmFibGVUb2tlbjogMCwKICAgICAgICBzcGF3blJlcXVlc3RUb2tlbjogMCwKICAgICAgICBzcGF3blJlcXVlc3RBdFNlY29uZHM6IC0xLAogICAgICAgIGV4cGVjdGluZ1NwYXduOiBmYWxzZSwKICAgICAgICB2ZWhpY2xlSWQ6IC0xLAogICAgICAgIHJlc3Bhd25SdW5uaW5nOiBmYWxzZSwKICAgICAgICBzcGF3blJldHJ5U2NoZWR1bGVkOiBmYWxzZSwKICAgIH07CgogICAgU3RhdGUudmVoaWNsZXMuc2xvdHMucHVzaChzbG90KTsKICAgIHJldHVybiBTdGF0ZS52ZWhpY2xlcy5zbG90cy5sZW5ndGggLSAxOwp9CgpmdW5jdGlvbiBnZXREZXNpcmVkU3Bhd25lckNvdW50c0ZvclByZXNldChwcmVzZXRJbmRleDogbnVtYmVyKTogeyB0ZWFtMTogbnVtYmVyOyB0ZWFtMjogbnVtYmVyIH0gewogICAgY29uc3QgcHJlc2V0ID0gTUFUQ0hVUF9QUkVTRVRTW3ByZXNldEluZGV4XSA/PyBNQVRDSFVQX1BSRVNFVFNbMF07CiAgICAvLyBSdWxlOiAxdjAgc3RpbGwgc3Bhd25zIDEgdmVoaWNsZSBwZXIgc2lkZSAocHJhY3RpY2UgKyB0b29saW5nIGNvbnNpc3RlbmN5KS4KICAgIGNvbnN0IGRlc2lyZWRUZWFtMSA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IocHJlc2V0LmxlZnRQbGF5ZXJzKSk7CiAgICBjb25zdCBkZXNpcmVkVGVhbTIgPSBNYXRoLm1heCgxLCBNYXRoLmZsb29yKHByZXNldC5yaWdodFBsYXllcnMpKTsKICAgIHJldHVybiB7IHRlYW0xOiBkZXNpcmVkVGVhbTEsIHRlYW0yOiBkZXNpcmVkVGVhbTIgfTsKfQoKLy8gVG9nZ2xlcyBzbG90IGVuYWJsZWQgc3RhdGU7IGJ1bXBzIHRva2VuIHRvIGNhbmNlbCBwZW5kaW5nIHdhaXRzLgovLyBSZXR1cm5zIHRydWUgb25seSB3aGVuIGVuYWJsaW5nIGEgc2xvdCB0aGF0IGhhcyBubyB0cmFja2VkIHZlaGljbGUgKG5lZWRzIHNwYXduKS4KZnVuY3Rpb24gc2V0U3Bhd25lclNsb3RFbmFibGVkKHNsb3RJbmRleDogbnVtYmVyLCBlbmFibGVkOiBib29sZWFuKTogYm9vbGVhbiB7CiAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbc2xvdEluZGV4XTsKICAgIGlmIChzbG90LmVuYWJsZWQgPT09IGVuYWJsZWQpIHJldHVybiBmYWxzZTsKICAgIHNsb3QuZW5hYmxlZCA9IGVuYWJsZWQ7CiAgICBzbG90LmVuYWJsZVRva2VuICs9IDE7CiAgICBzbG90LmV4cGVjdGluZ1NwYXduID0gZmFsc2U7CiAgICBpZiAoIWVuYWJsZWQpIHJldHVybiBmYWxzZTsKICAgIHJldHVybiBzbG90LnZlaGljbGVJZCA9PT0gLTE7Cn0KCi8vIEFwcGxpZXMgbWF0Y2h1cCAtPiBkZXNpcmVkIHNsb3QgY291bnRzLCBpbiBzbG90TnVtYmVyIG9yZGVyLCBhbmQgcXVldWVzIHNlcXVlbnRpYWwgc3Bhd25zIGZvciBuZXcgc2xvdHMuCmZ1bmN0aW9uIGFwcGx5U3Bhd25lckVuYWJsZW1lbnRGb3JNYXRjaHVwKHByZXNldEluZGV4OiBudW1iZXIsIHNwYXduT25FbmFibGU6IGJvb2xlYW4pOiB2b2lkIHsKICAgIGlmIChpc1JvdW5kTGl2ZSgpKSByZXR1cm47CgogICAgY29uc3QgZGVzaXJlZCA9IGdldERlc2lyZWRTcGF3bmVyQ291bnRzRm9yUHJlc2V0KHByZXNldEluZGV4KTsKICAgIGNvbnN0IHRlYW0xU2xvdEluZGljZXM6IG51bWJlcltdID0gW107CiAgICBjb25zdCB0ZWFtMlNsb3RJbmRpY2VzOiBudW1iZXJbXSA9IFtdOwogICAgY29uc3Qgc3Bhd25RdWV1ZTogbnVtYmVyW10gPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW2ldOwogICAgICAgIGlmIChzbG90LnRlYW1JZCA9PT0gVGVhbUlELlRlYW0xKSB0ZWFtMVNsb3RJbmRpY2VzLnB1c2goaSk7CiAgICAgICAgZWxzZSBpZiAoc2xvdC50ZWFtSWQgPT09IFRlYW1JRC5UZWFtMikgdGVhbTJTbG90SW5kaWNlcy5wdXNoKGkpOwogICAgfQoKICAgIC8vIEVuYWJsZW1lbnQgb3JkZXIgaXMgZHJpdmVuIGJ5IHNsb3ROdW1iZXIsIG5vdCBhcnJheSBvcmRlci4KICAgIHRlYW0xU2xvdEluZGljZXMuc29ydCgoYSwgYikgPT4gU3RhdGUudmVoaWNsZXMuc2xvdHNbYV0uc2xvdE51bWJlciAtIFN0YXRlLnZlaGljbGVzLnNsb3RzW2JdLnNsb3ROdW1iZXIpOwogICAgdGVhbTJTbG90SW5kaWNlcy5zb3J0KChhLCBiKSA9PiBTdGF0ZS52ZWhpY2xlcy5zbG90c1thXS5zbG90TnVtYmVyIC0gU3RhdGUudmVoaWNsZXMuc2xvdHNbYl0uc2xvdE51bWJlcik7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZWFtMVNsb3RJbmRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2xvdEluZGV4ID0gdGVhbTFTbG90SW5kaWNlc1tpXTsKICAgICAgICBjb25zdCBzaG91bGRFbmFibGUgPSBpIDwgZGVzaXJlZC50ZWFtMTsKICAgICAgICBjb25zdCBzaG91bGRTcGF3biA9IHNldFNwYXduZXJTbG90RW5hYmxlZChzbG90SW5kZXgsIHNob3VsZEVuYWJsZSk7CiAgICAgICAgaWYgKHNwYXduT25FbmFibGUgJiYgc2hvdWxkU3Bhd24pIHNwYXduUXVldWUucHVzaChzbG90SW5kZXgpOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGVhbTJTbG90SW5kaWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNsb3RJbmRleCA9IHRlYW0yU2xvdEluZGljZXNbaV07CiAgICAgICAgY29uc3Qgc2hvdWxkRW5hYmxlID0gaSA8IGRlc2lyZWQudGVhbTI7CiAgICAgICAgY29uc3Qgc2hvdWxkU3Bhd24gPSBzZXRTcGF3bmVyU2xvdEVuYWJsZWQoc2xvdEluZGV4LCBzaG91bGRFbmFibGUpOwogICAgICAgIGlmIChzcGF3bk9uRW5hYmxlICYmIHNob3VsZFNwYXduKSBzcGF3blF1ZXVlLnB1c2goc2xvdEluZGV4KTsKICAgIH0KCiAgICBpZiAoc3Bhd25PbkVuYWJsZSkgewogICAgICAgIC8vIFJlLXF1ZXVlIGFueSBlbmFibGVkIGJ1dCBlbXB0eSBzbG90cyB0byBjb3ZlciByYXBpZCBwcmVzZXQgY2hhbmdlcy4KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFN0YXRlLnZlaGljbGVzLnNsb3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1tpXTsKICAgICAgICAgICAgaWYgKCFzbG90LmVuYWJsZWQpIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAoc2xvdC52ZWhpY2xlSWQgIT09IC0xKSBjb250aW51ZTsKICAgICAgICAgICAgaWYgKHNsb3QuZXhwZWN0aW5nU3Bhd24pIGNvbnRpbnVlOwogICAgICAgICAgICBzcGF3blF1ZXVlLnB1c2goaSk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIENhbm5vdCBzcGF3biBpbiBwYXJhbGxlbCAtIHNwYXduIHNlcXVlbnRpYWxseSB0byBhdm9pZCBjcm9zcy1iaW5kaW5nIHdoZW4gbXVsdGlwbGUgc3Bhd25lcnMgZmlyZSBhdCBvbmNlLgogICAgaWYgKHNwYXduT25FbmFibGUgJiYgc3Bhd25RdWV1ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgcXVldWVTZXF1ZW50aWFsU3Bhd25zKHNwYXduUXVldWUpOwogICAgfQp9CgpmdW5jdGlvbiBxdWV1ZVNlcXVlbnRpYWxTcGF3bnMoc2xvdEluZGljZXM6IG51bWJlcltdKTogdm9pZCB7CiAgICBpZiAoc2xvdEluZGljZXMubGVuZ3RoID09PSAwKSByZXR1cm47CiAgICAvLyBUb2tlbiBjYW5jZWxzIGFueSBwcmlvciBzcGF3biBzZXF1ZW5jZSBpZiBhIG5ldyBvbmUgaXMgcXVldWVkLgogICAgLy8gQ29uc2lkZXIgaGFyZGVuaW5nOiBJZiBhIHNwYXduIHNlcXVlbmNlIHN0YWxscywgc3Bhd25TZXF1ZW5jZUluUHJvZ3Jlc3MgY2FuIHJlbWFpbiB0cnVlIGFuZCBibG9jayBtYXRjaHVwIGNoYW5nZXMuCiAgICBTdGF0ZS52ZWhpY2xlcy5zcGF3blNlcXVlbmNlVG9rZW4gKz0gMTsKICAgIGNvbnN0IHRva2VuID0gU3RhdGUudmVoaWNsZXMuc3Bhd25TZXF1ZW5jZVRva2VuOwogICAgU3RhdGUudmVoaWNsZXMuc3Bhd25TZXF1ZW5jZUluUHJvZ3Jlc3MgPSB0cnVlOwogICAgdm9pZCBydW5TZXF1ZW50aWFsU3Bhd25zKHNsb3RJbmRpY2VzLCB0b2tlbik7Cn0KCi8vIFNwYXducyBlYWNoIHNsb3Qgb25lLWF0LWEtdGltZSB0byBhdm9pZCBzaW11bHRhbmVvdXMgc3Bhd24gY3Jvc3MtYmluZGluZy4KLy8gRXhpdHMgZWFybHkgaWYgYSBuZXcgc2VxdWVuY2Ugc3VwZXJzZWRlcyB0aGlzIG9uZSAodG9rZW4gbWlzbWF0Y2gpLgphc3luYyBmdW5jdGlvbiBydW5TZXF1ZW50aWFsU3Bhd25zKHNsb3RJbmRpY2VzOiBudW1iZXJbXSwgdG9rZW46IG51bWJlcik6IFByb21pc2U8dm9pZD4gewogICAgLy8gQ29uc2lkZXIgaGFyZGVuaW5nOiBUaWdodCBtYXBzIGFyZSB2dWxuZXJhYmxlIGlmIGEgZGVsYXllZCBzcGF3biBhcnJpdmVzIGFmdGVyIHRoZSB0b2tlbiB3aW5kb3c7IGZhbGxiYWNrIGJpbmRpbmcgbWF5IG1pcy1iaW5kLgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzbG90SW5kaWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChTdGF0ZS52ZWhpY2xlcy5zcGF3blNlcXVlbmNlVG9rZW4gIT09IHRva2VuKSByZXR1cm47CiAgICAgICAgY29uc3Qgc2xvdEluZGV4ID0gc2xvdEluZGljZXNbaV07CiAgICAgICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW3Nsb3RJbmRleF07CiAgICAgICAgaWYgKCFzbG90IHx8ICFzbG90LmVuYWJsZWQgfHwgc2xvdC52ZWhpY2xlSWQgIT09IC0xKSBjb250aW51ZTsKICAgICAgICBhd2FpdCBmb3JjZVNwYXduV2l0aFJldHJ5KHNsb3RJbmRleCk7CiAgICAgICAgYXdhaXQgbW9kLldhaXQoMC4zKTsKICAgIH0KCiAgICBpZiAoU3RhdGUudmVoaWNsZXMuc3Bhd25TZXF1ZW5jZVRva2VuID09PSB0b2tlbikgewogICAgICAgIFN0YXRlLnZlaGljbGVzLnNwYXduU2VxdWVuY2VJblByb2dyZXNzID0gZmFsc2U7CiAgICB9Cn0KCi8vIEZvcmNlcyBhIHNwYXduIGZvciBhIHNsb3QsIHBvbGxpbmcgdW50aWwgYSB2ZWhpY2xlIGJpbmRzIG9yIGF0dGVtcHRzIGFyZSBleGhhdXN0ZWQuCi8vIEFib3J0cyBpZiBzbG90IGlzIGRpc2FibGVkIG9yIHRva2VuIGNoYW5nZXMgbWlkLWF0dGVtcHQuCmFzeW5jIGZ1bmN0aW9uIGZvcmNlU3Bhd25XaXRoUmV0cnkoc2xvdEluZGV4OiBudW1iZXIpOiBQcm9taXNlPGJvb2xlYW4+IHsKICAgIGNvbnN0IHNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1tzbG90SW5kZXhdOwogICAgaWYgKCFzbG90LmVuYWJsZWQpIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IHRva2VuID0gc2xvdC5lbmFibGVUb2tlbjsKICAgIHNsb3QuZXhwZWN0aW5nU3Bhd24gPSB0cnVlOwogICAgc2xvdC5zcGF3blJlcXVlc3RUb2tlbiArPSAxOwogICAgc2xvdC5zcGF3blJlcXVlc3RBdFNlY29uZHMgPSBNYXRoLmZsb29yKG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCkpOwogICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25TbG90SW5kZXggPSBzbG90SW5kZXg7CiAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blRva2VuID0gc2xvdC5zcGF3blJlcXVlc3RUb2tlbjsKICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduUmVxdWVzdGVkQXRTZWNvbmRzID0gc2xvdC5zcGF3blJlcXVlc3RBdFNlY29uZHM7CgogICAgLy8gUmUtYXBwbHkgY29uZmlnIGJlZm9yZSBmb3JjaW5nIHNwYXduIHRvIGF2b2lkIHRoZSBkZWZhdWx0IHZlaGljbGUgdHlwZS4KICAgIGNvbmZpZ3VyZVZlaGljbGVTcGF3bmVyKHNsb3Quc3Bhd25lciwgc2xvdC52ZWhpY2xlVHlwZSk7CiAgICBhd2FpdCBtb2QuV2FpdCgwKTsKCiAgICBmb3IgKGxldCBhdHRlbXB0ID0gMDsgYXR0ZW1wdCA8IDIwOyBhdHRlbXB0KyspIHsKICAgICAgICBpZiAoIXNsb3QuZW5hYmxlZCB8fCBzbG90LmVuYWJsZVRva2VuICE9PSB0b2tlbikgewogICAgICAgICAgICBzbG90LmV4cGVjdGluZ1NwYXduID0gZmFsc2U7CiAgICAgICAgICAgIGlmIChTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blNsb3RJbmRleCA9PT0gc2xvdEluZGV4ICYmIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduVG9rZW4gPT09IHNsb3Quc3Bhd25SZXF1ZXN0VG9rZW4pIHsKICAgICAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduU2xvdEluZGV4ID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25Ub2tlbiA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduUmVxdWVzdGVkQXRTZWNvbmRzID0gdW5kZWZpbmVkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgbW9kLkZvcmNlVmVoaWNsZVNwYXduZXJTcGF3bihzbG90LnNwYXduZXIpOwoKICAgICAgICBpZiAoIXNsb3QuZXhwZWN0aW5nU3Bhd24gJiYgc2xvdC52ZWhpY2xlSWQgIT09IC0xKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgYXdhaXQgbW9kLldhaXQoMC4yNSk7CiAgICB9CgogICAgc2xvdC5leHBlY3RpbmdTcGF3biA9IGZhbHNlOwogICAgaWYgKFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduU2xvdEluZGV4ID09PSBzbG90SW5kZXggJiYgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25Ub2tlbiA9PT0gc2xvdC5zcGF3blJlcXVlc3RUb2tlbikgewogICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduU2xvdEluZGV4ID0gdW5kZWZpbmVkOwogICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduVG9rZW4gPSB1bmRlZmluZWQ7CiAgICAgICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25SZXF1ZXN0ZWRBdFNlY29uZHMgPSB1bmRlZmluZWQ7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn0KCi8vIFNjaGVkdWxlcyBhIGRlbGF5ZWQgcmV0cnkgd2hlbiBzcGF3biBpcyBibG9ja2VkOyByZWNoZWNrcyBzbG90L3Rva2VuIGJlZm9yZSByZXRyeS4KYXN5bmMgZnVuY3Rpb24gc2NoZWR1bGVCbG9ja2VkU3Bhd25SZXRyeShzbG90SW5kZXg6IG51bWJlcik6IFByb21pc2U8dm9pZD4gewogICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW3Nsb3RJbmRleF07CiAgICBpZiAoIXNsb3QuZW5hYmxlZCkgcmV0dXJuOwogICAgaWYgKHNsb3Quc3Bhd25SZXRyeVNjaGVkdWxlZCkgcmV0dXJuOwogICAgc2xvdC5zcGF3blJldHJ5U2NoZWR1bGVkID0gdHJ1ZTsKICAgIGNvbnN0IHRva2VuID0gc2xvdC5lbmFibGVUb2tlbjsKCiAgICBhd2FpdCBtb2QuV2FpdChWRUhJQ0xFX1NQQVdORVJfUkVTUEFXTl9ERUxBWV9TRUNPTkRTKTsKICAgIHNsb3Quc3Bhd25SZXRyeVNjaGVkdWxlZCA9IGZhbHNlOwoKICAgIGlmICghc2xvdC5lbmFibGVkIHx8IHNsb3QuZW5hYmxlVG9rZW4gIT09IHRva2VuKSByZXR1cm47CiAgICBpZiAoc2xvdC52ZWhpY2xlSWQgIT09IC0xKSByZXR1cm47CgogICAgY29uc3QgdGVhbU5hbWVLZXkgPSBnZXRUZWFtTmFtZUtleShzbG90LnRlYW1JZCk7CiAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX1ZFSElDTEVfU1BBV05fUkVUUlksIHRlYW1OYW1lS2V5LCBWRUhJQ0xFX1NQQVdORVJfUkVTUEFXTl9ERUxBWV9TRUNPTkRTKSwKICAgICAgICB0cnVlCiAgICApOwoKICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCBmb3JjZVNwYXduV2l0aFJldHJ5KHNsb3RJbmRleCk7CiAgICBpZiAoIXN1Y2Nlc3MpIHsKICAgICAgICB2b2lkIHNjaGVkdWxlQmxvY2tlZFNwYXduUmV0cnkoc2xvdEluZGV4KTsKICAgIH0KfQoKLy8gV2FpdHMgdGhlIHJlc3Bhd24gZGVsYXksIGNsZWFycyBvbGQgdmVoaWNsZSBtYXBwaW5nLCB0aGVuIHNwYXducyBhIHJlcGxhY2VtZW50LgovLyBUb2tlbi1ndWFyZGVkIHRvIHByZXZlbnQgcmVzcGF3bnMgYWZ0ZXIgZGlzYWJsZS9yZXR1bmUuCmFzeW5jIGZ1bmN0aW9uIHNjaGVkdWxlUmVzcGF3bihzbG90SW5kZXg6IG51bWJlciwgbGFzdFZlaGljbGVJZDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7CiAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbc2xvdEluZGV4XTsKICAgIGlmICghc2xvdC5lbmFibGVkKSB7CiAgICAgICAgZGVsZXRlIFN0YXRlLnZlaGljbGVzLnZlaGljbGVUb1Nsb3RbbGFzdFZlaGljbGVJZF07CiAgICAgICAgaWYgKHNsb3QudmVoaWNsZUlkID09PSBsYXN0VmVoaWNsZUlkKSB7CiAgICAgICAgICAgIHNsb3QudmVoaWNsZUlkID0gLTE7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgIH0KICAgIC8vIEd1YXJkIGFnYWluc3Qgb3ZlcmxhcHBpbmcgcmVzcGF3biB0aW1lcnMgZm9yIHRoZSBzYW1lIHNsb3QuCiAgICBpZiAoc2xvdC5yZXNwYXduUnVubmluZykgcmV0dXJuOwoKICAgIHNsb3QucmVzcGF3blJ1bm5pbmcgPSB0cnVlOwogICAgY29uc3QgdG9rZW4gPSBzbG90LmVuYWJsZVRva2VuOwogICAgYXdhaXQgbW9kLldhaXQoVkVISUNMRV9TUEFXTkVSX1JFU1BBV05fREVMQVlfU0VDT05EUyk7CgogICAgaWYgKCFzbG90LmVuYWJsZWQgfHwgc2xvdC5lbmFibGVUb2tlbiAhPT0gdG9rZW4pIHsKICAgICAgICBzbG90LnJlc3Bhd25SdW5uaW5nID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGRlbGV0ZSBTdGF0ZS52ZWhpY2xlcy52ZWhpY2xlVG9TbG90W2xhc3RWZWhpY2xlSWRdOwogICAgc2xvdC52ZWhpY2xlSWQgPSAtMTsKCiAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgZm9yY2VTcGF3bldpdGhSZXRyeShzbG90SW5kZXgpOwogICAgaWYgKCFzdWNjZXNzKSB7CiAgICAgICAgdm9pZCBzY2hlZHVsZUJsb2NrZWRTcGF3blJldHJ5KHNsb3RJbmRleCk7CiAgICB9CiAgICBzbG90LnJlc3Bhd25SdW5uaW5nID0gZmFsc2U7Cn0KCi8vIFBlcmlvZGljYWxseSB2ZXJpZmllcyB0cmFja2VkIHZlaGljbGVzIHN0aWxsIGV4aXN0OyBpZiBtaXNzaW5nLCB0cmlnZ2VycyByZXNwYXduLgphc3luYyBmdW5jdGlvbiBwb2xsVmVoaWNsZVNwYXduZXJTbG90cygpOiBQcm9taXNlPHZvaWQ+IHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgYXdhaXQgbW9kLldhaXQoVkVISUNMRV9TUEFXTkVSX1BPTExfSU5URVJWQUxfU0VDT05EUyk7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgU3RhdGUudmVoaWNsZXMuc2xvdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW2ldOwogICAgICAgICAgICBpZiAoc2xvdC52ZWhpY2xlSWQgPT09IC0xKSBjb250aW51ZTsKCiAgICAgICAgICAgIGNvbnN0IHZlaGljbGUgPSBmaW5kVmVoaWNsZUJ5SWQoc2xvdC52ZWhpY2xlSWQpOwogICAgICAgICAgICBpZiAoIXZlaGljbGUpIHsKICAgICAgICAgICAgICAgIGNvbnN0IG9sZElkID0gc2xvdC52ZWhpY2xlSWQ7CiAgICAgICAgICAgICAgICBzbG90LnZlaGljbGVJZCA9IC0xOwogICAgICAgICAgICAgICAgLy8gVmVoaWNsZSBtaXNzaW5nIG1lYW5zIGRlc3Ryb3llZC91bnNwYXduZWQ7IHNjaGVkdWxlIGEgcmVzcGF3biBmb3IgaXRzIHNsb3QuCiAgICAgICAgICAgICAgICBzY2hlZHVsZVJlc3Bhd24oaSwgb2xkSWQpOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCmFzeW5jIGZ1bmN0aW9uIGFwcGx5U3Bhd25ZYXdUb1ZlaGljbGUoZXZlbnRWZWhpY2xlOiBtb2QuVmVoaWNsZSwgc2xvdDogVmVoaWNsZVNwYXduZXJTbG90KTogUHJvbWlzZTx2b2lkPiB7CiAgICAvLyBFbmZvcmNlIHRoZSBkZXNpcmVkIHNwYXduIHlhdyBvbiB0aGUgdmVoaWNsZSBhZnRlciBpdCBleGlzdHMgKG1hcC1zcGVjaWZpYyBzcGF3bmVyIHlhdyBjYW4gZHJpZnQpLgogICAgY29uc3QgcG9zID0gc2xvdC5zcGF3blBvczsKICAgIGNvbnN0IHlhd0RlZyA9IG1vZC5ZQ29tcG9uZW50T2Yoc2xvdC5zcGF3blJvdCk7CiAgICBjb25zdCB5YXdSYWQgPSB5YXdEZWcgKiBNYXRoLlBJIC8gMTgwOwogICAgbW9kLlRlbGVwb3J0KGV2ZW50VmVoaWNsZSwgcG9zLCB5YXdSYWQpOwogICAgYXdhaXQgbW9kLldhaXQoMCk7CiAgICBtb2QuVGVsZXBvcnQoZXZlbnRWZWhpY2xlLCBwb3MsIHlhd1JhZCk7Cn0KCi8vIEJpbmRpbmcgdXNlcyBvYmplY3QgcG9zaXRpb24gKG5vdCB2ZWhpY2xlIHN0YXRlKSBiZWNhdXNlIGl0IGlzIHN0YWJsZSBhdCBzcGF3biB0aW1lLgovLyBGYWxsYmFjayBiaW5kaW5nIGNhbiBtaXMtYXNzaWduIG9uIHRpZ2h0IG1hcHMgaWYgYSBzcGF3biBhcnJpdmVzIG91dHNpZGUgdGhlIHRva2VuIHdpbmRvdy4KZnVuY3Rpb24gYmluZFNwYXduZWRWZWhpY2xlVG9TbG90KGV2ZW50VmVoaWNsZTogbW9kLlZlaGljbGUsIHZlaGljbGVQb3M6IG1vZC5WZWN0b3IpOiBUZWFtSUQgfCAwIHsKICAgIGNvbnN0IHZlaGljbGVPYmpJZCA9IGdldE9iaklkKGV2ZW50VmVoaWNsZSk7CgogICAgY29uc3QgYWN0aXZlSW5kZXggPSBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blNsb3RJbmRleDsKICAgIGNvbnN0IGFjdGl2ZVRva2VuID0gU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25Ub2tlbjsKICAgIGNvbnN0IGFjdGl2ZUF0ID0gU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25SZXF1ZXN0ZWRBdFNlY29uZHM7CiAgICBpZiAoYWN0aXZlSW5kZXggIT09IHVuZGVmaW5lZCAmJiBhY3RpdmVUb2tlbiAhPT0gdW5kZWZpbmVkICYmIGFjdGl2ZUF0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCkpOwogICAgICAgIGNvbnN0IGV4cGlyZWQgPSAobm93IC0gYWN0aXZlQXQpID4gVkVISUNMRV9TUEFXTkVSX0JJTkRfVElNRU9VVF9TRUNPTkRTOwogICAgICAgIGlmICghZXhwaXJlZCkgewogICAgICAgICAgICBjb25zdCBhY3RpdmVTbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbYWN0aXZlSW5kZXhdOwogICAgICAgICAgICBpZiAoYWN0aXZlU2xvdCAmJiBhY3RpdmVTbG90LmVuYWJsZWQgJiYgYWN0aXZlU2xvdC5leHBlY3RpbmdTcGF3biAmJiBhY3RpdmVTbG90LnNwYXduUmVxdWVzdFRva2VuID09PSBhY3RpdmVUb2tlbikgewogICAgICAgICAgICAgICAgYWN0aXZlU2xvdC5leHBlY3RpbmdTcGF3biA9IGZhbHNlOwogICAgICAgICAgICAgICAgYWN0aXZlU2xvdC52ZWhpY2xlSWQgPSB2ZWhpY2xlT2JqSWQ7CiAgICAgICAgICAgICAgICBhY3RpdmVTbG90LnJlc3Bhd25SdW5uaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBhY3RpdmVTbG90LnNwYXduUmV0cnlTY2hlZHVsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLnZlaGljbGVUb1Nsb3RbdmVoaWNsZU9iaklkXSA9IGFjdGl2ZUluZGV4OwogICAgICAgICAgICAgICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25TbG90SW5kZXggPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blRva2VuID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25SZXF1ZXN0ZWRBdFNlY29uZHMgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICB2b2lkIGFwcGx5U3Bhd25ZYXdUb1ZlaGljbGUoZXZlbnRWZWhpY2xlLCBhY3RpdmVTbG90KTsKICAgICAgICAgICAgICAgIHJldHVybiBhY3RpdmVTbG90LnRlYW1JZDsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduU2xvdEluZGV4ID0gdW5kZWZpbmVkOwogICAgICAgICAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blRva2VuID0gdW5kZWZpbmVkOwogICAgICAgICAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blJlcXVlc3RlZEF0U2Vjb25kcyA9IHVuZGVmaW5lZDsKICAgICAgICB9CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBTdGF0ZS52ZWhpY2xlcy5zbG90cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1tpXTsKICAgICAgICBpZiAoIXNsb3QuZXhwZWN0aW5nU3Bhd24pIGNvbnRpbnVlOwoKICAgICAgICBjb25zdCBzcGF3bmVyUG9zID0gbW9kLkdldE9iamVjdFBvc2l0aW9uKHNsb3Quc3Bhd25lcik7CiAgICAgICAgY29uc3QgZCA9IG1vZC5EaXN0YW5jZUJldHdlZW4odmVoaWNsZVBvcywgc3Bhd25lclBvcyk7CiAgICAgICAgaWYgKGQgPD0gVkVISUNMRV9TUEFXTkVSX0JJTkRfRElTVEFOQ0VfTUVURVJTKSB7CiAgICAgICAgICAgIHNsb3QuZXhwZWN0aW5nU3Bhd24gPSBmYWxzZTsKICAgICAgICAgICAgc2xvdC52ZWhpY2xlSWQgPSB2ZWhpY2xlT2JqSWQ7CiAgICAgICAgICAgIHNsb3QucmVzcGF3blJ1bm5pbmcgPSBmYWxzZTsKICAgICAgICAgICAgc2xvdC5zcGF3blJldHJ5U2NoZWR1bGVkID0gZmFsc2U7CiAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLnZlaGljbGVUb1Nsb3RbdmVoaWNsZU9iaklkXSA9IGk7CiAgICAgICAgICAgIGlmIChTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blNsb3RJbmRleCA9PT0gaSAmJiBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blRva2VuID09PSBzbG90LnNwYXduUmVxdWVzdFRva2VuKSB7CiAgICAgICAgICAgICAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blNsb3RJbmRleCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLmFjdGl2ZVNwYXduVG9rZW4gPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blJlcXVlc3RlZEF0U2Vjb25kcyA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgfQogICAgICAgICAgICB2b2lkIGFwcGx5U3Bhd25ZYXdUb1ZlaGljbGUoZXZlbnRWZWhpY2xlLCBzbG90KTsKICAgICAgICAgICAgcmV0dXJuIHNsb3QudGVhbUlkOwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gMDsKfQoKLy8gTG9jYXRlcyB0aGUgZmlyc3QgImV4cGVjdGluZ1NwYXduIiBzbG90IHdpdGhpbiBiaW5kIGRpc3RhbmNlIG9mIHRoZSB2ZWhpY2xlIHBvc2l0aW9uLgpmdW5jdGlvbiBmaW5kU3Bhd25lclNsb3RCeVBvc2l0aW9uKHNwYXduUG9zOiBtb2QuVmVjdG9yKTogbnVtYmVyIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgU3RhdGUudmVoaWNsZXMuc2xvdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbaV07CiAgICAgICAgY29uc3Qgc3Bhd25lclBvcyA9IG1vZC5HZXRPYmplY3RQb3NpdGlvbihzbG90LnNwYXduZXIpOwogICAgICAgIGlmIChtb2QuRGlzdGFuY2VCZXR3ZWVuKHNwYXduUG9zLCBzcGF3bmVyUG9zKSA8PSBWRUhJQ0xFX1NQQVdORVJfQklORF9ESVNUQU5DRV9NRVRFUlMpIHsKICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIC0xOwp9CgovLyBCb290c3RyYXBzIHNwYXduZXJzICsgc2xvdHMsIGFwcGxpZXMgY3VycmVudCBtYXRjaHVwIGVuYWJsZW1lbnQsIGFuZCBzdGFydHMgdGhlIHBvbGxpbmcgbG9vcC4KYXN5bmMgZnVuY3Rpb24gc3RhcnRWZWhpY2xlU3Bhd25lclN5c3RlbSgpOiBQcm9taXNlPHZvaWQ+IHsKICAgIC8vIFdBUk5JTkc6IFRoaXMgc2hvdWxkIHJ1biBvbmNlIHBlciBtYXRjaDsgZHVwbGljYXRlIHJ1bnMgY2FuIGNyZWF0ZSBleHRyYSBzcGF3bmVycy9zbG90cy4KICAgIC8vIEVuc3VyZSBtYXAgY29uZmlnIGlzIGFwcGxpZWQgYmVmb3JlIGFueSBzcGF3bmVycyBhcmUgY3JlYXRlZCBvciBmb3JjZWQgdG8gc3Bhd24uCiAgICB3aGlsZSAoIVN0YXRlLnZlaGljbGVzLmNvbmZpZ1JlYWR5KSB7CiAgICAgICAgYXdhaXQgbW9kLldhaXQoMC4xKTsKICAgIH0KICAgIGF3YWl0IG1vZC5XYWl0KFZFSElDTEVfU1BBV05FUl9TVEFSVF9ERUxBWV9TRUNPTkRTKTsKCiAgICBTdGF0ZS52ZWhpY2xlcy5zbG90cy5sZW5ndGggPSAwOwogICAgU3RhdGUudmVoaWNsZXMudmVoaWNsZVRvU2xvdCA9IHt9OwogICAgU3RhdGUudmVoaWNsZXMuc3Bhd25TZXF1ZW5jZUluUHJvZ3Jlc3MgPSBmYWxzZTsKCiAgICBjb25zdCB0ZWFtMVNwZWNzID0gWy4uLlRFQU0xX1ZFSElDTEVfU1BBV05fU1BFQ1NdLnNvcnQoKGEsIGIpID0+IGEuc2xvdE51bWJlciAtIGIuc2xvdE51bWJlcik7CiAgICBjb25zdCB0ZWFtMlNwZWNzID0gWy4uLlRFQU0yX1ZFSElDTEVfU1BBV05fU1BFQ1NdLnNvcnQoKGEsIGIpID0+IGEuc2xvdE51bWJlciAtIGIuc2xvdE51bWJlcik7CgogICAgZm9yIChjb25zdCBzcGVjIG9mIHRlYW0xU3BlY3MpIHsKICAgICAgICBhZGRWZWhpY2xlU3Bhd25lclNsb3QoVGVhbUlELlRlYW0xLCBzcGVjLnNsb3ROdW1iZXIsIHNwZWMucG9zLCBzcGVjLnJvdCwgc3BlYy52ZWhpY2xlKTsKICAgIH0KICAgIGZvciAoY29uc3Qgc3BlYyBvZiB0ZWFtMlNwZWNzKSB7CiAgICAgICAgYWRkVmVoaWNsZVNwYXduZXJTbG90KFRlYW1JRC5UZWFtMiwgc3BlYy5zbG90TnVtYmVyLCBzcGVjLnBvcywgc3BlYy5yb3QsIHNwZWMudmVoaWNsZSk7CiAgICB9CgogICAgLy8gT25lLXRpbWUgY2xlYW51cDogcmVtb3ZlIGFueSBkZWZhdWx0IHZlaGljbGVzIHNpdHRpbmcgb24gb3IgbmVhciBzcGF3biBwYWRzIGJlZm9yZSBmaXJzdCBmb3JjZWQgc3Bhd25zLgogICAgLy8gVGhpcyBwcmV2ZW50cyBhIGRlZmF1bHQgQWJyYW1zIGZyb20gcGVyc2lzdGluZyBpZiBpdCBzcGF3bmVkIGJlZm9yZSBvdXIgc3Bhd25lcnMgd2VyZSBjb25maWd1cmVkLgogICAgLy8gS2VlcCB0aGlzIG9uZS1zaG90IGFuZCBwcmUtcm91bmQgdG8gYXZvaWQgZGVsZXRpbmcgcGxheWVyIHZlaGljbGVzIGxhdGVyIGluIHRoZSBtYXRjaC4KICAgIC8vIENvbnNpZGVyIEhhcmRlbmluZyB3aXRoIGEgc2Vjb25kIGNsZWFudXAgcGFzcyBiZWZvcmUgZmlyc3QgZm9yY2VkIHNwYXducyBpZiBkZWZhdWx0IHNwYXducyByZWFwcGVhciBhZnRlciBjbGVhbnVwCiAgICBpZiAoIWlzUm91bmRMaXZlKCkgJiYgIVN0YXRlLnZlaGljbGVzLnN0YXJ0dXBDbGVhbnVwRG9uZSkgewogICAgICAgIGNvbnN0IHZlaGljbGVzID0gbW9kLkFsbFZlaGljbGVzKCk7CiAgICAgICAgY29uc3QgdkNvdW50ID0gbW9kLkNvdW50T2YodmVoaWNsZXMpOwogICAgICAgIGZvciAobGV0IHYgPSAwOyB2IDwgdkNvdW50OyB2KyspIHsKICAgICAgICAgICAgY29uc3QgdmVoaWNsZSA9IG1vZC5WYWx1ZUluQXJyYXkodmVoaWNsZXMsIHYpIGFzIG1vZC5WZWhpY2xlOwogICAgICAgICAgICBpZiAoIXZlaGljbGUpIGNvbnRpbnVlOwogICAgICAgICAgICBjb25zdCBwb3MgPSBtb2QuR2V0T2JqZWN0UG9zaXRpb24odmVoaWNsZSk7CiAgICAgICAgICAgIGxldCBuZWFyU3Bhd24gPSBmYWxzZTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBTdGF0ZS52ZWhpY2xlcy5zbG90cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3Qgc2xvdCA9IFN0YXRlLnZlaGljbGVzLnNsb3RzW2ldOwogICAgICAgICAgICAgICAgaWYgKG1vZC5EaXN0YW5jZUJldHdlZW4ocG9zLCBzbG90LnNwYXduUG9zKSA8PSBWRUhJQ0xFX1NQQVdORVJfU1RBUlRVUF9DTEVBTlVQX1JBRElVU19NRVRFUlMpIHsKICAgICAgICAgICAgICAgICAgICBuZWFyU3Bhd24gPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChuZWFyU3Bhd24pIHsKICAgICAgICAgICAgICAgIG1vZC5VbnNwYXduT2JqZWN0KHZlaGljbGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIFN0YXRlLnZlaGljbGVzLnN0YXJ0dXBDbGVhbnVwRG9uZSA9IHRydWU7CiAgICB9CgoKICAgIC8vIEV4dHJhIHNob3J0IHdhaXQgcmVkdWNlcyB0aGUgY2hhbmNlIG9mIGEgZGVmYXVsdCBzcGF3biBhcHBlYXJpbmcgYWZ0ZXIgY2xlYW51cC4KICAgIGF3YWl0IG1vZC5XYWl0KDAuMSk7CiAgICAvLyBBcHBseSBlbmFibGVtZW50IGJlZm9yZSBzcGF3bmluZyBzbyBvbmx5IHRoZSBkZXNpcmVkIHNsb3RzIGNhbiBzcGF3bi4KICAgIGFwcGx5U3Bhd25lckVuYWJsZW1lbnRGb3JNYXRjaHVwKFN0YXRlLnJvdW5kLm1hdGNodXBQcmVzZXRJbmRleCwgZmFsc2UpOwoKICAgIC8vIEtpY2sgaW5pdGlhbCBzcGF3bnMgc28gZWFjaCBzbG90IGhhcyBhIHZlaGljbGUgYm91bmQgYmVmb3JlIHRoZSBwb2xsIGxvb3Agc3RhcnRzLgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBTdGF0ZS52ZWhpY2xlcy5zbG90cy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmICghU3RhdGUudmVoaWNsZXMuc2xvdHNbaV0uZW5hYmxlZCkgY29udGludWU7CiAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IGZvcmNlU3Bhd25XaXRoUmV0cnkoaSk7CiAgICAgICAgaWYgKCFzdWNjZXNzKSB7CiAgICAgICAgICAgIHZvaWQgc2NoZWR1bGVCbG9ja2VkU3Bhd25SZXRyeShpKTsKICAgICAgICB9CiAgICAgICAgYXdhaXQgbW9kLldhaXQoMC41KTsKICAgIH0KCiAgICAvLyBMb25nLXJ1bm5pbmcgcG9sbCBsb29wIHRvIGRldGVjdCBtaXNzaW5nIHZlaGljbGVzIGFuZCByZXNwYXduLgogICAgdm9pZCBwb2xsVmVoaWNsZVNwYXduZXJTbG90cygpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gVmVoaWNsZSBTcGF3bmVyIFN5c3RlbSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gS2lsbHMgSFVEIFN5bmMgKEdhbWVNb2RlU2NvcmUgLT4gSFVEKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCmZ1bmN0aW9uIHN5bmNLaWxsc0h1ZEZyb21UcmFja2VkVG90YWxzKF9mb3JjZTogYm9vbGVhbik6IHZvaWQgewogICAgLy8gVG90YWwga2lsbHMgYXJlIHRyYWNrZWQgaW4gc2NyaXB0IHZhcmlhYmxlczsgR2FtZU1vZGVTY29yZSBpcyByZXNlcnZlZCBmb3IgbWF0Y2ggd2lucy4KICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgY29uc3QgcmVmcyA9IGVuc3VyZUh1ZEZvclBsYXllcihwKTsKICAgICAgICBpZiAoIXJlZnMpIGNvbnRpbnVlOwogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMubGVmdEtpbGxzVGV4dCwgU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscyk7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5yaWdodEtpbGxzVGV4dCwgU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscyk7CiAgICB9Cn0KCi8vIFJvdW5kIGtpbGxzIEhVRCBTeW5jIChSb3VuZEtpbGxzIC0+IEhVRCkKZnVuY3Rpb24gc3luY1JvdW5kS2lsbHNIdWQoZm9yY2U6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQgewogICAgaWYgKCFmb3JjZSAmJiBTdGF0ZS5odWRDYWNoZS5sYXN0SHVkUm91bmRLaWxsc1QxID09PSBTdGF0ZS5zY29yZXMudDFSb3VuZEtpbGxzICYmIFN0YXRlLmh1ZENhY2hlLmxhc3RIdWRSb3VuZEtpbGxzVDIgPT09IFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHMpIHJldHVybjsKCiAgICBTdGF0ZS5odWRDYWNoZS5sYXN0SHVkUm91bmRLaWxsc1QxID0gU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxsczsKICAgIFN0YXRlLmh1ZENhY2hlLmxhc3RIdWRSb3VuZEtpbGxzVDIgPSBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzOwoKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKTsKICAgICAgICBjb25zdCByZWZzID0gZW5zdXJlSHVkRm9yUGxheWVyKHApOwogICAgICAgIGlmICghcmVmcykgY29udGludWU7CgogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMubGVmdFJvdW5kS2lsbHNUZXh0LCBTdGF0ZS5zY29yZXMudDFSb3VuZEtpbGxzKTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJpZ2h0Um91bmRLaWxsc1RleHQsIFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHMpOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gS2lsbHMgSFVEIFN5bmMgKEdhbWVNb2RlU2NvcmUgLT4gSFVEKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gTWF0Y2ggQ2xvY2sgKHBlci1wbGF5ZXIgTU06U1MpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBDbG9ja1dpZGdldENhY2hlRW50cnk6Ci8vIENhY2hlcyBhbGwgVUkgd2lkZ2V0IHJlZmVyZW5jZXMgcmVxdWlyZWQgdG8gcmVuZGVyIHRoZSByb3VuZCBjbG9jayBmb3Igb25lIHBsYXllci4KLy8gVGhpcyBwcmV2ZW50cyByZXBlYXRlZCBGaW5kVUlXaWRnZXQgY2FsbHMgZHVyaW5nIGNsb2NrIHVwZGF0ZXMgKHBlcmZvcm1hbmNlIGNyaXRpY2FsKS4KLy8gTGlmZWN5Y2xlOgovLyAtIENyZWF0ZWQgb25jZSBwZXIgcGxheWVyIGJ5IGVuc3VyZUNsb2NrVUlBbmRHZXRDYWNoZS4KLy8gLSBSZXVzZWQgb24gZXZlcnkgY2xvY2sgdGljay4KLy8gLSBTYWZlIHRvIGRpc2NhcmQgaWYgSFVEIGlzIHJlYnVpbHQgKHdpbGwgYmUgcmVjcmVhdGVkKS4KaW50ZXJmYWNlIENsb2NrV2lkZ2V0Q2FjaGVFbnRyeSB7CiAgICByb290TmFtZTogc3RyaW5nOwogICAgcm91bmRTdGF0ZVJvb3ROYW1lOiBzdHJpbmc7CiAgICByb3VuZExpdmVIZWxwUm9vdE5hbWU6IHN0cmluZzsKICAgIHJvdW5kU3RhdGVUZXh0PzogbW9kLlVJV2lkZ2V0OwogICAgcGxheWVyc1JlYWR5VGV4dD86IG1vZC5VSVdpZGdldDsKICAgIHJvdW5kTGl2ZUhlbHBSb290PzogbW9kLlVJV2lkZ2V0OwogICAgcm91bmRMaXZlSGVscFRleHQ/OiBtb2QuVUlXaWRnZXQ7CiAgICBtaW5UZW5zOiBtb2QuVUlXaWRnZXQ7CiAgICBtaW5PbmVzOiBtb2QuVUlXaWRnZXQ7CiAgICBjb2xvbjogbW9kLlVJV2lkZ2V0OwogICAgc2VjVGVuczogbW9kLlVJV2lkZ2V0OwogICAgc2VjT25lczogbW9kLlVJV2lkZ2V0Owp9CgpleHBvcnQgZnVuY3Rpb24gUmVzZXRSb3VuZENsb2NrKHNlY29uZHM6IG51bWJlcik6IHZvaWQgewogICAgU3RhdGUucm91bmQuY2xvY2suZHVyYXRpb25TZWNvbmRzID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihzZWNvbmRzKSk7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5tYXRjaFN0YXJ0RWxhcHNlZFNlY29uZHMgPSBNYXRoLmZsb29yKG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCkpOwoKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmlzUGF1c2VkID0gZmFsc2U7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5wYXVzZWRSZW1haW5pbmdTZWNvbmRzID0gdW5kZWZpbmVkOwoKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmV4cGlyeUZpcmVkID0gZmFsc2U7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5sYXN0RGlzcGxheWVkU2Vjb25kcyA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmxhc3RMb3dUaW1lU3RhdGUgPSB1bmRlZmluZWQ7Cn0KCmZ1bmN0aW9uIGdldFJlbWFpbmluZ1NlY29uZHMoKTogbnVtYmVyIHsKICAgIGlmIChTdGF0ZS5yb3VuZC5jbG9jay5pc1BhdXNlZCkgewogICAgICAgIHJldHVybiBNYXRoLm1heCgwLCBTdGF0ZS5yb3VuZC5jbG9jay5wYXVzZWRSZW1haW5pbmdTZWNvbmRzICE9PSB1bmRlZmluZWQgPyBTdGF0ZS5yb3VuZC5jbG9jay5wYXVzZWRSZW1haW5pbmdTZWNvbmRzIDogMCk7CiAgICB9CgogICAgaWYgKFN0YXRlLnJvdW5kLmNsb2NrLm1hdGNoU3RhcnRFbGFwc2VkU2Vjb25kcyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gMDsKCiAgICBjb25zdCBlbGFwc2VkID0gTWF0aC5mbG9vcihtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpKSAtIFN0YXRlLnJvdW5kLmNsb2NrLm1hdGNoU3RhcnRFbGFwc2VkU2Vjb25kczsKICAgIHJldHVybiBNYXRoLm1heCgwLCBTdGF0ZS5yb3VuZC5jbG9jay5kdXJhdGlvblNlY29uZHMgLSBlbGFwc2VkKTsKfQoKZnVuY3Rpb24gYWRqdXN0Um91bmRDbG9ja0J5U2Vjb25kcyhkZWx0YVNlY29uZHM6IG51bWJlcik6IHZvaWQgewogICAgY29uc3QgZGVsdGEgPSBNYXRoLmZsb29yKGRlbHRhU2Vjb25kcyk7CgogICAgaWYgKFN0YXRlLnJvdW5kLmNsb2NrLmlzUGF1c2VkKSB7CiAgICAgICAgY29uc3QgY3VycmVudCA9IFN0YXRlLnJvdW5kLmNsb2NrLnBhdXNlZFJlbWFpbmluZ1NlY29uZHMgIT09IHVuZGVmaW5lZCA/IFN0YXRlLnJvdW5kLmNsb2NrLnBhdXNlZFJlbWFpbmluZ1NlY29uZHMgOiAwOwogICAgICAgIFN0YXRlLnJvdW5kLmNsb2NrLnBhdXNlZFJlbWFpbmluZ1NlY29uZHMgPSBNYXRoLm1heCgwLCBjdXJyZW50ICsgZGVsdGEpOwogICAgICAgIFN0YXRlLnJvdW5kLmNsb2NrLmR1cmF0aW9uU2Vjb25kcyA9IE1hdGgubWF4KDAsIFN0YXRlLnJvdW5kLmNsb2NrLmR1cmF0aW9uU2Vjb25kcyArIGRlbHRhKTsKICAgIH0gZWxzZSB7CiAgICAgICAgU3RhdGUucm91bmQuY2xvY2suZHVyYXRpb25TZWNvbmRzID0gTWF0aC5tYXgoMCwgU3RhdGUucm91bmQuY2xvY2suZHVyYXRpb25TZWNvbmRzICsgZGVsdGEpOwogICAgfQoKICAgIGlmIChkZWx0YSA+IDApIHsKICAgICAgICBTdGF0ZS5yb3VuZC5jbG9jay5leHBpcnlGaXJlZCA9IGZhbHNlOwogICAgfQoKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmxhc3REaXNwbGF5ZWRTZWNvbmRzID0gdW5kZWZpbmVkOwogICAgU3RhdGUucm91bmQuY2xvY2subGFzdExvd1RpbWVTdGF0ZSA9IHVuZGVmaW5lZDsKfQoKZnVuY3Rpb24gcmVzZXRSb3VuZENsb2NrVG9EZWZhdWx0KCk6IHZvaWQgewogICAgUmVzZXRSb3VuZENsb2NrKFJPVU5EX1NUQVJUX1NFQ09ORFMpOwp9CgovLyBQdXNoZXMgdGhlIGN1cnJlbnQgcm91bmQgY2xvY2sgc3RhdGUgdG8gYWxsIHBsYXllcnMnIEhVRHMuCi8vIE11c3QgYmUgY2FsbGVkIGFmdGVyIGFueSBtYW51YWwgYWRtaW4gYWRqdXN0bWVudCBvciByZXNldCBvZiB0aGUgY2xvY2suCgovKioKICogUmVmcmVzaGVzIHRoZSB2aXNpYmxlIHJvdW5kIGNsb2NrIGZvciBhbGwgcGxheWVycy4KICogRXhwZWN0ZWQgdXNhZ2U6CiAqIC0gQ2FsbGVkIHdoZW4gdGhlIGF1dGhvcml0YXRpdmUgY2xvY2sgc2Vjb25kcyBjaGFuZ2UgKHRpY2spIG9yIHdoZW4gY2xvY2sgc3R5bGUgY2hhbmdlcyAobG93IHRpbWUpLgogKiBQZXJmb3JtYW5jZSBub3RlOgogKiAtIFRoaXMgc2hvdWxkIHJlbWFpbiBhIGxpZ2h0d2VpZ2h0IHBhc3MgdGhhdCBvbmx5IHVwZGF0ZXMgd2lkZ2V0cyB3aGVuIHRoZSBkaXNwbGF5ZWQgdmFsdWUgY2hhbmdlcy4KICovCgpmdW5jdGlvbiB1cGRhdGVBbGxQbGF5ZXJzQ2xvY2soKTogdm9pZCB7CiAgICBjb25zdCByZW1haW5pbmcgPSBnZXRSZW1haW5pbmdTZWNvbmRzKCk7CgogICAgaWYgKCFTdGF0ZS5yb3VuZC5jbG9jay5leHBpcnlGaXJlZCAmJiByZW1haW5pbmcgPD0gMCkgewogICAgICAgIFN0YXRlLnJvdW5kLmNsb2NrLmV4cGlyeUZpcmVkID0gdHJ1ZTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFN0YXRlLnJvdW5kLmNsb2NrLmV4cGlyeUhhbmRsZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIFN0YXRlLnJvdW5kLmNsb2NrLmV4cGlyeUhhbmRsZXJzW2ldKCk7CiAgICAgICAgfQogICAgfQoKICAgIGNvbnN0IGxvd1RpbWUgPSByZW1haW5pbmcgPCBMT1dfVElNRV9USFJFU0hPTERfU0VDT05EUzsKCiAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcihyZW1haW5pbmcgLyA2MCk7CiAgICAvLyBSZWFkIHRoZSBhdXRob3JpdGF0aXZlIHJlbWFpbmluZyBzZWNvbmRzIGZvciB0aGUgcm91bmQgY2xvY2suCmNvbnN0IHNlY29uZHMgPSByZW1haW5pbmcgJSA2MDsKCiAgICBjb25zdCBkaWdpdHMgPSB7CiAgICAgICAgbVQ6IE1hdGguZmxvb3IobWludXRlcyAvIDEwKSwKICAgICAgICBtTzogbWludXRlcyAlIDEwLAogICAgICAgIHNUOiBNYXRoLmZsb29yKHNlY29uZHMgLyAxMCksCiAgICAgICAgc086IHNlY29uZHMgJSAxMCwKICAgIH07CgogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHBsYXllciA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgY29udGludWU7CgogICAgICAgIC8vIEVuc3VyZSBlYWNoIHBsYXllcidzIGNsb2NrIHdpZGdldHMgZXhpc3QgYW5kIGdldCBjYWNoZWQgcmVmcyBmb3IgZWZmaWNpZW50IHVwZGF0ZXMuCiAgICAgICAgY29uc3QgY2FjaGVFbnRyeSA9IGVuc3VyZUNsb2NrVUlBbmRHZXRDYWNoZShwbGF5ZXIpOwogICAgICAgIGlmICghY2FjaGVFbnRyeSkgY29udGludWU7CgogICAgICAgIGlmIChTdGF0ZS5yb3VuZC5jbG9jay5sYXN0TG93VGltZVN0YXRlID09PSB1bmRlZmluZWQgfHwgbG93VGltZSAhPT0gU3RhdGUucm91bmQuY2xvY2subGFzdExvd1RpbWVTdGF0ZSkgewogICAgICAgICAgICBzZXRDbG9ja0NvbG9yQ2FjaGVkKGNhY2hlRW50cnksIGxvd1RpbWUgPyBDT0xPUl9MT1dfVElNRSA6IENPTE9SX05PUk1BTCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RhdGUucm91bmQuY2xvY2subGFzdERpc3BsYXllZFNlY29uZHMgIT09IHJlbWFpbmluZykgewogICAgICAgICAgICBzZXREaWdpdENhY2hlZChjYWNoZUVudHJ5Lm1pblRlbnMsIGRpZ2l0cy5tVCk7CiAgICAgICAgICAgIHNldERpZ2l0Q2FjaGVkKGNhY2hlRW50cnkubWluT25lcywgZGlnaXRzLm1PKTsKICAgICAgICAgICAgc2V0Q29sb25DYWNoZWQoY2FjaGVFbnRyeS5jb2xvbik7CiAgICAgICAgICAgIHNldERpZ2l0Q2FjaGVkKGNhY2hlRW50cnkuc2VjVGVucywgZGlnaXRzLnNUKTsKICAgICAgICAgICAgc2V0RGlnaXRDYWNoZWQoY2FjaGVFbnRyeS5zZWNPbmVzLCBkaWdpdHMuc08pOwogICAgICAgIH0KCiAgICAgICAgdXBkYXRlVmljdG9yeURpYWxvZ0ZvclBsYXllcihwbGF5ZXIsIHJlbWFpbmluZyk7CiAgICB9CgogICAgU3RhdGUucm91bmQuY2xvY2subGFzdExvd1RpbWVTdGF0ZSA9IGxvd1RpbWU7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5sYXN0RGlzcGxheWVkU2Vjb25kcyA9IHJlbWFpbmluZzsKfQoKLyoqCiAqIEVuc3VyZXMgdGhlIGNsb2NrIFVJIHdpZGdldHMgZXhpc3QgZm9yIGEgZ2l2ZW4gcGxheWVyIGFuZCByZXR1cm5zIHRoZSBjYWNoZWQgcmVmZXJlbmNlcy4KICogUmVzcG9uc2liaWxpdGllczoKICogLSBDcmVhdGUgYW55IG1pc3NpbmcgZGlnaXQvY29sb24gd2lkZ2V0cyAob25lLXRpbWUgcGVyIHBsYXllcikuCiAqIC0gUmV0dXJuIGEgY2FjaGUgb2JqZWN0IHRoYXQgdGhlIGNsb2NrIHVwZGF0ZSBjb2RlIGNhbiB1c2Ugd2l0aG91dCByZXBlYXRlZCB3aWRnZXQgbG9va3Vwcy4KICogTm9uLXJlc3BvbnNpYmlsaXRpZXM6CiAqIC0gRG9lcyBub3Qgc3RhcnQvc3RvcCB0aGUgY2xvY2s7IGl0IG9ubHkgZW5zdXJlcyBVSSBleGlzdHMuCiAqLwoKZnVuY3Rpb24gZW5zdXJlQ2xvY2tVSUFuZEdldENhY2hlKHBsYXllcjogbW9kLlBsYXllcik6IENsb2NrV2lkZ2V0Q2FjaGVFbnRyeSB8IHVuZGVmaW5lZCB7CiAgICAvLyBDbG9jayB3aWRnZXRzIGFyZSBzdG9yZWQgcGVyLXBsYXllcjsgZGVyaXZlIHBpZCBmb3IgY2FjaGUgbG9va3VwLgpjb25zdCBwaWQgPSBtb2QuR2V0T2JqSWQocGxheWVyKTsKICAgIGNvbnN0IHJvb3ROYW1lID0gIk1hdGNoVGltZXJSb290XyIgKyBwaWQ7CiAgICBjb25zdCByb3VuZFN0YXRlUm9vdE5hbWUgPSAiUm91bmRTdGF0ZVJvb3RfIiArIHBpZDsKICAgIGNvbnN0IHJvdW5kTGl2ZUhlbHBSb290TmFtZSA9ICJSb3VuZExpdmVIZWxwUm9vdF8iICsgcGlkOwoKICAgIGNvbnN0IGNhY2hlZCA9IFN0YXRlLmh1ZENhY2hlLmNsb2NrV2lkZ2V0Q2FjaGVbcGlkXTsKICAgIGlmIChjYWNoZWQpIHsKICAgICAgICBjb25zdCBwcm9iZUNsb2NrID0gc2FmZUZpbmQoY2FjaGVkLnJvb3ROYW1lKTsKICAgICAgICBjb25zdCBwcm9iZVN0YXRlID0gc2FmZUZpbmQoY2FjaGVkLnJvdW5kU3RhdGVSb290TmFtZSk7CiAgICAgICAgY29uc3QgcHJvYmVIZWxwID0gc2FmZUZpbmQoY2FjaGVkLnJvdW5kTGl2ZUhlbHBSb290TmFtZSk7CiAgICAgICAgaWYgKHByb2JlQ2xvY2sgJiYgcHJvYmVTdGF0ZSAmJiBwcm9iZUhlbHApIHsKICAgICAgICAgICAgbW9kLlNldFVJV2lkZ2V0UG9zaXRpb24ocHJvYmVIZWxwLCBtb2QuQ3JlYXRlVmVjdG9yKENMT0NLX1BPU0lUSU9OX1gsIDEyMCwgMCkpOwogICAgICAgICAgICByZXR1cm4gY2FjaGVkOwogICAgICAgIH0KICAgIH0KCiAgICBjb25zdCBkaWdpdFdpZHRoID0gQ0xPQ0tfV0lEVEggKiAwLjEyOwogICAgY29uc3QgY29sb25XaWR0aCA9IENMT0NLX1dJRFRIICogMC4wNjsKCiAgICBjb25zdCB4T2Zmc2V0cyA9IHsKICAgICAgICBtaW5UZW5zOiAtZGlnaXRXaWR0aCAqIDEuOCArIDE0LCAKICAgICAgICBtaW5PbmVzOiAtZGlnaXRXaWR0aCAqIDAuOCArIDgsIAogICAgICAgIGNvbG9uOiAtZGlnaXRXaWR0aCAqIDAuMDUsCiAgICAgICAgc2VjVGVuczogZGlnaXRXaWR0aCAqIDAuOSAtIDEwLCAKICAgICAgICBzZWNPbmVzOiBkaWdpdFdpZHRoICogMS45IC0gMTYsIAogICAgfTsKCiAgICBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgbmFtZTogcm9vdE5hbWUsCiAgICAgICAgdHlwZTogIkNvbnRhaW5lciIsCiAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICBwb3NpdGlvbjogW0NMT0NLX1BPU0lUSU9OX1gsIENMT0NLX1BPU0lUSU9OX1ldLAogICAgICAgIHNpemU6IFtDTE9DS19XSURUSCwgQ0xPQ0tfSEVJR0hUXSwKICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgLy8gU2xvdyBwYXRoOiBjcmVhdGUgZGlnaXQgd2lkZ2V0cyBvbmNlIHBlciBwbGF5ZXIsIHRoZW4gY2FjaGUgcmVmcyBmb3IgZnV0dXJlIHVwZGF0ZXMuCiAgICAgICAgICAgIGJ1aWxkRGlnaXQoIk1pblRlbnMiLCBwaWQsIHhPZmZzZXRzLm1pblRlbnMsIGRpZ2l0V2lkdGgpLAogICAgICAgICAgICBidWlsZERpZ2l0KCJNaW5PbmVzIiwgcGlkLCB4T2Zmc2V0cy5taW5PbmVzLCBkaWdpdFdpZHRoKSwKICAgICAgICAgICAgYnVpbGRDb2xvbihwaWQsIHhPZmZzZXRzLmNvbG9uLCBjb2xvbldpZHRoKSwKICAgICAgICAgICAgYnVpbGREaWdpdCgiU2VjVGVucyIsIHBpZCwgeE9mZnNldHMuc2VjVGVucywgZGlnaXRXaWR0aCksCiAgICAgICAgICAgIGJ1aWxkRGlnaXQoIlNlY09uZXMiLCBwaWQsIHhPZmZzZXRzLnNlY09uZXMsIGRpZ2l0V2lkdGgpLAogICAgICAgIF0sCiAgICB9KTsKCiAgICAvLyBDcmVhdGUgcm91bmQtc3RhdGUgdGV4dCB1bmRlciB0aGUgbWF0Y2ggY2xvY2sgZm9yIHRoaXMgcGxheWVyLgogICAgbW9kbGliLlBhcnNlVUkoewogICAgICAgIG5hbWU6IHJvdW5kU3RhdGVSb290TmFtZSwKICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgIHBvc2l0aW9uOiBbQ0xPQ0tfUE9TSVRJT05fWCwgQ0xPQ0tfUE9TSVRJT05fWSArIENMT0NLX0hFSUdIVCAtIDEwXSwKICAgICAgICBzaXplOiBbQ0xPQ0tfV0lEVEgsIDM0XSwKICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgY2hpbGRyZW46IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogIlJvdW5kU3RhdGVUZXh0XyIgKyBwaWQsCiAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCAwXSwKICAgICAgICAgICAgICAgIHNpemU6IFtDTE9DS19XSURUSCwgMThdLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgICAgICAgICAgYmdGaWxsOiBtb2QuVUlCZ0ZpbGwuTm9uZSwKICAgICAgICAgICAgICAgIHRleHRMYWJlbDogbW9kLnN0cmluZ2tleXMudHdsLmh1ZC5yb3VuZFN0YXRlTm90UmVhZHksCiAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6ICJQbGF5ZXJzUmVhZHlUZXh0XyIgKyBwaWQsCiAgICAgICAgICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5Ub3BDZW50ZXIsCiAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgICAgICAgICAgcG9zaXRpb246IFswLCAxNF0sCiAgICAgICAgICAgICAgICBzaXplOiBbQ0xPQ0tfV0lEVEgsIDE4XSwKICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgcGFkZGluZzogMCwKICAgICAgICAgICAgICAgIGJnQWxwaGE6IDAsCiAgICAgICAgICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICAgICAgLy8gUGxhY2Vob2xkZXIgbGFiZWw7IHJ1bnRpbWUgd2lsbCBzZXQgZnVsbCAie1h9IC8ge1l9IFBMQVlFUlMgUkVBRFkiIGZvcm1hdC4KICAgICAgICAgICAgICAgIHRleHRMYWJlbDogIiIsCiAgICAgICAgICAgICAgICAvLyBZZWxsb3csIG1hdGNoaW5nIG90aGVyIGltcG9ydGFudCBIVUQgY2FsbG91dHMuCiAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAwXSwKICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMSwKICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgIH0sCiAgICAgICAgXSwKICAgIH0pOwoKICAgIC8vIENyZWF0ZSByb3VuZC1saXZlIGhlbHAgdGV4dCB1bmRlciB0aGUgcm91bmQtc3RhdGUgZm9yIHRoaXMgcGxheWVyLgogICAgbW9kbGliLlBhcnNlVUkoewogICAgICAgIG5hbWU6IHJvdW5kTGl2ZUhlbHBSb290TmFtZSwKICAgICAgICB0eXBlOiAiQ29udGFpbmVyIiwKICAgICAgICBwbGF5ZXJJZDogcGxheWVyLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLlRvcENlbnRlciwKICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgIHBvc2l0aW9uOiBbQ0xPQ0tfUE9TSVRJT05fWCwgMTIwXSwKICAgICAgICBzaXplOiBbUk9VTkRfTElWRV9IRUxQX1dJRFRILCBST1VORF9MSVZFX0hFTFBfSEVJR0hUXSwKICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6ICJSb3VuZExpdmVIZWxwVGV4dF8iICsgcGlkLAogICAgICAgICAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgICAgICAgICAgYW5jaG9yOiBtb2QuVUlBbmNob3IuVG9wQ2VudGVyLAogICAgICAgICAgICAgICAgLy8gcG9zaXRpb246IFt4LCB5XSBvZmZzZXQ7IGRpcmVjdGlvbiBkZXBlbmRzIG9uIGFuY2hvciwgc28gdmVyaWZ5IHZpc3VhbGx5IGluLWdhbWUKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBbMCwgMF0sCiAgICAgICAgICAgICAgICBzaXplOiBbUk9VTkRfTElWRV9IRUxQX1dJRFRILCBST1VORF9MSVZFX0hFTFBfSEVJR0hUXSwKICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgICAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICAgICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLk5vbmUsCiAgICAgICAgICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQucm91bmRMaXZlSGVscEZvcm1hdCwgMCksCiAgICAgICAgICAgICAgICB0ZXh0Q29sb3I6IFsxLCAxLCAxXSwKICAgICAgICAgICAgICAgIHRleHRBbHBoYTogMSwKICAgICAgICAgICAgICAgIHRleHRTaXplOiAxMiwKICAgICAgICAgICAgICAgIHRleHRBbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgICAgIH0sCiAgICAgICAgXSwKICAgIH0pOwoKICAgIGNvbnN0IGVudHJ5OiBDbG9ja1dpZGdldENhY2hlRW50cnkgPSB7CiAgICAgICAgcm9vdE5hbWU6IHJvb3ROYW1lLAogICAgICAgIHJvdW5kU3RhdGVSb290TmFtZTogcm91bmRTdGF0ZVJvb3ROYW1lLAogICAgICAgIHJvdW5kTGl2ZUhlbHBSb290TmFtZTogcm91bmRMaXZlSGVscFJvb3ROYW1lLAogICAgICAgIG1pblRlbnM6IHNhZmVGaW5kKCJNYXRjaFRpbWVyTWluVGVuc18iICsgcGlkKSBhcyBtb2QuVUlXaWRnZXQsCiAgICAgICAgbWluT25lczogc2FmZUZpbmQoIk1hdGNoVGltZXJNaW5PbmVzXyIgKyBwaWQpIGFzIG1vZC5VSVdpZGdldCwKICAgICAgICBjb2xvbjogc2FmZUZpbmQoIk1hdGNoVGltZXJDb2xvbl8iICsgcGlkKSBhcyBtb2QuVUlXaWRnZXQsCiAgICAgICAgc2VjVGVuczogc2FmZUZpbmQoIk1hdGNoVGltZXJTZWNUZW5zXyIgKyBwaWQpIGFzIG1vZC5VSVdpZGdldCwKICAgICAgICBzZWNPbmVzOiBzYWZlRmluZCgiTWF0Y2hUaW1lclNlY09uZXNfIiArIHBpZCkgYXMgbW9kLlVJV2lkZ2V0LAogICAgICAgIHJvdW5kU3RhdGVUZXh0OiBzYWZlRmluZCgiUm91bmRTdGF0ZVRleHRfIiArIHBpZCkgYXMgbW9kLlVJV2lkZ2V0LAogICAgICAgIHBsYXllcnNSZWFkeVRleHQ6IHNhZmVGaW5kKCJQbGF5ZXJzUmVhZHlUZXh0XyIgKyBwaWQpIGFzIG1vZC5VSVdpZGdldCwKICAgICAgICByb3VuZExpdmVIZWxwUm9vdDogc2FmZUZpbmQocm91bmRMaXZlSGVscFJvb3ROYW1lKSBhcyBtb2QuVUlXaWRnZXQsCiAgICAgICAgcm91bmRMaXZlSGVscFRleHQ6IHNhZmVGaW5kKCJSb3VuZExpdmVIZWxwVGV4dF8iICsgcGlkKSBhcyBtb2QuVUlXaWRnZXQsCiAgICB9OwoKICAgIGlmICgKICAgICAgICAhZW50cnkubWluVGVucyB8fAogICAgICAgICFlbnRyeS5taW5PbmVzIHx8CiAgICAgICAgIWVudHJ5LmNvbG9uIHx8CiAgICAgICAgIWVudHJ5LnNlY1RlbnMgfHwKICAgICAgICAhZW50cnkuc2VjT25lcyB8fAogICAgICAgICFlbnRyeS5yb3VuZFN0YXRlVGV4dCB8fAogICAgICAgICFlbnRyeS5wbGF5ZXJzUmVhZHlUZXh0IHx8CiAgICAgICAgIWVudHJ5LnJvdW5kTGl2ZUhlbHBSb290IHx8CiAgICAgICAgIWVudHJ5LnJvdW5kTGl2ZUhlbHBUZXh0CiAgICApIHsKICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIFN0YXRlLmh1ZENhY2hlLmNsb2NrV2lkZ2V0Q2FjaGVbcGlkXSA9IGVudHJ5OwogICAgc2V0Q2xvY2tDb2xvckNhY2hlZChlbnRyeSwgQ09MT1JfTk9STUFMKTsKCiAgICByZXR1cm4gZW50cnk7Cn0KCmZ1bmN0aW9uIGJ1aWxkRGlnaXQocGFydDogc3RyaW5nLCBwaWQ6IG51bWJlciwgeDogbnVtYmVyLCB3aWR0aDogbnVtYmVyKSB7CiAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJNYXRjaFRpbWVyIiArIHBhcnQgKyAiXyIgKyBwaWQsCiAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgIHBvc2l0aW9uOiBbeCwgMF0sCiAgICAgICAgc2l6ZTogW3dpZHRoLCBDTE9DS19IRUlHSFRdLAogICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICB0ZXh0TGFiZWw6IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suZGlnaXQsIDApLAogICAgICAgIHRleHRTaXplOiBDTE9DS19GT05UX1NJWkUsCiAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgIH07Cn0KCmZ1bmN0aW9uIGJ1aWxkQ29sb24ocGlkOiBudW1iZXIsIHg6IG51bWJlciwgd2lkdGg6IG51bWJlcikgewogICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiTWF0Y2hUaW1lckNvbG9uXyIgKyBwaWQsCiAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICAvLyBwb3NpdGlvbjogW3gsIHldIG9mZnNldDsgZGlyZWN0aW9uIGRlcGVuZHMgb24gYW5jaG9yLCBzbyB2ZXJpZnkgdmlzdWFsbHkgaW4tZ2FtZQogICAgICAgIHBvc2l0aW9uOiBbeCwgMF0sCiAgICAgICAgc2l6ZTogW3dpZHRoLCBDTE9DS19IRUlHSFRdLAogICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICB0ZXh0TGFiZWw6IG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suY29sb24sCiAgICAgICAgdGV4dFNpemU6IENMT0NLX0ZPTlRfU0laRSwKICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgfTsKfQoKZnVuY3Rpb24gc2V0RGlnaXRDYWNoZWQod2lkZ2V0OiBtb2QuVUlXaWRnZXQsIGRpZ2l0OiBudW1iZXIpOiB2b2lkIHsKICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3aWRnZXQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5odWQuY2xvY2suZGlnaXQsIGRpZ2l0KSk7Cn0KCmZ1bmN0aW9uIHNldENvbG9uQ2FjaGVkKHdpZGdldDogbW9kLlVJV2lkZ2V0KTogdm9pZCB7CiAgICBtb2QuU2V0VUlUZXh0TGFiZWwod2lkZ2V0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuaHVkLmNsb2NrLmNvbG9uKSk7Cn0KCmZ1bmN0aW9uIHNldENsb2NrQ29sb3JDYWNoZWQoY2FjaGVFbnRyeTogQ2xvY2tXaWRnZXRDYWNoZUVudHJ5LCBjb2xvcjogYW55KTogdm9pZCB7CiAgICBtb2QuU2V0VUlUZXh0Q29sb3IoY2FjaGVFbnRyeS5taW5UZW5zLCBjb2xvcik7CiAgICBtb2QuU2V0VUlUZXh0Q29sb3IoY2FjaGVFbnRyeS5taW5PbmVzLCBjb2xvcik7CiAgICBtb2QuU2V0VUlUZXh0Q29sb3IoY2FjaGVFbnRyeS5jb2xvbiwgY29sb3IpOwogICAgbW9kLlNldFVJVGV4dENvbG9yKGNhY2hlRW50cnkuc2VjVGVucywgY29sb3IpOwogICAgbW9kLlNldFVJVGV4dENvbG9yKGNhY2hlRW50cnkuc2VjT25lcywgY29sb3IpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gTWF0Y2ggQ2xvY2sgKHBlci1wbGF5ZXIgTU06U1MpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBUZWFtIFN3aXRjaCBEYXRhICsgQ29uZmlnIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgppbnRlcmZhY2UgVGVhbVN3aXRjaENvbmZpZyB7CiAgICBlbmFibGVUZWFtU3dpdGNoOiBib29sZWFuOwogICAgaW50ZXJhY3RQb2ludE1pbkxpZmV0aW1lOiBudW1iZXI7CiAgICBpbnRlcmFjdFBvaW50TWF4TGlmZXRpbWU6IG51bWJlcjsKICAgIHZlbG9jaXR5VGhyZXNob2xkOiBudW1iZXI7Cn0KCmludGVyZmFjZSB0ZWFtU3dpdGNoRGF0YV90IHsKICAgIGludGVyYWN0UG9pbnQ6IG1vZC5JbnRlcmFjdFBvaW50IHwgbnVsbDsKICAgIGxhc3REZXBsb3lUaW1lOiBudW1iZXI7CiAgICBkb250U2hvd0FnYWluOiBib29sZWFuOwogICAgYWRtaW5QYW5lbFZpc2libGU6IGJvb2xlYW47CiAgICBhZG1pblBhbmVsQnVpbHQ6IGJvb2xlYW47CiAgICBsYXN0QWRtaW5QYW5lbFRvZ2dsZUF0OiBudW1iZXI7CiAgICBkaWFsb2dWaXNpYmxlOiBib29sZWFuOwogICAgLy8gVUkgY2FjaGluZzogdHJ1ZSBhZnRlciB0aGUgZmlyc3Qgd2FybS11cCBidWlsZCBzbyBzdWJzZXF1ZW50IG9wZW5zIGNhbiBiZSBpbnN0YW50LgogICAgdWlCdWlsdDogYm9vbGVhbjsKICAgIHBvc0RlYnVnVmlzaWJsZTogYm9vbGVhbjsKICAgIHBvc0RlYnVnVG9rZW46IG51bWJlcjsKfQoKLy8gUGVyLXBsYXllciBzdGF0ZSBsaXZlcyBpbiBTdGF0ZS5wbGF5ZXJzOgovLyAtIHRlYW1Td2l0Y2hEYXRhOiBkaWFsb2cgKyBpbnRlcmFjdC1wb2ludCBzdGF0ZSBwZXIgcGxheWVyLgovLyAtIHJlYWR5QnlQaWQ6IFJFQURZIHRvZ2dsZSBzdGF0ZSBmb3Igcm9zdGVyICsgYXV0by1zdGFydCBnYXRpbmcuCi8vIC0gaW5NYWluQmFzZUJ5UGlkOiBtYWluLWJhc2UgcHJlc2VuY2UgZm9yIHByZS1yb3VuZCBnYXRpbmcgKyBVSS4KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBUZWFtIFN3aXRjaCBEYXRhICsgQ29uZmlnIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBUZWFtIFN3aXRjaCBMb2dpYyAoaW50ZXJhY3QgcG9pbnQgKyBzd2FwIHRlYW1zKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKYXN5bmMgZnVuY3Rpb24gc3Bhd25UZWFtU3dpdGNoSW50ZXJhY3RQb2ludChldmVudFBsYXllcjogbW9kLlBsYXllcikgewogICAgaWYgKCFpc1BsYXllckRlcGxveWVkKGV2ZW50UGxheWVyKSkgcmV0dXJuOwogICAgY29uc3QgcGxheWVySWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXSkgaW5pdFRlYW1Td2l0Y2hEYXRhKGV2ZW50UGxheWVyKTsKCiAgICBpZiAoCiAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uaW50ZXJhY3RQb2ludCA9PT0gbnVsbCAmJgogICAgICAgICFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5kb250U2hvd0FnYWluICYmCiAgICAgICAgVEVBTVNXSVRDSENPTkZJRy5lbmFibGVUZWFtU3dpdGNoCiAgICApIHsKICAgICAgICBsZXQgaXNPbkdyb3VuZCA9IG1vZC5HZXRTb2xkaWVyU3RhdGUoZXZlbnRQbGF5ZXIsIG1vZC5Tb2xkaWVyU3RhdGVCb29sLklzT25Hcm91bmQpOwoKICAgICAgICB3aGlsZSAoIWlzT25Hcm91bmQpIHsKICAgICAgICAgICAgYXdhaXQgbW9kLldhaXQoMC4yKTsKICAgICAgICAgICAgaXNPbkdyb3VuZCA9IG1vZC5HZXRTb2xkaWVyU3RhdGUoZXZlbnRQbGF5ZXIsIG1vZC5Tb2xkaWVyU3RhdGVCb29sLklzT25Hcm91bmQpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcGxheWVyUG9zaXRpb24gPSBtb2QuR2V0U29sZGllclN0YXRlKGV2ZW50UGxheWVyLCBtb2QuU29sZGllclN0YXRlVmVjdG9yLkdldFBvc2l0aW9uKTsKICAgICAgICBjb25zdCBwbGF5ZXJGYWNpbmdEaXJlY3Rpb24gPSBtb2QuR2V0U29sZGllclN0YXRlKGV2ZW50UGxheWVyLCBtb2QuU29sZGllclN0YXRlVmVjdG9yLkdldEZhY2luZ0RpcmVjdGlvbik7CgogICAgICAgIGNvbnN0IGludGVyYWN0UG9pbnRQb3NpdGlvbiA9IG1vZC5BZGQoCiAgICAgICAgICAgIG1vZC5BZGQocGxheWVyUG9zaXRpb24sIHBsYXllckZhY2luZ0RpcmVjdGlvbiksCiAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMS41LCAwKQogICAgICAgICk7CgogICAgICAgIGNvbnN0IGludGVyYWN0UG9pbnQ6IG1vZC5JbnRlcmFjdFBvaW50ID0gbW9kLlNwYXduT2JqZWN0KAogICAgICAgICAgICBtb2QuUnVudGltZVNwYXduX0NvbW1vbi5JbnRlcmFjdFBvaW50LAogICAgICAgICAgICBpbnRlcmFjdFBvaW50UG9zaXRpb24sCiAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCkKICAgICAgICApOwoKICAgICAgICBtb2QuRW5hYmxlSW50ZXJhY3RQb2ludChpbnRlcmFjdFBvaW50LCB0cnVlKTsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5pbnRlcmFjdFBvaW50ID0gaW50ZXJhY3RQb2ludDsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5sYXN0RGVwbG95VGltZSA9IG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCk7CiAgICB9Cn0KCmZ1bmN0aW9uIHRlYW1Td2l0Y2hJbnRlcmFjdFBvaW50QWN0aXZhdGVkKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyLCBldmVudEludGVyYWN0UG9pbnQ6IG1vZC5JbnRlcmFjdFBvaW50KSB7CiAgICBjb25zdCBwbGF5ZXJJZCA9IG1vZC5HZXRPYmpJZChldmVudFBsYXllcik7CiAgICBpZiAoIVN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdKSBpbml0VGVhbVN3aXRjaERhdGEoZXZlbnRQbGF5ZXIpOwoKICAgIGlmIChTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5pbnRlcmFjdFBvaW50ICE9IG51bGwpIHsKICAgICAgICBjb25zdCBpbnRlcmFjdFBvaW50SWQgPSBtb2QuR2V0T2JqSWQoU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uaW50ZXJhY3RQb2ludCk7CiAgICAgICAgY29uc3QgZXZlbnRJbnRlcmFjdFBvaW50SWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRJbnRlcmFjdFBvaW50KTsKICAgICAgICBpZiAoaW50ZXJhY3RQb2ludElkID09PSBldmVudEludGVyYWN0UG9pbnRJZCkgewogICAgICAgICAgICBtb2QuRW5hYmxlVUlJbnB1dE1vZGUodHJ1ZSwgZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICBjcmVhdGVUZWFtU3dpdGNoVUkoZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICAvLyBUcmFjayB2aXNpYmlsaXR5IHNvIHJvc3RlciByZWZyZXNoZXMgY2FuIHRhcmdldCBhbGwgdmlld2VycyB3aXRoIHRoZSBkaWFsb2cgb3Blbi4KICAgICAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uZGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICAgICAgICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBpZChwbGF5ZXJJZCk7CiAgICAgICAgICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yVmlld2VyKGV2ZW50UGxheWVyLCBwbGF5ZXJJZCk7CiAgICAgICAgICAgIC8vIEltbWVkaWF0ZSBzZWxmLXJlZnJlc2ggdG8gYXZvaWQgcmVseWluZyBzb2xlbHkgb24gZ2xvYmFsIHJlZnJlc2ggYm9va2tlZXBpbmcuCgogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gcmVtb3ZlVGVhbVN3aXRjaEludGVyYWN0UG9pbnQoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIgfCBudW1iZXIpIHsKICAgIGxldCBwbGF5ZXJJZDogbnVtYmVyOwoKICAgIGlmIChtb2QuSXNUeXBlKGV2ZW50UGxheWVyLCBtb2QuVHlwZXMuUGxheWVyKSkgewogICAgICAgIHBsYXllcklkID0gbW9kLkdldE9iaklkKGV2ZW50UGxheWVyIGFzIG1vZC5QbGF5ZXIpOwogICAgfSBlbHNlIHsKICAgICAgICBwbGF5ZXJJZCA9IGV2ZW50UGxheWVyIGFzIG51bWJlcjsKICAgIH0KCiAgICBpZiAoIVN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdKSByZXR1cm47CgogICAgaWYgKFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdLmludGVyYWN0UG9pbnQgIT0gbnVsbCkgewogICAgICAgIG1vZC5FbmFibGVJbnRlcmFjdFBvaW50KFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdLmludGVyYWN0UG9pbnQgYXMgbW9kLkludGVyYWN0UG9pbnQsIGZhbHNlKTsKICAgICAgICBtb2QuVW5zcGF3bk9iamVjdChTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5pbnRlcmFjdFBvaW50IGFzIG1vZC5JbnRlcmFjdFBvaW50KTsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5pbnRlcmFjdFBvaW50ID0gbnVsbDsKICAgIH0KfQoKZnVuY3Rpb24gaXNWZWxvY2l0eUJleW9uZCh0aHJlc2hvbGQ6IG51bWJlciwgZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIpOiBib29sZWFuIHsKICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChldmVudFBsYXllcikpIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IHYgPSBtb2QuR2V0U29sZGllclN0YXRlKGV2ZW50UGxheWVyLCBtb2QuU29sZGllclN0YXRlVmVjdG9yLkdldExpbmVhclZlbG9jaXR5KTsKICAgIGNvbnN0IHggPSBtb2QuQWJzb2x1dGVWYWx1ZShtb2QuWENvbXBvbmVudE9mKHYpKTsKICAgIGNvbnN0IHkgPSBtb2QuQWJzb2x1dGVWYWx1ZShtb2QuWUNvbXBvbmVudE9mKHYpKTsKICAgIGNvbnN0IHogPSBtb2QuQWJzb2x1dGVWYWx1ZShtb2QuWkNvbXBvbmVudE9mKHYpKTsKICAgIHJldHVybiB4ICsgeSArIHogPiB0aHJlc2hvbGQ7Cn0KCmZ1bmN0aW9uIGNoZWNrVGVhbVN3aXRjaEludGVyYWN0UG9pbnRSZW1vdmFsKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKSB7CiAgICBpZiAoIWlzUGxheWVyRGVwbG95ZWQoZXZlbnRQbGF5ZXIpKSByZXR1cm47CiAgICBpZiAoVEVBTVNXSVRDSENPTkZJRy5lbmFibGVUZWFtU3dpdGNoICYmICFtb2QuR2V0U29sZGllclN0YXRlKGV2ZW50UGxheWVyLCBtb2QuU29sZGllclN0YXRlQm9vbC5Jc0RlYWQpKSB7CiAgICAgICAgY29uc3QgcGxheWVySWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgICAgIGlmICghU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0pIGluaXRUZWFtU3dpdGNoRGF0YShldmVudFBsYXllcik7CgogICAgICAgIGlmIChTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5pbnRlcmFjdFBvaW50ICE9IG51bGwpIHsKICAgICAgICAgICAgY29uc3QgbGlmZXRpbWUgPSBtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpIC0gU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0ubGFzdERlcGxveVRpbWU7CgogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBpc1ZlbG9jaXR5QmV5b25kKFRFQU1TV0lUQ0hDT05GSUcudmVsb2NpdHlUaHJlc2hvbGQsIGV2ZW50UGxheWVyKSB8fAogICAgICAgICAgICAgICAgbGlmZXRpbWUgPiBURUFNU1dJVENIQ09ORklHLmludGVyYWN0UG9pbnRNYXhMaWZldGltZQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHJlbW92ZVRlYW1Td2l0Y2hJbnRlcmFjdFBvaW50KHBsYXllcklkKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gaW5pdFRlYW1Td2l0Y2hEYXRhKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKSB7CiAgICBjb25zdCBwbGF5ZXJJZCA9IG1vZC5HZXRPYmpJZChldmVudFBsYXllcik7CiAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXSA9IHsKICAgICAgICBkb250U2hvd0FnYWluOiBmYWxzZSwKICAgICAgICBhZG1pblBhbmVsVmlzaWJsZTogZmFsc2UsCiAgICAgICAgYWRtaW5QYW5lbEJ1aWx0OiBmYWxzZSwKICAgICAgICBsYXN0QWRtaW5QYW5lbFRvZ2dsZUF0OiAwLAogICAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICAgIGludGVyYWN0UG9pbnQ6IG51bGwsCiAgICAgICAgbGFzdERlcGxveVRpbWU6IDAsCiAgICAgICAgdWlCdWlsdDogZmFsc2UsCiAgICAgICAgcG9zRGVidWdWaXNpYmxlOiBmYWxzZSwKICAgICAgICBwb3NEZWJ1Z1Rva2VuOiAwLAogICAgfTsKfQoKLy8gSGFuZGxlcyBhIHBsYXllci1pbml0aWF0ZWQgdGVhbSBzd2l0Y2guCi8vIFRoaXMgZnVuY3Rpb24gdmFsaWRhdGVzIHRoZSByZXF1ZXN0LCB1cGRhdGVzIHRlYW0gbWVtYmVyc2hpcCwKLy8gYW5kIHRyaWdnZXJzIGFueSByZXF1aXJlZCBIVUQgb3Igc3RhdGUgcmVmcmVzaC4KCi8vIFBlcmZvcm1zIGFuIHVuZGVwbG95IHdpdGggYSBzaG9ydCBkZWxheSB0byBlbnN1cmUgdGhlIGVuZ2luZSBoYXMgYXBwbGllZCBhIHByaW9yIFNldFRlYW0oKSBiZWZvcmUgY2hhbmdpbmcgZGVwbG95IHN0YXRlLgovLyBUaGlzIGludGVudGlvbmFsbHkgZG9lcyBOT1QgcmUtZGVwbG95IHRoZSBwbGF5ZXI7IHRoZSBwbGF5ZXIgaXMgZXhwZWN0ZWQgdG8gY2hvb3NlIGEgc3Bhd24gcG9pbnQgbWFudWFsbHkuCmFzeW5jIGZ1bmN0aW9uIGZvcmNlVW5kZXBsb3lQbGF5ZXIoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIpOiBQcm9taXNlPHZvaWQ+IHsKICAgIC8vIFVuZGVwbG95IGltbWVkaWF0ZWx5IHNvIHRoZSBwbGF5ZXIgaXMgZm9yY2VkIHRvIHRoZSBkZXBsb3kgc2NyZWVuIHJpZ2h0IGF3YXkuCiAgICAvLyBUaGVuIHJldHJ5IG9uY2Ugd2l0aCBhIHNob3J0IGRlbGF5IGZvciByb2J1c3RuZXNzIGFjcm9zcyB0cmFuc2llbnQgZW5naW5lIHRpbWluZy4KICAgIG1vZC5VbmRlcGxveVBsYXllcihldmVudFBsYXllcik7CiAgICBhd2FpdCBtb2QuV2FpdCgwLjA1KTsKICAgIG1vZC5VbmRlcGxveVBsYXllcihldmVudFBsYXllcik7Cn0KCmZ1bmN0aW9uIHByb2Nlc3NUZWFtU3dpdGNoKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKSB7CiAgICAvLyBMZWdhY3kgdGVhbS1zd2l0Y2ggcGF0aHdheSByZXRhaW5lZCBmb3IgcmV1c2UgYnkgdGhlIFJlYWR5IERpYWxvZyAoU3dhcCBUZWFtcyBidXR0b246IFN3YXAgVGVhbXMgYnV0dG9uKS4KICAgIC8vIFJlcXVpcmVtZW50czoKICAgIC8vIC0gQ2hhbmdlIHRoZSBwbGF5ZXIncyB0ZWFtIGFzc2lnbm1lbnQgKFRlYW1JRC5UZWFtMSA8LT4gVGVhbUlELlRlYW0yKQogICAgLy8gLSBGb3JjZSB0aGUgcGxheWVyIGJhY2sgdG8gdGhlIGRlcGxveSBzY3JlZW4gb24gdGhlIG5ldyB0ZWFtIChub3QganVzdCB1cGRhdGUgVUkvcm9zdGVyIHN0YXRlKQogICAgLy8KICAgIC8vIE5PVEU6IFNvbWUgZW5naW5lcyBjYWNoZSB0ZWFtIGFmZmlsaWF0aW9uIG9uIHRoZSBkZXBsb3llZCBzb2xkaWVyIGVudGl0eTsgdGhlcmVmb3JlIHdlOgogICAgLy8gMSkgU2V0IHRoZSB0ZWFtLCB0aGVuCiAgICAvLyAyKSBVbmRlcGxveSB0aGUgcGxheWVyIHNvIHRoZXkgbXVzdCByZWRlcGxveSBvbiB0aGUgbmV3IHRlYW0uCgogICAgY29uc3QgY3VycmVudFRlYW1OdW0gPSBnZXRUZWFtTnVtYmVyKG1vZC5HZXRUZWFtKGV2ZW50UGxheWVyKSk7CiAgICBjb25zdCBuZXdUZWFtTnVtID0gKGN1cnJlbnRUZWFtTnVtID09PSBUZWFtSUQuVGVhbTIpID8gVGVhbUlELlRlYW0xIDogVGVhbUlELlRlYW0yOwogICAgbW9kLlNldFRlYW0oZXZlbnRQbGF5ZXIsIG1vZC5HZXRUZWFtKG5ld1RlYW1OdW0pKTsKCiAgICAvLyBGb3JjZSBhIHJhcGlkIHJldHVybiB0byB0aGUgZGVwbG95IHNjcmVlbiBzbyB0aGUgcGxheWVyIHJlc3Bhd25zIG9uIHRoZSBuZXcgdGVhbS4KICAgIC8vIE5vdGU6IGRvIG5vdCBtb2RpZnkgcmVkZXBsb3kgdGltZXJzIGdsb2JhbGx5OyB3ZSBvbmx5IGZvcmNlIGFuIHVuZGVwbG95IHNvIHRoZSBwbGF5ZXIgY2FuIGNob29zZSBzcGF3biBtYW51YWxseS4KICAgIC8vIEVuc3VyZSB0ZWFtIHN3aXRjaGluZyBkb2VzIG5vdCBncmFudCBmYXN0ZXItdGhhbi1ub3JtYWwgcmVzcGF3biB0aW1pbmcuCiAgICAvLyBXZSByZXVzZSB0aGUgc2FtZSByZWRlcGxveSB3aW5kb3cgdXNlZCBhdCByb3VuZCBlbmQgKFJPVU5EX0VORF9SRURFUExPWV9ERUxBWV9TRUNPTkRTKS4KICAgIG1vZC5TZXRSZWRlcGxveVRpbWUoZXZlbnRQbGF5ZXIsIFJPVU5EX0VORF9SRURFUExPWV9ERUxBWV9TRUNPTkRTKTsKICAgIHZvaWQgZm9yY2VVbmRlcGxveVBsYXllcihldmVudFBsYXllcik7CgogICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5ub3RpZmljYXRpb25zLnRlYW1Td2l0Y2gpLCBmYWxzZSwgbW9kLkdldFRlYW0oZXZlbnRQbGF5ZXIpKTsKICAgIGRlbGV0ZVRlYW1Td2l0Y2hVSShldmVudFBsYXllcik7Cn0KCmZ1bmN0aW9uIGRlbGV0ZVRlYW1Td2l0Y2hVSShldmVudFBsYXllcjogbW9kLlBsYXllciB8IG51bWJlcikgewogICAgLy8gRGVsZXRlcyB0aGUgVGVhbSBTd2l0Y2ggVUkgZm9yIHRoZSBnaXZlbiBwbGF5ZXIgaWQgYW5kIHJlc3RvcmVzIG5vcm1hbCBpbnB1dC4KICAgIC8vIE5vdGU6IFdoZW4gY2FsbGVkIHdpdGggYSBwbGF5ZXIgaWQgKG51bWJlcikgcmF0aGVyIHRoYW4gYSBtb2QuUGxheWVyLCBVSSBpbnB1dCBtb2RlIGNhbm5vdCBiZSB0b2dnbGVkIGhlcmUuCgogICAgbGV0IHBsYXllcklkOiBhbnkgPSBldmVudFBsYXllcjsKCiAgICBpZiAobW9kLklzVHlwZShldmVudFBsYXllciwgbW9kLlR5cGVzLlBsYXllcikpIHsKICAgICAgICBtb2QuRW5hYmxlVUlJbnB1dE1vZGUoZmFsc2UsIGV2ZW50UGxheWVyIGFzIG1vZC5QbGF5ZXIpOwogICAgICAgIHBsYXllcklkID0gbW9kLkdldE9iaklkKGV2ZW50UGxheWVyIGFzIG1vZC5QbGF5ZXIpOwogICAgfQoKICAgIGNvbnN0IGJhc2VXaWRnZXQgPSBzYWZlRmluZChVSV9URUFNU1dJVENIX0NPTlRBSU5FUl9CQVNFX0lEICsgcGxheWVySWQpOwogICAgaWYgKGJhc2VXaWRnZXQpIG1vZC5TZXRVSVdpZGdldFZpc2libGUoYmFzZVdpZGdldCwgZmFsc2UpOwogICAgY29uc3QgZGVidWdXaWRnZXQgPSBzYWZlRmluZChVSV9URUFNU1dJVENIX0RFQlVHX1RJTUVMSU1JVF9JRCArIHBsYXllcklkKTsKICAgIGlmIChkZWJ1Z1dpZGdldCkgewogICAgICAgIG1vZC5TZXRVSVdpZGdldFZpc2libGUoZGVidWdXaWRnZXQsIGZhbHNlKTsKICAgIH0KCiAgICAvLyBBZG1pbiBwYW5lbCBpcyBub3QgY2FjaGVkOiBkZWxldGUgY29udGFpbmVyICsgY2hpbGRyZW4gKyB0b2dnbGUgb24gY2xvc2UgdG8gcHJldmVudCBzdHJheSB3aWRnZXRzLgogICAgZGVsZXRlQWRtaW5QYW5lbFVJKHBsYXllcklkLCB0cnVlKTsKICAgIHNldEFkbWluUGFuZWxDaGlsZFdpZGdldHNWaXNpYmxlKHBsYXllcklkLCBmYWxzZSk7CgogICAgaWYgKFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdKSB7CiAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uYWRtaW5QYW5lbFZpc2libGUgPSBmYWxzZTsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5hZG1pblBhbmVsQnVpbHQgPSBmYWxzZTsKICAgICAgICAvLyBGb3JjZS1oaWRlIGFueSBzdHJheSBhZG1pbiBwYW5lbCBjaGlsZHJlbiAoc29tZSBlbmdpbmVzIGRvIG5vdCBjYXNjYWRlIGNvbnRhaW5lciB2aXNpYmlsaXR5KS4KICAgICAgICBzZXRBZG1pblBhbmVsQ2hpbGRXaWRnZXRzVmlzaWJsZShwbGF5ZXJJZCwgZmFsc2UpOwogICAgICAgIC8vIERlbGV0ZSBhbnkgcHJldmlvdXNseS1idWlsdCBhZG1pbiBjb250YWluZXIgc28gdGhlIHBhbmVsIHdpbGwgcmVidWlsZCBjbGVhbmx5IG9uIGRlbWFuZC4KICAgICAgICBjb25zdCBleGlzdGluZ0FkbWluQ29udGFpbmVyID0gc2FmZUZpbmQoVUlfQURNSU5fUEFORUxfQ09OVEFJTkVSX0lEICsgcGxheWVySWQpOwogICAgICAgIGlmIChleGlzdGluZ0FkbWluQ29udGFpbmVyKSBtb2QuRGVsZXRlVUlXaWRnZXQoZXhpc3RpbmdBZG1pbkNvbnRhaW5lcik7CiAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5hZG1pblBhbmVsQnVpbHQgPSBmYWxzZTsKICAgICAgICAvLyBEaWFsb2cgaXMgbm8gbG9uZ2VyIHZpc2libGU7IHN0b3AgcGFydGljaXBhdGluZyBpbiBnbG9iYWwgcm9zdGVyIHJlZnJlc2hlcy4KICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5kaWFsb2dWaXNpYmxlID0gZmFsc2U7CiAgICB9CgogICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yUGlkKHBsYXllcklkKTsKfQoKZnVuY3Rpb24gY2xvc2VSZWFkeURpYWxvZ0ZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChwKTsKICAgICAgICBpZiAoU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwaWRdPy5kaWFsb2dWaXNpYmxlKSB7CiAgICAgICAgICAgIGRlbGV0ZVRlYW1Td2l0Y2hVSShwKTsKICAgICAgICB9CiAgICB9Cn0KCi8vIEhhcmQgZGVsZXRlIHVzZWQgb25seSBmb3IgY2xlYW51cCAoZS5nLiwgcGxheWVyIGxlYXZlcyBnYW1lKS4KLy8gTm9ybWFsIGRpYWxvZyBjbG9zZSBzaG91bGQgaGlkZSB3aWRnZXRzIHRvIGVuYWJsZSBVSSBjYWNoaW5nIGFuZCBmYXN0ZXIgcmVvcGVuLgpmdW5jdGlvbiBoYXJkRGVsZXRlVGVhbVN3aXRjaFVJKHBsYXllcklkOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IGJhc2VXaWRnZXQgPSBzYWZlRmluZChVSV9URUFNU1dJVENIX0NPTlRBSU5FUl9CQVNFX0lEICsgcGxheWVySWQpOwogICAgaWYgKGJhc2VXaWRnZXQpIG1vZC5EZWxldGVVSVdpZGdldChiYXNlV2lkZ2V0KTsKICAgIGNvbnN0IGRlYnVnV2lkZ2V0ID0gc2FmZUZpbmQoVUlfVEVBTVNXSVRDSF9ERUJVR19USU1FTElNSVRfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAoZGVidWdXaWRnZXQpIG1vZC5EZWxldGVVSVdpZGdldChkZWJ1Z1dpZGdldCk7CgogICAgLy8gQWRtaW4gUGFuZWwgd2lkZ2V0cyAodG9nZ2xlIGJ1dHRvbiArIGxhYmVsICsgY29udGFpbmVyKS4KICAgIGNvbnN0IGFkbWluVG9nZ2xlID0gc2FmZUZpbmQoVUlfQURNSU5fUEFORUxfQlVUVE9OX0lEICsgcGxheWVySWQpOwogICAgaWYgKGFkbWluVG9nZ2xlKSBtb2QuRGVsZXRlVUlXaWRnZXQoYWRtaW5Ub2dnbGUpOwogICAgY29uc3QgYWRtaW5Ub2dnbGVMYWJlbCA9IHNhZmVGaW5kKFVJX0FETUlOX1BBTkVMX0JVVFRPTl9MQUJFTF9JRCArIHBsYXllcklkKTsKICAgIGlmIChhZG1pblRvZ2dsZUxhYmVsKSBtb2QuRGVsZXRlVUlXaWRnZXQoYWRtaW5Ub2dnbGVMYWJlbCk7CiAgICBjb25zdCBhZG1pbkNvbnRhaW5lciA9IHNhZmVGaW5kKFVJX0FETUlOX1BBTkVMX0NPTlRBSU5FUl9JRCArIHBsYXllcklkKTsKICAgIGlmIChhZG1pbkNvbnRhaW5lcikgbW9kLkRlbGV0ZVVJV2lkZ2V0KGFkbWluQ29udGFpbmVyKTsKCiAgICBjb25zdCBwb3NDb250YWluZXIgPSBzYWZlRmluZChVSV9QT1NfREVCVUdfQ09OVEFJTkVSX0lEICsgcGxheWVySWQpOwogICAgaWYgKHBvc0NvbnRhaW5lcikgbW9kLkRlbGV0ZVVJV2lkZ2V0KHBvc0NvbnRhaW5lcik7CiAgICBjb25zdCBwb3NYID0gc2FmZUZpbmQoVUlfUE9TX0RFQlVHX1hfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAocG9zWCkgbW9kLkRlbGV0ZVVJV2lkZ2V0KHBvc1gpOwogICAgY29uc3QgcG9zWSA9IHNhZmVGaW5kKFVJX1BPU19ERUJVR19ZX0lEICsgcGxheWVySWQpOwogICAgaWYgKHBvc1kpIG1vZC5EZWxldGVVSVdpZGdldChwb3NZKTsKICAgIGNvbnN0IHBvc1ogPSBzYWZlRmluZChVSV9QT1NfREVCVUdfWl9JRCArIHBsYXllcklkKTsKICAgIGlmIChwb3NaKSBtb2QuRGVsZXRlVUlXaWRnZXQocG9zWik7CiAgICBjb25zdCByb3RZID0gc2FmZUZpbmQoVUlfUE9TX0RFQlVHX1JPVFlfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAocm90WSkgbW9kLkRlbGV0ZVVJV2lkZ2V0KHJvdFkpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gVGVhbSBTd2l0Y2ggTG9naWMgKGludGVyYWN0IHBvaW50ICsgc3dhcCB0ZWFtcykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFRlYW0gU3dpdGNoIFVJICsgVGVzdGVyIFBhbmVsIChJRHMgKyBidWlsZCBoZWxwZXJzKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gdGVhbVN3aXRjaEJ1dHRvbkV2ZW50KAogICAgZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsCiAgICBldmVudFVJV2lkZ2V0OiBtb2QuVUlXaWRnZXQsCiAgICBldmVudFVJQnV0dG9uRXZlbnQ6IG1vZC5VSUJ1dHRvbkV2ZW50CikgewogICAgLy8gU3RlcHM6CiAgICAvLyAxKSBJZGVudGlmeSB3aGljaCBidXR0b24gd2FzIHByZXNzZWQgZm9yIHRoaXMgcGxheWVyCiAgICAvLyAyKSBNdXRhdGUgYXV0aG9yaXRhdGl2ZSBzdGF0ZSAobWF0Y2ggLyByb3VuZCBjb3VudGVycykgaWYgYXBwbGljYWJsZQogICAgLy8gMykgUmVzeW5jIEhVRC9VSSBwcm9qZWN0aW9ucyBzbyBldmVyeSBwbGF5ZXIgc2VlcyB0aGUgbmV3IHN0YXRlCgogICAgY29uc3QgcGxheWVySWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgY29uc3Qgd2lkZ2V0TmFtZSA9IG1vZC5HZXRVSVdpZGdldE5hbWUoZXZlbnRVSVdpZGdldCk7CgogICAgc3dpdGNoICh3aWRnZXROYW1lKSB7CiAgICAgICAgY2FzZSBVSV9URUFNU1dJVENIX0JVVFRPTl9URUFNMV9JRCArIHBsYXllcklkOgogICAgICAgIGNhc2UgVUlfVEVBTVNXSVRDSF9CVVRUT05fVEVBTTJfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgLy8gRGVwcmVjYXRlZCBVSSAodjAuNSk6IFRlYW0gMSAvIFRlYW0gMiBidXR0b25zIHJlbW92ZWQgZnJvbSB0aGUgZGlhbG9nLgogICAgICAgICAgICAvLyBUaGlzIGhhbmRsZXIgcGF0aCBpcyBpbnRlbnRpb25hbGx5IHJldGFpbmVkIHNvIHRoZSBVSSBjYW4gYmUgcmUtZW5hYmxlZCBsYXRlciB3aXRob3V0IHJlLWltcGxlbWVudGluZyB0ZWFtIHN3aXRjaCBsb2dpYy4KICAgICAgICAgICAgcHJvY2Vzc1RlYW1Td2l0Y2goZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBVSV9URUFNU1dJVENIX0JVVFRPTl9DQU5DRUxfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgZGVsZXRlVGVhbVN3aXRjaFVJKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9SRUFEWV9JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIC8vIFByZS1yb3VuZCBnYXRpbmc6OiBwbGF5ZXJzIG1heSBvbmx5IHRyYW5zaXRpb24gdG8gUkVBRFkgd2hpbGUgaW4gdGhlaXIgbWFpbiBiYXNlIHdoZW4gdGhlIHJvdW5kIGlzIE5PVCBhY3RpdmUuCiAgICAgICAgICAgIC8vIFJlYWR5LWN5Y2xlIGF1dG8tc3RhcnQgLyByZXNldDo6IHdoZW4gYWxsIGFjdGl2ZSBwbGF5ZXJzIGJlY29tZSBSRUFEWSwgYXV0by1zdGFydCB0aGUgcm91bmQgdmlhIHN0YXJ0Um91bmQoKS4KICAgICAgICAgICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgY29uc3QgY3VycmVudGx5UmVhZHkgPSAhIVN0YXRlLnBsYXllcnMucmVhZHlCeVBpZFtwaWRdOwogICAgICAgICAgICBjb25zdCBpbkJhc2UgPSAoU3RhdGUucGxheWVycy5pbk1haW5CYXNlQnlQaWRbcGlkXSAhPT0gdW5kZWZpbmVkKSA/IFN0YXRlLnBsYXllcnMuaW5NYWluQmFzZUJ5UGlkW3BpZF0gOiB0cnVlOwoKICAgICAgICAgICAgLy8gVHJhbnNpdGlvbiBydWxlczoKICAgICAgICAgICAgLy8gLSBOT1QgUkVBRFkgLT4gUkVBRFk6IGFsbG93ZWQgb25seSBpZiAoaW5CYXNlIHx8IGlzUm91bmRMaXZlKCkpIChQcmUtcm91bmQgZ2F0aW5nOiBnYXRpbmcgYXBwbGllcyBvbmx5IHByZS1yb3VuZCkuCiAgICAgICAgICAgIC8vIC0gUkVBRFkgLT4gTk9UIFJFQURZOiBhbHdheXMgYWxsb3dlZC4KICAgICAgICAgICAgaWYgKCFjdXJyZW50bHlSZWFkeSkgewogICAgICAgICAgICAgICAgaWYgKCFpc1JvdW5kTGl2ZSgpICYmICFpbkJhc2UpIHsKICAgICAgICAgICAgICAgICAgICAvLyBEZW55IHJlYWR5LXVwIG91dHNpZGUgb2YgYmFzZSBwcmUtcm91bmQgKG5vIG1lc3NhZ2luZyBpbiBjdXJyZW50IG1pbGVzdG9uZSkuCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSA9IHRydWU7CiAgICAgICAgICAgICAgICAvLyBLZWVwIHRoZSBIVUQgIlggLyBZIFBMQVlFUlMgUkVBRFkiIGxpbmUgaW4gc3luYyBvbiBldmVyeSByZWFkeS1zdGF0ZSBjaGFuZ2UuCiAgICAgICAgICAgICAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW3BpZF0gPSBmYWxzZTsKICAgICAgICAgICAgICAgIC8vIEtlZXAgdGhlIEhVRCAiWCAvIFkgUExBWUVSUyBSRUFEWSIgbGluZSBpbiBzeW5jIG9uIGV2ZXJ5IHJlYWR5LXN0YXRlIGNoYW5nZS4KICAgICAgICAgICAgICAgIHVwZGF0ZVBsYXllcnNSZWFkeUh1ZFRleHRGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFJlZnJlc2ggc2VsZiArIGFsbCB2aXNpYmxlIHZpZXdlcnMgKGNlbnRyYWxpemVkIHJlbmRlcikuCiAgICAgICAgICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yVmlld2VyKGV2ZW50UGxheWVyLCBwbGF5ZXJJZCk7CiAgICAgICAgICAgIC8vIFJlZnJlc2ggYWxsIHZpc2libGUgdmlld2VycyBzbyBldmVyeW9uZSBzZWVzIHJlYWRpbmVzcyBjaGFuZ2VzIGltbWVkaWF0ZWx5LgoKICAgICAgICAgICAgLy8gQWxzbyByZWZyZXNoIGFsbCBvdGhlciB2aWV3ZXJzIHdobyBjdXJyZW50bHkgaGF2ZSB0aGUgZGlhbG9nIG9wZW4uCiAgICAgICAgICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yQWxsVmlzaWJsZVZpZXdlcnMoKTsKICAgICAgICAgICAgdXBkYXRlUGxheWVyc1JlYWR5SHVkVGV4dEZvckFsbFBsYXllcnMoKTsKCiAgICAgICAgICAgIC8vIFJlYWR5LWN5Y2xlIGF1dG8tc3RhcnQgLyByZXNldDo6IGlmIHRoaXMgaW50ZXJhY3Rpb24gcmVzdWx0ZWQgaW4gYWxsIGFjdGl2ZSBwbGF5ZXJzIGJlaW5nIFJFQURZLCBiZWdpbiB0aGUgcm91bmQuCiAgICAgICAgICAgIHRyeUF1dG9TdGFydFJvdW5kSWZBbGxSZWFkeShldmVudFBsYXllcik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgY2FzZSBVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1NXQVBfSUQgKyBwbGF5ZXJJZDogewogICAgICAgICAgICAvLyBTd2FwIFRlYW1zIGJ1dHRvbjo6IHNpbmdsZS1idXR0b24gdGVhbSB0b2dnbGUuCiAgICAgICAgICAgIHN3YXBQbGF5ZXJUZWFtKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjYXNlIFVJX1JFQURZX0RJQUxPR19CRVNUT0ZfREVDX0lEICsgcGxheWVySWQ6IHsKICAgICAgICAgICAgLy8gQ2xhbXAgdG8gY3VycmVudCByb3VuZCBzbyBtYXggcm91bmRzIG5ldmVyIGRpcHMgYmVsb3cgdGhlIGxpdmUgcm91bmQgaW5kZXguCiAgICAgICAgICAgIGNvbnN0IHByZXZNYXggPSBTdGF0ZS5yb3VuZC5tYXg7CiAgICAgICAgICAgIHNldEh1ZFJvdW5kQ291bnRlcnNGb3JBbGxQbGF5ZXJzKFN0YXRlLnJvdW5kLmN1cnJlbnQsIE1hdGgubWF4KFN0YXRlLnJvdW5kLmN1cnJlbnQsIE1hdGgubWF4KDEsIFN0YXRlLnJvdW5kLm1heCAtIDEpKSk7CiAgICAgICAgICAgIGlmIChTdGF0ZS5yb3VuZC5tYXggIT09IHByZXZNYXgpIHsKICAgICAgICAgICAgICAgIC8vIEdhbWVwbGF5LWdhdGVkIHdvcmxkIGxvZyBtZXNzYWdlIGZvciBiZXN0LW9mIGNoYW5nZXMuCiAgICAgICAgICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJlc3RPZkNoYW5nZWQsIGV2ZW50UGxheWVyLCBNYXRoLmZsb29yKFN0YXRlLnJvdW5kLm1heCkpLAogICAgICAgICAgICAgICAgICAgIHRydWUKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9JTkNfSUQgKyBwbGF5ZXJJZDogewogICAgICAgICAgICBjb25zdCBwcmV2TWF4ID0gU3RhdGUucm91bmQubWF4OwogICAgICAgICAgICBzZXRIdWRSb3VuZENvdW50ZXJzRm9yQWxsUGxheWVycyhTdGF0ZS5yb3VuZC5jdXJyZW50LCBTdGF0ZS5yb3VuZC5tYXggKyAxKTsKICAgICAgICAgICAgaWYgKFN0YXRlLnJvdW5kLm1heCAhPT0gcHJldk1heCkgewogICAgICAgICAgICAgICAgLy8gR2FtZXBsYXktZ2F0ZWQgd29ybGQgbG9nIG1lc3NhZ2UgZm9yIGJlc3Qtb2YgY2hhbmdlcy4KICAgICAgICAgICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuYmVzdE9mQ2hhbmdlZCwgZXZlbnRQbGF5ZXIsIE1hdGguZmxvb3IoU3RhdGUucm91bmQubWF4KSksCiAgICAgICAgICAgICAgICAgICAgdHJ1ZQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9ERUNfSUQgKyBwbGF5ZXJJZDogewogICAgICAgICAgICBpZiAoaXNSb3VuZExpdmUoKSkgYnJlYWs7CiAgICAgICAgICAgIGNvbnN0IG5leHQgPSBNYXRoLm1heCgwLCBTdGF0ZS5yb3VuZC5tYXRjaHVwUHJlc2V0SW5kZXggLSAxKTsKICAgICAgICAgICAgYXBwbHlNYXRjaHVwUHJlc2V0KG5leHQsIGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgVUlfUkVBRFlfRElBTE9HX01BVENIVVBfSU5DX0lEICsgcGxheWVySWQ6IHsKICAgICAgICAgICAgaWYgKGlzUm91bmRMaXZlKCkpIGJyZWFrOwogICAgICAgICAgICBjb25zdCBuZXh0ID0gTWF0aC5taW4oTUFUQ0hVUF9QUkVTRVRTLmxlbmd0aCAtIDEsIFN0YXRlLnJvdW5kLm1hdGNodXBQcmVzZXRJbmRleCArIDEpOwogICAgICAgICAgICBhcHBseU1hdGNodXBQcmVzZXQobmV4dCwgZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGNhc2UgVUlfVEVBTVNXSVRDSF9CVVRUT05fT1BUT1VUX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIC8vIERlcHJlY2F0ZWQgVUkgKHYwLjUpOiAnRE9OVCBTSE9XIEFHQUlOJyBidXR0b24gcmVtb3ZlZCBmcm9tIHRoZSBkaWFsb2cuCiAgICAgICAgICAgIC8vIFRoZSBvcHQtb3V0IGZsYWcgYW5kIGJlaGF2aW9yIHJlbWFpbiB0byBzdXBwb3J0IHJlaW50cm9kdWNpbmcgdGhlIGNvbnRyb2wgaW4gYSBmdXR1cmUgdmVyc2lvbi4KICAgICAgICAgICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXSkgaW5pdFRlYW1Td2l0Y2hEYXRhKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uZG9udFNob3dBZ2FpbiA9IHRydWU7CiAgICAgICAgICAgIGRlbGV0ZVRlYW1Td2l0Y2hVSShldmVudFBsYXllcik7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX0FETUlOX1BBTkVMX0JVVFRPTl9JRCArIHBsYXllcklkOiB7CiAgICAgICAgICAgIGlmICghU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0pIGluaXRUZWFtU3dpdGNoRGF0YShldmVudFBsYXllcik7CiAgICAgICAgICAgIGNvbnN0IG5vdyA9IG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCk7CiAgICAgICAgICAgIGlmIChub3cgLSBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5sYXN0QWRtaW5QYW5lbFRvZ2dsZUF0IDwgQURNSU5fUEFORUxfVE9HR0xFX0NPT0xET1dOX1NFQ09ORFMpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdLmxhc3RBZG1pblBhbmVsVG9nZ2xlQXQgPSBub3c7CgogICAgICAgICAgICAvLyBUb2dnbGUgYWRtaW4gcGFuZWwgdmlzaWJpbGl0eS4KICAgICAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uYWRtaW5QYW5lbFZpc2libGUgPSAhU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uYWRtaW5QYW5lbFZpc2libGU7CiAgICAgICAgICAgIGlmICghU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0uYWRtaW5QYW5lbFZpc2libGUpIHsKICAgICAgICAgICAgICAgIC8vIENsb3NlOiBkZWxldGUgcGFuZWwgY29udGVudHMgdG8gYXZvaWQgImdob3N0IiBjaGlsZHJlbiBvbiBzb21lIGNsaWVudHMuCiAgICAgICAgICAgICAgICBkZWxldGVBZG1pblBhbmVsVUkocGxheWVySWQsIGZhbHNlKTsKICAgICAgICAgICAgICAgIFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdLmFkbWluUGFuZWxCdWlsdCA9IGZhbHNlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY2Nlc3NlZCwgZXZlbnRQbGF5ZXIpLCB0cnVlKTsKCiAgICAgICAgICAgIC8vIE9wZW46IHJlYnVpbGQgY29udGFpbmVyICsgd2lkZ2V0cyBmcmVzaCBlYWNoIHRpbWUgKGxvdyBjb3N0OyBhdm9pZHMgZHVwbGljYXRlIGRyYXcgYnVncykuCiAgICAgICAgICAgIGRlbGV0ZUFkbWluUGFuZWxVSShwbGF5ZXJJZCwgZmFsc2UpOyAvLyBzYWZldHk6IGVuc3VyZSBubyBzdGFsZSBjb250YWluZXIvY2hpbGRyZW4gZXhpc3QKCiAgICAgICAgICAgIG1vZC5BZGRVSUNvbnRhaW5lcigKICAgICAgICAgICAgICAgIFVJX0FETUlOX1BBTkVMX0NPTlRBSU5FUl9JRCArIHBsYXllcklkLAogICAgICAgICAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtMTAsIDQ2LCAwKSwKICAgICAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMzMwLCA1ODAsIDApLAogICAgICAgICAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgICAgICAgICAgbW9kLkdldFVJUm9vdCgpLAogICAgICAgICAgICAgICAgZmFsc2UsCiAgICAgICAgICAgICAgICAxMCwKICAgICAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCksCiAgICAgICAgICAgICAgICAwLjgsCiAgICAgICAgICAgICAgICBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICAgICAgICAgIG1vZC5VSURlcHRoLkFib3ZlR2FtZVVJLAogICAgICAgICAgICAgICAgZXZlbnRQbGF5ZXIKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGNvbnN0IGFkbWluQ29udGFpbmVyID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFVJX0FETUlOX1BBTkVMX0NPTlRBSU5FUl9JRCArIHBsYXllcklkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgICAgICBidWlsZEFkbWluUGFuZWxXaWRnZXRzKGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQpOwogICAgICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5hZG1pblBhbmVsQnVpbHQgPSB0cnVlOwogICAgICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGFkbWluQ29udGFpbmVyLCB0cnVlKTsKICAgICAgICAgICAgc2V0QWRtaW5QYW5lbENoaWxkV2lkZ2V0c1Zpc2libGUocGxheWVySWQsIHRydWUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIC8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBUZWFtIFN3aXRjaCBVSSArIFRlc3RlciBQYW5lbCAoSURzICsgYnVpbGQgaGVscGVycykgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKICAgICAgICAvLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gVGVzdGVyIEJ1dHRvbiBFdmVudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9MRUZUX1dJTlNfREVDX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIHNldEh1ZFdpbkNvdW50ZXJzRm9yQWxsUGxheWVycyhNYXRoLm1heCgwLCBTdGF0ZS5tYXRjaC53aW5zVDEgLSAxKSwgU3RhdGUubWF0Y2gud2luc1QyKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50MVdpbnNEZWMpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX0xFRlRfV0lOU19JTkNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgc2V0SHVkV2luQ291bnRlcnNGb3JBbGxQbGF5ZXJzKFN0YXRlLm1hdGNoLndpbnNUMSArIDEsIFN0YXRlLm1hdGNoLndpbnNUMik7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudDFXaW5zSW5jKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fUklHSFRfV0lOU19ERUNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgc2V0SHVkV2luQ291bnRlcnNGb3JBbGxQbGF5ZXJzKFN0YXRlLm1hdGNoLndpbnNUMSwgTWF0aC5tYXgoMCwgU3RhdGUubWF0Y2gud2luc1QyIC0gMSkpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnQyV2luc0RlYyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fUklHSFRfV0lOU19JTkNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgc2V0SHVkV2luQ291bnRlcnNGb3JBbGxQbGF5ZXJzKFN0YXRlLm1hdGNoLndpbnNUMSwgU3RhdGUubWF0Y2gud2luc1QyICsgMSk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudDJXaW5zSW5jKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fTEVGVF9LSUxMU19ERUNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscyA9IE1hdGgubWF4KDAsIFN0YXRlLnNjb3Jlcy50MVRvdGFsS2lsbHMgLSAxKTsKICAgICAgICAgICAgc3luY0tpbGxzSHVkRnJvbVRyYWNrZWRUb3RhbHModHJ1ZSk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudDFUb3RhbEtpbGxzRGVjKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9MRUZUX0tJTExTX0lOQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBTdGF0ZS5zY29yZXMudDFUb3RhbEtpbGxzID0gU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscyArIDE7CiAgICAgICAgICAgIHN5bmNLaWxsc0h1ZEZyb21UcmFja2VkVG90YWxzKHRydWUpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnQxVG90YWxLaWxsc0luYyk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX1JJR0hUX0tJTExTX0RFQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBTdGF0ZS5zY29yZXMudDJUb3RhbEtpbGxzID0gTWF0aC5tYXgoMCwgU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscyAtIDEpOwogICAgICAgICAgICBzeW5jS2lsbHNIdWRGcm9tVHJhY2tlZFRvdGFscyh0cnVlKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50MlRvdGFsS2lsbHNEZWMpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX1JJR0hUX0tJTExTX0lOQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBTdGF0ZS5zY29yZXMudDJUb3RhbEtpbGxzID0gU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscyArIDE7CiAgICAgICAgICAgIHN5bmNLaWxsc0h1ZEZyb21UcmFja2VkVG90YWxzKHRydWUpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnQyVG90YWxLaWxsc0luYyk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX0FETUlOX0JVVFRPTl9UMV9ST1VORF9LSUxMU19ERUNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscyA9IE1hdGgubWF4KDAsIFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgLSAxKTsKICAgICAgICAgICAgc3luY1JvdW5kS2lsbHNIdWQodHJ1ZSk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudDFSb3VuZEtpbGxzRGVjKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9BRE1JTl9CVVRUT05fVDFfUk9VTkRfS0lMTFNfSU5DX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgPSBTdGF0ZS5zY29yZXMudDFSb3VuZEtpbGxzICsgMTsKICAgICAgICAgICAgc3luY1JvdW5kS2lsbHNIdWQodHJ1ZSk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMudDFSb3VuZEtpbGxzSW5jKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0RFQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzID0gTWF0aC5tYXgoMCwgU3RhdGUuc2NvcmVzLnQyUm91bmRLaWxscyAtIDEpOwogICAgICAgICAgICBzeW5jUm91bmRLaWxsc0h1ZCh0cnVlKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50MlJvdW5kS2lsbHNEZWMpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFVJX0FETUlOX0JVVFRPTl9UMl9ST1VORF9LSUxMU19JTkNfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgU3RhdGUuc2NvcmVzLnQyUm91bmRLaWxscyA9IFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHMgKyAxOwogICAgICAgICAgICBzeW5jUm91bmRLaWxsc0h1ZCh0cnVlKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50MlJvdW5kS2lsbHNJbmMpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9ST1VORF9LSUxMU19UQVJHRVRfREVDX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIFN0YXRlLnJvdW5kLmtpbGxzVGFyZ2V0ID0gTWF0aC5tYXgoMSwgU3RhdGUucm91bmQua2lsbHNUYXJnZXQgLSAxKTsKICAgICAgICAgICAgLy8gUmVmcmVzaCBIVUQgaGVscCB0ZXh0ICgiRmlyc3QgdG8gWCBLaWxscyIpIGltbWVkaWF0ZWx5IHdoZW4gdGFyZ2V0IGtpbGxzIGNoYW5nZXMgaW4gdGhlIEFkbWluIFBhbmVsLgogICAgICAgICAgICBzZXRSb3VuZFN0YXRlVGV4dEZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgc3luY1JvdW5kS2lsbHNUYXJnZXRUZXN0ZXJWYWx1ZUZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50YXJnZXRSb3VuZEtpbGxzRGVjKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9ST1VORF9LSUxMU19UQVJHRVRfSU5DX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIC8vIE5PVEU6IEFkbWluLXBhbmVsIHRhcmdldC1raWxscyBhZGp1c3RtZW50cyBtdXN0IHJlZnJlc2ggdGhlIEhVRCBoZWxwIHRleHQgaW1tZWRpYXRlbHkuCiAgICAgICAgICAgIFN0YXRlLnJvdW5kLmtpbGxzVGFyZ2V0ID0gU3RhdGUucm91bmQua2lsbHNUYXJnZXQgKyAxOwogICAgICAgICAgICAvLyBSZWZyZXNoIEhVRCBoZWxwIHRleHQgKCJGaXJzdCB0byBYIEtpbGxzIikgaW1tZWRpYXRlbHkgd2hlbiB0YXJnZXQga2lsbHMgY2hhbmdlcyBpbiB0aGUgQWRtaW4gUGFuZWwuCiAgICAgICAgICAgIHNldFJvdW5kU3RhdGVUZXh0Rm9yQWxsUGxheWVycygpOwogICAgICAgICAgICBzeW5jUm91bmRLaWxsc1RhcmdldFRlc3RlclZhbHVlRm9yQWxsUGxheWVycygpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnRhcmdldFJvdW5kS2lsbHNJbmMpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9USUVTX0RFQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBhZGp1c3RNYXRjaFRpZXNGb3JCb3RoVGVhbXMoLTEpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnRpZXNEZWMpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX1RJRVNfSU5DX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIGFkanVzdE1hdGNoVGllc0ZvckJvdGhUZWFtcygxKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy50aWVzSW5jKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fQ1VSX1JPVU5EX0RFQ19JRCArIHBsYXllcklkOgogICAgICAgICAgICBzZXRIdWRSb3VuZENvdW50ZXJzRm9yQWxsUGxheWVycyhNYXRoLm1heCgwLCBTdGF0ZS5yb3VuZC5jdXJyZW50IC0gMSksIFN0YXRlLnJvdW5kLm1heCk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMuY3VycmVudFJvdW5kRGVjKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9DVVJfUk9VTkRfSU5DX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIHNldEh1ZFJvdW5kQ291bnRlcnNGb3JBbGxQbGF5ZXJzKFN0YXRlLnJvdW5kLmN1cnJlbnQgKyAxLCBTdGF0ZS5yb3VuZC5tYXgpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLmN1cnJlbnRSb3VuZEluYyk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX0NMT0NLX1RJTUVfREVDX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIGFkanVzdFJvdW5kQ2xvY2tCeVNlY29uZHMoLTYwKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy5jbG9ja1RpbWVEZWMpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX0NMT0NLX1RJTUVfSU5DX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIGlmICghU3RhdGUucm91bmQuY2xvY2suaXNQYXVzZWQgJiYgZ2V0UmVtYWluaW5nU2Vjb25kcygpIDwgMCkgewogICAgICAgICAgICAgICAgUmVzZXRSb3VuZENsb2NrKDYwKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFkanVzdFJvdW5kQ2xvY2tCeVNlY29uZHMoNjApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMuY2xvY2tUaW1lSW5jKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fQ0xPQ0tfUkVTRVRfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgcmVzZXRSb3VuZENsb2NrVG9EZWZhdWx0KCk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMuY2xvY2tSZXNldCk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFVJX1RFU1RfQlVUVE9OX1JPVU5EX1NUQVJUX0lEICsgcGxheWVySWQ6CiAgICAgICAgICAgIHN0YXJ0UHJlZ2FtZUNvdW50ZG93bihldmVudFBsYXllciwgdHJ1ZSk7IC8vb2xkOiBzdGFydFJvdW5kKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgaGFuZGxlQWRtaW5QYW5lbEFjdGlvbihldmVudFBsYXllciwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwuYWN0aW9ucy5yb3VuZFN0YXJ0KTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBVSV9URVNUX0JVVFRPTl9ST1VORF9FTkRfSUQgKyBwbGF5ZXJJZDoKICAgICAgICAgICAgZW5kUm91bmQoZXZlbnRQbGF5ZXIpOwogICAgICAgICAgICBoYW5kbGVBZG1pblBhbmVsQWN0aW9uKGV2ZW50UGxheWVyLCBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5hY3Rpb25zLnJvdW5kRW5kKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgVUlfVEVTVF9CVVRUT05fUE9TX0RFQlVHX0lEICsgcGxheWVySWQ6IHsKICAgICAgICAgICAgaWYgKCFTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXSkgaW5pdFRlYW1Td2l0Y2hEYXRhKGV2ZW50UGxheWVyKTsKICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXTsKICAgICAgICAgICAgc3RhdGUucG9zRGVidWdWaXNpYmxlID0gIXN0YXRlLnBvc0RlYnVnVmlzaWJsZTsKICAgICAgICAgICAgc2V0UG9zaXRpb25EZWJ1Z1Zpc2libGVGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIsIHN0YXRlLnBvc0RlYnVnVmlzaWJsZSk7CiAgICAgICAgICAgIGhhbmRsZUFkbWluUGFuZWxBY3Rpb24oZXZlbnRQbGF5ZXIsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmFjdGlvbnMucG9zaXRpb25EZWJ1Zyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIGJyZWFrOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gVGVzdGVyIEJ1dHRvbiBFdmVudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJvdW5kIFN0YXJ0L0VuZCBGbG93ICsgU3RhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIFJ1bnMgcm91bmQgc3RhcnQvZW5kIGZsb3cgdGllZCB0byB0aGUgcm91bmQgY2xvY2sgZXhwaXJ5LgovLyBWaWN0b3J5IGRpYWxvZyB2aXNpYmlsaXR5IGlzIGludGVudGlvbmFsbHkgZGVjb3VwbGVkIGZyb20gU3RhdGUubWF0Y2guaXNFbmRlZC4KLy8gU3RhdGUubWF0Y2guaXNFbmRlZCBjYW4gYmVjb21lIHRydWUgYXQgcm91bmQgZW5kLCBidXQgdGhlIFZpY3RvcnkgVUkgc2hvdWxkIG9ubHkgYXBwZWFyIGFmdGVyIHRoZSAxMHMgcm91bmQtZW5kIHdpbmRvdyBleHBpcmVzLgovLyBTdGF0ZS5tYXRjaC52aWN0b3J5RGlhbG9nQWN0aXZlIGdhdGVzIGJvdGggdmlzaWJpbGl0eSBhbmQgY291bnRkb3duIHVwZGF0ZXMgc28gdGhlIHJlc3RhcnQgdGltZXIgYWx3YXlzIHN0YXJ0cyBhdCA0NXMgd2hlbiB0aGUgZGlhbG9nIGFwcGVhcnMuCgovLyBBc3luYyBjb250cm9sIChyb3VuZCBlbmQpOgovLyAtIFN0YXRlLnJvdW5kLmZsb3cucm91bmRFbmRSZWRlcGxveVRva2VuIGludmFsaWRhdGVzIGFueSBpbi1mbGlnaHQgcm91bmQtZW5kIGNvdW50ZG93bnMgd2hlbiBpbmNyZW1lbnRlZC4KLy8gLSBTdGF0ZS5yb3VuZC5mbG93LmNsb2NrRXhwaXJ5Qm91bmQgcHJldmVudHMgZG91YmxlLWJpbmRpbmcgdGhlIGNsb2NrLWV4cGlyeSBoYW5kbGVyLgovLyBBc3luYyBjb250cm9sIChtYXRjaCBlbmQpOgovLyAtIFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuIGludmFsaWRhdGVzIGFueSBpbi1mbGlnaHQgbWF0Y2gtZW5kIGRlbGF5cyB3aGVuIGluY3JlbWVudGVkLgoKCmZ1bmN0aW9uIGJyb2FkY2FzdFN0cmluZ0tleSgKICAgIHN0cmluZ0tleTogbnVtYmVyLAogICAgYXJnMD86IHN0cmluZyB8IG51bWJlciB8IG1vZC5QbGF5ZXIsCiAgICBhcmcxPzogc3RyaW5nIHwgbnVtYmVyIHwgbW9kLlBsYXllciwKICAgIGFyZzI/OiBzdHJpbmcgfCBudW1iZXIgfCBtb2QuUGxheWVyCik6IHZvaWQgewogICAgY29uc3QgbWVzc2FnZSA9IChhcmcwID09PSB1bmRlZmluZWQpCiAgICAgICAgPyBtb2QuTWVzc2FnZShzdHJpbmdLZXkpCiAgICAgICAgOiAoYXJnMSA9PT0gdW5kZWZpbmVkKQogICAgICAgICAgICA/IG1vZC5NZXNzYWdlKHN0cmluZ0tleSwgYXJnMCkKICAgICAgICAgICAgOiAoYXJnMiA9PT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgICAgPyBtb2QuTWVzc2FnZShzdHJpbmdLZXksIGFyZzAsIGFyZzEpCiAgICAgICAgICAgICAgICA6IG1vZC5NZXNzYWdlKHN0cmluZ0tleSwgYXJnMCwgYXJnMSwgYXJnMik7CiAgICBzZW5kTm90aWZpY2F0aW9uTWVzc2FnZShtZXNzYWdlLCBmYWxzZSk7Cn0KCmZ1bmN0aW9uIGJyb2FkY2FzdEhpZ2hsaWdodGVkU3RyaW5nS2V5KAogICAgc3RyaW5nS2V5OiBudW1iZXIsCiAgICBhcmcwPzogc3RyaW5nIHwgbnVtYmVyIHwgbW9kLlBsYXllciwKICAgIGFyZzE/OiBzdHJpbmcgfCBudW1iZXIgfCBtb2QuUGxheWVyLAogICAgYXJnMj86IHN0cmluZyB8IG51bWJlciB8IG1vZC5QbGF5ZXIKKTogdm9pZCB7CiAgICBjb25zdCBtZXNzYWdlID0gKGFyZzAgPT09IHVuZGVmaW5lZCkKICAgICAgICA/IG1vZC5NZXNzYWdlKHN0cmluZ0tleSkKICAgICAgICA6IChhcmcxID09PSB1bmRlZmluZWQpCiAgICAgICAgICAgID8gbW9kLk1lc3NhZ2Uoc3RyaW5nS2V5LCBhcmcwKQogICAgICAgICAgICA6IChhcmcyID09PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICA/IG1vZC5NZXNzYWdlKHN0cmluZ0tleSwgYXJnMCwgYXJnMSkKICAgICAgICAgICAgICAgIDogbW9kLk1lc3NhZ2Uoc3RyaW5nS2V5LCBhcmcwLCBhcmcxLCBhcmcyKTsKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtZXNzYWdlLCBmYWxzZSk7Cn0KCi8vIENvbW1lbnRlZCBvdXQgZnVuY3Rpb246Ci8vZnVuY3Rpb24gYnJvYWRjYXN0Tm90aWZpY2F0aW9uTWVzc2FnZShtZXNzYWdlOiBtb2QuTWVzc2FnZSk6IHZvaWQgewovLyAgICBtb2QuRGlzcGxheU5vdGlmaWNhdGlvbk1lc3NhZ2UobWVzc2FnZSk7Ci8vfQoKLy8gU3RhbmRhcmQgcm91bmQtZW5kIGZsb3c6IGFmdGVyIFJPVU5EX0VORF9SRURFUExPWV9ERUxBWV9TRUNPTkRTLCBoaWRlIHRoZSByb3VuZC1lbmQgZGlhbG9nIGFuZCB1bmRlcGxveSBhbGwgcGxheWVycy4KLy8gU3RhdGUucm91bmQuZmxvdy5yb3VuZEVuZFJlZGVwbG95VG9rZW4gY2FuY2VscyBvbGRlciB0aW1lcnMgaWYgYSBuZXcgcm91bmQgZW5kIGlzIHRyaWdnZXJlZCBiZWZvcmUgdGhlIGRlbGF5IGNvbXBsZXRlcy4KYXN5bmMgZnVuY3Rpb24gc2NoZWR1bGVSb3VuZEVuZFJlZGVwbG95KGV4cGVjdGVkVG9rZW46IG51bWJlcik6IFByb21pc2U8dm9pZD4gewogICAgYXdhaXQgbW9kLldhaXQoUk9VTkRfRU5EX1JFREVQTE9ZX0RFTEFZX1NFQ09ORFMpOwoKICAgIGlmIChleHBlY3RlZFRva2VuICE9PSBTdGF0ZS5yb3VuZC5mbG93LnJvdW5kRW5kUmVkZXBsb3lUb2tlbikgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChpc1JvdW5kTGl2ZSgpKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIEhpZGUgdGhlIHJvdW5kLWVuZCBkaWFsb2cgYXQgdGhlIHJlZGVwbG95IGJvdW5kYXJ5IHNvIGl0IG5ldmVyIG91dGxpdmVzIHRoZSByb3VuZC1lbmQgd2luZG93LgogICAgc2V0Um91bmRFbmREaWFsb2dWaXNpYmxlRm9yQWxsUGxheWVycyhmYWxzZSk7CgogICAgLy8gU2tpcCByZWRlcGxveSB3aGVuIHRoZSBtYXRjaCBoYXMgZW5kZWQgKHZpY3RvcnkgZGlhbG9nIGNvbnRpbnVlcyB0aHJvdWdoIHRoZSBtYXRjaC1lbmQgZmxvdykuCiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCkgewogICAgICAgIHJldHVybjsKLy8gRmluYWwtcm91bmQgZmxvdzoga2VlcCB0aGUgcm91bmQtZW5kIGRpYWxvZyB2aXNpYmxlIGZvciB0aGUgbm9ybWFsIDEwcyB3aW5kb3csIHRoZW4gaGlkZSBpdCBhbmQgc2hvdyB0aGUgVmljdG9yeSBkaWFsb2cgZm9yIE1BVENIX0VORF9ERUxBWV9TRUNPTkRTLgovLyBUaGlzIHVzZXMgU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW4gYXMgYSBjYW5jZWxsYXRpb24gdG9rZW4gc28gYWRtaW4gYWN0aW9ucyBvciB1bmV4cGVjdGVkIHN0YXRlIGNoYW5nZXMgY2Fubm90IHRyaWdnZXIgc3RhbGUgZGVsYXllZCBVSS4KICAgIH0KCiAgICBtb2QuVW5kZXBsb3lBbGxQbGF5ZXJzKCk7Cn0KCmFzeW5jIGZ1bmN0aW9uIHNjaGVkdWxlRmluYWxSb3VuZFZpY3RvcnkoZXhwZWN0ZWRUb2tlbjogbnVtYmVyLCB3aW5uaW5nVGVhbU51bTogVGVhbUlEIHwgMCk6IFByb21pc2U8dm9pZD4gewogICAgYXdhaXQgbW9kLldhaXQoUk9VTkRfRU5EX1JFREVQTE9ZX0RFTEFZX1NFQ09ORFMpOwoKICAgIGlmIChleHBlY3RlZFRva2VuICE9PSBTdGF0ZS5tYXRjaC5mbG93Lm1hdGNoRW5kRGVsYXlUb2tlbikgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICghU3RhdGUubWF0Y2guaXNFbmRlZCkgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAvLyBIaWRlIHRoZSByb3VuZC1lbmQgZGlhbG9nIHdoZW4gdGhlIHJvdW5kLWVuZCB3aW5kb3cgZXhwaXJlcywgZXZlbiBvbiB0aGUgZmluYWwgcm91bmQuCiAgICBzZXRSb3VuZEVuZERpYWxvZ1Zpc2libGVGb3JBbGxQbGF5ZXJzKGZhbHNlKTsKCiAgICAvLyBTdGFydCB0aGUgbWF0Y2gtZW5kIHZpY3RvcnkgZmxvdyBvbmx5IGFmdGVyIHRoZSByb3VuZC1lbmQgd2luZG93IGNvbXBsZXRlcy4KICAgIFN0YXRlLm1hdGNoLnZpY3RvcnlTdGFydEVsYXBzZWRTZWNvbmRzU25hcHNob3QgPSBNYXRoLmZsb29yKG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCkpOwogICAgU3RhdGUubWF0Y2guZW5kRWxhcHNlZFNlY29uZHNTbmFwc2hvdCA9IFN0YXRlLm1hdGNoLnZpY3RvcnlTdGFydEVsYXBzZWRTZWNvbmRzU25hcHNob3Q7CiAgICBTdGF0ZS5tYXRjaC52aWN0b3J5RGlhbG9nQWN0aXZlID0gdHJ1ZTsKICAgIFN0YXRlLnJvdW5kLmNsb2NrLmlzUGF1c2VkID0gZmFsc2U7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5wYXVzZWRSZW1haW5pbmdTZWNvbmRzID0gdW5kZWZpbmVkOwogICAgUmVzZXRSb3VuZENsb2NrKE1BVENIX0VORF9ERUxBWV9TRUNPTkRTKTsKICAgIHVwZGF0ZVZpY3RvcnlEaWFsb2dGb3JBbGxQbGF5ZXJzKE1BVENIX0VORF9ERUxBWV9TRUNPTkRTKTsKCiAgICB2b2lkIHNjaGVkdWxlTWF0Y2hFbmQoZXhwZWN0ZWRUb2tlbiwgd2lubmluZ1RlYW1OdW0pOwp9Cgphc3luYyBmdW5jdGlvbiBzY2hlZHVsZU1hdGNoRW5kKGV4cGVjdGVkVG9rZW46IG51bWJlciwgd2lubmluZ1RlYW1OdW0/OiBUZWFtSUQgfCAwKTogUHJvbWlzZTx2b2lkPiB7CiAgICBhd2FpdCBtb2QuV2FpdChNQVRDSF9FTkRfREVMQVlfU0VDT05EUyk7CgogICAgaWYgKGV4cGVjdGVkVG9rZW4gIT09IFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKCFTdGF0ZS5tYXRjaC5pc0VuZGVkKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh3aW5uaW5nVGVhbU51bSAhPT0gdW5kZWZpbmVkICYmIHdpbm5pbmdUZWFtTnVtICE9PSAwKSB7CiAgICAgICAgZW5kR2FtZU1vZGVGb3JUZWFtTnVtKHdpbm5pbmdUZWFtTnVtKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgbW9kLkVuZEdhbWVNb2RlKG1vZC5HZXRUZWFtKDApKTsKfQoKZnVuY3Rpb24gYmluZFJvdW5kQ2xvY2tFeHBpcnlUb1JvdW5kRW5kKCk6IHZvaWQgewogICAgaWYgKFN0YXRlLnJvdW5kLmZsb3cuY2xvY2tFeHBpcnlCb3VuZCkgcmV0dXJuOwogICAgU3RhdGUucm91bmQuZmxvdy5jbG9ja0V4cGlyeUJvdW5kID0gdHJ1ZTsKCiAgICBTdGF0ZS5yb3VuZC5jbG9jay5leHBpcnlIYW5kbGVycy5wdXNoKCgpID0+IHsKICAgICAgICBpZiAoaXNSb3VuZExpdmUoKSkgewogICAgICAgICAgICBlbmRSb3VuZCgpOwogICAgICAgIH0KICAgIH0pOwp9CgovLyBTdGFydHMgYSBuZXcgcm91bmQgdXNpbmcgdGhlIGN1cnJlbnQgYXV0aG9yaXRhdGl2ZSBjb25maWd1cmF0aW9uLgovLyBJbnZhcmlhbnRzOgovLyAtIFJlc2V0cyBwZXItcm91bmQgY291bnRlcnMgYnV0IHByZXNlcnZlcyBtYXRjaC1sZXZlbCB0b3RhbHMKLy8gLSBJbml0aWFsaXplcyB0aGUgcm91bmQgY2xvY2sgZnJvbSBST1VORF9TVEFSVF9TRUNPTkRTCi8vIC0gU2V0cyByb3VuZCBwaGFzZSBzdGF0ZSB1c2VkIGJ5IEhVRCBhbmQgZW5kIGNvbmRpdGlvbnMKCmZ1bmN0aW9uIHN0YXJ0Um91bmQoX3RyaWdnZXJQbGF5ZXI/OiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCkgewogICAgLy8gU3RlcHM6CiAgICAvLyAxKSBSZXNldCByb3VuZC1zY29wZWQgY291bnRlcnMgYW5kIGZsYWdzCiAgICAvLyAyKSBJbml0aWFsaXplIHRoZSByb3VuZCBjbG9jayBmcm9tIFJPVU5EX1NUQVJUX1NFQ09ORFMKICAgIC8vIDMpIFB1c2ggSFVEL1VJIHVwZGF0ZXMgZm9yIHRoZSBuZXcgcm91bmQgc3RhdGUKCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIERlZmVuc2l2ZSBjbGVhbnVwOiBoaWRlIGNvdW50ZG93biBVSSBpZiB3ZSBhcmUgbm90IGN1cnJlbnRseSBydW5uaW5nIGEgY291bnRkb3duLgogICAgLy8gVGhpcyBwcmVzZXJ2ZXMgdGhlIEdPIGRpc3BsYXkgd2hlbiBzdGFydFJvdW5kIGlzIHRyaWdnZXJlZCBieSB0aGUgY291bnRkb3duIGl0c2VsZi4KICAgIGlmICghU3RhdGUucm91bmQuY291bnRkb3duLmlzQWN0aXZlKSB7CiAgICAgICAgaGlkZVByZWdhbWVDb3VudGRvd25Gb3JBbGxQbGF5ZXJzKCk7CiAgICB9CgogICAgU3RhdGUucm91bmQuY291bnRkb3duLmlzUmVxdWVzdGVkID0gZmFsc2U7CiAgICBiaW5kUm91bmRDbG9ja0V4cGlyeVRvUm91bmRFbmQoKTsKICAgIFN0YXRlLnJvdW5kLnBoYXNlID0gUm91bmRQaGFzZS5MaXZlOyAvLyBFbmFibGVzIHNjb3JpbmcgKyBMSVZFIEhVRCBzdGF0ZS4KICAgIC8vIEV4dGVuZHMgdGhlIGJ1aWx0LWluIGdhbWVtb2RlIHRpbWUgbGltaXQgc28gdGhlIG1hdGNoIGFsd2F5cyBoYXMgYSBmdWxsIGhvdXIgcmVtYWluaW5nIGFmdGVyIGVhY2ggcm91bmQgc3RhcnQuCiAgICBjb25zdCBlbGFwc2VkU2Vjb25kcyA9IE1hdGguZmxvb3IobW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKSk7CiAgICBtb2QuU2V0R2FtZU1vZGVUaW1lTGltaXQoZWxhcHNlZFNlY29uZHMgKyBCQUNLR1JPVU5EX1RJTUVfTElNSVRfUkVTRVRfU0VDT05EUyk7CiAgICBzZXRSb3VuZFN0YXRlVGV4dEZvckFsbFBsYXllcnMoKTsKICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvckFsbFBsYXllcnMoKTsKICAgIHNldFJvdW5kRW5kRGlhbG9nVmlzaWJsZUZvckFsbFBsYXllcnMoZmFsc2UpOwoKICAgIFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgPSAwOwogICAgU3RhdGUuc2NvcmVzLnQyUm91bmRLaWxscyA9IDA7CgogICAgc3luY1JvdW5kS2lsbHNIdWQodHJ1ZSk7CgogICAgUmVzZXRSb3VuZENsb2NrKFJPVU5EX1NUQVJUX1NFQ09ORFMpOwogICAgYnJvYWRjYXN0U3RyaW5nS2V5KG1vZC5zdHJpbmdrZXlzLnR3bC5ub3RpZmljYXRpb25zLnJvdW5kU3RhcnRlZCk7Cn0KCi8vIEVuZHMgdGhlIGN1cnJlbnQgcm91bmQgYW5kIHNjaGVkdWxlcyB0cmFuc2l0aW9uIHRvIHRoZSBuZXh0IHN0YXRlLgovLyBOb3RlczoKLy8gLSBSb3VuZCBlbmQgcmVhc29uIGlzIGRldGVybWluZWQgYmVmb3JlIHRoaXMgY2FsbAovLyAtIFJlZGVwbG95IGRlbGF5IGFuZCBuZXh0LXJvdW5kIHNjaGVkdWxpbmcgYXJlIHRpbWUtYmFzZWQKLy8gLSBNYXRjaCBlbmQgaXMgaGFuZGxlZCBzZXBhcmF0ZWx5IGFuZCBtdXN0IG5vdCBiZSB0cmlnZ2VyZWQgaGVyZQoKZnVuY3Rpb24gZW5kUm91bmQoX3RyaWdnZXJQbGF5ZXI/OiBtb2QuUGxheWVyLCBmcmVlemVSZW1haW5pbmdTZWNvbmRzPzogbnVtYmVyKTogdm9pZCB7CiAgICBpZiAoIWlzUm91bmRMaXZlKCkpIHsKICAgIC8vIFN0ZXBzOgogICAgLy8gMSkgRnJlZXplIHJvdW5kLWxpdmUgc3lzdGVtcyAobm8gZnVydGhlciBzY29yaW5nKQogICAgLy8gMikgU2NoZWR1bGUgcmVkZXBsb3kgLyB0cmFuc2l0aW9uIHVzaW5nIFJPVU5EX0VORF9SRURFUExPWV9ERUxBWV9TRUNPTkRTCiAgICAvLyAzKSBJZiBtYXRjaCBzaG91bGQgZW5kLCBoYW5kIG9mZiB0byBtYXRjaC1lbmQgcGF0aCAobm90IHJvdW5kIHBhdGgpCgogICAgICAgIHJldHVybjsKICAgIH0KICAgIFN0YXRlLnJvdW5kLnBoYXNlID0gUm91bmRQaGFzZS5Ob3RSZWFkeTsgLy8gUmV0dXJuIHRvIHByZS1yb3VuZCBzdGF0ZTsgbWF5IGJlIG92ZXJyaWRkZW4gdG8gR2FtZU92ZXIgYmVsb3cuCiAgICAvLyBSZWFkeS1jeWNsZSBhdXRvLXN0YXJ0IC8gcmVzZXQ6OiByb3VuZCBlbmRlZCAtPiByZXNldCBhbGwgcGxheWVycyB0byBOT1QgUkVBRFkgZm9yIHRoZSBuZXh0IHJlYWR5LXVwIGN5Y2xlLgogICAgcmVzZXRSZWFkeVN0YXRlRm9yQWxsUGxheWVycygpOwoKICAgIC8vIEZyZWV6ZSBkaXNwbGF5IGFmdGVyIGVuZGluZyB0aGUgcm91bmQuCiAgICBTdGF0ZS5yb3VuZC5jbG9jay5pc1BhdXNlZCA9IHRydWU7CiAgICBTdGF0ZS5yb3VuZC5jbG9jay5wYXVzZWRSZW1haW5pbmdTZWNvbmRzID0gTWF0aC5tYXgoMCwgZnJlZXplUmVtYWluaW5nU2Vjb25kcyAhPT0gdW5kZWZpbmVkID8gTWF0aC5mbG9vcihmcmVlemVSZW1haW5pbmdTZWNvbmRzKSA6IDApOwoKICAgIGNvbnN0IHdpbm5lclRlYW1OdW0gPSAoU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscyA+IFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHMpID8gVGVhbUlELlRlYW0xIDogKChTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzID4gU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscykgPyBUZWFtSUQuVGVhbTIgOiAwKTsKICAgIHVwZGF0ZVJvdW5kRW5kRGlhbG9nRm9yQWxsUGxheWVycyh3aW5uZXJUZWFtTnVtKTsKICAgIHNldFJvdW5kRW5kRGlhbG9nVmlzaWJsZUZvckFsbFBsYXllcnModHJ1ZSk7CgogICAgY29uc3QgdDEgPSBTdGF0ZS5zY29yZXMudDFSb3VuZEtpbGxzOwogICAgY29uc3QgdDIgPSBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzOwoKICAgIGlmICh0MSA+IHQyKSB7CiAgICAgICAgY29uc3QgbmV3VDFXaW5zID0gU3RhdGUubWF0Y2gud2luc1QxICsgMTsKICAgICAgICBjb25zdCBuZXdUMldpbnMgPSBTdGF0ZS5tYXRjaC53aW5zVDI7CiAgICAgICAgc2V0SHVkV2luQ291bnRlcnNGb3JBbGxQbGF5ZXJzKG5ld1QxV2lucywgbmV3VDJXaW5zKTsKICAgICAgICBicm9hZGNhc3RTdHJpbmdLZXkobW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMucm91bmRFbmRXaW4sIGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMSksIHQxLCB0Mik7CiAgICAgICAgYnJvYWRjYXN0SGlnaGxpZ2h0ZWRTdHJpbmdLZXkobW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMucm91bmRXaW5zLCBuZXdUMVdpbnMsIG5ld1QyV2lucyk7CiAgICB9IGVsc2UgaWYgKHQyID4gdDEpIHsKICAgICAgICBjb25zdCBuZXdUMVdpbnMgPSBTdGF0ZS5tYXRjaC53aW5zVDE7CiAgICAgICAgY29uc3QgbmV3VDJXaW5zID0gU3RhdGUubWF0Y2gud2luc1QyICsgMTsKICAgICAgICBzZXRIdWRXaW5Db3VudGVyc0ZvckFsbFBsYXllcnMobmV3VDFXaW5zLCBuZXdUMldpbnMpOwogICAgICAgIGJyb2FkY2FzdFN0cmluZ0tleShtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5yb3VuZEVuZFdpbiwgZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0yKSwgdDIsIHQxKTsKICAgICAgICBicm9hZGNhc3RIaWdobGlnaHRlZFN0cmluZ0tleShtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5yb3VuZFdpbnMsIG5ld1QxV2lucywgbmV3VDJXaW5zKTsKICAgIH0gZWxzZSB7CiAgICAgICAgU3RhdGUubWF0Y2gudGllc1QxID0gU3RhdGUubWF0Y2gudGllc1QxICsgMTsKICAgICAgICBTdGF0ZS5tYXRjaC50aWVzVDIgPSBTdGF0ZS5tYXRjaC50aWVzVDIgKyAxOwogICAgICAgIHN5bmNSb3VuZFJlY29yZEh1ZEZvckFsbFBsYXllcnMoKTsKICAgICAgICBicm9hZGNhc3RTdHJpbmdLZXkobW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMucm91bmRFbmRUaWUsIHQxLCB0Mik7CiAgICAgICAgYnJvYWRjYXN0SGlnaGxpZ2h0ZWRTdHJpbmdLZXkobW9kLnN0cmluZ2tleXMudHdsLm5vdGlmaWNhdGlvbnMucm91bmRXaW5zLCBTdGF0ZS5tYXRjaC53aW5zVDEsIFN0YXRlLm1hdGNoLndpbnNUMik7CiAgICB9CgogICAgLy8gRW5kIG1hdGNoIHdoZW4gYSB0ZWFtIHJlYWNoZXMgdGhlIHJlcXVpcmVkIG1ham9yaXR5IG9mIHdpbnMuCiAgICBjb25zdCB3aW5zTmVlZGVkID0gTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5tYXggLyAyKSArIDE7CiAgICBpZiAoU3RhdGUucm91bmQubWF4ID49IDEpIHsKICAgICAgICBpZiAoU3RhdGUubWF0Y2gud2luc1QxID49IHdpbnNOZWVkZWQpIHsKICAgICAgICAgICAgU3RhdGUubWF0Y2guaXNFbmRlZCA9IHRydWU7CiAgICAgICAgICAgIFN0YXRlLnJvdW5kLnBoYXNlID0gUm91bmRQaGFzZS5HYW1lT3ZlcjsgLy8gTG9ja3MgSFVEIHRvIEdBTUUgT1ZFUiBhbmQgZGlzYWJsZXMgbGl2ZSBzY29yaW5nLgogICAgICAgICAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIHNldFJvdW5kU3RhdGVUZXh0Rm9yQWxsUGxheWVycygpOwogICAgICAgICAgICBTdGF0ZS5tYXRjaC53aW5uZXJUZWFtID0gVGVhbUlELlRlYW0xOwogICAgICAgICAgICBTdGF0ZS5tYXRjaC5mbG93Lm1hdGNoRW5kRGVsYXlUb2tlbiA9IChTdGF0ZS5tYXRjaC5mbG93Lm1hdGNoRW5kRGVsYXlUb2tlbiArIDEpICUgMTAwMDAwMDAwMDsKICAgICAgICAgICAgY29uc3QgbWF0Y2hFbmRUb2tlbiA9IFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuOwogICAgICAgICAgICB2b2lkIHNjaGVkdWxlRmluYWxSb3VuZFZpY3RvcnkobWF0Y2hFbmRUb2tlbiwgVGVhbUlELlRlYW0xKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoU3RhdGUubWF0Y2gud2luc1QyID49IHdpbnNOZWVkZWQpIHsKICAgICAgICAgICAgU3RhdGUubWF0Y2guaXNFbmRlZCA9IHRydWU7CiAgICAgICAgICAgIFN0YXRlLnJvdW5kLnBoYXNlID0gUm91bmRQaGFzZS5HYW1lT3ZlcjsgLy8gTG9ja3MgSFVEIHRvIEdBTUUgT1ZFUiBhbmQgZGlzYWJsZXMgbGl2ZSBzY29yaW5nLgogICAgICAgICAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIHNldFJvdW5kU3RhdGVUZXh0Rm9yQWxsUGxheWVycygpOwogICAgICAgICAgICBTdGF0ZS5tYXRjaC53aW5uZXJUZWFtID0gVGVhbUlELlRlYW0yOwogICAgICAgICAgICBTdGF0ZS5tYXRjaC5mbG93Lm1hdGNoRW5kRGVsYXlUb2tlbiA9IChTdGF0ZS5tYXRjaC5mbG93Lm1hdGNoRW5kRGVsYXlUb2tlbiArIDEpICUgMTAwMDAwMDAwMDsKICAgICAgICAgICAgY29uc3QgbWF0Y2hFbmRUb2tlbiA9IFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuOwogICAgICAgICAgICB2b2lkIHNjaGVkdWxlRmluYWxSb3VuZFZpY3RvcnkobWF0Y2hFbmRUb2tlbiwgVGVhbUlELlRlYW0yKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0gICAgCiAgICAKICAgIC8vIEVuZHMgdGhlIG1hdGNoIGF0IG1heCByb3VuZHMgYnkgY29tcGFyaW5nIHdpbnM7IGEgdGllIHJlbWFpbnMgYSBkcmF3LgogICAgLy8gRW5kIG1hdGNoIHdoZW4gdGhlIGNvbmZpZ3VyZWQgbWF4IHJvdW5kcyBhcmUgY29tcGxldGVkIHdpdGhvdXQgYSBtYWpvcml0eSB3aW5uZXIuCiAgICAvLyBXaW5uZXIgaXMgZGVjaWRlZCBieSBtb3N0IHJvdW5kcyB3b247IGEgdGllIHJlbWFpbnMgYSBkcmF3LgogICAgaWYgKFN0YXRlLnJvdW5kLm1heCA+PSAxICYmIFN0YXRlLnJvdW5kLmN1cnJlbnQgPj0gU3RhdGUucm91bmQubWF4KSB7CiAgICAgICAgU3RhdGUubWF0Y2guaXNFbmRlZCA9IHRydWU7CiAgICAgICAgU3RhdGUucm91bmQucGhhc2UgPSBSb3VuZFBoYXNlLkdhbWVPdmVyOyAvLyBMb2NrcyBIVUQgdG8gR0FNRSBPVkVSIGFuZCBkaXNhYmxlcyBsaXZlIHNjb3JpbmcuCiAgICAgICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yQWxsUGxheWVycygpOwogICAgICAgIHNldFJvdW5kU3RhdGVUZXh0Rm9yQWxsUGxheWVycygpOwoKICAgICAgICBpZiAoU3RhdGUubWF0Y2gud2luc1QxID4gU3RhdGUubWF0Y2gud2luc1QyKSB7CiAgICAgICAgICAgIFN0YXRlLm1hdGNoLndpbm5lclRlYW0gPSBUZWFtSUQuVGVhbTE7CiAgICAgICAgICAgIFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuID0gKFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuICsgMSkgJSAxMDAwMDAwMDAwOwogICAgICAgICAgICBjb25zdCBtYXRjaEVuZFRva2VuID0gU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW47CiAgICAgICAgICAgIHZvaWQgc2NoZWR1bGVGaW5hbFJvdW5kVmljdG9yeShtYXRjaEVuZFRva2VuLCBUZWFtSUQuVGVhbTEpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RhdGUubWF0Y2gud2luc1QyID4gU3RhdGUubWF0Y2gud2luc1QxKSB7CiAgICAgICAgICAgIFN0YXRlLm1hdGNoLndpbm5lclRlYW0gPSBUZWFtSUQuVGVhbTI7CiAgICAgICAgICAgIFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuID0gKFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuICsgMSkgJSAxMDAwMDAwMDAwOwogICAgICAgICAgICBjb25zdCBtYXRjaEVuZFRva2VuID0gU3RhdGUubWF0Y2guZmxvdy5tYXRjaEVuZERlbGF5VG9rZW47CiAgICAgICAgICAgIHZvaWQgc2NoZWR1bGVGaW5hbFJvdW5kVmljdG9yeShtYXRjaEVuZFRva2VuLCBUZWFtSUQuVGVhbTIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBTdGF0ZS5tYXRjaC53aW5uZXJUZWFtID0gdW5kZWZpbmVkOwogICAgICAgIFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuID0gKFN0YXRlLm1hdGNoLmZsb3cubWF0Y2hFbmREZWxheVRva2VuICsgMSkgJSAxMDAwMDAwMDAwOwogICAgICAgIGNvbnN0IG1hdGNoRW5kVG9rZW4gPSBTdGF0ZS5tYXRjaC5mbG93Lm1hdGNoRW5kRGVsYXlUb2tlbjsKICAgICAgICB2b2lkIHNjaGVkdWxlRmluYWxSb3VuZFZpY3RvcnkobWF0Y2hFbmRUb2tlbiwgMCk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIFN0YXRlLnJvdW5kLmZsb3cucm91bmRFbmRSZWRlcGxveVRva2VuID0gKFN0YXRlLnJvdW5kLmZsb3cucm91bmRFbmRSZWRlcGxveVRva2VuICsgMSkgJSAxMDAwMDAwMDAwOwogICAgY29uc3QgcmVkZXBsb3lUb2tlbiA9IFN0YXRlLnJvdW5kLmZsb3cucm91bmRFbmRSZWRlcGxveVRva2VuOwoKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5yb3VuZE92ZXJSZWRlcGxveWluZywgUk9VTkRfRU5EX1JFREVQTE9ZX0RFTEFZX1NFQ09ORFMpLAogICAgICAgIHRydWUKICAgICk7CiAgICB2b2lkIHNjaGVkdWxlUm91bmRFbmRSZWRlcGxveShyZWRlcGxveVRva2VuKTsKCiAgICAvLyBQcmVwYXJlIG5leHQgcm91bmQgY291bnRlcnMgYWZ0ZXIgZW5kaW5nIHRoZSBhY3RpdmUgcm91bmQuCiAgICBTdGF0ZS5yb3VuZC5jdXJyZW50ID0gTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5jdXJyZW50KSArIDE7CiAgICBzZXRIdWRSb3VuZENvdW50ZXJzRm9yQWxsUGxheWVycyhTdGF0ZS5yb3VuZC5jdXJyZW50LCBTdGF0ZS5yb3VuZC5tYXgpOwogICAgc2V0Um91bmRTdGF0ZVRleHRGb3JBbGxQbGF5ZXJzKCk7CiAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBSb3VuZCBTdGFydC9FbmQgRmxvdyArIFN0YXRlIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBVSSAtIFJlYWR5IFVwIERpYWxvZyAoY29uc3RydWN0aW9uKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gRW5zdXJlcyB0aGUgQWRtaW4gUGFuZWwgdG9nZ2xlIGJ1dHRvbiArIGNvbnRhaW5lciBleGlzdCBmb3IgdGhpcyBwbGF5ZXIgYW5kIGFyZSBzaG93bi9oaWRkZW4gY29ycmVjdGx5LgovLyBSZXF1aXJlZCBmb3IgVUkgY2FjaGluZzogd2UgaGlkZSB0aGVzZSB3aWRnZXRzIG9uIGRpYWxvZyBjbG9zZSAobm90IGRlbGV0ZSksIHNvIHJlb3BlbiBjYW4gc2ltcGx5IHJlLXNob3cgdGhlbS4KCi8vIFNvbWUgVUkgaW1wbGVtZW50YXRpb25zIGRvIG5vdCBjYXNjYWRlIHZpc2liaWxpdHkgZnJvbSBhIGNvbnRhaW5lciB0byBpdHMgY2hpbGRyZW4uCi8vIFRvIGF2b2lkICJnaG9zdCIgYWRtaW4gd2lkZ2V0cyBhcHBlYXJpbmcgd2hlbiB0aGUgcGFuZWwgaXMgaGlkZGVuLCB3ZSBleHBsaWNpdGx5IHRvZ2dsZSBhbGwgYWRtaW4vdGVzdGVyIHdpZGdldHMuCmZ1bmN0aW9uIHNldEFkbWluUGFuZWxDaGlsZFdpZGdldHNWaXNpYmxlKHBsYXllcklkOiBudW1iZXIsIHZpc2libGU6IGJvb2xlYW4pOiB2b2lkIHsKICAgIGNvbnN0IGlkczogc3RyaW5nW10gPSBbCiAgICAgICAgLy8gQWRtaW4vdGVzdGVyIGhlYWRlciArIHJvdyBsYWJlbHMKICAgICAgICBVSV9URVNUX0hFQURFUl9MQUJFTF9JRCwKICAgICAgICBVSV9URVNUX0xBQkVMX0xFRlRfV0lOU19JRCwKICAgICAgICBVSV9URVNUX0xBQkVMX1JJR0hUX1dJTlNfSUQsCiAgICAgICAgVUlfVEVTVF9MQUJFTF9MRUZUX0tJTExTX0lELAogICAgICAgIFVJX1RFU1RfTEFCRUxfUklHSFRfS0lMTFNfSUQsCiAgICAgICAgVUlfVEVTVF9MQUJFTF9ST1VORF9LSUxMU19UQVJHRVRfSUQsCiAgICAgICAgVUlfVEVTVF9WQUxVRV9ST1VORF9LSUxMU19UQVJHRVRfSUQsCiAgICAgICAgVUlfVEVTVF9MQUJFTF9USUVTX0lELAogICAgICAgIFVJX1RFU1RfTEFCRUxfQ1VSX1JPVU5EX0lELAogICAgICAgIFVJX1RFU1RfTEFCRUxfQ0xPQ0tfVElNRV9JRCwKICAgICAgICBVSV9BRE1JTl9MQUJFTF9UMV9ST1VORF9LSUxMU19JRCwKICAgICAgICBVSV9BRE1JTl9MQUJFTF9UMl9ST1VORF9LSUxMU19JRCwKCiAgICAgICAgLy8gUm93ICsvLSBidXR0b25zCiAgICAgICAgVUlfVEVTVF9CVVRUT05fTEVGVF9XSU5TX0RFQ19JRCwgVUlfVEVTVF9CVVRUT05fTEVGVF9XSU5TX0lOQ19JRCwKICAgICAgICBVSV9URVNUX0JVVFRPTl9SSUdIVF9XSU5TX0RFQ19JRCwgVUlfVEVTVF9CVVRUT05fUklHSFRfV0lOU19JTkNfSUQsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fTEVGVF9LSUxMU19ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX0xFRlRfS0lMTFNfSU5DX0lELAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1JJR0hUX0tJTExTX0RFQ19JRCwgVUlfVEVTVF9CVVRUT05fUklHSFRfS0lMTFNfSU5DX0lELAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1JPVU5EX0tJTExTX1RBUkdFVF9ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX1JPVU5EX0tJTExTX1RBUkdFVF9JTkNfSUQsCiAgICAgICAgVUlfQURNSU5fQlVUVE9OX1QxX1JPVU5EX0tJTExTX0RFQ19JRCwgVUlfQURNSU5fQlVUVE9OX1QxX1JPVU5EX0tJTExTX0lOQ19JRCwKICAgICAgICBVSV9BRE1JTl9CVVRUT05fVDJfUk9VTkRfS0lMTFNfREVDX0lELCBVSV9BRE1JTl9CVVRUT05fVDJfUk9VTkRfS0lMTFNfSU5DX0lELAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1RJRVNfREVDX0lELCBVSV9URVNUX0JVVFRPTl9USUVTX0lOQ19JRCwKICAgICAgICBVSV9URVNUX0JVVFRPTl9DVVJfUk9VTkRfREVDX0lELCBVSV9URVNUX0JVVFRPTl9DVVJfUk9VTkRfSU5DX0lELAogICAgICAgIFVJX1RFU1RfQlVUVE9OX0NMT0NLX1RJTUVfREVDX0lELCBVSV9URVNUX0JVVFRPTl9DTE9DS19USU1FX0lOQ19JRCwKCiAgICAgICAgLy8gKy8tIHRleHQgb3ZlcmxheXMKICAgICAgICBVSV9URVNUX01JTlVTX1RFWFRfSUQsCiAgICAgICAgVUlfVEVTVF9QTFVTX1RFWFRfSUQsCgogICAgICAgIC8vIEJvdHRvbSBhZG1pbiBidXR0b25zCiAgICAgICAgVUlfVEVTVF9CVVRUT05fQ0xPQ0tfUkVTRVRfSUQsIFVJX1RFU1RfUkVTRVRfVEVYVF9JRCwKICAgICAgICBVSV9URVNUX0JVVFRPTl9ST1VORF9TVEFSVF9JRCwgVUlfVEVTVF9ST1VORF9TVEFSVF9URVhUX0lELAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1JPVU5EX0VORF9JRCwgVUlfVEVTVF9ST1VORF9FTkRfVEVYVF9JRCwKICAgICAgICBVSV9URVNUX0JVVFRPTl9QT1NfREVCVUdfSUQsIFVJX1RFU1RfUE9TX0RFQlVHX1RFWFRfSUQsCiAgICBdOwoKICAgIGZvciAoY29uc3QgYmFzZUlkIG9mIGlkcykgewogICAgICAgIGNvbnN0IHcgPSBzYWZlRmluZChiYXNlSWQgKyBwbGF5ZXJJZCk7CiAgICAgICAgaWYgKHcpIG1vZC5TZXRVSVdpZGdldFZpc2libGUodywgdmlzaWJsZSk7CiAgICB9Cn0KCi8vIEFkbWluIFBhbmVsIGxpZmVjeWNsZSBoZWxwZXIuCi8vIFdlIERPIE5PVCBjYWNoZSB0aGUgYWRtaW4gcGFuZWwgY29udGVudHMgYmVjYXVzZSBzb21lIGVuZ2luZXMgZG8gbm90IHJlbGlhYmx5IGhpZGUgY29udGFpbmVyIGNoaWxkcmVuLgovLyBJbnN0ZWFkLCB3ZSBkZWxldGUgdGhlIHBhbmVsIGNvbnRhaW5lciArIGFsbCBjaGlsZHJlbiB3aGVuZXZlciBpdCBpcyBjbG9zZWQsIGFuZCByZWJ1aWxkIG9uLWRlbWFuZC4KZnVuY3Rpb24gZGVsZXRlQWRtaW5QYW5lbFVJKHBsYXllcklkOiBudW1iZXIsIGRlbGV0ZVRvZ2dsZTogYm9vbGVhbik6IHZvaWQgewogICAgLy8gSGlkZSBjaGlsZCB3aWRnZXRzIGZpcnN0IChjb3ZlcnMgYW55IHN0cmF5IGNoaWxkcmVuIHRoYXQgbWF5IGhhdmUgZGV0YWNoZWQgZnJvbSB0aGUgY29udGFpbmVyKS4KICAgIHNldEFkbWluUGFuZWxDaGlsZFdpZGdldHNWaXNpYmxlKHBsYXllcklkLCBmYWxzZSk7CgogICAgY29uc3QgYWRtaW5Db250YWluZXIgPSBzYWZlRmluZChVSV9BRE1JTl9QQU5FTF9DT05UQUlORVJfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAoYWRtaW5Db250YWluZXIpIG1vZC5EZWxldGVVSVdpZGdldChhZG1pbkNvbnRhaW5lcik7CgogICAgaWYgKGRlbGV0ZVRvZ2dsZSkgewogICAgICAgIGNvbnN0IGFkbWluVG9nZ2xlID0gc2FmZUZpbmQoVUlfQURNSU5fUEFORUxfQlVUVE9OX0lEICsgcGxheWVySWQpOwogICAgICAgIGlmIChhZG1pblRvZ2dsZSkgbW9kLkRlbGV0ZVVJV2lkZ2V0KGFkbWluVG9nZ2xlKTsKICAgICAgICBjb25zdCBhZG1pblRvZ2dsZUxhYmVsID0gc2FmZUZpbmQoVUlfQURNSU5fUEFORUxfQlVUVE9OX0xBQkVMX0lEICsgcGxheWVySWQpOwogICAgICAgIGlmIChhZG1pblRvZ2dsZUxhYmVsKSBtb2QuRGVsZXRlVUlXaWRnZXQoYWRtaW5Ub2dnbGVMYWJlbCk7CiAgICB9Cn0KCmZ1bmN0aW9uIGVuc3VyZUFkbWluUGFuZWxXaWRnZXRzKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyLCBwbGF5ZXJJZDogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCBBRE1JTl9UT0dHTEVfQlVUVE9OX0lEID0gVUlfQURNSU5fUEFORUxfQlVUVE9OX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBBRE1JTl9UT0dHTEVfTEFCRUxfSUQgPSBVSV9BRE1JTl9QQU5FTF9CVVRUT05fTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IEFETUlOX0NPTlRBSU5FUl9JRCA9IFVJX0FETUlOX1BBTkVMX0NPTlRBSU5FUl9JRCArIHBsYXllcklkOwoKICAgIC8vIENyZWF0ZSB0b2dnbGUgYnV0dG9uIGlmIG1pc3NpbmcuCiAgICBsZXQgdG9nZ2xlQnRuID0gc2FmZUZpbmQoQURNSU5fVE9HR0xFX0JVVFRPTl9JRCk7CiAgICBpZiAoIXRvZ2dsZUJ0bikgewogICAgICAgIG1vZC5BZGRVSUJ1dHRvbigKICAgICAgICAgICAgQURNSU5fVE9HR0xFX0JVVFRPTl9JRCwKICAgICAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtMTAsIDEwLCAwKSwKICAgICAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigxMjAsIDMyLCAwKSwKICAgICAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgICAgICBldmVudFBsYXllcgogICAgICAgICk7CiAgICAgICAgdG9nZ2xlQnRuID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKEFETUlOX1RPR0dMRV9CVVRUT05fSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgbW9kLlNldFVJQnV0dG9uQWxwaGFCYXNlKHRvZ2dsZUJ0biwgMC4zKTsKICAgIH0KCiAgICAvLyBDcmVhdGUgbGFiZWwgaWYgbWlzc2luZyAoc29tZSBVSSBzeXN0ZW1zIGNyZWF0ZSB0aGlzIGltcGxpY2l0bHk7IGtlZXAgc2FmZUZpbmQgYW55d2F5KS4KICAgIGxldCB0b2dnbGVMYWJlbCA9IHNhZmVGaW5kKEFETUlOX1RPR0dMRV9MQUJFTF9JRCk7CiAgICBpZiAoIXRvZ2dsZUxhYmVsKSB7CiAgICAgICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICAgICAgQURNSU5fVE9HR0xFX0xBQkVMX0lELAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0xMCwgMTAsIDApLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDEyMCwgMzIsIDApLAogICAgICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLmJ1dHRvbnMucGFuZWwpLAogICAgICAgICAgICBldmVudFBsYXllcgogICAgICAgICk7CiAgICAgICAgdG9nZ2xlTGFiZWwgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoQURNSU5fVE9HR0xFX0xBQkVMX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEodG9nZ2xlTGFiZWwsIDApOwogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKHRvZ2dsZUxhYmVsLCAxMik7CiAgICAgICAgbW9kLlNldFVJVGV4dENvbG9yKHRvZ2dsZUxhYmVsLCBtb2QuQ3JlYXRlVmVjdG9yKDEsIDEsIDEpKTsKICAgIH0KCiAgICAvLyBDcmVhdGUgYWRtaW4gY29udGFpbmVyIGlmIG1pc3NpbmcuCiAgICBsZXQgYWRtaW5Db250YWluZXIgPSBzYWZlRmluZChBRE1JTl9DT05UQUlORVJfSUQpOwogICAgaWYgKCFhZG1pbkNvbnRhaW5lcikgewogICAgICAgIG1vZC5BZGRVSUNvbnRhaW5lcigKICAgICAgICAgICAgQURNSU5fQ09OVEFJTkVSX0lELAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0xMCwgNDYsIDApLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDMzMCwgNTgwLCAwKSwKICAgICAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgICAgICBtb2QuR2V0VUlSb290KCksCiAgICAgICAgICAgIGZhbHNlLAogICAgICAgICAgICAxMCwKICAgICAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigwLCAwLCAwKSwKICAgICAgICAgICAgMC44LAogICAgICAgICAgICBtb2QuVUlCZ0ZpbGwuQmx1ciwKICAgICAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgICAgIGV2ZW50UGxheWVyCiAgICAgICAgKTsKICAgICAgICBhZG1pbkNvbnRhaW5lciA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShBRE1JTl9DT05UQUlORVJfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICB9CgogICAgLy8gQWRtaW4gdG9nZ2xlIGJ1dHRvbiBzaG91bGQgZXhpc3Qgb25seSB3aGlsZSB0aGUgUmVhZHkgVXAgZGlhbG9nIGlzIG9wZW4uCiAgICAvLyBXaGVuIGNhY2hpbmcgaXMgZW5hYmxlZCwgd2UgaGlkZS9zaG93IHJhdGhlciB0aGFuIHJlY3JlYXRlLgogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh0b2dnbGVCdG4sIHRydWUpOwogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh0b2dnbGVMYWJlbCwgdHJ1ZSk7CgogICAgLy8gRGVmYXVsdCBjbG9zZWQgb24gZmlyc3QgYnVpbGQ7IHByZXNlcnZlIHN0YXRlIG9uIHJlb3Blbi4KICAgIGlmICghU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwbGF5ZXJJZF0pIGluaXRUZWFtU3dpdGNoRGF0YShldmVudFBsYXllcik7CiAgICBpZiAoIVN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdLmFkbWluUGFuZWxCdWlsdCkgewogICAgICAgIFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGxheWVySWRdLmFkbWluUGFuZWxWaXNpYmxlID0gZmFsc2U7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShhZG1pbkNvbnRhaW5lciwgZmFsc2UpOwogICAgICAgIHNldEFkbWluUGFuZWxDaGlsZFdpZGdldHNWaXNpYmxlKHBsYXllcklkLCBmYWxzZSk7CiAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IHZpc2libGUgPSBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BsYXllcklkXS5hZG1pblBhbmVsVmlzaWJsZTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGFkbWluQ29udGFpbmVyLCB2aXNpYmxlKTsKICAgICAgICBzZXRBZG1pblBhbmVsQ2hpbGRXaWRnZXRzVmlzaWJsZShwbGF5ZXJJZCwgdmlzaWJsZSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGNyZWF0ZVRlYW1Td2l0Y2hVSShldmVudFBsYXllcjogbW9kLlBsYXllcikgewogICAgLy8gU3RlcHM6CiAgICAvLyAxKSBFbnN1cmUgcGVyLXBsYXllciBkaWFsb2cgcm9vdCBleGlzdHMKICAgIC8vIDIpIEJ1aWxkIGxlZnQgdGVhbSBwYW5lbCB3aWRnZXRzCiAgICAvLyAzKSBCdWlsZCByaWdodCB0ZWFtIHBhbmVsIHdpZGdldHMKICAgIC8vIDQpIEJ1aWxkIGFkbWluIHBhbmVsIHdpZGdldHMgKyBiaW5kIGJ1dHRvbiBJRHMKICAgIC8vIDUpIEZpbmFsaXplIHZpc2liaWxpdHkgLyBkZWZhdWx0IHN0YXRlcwoKICAgIC8vIFVJIGxheW91dCBtYXBzIChwZXIgcGFuZWwpOgogICAgLy8gLSBMZWZ0IHBhbmVsOiBUZWFtIDEgcm9zdGVyIC8gaW50ZXJhY3Rpb24gc3VyZmFjZSAobGF5b3V0LWRyaXZlbikuCiAgICAvLyAtIFJpZ2h0IHBhbmVsOiBUZWFtIDIgcm9zdGVyIC8gaW50ZXJhY3Rpb24gc3VyZmFjZSAobGF5b3V0LWRyaXZlbikuCiAgICAvLyAtIEFkbWluIHBhbmVsOiBUdW5hYmxlIGNvbnRyb2xzIHRoYXQgbXV0YXRlIGF1dGhvcml0YXRpdmUgc3RhdGU7IHJvd3MgYXJlIHBsYWNlZCB2aWEgcm93MFkgKyBOICogKGJ1dHRvblNpemVZICsgcm93U3BhY2luZ1kpLgogICAgLy8gTGF5b3V0IHJ1bGU6IGlmIGEgbGFiZWwgd3JhcHMgb3Igb3ZlcmxhcHMsIGFkanVzdCBsYWJlbFNpemVYIG9yIHRleHQgc2l6ZSBiZWZvcmUgdG91Y2hpbmcgcm93IG1hdGguCgogICAgY29uc3QgcGxheWVySWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgLy8gVUkgY2FjaGluZyAob3B0ICMxKTogaWYgdGhpcyBwbGF5ZXIgYWxyZWFkeSBidWlsdCB0aGUgZGlhbG9nIG9uY2UsIGp1c3Qgc2hvdyBpdCBhZ2Fpbi4KICAgIC8vIFRoaXMgYXZvaWRzIHJlY3JlYXRpbmcgfjEwMCB3aWRnZXRzIG9uIGV2ZXJ5IG9wZW4gYW5kIG1ha2VzIGRpYWxvZyBvcGVuIG5lYXItaW5zdGFudCBhZnRlciBmaXJzdCBidWlsZC4KICAgIGNvbnN0IGV4aXN0aW5nQmFzZSA9IHNhZmVGaW5kKFVJX1RFQU1TV0lUQ0hfQ09OVEFJTkVSX0JBU0VfSUQgKyBwbGF5ZXJJZCk7CiAgICBpZiAoZXhpc3RpbmdCYXNlKSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShleGlzdGluZ0Jhc2UsIHRydWUpOwogICAgICAgIGNvbnN0IGV4aXN0aW5nRGVidWcgPSBzYWZlRmluZChVSV9URUFNU1dJVENIX0RFQlVHX1RJTUVMSU1JVF9JRCArIHBsYXllcklkKTsKICAgICAgICBpZiAoZXhpc3RpbmdEZWJ1ZykgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShleGlzdGluZ0RlYnVnLCB0cnVlKTsKICAgICAgICBlbnN1cmVBZG1pblBhbmVsV2lkZ2V0cyhldmVudFBsYXllciwgcGxheWVySWQpOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBDT05UQUlORVJfQkFTRV9JRCA9IFVJX1RFQU1TV0lUQ0hfQ09OVEFJTkVSX0JBU0VfSUQgKyBwbGF5ZXJJZDsKCiAgICAvL2NvbnN0IEJVVFRPTl9URUFNMV9JRCA9IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX1RFQU0xX0lEICsgcGxheWVySWQ7IC8vb2xkIGJ1dHRvbi9kZWFkCiAgICAvL2NvbnN0IEJVVFRPTl9URUFNMV9MQUJFTF9JRCA9IFVJX1RFQU1TV0lUQ0hfQlVUVE9OX1RFQU0xX0xBQkVMX0lEICsgcGxheWVySWQ7IC8vb2xkIGJ1dHRvbi9kZWFkCgogICAgLy9jb25zdCBCVVRUT05fVEVBTTJfSUQgPSBVSV9URUFNU1dJVENIX0JVVFRPTl9URUFNMl9JRCArIHBsYXllcklkOyAvL29sZCBidXR0b24vZGVhZAogICAgLy9jb25zdCBCVVRUT05fVEVBTTJfTEFCRUxfSUQgPSBVSV9URUFNU1dJVENIX0JVVFRPTl9URUFNMl9MQUJFTF9JRCArIHBsYXllcklkOyAvL29sZCBidXR0b24vZGVhZAoKICAgIC8vY29uc3QgQlVUVE9OX1NQRUNUQVRFX0lEID0gVUlfVEVBTVNXSVRDSF9CVVRUT05fU1BFQ1RBVEVfSUQgKyBwbGF5ZXJJZDsgLy9vbGQgYnV0dG9uL2RlYWQKICAgIC8vY29uc3QgQlVUVE9OX1NQRUNUQVRFX0xBQkVMX0lEID0gVUlfVEVBTVNXSVRDSF9CVVRUT05fU1BFQ1RBVEVfTEFCRUxfSUQgKyBwbGF5ZXJJZDsgLy9vbGQgYnV0dG9uL2RlYWQKCiAgICBjb25zdCBCVVRUT05fQ0FOQ0VMX0lEID0gVUlfVEVBTVNXSVRDSF9CVVRUT05fQ0FOQ0VMX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBCVVRUT05fQ0FOQ0VMX0xBQkVMX0lEID0gVUlfVEVBTVNXSVRDSF9CVVRUT05fQ0FOQ0VMX0xBQkVMX0lEICsgcGxheWVySWQ7CgogICAgLy9jb25zdCBCVVRUT05fT1BUT1VUX0lEID0gVUlfVEVBTVNXSVRDSF9CVVRUT05fT1BUT1VUX0lEICsgcGxheWVySWQ7IC8vb2xkIGJ1dHRvbi9kZWFkCiAgICAvL2NvbnN0IEJVVFRPTl9PUFRPVVRfTEFCRUxfSUQgPSBVSV9URUFNU1dJVENIX0JVVFRPTl9PUFRPVVRfTEFCRUxfSUQgKyBwbGF5ZXJJZDsgLy9vbGQgYnV0dG9uL2RlYWQKCiAgICBtb2QuQWRkVUlDb250YWluZXIoCiAgICAgICAgQ09OVEFJTkVSX0JBU0VfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtMTAsIDAsIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMTMwMCwgNzAwLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgICAgIG1vZC5HZXRVSVJvb3QoKSwKICAgICAgICB0cnVlLAogICAgICAgIDEwLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCksCiAgICAgICAgMC45OTUsCiAgICAgICAgbW9kLlVJQmdGaWxsLkJsdXIsCiAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBDT05UQUlORVJfQkFTRSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShDT05UQUlORVJfQkFTRV9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoQ09OVEFJTkVSX0JBU0UsIDAuOTk1KTsgLy8gRm9yY2UgZGFya2VyIG92ZXJsYXkgKHNvbWUgY2xpZW50cyByZW5kZXIgYmx1ciBsaWdodGVyKQoKICAgIC8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBVSSAtIFJlYWR5IFVwIERpYWxvZyAoY29uc3RydWN0aW9uKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAoUm9zdGVyIFVJKSAtICAoaGVhZGVyICsgdGVhbSByb3N0ZXJzKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIEhlYWRlciByb3dzIChzdHJpbmctYmFja2VkIGZvciBlYXN5IGl0ZXJhdGlvbikuCiAgICBjb25zdCBSRUFEWV9IRUFERVJfSUQgPSBVSV9SRUFEWV9ESUFMT0dfSEVBREVSX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBSRUFEWV9IRUFERVIyX0lEID0gVUlfUkVBRFlfRElBTE9HX0hFQURFUjJfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IFJFQURZX0hFQURFUjNfSUQgPSBVSV9SRUFEWV9ESUFMT0dfSEVBREVSM19JRCArIHBsYXllcklkOwoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgUkVBRFlfSEVBREVSX0lELAogICAgICAgIC8vSWYgQW5jaG9yZWQgYXQgVG9wTGVmdCwgWCBpcyBsZWZ0IG9mZnNldCAtIGluY3JlYXNlIHRvIG1vdmUgcmlnaHQsIFkgaXMgZG93biBvZmZzZXQgLSBpbmNyZWFzZSB0byBtb3ZlIGRvd24KICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0xMSwgLTUsIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoOTAwLCAyMiwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmhlYWRlciksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBSRUFEWV9IRUFERVIgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoUkVBRFlfSEVBREVSX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShSRUFEWV9IRUFERVIsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoUkVBRFlfSEVBREVSLCAyMCk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoUkVBRFlfSEVBREVSLCBDT05UQUlORVJfQkFTRSk7CgogICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICBSRUFEWV9IRUFERVIyX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoLTExLCAxOSwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3Rvcig5MDAsIDIwLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wTGVmdCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuaGVhZGVyMiksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBSRUFEWV9IRUFERVIyID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFJFQURZX0hFQURFUjJfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKFJFQURZX0hFQURFUjIsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoUkVBRFlfSEVBREVSMiwgMTYpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFJFQURZX0hFQURFUjIsIENPTlRBSU5FUl9CQVNFKTsKCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIFJFQURZX0hFQURFUjNfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtMTEsIDM5LCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDkwMCwgMjAsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5oZWFkZXIzLCBNYXRoLmZsb29yKFZFSElDTEVfU1BBV05FUl9LRUVQX0FMSVZFX0FCQU5ET05fUkFESVVTKSksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBSRUFEWV9IRUFERVIzID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFJFQURZX0hFQURFUjNfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKFJFQURZX0hFQURFUjMsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoUkVBRFlfSEVBREVSMywgMTYpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFJFQURZX0hFQURFUjMsIENPTlRBSU5FUl9CQVNFKTsKCiAgICBjb25zdCBSRUFEWV9NQVBfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTUFQX0xBQkVMX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBSRUFEWV9NQVBfVkFMVUVfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTUFQX1ZBTFVFX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBtYXBMYWJlbFggPSAyNjA7CiAgICBjb25zdCBtYXBWYWx1ZVggPSAxMzU7IC8vLVggbW92ZXMgcmlnaHQKICAgIGNvbnN0IG1hcExhYmVsWSA9IDA7CiAgICBjb25zdCBtYXBMYWJlbFNpemVYID0gNTA7CiAgICBjb25zdCBtYXBWYWx1ZVNpemVYID0gMTQwOwoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgUkVBRFlfTUFQX0xBQkVMX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IobWFwTGFiZWxYLCBtYXBMYWJlbFksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IobWFwTGFiZWxTaXplWCwgMjAsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cubWFwTGFiZWwpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgUkVBRFlfTUFQX0xBQkVMID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFJFQURZX01BUF9MQUJFTF9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoUkVBRFlfTUFQX0xBQkVMLCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKFJFQURZX01BUF9MQUJFTCwgMTIpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFJFQURZX01BUF9MQUJFTCwgQ09OVEFJTkVSX0JBU0UpOwoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgUkVBRFlfTUFQX1ZBTFVFX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IobWFwVmFsdWVYLCBtYXBMYWJlbFksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IobWFwVmFsdWVTaXplWCwgMjAsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShnZXRNYXBOYW1lS2V5KEFDVElWRV9NQVBfS0VZKSksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBSRUFEWV9NQVBfVkFMVUUgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoUkVBRFlfTUFQX1ZBTFVFX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShSRUFEWV9NQVBfVkFMVUUsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoUkVBRFlfTUFQX1ZBTFVFLCAxMik7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoUkVBRFlfTUFQX1ZBTFVFLCBDT05UQUlORVJfQkFTRSk7CiAgICB1cGRhdGVSZWFkeURpYWxvZ01hcExhYmVsRm9yUGlkKHBsYXllcklkKTsKCiAgICAvLyBCZXN0LW9mIHJvdW5kcyBjb250cm9sICh0b3AtcmlnaHQpOiBtaW51cyBidXR0b24sIGR5bmFtaWMgbGFiZWwsIHBsdXMgYnV0dG9uLgogICAgY29uc3QgQkVTVE9GX0RFQ19JRCA9IFVJX1JFQURZX0RJQUxPR19CRVNUT0ZfREVDX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBCRVNUT0ZfREVDX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX0JFU1RPRl9ERUNfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IEJFU1RPRl9MQUJFTF9JRCA9IFVJX1JFQURZX0RJQUxPR19CRVNUT0ZfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IEJFU1RPRl9JTkNfSUQgPSBVSV9SRUFEWV9ESUFMT0dfQkVTVE9GX0lOQ19JRCArIHBsYXllcklkOwogICAgY29uc3QgQkVTVE9GX0lOQ19MQUJFTF9JRCA9IFVJX1JFQURZX0RJQUxPR19CRVNUT0ZfSU5DX0xBQkVMX0lEICsgcGxheWVySWQ7CgogICAgY29uc3QgYmVzdE9mWSA9IC0zOwogICAgY29uc3QgYmVzdE9mQnV0dG9uU2l6ZVggPSAyNjsKICAgIGNvbnN0IGJlc3RPZkJ1dHRvblNpemVZID0gMjQ7CiAgICBjb25zdCBiZXN0T2ZMYWJlbFNpemVYID0gMTcwOwogICAgY29uc3QgYmVzdE9mTGFiZWxTaXplWSA9IDI0OwoKICAgIC8vIEJlc3Qtb2Y6IG1pbnVzIGJ1dHRvbiAobGVmdCBvZiBsYWJlbCkKICAgIG1vZC5BZGRVSUJ1dHRvbigKICAgICAgICBCRVNUT0ZfREVDX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMTI1LCBiZXN0T2ZZLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKGJlc3RPZkJ1dHRvblNpemVYLCBiZXN0T2ZCdXR0b25TaXplWSwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgQkVTVE9GX0RFQyA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShCRVNUT0ZfREVDX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KEJFU1RPRl9ERUMsIENPTlRBSU5FUl9CQVNFKTsKCiAgICAvLyBCZXN0LW9mOiBtaW51cyBsYWJlbCAobGVmdCBvZiBsYWJlbCkKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgQkVTVE9GX0RFQ19MQUJFTF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDEyNSwgYmVzdE9mWSwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihiZXN0T2ZCdXR0b25TaXplWCwgYmVzdE9mQnV0dG9uU2l6ZVksIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudWkubWludXMpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgQkVTVE9GX0RFQ19MQUJFTCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShCRVNUT0ZfREVDX0xBQkVMX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShCRVNUT0ZfREVDX0xBQkVMLCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKEJFU1RPRl9ERUNfTEFCRUwsIDE0KTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChCRVNUT0ZfREVDX0xBQkVMLCBDT05UQUlORVJfQkFTRSk7CgogICAgLy8gQmVzdC1vZjogZHluYW1pYyBsYWJlbAogICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICBCRVNUT0ZfTEFCRUxfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtNDIsIGJlc3RPZlksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoYmVzdE9mTGFiZWxTaXplWCwgYmVzdE9mTGFiZWxTaXplWSwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5iZXN0T2ZMYWJlbCwgU3RhdGUucm91bmQubWF4KSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IEJFU1RPRl9MQUJFTCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShCRVNUT0ZfTEFCRUxfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKEJFU1RPRl9MQUJFTCwgMCk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShCRVNUT0ZfTEFCRUwsIDE0KTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChCRVNUT0ZfTEFCRUwsIENPTlRBSU5FUl9CQVNFKTsKCiAgICAvLyBCZXN0LW9mOiBwbHVzIGJ1dHRvbiAocmlnaHQgb2YgbGFiZWwpCiAgICBtb2QuQWRkVUlCdXR0b24oCiAgICAgICAgQkVTVE9GX0lOQ19JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0zLCBiZXN0T2ZZLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKGJlc3RPZkJ1dHRvblNpemVYLCBiZXN0T2ZCdXR0b25TaXplWSwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgQkVTVE9GX0lOQyA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShCRVNUT0ZfSU5DX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KEJFU1RPRl9JTkMsIENPTlRBSU5FUl9CQVNFKTsKCiAgICAvLyBCZXN0LW9mOiBwbHVzIGxhYmVsIChyaWdodCBvZiBsYWJlbCkKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgQkVTVE9GX0lOQ19MQUJFTF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0zLCBiZXN0T2ZZLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKGJlc3RPZkJ1dHRvblNpemVYLCBiZXN0T2ZCdXR0b25TaXplWSwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcFJpZ2h0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC51aS5wbHVzKSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IEJFU1RPRl9JTkNfTEFCRUwgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoQkVTVE9GX0lOQ19MQUJFTF9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoQkVTVE9GX0lOQ19MQUJFTCwgMCk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShCRVNUT0ZfSU5DX0xBQkVMLCAxNCk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoQkVTVE9GX0lOQ19MQUJFTCwgQ09OVEFJTkVSX0JBU0UpOwogICAgdXBkYXRlQmVzdE9mUm91bmRzTGFiZWxGb3JQaWQocGxheWVySWQpOwoKICAgIC8vIE1hdGNodXAgcHJlc2V0IGNvbnRyb2wgKGJlbG93IEJlc3Qtb2YpOiBtaW51cyBidXR0b24sIGR5bmFtaWMgbGFiZWwsIHBsdXMgYnV0dG9uLgogICAgY29uc3QgTUFUQ0hVUF9ERUNfSUQgPSBVSV9SRUFEWV9ESUFMT0dfTUFUQ0hVUF9ERUNfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IE1BVENIVVBfREVDX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01BVENIVVBfREVDX0xBQkVMX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBNQVRDSFVQX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX01BVENIVVBfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IE1BVENIVVBfSU5DX0lEID0gVUlfUkVBRFlfRElBTE9HX01BVENIVVBfSU5DX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBNQVRDSFVQX0lOQ19MQUJFTF9JRCA9IFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0lOQ19MQUJFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgTUFUQ0hVUF9NSU5QTEFZRVJTX0lEID0gVUlfUkVBRFlfRElBTE9HX01BVENIVVBfTUlOUExBWUVSU19JRCArIHBsYXllcklkOwogICAgY29uc3QgTUFUQ0hVUF9LSUxMU1RBUkdFVF9JRCA9IFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0tJTExTVEFSR0VUX0lEICsgcGxheWVySWQ7CgogICAgY29uc3QgbWF0Y2h1cFkgPSBiZXN0T2ZZICsgYmVzdE9mQnV0dG9uU2l6ZVkgKyA0OwoKICAgIC8vIE1hdGNodXA6IG1pbnVzIGJ1dHRvbiAobGVmdCBvZiBsYWJlbCkKICAgIG1vZC5BZGRVSUJ1dHRvbigKICAgICAgICBNQVRDSFVQX0RFQ19JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDEyNSwgbWF0Y2h1cFksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoYmVzdE9mQnV0dG9uU2l6ZVgsIGJlc3RPZkJ1dHRvblNpemVZLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBNQVRDSFVQX0RFQyA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShNQVRDSFVQX0RFQ19JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChNQVRDSFVQX0RFQywgQ09OVEFJTkVSX0JBU0UpOwoKICAgIC8vIE1hdGNodXA6IG1pbnVzIGxhYmVsCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIE1BVENIVVBfREVDX0xBQkVMX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMTI1LCBtYXRjaHVwWSwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihiZXN0T2ZCdXR0b25TaXplWCwgYmVzdE9mQnV0dG9uU2l6ZVksIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudWkubWludXMpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgTUFUQ0hVUF9ERUNfTEFCRUwgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoTUFUQ0hVUF9ERUNfTEFCRUxfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKE1BVENIVVBfREVDX0xBQkVMLCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKE1BVENIVVBfREVDX0xBQkVMLCAxNCk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoTUFUQ0hVUF9ERUNfTEFCRUwsIENPTlRBSU5FUl9CQVNFKTsKCiAgICAvLyBNYXRjaHVwOiBkeW5hbWljIGxhYmVsCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIE1BVENIVVBfTEFCRUxfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtNzUsIG1hdGNodXBZLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKGJlc3RPZkxhYmVsU2l6ZVgsIGJlc3RPZkxhYmVsU2l6ZVksIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cubWF0Y2h1cEZvcm1hdCwgMSwgMCksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBNQVRDSFVQX0xBQkVMID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKE1BVENIVVBfTEFCRUxfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKE1BVENIVVBfTEFCRUwsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoTUFUQ0hVUF9MQUJFTCwgMTQpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KE1BVENIVVBfTEFCRUwsIENPTlRBSU5FUl9CQVNFKTsKCiAgICAvLyBNYXRjaHVwOiBwbHVzIGJ1dHRvbiAocmlnaHQgb2YgbGFiZWwpCiAgICBtb2QuQWRkVUlCdXR0b24oCiAgICAgICAgTUFUQ0hVUF9JTkNfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtMywgbWF0Y2h1cFksIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoYmVzdE9mQnV0dG9uU2l6ZVgsIGJlc3RPZkJ1dHRvblNpemVZLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBNQVRDSFVQX0lOQyA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShNQVRDSFVQX0lOQ19JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChNQVRDSFVQX0lOQywgQ09OVEFJTkVSX0JBU0UpOwoKICAgIC8vIE1hdGNodXA6IHBsdXMgbGFiZWwgKHJpZ2h0IG9mIGxhYmVsKQogICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICBNQVRDSFVQX0lOQ19MQUJFTF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0zLCBtYXRjaHVwWSwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihiZXN0T2ZCdXR0b25TaXplWCwgYmVzdE9mQnV0dG9uU2l6ZVksIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudWkucGx1cyksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBNQVRDSFVQX0lOQ19MQUJFTCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShNQVRDSFVQX0lOQ19MQUJFTF9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoTUFUQ0hVUF9JTkNfTEFCRUwsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoTUFUQ0hVUF9JTkNfTEFCRUwsIDE0KTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChNQVRDSFVQX0lOQ19MQUJFTCwgQ09OVEFJTkVSX0JBU0UpOwoKICAgIC8vIE1hdGNodXAgcmVhZG91dHMgKGJlbG93IG1hdGNodXAgYnV0dG9ucykKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgTUFUQ0hVUF9NSU5QTEFZRVJTX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoLTQyIC0gKGJlc3RPZkxhYmVsU2l6ZVggKyA4MCkgLyA0LCBtYXRjaHVwWSArIGJlc3RPZkJ1dHRvblNpemVZICsgMiwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihiZXN0T2ZMYWJlbFNpemVYICsgODAsIDE2LCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLm1pblBsYXllcnNUb1N0YXJ0Rm9ybWF0LCBTdGF0ZS5yb3VuZC5hdXRvU3RhcnRNaW5BY3RpdmVQbGF5ZXJzKSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IE1BVENIVVBfTUlOUExBWUVSUyA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShNQVRDSFVQX01JTlBMQVlFUlNfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKE1BVENIVVBfTUlOUExBWUVSUywgMCk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShNQVRDSFVQX01JTlBMQVlFUlMsIDEyKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChNQVRDSFVQX01JTlBMQVlFUlMsIENPTlRBSU5FUl9CQVNFKTsKCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIE1BVENIVVBfS0lMTFNUQVJHRVRfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigtNDIgLSAoYmVzdE9mTGFiZWxTaXplWCArIDgwKSAvIDQsIG1hdGNodXBZICsgYmVzdE9mQnV0dG9uU2l6ZVkgKyAxOCwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcihiZXN0T2ZMYWJlbFNpemVYICsgODAsIDE2LCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnRhcmdldEtpbGxzVG9XaW5Gb3JtYXQsIFN0YXRlLnJvdW5kLmtpbGxzVGFyZ2V0KSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IE1BVENIVVBfS0lMTFNUQVJHRVQgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoTUFUQ0hVUF9LSUxMU1RBUkdFVF9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoTUFUQ0hVUF9LSUxMU1RBUkdFVCwgMCk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShNQVRDSFVQX0tJTExTVEFSR0VULCAxMik7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoTUFUQ0hVUF9LSUxMU1RBUkdFVCwgQ09OVEFJTkVSX0JBU0UpOwoKICAgIHVwZGF0ZU1hdGNodXBMYWJlbEZvclBpZChwbGF5ZXJJZCk7CiAgICB1cGRhdGVNYXRjaHVwUmVhZG91dHNGb3JQaWQocGxheWVySWQpOwoKICAgIC8vIExlZnQgYW5kIHJpZ2h0IHJvc3RlciBjb250YWluZXJzIChjaGlsZHJlbiBhcmUgcGFyZW50ZWQgdG8gdGhlc2UgY29udGFpbmVycykuCiAgICBjb25zdCBUMV9DT05UQUlORVJfSUQgPSBVSV9SRUFEWV9ESUFMT0dfVEVBTTFfQ09OVEFJTkVSX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBUMl9DT05UQUlORVJfSUQgPSBVSV9SRUFEWV9ESUFMT0dfVEVBTTJfQ09OVEFJTkVSX0lEICsgcGxheWVySWQ7CgogICAgbW9kLkFkZFVJQ29udGFpbmVyKAogICAgICAgIFQxX0NPTlRBSU5FUl9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDUwLCA5MCwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3Rvcig1ODAsIDQ0MCwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgdHJ1ZSwKICAgICAgICAxLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMC4xMCwgMC4yNSwgMC43MCksCiAgICAgICAgMC4yMCwKICAgICAgICBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBtb2QuQWRkVUlDb250YWluZXIoCiAgICAgICAgVDJfQ09OVEFJTkVSX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoNjcwLCA5MCwgMCksCiAgICAgICAgbW9kLkNyZWF0ZVZlY3Rvcig1ODAsIDQ0MCwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgQ09OVEFJTkVSX0JBU0UsCiAgICAgICAgdHJ1ZSwKICAgICAgICAxLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMC43MCwgMC4xNSwgMC4xNSksCiAgICAgICAgMC4yMCwKICAgICAgICBtb2QuVUlCZ0ZpbGwuU29saWQsCiAgICAgICAgbW9kLlVJRGVwdGguQWJvdmVHYW1lVUksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CgogICAgY29uc3QgVDFfQ09OVEFJTkVSID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFQxX0NPTlRBSU5FUl9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIGNvbnN0IFQyX0NPTlRBSU5FUiA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShUMl9DT05UQUlORVJfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CgogICAgLy8gVGVhbSBsYWJlbHMgcmV1c2UgZXhpc3RpbmcgdGVhbS1uYW1lIHN0cmluZ3MuCiAgICBjb25zdCBUMV9MQUJFTF9JRCA9IFVJX1JFQURZX0RJQUxPR19URUFNMV9MQUJFTF9JRCArIHBsYXllcklkOwogICAgY29uc3QgVDJfTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfVEVBTTJfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgVDFfTEFCRUxfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigxMCwgMTAsIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoNTYwLCAzNCwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsCiAgICAgICAgbW9kLk1lc3NhZ2UoZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0xKSksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBUMV9MQUJFTCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShUMV9MQUJFTF9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoVDFfTEFCRUwsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoVDFfTEFCRUwsIDIwKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChUMV9MQUJFTCwgVDFfQ09OVEFJTkVSKTsKCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIFQyX0xBQkVMX0lELAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMTAsIDEwLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDU2MCwgMzQsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIG1vZC5NZXNzYWdlKGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMikpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgVDJfTEFCRUwgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoVDJfTEFCRUxfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKFQyX0xBQkVMLCAwKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKFQyX0xBQkVMLCAyMCk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoVDJfTEFCRUwsIFQyX0NPTlRBSU5FUik7CgogICAgLy8gRml4ZWQgcm93czogdXAgdG8gMTYgcGxheWVycyBwZXIgdGVhbSAoMzIgbWF4KS4gSWYgd2UgZXZlciB3YW50IHRvIGdvIGFib3ZlIDE2IHBlciB0ZWFtLCB3ZSBzaG91bGQgaW50cm9kdWNlIGEgTmV4dCBQYWdlIG9yIFByZXZpb3VzIFBhZ2UgYnV0dG9uPyBTbGlkZXI/CiAgICBjb25zdCByb3dTdGFydFkgPSA1MDsKICAgIGNvbnN0IHJvd0ggPSAyNjsKICAgIGNvbnN0IGNvbE5hbWVYID0gMTA7CiAgICBjb25zdCBjb2xSZWFkeVggPSAyODA7CiAgICBjb25zdCBjb2xCYXNlWCA9IDQyMDsKICAgIGNvbnN0IGNvbE5hbWVXID0gMjYwOwogICAgY29uc3QgY29sU3RhdHVzVyA9IDE0MDsKCiAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCAxNjsgcm93KyspIHsKICAgICAgICBjb25zdCB5ID0gcm93U3RhcnRZICsgKHJvdyAqIHJvd0gpOwoKICAgICAgICBjb25zdCB0MU5hbWVJZCA9IFVJX1JFQURZX0RJQUxPR19UMV9ST1dfTkFNRV9JRCArIHBsYXllcklkICsgIl8iICsgcm93OwogICAgICAgIGNvbnN0IHQxUmVhZHlJZCA9IFVJX1JFQURZX0RJQUxPR19UMV9ST1dfUkVBRFlfSUQgKyBwbGF5ZXJJZCArICJfIiArIHJvdzsKICAgICAgICBjb25zdCB0MUJhc2VJZCA9IFVJX1JFQURZX0RJQUxPR19UMV9ST1dfQkFTRV9JRCArIHBsYXllcklkICsgIl8iICsgcm93OwoKICAgICAgICBtb2QuQWRkVUlUZXh0KHQxTmFtZUlkLCBtb2QuQ3JlYXRlVmVjdG9yKGNvbE5hbWVYLCB5LCAwKSwgbW9kLkNyZWF0ZVZlY3Rvcihjb2xOYW1lVywgcm93SCwgMCksIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCAiIiksIGV2ZW50UGxheWVyKTsKICAgICAgICBjb25zdCBUMV9OQU1FID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKHQxTmFtZUlkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoVDFfTkFNRSwgMCk7CiAgICAgICAgbW9kLlNldFVJVGV4dFNpemUoVDFfTkFNRSwgMTQpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChUMV9OQU1FLCBUMV9DT05UQUlORVIpOwoKICAgICAgICBtb2QuQWRkVUlUZXh0KHQxUmVhZHlJZCwgbW9kLkNyZWF0ZVZlY3Rvcihjb2xSZWFkeVgsIHksIDApLCBtb2QuQ3JlYXRlVmVjdG9yKGNvbFN0YXR1c1csIHJvd0gsIDApLCBtb2QuVUlBbmNob3IuVG9wTGVmdCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgIiIpLCBldmVudFBsYXllcik7CiAgICAgICAgY29uc3QgVDFfUkVBRFkgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodDFSZWFkeUlkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoVDFfUkVBRFksIDApOwogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKFQxX1JFQURZLCAxNCk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFQxX1JFQURZLCBUMV9DT05UQUlORVIpOwoKICAgICAgICBtb2QuQWRkVUlUZXh0KHQxQmFzZUlkLCBtb2QuQ3JlYXRlVmVjdG9yKGNvbEJhc2VYLCB5LCAwKSwgbW9kLkNyZWF0ZVZlY3Rvcihjb2xTdGF0dXNXLCByb3dILCAwKSwgbW9kLlVJQW5jaG9yLlRvcExlZnQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsICIiKSwgZXZlbnRQbGF5ZXIpOwogICAgICAgIGNvbnN0IFQxX0JBU0UgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodDFCYXNlSWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShUMV9CQVNFLCAwKTsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShUMV9CQVNFLCAxNCk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFQxX0JBU0UsIFQxX0NPTlRBSU5FUik7CgogICAgICAgIGNvbnN0IHQyTmFtZUlkID0gVUlfUkVBRFlfRElBTE9HX1QyX1JPV19OQU1FX0lEICsgcGxheWVySWQgKyAiXyIgKyByb3c7CiAgICAgICAgY29uc3QgdDJSZWFkeUlkID0gVUlfUkVBRFlfRElBTE9HX1QyX1JPV19SRUFEWV9JRCArIHBsYXllcklkICsgIl8iICsgcm93OwogICAgICAgIGNvbnN0IHQyQmFzZUlkID0gVUlfUkVBRFlfRElBTE9HX1QyX1JPV19CQVNFX0lEICsgcGxheWVySWQgKyAiXyIgKyByb3c7CgogICAgICAgIG1vZC5BZGRVSVRleHQodDJOYW1lSWQsIG1vZC5DcmVhdGVWZWN0b3IoY29sTmFtZVgsIHksIDApLCBtb2QuQ3JlYXRlVmVjdG9yKGNvbE5hbWVXLCByb3dILCAwKSwgbW9kLlVJQW5jaG9yLlRvcExlZnQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsICIiKSwgZXZlbnRQbGF5ZXIpOwogICAgICAgIGNvbnN0IFQyX05BTUUgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodDJOYW1lSWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShUMl9OQU1FLCAwKTsKICAgICAgICBtb2QuU2V0VUlUZXh0U2l6ZShUMl9OQU1FLCAxNCk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFQyX05BTUUsIFQyX0NPTlRBSU5FUik7CgogICAgICAgIG1vZC5BZGRVSVRleHQodDJSZWFkeUlkLCBtb2QuQ3JlYXRlVmVjdG9yKGNvbFJlYWR5WCwgeSwgMCksIG1vZC5DcmVhdGVWZWN0b3IoY29sU3RhdHVzVywgcm93SCwgMCksIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCAiIiksIGV2ZW50UGxheWVyKTsKICAgICAgICBjb25zdCBUMl9SRUFEWSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZSh0MlJlYWR5SWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShUMl9SRUFEWSwgMCk7CiAgICAgICAgbW9kLlNldFVJVGV4dFNpemUoVDJfUkVBRFksIDE0KTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoVDJfUkVBRFksIFQyX0NPTlRBSU5FUik7CgogICAgICAgIG1vZC5BZGRVSVRleHQodDJCYXNlSWQsIG1vZC5DcmVhdGVWZWN0b3IoY29sQmFzZVgsIHksIDApLCBtb2QuQ3JlYXRlVmVjdG9yKGNvbFN0YXR1c1csIHJvd0gsIDApLCBtb2QuVUlBbmNob3IuVG9wTGVmdCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgIiIpLCBldmVudFBsYXllcik7CiAgICAgICAgY29uc3QgVDJfQkFTRSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZSh0MkJhc2VJZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKFQyX0JBU0UsIDApOwogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKFQyX0JBU0UsIDE0KTsKICAgICAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoVDJfQkFTRSwgVDJfQ09OVEFJTkVSKTsKICAgIH0KCiAgICAvLyBQb3B1bGF0ZSByb3dzIGZvciB0aGlzIHZpZXdlciAuCiAgICByZWZyZXNoUmVhZHlEaWFsb2dSb3N0ZXJGb3JWaWV3ZXIoZXZlbnRQbGF5ZXIsIHBsYXllcklkKTsKCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIChSb3N0ZXIgVUkpIC0gIChoZWFkZXIgKyB0ZWFtIHJvc3RlcnMpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIFN3YXAgVGVhbXMgQnV0dG9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLy8gQm90dG9tLWxlZnQgdG9nZ2xlOiBzd2FwcyB0aGUgcGxheWVyJ3MgY3VycmVudCB0ZWFtIChUZWFtIDEgPC0+IFRlYW0gMikuCiAgICBjb25zdCBTV0FQX0JVVFRPTl9JRCA9IFVJX1JFQURZX0RJQUxPR19CVVRUT05fU1dBUF9JRCArIHBsYXllcklkOwogICAgY29uc3QgU1dBUF9CVVRUT05fTEFCRUxfSUQgPSBVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1NXQVBfTEFCRUxfSUQgKyBwbGF5ZXJJZDsKCiAgICBtb2QuQWRkVUlCdXR0b24oCiAgICAgICAgU1dBUF9CVVRUT05fSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigwLCAwLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDMwMCwgMTAwLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuQm90dG9tTGVmdCwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IFNXQVBfQlVUVE9OID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFNXQVBfQlVUVE9OX0lELCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFNXQVBfQlVUVE9OLCBDT05UQUlORVJfQkFTRSk7CgogICAgbW9kLkFkZFVJVGV4dCgKICAgICAgICBTV0FQX0JVVFRPTl9MQUJFTF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDAsIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMzAwLCAxMDAsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Cb3R0b21MZWZ0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5idXR0b25zLnN3YXBUZWFtcyksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBTV0FQX0JVVFRPTl9MQUJFTCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShTV0FQX0JVVFRPTl9MQUJFTF9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoU1dBUF9CVVRUT05fTEFCRUwsIDApOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFNXQVBfQlVUVE9OX0xBQkVMLCBDT05UQUlORVJfQkFTRSk7CgogICAgLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIFJlYWR5IERpYWxvZyAtIFN3YXAgVGVhbXMgQnV0dG9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCiAgICAvLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nICAtIFJlYWR5IFRvZ2dsZSBCdXR0b24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAvLyBCb3R0b20tY2VudGVyIHRvZ2dsZTogc3RhcnRzIGFzICJSZWFkeSIgKHByZXNzaW5nIGl0IHNldHMgUkVBRFkpLCB0aGVuIGZsaXBzIHRvICJOb3QgUmVhZHkiLgogICAgY29uc3QgUkVBRFlfQlVUVE9OX0lEID0gVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9SRUFEWV9JRCArIHBsYXllcklkOwogICAgY29uc3QgUkVBRFlfQlVUVE9OX0xBQkVMX0lEID0gVUlfUkVBRFlfRElBTE9HX0JVVFRPTl9SRUFEWV9MQUJFTF9JRCArIHBsYXllcklkOwoKICAgIG1vZC5BZGRVSUJ1dHRvbigKICAgICAgICBSRUFEWV9CVVRUT05fSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigwLCAwLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDMwMCwgMTAwLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuQm90dG9tQ2VudGVyLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgUkVBRFlfQlVUVE9OID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFJFQURZX0JVVFRPTl9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChSRUFEWV9CVVRUT04sIENPTlRBSU5FUl9CQVNFKTsKCiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIFJFQURZX0JVVFRPTl9MQUJFTF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDAsIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMzAwLCAxMDAsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Cb3R0b21DZW50ZXIsCiAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJ1dHRvbnMucmVhZHkpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgUkVBRFlfQlVUVE9OX0xBQkVMID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKFJFQURZX0JVVFRPTl9MQUJFTF9JRCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoUkVBRFlfQlVUVE9OX0xBQkVMLCAwKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChSRUFEWV9CVVRUT05fTEFCRUwsIENPTlRBSU5FUl9CQVNFKTsKCiAgICAvLyBFbnN1cmUgdGhlIGxhYmVsIG1hdGNoZXMgdGhlIGN1cnJlbnQgc3RvcmVkIHN0YXRlIGZvciB0aGlzIHZpZXdlciAoZGVmYXVsdCBpcyBOT1QgUkVBRFkpLgogICAgdXBkYXRlUmVhZHlUb2dnbGVCdXR0b25Gb3JWaWV3ZXIoZXZlbnRQbGF5ZXIsIHBsYXllcklkKTsKCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nICAtIFJlYWR5IFRvZ2dsZSBCdXR0b24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKICAgIC8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBEZWJ1ZyBJbmZvIC0gVGltZSBMaW1pdCBTZWNvbmRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLy8gU2hvd3MgdGhlIGN1cnJlbnQgaW5mZXJyZWQgZ2FtZW1vZGUgdGltZSBsaW1pdCAoc2Vjb25kcykgd2hpbGUgdGhlIHRlYW0gc3dpdGNoIGRpYWxvZyBpcyBvcGVuLgogICAgY29uc3QgZGVidWdUaW1lTGltaXRTZWNvbmRzID0gTWF0aC5mbG9vcihtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpICsgbW9kLkdldE1hdGNoVGltZVJlbWFpbmluZygpKTsKICAgIGNvbnN0IERFQlVHX1RJTUVMSU1JVF9JRCA9IFVJX1RFQU1TV0lUQ0hfREVCVUdfVElNRUxJTUlUX0lEICsgcGxheWVySWQ7CiAgICBtb2QuQWRkVUlUZXh0KAogICAgICAgIERFQlVHX1RJTUVMSU1JVF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKC0zMjAsIC0xNjAsIDApLCAgLy9tb2QuQ3JlYXRlVmVjdG9yKC0yMjAsIDEwLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDgwLCAyOCwgMCksICAgIC8vbW9kLkNyZWF0ZVZlY3Rvcig4MCwgMjgsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BSaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudGVhbVN3aXRjaC5kZWJ1Z1RpbWVMaW1pdCwgZGVidWdUaW1lTGltaXRTZWNvbmRzKSwKICAgICAgICBldmVudFBsYXllcgogICAgKTsKICAgIGNvbnN0IERFQlVHX1RJTUVMSU1JVCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShERUJVR19USU1FTElNSVRfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAvLyBQYXJlbnQgdG8gdGhlIFRlYW0gU3dpdGNoIGNvbnRhaW5lciBzbyB0aGUgdGV4dCBpcyBhbHdheXMgZHJhd24gYWJvdmUgdGhlIGRpYWxvZyBiYWNrZ3JvdW5kLgogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KERFQlVHX1RJTUVMSU1JVCwgQ09OVEFJTkVSX0JBU0UpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShERUJVR19USU1FTElNSVQsIDApOwogICAgbW9kLlNldFVJVGV4dFNpemUoREVCVUdfVElNRUxJTUlULCAxMik7CgogICAgLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIERlYnVnIEluZm8gLSBUaW1lIExpbWl0IFNlY29uZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgogICAgCiAgICAvLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gQWRtaW4gUGFuZWwgVG9nZ2xlIEJ1dHRvbiAoVG9wLVJpZ2h0LCBvbmx5IHdoaWxlIFJlYWR5IFVwIGRpYWxvZyBpcyBvcGVuKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIFVJIGNhY2hpbmcgbm90ZTogdGhlc2Ugd2lkZ2V0cyBhcmUgY3JlYXRlZCBvbmNlIGFuZCB0aGVuIGhpZGRlbi9zaG93biBvbiBvcGVuL2Nsb3NlLgogICAgZW5zdXJlQWRtaW5QYW5lbFdpZGdldHMoZXZlbnRQbGF5ZXIsIHBsYXllcklkKTsKCiAgICAvLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gQWRtaW4gUGFuZWwgVG9nZ2xlIEJ1dHRvbiAoVG9wLVJpZ2h0LCBvbmx5IHdoaWxlIFJlYWR5IFVwIGRpYWxvZyBpcyBvcGVuKSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgogICAgLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIERpYWxvZyBCdXR0b25zIChMZWZ0IFNpZGUpIC0gQ2FuY2VsIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLy8gQ2FuY2VsIHJlbWFpbnMgYSBjb3JlIGZ1bmN0aW9uIHNvIHBsYXllcnMgY2FuIGRpc21pc3MgdGhlIGRpYWxvZyBhbmQgcmVnYWluIGNvbnRyb2wuCiAgICAvLyAoVGVhbSBzd2l0Y2hpbmcgLyBzcGVjdGF0ZSAvIG9wdC1vdXQgYnV0dG9ucyBhcmUgaW50ZW50aW9uYWxseSBub3QgZXhwb3NlZCBpbiB2MC41Kzsgc2VlIERlcHJlY2F0ZWQgVUkgYmxvY2sgYmVsb3cuKQogICAgbW9kLkFkZFVJQnV0dG9uKAogICAgICAgIEJVVFRPTl9DQU5DRUxfSUQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3RvcigwLCAwLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDMwMCwgMTAwLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuQm90dG9tUmlnaHQsCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBCVVRUT05fQ0FOQ0VMID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKEJVVFRPTl9DQU5DRUxfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoQlVUVE9OX0NBTkNFTCwgQ09OVEFJTkVSX0JBU0UpOwoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgQlVUVE9OX0NBTkNFTF9MQUJFTF9JRCwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDAsIDAsIDApLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMzAwLCAxMDAsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Cb3R0b21SaWdodCwKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudGVhbVN3aXRjaC5idXR0b25zLmNhbmNlbCksCiAgICAgICAgZXZlbnRQbGF5ZXIKICAgICk7CiAgICBjb25zdCBCVVRUT05fQ0FOQ0VMX0xBQkVMID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKEJVVFRPTl9DQU5DRUxfTEFCRUxfSUQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKEJVVFRPTl9DQU5DRUxfTEFCRUwsIDApOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KEJVVFRPTl9DQU5DRUxfTEFCRUwsIENPTlRBSU5FUl9CQVNFKTsKCiAgICAvLyBMYXlvdXQgY29uc3RhbnRzOiBhZGp1c3QgY2F1dGlvdXNseTsgdmVyaWZ5IGluLWdhbWUgZGlhbG9nIEFkbWluIHBhbmVsIHdpZGdldHMgYXJlIGJ1aWx0IGxhemlseSBvbiBmaXJzdCBvcGVuIChzZWUgYnVpbGRBZG1pblBhbmVsV2lkZ2V0cykgdG8gcHJldmVudCBhIG9uZS10aWNrIHJlbmRlciBmbGlja2VyLgogICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yUGxheWVyKGV2ZW50UGxheWVyKTsKfQoKLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIERpYWxvZyBCdXR0b25zIChMZWZ0IFNpZGUpIC0gQ2FuY2VsIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBBZG1pbiBQYW5lbCBVSSAoUmlnaHQgU2lkZSkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vIEJ1aWxkcyB0aGUgQWRtaW4gUGFuZWwgd2lkZ2V0cyBsYXppbHkgKHRvIGF2b2lkIGEgMS1mcmFtZSBmbGlja2VyIG9uIGRpYWxvZyBvcGVuKS4KZnVuY3Rpb24gYnVpbGRBZG1pblBhbmVsV2lkZ2V0cyhldmVudFBsYXllcjogbW9kLlBsYXllciwgYWRtaW5Db250YWluZXI6IG1vZC5VSVdpZGdldCwgcGxheWVySWQ6IG51bWJlcik6IHZvaWQgewoKICAgIC8vIEZpdCBhdCB0YXJnZXQgcmVzb2x1dGlvbnMuCiAgICBjb25zdCB0ZXN0ZXJCYXNlWCA9IDEwOwogICAgY29uc3QgdGVzdGVyQmFzZVkgPSAxMDsKCiAgICBjb25zdCBidXR0b25TaXplWCA9IDQ4OwogICAgY29uc3QgYnV0dG9uU2l6ZVkgPSAzNDsKICAgIGNvbnN0IGxhYmVsU2l6ZVggPSAxNzU7CiAgICBjb25zdCByb3dTcGFjaW5nWSA9IDQ7CgogICAgY29uc3QgZGVjT2Zmc2V0WCA9IDA7CiAgICBjb25zdCBsYWJlbE9mZnNldFggPSBidXR0b25TaXplWCArIDg7CiAgICBjb25zdCBpbmNPZmZzZXRYID0gYnV0dG9uU2l6ZVggKyA4ICsgbGFiZWxTaXplWCArIDg7CgogICAgY29uc3QgaGVhZGVySWQgPSBVSV9URVNUX0hFQURFUl9MQUJFTF9JRCArIHBsYXllcklkOwoKICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgaGVhZGVySWQsCiAgICAgICAgbW9kLkNyZWF0ZVZlY3Rvcih0ZXN0ZXJCYXNlWCwgdGVzdGVyQmFzZVkgKyAyLCAwKSwKICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDIyMCwgMTgsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLnRlc3Rlci5oZWFkZXIpLAogICAgICAgIGV2ZW50UGxheWVyCiAgICApOwogICAgY29uc3QgVEVTVF9IRUFERVIgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoaGVhZGVySWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShURVNUX0hFQURFUiwgMTIpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShURVNUX0hFQURFUiwgMCk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoVEVTVF9IRUFERVIsIGFkbWluQ29udGFpbmVyKTsKCiAgICBjb25zdCByb3cwWSA9IHRlc3RlckJhc2VZICsgMjI7CgogICAgYWRkVGVzdGVyUm93KGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQsIHRlc3RlckJhc2VYLCByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDAsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fTEVGVF9XSU5TX0RFQ19JRCwgVUlfVEVTVF9CVVRUT05fTEVGVF9XSU5TX0lOQ19JRCwgVUlfVEVTVF9MQUJFTF9MRUZUX1dJTlNfSUQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmxhYmVscy5sZWZ0V2lucywgYnV0dG9uU2l6ZVgsIGJ1dHRvblNpemVZLCBsYWJlbFNpemVYLCBkZWNPZmZzZXRYLCBsYWJlbE9mZnNldFgsIGluY09mZnNldFgpOwoKICAgIGFkZFRlc3RlclJvdyhldmVudFBsYXllciwgYWRtaW5Db250YWluZXIsIHBsYXllcklkLCB0ZXN0ZXJCYXNlWCwgcm93MFkgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSkgKiAxLAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1JJR0hUX1dJTlNfREVDX0lELCBVSV9URVNUX0JVVFRPTl9SSUdIVF9XSU5TX0lOQ19JRCwgVUlfVEVTVF9MQUJFTF9SSUdIVF9XSU5TX0lELAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLnRlc3Rlci5sYWJlbHMucmlnaHRXaW5zLCBidXR0b25TaXplWCwgYnV0dG9uU2l6ZVksIGxhYmVsU2l6ZVgsIGRlY09mZnNldFgsIGxhYmVsT2Zmc2V0WCwgaW5jT2Zmc2V0WCk7CgogICAgYWRkVGVzdGVyUm93KGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQsIHRlc3RlckJhc2VYLCByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDIsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fTEVGVF9LSUxMU19ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX0xFRlRfS0lMTFNfSU5DX0lELCBVSV9URVNUX0xBQkVMX0xFRlRfS0lMTFNfSUQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmxhYmVscy5sZWZ0S2lsbHMsIGJ1dHRvblNpemVYLCBidXR0b25TaXplWSwgbGFiZWxTaXplWCwgZGVjT2Zmc2V0WCwgbGFiZWxPZmZzZXRYLCBpbmNPZmZzZXRYKTsKCiAgICBhZGRUZXN0ZXJSb3coZXZlbnRQbGF5ZXIsIGFkbWluQ29udGFpbmVyLCBwbGF5ZXJJZCwgdGVzdGVyQmFzZVgsIHJvdzBZICsgKGJ1dHRvblNpemVZICsgcm93U3BhY2luZ1kpICogMywKICAgICAgICBVSV9URVNUX0JVVFRPTl9SSUdIVF9LSUxMU19ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX1JJR0hUX0tJTExTX0lOQ19JRCwgVUlfVEVTVF9MQUJFTF9SSUdIVF9LSUxMU19JRCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC50ZXN0ZXIubGFiZWxzLnJpZ2h0S2lsbHMsIGJ1dHRvblNpemVYLCBidXR0b25TaXplWSwgbGFiZWxTaXplWCwgZGVjT2Zmc2V0WCwgbGFiZWxPZmZzZXRYLCBpbmNPZmZzZXRYKTsKCiAgICBhZGRUZXN0ZXJSb3coZXZlbnRQbGF5ZXIsIGFkbWluQ29udGFpbmVyLCBwbGF5ZXJJZCwgdGVzdGVyQmFzZVgsIHJvdzBZICsgKGJ1dHRvblNpemVZICsgcm93U3BhY2luZ1kpICogNCwKICAgICAgICBVSV9BRE1JTl9CVVRUT05fVDFfUk9VTkRfS0lMTFNfREVDX0lELCBVSV9BRE1JTl9CVVRUT05fVDFfUk9VTkRfS0lMTFNfSU5DX0lELCBVSV9BRE1JTl9MQUJFTF9UMV9ST1VORF9LSUxMU19JRCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC5sYWJlbHMudDFSb3VuZEtpbGxzLCBidXR0b25TaXplWCwgYnV0dG9uU2l6ZVksIGxhYmVsU2l6ZVgsIGRlY09mZnNldFgsIGxhYmVsT2Zmc2V0WCwgaW5jT2Zmc2V0WCk7CgogICAgYWRkVGVzdGVyUm93KGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQsIHRlc3RlckJhc2VYLCByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDUsCiAgICAgICAgVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0RFQ19JRCwgVUlfQURNSU5fQlVUVE9OX1QyX1JPVU5EX0tJTExTX0lOQ19JRCwgVUlfQURNSU5fTEFCRUxfVDJfUk9VTkRfS0lMTFNfSUQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwubGFiZWxzLnQyUm91bmRLaWxscywgYnV0dG9uU2l6ZVgsIGJ1dHRvblNpemVZLCBsYWJlbFNpemVYLCBkZWNPZmZzZXRYLCBsYWJlbE9mZnNldFgsIGluY09mZnNldFgpOwoKICAgIGFkZFRlc3RlclJvd1dpdGhWYWx1ZShldmVudFBsYXllciwgYWRtaW5Db250YWluZXIsIHBsYXllcklkLCB0ZXN0ZXJCYXNlWCwgcm93MFkgKyAoYnV0dG9uU2l6ZVkgKyByb3dTcGFjaW5nWSkgKiA2LAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1JPVU5EX0tJTExTX1RBUkdFVF9ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX1JPVU5EX0tJTExTX1RBUkdFVF9JTkNfSUQsIFVJX1RFU1RfTEFCRUxfUk9VTkRfS0lMTFNfVEFSR0VUX0lELCBVSV9URVNUX1ZBTFVFX1JPVU5EX0tJTExTX1RBUkdFVF9JRCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC50ZXN0ZXIubGFiZWxzLnJvdW5kS2lsbHNUYXJnZXQsIFN0YXRlLnJvdW5kLmtpbGxzVGFyZ2V0LCBidXR0b25TaXplWCwgYnV0dG9uU2l6ZVksIGxhYmVsU2l6ZVgsIDQ2LCBkZWNPZmZzZXRYLCBsYWJlbE9mZnNldFgsIGluY09mZnNldFgpOwoKICAgIHN5bmNSb3VuZEtpbGxzVGFyZ2V0VGVzdGVyVmFsdWVGb3JBbGxQbGF5ZXJzKCk7CgogICAgYWRkVGVzdGVyUm93KGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQsIHRlc3RlckJhc2VYLCByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDcsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fVElFU19ERUNfSUQsIFVJX1RFU1RfQlVUVE9OX1RJRVNfSU5DX0lELCBVSV9URVNUX0xBQkVMX1RJRVNfSUQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmxhYmVscy50aWVzLCBidXR0b25TaXplWCwgYnV0dG9uU2l6ZVksIGxhYmVsU2l6ZVgsIGRlY09mZnNldFgsIGxhYmVsT2Zmc2V0WCwgaW5jT2Zmc2V0WCk7CgogICAgYWRkVGVzdGVyUm93KGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQsIHRlc3RlckJhc2VYLCByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDgsCiAgICAgICAgVUlfVEVTVF9CVVRUT05fQ1VSX1JPVU5EX0RFQ19JRCwgVUlfVEVTVF9CVVRUT05fQ1VSX1JPVU5EX0lOQ19JRCwgVUlfVEVTVF9MQUJFTF9DVVJfUk9VTkRfSUQsCiAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmxhYmVscy5jdXJyZW50Um91bmQsIGJ1dHRvblNpemVYLCBidXR0b25TaXplWSwgbGFiZWxTaXplWCwgZGVjT2Zmc2V0WCwgbGFiZWxPZmZzZXRYLCBpbmNPZmZzZXRYKTsKCiAgICBhZGRUZXN0ZXJSb3coZXZlbnRQbGF5ZXIsIGFkbWluQ29udGFpbmVyLCBwbGF5ZXJJZCwgdGVzdGVyQmFzZVgsIHJvdzBZICsgKGJ1dHRvblNpemVZICsgcm93U3BhY2luZ1kpICogOSwKICAgICAgICBVSV9URVNUX0JVVFRPTl9DTE9DS19USU1FX0RFQ19JRCwgVUlfVEVTVF9CVVRUT05fQ0xPQ0tfVElNRV9JTkNfSUQsIFVJX1RFU1RfTEFCRUxfQ0xPQ0tfVElNRV9JRCwKICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuYWRtaW5QYW5lbC50ZXN0ZXIubGFiZWxzLmNsb2NrVGltZSwgYnV0dG9uU2l6ZVgsIGJ1dHRvblNpemVZLCBsYWJlbFNpemVYLCBkZWNPZmZzZXRYLCBsYWJlbE9mZnNldFgsIGluY09mZnNldFgpOwoKICAgIGFkZFRlc3RlclJlc2V0QnV0dG9uKGV2ZW50UGxheWVyLCBhZG1pbkNvbnRhaW5lciwgcGxheWVySWQsIHRlc3RlckJhc2VYLAogICAgICAgIHJvdzBZICsgKGJ1dHRvblNpemVZICsgcm93U3BhY2luZ1kpICogMTAsIChidXR0b25TaXplWCArIDggKyBsYWJlbFNpemVYICsgOCArIGJ1dHRvblNpemVYKSwgMzYpOwoKICAgIGFkZFRlc3RlckFjdGlvbkJ1dHRvbihldmVudFBsYXllciwgYWRtaW5Db250YWluZXIsIHBsYXllcklkLCB0ZXN0ZXJCYXNlWCwKICAgICAgICByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDExLCAoYnV0dG9uU2l6ZVggKyA4ICsgbGFiZWxTaXplWCArIDggKyBidXR0b25TaXplWCksIDM2LAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1JPVU5EX1NUQVJUX0lELCBVSV9URVNUX1JPVU5EX1NUQVJUX1RFWFRfSUQsIG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLnRlc3Rlci5idXR0b25zLnJvdW5kU3RhcnQpOwoKICAgIGFkZFRlc3RlckFjdGlvbkJ1dHRvbihldmVudFBsYXllciwgYWRtaW5Db250YWluZXIsIHBsYXllcklkLCB0ZXN0ZXJCYXNlWCwKICAgICAgICByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDEyLCAoYnV0dG9uU2l6ZVggKyA4ICsgbGFiZWxTaXplWCArIDggKyBidXR0b25TaXplWCksIDM2LAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1JPVU5EX0VORF9JRCwgVUlfVEVTVF9ST1VORF9FTkRfVEVYVF9JRCwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmJ1dHRvbnMucm91bmRFbmQpOwoKICAgIGFkZFRlc3RlckFjdGlvbkJ1dHRvbihldmVudFBsYXllciwgYWRtaW5Db250YWluZXIsIHBsYXllcklkLCB0ZXN0ZXJCYXNlWCwKICAgICAgICByb3cwWSArIChidXR0b25TaXplWSArIHJvd1NwYWNpbmdZKSAqIDEzLCAoYnV0dG9uU2l6ZVggKyA4ICsgbGFiZWxTaXplWCArIDggKyBidXR0b25TaXplWCksIDM2LAogICAgICAgIFVJX1RFU1RfQlVUVE9OX1BPU19ERUJVR19JRCwgVUlfVEVTVF9QT1NfREVCVUdfVEVYVF9JRCwgbW9kLnN0cmluZ2tleXMudHdsLmFkbWluUGFuZWwudGVzdGVyLmJ1dHRvbnMucG9zaXRpb25EZWJ1Zyk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBBZG1pbiBQYW5lbCBVSSAoUmlnaHQgU2lkZSkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEFkbWluIFBhbmVsIFVJIGJ1aWxkZXIgaGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gYWRkVGVzdGVyUm93KAogICAgZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsCiAgICBjb250YWluZXJCYXNlOiBtb2QuVUlXaWRnZXQsCiAgICBwbGF5ZXJJZDogbnVtYmVyLAogICAgYmFzZVg6IG51bWJlciwKICAgIGJhc2VZOiBudW1iZXIsCiAgICBkZWNCdXR0b25CYXNlSWQ6IHN0cmluZywKICAgIGluY0J1dHRvbkJhc2VJZDogc3RyaW5nLAogICAgbGFiZWxCYXNlSWQ6IHN0cmluZywKICAgIGxhYmVsS2V5OiBudW1iZXIsCiAgICBidXR0b25TaXplWDogbnVtYmVyLAogICAgYnV0dG9uU2l6ZVk6IG51bWJlciwKICAgIGxhYmVsU2l6ZVg6IG51bWJlciwKICAgIGRlY09mZnNldFg6IG51bWJlciwKICAgIGxhYmVsT2Zmc2V0WDogbnVtYmVyLAogICAgaW5jT2Zmc2V0WDogbnVtYmVyCik6IHZvaWQgewogICAgLy8gU3RlcHM6CiAgICAvLyAxKSBFbnN1cmUgcGVyLXBsYXllciBkaWFsb2cgcm9vdCBleGlzdHMKICAgIC8vIDIpIEJ1aWxkIGxlZnQgdGVhbSBwYW5lbCB3aWRnZXRzCiAgICAvLyAzKSBCdWlsZCByaWdodCB0ZWFtIHBhbmVsIHdpZGdldHMKICAgIC8vIDQpIEJ1aWxkIGFkbWluIHBhbmVsIHdpZGdldHMgKyBiaW5kIGJ1dHRvbiBJRHMKICAgIC8vIDUpIEZpbmFsaXplIHZpc2liaWxpdHkgLyBkZWZhdWx0IHN0YXRlcwoKICAgIGNvbnN0IGRlY0J1dHRvbklkID0gZGVjQnV0dG9uQmFzZUlkICsgcGxheWVySWQ7CiAgICBjb25zdCBpbmNCdXR0b25JZCA9IGluY0J1dHRvbkJhc2VJZCArIHBsYXllcklkOwoKICAgIGNvbnN0IHBsdXNUZXh0SWQgPSBVSV9URVNUX1BMVVNfVEVYVF9JRCArIGluY0J1dHRvbklkOwogICAgY29uc3QgbWludXNUZXh0SWQgPSBVSV9URVNUX01JTlVTX1RFWFRfSUQgKyBkZWNCdXR0b25JZDsKCiAgICBjb25zdCBsYWJlbElkID0gbGFiZWxCYXNlSWQgKyBwbGF5ZXJJZDsKCiAgICBtb2QuQWRkVUlCdXR0b24oZGVjQnV0dG9uSWQsIG1vZC5DcmVhdGVWZWN0b3IoYmFzZVggKyBkZWNPZmZzZXRYLCBiYXNlWSwgMCksIG1vZC5DcmVhdGVWZWN0b3IoYnV0dG9uU2l6ZVgsIGJ1dHRvblNpemVZLCAwKSwKICAgICAgICBtb2QuVUlBbmNob3IuVG9wTGVmdCwgZXZlbnRQbGF5ZXIpOwogICAgY29uc3QgREVDX0JVVFRPTiA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShkZWNCdXR0b25JZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChERUNfQlVUVE9OLCBjb250YWluZXJCYXNlKTsKCiAgICBtb2QuQWRkVUlUZXh0KG1pbnVzVGV4dElkLCBtb2QuQ3JlYXRlVmVjdG9yKGJhc2VYICsgZGVjT2Zmc2V0WCwgYmFzZVkgKyAxMSwgMCksIG1vZC5DcmVhdGVWZWN0b3IoYnV0dG9uU2l6ZVgsIGJ1dHRvblNpemVZIC0gMjIsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudWkubWludXMpLCBldmVudFBsYXllcik7CiAgICBtb2QuU2V0VUlUZXh0U2l6ZShtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUobWludXNUZXh0SWQsIG1vZC5HZXRVSVJvb3QoKSksIDEyKTsKICAgIGNvbnN0IE1JTlVTX1RFWFQgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUobWludXNUZXh0SWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKE1JTlVTX1RFWFQsIDApOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KE1JTlVTX1RFWFQsIGNvbnRhaW5lckJhc2UpOwoKICAgIG1vZC5BZGRVSVRleHQobGFiZWxJZCwgbW9kLkNyZWF0ZVZlY3RvcihiYXNlWCArIGxhYmVsT2Zmc2V0WCwgYmFzZVkgKyAxMSwgMCksIG1vZC5DcmVhdGVWZWN0b3IobGFiZWxTaXplWCwgYnV0dG9uU2l6ZVkgLSAyMiwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsIG1vZC5NZXNzYWdlKGxhYmVsS2V5KSwgZXZlbnRQbGF5ZXIpOwogICAgbW9kLlNldFVJVGV4dFNpemUobW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKGxhYmVsSWQsIG1vZC5HZXRVSVJvb3QoKSksIDEyKTsKICAgIGNvbnN0IExBQkVMID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKGxhYmVsSWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKExBQkVMLCAwKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChMQUJFTCwgY29udGFpbmVyQmFzZSk7CgogICAgbW9kLkFkZFVJQnV0dG9uKGluY0J1dHRvbklkLCBtb2QuQ3JlYXRlVmVjdG9yKGJhc2VYICsgaW5jT2Zmc2V0WCwgYmFzZVksIDApLCBtb2QuQ3JlYXRlVmVjdG9yKGJ1dHRvblNpemVYLCBidXR0b25TaXplWSwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsIGV2ZW50UGxheWVyKTsKICAgIGNvbnN0IElOQ19CVVRUT04gPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoaW5jQnV0dG9uSWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoSU5DX0JVVFRPTiwgY29udGFpbmVyQmFzZSk7CgogICAgbW9kLkFkZFVJVGV4dChwbHVzVGV4dElkLCBtb2QuQ3JlYXRlVmVjdG9yKGJhc2VYICsgaW5jT2Zmc2V0WCwgYmFzZVkgKyAxMSwgMCksIG1vZC5DcmVhdGVWZWN0b3IoYnV0dG9uU2l6ZVgsIGJ1dHRvblNpemVZIC0gMjIsIDApLAogICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wudWkucGx1cyksIGV2ZW50UGxheWVyKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShwbHVzVGV4dElkLCBtb2QuR2V0VUlSb290KCkpLCAxMik7CiAgICBjb25zdCBQTFVTX1RFWFQgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUocGx1c1RleHRJZCwgbW9kLkdldFVJUm9vdCgpKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoUExVU19URVhULCAwKTsKICAgIG1vZC5TZXRVSVdpZGdldFBhcmVudChQTFVTX1RFWFQsIGNvbnRhaW5lckJhc2UpOwp9CgpmdW5jdGlvbiBhZGRUZXN0ZXJSb3dXaXRoVmFsdWUoCiAgICBldmVudFBsYXllcjogbW9kLlBsYXllciwKICAgIGNvbnRhaW5lckJhc2U6IG1vZC5VSVdpZGdldCwKICAgIHBsYXllcklkOiBudW1iZXIsCiAgICBiYXNlWDogbnVtYmVyLAogICAgYmFzZVk6IG51bWJlciwKICAgIGRlY0J1dHRvbkJhc2VJZDogc3RyaW5nLAogICAgaW5jQnV0dG9uQmFzZUlkOiBzdHJpbmcsCiAgICBsYWJlbEJhc2VJZDogc3RyaW5nLAogICAgdmFsdWVCYXNlSWQ6IHN0cmluZywKICAgIGxhYmVsS2V5OiBudW1iZXIsCiAgICBpbml0aWFsVmFsdWU6IG51bWJlciwKICAgIGJ1dHRvblNpemVYOiBudW1iZXIsCiAgICBidXR0b25TaXplWTogbnVtYmVyLAogICAgbGFiZWxTaXplWDogbnVtYmVyLAogICAgdmFsdWVTaXplWDogbnVtYmVyLAogICAgZGVjT2Zmc2V0WDogbnVtYmVyLAogICAgbGFiZWxPZmZzZXRYOiBudW1iZXIsCiAgICBpbmNPZmZzZXRYOiBudW1iZXIKKTogdm9pZCB7CiAgICBhZGRUZXN0ZXJSb3coZXZlbnRQbGF5ZXIsIGNvbnRhaW5lckJhc2UsIHBsYXllcklkLCBiYXNlWCwgYmFzZVksCiAgICAgICAgZGVjQnV0dG9uQmFzZUlkLCBpbmNCdXR0b25CYXNlSWQsIGxhYmVsQmFzZUlkLCBsYWJlbEtleSwKICAgICAgICBidXR0b25TaXplWCwgYnV0dG9uU2l6ZVksIGxhYmVsU2l6ZVgsIGRlY09mZnNldFgsIGxhYmVsT2Zmc2V0WCwgaW5jT2Zmc2V0WCk7CgogICAgY29uc3QgdmFsdWVJZCA9IHZhbHVlQmFzZUlkICsgcGxheWVySWQ7CiAgICBjb25zdCB2YWx1ZVggPSBiYXNlWCArIGluY09mZnNldFggLSAxNiAtIHZhbHVlU2l6ZVg7CgogICAgbW9kLkFkZFVJVGV4dCh2YWx1ZUlkLCBtb2QuQ3JlYXRlVmVjdG9yKHZhbHVlWCwgYmFzZVkgKyAxMSwgMCksIG1vZC5DcmVhdGVWZWN0b3IodmFsdWVTaXplWCwgYnV0dG9uU2l6ZVkgLSAyMiwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsIE1hdGguZmxvb3IoaW5pdGlhbFZhbHVlKSksIGV2ZW50UGxheWVyKTsKICAgIG1vZC5TZXRVSVRleHRTaXplKG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZSh2YWx1ZUlkLCBtb2QuR2V0VUlSb290KCkpLCAxMik7CiAgICBjb25zdCBWQUxVRV9URVhUID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKHZhbHVlSWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRCZ0FscGhhKFZBTFVFX1RFWFQsIDApOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFZBTFVFX1RFWFQsIGNvbnRhaW5lckJhc2UpOwp9CgpmdW5jdGlvbiBzeW5jUm91bmRLaWxsc1RhcmdldFRlc3RlclZhbHVlRm9yQWxsUGxheWVycygpOiB2b2lkIHsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKTsKICAgICAgICBjb25zdCBwaWQgPSBnZXRPYmpJZChwKTsKICAgICAgICBjb25zdCB3aWRnZXQgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoVUlfVEVTVF9WQUxVRV9ST1VORF9LSUxMU19UQVJHRVRfSUQgKyBwaWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgaWYgKCF3aWRnZXQpIGNvbnRpbnVlOwogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3aWRnZXQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsIE1hdGguZmxvb3IoU3RhdGUucm91bmQua2lsbHNUYXJnZXQpKSk7CiAgICB9CiAgICB1cGRhdGVNYXRjaHVwUmVhZG91dHNGb3JBbGxQbGF5ZXJzKCk7Cn0KCmZ1bmN0aW9uIGFkZFRlc3RlclJlc2V0QnV0dG9uKAogICAgZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsCiAgICBjb250YWluZXJCYXNlOiBtb2QuVUlXaWRnZXQsCiAgICBwbGF5ZXJJZDogbnVtYmVyLAogICAgYmFzZVg6IG51bWJlciwKICAgIGJhc2VZOiBudW1iZXIsCiAgICB3aWR0aDogbnVtYmVyLAogICAgaGVpZ2h0OiBudW1iZXIKKTogdm9pZCB7CiAgICBjb25zdCBidXR0b25JZCA9IFVJX1RFU1RfQlVUVE9OX0NMT0NLX1JFU0VUX0lEICsgcGxheWVySWQ7CiAgICBjb25zdCBsYWJlbElkID0gVUlfVEVTVF9SRVNFVF9URVhUX0lEICsgcGxheWVySWQ7CgogICAgbW9kLkFkZFVJQnV0dG9uKGJ1dHRvbklkLCBtb2QuQ3JlYXRlVmVjdG9yKGJhc2VYLCBiYXNlWSwgMCksIG1vZC5DcmVhdGVWZWN0b3Iod2lkdGgsIGhlaWdodCwgMCksIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LCBldmVudFBsYXllcik7CiAgICBjb25zdCBSRVNFVF9CVVRUT04gPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoYnV0dG9uSWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoUkVTRVRfQlVUVE9OLCBjb250YWluZXJCYXNlKTsKCiAgICBtb2QuQWRkVUlUZXh0KGxhYmVsSWQsIG1vZC5DcmVhdGVWZWN0b3IoYmFzZVgsIGJhc2VZICsgMTEsIDApLCBtb2QuQ3JlYXRlVmVjdG9yKHdpZHRoLCBoZWlnaHQgLSAyMiwgMCksCiAgICAgICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5hZG1pblBhbmVsLnRlc3Rlci5idXR0b25zLmNsb2NrUmVzZXQpLCBldmVudFBsYXllcik7CiAgICBjb25zdCBSRVNFVF9MQUJFTCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShsYWJlbElkLCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJVGV4dFNpemUoUkVTRVRfTEFCRUwsIDEyKTsKICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEoUkVTRVRfTEFCRUwsIDApOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KFJFU0VUX0xBQkVMLCBjb250YWluZXJCYXNlKTsKfQoKZnVuY3Rpb24gYWRkVGVzdGVyQWN0aW9uQnV0dG9uKAogICAgZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsCiAgICBjb250YWluZXJCYXNlOiBtb2QuVUlXaWRnZXQsCiAgICBwbGF5ZXJJZDogbnVtYmVyLAogICAgYmFzZVg6IG51bWJlciwKICAgIGJhc2VZOiBudW1iZXIsCiAgICB3aWR0aDogbnVtYmVyLAogICAgaGVpZ2h0OiBudW1iZXIsCiAgICBidXR0b25CYXNlSWQ6IHN0cmluZywKICAgIGxhYmVsQmFzZUlkOiBzdHJpbmcsCiAgICBsYWJlbEtleTogbnVtYmVyCik6IHZvaWQgewogICAgY29uc3QgYnV0dG9uSWQgPSBidXR0b25CYXNlSWQgKyBwbGF5ZXJJZDsKICAgIGNvbnN0IGxhYmVsSWQgPSBsYWJlbEJhc2VJZCArIHBsYXllcklkOwoKICAgIG1vZC5BZGRVSUJ1dHRvbihidXR0b25JZCwgbW9kLkNyZWF0ZVZlY3RvcihiYXNlWCwgYmFzZVksIDApLCBtb2QuQ3JlYXRlVmVjdG9yKHdpZHRoLCBoZWlnaHQsIDApLAogICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsIGV2ZW50UGxheWVyKTsKICAgIGNvbnN0IEFDVElPTl9CVVRUT04gPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoYnV0dG9uSWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICBtb2QuU2V0VUlXaWRnZXRQYXJlbnQoQUNUSU9OX0JVVFRPTiwgY29udGFpbmVyQmFzZSk7CgogICAgbW9kLkFkZFVJVGV4dChsYWJlbElkLCBtb2QuQ3JlYXRlVmVjdG9yKGJhc2VYLCBiYXNlWSArIDExLCAwKSwgbW9kLkNyZWF0ZVZlY3Rvcih3aWR0aCwgaGVpZ2h0IC0gMjIsIDApLAogICAgbW9kLlVJQW5jaG9yLlRvcExlZnQsIG1vZC5NZXNzYWdlKGxhYmVsS2V5KSwgZXZlbnRQbGF5ZXIpOwogICAgbW9kLlNldFVJVGV4dFNpemUobW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKGxhYmVsSWQsIG1vZC5HZXRVSVJvb3QoKSksIDEyKTsKICAgIGNvbnN0IEFDVElPTl9MQUJFTCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShsYWJlbElkLCBtb2QuR2V0VUlSb290KCkpOwogICAgbW9kLlNldFVJV2lkZ2V0QmdBbHBoYShBQ1RJT05fTEFCRUwsIDApOwogICAgbW9kLlNldFVJV2lkZ2V0UGFyZW50KEFDVElPTl9MQUJFTCwgY29udGFpbmVyQmFzZSk7Cn0KCmZ1bmN0aW9uIGVuc3VyZVBvc2l0aW9uRGVidWdXaWRnZXRzKHBsYXllcjogbW9kLlBsYXllcik6IHsgeDogbW9kLlVJV2lkZ2V0OyB5OiBtb2QuVUlXaWRnZXQ7IHo6IG1vZC5VSVdpZGdldDsgcm90WTogbW9kLlVJV2lkZ2V0IH0gfCB1bmRlZmluZWQgewogICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHBsYXllcik7CiAgICBjb25zdCBjb250YWluZXJJZCA9IFVJX1BPU19ERUJVR19DT05UQUlORVJfSUQgKyBwaWQ7CiAgICBjb25zdCB4SWQgPSBVSV9QT1NfREVCVUdfWF9JRCArIHBpZDsKICAgIGNvbnN0IHlJZCA9IFVJX1BPU19ERUJVR19ZX0lEICsgcGlkOwogICAgY29uc3QgeklkID0gVUlfUE9TX0RFQlVHX1pfSUQgKyBwaWQ7CiAgICBjb25zdCByb3RZSWQgPSBVSV9QT1NfREVCVUdfUk9UWV9JRCArIHBpZDsKCiAgICBsZXQgY29udGFpbmVyID0gc2FmZUZpbmQoY29udGFpbmVySWQpOwogICAgaWYgKCFjb250YWluZXIpIHsKICAgICAgICBtb2QuQWRkVUlDb250YWluZXIoCiAgICAgICAgICAgIGNvbnRhaW5lcklkLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDEwMCwgMTcsIDApLCAvLyArWCB0byBtb3ZlIGxlZnQsICtZIHRvIG1vdmUgZG93bgogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDIwMCwgMTgsIDApLAogICAgICAgICAgICBtb2QuVUlBbmNob3IuVG9wUmlnaHQsCiAgICAgICAgICAgIG1vZC5HZXRVSVJvb3QoKSwKICAgICAgICAgICAgZmFsc2UsCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMCwgMCksCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgICAgICBtb2QuVUlEZXB0aC5BYm92ZUdhbWVVSSwKICAgICAgICAgICAgcGxheWVyCiAgICAgICAgKTsKICAgICAgICBjb250YWluZXIgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUoY29udGFpbmVySWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICB9CiAgICBpZiAoY29udGFpbmVyKSB7CiAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShjb250YWluZXIsIHRydWUpOwogICAgfQoKICAgIGNvbnN0IG1ha2VUZXh0ID0gKGlkOiBzdHJpbmcsIHBvc1g6IG51bWJlcikgPT4gewogICAgICAgIG1vZC5BZGRVSVRleHQoCiAgICAgICAgICAgIGlkLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKHBvc1gsIDAsIDApLAogICAgICAgICAgICBtb2QuQ3JlYXRlVmVjdG9yKDgwLCAxOCwgMCksCiAgICAgICAgICAgIG1vZC5VSUFuY2hvci5Ub3BMZWZ0LAogICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCAwKSwKICAgICAgICAgICAgcGxheWVyCiAgICAgICAgKTsKICAgICAgICBjb25zdCB3ID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKGlkLCBtb2QuR2V0VUlSb290KCkpOwogICAgICAgIG1vZC5TZXRVSVdpZGdldEJnQWxwaGEodywgMCk7CiAgICAgICAgbW9kLlNldFVJVGV4dFNpemUodywgMTApOwogICAgICAgIG1vZC5TZXRVSVRleHRDb2xvcih3LCBtb2QuQ3JlYXRlVmVjdG9yKDEsIDEsIDEpKTsKICAgICAgICBpZiAoY29udGFpbmVyKSBtb2QuU2V0VUlXaWRnZXRQYXJlbnQodywgY29udGFpbmVyKTsKICAgICAgICByZXR1cm4gdzsKICAgIH07CgogICAgLy8gMCwgNTAsIDkwLCAxNDAgYXJlIHNwYWNpbmcgdmFsdWVzIGZvciB0aGUgNCB0ZXh0IHdpZGdldHMKICAgIGxldCB4ID0gc2FmZUZpbmQoeElkKTsKICAgIGlmICgheCkgeCA9IG1ha2VUZXh0KHhJZCwgMCk7CiAgICBsZXQgeSA9IHNhZmVGaW5kKHlJZCk7CiAgICBpZiAoIXkpIHkgPSBtYWtlVGV4dCh5SWQsIDUwKTsKICAgIGxldCB6ID0gc2FmZUZpbmQoeklkKTsKICAgIGlmICgheikgeiA9IG1ha2VUZXh0KHpJZCwgOTApOwogICAgbGV0IHJvdFkgPSBzYWZlRmluZChyb3RZSWQpOwogICAgaWYgKCFyb3RZKSByb3RZID0gbWFrZVRleHQocm90WUlkLCAxNDApOwoKICAgIGlmICgheCB8fCAheSB8fCAheiB8fCAhcm90WSkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIHJldHVybiB7IHgsIHksIHosIHJvdFkgfTsKfQoKYXN5bmMgZnVuY3Rpb24gcG9zaXRpb25EZWJ1Z0xvb3AocGxheWVyOiBtb2QuUGxheWVyLCBleHBlY3RlZFRva2VuOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHsKICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChwbGF5ZXIpOwogICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBjb25zdCBzdGF0ZSA9IFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGlkXTsKICAgICAgICBpZiAoIXN0YXRlIHx8ICFzdGF0ZS5wb3NEZWJ1Z1Zpc2libGUgfHwgc3RhdGUucG9zRGVidWdUb2tlbiAhPT0gZXhwZWN0ZWRUb2tlbikgcmV0dXJuOwogICAgICAgIGlmICghbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgcmV0dXJuOwogICAgICAgIGlmICghaXNQbGF5ZXJEZXBsb3llZChwbGF5ZXIpKSByZXR1cm47CgogICAgICAgIGNvbnN0IHdpZGdldHMgPSBlbnN1cmVQb3NpdGlvbkRlYnVnV2lkZ2V0cyhwbGF5ZXIpOwogICAgICAgIGlmICghd2lkZ2V0cykgcmV0dXJuOwoKICAgICAgICBjb25zdCBwb3MgPSBtb2QuR2V0U29sZGllclN0YXRlKHBsYXllciwgbW9kLlNvbGRpZXJTdGF0ZVZlY3Rvci5HZXRQb3NpdGlvbik7CiAgICAgICAgY29uc3QgZmFjaW5nID0gbW9kLkdldFNvbGRpZXJTdGF0ZShwbGF5ZXIsIG1vZC5Tb2xkaWVyU3RhdGVWZWN0b3IuR2V0RmFjaW5nRGlyZWN0aW9uKTsKCiAgICAgICAgY29uc3Qgcm91bmRUbzMgPSAodmFsdWU6IG51bWJlcikgPT4gTWF0aC5yb3VuZCh2YWx1ZSAqIDEwMDApIC8gMTAwMDsKICAgICAgICBjb25zdCB5YXdSYWQgPSBNYXRoLmF0YW4yKG1vZC5YQ29tcG9uZW50T2YoZmFjaW5nKSwgbW9kLlpDb21wb25lbnRPZihmYWNpbmcpKTsKICAgICAgICBjb25zdCB5YXdEZWcgPSAoeWF3UmFkICogMTgwKSAvIE1hdGguUEk7CgogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3aWRnZXRzLngsIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsIHJvdW5kVG8zKG1vZC5YQ29tcG9uZW50T2YocG9zKSkpKTsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwod2lkZ2V0cy55LCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCByb3VuZFRvMyhtb2QuWUNvbXBvbmVudE9mKHBvcykpKSk7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHdpZGdldHMueiwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS5nZW5lcmljQ291bnRlciwgcm91bmRUbzMobW9kLlpDb21wb25lbnRPZihwb3MpKSkpOwogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3aWRnZXRzLnJvdFksIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5zeXN0ZW0uZ2VuZXJpY0NvdW50ZXIsIHJvdW5kVG8zKHlhd0RlZykpKTsKCiAgICAgICAgYXdhaXQgbW9kLldhaXQoMi4wKTsKICAgIH0KfQoKZnVuY3Rpb24gc2V0UG9zaXRpb25EZWJ1Z1Zpc2libGVGb3JQbGF5ZXIocGxheWVyOiBtb2QuUGxheWVyLCB2aXNpYmxlOiBib29sZWFuKTogdm9pZCB7CiAgICBjb25zdCBwaWQgPSBtb2QuR2V0T2JqSWQocGxheWVyKTsKICAgIGNvbnN0IHN0YXRlID0gU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwaWRdOwogICAgaWYgKCFzdGF0ZSkgcmV0dXJuOwoKICAgIGNvbnN0IHdpZGdldHMgPSBlbnN1cmVQb3NpdGlvbkRlYnVnV2lkZ2V0cyhwbGF5ZXIpOwogICAgaWYgKCF3aWRnZXRzKSByZXR1cm47CgogICAgY29uc3QgY29udGFpbmVyID0gc2FmZUZpbmQoVUlfUE9TX0RFQlVHX0NPTlRBSU5FUl9JRCArIHBpZCk7CiAgICBpZiAoY29udGFpbmVyKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKGNvbnRhaW5lciwgdmlzaWJsZSk7CgogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXRzLngsIHZpc2libGUpOwogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXRzLnksIHZpc2libGUpOwogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXRzLnosIHZpc2libGUpOwogICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh3aWRnZXRzLnJvdFksIHZpc2libGUpOwoKICAgIHN0YXRlLnBvc0RlYnVnVG9rZW4gPSAoc3RhdGUucG9zRGVidWdUb2tlbiArIDEpICUgMTAwMDAwMDAwMDsKICAgIGlmICh2aXNpYmxlKSB7CiAgICAgICAgdm9pZCBwb3NpdGlvbkRlYnVnTG9vcChwbGF5ZXIsIHN0YXRlLnBvc0RlYnVnVG9rZW4pOwogICAgfQp9CgovKiBEZWFkIENvZGU6IGNvbW1lbnRpbmcgb3V0IHRvIGJlIGNlcnRhaW4gd2UgY2FuIHJlbW92ZSBpdCwgbmV3IHBhdGggZm9yIGNvb3JkcyBpcyBlc3RhYmxpc2hlZCB0aHJvdWdoIEFkbWluIFBhbmVsIEJ1dHRvbgoKZnVuY3Rpb24gc3RhcnRBZG1pbkRlYnVnTG9vcChwbGF5ZXI6IG1vZC5QbGF5ZXIpOiB2b2lkIHsKICAgIGlmIChTdGF0ZS5hZG1pbi5kZWJ1Z0xvb3BBY3RpdmUpIHJldHVybjsKICAgIFN0YXRlLmFkbWluLmRlYnVnTG9vcEFjdGl2ZSA9IHRydWU7CiAgICBkZWJ1Z0xvb3AocGxheWVyKTsKfQoKLy8gVGhpcyB3aWxsIGNhbGwgaXRzZWxmIGV2ZXJ5IDAuNSBzZWNvbmRzLgpmdW5jdGlvbiBkZWJ1Z0xvb3AocGxheWVyOiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBtb2QuV2FpdCg1KS50aGVuKCgpID0+IHsKICAgICAgICBpZiAoIXBsYXllciB8fCAhbW9kLklzUGxheWVyVmFsaWQocGxheWVyKSkgewogICAgICAgICAgICBTdGF0ZS5hZG1pbi5kZWJ1Z0xvb3BBY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoIW1vZC5HZXRTb2xkaWVyU3RhdGUocGxheWVyLCBtb2QuU29sZGllclN0YXRlQm9vbC5Jc0FsaXZlKSkgewogICAgICAgICAgICBTdGF0ZS5hZG1pbi5kZWJ1Z0xvb3BBY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcG9zID0gbW9kLkdldFNvbGRpZXJTdGF0ZShwbGF5ZXIsIG1vZC5Tb2xkaWVyU3RhdGVWZWN0b3IuR2V0UG9zaXRpb24pOwogICAgICAgIGNvbnN0IGZhY2luZyA9IG1vZC5HZXRTb2xkaWVyU3RhdGUocGxheWVyLCBtb2QuU29sZGllclN0YXRlVmVjdG9yLkdldEZhY2luZ0RpcmVjdGlvbik7CgogICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICAgICAgbW9kLk1lc3NhZ2UoCiAgICAgICAgICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuZGVidWcuYWRtaW5Qb3MsCiAgICAgICAgICAgICAgICBNYXRoLmZsb29yKG1vZC5YQ29tcG9uZW50T2YocG9zKSksCiAgICAgICAgICAgICAgICBNYXRoLmZsb29yKG1vZC5ZQ29tcG9uZW50T2YocG9zKSksCiAgICAgICAgICAgICAgICBNYXRoLmZsb29yKG1vZC5aQ29tcG9uZW50T2YocG9zKSkKICAgICAgICAgICAgKSwKICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgcGxheWVyCiAgICAgICAgKTsKICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKAogICAgICAgICAgICAgICAgbW9kLnN0cmluZ2tleXMudHdsLmRlYnVnLmFkbWluRmFjaW5nLAogICAgICAgICAgICAgICAgTWF0aC5mbG9vcihtb2QuWENvbXBvbmVudE9mKGZhY2luZykpLAogICAgICAgICAgICAgICAgTWF0aC5mbG9vcihtb2QuWUNvbXBvbmVudE9mKGZhY2luZykpLAogICAgICAgICAgICAgICAgTWF0aC5mbG9vcihtb2QuWkNvbXBvbmVudE9mKGZhY2luZykpCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgIHBsYXllcgogICAgICAgICk7CgogICAgICAgIGRlYnVnTG9vcChwbGF5ZXIpOwogICAgfSk7Cn0KKi8KLy8jZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tIEFkbWluIFBhbmVsIFVJIGJ1aWxkZXIgaGVscGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIChSb3N0ZXIgVUkpIC0gIChsYXlvdXQgKyBwb3B1bGF0aW9uIG9ubHkpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBCdWlsZHMgdGhlIGVudGlyZSBUZWFtIFN3aXRjaCArIEFkbWluIFBhbmVsIGRpYWxvZy4KLy8gUmVzcG9uc2liaWxpdGllczoKLy8gLSBDcmVhdGVzIGxlZnQgdGVhbSwgcmlnaHQgdGVhbSwgYW5kIGFkbWluIHBhbmVsIFVJIHNlY3Rpb25zCi8vIC0gRGVmaW5lcyBsYXlvdXQgY29uc3RhbnRzIGFuZCByb3cgbWF0aCBmb3IgdGhlIGFkbWluIHBhbmVsCi8vIC0gV2lyZXMgYWxsIGFkbWluIGJ1dHRvbnMgdG8gYXV0aG9yaXRhdGl2ZSBtYXRjaCBzdGF0ZSBtdXRhdGlvbnMKLy8gLSBFbnN1cmVzIHBlci1wbGF5ZXIgVUkgcm9vdHMgYXJlIGNyZWF0ZWQgb25jZSBhbmQgcmV1c2VkCgovLyBQb3B1bGF0ZXMgdGhlIHJvc3RlciBVSSBmb3IgdGhlIGdpdmVuIHZpZXdlci4gCi8vIC0gUmVhbCBhY3RpdmUgcGxheWVyIGxpc3RzICsgdGVhbSBhc3NpZ25tZW50Ci8vIC0gRGVmYXVsdCBzdGF0dXMgdmFsdWVzIChOT1QgUkVBRFkgLyBJTiBNQUlOIEJBU0UpIGZvciBhbGwgcm93cwovLyBMYXRlciBwaGFzZXMgd2lsbCByZXBsYWNlIGRlZmF1bHRzIHdpdGggYXV0aG9yaXRhdGl2ZSBwZXItcGxheWVyIHN0YXRlICsgZ2F0aW5nICsgcm91bmQgaW50ZWdyYXRpb24uCgovLyBBcHBsaWVzIHBlci1yb3cgY29sb3IgcG9saWN5IGZvciB0aGUgUmVhZHkgZGlhbG9nOgovLyAtIFBsYXllciBuYW1lOiB3aGl0ZSBieSBkZWZhdWx0OyBncmVlbiBvbmx5IHdoZW4gQk9USCByZWFkeSBBTkQgaW4gbWFpbiBiYXNlLgovLyAtIFJFQURZIC8gSU4gTUFJTiBCQVNFOiBncmVlbgovLyAtIE5PVCBSRUFEWSAvIE5PVCBJTiBNQUlOIEJBU0U6IHJlZApmdW5jdGlvbiBhcHBseVJlYWR5RGlhbG9nUm93Q29sb3JzKG5hbWVXaWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCwgcmVhZHlXaWRnZXQ6IG1vZC5VSVdpZGdldCB8IHVuZGVmaW5lZCwgYmFzZVdpZGdldDogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkLCBpc1JlYWR5OiBib29sZWFuLCBpc0luQmFzZTogYm9vbGVhbik6IHZvaWQgewogICAgaWYgKHJlYWR5V2lkZ2V0KSBtb2QuU2V0VUlUZXh0Q29sb3IocmVhZHlXaWRnZXQsIGlzUmVhZHkgPyBDT0xPUl9SRUFEWV9HUkVFTiA6IENPTE9SX05PVF9SRUFEWV9SRUQpOwogICAgaWYgKGJhc2VXaWRnZXQpIG1vZC5TZXRVSVRleHRDb2xvcihiYXNlV2lkZ2V0LCBpc0luQmFzZSA/IENPTE9SX1JFQURZX0dSRUVOIDogQ09MT1JfTk9UX1JFQURZX1JFRCk7CiAgICBpZiAobmFtZVdpZGdldCkgbW9kLlNldFVJVGV4dENvbG9yKG5hbWVXaWRnZXQsIChpc1JlYWR5ICYmIGlzSW5CYXNlKSA/IENPTE9SX1JFQURZX0dSRUVOIDogQ09MT1JfTk9STUFMKTsKfQoKLy8gUmVuZGVycyB0aGUgZW50aXJlIFJlYWR5IFVwIGRpYWxvZyBzdGF0ZSBmb3IgYSBzaW5nbGUgdmlld2VyLgovLyBDZW50cmFsaXppbmcgVUkgdXBkYXRlcyByZWR1Y2VzIHJlZnJlc2ggcmVncmVzc2lvbnMgYXMgdGhlIGRpYWxvZyBncm93cyBpbiBjb21wbGV4aXR5LgpmdW5jdGlvbiByZW5kZXJSZWFkeURpYWxvZ0ZvclZpZXdlcihldmVudFBsYXllcjogbW9kLlBsYXllciwgdmlld2VyUGlkOiBudW1iZXIpOiB2b2lkIHsKICAgIHJlZnJlc2hSZWFkeURpYWxvZ1Jvc3RlckZvclZpZXdlcihldmVudFBsYXllciwgdmlld2VyUGlkKTsKICAgIHVwZGF0ZVJlYWR5VG9nZ2xlQnV0dG9uRm9yVmlld2VyKGV2ZW50UGxheWVyLCB2aWV3ZXJQaWQpOwoKfQoKLy8gUmVuZGVycyB0aGUgZGlhbG9nIGZvciBhbGwgcGxheWVycyB3aG8gY3VycmVudGx5IGhhdmUgaXQgb3Blbi4KLy8gQ29kZSBDbGVhbnVwOiBPdmVybGFwcyB3aXRoIHJlZnJlc2hSZWFkeURpYWxvZ0ZvckFsbFZpc2libGVWaWV3ZXJzOyBjb25zaWRlciBjb25zb2xpZGF0aW5nIHRvIG9uZSBlbnRyeXBvaW50LgovKioKICogQnJvYWRjYXN0LXN0eWxlIHJlZnJlc2ggZm9yIHRoZSByZWFkeSBkaWFsb2cuCiAqIENhbGwgd2hlbmV2ZXIgcm9zdGVyIG1lbWJlcnNoaXAgb3IgcGVyLXBsYXllciBkaXNwbGF5IHN0YXRlIGNoYW5nZXMgKHJlYWR5IC8gaW4tbWFpbi1iYXNlIC8gdGVhbSkuCiAqLwpmdW5jdGlvbiByZW5kZXJSZWFkeURpYWxvZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk6IHZvaWQgewogICAgZm9yIChjb25zdCBwaWRTdHIgaW4gU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YSkgewogICAgICAgIGNvbnN0IHBpZCA9IE51bWJlcihwaWRTdHIpOwogICAgICAgIGNvbnN0IHN0YXRlID0gU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwaWRdOwogICAgICAgIGlmICghc3RhdGUgfHwgIXN0YXRlLmRpYWxvZ1Zpc2libGUpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHZpZXdlciA9IHNhZmVGaW5kUGxheWVyKHBpZCk7CiAgICAgICAgaWYgKCF2aWV3ZXIpIGNvbnRpbnVlOwogICAgICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yVmlld2VyKHZpZXdlciwgcGlkKTsKICAgIH0KfQoKZnVuY3Rpb24gcmVmcmVzaFJlYWR5RGlhbG9nUm9zdGVyRm9yVmlld2VyKHZpZXdlcjogbW9kLlBsYXllciwgdmlld2VyUGxheWVySWQ6IG51bWJlcik6IHZvaWQgewogICAgY29uc3QgYWN0aXZlID0gZ2V0QWN0aXZlUGxheWVycygpOwogICAgY29uc3QgdDFQbGF5ZXJzOiBtb2QuUGxheWVyW10gPSBhY3RpdmUudGVhbTE7CiAgICBjb25zdCB0MlBsYXllcnM6IG1vZC5QbGF5ZXJbXSA9IGFjdGl2ZS50ZWFtMjsKCiAgICBjb25zdCBtYXhSb3dzUGVyVGVhbSA9IDE2OwogICAgY29uc3QgZW1wdHlNc2cgPSBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLmdlbmVyaWNDb3VudGVyLCAiIik7CiAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCBtYXhSb3dzUGVyVGVhbTsgcm93KyspIHsKICAgICAgICBjb25zdCB0MU5hbWVJZCA9IFVJX1JFQURZX0RJQUxPR19UMV9ST1dfTkFNRV9JRCArIHZpZXdlclBsYXllcklkICsgIl8iICsgcm93OwogICAgICAgIGNvbnN0IHQxUmVhZHlJZCA9IFVJX1JFQURZX0RJQUxPR19UMV9ST1dfUkVBRFlfSUQgKyB2aWV3ZXJQbGF5ZXJJZCArICJfIiArIHJvdzsKICAgICAgICBjb25zdCB0MUJhc2VJZCA9IFVJX1JFQURZX0RJQUxPR19UMV9ST1dfQkFTRV9JRCArIHZpZXdlclBsYXllcklkICsgIl8iICsgcm93OwoKICAgICAgICBjb25zdCB0Mk5hbWVJZCA9IFVJX1JFQURZX0RJQUxPR19UMl9ST1dfTkFNRV9JRCArIHZpZXdlclBsYXllcklkICsgIl8iICsgcm93OwogICAgICAgIGNvbnN0IHQyUmVhZHlJZCA9IFVJX1JFQURZX0RJQUxPR19UMl9ST1dfUkVBRFlfSUQgKyB2aWV3ZXJQbGF5ZXJJZCArICJfIiArIHJvdzsKICAgICAgICBjb25zdCB0MkJhc2VJZCA9IFVJX1JFQURZX0RJQUxPR19UMl9ST1dfQkFTRV9JRCArIHZpZXdlclBsYXllcklkICsgIl8iICsgcm93OwoKICAgICAgICBjb25zdCB0MU5hbWUgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodDFOYW1lSWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgY29uc3QgdDFSZWFkeSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZSh0MVJlYWR5SWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgY29uc3QgdDFCYXNlID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKHQxQmFzZUlkLCBtb2QuR2V0VUlSb290KCkpOwoKICAgICAgICBjb25zdCB0Mk5hbWUgPSBtb2QuRmluZFVJV2lkZ2V0V2l0aE5hbWUodDJOYW1lSWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgY29uc3QgdDJSZWFkeSA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZSh0MlJlYWR5SWQsIG1vZC5HZXRVSVJvb3QoKSk7CiAgICAgICAgY29uc3QgdDJCYXNlID0gbW9kLkZpbmRVSVdpZGdldFdpdGhOYW1lKHQyQmFzZUlkLCBtb2QuR2V0VUlSb290KCkpOwoKICAgICAgICBjb25zdCBwMSA9IChyb3cgPCB0MVBsYXllcnMubGVuZ3RoKSA/IHQxUGxheWVyc1tyb3ddIDogdW5kZWZpbmVkOwogICAgICAgIGNvbnN0IHAyID0gKHJvdyA8IHQyUGxheWVycy5sZW5ndGgpID8gdDJQbGF5ZXJzW3Jvd10gOiB1bmRlZmluZWQ7CgogICAgICAgIC8vIEhpZGUgdW51c2VkIHBsYWNlaG9sZGVyIHJvd3MgKHByZXZlbnRzICd1bmtub3duIHN0cmluZycgYXJ0aWZhY3RzIGFuZCByZWR1Y2VzIHZpc3VhbCBub2lzZSkuCiAgICAgICAgY29uc3QgaGFzUDEgPSAhIXAxOwogICAgICAgIGNvbnN0IGhhc1AyID0gISFwMjsKICAgICAgICBpZiAodDFOYW1lKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHQxTmFtZSwgaGFzUDEpOwogICAgICAgIGlmICh0MVJlYWR5KSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHQxUmVhZHksIGhhc1AxKTsKICAgICAgICBpZiAodDFCYXNlKSBtb2QuU2V0VUlXaWRnZXRWaXNpYmxlKHQxQmFzZSwgaGFzUDEpOwogICAgICAgIGlmICh0Mk5hbWUpIG1vZC5TZXRVSVdpZGdldFZpc2libGUodDJOYW1lLCBoYXNQMik7CiAgICAgICAgaWYgKHQyUmVhZHkpIG1vZC5TZXRVSVdpZGdldFZpc2libGUodDJSZWFkeSwgaGFzUDIpOwogICAgICAgIGlmICh0MkJhc2UpIG1vZC5TZXRVSVdpZGdldFZpc2libGUodDJCYXNlLCBoYXNQMik7CgogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCh0MU5hbWUsIHAxID8gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnBsYXllck5hbWVGb3JtYXQsIHAxKSA6IGVtcHR5TXNnKTsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwodDFSZWFkeSwgcDEgPyAoU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW21vZC5HZXRPYmpJZChwMSldID8gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnN0YXR1cy5yZWFkeSkgOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuc3RhdHVzLm5vdFJlYWR5KSkgOiBlbXB0eU1zZyk7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHQxQmFzZSwgcDEgPyAoKFN0YXRlLnBsYXllcnMuaW5NYWluQmFzZUJ5UGlkW21vZC5HZXRPYmpJZChwMSldICE9PSB1bmRlZmluZWQgPyBTdGF0ZS5wbGF5ZXJzLmluTWFpbkJhc2VCeVBpZFttb2QuR2V0T2JqSWQocDEpXSA6IHRydWUpID8gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJhc2VTdGF0dXMuaW4pIDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJhc2VTdGF0dXMub3V0KSkgOiBlbXB0eU1zZyk7CiAgICAgICAgaWYgKHAxKSB7CiAgICAgICAgICAgIGNvbnN0IHAxSWQgPSBtb2QuR2V0T2JqSWQocDEpOwogICAgICAgICAgICBjb25zdCBwMVJlYWR5ID0gISFTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcDFJZF07CiAgICAgICAgICAgIGNvbnN0IHAxSW5CYXNlID0gISFTdGF0ZS5wbGF5ZXJzLmluTWFpbkJhc2VCeVBpZFtwMUlkXTsKICAgICAgICAgICAgYXBwbHlSZWFkeURpYWxvZ1Jvd0NvbG9ycyh0MU5hbWUsIHQxUmVhZHksIHQxQmFzZSwgcDFSZWFkeSwgcDFJbkJhc2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEVtcHR5IHJvdzogZGVmYXVsdCB0byB3aGl0ZSBmb3IgYW55IHBsYWNlaG9sZGVyIHRleHQuCiAgICAgICAgICAgIGlmICh0MU5hbWUpIG1vZC5TZXRVSVRleHRDb2xvcih0MU5hbWUsIENPTE9SX05PUk1BTCk7CiAgICAgICAgICAgIGlmICh0MVJlYWR5KSBtb2QuU2V0VUlUZXh0Q29sb3IodDFSZWFkeSwgQ09MT1JfTk9STUFMKTsKICAgICAgICAgICAgaWYgKHQxQmFzZSkgbW9kLlNldFVJVGV4dENvbG9yKHQxQmFzZSwgQ09MT1JfTk9STUFMKTsKICAgICAgICB9CgogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCh0Mk5hbWUsIHAyID8gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnBsYXllck5hbWVGb3JtYXQsIHAyKSA6IGVtcHR5TXNnKTsKICAgICAgICBtb2QuU2V0VUlUZXh0TGFiZWwodDJSZWFkeSwgcDIgPyAoU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW21vZC5HZXRPYmpJZChwMildID8gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLnN0YXR1cy5yZWFkeSkgOiBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cuc3RhdHVzLm5vdFJlYWR5KSkgOiBlbXB0eU1zZyk7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHQyQmFzZSwgcDIgPyAoKFN0YXRlLnBsYXllcnMuaW5NYWluQmFzZUJ5UGlkW21vZC5HZXRPYmpJZChwMildICE9PSB1bmRlZmluZWQgPyBTdGF0ZS5wbGF5ZXJzLmluTWFpbkJhc2VCeVBpZFttb2QuR2V0T2JqSWQocDIpXSA6IHRydWUpID8gbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJhc2VTdGF0dXMuaW4pIDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJhc2VTdGF0dXMub3V0KSkgOiBlbXB0eU1zZyk7CiAgICAgICAgaWYgKHAyKSB7CiAgICAgICAgICAgIGNvbnN0IHAySWQgPSBtb2QuR2V0T2JqSWQocDIpOwogICAgICAgICAgICBjb25zdCBwMlJlYWR5ID0gISFTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcDJJZF07CiAgICAgICAgICAgIGNvbnN0IHAySW5CYXNlID0gISFTdGF0ZS5wbGF5ZXJzLmluTWFpbkJhc2VCeVBpZFtwMklkXTsKICAgICAgICAgICAgYXBwbHlSZWFkeURpYWxvZ1Jvd0NvbG9ycyh0Mk5hbWUsIHQyUmVhZHksIHQyQmFzZSwgcDJSZWFkeSwgcDJJbkJhc2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh0Mk5hbWUpIG1vZC5TZXRVSVRleHRDb2xvcih0Mk5hbWUsIENPTE9SX05PUk1BTCk7CiAgICAgICAgICAgIGlmICh0MlJlYWR5KSBtb2QuU2V0VUlUZXh0Q29sb3IodDJSZWFkeSwgQ09MT1JfTk9STUFMKTsKICAgICAgICAgICAgaWYgKHQyQmFzZSkgbW9kLlNldFVJVGV4dENvbG9yKHQyQmFzZSwgQ09MT1JfTk9STUFMKTsKICAgICAgICB9CiAgICB9Cn0KCi8vIFVwZGF0ZXMgdGhlIFJlYWR5IHRvZ2dsZSBidXR0b24gbGFiZWwgZm9yIHRoZSBnaXZlbiB2aWV3ZXIgYmFzZWQgb24gdGhhdCB2aWV3ZXIncyBjdXJyZW50IHJlYWR5IHN0YXRlLgpmdW5jdGlvbiB1cGRhdGVSZWFkeVRvZ2dsZUJ1dHRvbkZvclZpZXdlcih2aWV3ZXI6IG1vZC5QbGF5ZXIsIHZpZXdlclBsYXllcklkOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IGJ0bkxhYmVsSWQgPSBVSV9SRUFEWV9ESUFMT0dfQlVUVE9OX1JFQURZX0xBQkVMX0lEICsgdmlld2VyUGxheWVySWQ7CiAgICBjb25zdCBsYWJlbFdpZGdldCA9IG1vZC5GaW5kVUlXaWRnZXRXaXRoTmFtZShidG5MYWJlbElkLCBtb2QuR2V0VUlSb290KCkpOwogICAgaWYgKCFsYWJlbFdpZGdldCkgcmV0dXJuOwoKICAgIGNvbnN0IGlzUmVhZHkgPSAhIVN0YXRlLnBsYXllcnMucmVhZHlCeVBpZFt2aWV3ZXJQbGF5ZXJJZF07CiAgICBjb25zdCBsYWJlbE1zZyA9IGlzUmVhZHkKICAgICAgICA/IG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5idXR0b25zLm5vdFJlYWR5KQogICAgICAgIDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJ1dHRvbnMucmVhZHkpOwoKICAgIG1vZC5TZXRVSVRleHRMYWJlbChsYWJlbFdpZGdldCwgbGFiZWxNc2cpOwp9CgovLyBVcGRhdGVzIHRoZSBSZWFkeSBVcCBkaWFsb2cgIkJlc3Qgb2YgezB9IFJvdW5kcyIgbGFiZWwgZm9yIGEgc2luZ2xlIHZpZXdlci4KZnVuY3Rpb24gdXBkYXRlQmVzdE9mUm91bmRzTGFiZWxGb3JQaWQocGlkOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IGxhYmVsSWQgPSBVSV9SRUFEWV9ESUFMT0dfQkVTVE9GX0xBQkVMX0lEICsgcGlkOwogICAgY29uc3QgbGFiZWxXaWRnZXQgPSBzYWZlRmluZChsYWJlbElkKTsKICAgIGlmICghbGFiZWxXaWRnZXQpIHJldHVybjsKICAgIG1vZC5TZXRVSVRleHRMYWJlbChsYWJlbFdpZGdldCwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLnJlYWR5RGlhbG9nLmJlc3RPZkxhYmVsLCBNYXRoLmZsb29yKFN0YXRlLnJvdW5kLm1heCkpKTsKfQoKZnVuY3Rpb24gdXBkYXRlQmVzdE9mUm91bmRzTGFiZWxGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICB1cGRhdGVCZXN0T2ZSb3VuZHNMYWJlbEZvclBpZChtb2QuR2V0T2JqSWQocCkpOwogICAgfQp9CgpmdW5jdGlvbiB1cGRhdGVSZWFkeURpYWxvZ01hcExhYmVsRm9yUGlkKHBpZDogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCB2YWx1ZUlkID0gVUlfUkVBRFlfRElBTE9HX01BUF9WQUxVRV9JRCArIHBpZDsKICAgIGNvbnN0IHZhbHVlV2lkZ2V0ID0gc2FmZUZpbmQodmFsdWVJZCk7CiAgICBpZiAoIXZhbHVlV2lkZ2V0KSByZXR1cm47CiAgICBtb2QuU2V0VUlUZXh0TGFiZWwodmFsdWVXaWRnZXQsIG1vZC5NZXNzYWdlKGdldE1hcE5hbWVLZXkoQUNUSVZFX01BUF9LRVkpKSk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZVJlYWR5RGlhbG9nTWFwTGFiZWxGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICB1cGRhdGVSZWFkeURpYWxvZ01hcExhYmVsRm9yUGlkKG1vZC5HZXRPYmpJZChwKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIHVwZGF0ZVRlYW1OYW1lV2lkZ2V0c0ZvclBpZChwaWQ6IG51bWJlcik6IHZvaWQgewogICAgY29uc3QgdDFOYW1lS2V5ID0gZ2V0VGVhbU5hbWVLZXkoVGVhbUlELlRlYW0xKTsKICAgIGNvbnN0IHQyTmFtZUtleSA9IGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMik7CgogICAgY29uc3QgaHVkVDEgPSBzYWZlRmluZChgVGVhbUxlZnRfTmFtZV8ke3BpZH1gKTsKICAgIGNvbnN0IGh1ZFQyID0gc2FmZUZpbmQoYFRlYW1SaWdodF9OYW1lXyR7cGlkfWApOwogICAgaWYgKGh1ZFQxKSBtb2QuU2V0VUlUZXh0TGFiZWwoaHVkVDEsIG1vZC5NZXNzYWdlKHQxTmFtZUtleSkpOwogICAgaWYgKGh1ZFQyKSBtb2QuU2V0VUlUZXh0TGFiZWwoaHVkVDIsIG1vZC5NZXNzYWdlKHQyTmFtZUtleSkpOwoKICAgIGNvbnN0IHJlYWR5VDEgPSBzYWZlRmluZChVSV9SRUFEWV9ESUFMT0dfVEVBTTFfTEFCRUxfSUQgKyBwaWQpOwogICAgY29uc3QgcmVhZHlUMiA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19URUFNMl9MQUJFTF9JRCArIHBpZCk7CiAgICBpZiAocmVhZHlUMSkgbW9kLlNldFVJVGV4dExhYmVsKHJlYWR5VDEsIG1vZC5NZXNzYWdlKHQxTmFtZUtleSkpOwogICAgaWYgKHJlYWR5VDIpIG1vZC5TZXRVSVRleHRMYWJlbChyZWFkeVQyLCBtb2QuTWVzc2FnZSh0Mk5hbWVLZXkpKTsKfQoKZnVuY3Rpb24gdXBkYXRlVGVhbU5hbWVXaWRnZXRzRm9yQWxsUGxheWVycygpOiB2b2lkIHsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgdXBkYXRlVGVhbU5hbWVXaWRnZXRzRm9yUGlkKG1vZC5HZXRPYmpJZChwKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIHVwZGF0ZU1hdGNodXBMYWJlbEZvclBpZChwaWQ6IG51bWJlcik6IHZvaWQgewogICAgY29uc3QgbGFiZWxJZCA9IFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0xBQkVMX0lEICsgcGlkOwogICAgY29uc3QgbGFiZWxXaWRnZXQgPSBzYWZlRmluZChsYWJlbElkKTsKICAgIGlmICghbGFiZWxXaWRnZXQpIHJldHVybjsKICAgIGNvbnN0IHByZXNldCA9IE1BVENIVVBfUFJFU0VUU1tTdGF0ZS5yb3VuZC5tYXRjaHVwUHJlc2V0SW5kZXhdOwogICAgbW9kLlNldFVJVGV4dExhYmVsKAogICAgICAgIGxhYmVsV2lkZ2V0LAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy5tYXRjaHVwRm9ybWF0LCBwcmVzZXQubGVmdFBsYXllcnMsIHByZXNldC5yaWdodFBsYXllcnMpCiAgICApOwp9CgovLyBSZWZyZXNoZXMgdGhlIG1hdGNodXAgbGFiZWwgKGUuZy4sICIxIHZzIDEiKSBmb3IgZXZlcnkgYWN0aXZlIHBsYXllciBIVUQuCmZ1bmN0aW9uIHVwZGF0ZU1hdGNodXBMYWJlbEZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIHVwZGF0ZU1hdGNodXBMYWJlbEZvclBpZChtb2QuR2V0T2JqSWQocCkpOwogICAgfQp9CgovLyBVcGRhdGVzIHBlci1wbGF5ZXIgUmVhZHkgZGlhbG9nIHJlYWRvdXRzIChtaW4gcGxheWVycyArIHRhcmdldCBraWxscykgZm9yIGEgc2luZ2xlIHBpZC4KZnVuY3Rpb24gdXBkYXRlTWF0Y2h1cFJlYWRvdXRzRm9yUGlkKHBpZDogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCBtaW5QbGF5ZXJzV2lkZ2V0ID0gc2FmZUZpbmQoVUlfUkVBRFlfRElBTE9HX01BVENIVVBfTUlOUExBWUVSU19JRCArIHBpZCk7CiAgICBjb25zdCBraWxsc1RhcmdldFdpZGdldCA9IHNhZmVGaW5kKFVJX1JFQURZX0RJQUxPR19NQVRDSFVQX0tJTExTVEFSR0VUX0lEICsgcGlkKTsKICAgIGlmIChtaW5QbGF5ZXJzV2lkZ2V0KSB7CiAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKAogICAgICAgICAgICBtaW5QbGF5ZXJzV2lkZ2V0LAogICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wucmVhZHlEaWFsb2cubWluUGxheWVyc1RvU3RhcnRGb3JtYXQsIE1hdGguZmxvb3IoU3RhdGUucm91bmQuYXV0b1N0YXJ0TWluQWN0aXZlUGxheWVycykpCiAgICAgICAgKTsKICAgIH0KICAgIGlmIChraWxsc1RhcmdldFdpZGdldCkgewogICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCgKICAgICAgICAgICAga2lsbHNUYXJnZXRXaWRnZXQsCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5yZWFkeURpYWxvZy50YXJnZXRLaWxsc1RvV2luRm9ybWF0LCBNYXRoLmZsb29yKFN0YXRlLnJvdW5kLmtpbGxzVGFyZ2V0KSkKICAgICAgICApOwogICAgfQp9CgovLyBSZWZyZXNoZXMgdGhlIG1hdGNodXAgcmVhZG91dHMgZm9yIGFsbCBwbGF5ZXJzIHdpdGggYSBSZWFkeSBkaWFsb2cgSFVELgpmdW5jdGlvbiB1cGRhdGVNYXRjaHVwUmVhZG91dHNGb3JBbGxQbGF5ZXJzKCk6IHZvaWQgewogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICB1cGRhdGVNYXRjaHVwUmVhZG91dHNGb3JQaWQobW9kLkdldE9iaklkKHApKTsKICAgIH0KfQoKLy8gQXBwbGllcyB0aGUgc2VsZWN0ZWQgbWF0Y2h1cCBwcmVzZXQsIHVwZGF0ZXMgVUkvc3RhdGUsIGFuZCByZS1lbmFibGVzIHNwYXduZXJzIChub3QtbGl2ZSBvbmx5KS4KZnVuY3Rpb24gYXBwbHlNYXRjaHVwUHJlc2V0KGluZGV4OiBudW1iZXIsIGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBjb25zdCBjbGFtcGVkID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oTUFUQ0hVUF9QUkVTRVRTLmxlbmd0aCAtIDEsIE1hdGguZmxvb3IoaW5kZXgpKSk7CiAgICBpZiAoY2xhbXBlZCA9PT0gU3RhdGUucm91bmQubWF0Y2h1cFByZXNldEluZGV4KSByZXR1cm47CiAgICBpZiAoU3RhdGUudmVoaWNsZXMuc3Bhd25TZXF1ZW5jZUluUHJvZ3Jlc3MpIHJldHVybjsKICAgIGNvbnN0IG5vdyA9IE1hdGguZmxvb3IobW9kLkdldE1hdGNoVGltZUVsYXBzZWQoKSk7CiAgICBpZiAobm93IC0gU3RhdGUucm91bmQubGFzdE1hdGNodXBDaGFuZ2VBdFNlY29uZHMgPCBNQVRDSFVQX0NIQU5HRV9DT09MRE9XTl9TRUNPTkRTKSByZXR1cm47CiAgICBjb25zdCBwcmVzZXQgPSBNQVRDSFVQX1BSRVNFVFNbY2xhbXBlZF07CiAgICBTdGF0ZS5yb3VuZC5tYXRjaHVwUHJlc2V0SW5kZXggPSBjbGFtcGVkOwogICAgU3RhdGUucm91bmQubGFzdE1hdGNodXBDaGFuZ2VBdFNlY29uZHMgPSBub3c7CiAgICBTdGF0ZS5yb3VuZC5hdXRvU3RhcnRNaW5BY3RpdmVQbGF5ZXJzID0gcHJlc2V0Lm1pbkFjdGl2ZVBsYXllcnM7CiAgICBTdGF0ZS5yb3VuZC5raWxsc1RhcmdldCA9IHByZXNldC5yb3VuZEtpbGxzVGFyZ2V0OwoKICAgIHVwZGF0ZU1hdGNodXBMYWJlbEZvckFsbFBsYXllcnMoKTsKICAgIHVwZGF0ZU1hdGNodXBSZWFkb3V0c0ZvckFsbFBsYXllcnMoKTsKICAgIHNldFJvdW5kU3RhdGVUZXh0Rm9yQWxsUGxheWVycygpOwogICAgc3luY1JvdW5kS2lsbHNUYXJnZXRUZXN0ZXJWYWx1ZUZvckFsbFBsYXllcnMoKTsKCiAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgbW9kLk1lc3NhZ2UoU1RSX1JFQURZX0RJQUxPR19NQVRDSFVQX0NIQU5HRUQsIGV2ZW50UGxheWVyLCBwcmVzZXQubGVmdFBsYXllcnMsIHByZXNldC5yaWdodFBsYXllcnMpLAogICAgICAgIHRydWUKICAgICk7CgogICAgYXBwbHlTcGF3bmVyRW5hYmxlbWVudEZvck1hdGNodXAoY2xhbXBlZCwgdHJ1ZSk7CgogICAgLy8gSWYgdGhlIG5ldyBtaW5pbXVtIGlzIHNhdGlzZmllZCwgYXV0by1zdGFydCB3aGVuIGFsbCBhY3RpdmUgcGxheWVycyBhcmUgcmVhZHkuCiAgICB0cnlBdXRvU3RhcnRSb3VuZElmQWxsUmVhZHkoZXZlbnRQbGF5ZXIpOwp9CgovKiBEZWFkIGZ1bmN0aW9uIC0gY29tbWVudGluZyBvdXQgZm9yIG5vdyB0byBlbnN1cmUgd2UgY2FuIGtpbGwgaXQKLy8gUmVmcmVzaGVzIHRoZSByb3N0ZXIgVUkgZm9yIGV2ZXJ5IHBsYXllciB3aG8gY3VycmVudGx5IGhhcyB0aGUgZGlhbG9nIG9wZW4uCi8vIFBoYXNlIDMgdXNlcyB0aGlzIHRvIHJlZmxlY3QgbWFpbi1iYXNlIHN0YXRlIGNoYW5nZXMgbGl2ZSB3aXRob3V0IHJlcXVpcmluZyB1c2VycyB0byByZW9wZW4gdGhlIGRpYWxvZy4KZnVuY3Rpb24gcmVmcmVzaFJlYWR5RGlhbG9nRm9yQWxsVmlzaWJsZVZpZXdlcnMoKTogdm9pZCB7CiAgICBjb25zdCB2aWV3ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IHZpZXdlckNvdW50ID0gbW9kLkNvdW50T2Yodmlld2Vycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZpZXdlckNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCB2aWV3ZXIgPSBtb2QuVmFsdWVJbkFycmF5KHZpZXdlcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgY29uc3QgdmlkID0gbW9kLkdldE9iaklkKHZpZXdlcik7CiAgICAgICAgaWYgKFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbdmlkXSAmJiBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3ZpZF0uZGlhbG9nVmlzaWJsZSkgewogICAgICAgICAgICByZWZyZXNoUmVhZHlEaWFsb2dSb3N0ZXJGb3JWaWV3ZXIodmlld2VyLCB2aWQpOwogICAgICAgICAgICB1cGRhdGVSZWFkeVRvZ2dsZUJ1dHRvbkZvclZpZXdlcih2aWV3ZXIsIHZpZCk7CiAgICAgICAgfQogICAgfQp9CiovCgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIChSb3N0ZXIgVUkpIC0gIChsYXlvdXQgKyBwb3B1bGF0aW9uIG9ubHkpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgLSBBbGwtUmVhZHkgQXV0by1TdGFydCArIFJvdW5kIFJlc2V0IC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBSZXNldHMgYWxsIHBsYXllcnMgdG8gTk9UIFJFQURZLiBDYWxsZWQgd2hlbiBhIHJvdW5kIGVuZHMgKGluY2x1ZGluZyBtYXRjaC1lbmQgcGF0aHMpIHNvIHRoZSBuZXh0IHJvdW5kIHJlcXVpcmVzIGEgZnJlc2ggcmVhZHktdXAgY3ljbGUuCmZ1bmN0aW9uIHJlc2V0UmVhZHlTdGF0ZUZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChwKTsKICAgICAgICBTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSA9IGZhbHNlOwogICAgICAgIC8vIEtlZXAgdGhlIEhVRCAiWCAvIFkgUExBWUVSUyBSRUFEWSIgbGluZSBpbiBzeW5jIG9uIGV2ZXJ5IHJlYWR5LXN0YXRlIGNoYW5nZS4KICAgICAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgfQogICAgLy8gSWYgYW55IGRpYWxvZ3MgYXJlIG9wZW4sIHJlZmxlY3QgdGhlIHJlc2V0IGltbWVkaWF0ZWx5LgogICAgcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycygpOwogICAgdXBkYXRlUGxheWVyc1JlYWR5SHVkVGV4dEZvckFsbFBsYXllcnMoKTsKfQoKLy8gUmV0dXJucyB0cnVlIHdoZW4gZXZlcnkgYWN0aXZlIHBsYXllciBvbiBUZWFtIDEvMiBpcyBjdXJyZW50bHkgUkVBRFkuCgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBBY3RpdmUgUGxheWVyIFJlc29sdXRpb24KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gU2luZ2xlIHNvdXJjZSBvZiB0cnV0aCBmb3Igd2hvIGNvdW50cyBhcyBhbiAiYWN0aXZlIiBwbGF5ZXIgYWNyb3NzOgovLyAgIC0gcm9zdGVyIHBvcHVsYXRpb24gKFJlYWR5IFVwIFVJKQovLyAgIC0gYWxsLXJlYWR5IGNoZWNrcyAvIGF1dG8tc3RhcnQgZ2F0aW5nCi8vICAgLSBhbnkgZnV0dXJlIHJvdW5kIGdhdGluZyBsb2dpYwovLwovLyBEZWZpbml0aW9uIChsb3ctcmlzaywgY29uc2VydmF0aXZlKToKLy8gICAtIE11c3QgYmUgcHJlc2VudCBpbiBtb2QuQWxsUGxheWVycygpIChhdm9pZHMgc3RhbGUvZGlzY29ubmVjdGVkIHBpZHMpCi8vICAgLSBNdXN0IGJlIHZhbGlkIChtb2QuSXNQbGF5ZXJWYWxpZCkKLy8gICAtIE11c3QgYmUgYXNzaWduZWQgdG8gVGVhbUlELlRlYW0xIG9yIFRlYW1JRC5UZWFtMiAoc3BlY3RhdG9ycy9uZXV0cmFsIGV4Y2x1ZGVkKQovLwovLyBOb3RlOiBXZSBpbnRlbnRpb25hbGx5IGRvIE5PVCBmaWx0ZXIgYnkgImRlcGxveWVkIiBzdGF0ZSBoZXJlLiBTb21lIEFQSXMgZXhwb3NlIGRlcGxveW1lbnQgc3RhdGUsCi8vIGJ1dCB0aGlzIGNvZGViYXNlIGRvZXMgbm90IGN1cnJlbnRseSBoYXZlIGEgdHlwZWQvcG9ydGFibGUgY2hlY2suIFRyZWF0aW5nIHVuZGVwbG95ZWQgdGVhbW1hdGVzIGFzCi8vIGFjdGl2ZSBpcyBzYWZlciBmb3IgcmVhZGluZXNzIGdhdGluZyBhbmQgYXZvaWRzIGVkZ2UtY2FzZSBtaXNtYXRjaGVzIGR1cmluZyB0ZWFtIHN3aXRjaGluZy4KdHlwZSBBY3RpdmVQbGF5ZXJzX3QgPSB7CiAgICBhbGw6IG1vZC5QbGF5ZXJbXTsKICAgIHRlYW0xOiBtb2QuUGxheWVyW107CiAgICB0ZWFtMjogbW9kLlBsYXllcltdOwp9OwoKLyoqCiAqIEFjdGl2ZS1wbGF5ZXIgZGVmaW5pdGlvbiAoc2luZ2xlIHNvdXJjZSBvZiB0cnV0aCkuCiAqIFVzZWQgYnk6IHJvc3RlciBwb3B1bGF0aW9uLCBhbGwtcmVhZHkgY2hlY2tzLCByb3VuZCBzdGFydCBnYXRpbmcsIGFuZCB0aGUgSFVEIHJlYWR5LWNvdW50IGxpbmUuCiAqIE5vdGVzOiBleGNsdWRlcyB1bmRlcGxveWVkL25ldXRyYWwvc3RhbGUgcGxheWVycyBieSByZWFkaW5nIGN1cnJlbnQgZW5naW5lIHRlYW0gc3RhdGUgZWFjaCBjYWxsOyBkbyBub3QgY2FjaGUgbG9uZy10ZXJtLgogKi8KZnVuY3Rpb24gZ2V0QWN0aXZlUGxheWVycygpOiBBY3RpdmVQbGF5ZXJzX3QgewogICAgY29uc3QgYWxsOiBtb2QuUGxheWVyW10gPSBbXTsKICAgIGNvbnN0IHRlYW0xOiBtb2QuUGxheWVyW10gPSBbXTsKICAgIGNvbnN0IHRlYW0yOiBtb2QuUGxheWVyW10gPSBbXTsKCiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHRlYW1OdW0gPSBnZXRUZWFtTnVtYmVyKG1vZC5HZXRUZWFtKHApKTsKICAgICAgICBpZiAodGVhbU51bSAhPT0gVGVhbUlELlRlYW0xICYmIHRlYW1OdW0gIT09IFRlYW1JRC5UZWFtMikgY29udGludWU7CgogICAgICAgIGFsbC5wdXNoKHApOwogICAgICAgIGlmICh0ZWFtTnVtID09PSBUZWFtSUQuVGVhbTEpIHRlYW0xLnB1c2gocCk7CiAgICAgICAgZWxzZSB0ZWFtMi5wdXNoKHApOwogICAgfQoKICAgIC8vIFN0YWJsZSBVSSBvcmRlcmluZzogc29ydCBieSBwaWQgKG9iamVjdCBpZCkuCiAgICAvLyBUaGlzIHByZXZlbnRzIHJvd3MgZnJvbSBzaHVmZmxpbmcgYWNyb3NzIHJlZnJlc2hlcy4KICAgIGNvbnN0IGJ5UGlkID0gKGE6IG1vZC5QbGF5ZXIsIGI6IG1vZC5QbGF5ZXIpID0+IG1vZC5HZXRPYmpJZChhKSAtIG1vZC5HZXRPYmpJZChiKTsKICAgIGFsbC5zb3J0KGJ5UGlkKTsKICAgIHRlYW0xLnNvcnQoYnlQaWQpOwogICAgdGVhbTIuc29ydChieVBpZCk7CgogICAgcmV0dXJuIHsgYWxsLCB0ZWFtMSwgdGVhbTIgfTsKfQoKZnVuY3Rpb24gYXJlQWxsQWN0aXZlUGxheWVyc1JlYWR5KCk6IGJvb2xlYW4gewogICAgY29uc3QgYWN0aXZlID0gZ2V0QWN0aXZlUGxheWVycygpOwogICAgY29uc3QgYWN0aXZlQ291bnQgPSBhY3RpdmUuYWxsLmxlbmd0aDsKICAgIGlmIChhY3RpdmVDb3VudCA8IFN0YXRlLnJvdW5kLmF1dG9TdGFydE1pbkFjdGl2ZVBsYXllcnMpIHsKICAgICAgICBpZiAoYWN0aXZlQ291bnQgIT09IDApIHJldHVybiBmYWxzZTsKCiAgICAgICAgLy8gRmFsbGJhY2s6IGlmIG5vIFRlYW0gMS8yIHBsYXllcnMgYXJlIGFzc2lnbmVkIHlldCAodGVhbSAwIHByZS1kZXBsb3kpLAogICAgICAgIC8vIGFsbG93IHRoZSByZWFkeSBjaGVjayB0byB1c2UgYWxsIHZhbGlkIHBsYXllcnMuCiAgICAgICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICAgICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgICAgICBsZXQgdmFsaWRDb3VudCA9IDA7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgICAgIGlmICghcCB8fCAhbW9kLklzUGxheWVyVmFsaWQocCkpIGNvbnRpbnVlOwogICAgICAgICAgICBjb25zdCBwaWQgPSBtb2QuR2V0T2JqSWQocCk7CiAgICAgICAgICAgIGlmICghU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW3BpZF0pIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgdmFsaWRDb3VudCsrOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdmFsaWRDb3VudCA+PSBTdGF0ZS5yb3VuZC5hdXRvU3RhcnRNaW5BY3RpdmVQbGF5ZXJzOwogICAgfQoKICAgIGZvciAoY29uc3QgcCBvZiBhY3RpdmUuYWxsKSB7CiAgICAgICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHApOwogICAgICAgIGlmICghU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW3BpZF0pIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0cnVlOwp9CgovLyBJbXBsZW1lbnRzIGEgc3luY2hyb25pemVkIHByZS1yb3VuZCAxMC0xLUdPISBjb3VudGRvd24gdGhhdCBzdGFydHMgdGhlIHJvdW5kIG9uIEdPLgppbnRlcmZhY2UgQ291bnRkb3duV2lkZ2V0Q2FjaGVFbnRyeSB7CiAgICByb290TmFtZTogc3RyaW5nOwogICAgd2lkZ2V0PzogbW9kLlVJV2lkZ2V0Owp9CgpmdW5jdGlvbiBlbnN1cmVDb3VudGRvd25VSUFuZEdldFdpZGdldChwbGF5ZXI6IG1vZC5QbGF5ZXIpOiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQgewogICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHBsYXllcik7CiAgICBjb25zdCByb290TmFtZSA9ICJQcmVnYW1lQ291bnRkb3duVGV4dF8iICsgcGlkOwoKICAgIGNvbnN0IGNhY2hlZCA9IFN0YXRlLmh1ZENhY2hlLmNvdW50ZG93bldpZGdldENhY2hlW3BpZF07CiAgICBpZiAoY2FjaGVkKSB7CiAgICAgICAgaWYgKGNhY2hlZC53aWRnZXQpIHJldHVybiBjYWNoZWQud2lkZ2V0OwoKICAgICAgICBjb25zdCBmb3VuZCA9IHNhZmVGaW5kKGNhY2hlZC5yb290TmFtZSk7CiAgICAgICAgaWYgKGZvdW5kKSB7CiAgICAgICAgICAgIGNhY2hlZC53aWRnZXQgPSBmb3VuZDsKICAgICAgICAgICAgcmV0dXJuIGZvdW5kOwogICAgICAgIH0KICAgIH0KCiAgICBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgbmFtZTogcm9vdE5hbWUsCiAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgIHBsYXllcklkOiBwbGF5ZXIsCiAgICAgICAgcG9zaXRpb246IFswLCAwXSwKICAgICAgICBzaXplOiBbMzIwLCAxNDBdLAogICAgICAgIGFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICBwYWRkaW5nOiAwLAogICAgICAgIGJnQ29sb3I6IFswLCAwLCAwXSwKICAgICAgICBiZ0FscGhhOiAwLAogICAgICAgIGJnRmlsbDogbW9kLlVJQmdGaWxsLlNvbGlkLAogICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLmNvdW50ZG93bi5mb3JtYXQsIFBSRUdBTUVfQ09VTlRET1dOX1NUQVJUX05VTUJFUiksCiAgICAgICAgdGV4dENvbG9yOiBbMSwgMSwgMV0sCiAgICAgICAgdGV4dEFscGhhOiBQUkVHQU1FX0FMRVJUX1RFWFRfQUxQSEEsCiAgICAgICAgdGV4dFNpemU6IFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfRElHSVRfU1RBUlQsCiAgICAgICAgdGV4dEFuY2hvcjogbW9kLlVJQW5jaG9yLkNlbnRlciwKICAgIH0pOwoKICAgIGNvbnN0IHdpZGdldCA9IHNhZmVGaW5kKHJvb3ROYW1lKTsKICAgIFN0YXRlLmh1ZENhY2hlLmNvdW50ZG93bldpZGdldENhY2hlW3BpZF0gPSB7IHJvb3ROYW1lLCB3aWRnZXQgfTsKICAgIHJldHVybiB3aWRnZXQ7Cn0KCmZ1bmN0aW9uIHNldFByZWdhbWVDb3VudGRvd25WaXN1YWxGb3JBbGxQbGF5ZXJzKAogICAgbGFiZWxLZXk6IG51bWJlciwKICAgIGxhYmVsVmFsdWU6IG51bWJlciB8IHVuZGVmaW5lZCwKICAgIGNvbG9yOiBtb2QuVmVjdG9yLAogICAgc2l6ZTogbnVtYmVyLAogICAgdmlzaWJsZTogYm9vbGVhbgopOiB2b2lkIHsKICAgIGNvbnN0IHBsYXllcnMgPSBtb2QuQWxsUGxheWVycygpOwogICAgY29uc3QgY291bnQgPSBtb2QuQ291bnRPZihwbGF5ZXJzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IHAgPSBtb2QuVmFsdWVJbkFycmF5KHBsYXllcnMsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgY29uc3QgdyA9IGVuc3VyZUNvdW50ZG93blVJQW5kR2V0V2lkZ2V0KHApOwogICAgICAgIGlmICghdykgY29udGludWU7CgogICAgICAgIG1vZC5TZXRVSVdpZGdldFZpc2libGUodywgdmlzaWJsZSk7CiAgICAgICAgaWYgKHZpc2libGUpIHsKICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IChsYWJlbFZhbHVlICE9PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICA/IG1vZC5NZXNzYWdlKGxhYmVsS2V5LCBsYWJlbFZhbHVlKQogICAgICAgICAgICAgICAgOiBtb2QuTWVzc2FnZShsYWJlbEtleSk7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbCh3LCBtZXNzYWdlKTsKICAgICAgICAgICAgbW9kLlNldFVJVGV4dENvbG9yKHcsIGNvbG9yKTsKICAgICAgICAgICAgbW9kLlNldFVJVGV4dFNpemUodywgc2l6ZSk7CiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBzZXRQcmVnYW1lQ291bnRkb3duU2l6ZUZvckFsbFBsYXllcnMoc2l6ZTogbnVtYmVyKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGNvbnN0IHcgPSBlbnN1cmVDb3VudGRvd25VSUFuZEdldFdpZGdldChwKTsKICAgICAgICBpZiAoIXcpIGNvbnRpbnVlOwogICAgICAgIG1vZC5TZXRVSVRleHRTaXplKHcsIHNpemUpOwogICAgfQp9CgpmdW5jdGlvbiBoaWRlUHJlZ2FtZUNvdW50ZG93bkZvckFsbFBsYXllcnMoKTogdm9pZCB7CiAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgIGNvbnN0IGNvdW50ID0gbW9kLkNvdW50T2YocGxheWVycyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgIGNvbnN0IHcgPSBlbnN1cmVDb3VudGRvd25VSUFuZEdldFdpZGdldChwKTsKICAgICAgICBpZiAoIXcpIGNvbnRpbnVlOwogICAgICAgIG1vZC5TZXRVSVdpZGdldFZpc2libGUodywgZmFsc2UpOwogICAgfQp9CgpmdW5jdGlvbiBlbnN1cmVPdmVyTGluZVRpdGxlVUlBbmRHZXRXaWRnZXQocGxheWVyOiBtb2QuUGxheWVyKTogbW9kLlVJV2lkZ2V0IHwgdW5kZWZpbmVkIHsKICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChwbGF5ZXIpOwogICAgY29uc3Qgcm9vdE5hbWUgPSBPVkVSX0xJTkVfVElUTEVfSUQgKyBwaWQ7CgogICAgY29uc3QgY2FjaGVkID0gU3RhdGUuaHVkQ2FjaGUub3ZlckxpbmVUaXRsZVdpZGdldENhY2hlW3BpZF07CiAgICBpZiAoY2FjaGVkKSB7CiAgICAgICAgaWYgKGNhY2hlZC53aWRnZXQpIHJldHVybiBjYWNoZWQud2lkZ2V0OwoKICAgICAgICBjb25zdCBmb3VuZCA9IHNhZmVGaW5kKGNhY2hlZC5yb290TmFtZSk7CiAgICAgICAgaWYgKGZvdW5kKSB7CiAgICAgICAgICAgIGNhY2hlZC53aWRnZXQgPSBmb3VuZDsKICAgICAgICAgICAgcmV0dXJuIGZvdW5kOwogICAgICAgIH0KICAgIH0KCiAgICBtb2RsaWIuUGFyc2VVSSh7CiAgICAgICAgbmFtZTogcm9vdE5hbWUsCiAgICAgICAgdHlwZTogIlRleHQiLAogICAgICAgIHBsYXllcklkOiBwbGF5ZXIsCiAgICAgICAgcG9zaXRpb246IFswLCAwXSwKICAgICAgICBzaXplOiBbMjUwMCwgMjAwXSwKICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgcGFkZGluZzogMCwKICAgICAgICBiZ0NvbG9yOiBbMCwgMCwgMF0sCiAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm92ZXJMaW5lLnRpdGxlLCBwbGF5ZXIpLAogICAgICAgIHRleHRDb2xvcjogWzEsIDAsIDBdLAogICAgICAgIHRleHRBbHBoYTogUFJFR0FNRV9BTEVSVF9URVhUX0FMUEhBLAogICAgICAgIHRleHRTaXplOiBPVkVSX0xJTkVfVElUTEVfU0laRSwKICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgfSk7CgogICAgY29uc3Qgd2lkZ2V0ID0gc2FmZUZpbmQocm9vdE5hbWUpOwogICAgU3RhdGUuaHVkQ2FjaGUub3ZlckxpbmVUaXRsZVdpZGdldENhY2hlW3BpZF0gPSB7IHJvb3ROYW1lLCB3aWRnZXQgfTsKICAgIHJldHVybiB3aWRnZXQ7Cn0KCmZ1bmN0aW9uIGVuc3VyZU92ZXJMaW5lU3VidGl0bGVVSUFuZEdldFdpZGdldChwbGF5ZXI6IG1vZC5QbGF5ZXIpOiBtb2QuVUlXaWRnZXQgfCB1bmRlZmluZWQgewogICAgY29uc3QgcGlkID0gbW9kLkdldE9iaklkKHBsYXllcik7CiAgICBjb25zdCByb290TmFtZSA9IE9WRVJfTElORV9TVUJUSVRMRV9JRCArIHBpZDsKCiAgICBjb25zdCBjYWNoZWQgPSBTdGF0ZS5odWRDYWNoZS5vdmVyTGluZVN1YnRpdGxlV2lkZ2V0Q2FjaGVbcGlkXTsKICAgIGlmIChjYWNoZWQpIHsKICAgICAgICBpZiAoY2FjaGVkLndpZGdldCkgcmV0dXJuIGNhY2hlZC53aWRnZXQ7CgogICAgICAgIGNvbnN0IGZvdW5kID0gc2FmZUZpbmQoY2FjaGVkLnJvb3ROYW1lKTsKICAgICAgICBpZiAoZm91bmQpIHsKICAgICAgICAgICAgY2FjaGVkLndpZGdldCA9IGZvdW5kOwogICAgICAgICAgICByZXR1cm4gZm91bmQ7CiAgICAgICAgfQogICAgfQoKICAgIG1vZGxpYi5QYXJzZVVJKHsKICAgICAgICBuYW1lOiByb290TmFtZSwKICAgICAgICB0eXBlOiAiVGV4dCIsCiAgICAgICAgcGxheWVySWQ6IHBsYXllciwKICAgICAgICBwb3NpdGlvbjogWzAsIE9WRVJfTElORV9TVUJUSVRMRV9PRkZTRVRfWV0sCiAgICAgICAgc2l6ZTogWzI1MDAsIDgwXSwKICAgICAgICBhbmNob3I6IG1vZC5VSUFuY2hvci5DZW50ZXIsCiAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgcGFkZGluZzogMCwKICAgICAgICBiZ0NvbG9yOiBbMCwgMCwgMF0sCiAgICAgICAgYmdBbHBoYTogMCwKICAgICAgICBiZ0ZpbGw6IG1vZC5VSUJnRmlsbC5Ob25lLAogICAgICAgIHRleHRMYWJlbDogbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm92ZXJMaW5lLnN1YnRpdGxlLCBwbGF5ZXIpLAogICAgICAgIHRleHRDb2xvcjogWzEsIDEsIDBdLAogICAgICAgIHRleHRBbHBoYTogUFJFR0FNRV9BTEVSVF9URVhUX0FMUEhBLAogICAgICAgIHRleHRTaXplOiBPVkVSX0xJTkVfU1VCVElUTEVfU0laRSwKICAgICAgICB0ZXh0QW5jaG9yOiBtb2QuVUlBbmNob3IuQ2VudGVyLAogICAgfSk7CgogICAgY29uc3Qgd2lkZ2V0ID0gc2FmZUZpbmQocm9vdE5hbWUpOwogICAgU3RhdGUuaHVkQ2FjaGUub3ZlckxpbmVTdWJ0aXRsZVdpZGdldENhY2hlW3BpZF0gPSB7IHJvb3ROYW1lLCB3aWRnZXQgfTsKICAgIHJldHVybiB3aWRnZXQ7Cn0KCmZ1bmN0aW9uIGNhbmNlbFByZWdhbWVDb3VudGRvd24oKTogdm9pZCB7CiAgICBpZiAoIVN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc0FjdGl2ZSkgcmV0dXJuOwogICAgU3RhdGUucm91bmQuY291bnRkb3duLnRva2VuKys7CiAgICBTdGF0ZS5yb3VuZC5jb3VudGRvd24uaXNBY3RpdmUgPSBmYWxzZTsKICAgIGhpZGVQcmVnYW1lQ291bnRkb3duRm9yQWxsUGxheWVycygpOwp9CgpmdW5jdGlvbiBkZWxldGVPdmVyTGluZU1lc3NhZ2VGb3JQbGF5ZXIocGlkOiBudW1iZXIpOiB2b2lkIHsKICAgIGNvbnN0IHRpdGxlID0gc2FmZUZpbmQoT1ZFUl9MSU5FX1RJVExFX0lEICsgcGlkKTsKICAgIGlmICh0aXRsZSkgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZSh0aXRsZSwgZmFsc2UpOwoKICAgIGNvbnN0IHN1YnRpdGxlID0gc2FmZUZpbmQoT1ZFUl9MSU5FX1NVQlRJVExFX0lEICsgcGlkKTsKICAgIGlmIChzdWJ0aXRsZSkgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShzdWJ0aXRsZSwgZmFsc2UpOwp9Cgphc3luYyBmdW5jdGlvbiBzaG93T3ZlckxpbmVNZXNzYWdlRm9yQWxsUGxheWVycyhvZmZlbmRlcjogbW9kLlBsYXllcik6IFByb21pc2U8dm9pZD4gewogICAgU3RhdGUucm91bmQuY291bnRkb3duLm92ZXJMaW5lTWVzc2FnZVRva2VuID0gKFN0YXRlLnJvdW5kLmNvdW50ZG93bi5vdmVyTGluZU1lc3NhZ2VUb2tlbiArIDEpICUgMTAwMDAwMDAwMDsKICAgIGNvbnN0IGV4cGVjdGVkVG9rZW4gPSBTdGF0ZS5yb3VuZC5jb3VudGRvd24ub3ZlckxpbmVNZXNzYWdlVG9rZW47CgogICAgY29uc3QgcGxheWVycyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgcCA9IG1vZC5WYWx1ZUluQXJyYXkocGxheWVycywgaSkgYXMgbW9kLlBsYXllcjsKICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICBjb25zdCBwaWQgPSBtb2QuR2V0T2JqSWQocCk7CgogICAgICAgIGRlbGV0ZU92ZXJMaW5lTWVzc2FnZUZvclBsYXllcihwaWQpOwoKICAgICAgICBjb25zdCB0aXRsZSA9IGVuc3VyZU92ZXJMaW5lVGl0bGVVSUFuZEdldFdpZGdldChwKTsKICAgICAgICBpZiAodGl0bGUpIHsKICAgICAgICAgICAgbW9kLlNldFVJVGV4dExhYmVsKHRpdGxlLCBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wub3ZlckxpbmUudGl0bGUsIG9mZmVuZGVyKSk7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRDb2xvcih0aXRsZSwgQ09MT1JfTk9UX1JFQURZX1JFRCk7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRTaXplKHRpdGxlLCBPVkVSX0xJTkVfVElUTEVfU0laRSk7CiAgICAgICAgICAgIG1vZC5TZXRVSVdpZGdldFZpc2libGUodGl0bGUsIHRydWUpOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgc3VidGl0bGUgPSBlbnN1cmVPdmVyTGluZVN1YnRpdGxlVUlBbmRHZXRXaWRnZXQocCk7CiAgICAgICAgaWYgKHN1YnRpdGxlKSB7CiAgICAgICAgICAgIG1vZC5TZXRVSVRleHRMYWJlbChzdWJ0aXRsZSwgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm92ZXJMaW5lLnN1YnRpdGxlLCBvZmZlbmRlcikpOwogICAgICAgICAgICBtb2QuU2V0VUlUZXh0Q29sb3Ioc3VidGl0bGUsIENPTE9SX1dBUk5JTkdfWUVMTE9XKTsKICAgICAgICAgICAgbW9kLlNldFVJVGV4dFNpemUoc3VidGl0bGUsIE9WRVJfTElORV9TVUJUSVRMRV9TSVpFKTsKICAgICAgICAgICAgbW9kLlNldFVJV2lkZ2V0VmlzaWJsZShzdWJ0aXRsZSwgdHJ1ZSk7CiAgICAgICAgfQogICAgfQoKICAgIGF3YWl0IG1vZC5XYWl0KE9WRVJfTElORV9NRVNTQUdFX0RVUkFUSU9OX1NFQ09ORFMpOwogICAgaWYgKGV4cGVjdGVkVG9rZW4gIT09IFN0YXRlLnJvdW5kLmNvdW50ZG93bi5vdmVyTGluZU1lc3NhZ2VUb2tlbikgcmV0dXJuOwoKICAgIGNvbnN0IHJlbWFpbmluZyA9IG1vZC5BbGxQbGF5ZXJzKCk7CiAgICBjb25zdCByZW1haW5pbmdDb3VudCA9IG1vZC5Db3VudE9mKHJlbWFpbmluZyk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlbWFpbmluZ0NvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShyZW1haW5pbmcsIGkpIGFzIG1vZC5QbGF5ZXI7CiAgICAgICAgaWYgKCFwIHx8ICFtb2QuSXNQbGF5ZXJWYWxpZChwKSkgY29udGludWU7CiAgICAgICAgZGVsZXRlT3ZlckxpbmVNZXNzYWdlRm9yUGxheWVyKG1vZC5HZXRPYmpJZChwKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIHN0YXJ0UHJlZ2FtZUNvdW50ZG93bih0cmlnZ2VyUGxheWVyPzogbW9kLlBsYXllciwgZm9yY2U/OiBib29sZWFuKTogdm9pZCB7CiAgICBpZiAoU3RhdGUucm91bmQuY291bnRkb3duLmlzQWN0aXZlKSByZXR1cm47CiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCB8fCBpc1JvdW5kTGl2ZSgpKSByZXR1cm47CiAgICBpZiAoIWZvcmNlICYmICFhcmVBbGxBY3RpdmVQbGF5ZXJzUmVhZHkoKSkgcmV0dXJuOwoKICAgIGNsb3NlUmVhZHlEaWFsb2dGb3JBbGxQbGF5ZXJzKCk7CiAgICBTdGF0ZS5yb3VuZC5jb3VudGRvd24uaXNBY3RpdmUgPSB0cnVlOwogICAgU3RhdGUucm91bmQuY291bnRkb3duLmlzUmVxdWVzdGVkID0gdHJ1ZTsKICAgIFN0YXRlLnJvdW5kLmNvdW50ZG93bi50b2tlbisrOwogICAgY29uc3QgZXhwZWN0ZWRUb2tlbiA9IFN0YXRlLnJvdW5kLmNvdW50ZG93bi50b2tlbjsKCiAgICB2b2lkIHJ1blByZWdhbWVDb3VudGRvd24oZXhwZWN0ZWRUb2tlbiwgdHJpZ2dlclBsYXllciwgZm9yY2UgPT09IHRydWUpOwp9CgpmdW5jdGlvbiBpc1ByZWdhbWVDb3VudGRvd25TdGlsbFZhbGlkKGV4cGVjdGVkVG9rZW46IG51bWJlciwgZm9yY2U/OiBib29sZWFuLCBhbGxvd1JvdW5kQWN0aXZlPzogYm9vbGVhbik6IGJvb2xlYW4gewogICAgaWYgKGV4cGVjdGVkVG9rZW4gIT09IFN0YXRlLnJvdW5kLmNvdW50ZG93bi50b2tlbikgcmV0dXJuIGZhbHNlOwogICAgaWYgKFN0YXRlLm1hdGNoLmlzRW5kZWQpIHJldHVybiBmYWxzZTsKICAgIGlmICghYWxsb3dSb3VuZEFjdGl2ZSAmJiBpc1JvdW5kTGl2ZSgpKSByZXR1cm4gZmFsc2U7CiAgICBpZiAoIWZvcmNlICYmICFhcmVBbGxBY3RpdmVQbGF5ZXJzUmVhZHkoKSkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIGdldFByZWdhbWVDb3VudGRvd25Db2xvcih2YWx1ZTogbnVtYmVyKTogbW9kLlZlY3RvciB7CiAgICByZXR1cm4gdmFsdWUgPT09IDEgPyBtb2QuQ3JlYXRlVmVjdG9yKDEsIDEsIDApIDogbW9kLkNyZWF0ZVZlY3RvcigxLCAwLCAwKTsKfQoKYXN5bmMgZnVuY3Rpb24gYW5pbWF0ZVByZWdhbWVDb3VudGRvd25TaXplKAogICAgZXhwZWN0ZWRUb2tlbjogbnVtYmVyLAogICAgZm9yY2U6IGJvb2xlYW4sCiAgICBzdGFydFNpemU6IG51bWJlciwKICAgIGVuZFNpemU6IG51bWJlciwKICAgIGFsbG93Um91bmRBY3RpdmU/OiBib29sZWFuCik6IFByb21pc2U8Ym9vbGVhbj4gewogICAgY29uc3Qgc3RlcFNlY29uZHMgPSBQUkVHQU1FX0NPVU5URE9XTl9TVEVQX1NFQ09ORFMgLyBQUkVHQU1FX0NPVU5URE9XTl9BTklNQVRJT05fU1RFUFM7CiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBQUkVHQU1FX0NPVU5URE9XTl9BTklNQVRJT05fU1RFUFM7IGkrKykgewogICAgICAgIGF3YWl0IG1vZC5XYWl0KHN0ZXBTZWNvbmRzKTsKICAgICAgICBpZiAoIWlzUHJlZ2FtZUNvdW50ZG93blN0aWxsVmFsaWQoZXhwZWN0ZWRUb2tlbiwgZm9yY2UsIGFsbG93Um91bmRBY3RpdmUpKSByZXR1cm4gZmFsc2U7CiAgICAgICAgY29uc3QgdCA9IGkgLyBQUkVHQU1FX0NPVU5URE9XTl9BTklNQVRJT05fU1RFUFM7CiAgICAgICAgY29uc3Qgc2l6ZSA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3Ioc3RhcnRTaXplICsgKGVuZFNpemUgLSBzdGFydFNpemUpICogdCkpOwogICAgICAgIHNldFByZWdhbWVDb3VudGRvd25TaXplRm9yQWxsUGxheWVycyhzaXplKTsKICAgIH0KICAgIHJldHVybiB0cnVlOwp9Cgphc3luYyBmdW5jdGlvbiBydW5QcmVnYW1lQ291bnRkb3duKGV4cGVjdGVkVG9rZW46IG51bWJlciwgdHJpZ2dlclBsYXllcj86IG1vZC5QbGF5ZXIsIGZvcmNlPzogYm9vbGVhbik6IFByb21pc2U8dm9pZD4gewogICAgYXdhaXQgbW9kLldhaXQoUFJFR0FNRV9DT1VOVERPV05fSU5JVElBTF9ERUxBWV9TRUNPTkRTKTsKCiAgICBpZiAoIWlzUHJlZ2FtZUNvdW50ZG93blN0aWxsVmFsaWQoZXhwZWN0ZWRUb2tlbiwgZm9yY2UpKSB7CiAgICAgICAgU3RhdGUucm91bmQuY291bnRkb3duLmlzQWN0aXZlID0gZmFsc2U7CiAgICAgICAgaGlkZVByZWdhbWVDb3VudGRvd25Gb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGZvciAobGV0IHZhbHVlID0gUFJFR0FNRV9DT1VOVERPV05fU1RBUlRfTlVNQkVSOyB2YWx1ZSA+PSAxOyB2YWx1ZS0tKSB7CiAgICAgICAgaWYgKCFpc1ByZWdhbWVDb3VudGRvd25TdGlsbFZhbGlkKGV4cGVjdGVkVG9rZW4sIGZvcmNlKSkgewogICAgICAgICAgICBTdGF0ZS5yb3VuZC5jb3VudGRvd24uaXNBY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgaGlkZVByZWdhbWVDb3VudGRvd25Gb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHNldFByZWdhbWVDb3VudGRvd25WaXN1YWxGb3JBbGxQbGF5ZXJzKAogICAgICAgICAgICBtb2Quc3RyaW5na2V5cy50d2wuY291bnRkb3duLmZvcm1hdCwKICAgICAgICAgICAgdmFsdWUsCiAgICAgICAgICAgIGdldFByZWdhbWVDb3VudGRvd25Db2xvcih2YWx1ZSksCiAgICAgICAgICAgIFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfRElHSVRfU1RBUlQsCiAgICAgICAgICAgIHRydWUKICAgICAgICApOwoKICAgICAgICBjb25zdCBvayA9IGF3YWl0IGFuaW1hdGVQcmVnYW1lQ291bnRkb3duU2l6ZSgKICAgICAgICAgICAgZXhwZWN0ZWRUb2tlbiwKICAgICAgICAgICAgZm9yY2UgPT09IHRydWUsCiAgICAgICAgICAgIFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfRElHSVRfU1RBUlQsCiAgICAgICAgICAgIFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfRElHSVRfRU5ECiAgICAgICAgKTsKICAgICAgICBpZiAoIW9rKSB7CiAgICAgICAgICAgIFN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc0FjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgICBoaWRlUHJlZ2FtZUNvdW50ZG93bkZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoIWlzUHJlZ2FtZUNvdW50ZG93blN0aWxsVmFsaWQoZXhwZWN0ZWRUb2tlbiwgZm9yY2UpKSB7CiAgICAgICAgU3RhdGUucm91bmQuY291bnRkb3duLmlzQWN0aXZlID0gZmFsc2U7CiAgICAgICAgaGlkZVByZWdhbWVDb3VudGRvd25Gb3JBbGxQbGF5ZXJzKCk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIHNldFByZWdhbWVDb3VudGRvd25WaXN1YWxGb3JBbGxQbGF5ZXJzKAogICAgICAgIG1vZC5zdHJpbmdrZXlzLnR3bC5jb3VudGRvd24uZ28sCiAgICAgICAgdW5kZWZpbmVkLAogICAgICAgIG1vZC5DcmVhdGVWZWN0b3IoMCwgMSwgMCksCiAgICAgICAgUFJFR0FNRV9DT1VOVERPV05fU0laRV9HT19TVEFSVCwKICAgICAgICB0cnVlCiAgICApOwogICAgc3RhcnRSb3VuZCh0cmlnZ2VyUGxheWVyKTsKCiAgICBjb25zdCBvayA9IGF3YWl0IGFuaW1hdGVQcmVnYW1lQ291bnRkb3duU2l6ZSgKICAgICAgICBleHBlY3RlZFRva2VuLAogICAgICAgIGZvcmNlID09PSB0cnVlLAogICAgICAgIFBSRUdBTUVfQ09VTlRET1dOX1NJWkVfR09fU1RBUlQsCiAgICAgICAgUFJFR0FNRV9DT1VOVERPV05fU0laRV9HT19FTkQsCiAgICAgICAgdHJ1ZQogICAgKTsKICAgIGlmICghb2sgfHwgZXhwZWN0ZWRUb2tlbiAhPT0gU3RhdGUucm91bmQuY291bnRkb3duLnRva2VuKSB7CiAgICAgICAgLy8gSWYgdGhlIGFuaW1hdGlvbiBhYm9ydGVkLCBoaWRlIGltbWVkaWF0ZWx5IHRvIGF2b2lkIGEgc3R1Y2sgR08uCiAgICAgICAgaWYgKGV4cGVjdGVkVG9rZW4gPT09IFN0YXRlLnJvdW5kLmNvdW50ZG93bi50b2tlbikgewogICAgICAgICAgICBoaWRlUHJlZ2FtZUNvdW50ZG93bkZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgU3RhdGUucm91bmQuY291bnRkb3duLmlzQWN0aXZlID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAvLyBLZWVwIEdPIHZpc2libGUgZm9yIGEgc2hvcnQgaG9sZCB0byBmaW5pc2ggdGhlIHZpc3VhbCBiZWF0ICh1bnByZWRpY3RhYmxlIHJlcHJvIGlzc3VlcykuCiAgICBpZiAoU3RhdGUubWF0Y2guaXNFbmRlZCkgewogICAgICAgIGhpZGVQcmVnYW1lQ291bnRkb3duRm9yQWxsUGxheWVycygpOwogICAgICAgIFN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc0FjdGl2ZSA9IGZhbHNlOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBhd2FpdCBtb2QuV2FpdChQUkVHQU1FX0NPVU5URE9XTl9HT19IT0xEX1NFQ09ORFMpOwogICAgaWYgKGV4cGVjdGVkVG9rZW4gIT09IFN0YXRlLnJvdW5kLmNvdW50ZG93bi50b2tlbikgcmV0dXJuOwoKICAgIGhpZGVQcmVnYW1lQ291bnRkb3duRm9yQWxsUGxheWVycygpOwogICAgU3RhdGUucm91bmQuY291bnRkb3duLmlzQWN0aXZlID0gZmFsc2U7Cn0KCi8vIFN0YXJ0cyB0aGUgcm91bmQgYXMgc29vbiBhcyBhbGwgYWN0aXZlIHBsYXllcnMgYXJlIFJFQURZLgovLyBOb3RlczoKLy8gLSBPbmx5IHRyaWdnZXJzIHdoZW4gcm91bmQgaXMgTk9UIGFjdGl2ZSBhbmQgbWF0Y2ggaXMgTk9UIGVuZGVkLgovLyAtIFVzZXMgdGhlIGV4aXN0aW5nIHN0YXJ0Um91bmQoKSBmbG93OyB3ZSBkbyBub3QgYnlwYXNzIG9yIHJlaW1wbGVtZW50IHJvdW5kIGluaXQgbG9naWMuCmZ1bmN0aW9uIHRyeUF1dG9TdGFydFJvdW5kSWZBbGxSZWFkeSh0cmlnZ2VyUGxheWVyPzogbW9kLlBsYXllcik6IHZvaWQgewogICAgaWYgKFN0YXRlLm1hdGNoLmlzRW5kZWQgfHwgaXNSb3VuZExpdmUoKSkgcmV0dXJuOwogICAgaWYgKCFhcmVBbGxBY3RpdmVQbGF5ZXJzUmVhZHkoKSkgcmV0dXJuOwogICAgLy8gQWxsIHBsYXllcnMgcmVhZHk6IHN0YXJ0IHRoZSByb3VuZCB1c2luZyB0aGUgZXhpc3RpbmcgZnVuY3Rpb24uCiAgICBzdGFydFByZWdhbWVDb3VudGRvd24odHJpZ2dlclBsYXllcik7IC8vb2xkOiBzdGFydFJvdW5kKHRyaWdnZXJQbGF5ZXIpOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIC0gQWxsLVJlYWR5IEF1dG8tU3RhcnQgKyBSb3VuZCBSZXNldCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gUmVhZHkgRGlhbG9nIC0gU3dhcCBUZWFtcyBCdXR0b24gKHNpbmdsZSB0b2dnbGUpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovLyBTd2FwcyB0aGUgZ2l2ZW4gcGxheWVyIGJldHdlZW4gVGVhbSAxIGFuZCBUZWFtIDIuIFRoaXMgcmV1c2VzIHRoZSBleGlzdGluZyB0ZWFtLWFzc2lnbm1lbnQgQVBJcywKLy8gYnV0IGV4cG9zZXMgdGhlbSBhcyBhIHNpbmdsZSB0b2dnbGUgYnV0dG9uIHJhdGhlciB0aGFuIHNlcGFyYXRlIFRlYW0gMSAvIFRlYW0gMiBidXR0b25zLgpmdW5jdGlvbiBzd2FwUGxheWVyVGVhbShldmVudFBsYXllcjogbW9kLlBsYXllcik6IHZvaWQgewogICAgLy8gU3dhcCBUZWFtcyBidXR0b246OiBzaW5nbGUtYnV0dG9uIHRlYW0gdG9nZ2xlIChUZWFtIDEgPC0+IFRlYW0gMikuCiAgICAvLyBJTVBPUlRBTlQ6IFRoaXMgbXVzdCByZWFwcGx5IHRoZSBsZWdhY3kgYmVoYXZpb3IgZnJvbSB0aGUgb2xkIFRlYW0gMSAvIFRlYW0gMiBidXR0b25zOgogICAgLy8gLSBBcHBseSB0aGUgdGVhbSBhc3NpZ25tZW50IGNoYW5nZQogICAgLy8gLSBVbmRlcGxveSAoZm9yY2VzIHJlZGVwbG95KSBzbyB0aGUgcGxheWVyIGFjdHVhbGx5IHJlc3Bhd25zIG9uIHRoZSBuZXcgdGVhbQogICAgLy8gLSBDbG9zZSB0aGUgZGlhbG9nIGFuZCBicm9hZGNhc3QgdGhlIHRlYW0tc3dpdGNoIG1lc3NhZ2UKICAgIC8vIFdlIGFjaGlldmUgdGhhdCBieSByZXVzaW5nIHRoZSByZXRhaW5lZCBwcm9jZXNzVGVhbVN3aXRjaCgpIHBhdGh3YXkuCiAgICBjb25zdCBwaWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgLy8gU3dhcHBpbmcgdGVhbXMgbXVzdCBhbHdheXMgZm9yY2UgdGhlIHBsYXllciBiYWNrIHRvIE5PVCBSRUFEWS4KICAgIC8vIFRoaXMgcHJldmVudHMgYSBwbGF5ZXIgZnJvbSBjYXJyeWluZyBSRUFEWSBzdGF0dXMgYWNyb3NzIHRlYW0gYXNzaWdubWVudCBjaGFuZ2VzLgogICAgU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW3BpZF0gPSBmYWxzZTsKICAgIC8vIEtlZXAgdGhlIEhVRCAiWCAvIFkgUExBWUVSUyBSRUFEWSIgbGluZSBpbiBzeW5jIG9uIGV2ZXJ5IHJlYWR5LXN0YXRlIGNoYW5nZS4KICAgIHVwZGF0ZVBsYXllcnNSZWFkeUh1ZFRleHRGb3JBbGxQbGF5ZXJzKCk7CiAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JQaWQocGlkKTsKCiAgICBwcm9jZXNzVGVhbVN3aXRjaChldmVudFBsYXllcik7CgogICAgLy8gSWYgb3RoZXIgdmlld2VycyBoYXZlIHRoZSByZWFkeSBkaWFsb2cgb3BlbiwgcmVmcmVzaCB0aGVpciByb3N0ZXJzIHNvIHRoaXMgcGxheWVyIG1vdmVzIGNvbHVtbnMgaW1tZWRpYXRlbHkuCiAgICByZW5kZXJSZWFkeURpYWxvZ0ZvckFsbFZpc2libGVWaWV3ZXJzKCk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBSZWFkeSBEaWFsb2cgLSBTd2FwIFRlYW1zIEJ1dHRvbiAoc2luZ2xlIHRvZ2dsZSkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgoKLy8jcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE11bHRpQ2xpY2tEZXRlY3RvciAodHJpcGxlIHRhcCBpbnRlcmFjdCkgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8vQ29kZSBDbGVhbnVwOiBSZWZhY3RvciB0aGlzIHJlZmVyZW5jZSBhbmQgdXNlIFRTIFRlbXBsYXRlIGFzIGEgdG9vbCBpbXBvcnQgZHVyaW5nIGJ1bmRsaW5nIGEgbmV3IGRpc3RyaWJ1dGlvbiBpbnN0ZWFkCmNsYXNzIEludGVyYWN0TXVsdGlDbGlja0RldGVjdG9yIHsKICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFNUQVRFUzogUmVjb3JkPG51bWJlciwgeyBsYXN0SXNJbnRlcmFjdGluZzogYm9vbGVhbjsgY2xpY2tDb3VudDogbnVtYmVyOyBzZXF1ZW5jZVN0YXJ0VGltZTogbnVtYmVyIH0+ID0ge307CiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBXSU5ET1dfTVMgPSAxXzAwMDsKICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFJFUVVJUkVEX0NMSUNLUyA9IDM7CgogICAgcHVibGljIHN0YXRpYyBjaGVja011bHRpQ2xpY2socGxheWVyOiBtb2QuUGxheWVyKTogYm9vbGVhbiB7CiAgICAgICAgY29uc3QgcGxheWVySWQgPSBtb2QuR2V0T2JqSWQocGxheWVyKTsKICAgICAgICBjb25zdCBpc0ludGVyYWN0aW5nID0gbW9kLkdldFNvbGRpZXJTdGF0ZShwbGF5ZXIsIG1vZC5Tb2xkaWVyU3RhdGVCb29sLklzSW50ZXJhY3RpbmcpOwoKICAgICAgICBsZXQgc3RhdGUgPSB0aGlzLlNUQVRFU1twbGF5ZXJJZF07CiAgICAgICAgaWYgKCFzdGF0ZSkgewogICAgICAgICAgICB0aGlzLlNUQVRFU1twbGF5ZXJJZF0gPSBzdGF0ZSA9IHsKICAgICAgICAgICAgICAgIGxhc3RJc0ludGVyYWN0aW5nOiBpc0ludGVyYWN0aW5nLAogICAgICAgICAgICAgICAgY2xpY2tDb3VudDogMCwKICAgICAgICAgICAgICAgIHNlcXVlbmNlU3RhcnRUaW1lOiAwLAogICAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgaWYgKGlzSW50ZXJhY3RpbmcgPT09IHN0YXRlLmxhc3RJc0ludGVyYWN0aW5nKSByZXR1cm4gZmFsc2U7CiAgICAgICAgc3RhdGUubGFzdElzSW50ZXJhY3RpbmcgPSBpc0ludGVyYWN0aW5nOwoKICAgICAgICBpZiAoIWlzSW50ZXJhY3RpbmcpIHJldHVybiBmYWxzZTsKCiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTsKCiAgICAgICAgaWYgKHN0YXRlLmNsaWNrQ291bnQgPiAwICYmIG5vdyAtIHN0YXRlLnNlcXVlbmNlU3RhcnRUaW1lID4gdGhpcy5XSU5ET1dfTVMpIHsKICAgICAgICAgICAgc3RhdGUuY2xpY2tDb3VudCA9IDA7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RhdGUuY2xpY2tDb3VudCA9PT0gMCkgewogICAgICAgICAgICBzdGF0ZS5zZXF1ZW5jZVN0YXJ0VGltZSA9IG5vdzsKICAgICAgICAgICAgc3RhdGUuY2xpY2tDb3VudCA9IDE7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmICgrK3N0YXRlLmNsaWNrQ291bnQgIT09IHRoaXMuUkVRVUlSRURfQ0xJQ0tTKSByZXR1cm4gZmFsc2U7CgogICAgICAgIHN0YXRlLmNsaWNrQ291bnQgPSAwOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gTXVsdGlDbGlja0RldGVjdG9yICh0cmlwbGUgdGFwIGludGVyYWN0KSAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgovLyNyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0gTWFpbiBCYXNlIFJlc3RvY2sgKGFyZWEgdHJpZ2dlcnMpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBJc1BsYXllckluT3duTWFpbkJhc2UocGxheWVyOiBtb2QuUGxheWVyLCBhcmVhVHJpZ2dlcjogbW9kLkFyZWFUcmlnZ2VyKTogYm9vbGVhbiB7CiAgICBjb25zdCB0cmlnZ2VySWQgPSBtb2QuR2V0T2JqSWQoYXJlYVRyaWdnZXIpOwogICAgY29uc3QgdGVhbUlkID0gbW9kLkdldE9iaklkKG1vZC5HZXRUZWFtKHBsYXllcikpOwoKICAgIHJldHVybiBtb2QuT3IoCiAgICAgICAgbW9kLkFuZChtb2QuRXF1YWxzKHRyaWdnZXJJZCwgVEVBTTFfTUFJTl9CQVNFX1RSSUdHRVJfSUQpLCBtb2QuRXF1YWxzKHRlYW1JZCwgbW9kLkdldE9iaklkKG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMSkpKSksCiAgICAgICAgbW9kLkFuZChtb2QuRXF1YWxzKHRyaWdnZXJJZCwgVEVBTTJfTUFJTl9CQVNFX1RSSUdHRVJfSUQpLCBtb2QuRXF1YWxzKHRlYW1JZCwgbW9kLkdldE9iaklkKG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMikpKSkKICAgICk7Cn0KCmZ1bmN0aW9uIEJyb2FkY2FzdE1haW5CYXNlRXZlbnQobWVzc2FnZTogbW9kLk1lc3NhZ2UpOiB2b2lkIHsKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtZXNzYWdlLCBmYWxzZSk7Cn0KCmZ1bmN0aW9uIE5vdGlmeUFtbW9SZXN0b2NrZWQocGxheWVyOiBtb2QuUGxheWVyKTogdm9pZCB7CiAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UobW9kLk1lc3NhZ2UoU1RSX0FNTU9fUkVTVE9DS0VEKSwgdHJ1ZSwgbW9kLkdldFRlYW0ocGxheWVyKSk7Cn0KCmZ1bmN0aW9uIFJlc3RvY2tHYWRnZXRBbW1vKHBsYXllcjogbW9kLlBsYXllciwgbWFnQW1tbzogbnVtYmVyKTogdm9pZCB7CiAgICBpZiAoIWlzUGxheWVyRGVwbG95ZWQocGxheWVyKSkgcmV0dXJuOwogICAgbW9kLlNldEludmVudG9yeU1hZ2F6aW5lQW1tbyhwbGF5ZXIsIG1vZC5JbnZlbnRvcnlTbG90cy5HYWRnZXRPbmUsIG1hZ0FtbW8pOwogICAgbW9kLlNldEludmVudG9yeU1hZ2F6aW5lQW1tbyhwbGF5ZXIsIG1vZC5JbnZlbnRvcnlTbG90cy5HYWRnZXRUd28sIG1hZ0FtbW8pOwp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gTWFpbiBCYXNlIFJlc3RvY2sgKGFyZWEgdHJpZ2dlcnMpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBFeHBvcnRlZCBFdmVudCBIYW5kbGVycyAoc2luZ2xlIGV4cG9ydHMpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgovKioKICogRW50cnkgcG9pbnQgZm9yIHRoaXMgZXhwZXJpZW5jZSB3aGVuIHRoZSBnYW1lIG1vZGUgc3RhcnRzLgogKgogKiBIaWdoLWxldmVsIGZsb3c6CiAqIDEpIEluaXRpYWxpemUgYXV0aG9yaXRhdGl2ZSBtYXRjaC9yb3VuZCBzdGF0ZSAoY291bnRlcnMsIGZsYWdzLCBhbmQgdGltZXJzKS4KICogMikgQnVpbGQgb3IgcmVwYWlyIGFueSBnbG9iYWwgVUkvc3RhdGUgdGhhdCBzaG91bGQgZXhpc3QgYmVmb3JlIHBsYXllcnMgaW50ZXJhY3QuCiAqIDMpIEVuc3VyZSBldmVyeSBjdXJyZW50bHktY29ubmVjdGVkIHBsYXllciBoYXMgYSBIVUQgYW5kIHRoYXQgdGhlIEhVRCByZWZsZWN0cyB0aGUgaW5pdGlhbCBzdGF0ZS4KICogNCkgQXJtIGFueSByZWN1cnJpbmcgcHJvY2Vzc2VzIChjbG9jayB0aWNrLCBjbGVhbnVwIHBhc3NlcykgdGhhdCBrZWVwIHN0YXRlIGFuZCBVSSBpbiBzeW5jLgogKgogKiBJbXBvcnRhbnQgaW52YXJpYW50czoKICogLSBEbyBub3QgYXdhcmQgcG9pbnRzIHVubGVzcyBgaXNSb3VuZExpdmUoKWAgaXMgdHJ1ZS4KICogLSBSb3VuZC9tYXRjaCBjb3VudGVycyBhcmUgYXV0aG9yaXRhdGl2ZTsgdGhlIEhVRCBpcyBhIHByb2plY3Rpb24gb2YgdGhhdCBzdGF0ZS4KICogLSBBbnkgYXN5bmMgd29yayBzdGFydGVkIGhlcmUgbXVzdCB1c2UgdGhlIGd1YXJkIHRva2VucyB0byBwcmV2ZW50IG92ZXJsYXAgaWYgdGhlIG1vZGUgcmVzdGFydHMuCiAqCiAqIFdoeSBhc3luYyBmdW5jdGlvbnM6IHVzZXMgc21hbGwgZW5naW5lIHdhaXRzIChtb2QuV2FpdC9hd2FpdCkgdG8gc2VxdWVuY2UgVUkgcmVidWlsZHMvdGltZXJzIHNhZmVseSB3aXRob3V0IGJsb2NraW5nIHRoZSBtYWluIHRocmVhZC4KICovCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBPbkdhbWVNb2RlU3RhcnRlZCgpOiBQcm9taXNlPHZvaWQ+IHsKICAgIGNvbnN0IGRldGVjdGVkTWFwS2V5ID0gZGV0ZWN0TWFwS2V5RnJvbUhxcygpOwogICAgaWYgKGRldGVjdGVkTWFwS2V5KSB7CiAgICAgICAgYXBwbHlNYXBDb25maWcoZGV0ZWN0ZWRNYXBLZXkpOwogICAgfQogICAgU3RhdGUudmVoaWNsZXMuY29uZmlnUmVhZHkgPSB0cnVlOwoKICAgIC8vIFZlaGljbGUgc2NvcmluZyBpbml0ICsgbGVnYWN5IGNsZWFudXAKICAgIC8vIFJlbW92ZSBsZWdhY3kgVUkgcm9vdHMgKGlmIGFueSkgYmVmb3JlIHdlIGJ1aWxkIGZyZXNoIEhVRHM7IHByZXZlbnRzIGR1cGxpY2F0ZWQgb3ZlcmxheXMgYWNyb3NzIHJlc3RhcnRzLgogICAgZGVsZXRlTGVnYWN5U2NvcmVSb290c0ZvckFsbFBsYXllcnMoKTsKCiAgICAvLyBBcHBseSBpbml0aWFsIGVuZ2luZSB2YXJpYWJsZXMvc2V0dGluZ3MgdXNlZCBieSB0aGUgbW9kZSAoYXV0aG9yaXRhdGl2ZSBiYXNlbGluZSkuCiAgICBtb2QuU2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMSwgbW9kLkVtcHR5QXJyYXkoKSk7CiAgICBtb2QuU2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMiwgbW9kLkVtcHR5QXJyYXkoKSk7CgogICAgdmVoSWRzLmxlbmd0aCA9IDA7CiAgICB2ZWhPd25lcnMubGVuZ3RoID0gMDsKICAgIGNsZWFyU3Bhd25CYXNlVGVhbUNhY2hlKCk7CiAgICBjbGVhclNwYXduQmFzZVRlYW1DYWNoZSgpOwoKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMuaW5pdCksIGZhbHNlLCBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTEpKTsKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMuaW5pdCksIGZhbHNlLCBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTIpKTsKCiAgICAvLyBFbnN1cmUgSFVEIGV4aXN0cyBmb3IgYW55b25lIGFscmVhZHkgaW4tZ2FtZSBhdCBzdGFydAogICAgYXdhaXQgbW9kLldhaXQoMC4xKTsKICAgIHsKICAgICAgICBjb25zdCBwbGF5ZXJzID0gbW9kLkFsbFBsYXllcnMoKTsKICAgICAgICBjb25zdCBjb3VudCA9IG1vZC5Db3VudE9mKHBsYXllcnMpOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgICAgICBjb25zdCBwID0gbW9kLlZhbHVlSW5BcnJheShwbGF5ZXJzLCBpKSBhcyBtb2QuUGxheWVyOwogICAgICAgICAgICBpZiAoIXAgfHwgIW1vZC5Jc1BsYXllclZhbGlkKHApKSBjb250aW51ZTsKICAgICAgICAgICAgLy8gQnVpbGQvcmVidWlsZCB0aGUgcGxheWVyJ3MgSFVEICh3aWRnZXRzKSBhbmQgaW1tZWRpYXRlbHkgcmVmbGVjdCBjdXJyZW50IGF1dGhvcml0YXRpdmUgc3RhdGUuCiAgICAgICAgICAgIGVuc3VyZUh1ZEZvclBsYXllcihwKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gUmVzZXQgSFVEIHN0YXRlCiAgICBTdGF0ZS5tYXRjaC5pc0VuZGVkID0gZmFsc2U7CiAgICBTdGF0ZS5tYXRjaC52aWN0b3J5RGlhbG9nQWN0aXZlID0gZmFsc2U7CiAgICBTdGF0ZS5yb3VuZC5waGFzZSA9IFJvdW5kUGhhc2UuTm90UmVhZHk7IC8vIFJlc2V0IHJvdW5kIHBoYXNlIGZvciBhIG5ldyBtYXRjaC4KICAgIFN0YXRlLnJvdW5kLmN1cnJlbnQgPSAxOwoKICAgIHNldE1hdGNoV2luc1RlYW0oVGVhbUlELlRlYW0xLCAwKTsKICAgIHNldE1hdGNoV2luc1RlYW0oVGVhbUlELlRlYW0yLCAwKTsKICAgIFN0YXRlLnNjb3Jlcy50MVRvdGFsS2lsbHMgPSAwOwogICAgU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscyA9IDA7CgogICAgU3RhdGUubWF0Y2gud2lubmVyVGVhbSA9IHVuZGVmaW5lZDsKICAgIFN0YXRlLm1hdGNoLmVuZEVsYXBzZWRTZWNvbmRzU25hcHNob3QgPSAwOwogICAgU3RhdGUubWF0Y2gudmljdG9yeVN0YXJ0RWxhcHNlZFNlY29uZHNTbmFwc2hvdCA9IDA7CiAgICBTdGF0ZS5hZG1pbi5hY3Rpb25Db3VudCA9IDA7CgogICAgU3RhdGUuaHVkQ2FjaGUubGFzdEh1ZFNjb3JlVDEgPSB1bmRlZmluZWQ7CiAgICBTdGF0ZS5odWRDYWNoZS5sYXN0SHVkU2NvcmVUMiA9IHVuZGVmaW5lZDsKICAgIC8vIEluaXQgdmlzaWJsZSBjb3VudGVycwogICAgc2V0SHVkUm91bmRDb3VudGVyc0ZvckFsbFBsYXllcnMoU3RhdGUucm91bmQuY3VycmVudCwgTUFYX1JPVU5EUyk7CiAgICBzZXRIdWRXaW5Db3VudGVyc0ZvckFsbFBsYXllcnMoMCwgMCk7CiAgICBTdGF0ZS5tYXRjaC50aWVzVDEgPSAwOwogICAgU3RhdGUubWF0Y2gudGllc1QyID0gMDsKICAgIHN5bmNSb3VuZFJlY29yZEh1ZEZvckFsbFBsYXllcnMoKTsKICAgIHN5bmNXaW5Db3VudGVyc0h1ZEZyb21HYW1lTW9kZVNjb3JlKCk7CiAgICBzeW5jS2lsbHNIdWRGcm9tVHJhY2tlZFRvdGFscyh0cnVlKTsKICAgIHVwZGF0ZUFkbWluUGFuZWxBY3Rpb25Db3VudEZvckFsbFBsYXllcnMoKTsKICAgIC8vIEJyb2FkY2FzdCB0aGUgaW5pdGlhbCByb3VuZCBwaGFzZSBsYWJlbCAoZS5nLiwgTk9UIFJFQURZKSB0byBhbGwgSFVEcy4KICAgIHNldFJvdW5kU3RhdGVUZXh0Rm9yQWxsUGxheWVycygpOwogICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yQWxsUGxheWVycygpOwoKICAgIC8vIENsb2NrIGluaXQgKyBsb29wCiAgICBSZXNldFJvdW5kQ2xvY2soMCk7CgogICAgLy8gVmVoaWNsZSBzcGF3bmVycyBydW4gb24gdGhlaXIgb3duIGxvb3Agc28gdGhleSBkb24ndCBibG9jayB0aGUgbWFpbiBjbG9jayBsb29wLgogICAgdm9pZCBzdGFydFZlaGljbGVTcGF3bmVyU3lzdGVtKCk7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAvLyBQdXNoIHRoZSBpbml0aWFsIGNsb2NrIGRpc3BsYXkgc28gZXZlcnkgSFVEIHNob3dzIHRoZSBzYW1lIHN0YXJ0aW5nIHRpbWUuCiAgICAgICAgdXBkYXRlQWxsUGxheWVyc0Nsb2NrKCk7CiAgICAgICAgc3luY0tpbGxzSHVkRnJvbVRyYWNrZWRUb3RhbHMoZmFsc2UpOwoKICAgICAgICBpZiAoU3RhdGUubWF0Y2gudmljdG9yeURpYWxvZ0FjdGl2ZSkgewogICAgICAgICAgICBjb25zdCBlbGFwc2VkU2luY2VWaWN0b3J5ID0gTWF0aC5mbG9vcihtb2QuR2V0TWF0Y2hUaW1lRWxhcHNlZCgpKSAtIE1hdGguZmxvb3IoU3RhdGUubWF0Y2gudmljdG9yeVN0YXJ0RWxhcHNlZFNlY29uZHNTbmFwc2hvdCk7CiAgICAgICAgICAgIGNvbnN0IHJlbWFpbmluZyA9IE1BVENIX0VORF9ERUxBWV9TRUNPTkRTIC0gZWxhcHNlZFNpbmNlVmljdG9yeTsKICAgICAgICAgICAgdXBkYXRlVmljdG9yeURpYWxvZ0ZvckFsbFBsYXllcnMoTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihyZW1haW5pbmcpKSk7CiAgICAgICAgfQogICAgICAgIGF3YWl0IG1vZC5XYWl0KDEuMCk7CiAgICB9Cn0KCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBPblBsYXllckpvaW5HYW1lKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKSB7CiAgICBpbml0VGVhbVN3aXRjaERhdGEoZXZlbnRQbGF5ZXIpOwogICAgU3RhdGUucGxheWVycy5kZXBsb3llZEJ5UGlkW2dldE9iaklkKGV2ZW50UGxheWVyKV0gPSBmYWxzZTsKCiAgICBhd2FpdCBtb2QuV2FpdCgwLjEpOwogICAgaWYgKCFtb2QuSXNQbGF5ZXJWYWxpZChldmVudFBsYXllcikpIHJldHVybjsKCiAgICBjb25zdCByZWZzID0gZW5zdXJlSHVkRm9yUGxheWVyKGV2ZW50UGxheWVyKTsKCiAgICAvLyBKb2luLXRpbWUgSFVEIGluaXRpYWxpemF0aW9uIHVzZXMgc2NyaXB0LWF1dGhvcml0YXRpdmUgY291bnRlcnM7IGRvIG5vdCBwdWxsIGZyb20gZW5naW5lIHNjb3JlcyBoZXJlLgogICAgaWYgKHJlZnMpIHsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLmxlZnRXaW5zVGV4dCwgU3RhdGUubWF0Y2gud2luc1QxKTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJpZ2h0V2luc1RleHQsIFN0YXRlLm1hdGNoLndpbnNUMik7CiAgICAgICAgc2V0Um91bmRSZWNvcmRUZXh0KHJlZnMubGVmdFJlY29yZFRleHQsIFN0YXRlLm1hdGNoLndpbnNUMSwgU3RhdGUubWF0Y2gubG9zc2VzVDEsIFN0YXRlLm1hdGNoLnRpZXNUMSk7CiAgICAgICAgc2V0Um91bmRSZWNvcmRUZXh0KHJlZnMucmlnaHRSZWNvcmRUZXh0LCBTdGF0ZS5tYXRjaC53aW5zVDIsIFN0YXRlLm1hdGNoLmxvc3Nlc1QyLCBTdGF0ZS5tYXRjaC50aWVzVDIpOwogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMubGVmdFJvdW5kS2lsbHNUZXh0LCBTdGF0ZS5zY29yZXMudDFSb3VuZEtpbGxzKTsKICAgICAgICBzZXRDb3VudGVyVGV4dChyZWZzLnJpZ2h0Um91bmRLaWxsc1RleHQsIFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHMpOwogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMubGVmdEtpbGxzVGV4dCwgU3RhdGUuc2NvcmVzLnQxVG90YWxLaWxscyk7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5yaWdodEtpbGxzVGV4dCwgU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscyk7CiAgICAgICAgc2V0Q291bnRlclRleHQocmVmcy5yb3VuZEN1clRleHQsIFN0YXRlLnJvdW5kLmN1cnJlbnQpOwogICAgICAgIHNldENvdW50ZXJUZXh0KHJlZnMucm91bmRNYXhUZXh0LCBTdGF0ZS5yb3VuZC5tYXgpOwogICAgfQogICAgewogICAgICAgIGNvbnN0IGNhY2hlID0gZW5zdXJlQ2xvY2tVSUFuZEdldENhY2hlKGV2ZW50UGxheWVyKTsKICAgICAgICBpZiAoY2FjaGUpIHNldFJvdW5kU3RhdGVUZXh0KGNhY2hlLnJvdW5kU3RhdGVUZXh0KTsKICAgIHVwZGF0ZUhlbHBUZXh0VmlzaWJpbGl0eUZvclBsYXllcihldmVudFBsYXllcik7CiAgICB9CiAgICBkZWxldGVMZWdhY3lTY29yZVJvb3RGb3JQbGF5ZXIoZXZlbnRQbGF5ZXIpOwogICAgdXBkYXRlVGVhbU5hbWVXaWRnZXRzRm9yUGlkKG1vZC5HZXRPYmpJZChldmVudFBsYXllcikpOwp9CgovKioKICogRGlzY29ubmVjdCBoYW5kbGluZzoKICogLSBDbGVhcnMgcGVyLXBsYXllciBzdGF0ZSBtYXBzIHNvIHJlam9pbiBzdGFydHMgY2xlYW4gKE5PVCBSRUFEWSkuCiAqIC0gRm9yY2VzIFVJL0hVRCByZWZyZXNoIGZvciByZW1haW5pbmcgcGxheWVycyB0byBkcm9wIHRoZSBkZXBhcnRlZCBwbGF5ZXIgaW1tZWRpYXRlbHkuCiAqLwpleHBvcnQgZnVuY3Rpb24gT25QbGF5ZXJMZWF2ZUdhbWUoZXZlbnROdW1iZXI6IG51bWJlcikgewogICAgcmVtb3ZlVGVhbVN3aXRjaEludGVyYWN0UG9pbnQoZXZlbnROdW1iZXIpOwogICAgLy8gQ2xlYW51cDogZGVsZXRlIGNhY2hlZCBVSSB3aWRnZXRzIHNvIHdlIGRvIG5vdCBsZWFrIFVJIGZvciBkaXNjb25uZWN0ZWQgcGxheWVycy4KICAgIGhhcmREZWxldGVUZWFtU3dpdGNoVUkoZXZlbnROdW1iZXIpOwogICAgLy8gUmVtb3ZlIGFueSBwZXJzaXN0ZWQgcGVyLXBsYXllciBzdGF0ZSBzbyByZWpvaW4gc3RhcnRzIGNsZWFuIChOT1QgUkVBRFkgYnkgZGVmYXVsdCkuCiAgICBkZWxldGUgU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW2V2ZW50TnVtYmVyXTsKICAgIGRlbGV0ZSBTdGF0ZS5wbGF5ZXJzLmluTWFpbkJhc2VCeVBpZFtldmVudE51bWJlcl07CiAgICBkZWxldGUgU3RhdGUucGxheWVycy5kZXBsb3llZEJ5UGlkW2V2ZW50TnVtYmVyXTsKICAgIC8vIEFsc28gZHJvcCBkaWFsb2ctdmlzaWJsZSB0cmFja2luZyBpZiBwcmVzZW50ICh2aWV3ZXIgaXMgZ29uZSkuCiAgICBkZWxldGUgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtldmVudE51bWJlcl07CgogICAgLy8gUmVmcmVzaCBVSSBmb3IgcmVtYWluaW5nIHBsYXllcnMgc28gcm9zdGVycyArIEhVRCByZWFkeSBjb3VudHMgaW1tZWRpYXRlbHkgcmVmbGVjdCB0aGUgZGlzY29ubmVjdC4KICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yQWxsVmlzaWJsZVZpZXdlcnMoKTsKICAgIHVwZGF0ZVBsYXllcnNSZWFkeUh1ZFRleHRGb3JBbGxQbGF5ZXJzKCk7CiAgICB1cGRhdGVIZWxwVGV4dFZpc2liaWxpdHlGb3JBbGxQbGF5ZXJzKCk7Cn0KCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBPblBsYXllckRlcGxveWVkKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKSB7CiAgICBTdGF0ZS5wbGF5ZXJzLmRlcGxveWVkQnlQaWRbZ2V0T2JqSWQoZXZlbnRQbGF5ZXIpXSA9IHRydWU7CiAgICAvL1JlbW92ZSBleGlzdGluZyBnYWRnZXRzIGFuZCBnaXZlIGRlcGxveWFibGUgdmVoaWNsZSBzdXBwbHkgY3JhdGVzCiAgICBtb2QuUmVtb3ZlRXF1aXBtZW50KGV2ZW50UGxheWVyLCBtb2QuSW52ZW50b3J5U2xvdHMuR2FkZ2V0T25lKTsKICAgIG1vZC5SZW1vdmVFcXVpcG1lbnQoZXZlbnRQbGF5ZXIsIG1vZC5JbnZlbnRvcnlTbG90cy5HYWRnZXRUd28pOwogICAgbW9kLkFkZEVxdWlwbWVudCgKICAgICAgICBldmVudFBsYXllciwKICAgICAgICBtb2QuR2FkZ2V0cy5EZXBsb3lhYmxlX1ZlaGljbGVfU3VwcGx5X0NyYXRlLAogICAgICAgIG1vZC5JbnZlbnRvcnlTbG90cy5HYWRnZXRPbmUKICAgICk7CiAgICBtb2QuQWRkRXF1aXBtZW50KAogICAgICAgIGV2ZW50UGxheWVyLAogICAgICAgIG1vZC5HYWRnZXRzLkRlcGxveWFibGVfVmVoaWNsZV9TdXBwbHlfQ3JhdGUsCiAgICAgICAgbW9kLkludmVudG9yeVNsb3RzLkdhZGdldFR3bwogICAgKTsKICAgIC8vIFJlam9pbiAvIHNwYXduIGJlaGF2aW9yOiBwbGF5ZXJzIGFsd2F5cyBzdGFydCBOT1QgUkVBRFkgZm9yIHRoZSBuZXh0IHJvdW5kIGdhdGluZy4KICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChldmVudFBsYXllcik7CiAgICBTdGF0ZS5wbGF5ZXJzLnJlYWR5QnlQaWRbcGlkXSA9IGZhbHNlOwogICAgLy8gRGVzaWduIGFzc3VtcHRpb246IHBsYXllcnMgc3Bhd24gaW4gdGhlaXIgbWFpbiBiYXNlOyB1cGRhdGUgaW1tZWRpYXRlbHkgZm9yIHJvc3RlciBkaXNwbGF5LgogICAgU3RhdGUucGxheWVycy5pbk1haW5CYXNlQnlQaWRbcGlkXSA9IHRydWU7CiAgICB1cGRhdGVQbGF5ZXJzUmVhZHlIdWRUZXh0Rm9yQWxsUGxheWVycygpOwogICAgcmVuZGVyUmVhZHlEaWFsb2dGb3JBbGxWaXNpYmxlVmlld2VycygpOwogICAgdXBkYXRlSGVscFRleHRWaXNpYmlsaXR5Rm9yQWxsUGxheWVycygpOwoKICAgIGVuc3VyZUh1ZEZvclBsYXllcihldmVudFBsYXllcik7CiAgICBhd2FpdCBzcGF3blRlYW1Td2l0Y2hJbnRlcmFjdFBvaW50KGV2ZW50UGxheWVyKTsKCiAgICAvLyBBZG1pbiBkZWJ1ZyBsb29wIGludGVudGlvbmFsbHkgZGlzYWJsZWQgKHRvZ2dsZSBtYW51YWxseSB3aGVuIG5lZWRlZCkuCn0KCmV4cG9ydCBmdW5jdGlvbiBPblBsYXllclVuZGVwbG95KGV2ZW50UGxheWVyOiBtb2QuUGxheWVyKSB7CiAgICAvLyBJZiB0aGUgcGxheWVyIGlzIGxlYXZpbmcgdGhlIGRlcGxveWVkIHN0YXRlIChkZWF0aCAvIG1hbnVhbCB1bmRlcGxveSAvIGZvcmNlZCByZWRlcGxveSksCiAgICAvLyB0aGUgUmVhZHkgVXAgZGlhbG9nIHNob3VsZCBiZSBjbG9zZWQuIFRoaXMgcHJldmVudHMgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgVUkgd2hpbGUgdW5kZXBsb3llZC4KICAgIGNvbnN0IHBpZCA9IG1vZC5HZXRPYmpJZChldmVudFBsYXllcik7CiAgICBTdGF0ZS5wbGF5ZXJzLmRlcGxveWVkQnlQaWRbcGlkXSA9IGZhbHNlOwogICAgaWYgKFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGlkXT8uZGlhbG9nVmlzaWJsZSkgewogICAgICAgIGRlbGV0ZVRlYW1Td2l0Y2hVSShldmVudFBsYXllcik7CiAgICB9CgogICAgcmVtb3ZlVGVhbVN3aXRjaEludGVyYWN0UG9pbnQoZXZlbnRQbGF5ZXIpOwp9CgovLyBQZXJmb3JtYW5jZSBub3RlOgovLyAtIE9uZ29pbmdQbGF5ZXIgZXhlY3V0ZXMgZnJlcXVlbnRseTsga2VlcCBpdCBsaWdodHdlaWdodCEKLy8gLSBBdm9pZCBGaW5kVUlXaWRnZXQgY2FsbHMgb3IgcGVyLXRpY2sgbG9vcHMgb3ZlciBhbGwgcGxheWVycy92ZWhpY2xlcyB1bmxlc3Mgc3RyaWN0bHkgbmVjZXNzYXJ5LgovLyAtIFByZWZlciAidXBkYXRlIG9ubHkgd2hlbiBjaGFuZ2VkIiBwYXR0ZXJucyBmb3IgSFVEL2Nsb2NrIHJlZnJlc2hlcy4KZXhwb3J0IGZ1bmN0aW9uIE9uZ29pbmdQbGF5ZXIoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIpOiB2b2lkIHsKICAgIGlmIChpc1BsYXllckRlcGxveWVkKGV2ZW50UGxheWVyKSkgewogICAgICAgIGNoZWNrVGVhbVN3aXRjaEludGVyYWN0UG9pbnRSZW1vdmFsKGV2ZW50UGxheWVyKTsKICAgIH0KCiAgICAvLyBVSSBjYWNoaW5nIHdhcm0tdXA6IGJ1aWxkIHRoZSBSZWFkeSBVcCBkaWFsb2cgb25jZSBwZXIgcGxheWVyIHNvIHRoZSBmaXJzdCByZWFsIG9wZW4gaXMgc25hcHB5LgogICAgLy8gV2UgYnVpbGQgYW5kIGltbWVkaWF0ZWx5IGhpZGU7IHRoZSBkaWFsb2cgYmVjb21lcyB2aXNpYmxlIG9ubHkgd2hlbiB0aGUgcGxheWVyIG9wZW5zIGl0IHZpYSB0aGUgaW50ZXJhY3QgcG9pbnQuCiAgICBjb25zdCBwaWQgPSBtb2QuR2V0T2JqSWQoZXZlbnRQbGF5ZXIpOwogICAgaWYgKFN0YXRlLnBsYXllcnMudGVhbVN3aXRjaERhdGFbcGlkXSAmJiAhU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwaWRdLnVpQnVpbHQpIHsKICAgICAgICBjcmVhdGVUZWFtU3dpdGNoVUkoZXZlbnRQbGF5ZXIpOwogICAgICAgIC8vIEVuc3VyZSB0aGUgd2FybS11cCBidWlsZCBkb2VzIG5vdCBjb3VudCBhcyAib3BlbiIgZm9yIHJlZnJlc2ggbG9naWMuCiAgICAgICAgU3RhdGUucGxheWVycy50ZWFtU3dpdGNoRGF0YVtwaWRdLmRpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgICBkZWxldGVUZWFtU3dpdGNoVUkoZXZlbnRQbGF5ZXIpOyAvLyBub3cgaGlkZXMgKGNhY2hlZCkgcmF0aGVyIHRoYW4gZGVsZXRpbmcKICAgICAgICBTdGF0ZS5wbGF5ZXJzLnRlYW1Td2l0Y2hEYXRhW3BpZF0udWlCdWlsdCA9IHRydWU7CiAgICB9CgogICAgaWYgKGlzUGxheWVyRGVwbG95ZWQoZXZlbnRQbGF5ZXIpKSB7CiAgICAgICAgaWYgKEludGVyYWN0TXVsdGlDbGlja0RldGVjdG9yLmNoZWNrTXVsdGlDbGljayhldmVudFBsYXllcikpIHsKICAgICAgICAgICAgc3Bhd25UZWFtU3dpdGNoSW50ZXJhY3RQb2ludChldmVudFBsYXllcik7CiAgICAgICAgICAgIC8vbW9kLkRpc3BsYXlIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wubm90aWZpY2F0aW9ucy5tdWx0aWNsaWNrRGV0ZWN0b3IpLCBtb2QuR2V0VGVhbShldmVudFBsYXllcikpOwogICAgICAgIH0KICAgIH0KfQoKZXhwb3J0IGZ1bmN0aW9uIE9uUGxheWVySW50ZXJhY3QoZXZlbnRQbGF5ZXI6IG1vZC5QbGF5ZXIsIGV2ZW50SW50ZXJhY3RQb2ludDogbW9kLkludGVyYWN0UG9pbnQpIHsKICAgIHRlYW1Td2l0Y2hJbnRlcmFjdFBvaW50QWN0aXZhdGVkKGV2ZW50UGxheWVyLCBldmVudEludGVyYWN0UG9pbnQpOwp9CgpleHBvcnQgZnVuY3Rpb24gT25QbGF5ZXJVSUJ1dHRvbkV2ZW50KGV2ZW50UGxheWVyOiBtb2QuUGxheWVyLCBldmVudFVJV2lkZ2V0OiBtb2QuVUlXaWRnZXQsIGV2ZW50VUlCdXR0b25FdmVudDogbW9kLlVJQnV0dG9uRXZlbnQpIHsKICAgIHRlYW1Td2l0Y2hCdXR0b25FdmVudChldmVudFBsYXllciwgZXZlbnRVSVdpZGdldCwgZXZlbnRVSUJ1dHRvbkV2ZW50KTsKfQoKLy8gT25QbGF5ZXJFbnRlclZlaGljbGU6Ci8vIFJlZ2lzdGVycyBhIHZlaGljbGUgdG8gYSB0ZWFtIHRoZSBmaXJzdCB0aW1lIGEgcGxheWVyIGVudGVycyBpdC4KLy8gVGhpcyBlc3RhYmxpc2hlcyB3aGljaCB0ZWFtIHdpbGwgbG9zZSBhIHBvaW50IGlmIHRoZSB2ZWhpY2xlIGlzIGxhdGVyIGRlc3Ryb3llZC4KLy8gQWxzbyByZWNvcmRzIHRoZSBlbnRlcmluZyBwbGF5ZXIgYXMgdGhlICdsYXN0IGRyaXZlcicgZm9yIG1lc3NhZ2luZyBwdXJwb3Nlcy4KLy8gTm90ZXM6Ci8vIC0gUmVnaXN0cmF0aW9uIGlzIGlkZW1wb3RlbnQ7IHJlLWVudGVyaW5nIGRvZXMgbm90IGRvdWJsZS1yZWdpc3Rlci4KLy8gLSBMYXN0IGRyaXZlciBpcyBiZXN0LWVmZm9ydCBhbmQgbm90IGF1dGhvcml0YXRpdmUgZm9yIHNjb3JpbmcuCi8vIENvZGUgQ2xlYW51cDogS25vd24gZnJhZ2lsaXR5IC0gd2UgbmVlZCB0byByZWZhY3RvciBvciBpZGVudGlmeSBhIGRpZmZlcmVudCBtZXRob2QgZW50aXJlbHkgYXMgT25QbGF5ZXJFbnRlclZlaGljbGUgaXMgZXJyb3IgcHJvbmUuCmV4cG9ydCBmdW5jdGlvbiBPblBsYXllckVudGVyVmVoaWNsZShldmVudFBsYXllcjogbW9kLlBsYXllciwgZXZlbnRWZWhpY2xlOiBtb2QuVmVoaWNsZSkgewogICAgaWYgKCFtb2QuSXNQbGF5ZXJWYWxpZChldmVudFBsYXllcikpIHJldHVybjsKCiAgICBjb25zdCB0ZWFtTnVtID0gZ2V0VGVhbU51bWJlcihtb2QuR2V0VGVhbShldmVudFBsYXllcikpOwogICAgaWYgKHRlYW1OdW0gIT09IFRlYW1JRC5UZWFtMSAmJiB0ZWFtTnVtICE9PSBUZWFtSUQuVGVhbTIpIHJldHVybjsKCiAgICBjb25zdCBpblQxID0gYXJyYXlDb250YWluc1ZlaGljbGUobW9kLkdldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTEpLCBldmVudFZlaGljbGUpOwogICAgY29uc3QgaW5UMiA9IGFycmF5Q29udGFpbnNWZWhpY2xlKG1vZC5HZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0yKSwgZXZlbnRWZWhpY2xlKTsKICAgIGNvbnN0IHdhc1JlZ2lzdGVyZWQgPSBpblQxIHx8IGluVDI7CgogICAgLy8gQ2FjaGVkIGxhc3QgZHJpdmVyIGZvciB0aGlzIHZlaGljbGUgKGlmIGFueSkuCiAgICBjb25zdCBwcmlvck93bmVyID0gZ2V0TGFzdERyaXZlcihldmVudFZlaGljbGUpOyAKCiAgICAvLyBPbmx5IHRydXN0IHRoZSBvd25lciBpZiB0aGUgcGxheWVyIGlzIHN0aWxsIHZhbGlkLgogICAgY29uc3QgcHJpb3JPd25lclZhbGlkID0gISFwcmlvck93bmVyICYmIG1vZC5Jc1BsYXllclZhbGlkKHByaW9yT3duZXIpOyAKCiAgICAvLyBTYW1lIHBsYXllciByZS1lbnRlcmluZyB0aGVpciBsYXN0LWRyaXZlbiB2ZWhpY2xlLgogICAgY29uc3QgaXNSZXR1cm5Ub1NhbWVPd25lciA9IHByaW9yT3duZXJWYWxpZCAmJiAoZ2V0T2JqSWQocHJpb3JPd25lcikgPT09IGdldE9iaklkKGV2ZW50UGxheWVyKSk7IAoKICAgIC8vIEN1cnJlbnQgcmVnaXN0cnkgdGVhbSBmb3IgdGhpcyB2ZWhpY2xlLCBpZiBhbnkuCiAgICBjb25zdCByZWdpc3RlcmVkVGVhbSA9IGluVDEgPyBUZWFtSUQuVGVhbTEgOiAoaW5UMiA/IFRlYW1JRC5UZWFtMiA6IDApOyAKCiAgICAvLyBUcmFuc2ZlciBvbiBtaXNzaW5nIG93bmVyIG9yIGNyb3NzLXRlYW0gcmVnaXN0cnkgbWlzbWF0Y2guCiAgICBjb25zdCBzaG91bGRUcmFuc2Zlck93bmVyc2hpcCA9ICFwcmlvck93bmVyVmFsaWQgfHwgKHJlZ2lzdGVyZWRUZWFtICE9PSAwICYmIHJlZ2lzdGVyZWRUZWFtICE9PSB0ZWFtTnVtKTsgCgogICAgLy8gUmVjb25jaWxlIGJhc2VsaW5lIHRlYW0gZm9yIHVub3duZWQgdmVoaWNsZXMgYmVmb3JlIGFwcGx5aW5nICJlbnRlciA9IGNsYWltL3N0ZWFsIi4KICAgIGlmICghcHJpb3JPd25lclZhbGlkKSB7CiAgICAgICAgY29uc3QgdmVoaWNsZU9iaklkID0gZ2V0T2JqSWQoZXZlbnRWZWhpY2xlKTsKICAgICAgICBsZXQgaW5mZXJyZWRCYXNlVGVhbSA9IHZlaGljbGVTcGF3bkJhc2VUZWFtQnlPYmpJZFt2ZWhpY2xlT2JqSWRdOwogICAgICAgIGlmIChpbmZlcnJlZEJhc2VUZWFtICE9PSBUZWFtSUQuVGVhbTEgJiYgaW5mZXJyZWRCYXNlVGVhbSAhPT0gVGVhbUlELlRlYW0yKSB7CiAgICAgICAgICAgIGluZmVycmVkQmFzZVRlYW0gPSBpbmZlckJhc2VUZWFtRnJvbVBvc2l0aW9uKG1vZC5HZXRPYmplY3RQb3NpdGlvbihldmVudFZlaGljbGUpKSBhcyBUZWFtSUQ7CiAgICAgICAgfQoKICAgICAgICBpZiAoaW5mZXJyZWRCYXNlVGVhbSA9PT0gVGVhbUlELlRlYW0xIHx8IGluZmVycmVkQmFzZVRlYW0gPT09IFRlYW1JRC5UZWFtMikgewogICAgICAgICAgICBjb25zdCByZWdpc3RlcmVkVGVhbSA9IGluVDEgPyBUZWFtSUQuVGVhbTEgOiAoaW5UMiA/IFRlYW1JRC5UZWFtMiA6IDApOwogICAgICAgICAgICBpZiAocmVnaXN0ZXJlZFRlYW0gIT09IGluZmVycmVkQmFzZVRlYW0pIHsKICAgICAgICAgICAgICAgIHJlZ2lzdGVyVmVoaWNsZVRvVGVhbShldmVudFZlaGljbGUsIGluZmVycmVkQmFzZVRlYW0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGlmIChzaG91bGRUcmFuc2Zlck93bmVyc2hpcCkgewogICAgICAgIHNldExhc3REcml2ZXIoZXZlbnRWZWhpY2xlLCBldmVudFBsYXllcik7CiAgICAgICAgcmVnaXN0ZXJWZWhpY2xlVG9UZWFtKGV2ZW50VmVoaWNsZSwgdGVhbU51bSk7CiAgICB9IGVsc2UgaWYgKCF3YXNSZWdpc3RlcmVkKSB7CiAgICAgICAgLy8gU2FmZXR5OiBlbnN1cmUgbWVtYmVyc2hpcCBleGlzdHMgZXZlbiBpZiB0aGUgcmVnaXN0cnkgZGVzeW5jZWQuCiAgICAgICAgcmVnaXN0ZXJWZWhpY2xlVG9UZWFtKGV2ZW50VmVoaWNsZSwgdGVhbU51bSk7CiAgICB9IGVsc2UgaWYgKCFpc1JldHVyblRvU2FtZU93bmVyKSB7CiAgICAgICAgLy8gU2FtZS10ZWFtIHBhc3NlbmdlciBlbnRyeToga2VlcCBjdXJyZW50IG93bmVyIGFuZCBhdm9pZCBub2lzeSBtZXNzYWdpbmcuCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHRlYW1OYW1lS2V5ID0gZ2V0VGVhbU5hbWVLZXkodGVhbU51bSk7CgogICAgLy9TZW5kIG5vdGlmaWNhdGlvbnMgYXJvdW5kIGRpZmZlcmVudCB2ZWhpY2xlIHJlZ2lzdHJhdGlvbiBldmVudHMgc28gcGxheWVycyBjYW4gc3BvdCBrbm93biBpc3N1ZSB3aXRoIFZlaGljbGUgUmVnaXN0cmF0aW9ucwogICAgaWYgKCF3YXNSZWdpc3RlcmVkKSB7IC8vTmV3IFZlaGljbGUKICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy52ZWhpY2xlUmVnaXN0ZXJlZE5ldywgdGVhbU5hbWVLZXksIGV2ZW50UGxheWVyKSwgCiAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgIG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMSkKICAgICAgICApOwogICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnZlaGljbGVSZWdpc3RlcmVkTmV3LCB0ZWFtTmFtZUtleSwgZXZlbnRQbGF5ZXIpLCAKICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgbW9kLkdldFRlYW0oVGVhbUlELlRlYW0yKQogICAgICAgICk7CiAgICB9IGVsc2UgaWYgKGlzUmV0dXJuVG9TYW1lT3duZXIpIHsgLy9PbGQgVmVoaWNsZSBTYW1lIFBsYXllcgogICAgICAgIGNvbnN0IG1lc3NhZ2VLZXkgPSAocmVnaXN0ZXJlZFRlYW0gIT09IDAgJiYgcmVnaXN0ZXJlZFRlYW0gIT09IHRlYW1OdW0pCiAgICAgICAgICAgID8gU1RSX1ZFSElDTEVfU1RPTEVOX1JFR0lTVEVSCiAgICAgICAgICAgIDogbW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnZlaGljbGVSZXR1cm5lZDsKICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1lc3NhZ2VLZXksIGV2ZW50UGxheWVyLCB0ZWFtTmFtZUtleSksIAogICAgICAgICAgICB0cnVlLAogICAgICAgICAgICBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTEpCiAgICAgICAgKTsKICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1lc3NhZ2VLZXksIGV2ZW50UGxheWVyLCB0ZWFtTmFtZUtleSksIAogICAgICAgICAgICB0cnVlLAogICAgICAgICAgICBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTIpCiAgICAgICAgKTsKICAgIH0gZWxzZSB7IC8vT2xkIFZlaGljbGUgRGlmZmVyZW50IFBsYXllcgogICAgICAgIGNvbnN0IG1lc3NhZ2VLZXkgPSAocmVnaXN0ZXJlZFRlYW0gIT09IDAgJiYgcmVnaXN0ZXJlZFRlYW0gIT09IHRlYW1OdW0pCiAgICAgICAgICAgID8gU1RSX1ZFSElDTEVfU1RPTEVOX1JFR0lTVEVSCiAgICAgICAgICAgIDogbW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnZlaGljbGVSZVJlZ2lzdGVyZWQ7CiAgICAgICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgICAgICBtb2QuTWVzc2FnZShtZXNzYWdlS2V5LCB0ZWFtTmFtZUtleSwgZXZlbnRQbGF5ZXIpLCAKICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgbW9kLkdldFRlYW0oVGVhbUlELlRlYW0xKQogICAgICAgICk7CiAgICAgICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgICAgICBtb2QuTWVzc2FnZShtZXNzYWdlS2V5LCB0ZWFtTmFtZUtleSwgZXZlbnRQbGF5ZXIpLCAKICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgbW9kLkdldFRlYW0oVGVhbUlELlRlYW0yKQogICAgICAgICk7CiAgICB9Cn0KCi8vIE9uVmVoaWNsZVNwYXduZWQ6Ci8vIFJlZ2lzdGVycyBhIHNwYXduZWQgdmVoaWNsZSB0byB0aGUgbmVhcmVzdCBtYWluIGJhc2UgdGVhbSB1c2luZyBpdHMgd29ybGQgcG9zaXRpb24uCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBPblZlaGljbGVTcGF3bmVkKGV2ZW50VmVoaWNsZTogbW9kLlZlaGljbGUpOiBQcm9taXNlPHZvaWQ+IHsKICAgIC8vIEJpbmQgdmVoaWNsZSB0byBhIHNwYXduZXIgc2xvdCBmaXJzdDsgZmFsbCBiYWNrIHRvIGJhc2UgaW5mZXJlbmNlIGlmIG5vdCBzcGF3bmVkIGJ5IG91ciBzcGF3bmVycy4KICAgIGNvbnN0IHBvc09iamVjdCA9IG1vZC5HZXRPYmplY3RQb3NpdGlvbihldmVudFZlaGljbGUpOwogICAgbGV0IHNsb3RJbmRleCA9IC0xOwogICAgY29uc3QgYWN0aXZlSW5kZXggPSBTdGF0ZS52ZWhpY2xlcy5hY3RpdmVTcGF3blNsb3RJbmRleDsKICAgIGNvbnN0IGFjdGl2ZVRva2VuID0gU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25Ub2tlbjsKICAgIGNvbnN0IGFjdGl2ZUF0ID0gU3RhdGUudmVoaWNsZXMuYWN0aXZlU3Bhd25SZXF1ZXN0ZWRBdFNlY29uZHM7CiAgICBpZiAoYWN0aXZlSW5kZXggIT09IHVuZGVmaW5lZCAmJiBhY3RpdmVUb2tlbiAhPT0gdW5kZWZpbmVkICYmIGFjdGl2ZUF0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKG1vZC5HZXRNYXRjaFRpbWVFbGFwc2VkKCkpOwogICAgICAgIGNvbnN0IGV4cGlyZWQgPSAobm93IC0gYWN0aXZlQXQpID4gVkVISUNMRV9TUEFXTkVSX0JJTkRfVElNRU9VVF9TRUNPTkRTOwogICAgICAgIGNvbnN0IGFjdGl2ZVNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1thY3RpdmVJbmRleF07CiAgICAgICAgaWYgKCFleHBpcmVkICYmIGFjdGl2ZVNsb3QgJiYgYWN0aXZlU2xvdC5leHBlY3RpbmdTcGF3biAmJiBhY3RpdmVTbG90LnNwYXduUmVxdWVzdFRva2VuID09PSBhY3RpdmVUb2tlbikgewogICAgICAgICAgICBzbG90SW5kZXggPSBhY3RpdmVJbmRleDsKICAgICAgICB9CiAgICB9CiAgICBpZiAoc2xvdEluZGV4ID09PSAtMSkgewogICAgICAgIHNsb3RJbmRleCA9IGZpbmRTcGF3bmVyU2xvdEJ5UG9zaXRpb24ocG9zT2JqZWN0KTsKICAgIH0KICAgIGlmIChzbG90SW5kZXggPj0gMCkgewogICAgICAgIGNvbnN0IHNsb3QgPSBTdGF0ZS52ZWhpY2xlcy5zbG90c1tzbG90SW5kZXhdOwogICAgICAgIGlmICghc2xvdC5lbmFibGVkKSB7CiAgICAgICAgICAgIG1vZC5VbnNwYXduT2JqZWN0KGV2ZW50VmVoaWNsZSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCFzbG90LmV4cGVjdGluZ1NwYXduICYmIHNsb3QudmVoaWNsZUlkID09PSAtMSkgewogICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBzcGF3bmVyJ3MgaW5pdGlhbCBkZWZhdWx0IHNwYXduIHdpdGggYSBmb3JjZWQgc3Bhd24gdXNpbmcgdGhlIGNvbmZpZ3VyZWQgdHlwZS4KICAgICAgICAgICAgbW9kLlVuc3Bhd25PYmplY3QoZXZlbnRWZWhpY2xlKTsKICAgICAgICAgICAgYXdhaXQgbW9kLldhaXQoMC4xKTsgLy8gR2l2ZSB0aGUgZW5naW5lIGEgbW9tZW50IHRvIGNsZWFyIHRoZSBzcGF3biBiZWZvcmUgZm9yY2luZyBhZ2Fpbi4KICAgICAgICAgICAgY29uZmlndXJlVmVoaWNsZVNwYXduZXIoc2xvdC5zcGF3bmVyLCBzbG90LnZlaGljbGVUeXBlKTsKICAgICAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IGZvcmNlU3Bhd25XaXRoUmV0cnkoc2xvdEluZGV4KTsKICAgICAgICAgICAgaWYgKCFzdWNjZXNzKSB7CiAgICAgICAgICAgICAgICB2b2lkIHNjaGVkdWxlQmxvY2tlZFNwYXduUmV0cnkoc2xvdEluZGV4KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQogICAgCiAgICAvLyBQcmltYXJ5IHBhdGg6IGJpbmQgdG8gYSBzcGF3bmVyIHNsb3QgdGhhdCBpcyBleHBlY3RpbmcgdGhpcyBzcGF3bi4KICAgIGxldCBpbmZlcnJlZFRlYW0gPSBiaW5kU3Bhd25lZFZlaGljbGVUb1Nsb3QoZXZlbnRWZWhpY2xlLCBwb3NPYmplY3QpOwoKICAgIGlmIChpbmZlcnJlZFRlYW0gPT09IDApIHsKICAgICAgICAvLyBSZXRyeSBvbmNlIGFmdGVyIGEgc2hvcnQgZGVsYXkgaW4gY2FzZSB0aGUgc3Bhd24gcG9zaXRpb24gaGFzbid0IHNldHRsZWQgeWV0LgogICAgICAgIGF3YWl0IG1vZC5XYWl0KDAuMik7CiAgICAgICAgY29uc3QgcG9zUmV0cnkgPSBtb2QuR2V0T2JqZWN0UG9zaXRpb24oZXZlbnRWZWhpY2xlKTsKICAgICAgICBpbmZlcnJlZFRlYW0gPSBiaW5kU3Bhd25lZFZlaGljbGVUb1Nsb3QoZXZlbnRWZWhpY2xlLCBwb3NSZXRyeSk7CiAgICB9CgogICAgY29uc3QgcG9zID0gbW9kLkdldFZlaGljbGVTdGF0ZShldmVudFZlaGljbGUsIG1vZC5WZWhpY2xlU3RhdGVWZWN0b3IuVmVoaWNsZVBvc2l0aW9uKTsKICAgIGNvbnN0IHZlaGljbGVPYmpJZCA9IGdldE9iaklkKGV2ZW50VmVoaWNsZSk7CgogICAgaWYgKGluZmVycmVkVGVhbSA9PT0gMCkgewogICAgICAgIC8vIEZhbGxiYWNrIHBhdGg6IGFzc2lnbiB0byB0aGUgbmVhcmVzdCBtYWluIGJhc2UgaWYgd2l0aGluIGJpbmQgcmFkaXVzLgogICAgICAgIGluZmVycmVkVGVhbSA9IGluZmVyQmFzZVRlYW1Gcm9tUG9zaXRpb24ocG9zKTsKCiAgICAgICAgLy8gSWYgdGhlIHNwYXduIG1hdGNoZWQgYSBrbm93biBzcGF3bmVyIGJ1dCBmYWlsZWQgdG8gYmluZCwgYmluZCB0aGUgc2xvdCBleHBsaWNpdGx5LgogICAgICAgIGlmIChzbG90SW5kZXggPj0gMCkgewogICAgICAgICAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbc2xvdEluZGV4XTsKICAgICAgICAgICAgaWYgKHNsb3QgJiYgc2xvdC5lbmFibGVkICYmIHNsb3QudmVoaWNsZUlkID09PSAtMSkgewogICAgICAgICAgICAgICAgc2xvdC5leHBlY3RpbmdTcGF3biA9IGZhbHNlOwogICAgICAgICAgICAgICAgc2xvdC52ZWhpY2xlSWQgPSB2ZWhpY2xlT2JqSWQ7CiAgICAgICAgICAgICAgICBzbG90LnJlc3Bhd25SdW5uaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBzbG90LnNwYXduUmV0cnlTY2hlZHVsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIFN0YXRlLnZlaGljbGVzLnZlaGljbGVUb1Nsb3RbdmVoaWNsZU9iaklkXSA9IHNsb3RJbmRleDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLyBCYWlsIG91dCBpZiB0aGUgdmVoaWNsZSBkaWRuJ3Qgc3Bhd24gbmVhciBhIGtub3duIHRlYW0gYmFzZSAoa2VlcHMgcmVnaXN0cmF0aW9uIGNsZWFuKS4KICAgIGlmIChpbmZlcnJlZFRlYW0gIT09IFRlYW1JRC5UZWFtMSAmJiBpbmZlcnJlZFRlYW0gIT09IFRlYW1JRC5UZWFtMikgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAvLyBDYWNoZSBiYXNlLXRlYW0gaW5mZXJlbmNlIGZvciBsYXRlciByZWNvbmNpbGlhdGlvbiBvbiBlbnRlci4KICAgIHZlaGljbGVTcGF3bkJhc2VUZWFtQnlPYmpJZFt2ZWhpY2xlT2JqSWRdID0gaW5mZXJyZWRUZWFtOyAKCiAgICAvLyBSZXNldCBjYWNoZWQgb3duZXIgc28gZW50ZXIgZXZlbnRzIGNhbiBlc3RhYmxpc2ggYSBuZXcgb3duZXIuCiAgICBjbGVhckxhc3REcml2ZXJCeVZlaGljbGVPYmpJZCh2ZWhpY2xlT2JqSWQpOyAKCiAgICAvLyBTcGF3bi10aW1lIHJlZ2lzdHJhdGlvbiBpcyBhdXRob3JpdGF0aXZlIG9ubHkgYWZ0ZXIgYSBzbG90IGJpbmRzIChiZWZvcmUgYW55IHBsYXllciBlbnRlcnMpLgogICAgcmVnaXN0ZXJWZWhpY2xlVG9UZWFtKGV2ZW50VmVoaWNsZSwgaW5mZXJyZWRUZWFtKTsKCiAgICBjb25zdCB0ZWFtTmFtZUtleSA9IGdldFRlYW1OYW1lS2V5KGluZmVycmVkVGVhbSk7CiAgICBjb25zdCB4ID0gTWF0aC5mbG9vcihtb2QuWENvbXBvbmVudE9mKHBvcykpOwogICAgY29uc3QgeiA9IE1hdGguZmxvb3IobW9kLlpDb21wb25lbnRPZihwb3MpKTsKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMudmVoaWNsZVNwYXduZWQsIHRlYW1OYW1lS2V5LCB4LCB6KSwKICAgICAgICB0cnVlCiAgICApOwp9CgovLyBPblZlaGljbGVEZXN0cm95ZWQ6Ci8vIEhhbmRsZXMgdmVoaWNsZS1kZXN0cnVjdGlvbiBzY29yaW5nIGxvZ2ljLgovLyBJZiB0aGUgZGVzdHJveWVkIHZlaGljbGUgaXMgcmVnaXN0ZXJlZCB0byBhIHRlYW0gQU5EIHRoZSByb3VuZCBpcyBMSVZFOgovLyAtIEF3YXJkICsxIFJvdW5kIEtpbGwgdG8gdGhlIG9wcG9zaW5nIHRlYW0uCi8vIC0gRW1pdCBpbmZvcm1hdGlvbmFsIHdvcmxkIGxvZyBtZXNzYWdlcy4KLy8gSWYgdGhlIHJvdW5kIGlzIG5vdCBsaXZlOgovLyAtIE5vIHBvaW50cyBhcmUgYXdhcmRlZDsgdGhlIHZlaGljbGUgaXMgc2ltcGx5IGRlcmVnaXN0ZXJlZC4KLy8gSW1wb3J0YW50OgovLyAtIEluZmFudHJ5IGRlYXRocyBhcmUgaWdub3JlZCBlbnRpcmVseS4KLy8gLSBUaGlzIGZ1bmN0aW9uIGlzIHRoZSBPTkxZIHBsYWNlIHJvdW5kIHZlaGljbGUga2lsbHMgYXJlIGF3YXJkZWQuCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBPblZlaGljbGVEZXN0cm95ZWQoZXZlbnRWZWhpY2xlOiBtb2QuVmVoaWNsZSkgewogICAgY29uc3QgaW5UMSA9IGFycmF5Q29udGFpbnNWZWhpY2xlKG1vZC5HZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0xKSwgZXZlbnRWZWhpY2xlKTsKICAgIGNvbnN0IGluVDIgPSBhcnJheUNvbnRhaW5zVmVoaWNsZShtb2QuR2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMiksIGV2ZW50VmVoaWNsZSk7CgogICAgaWYgKCFpblQxICYmICFpblQyKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGRlc3Ryb3llZFRlYW1OdW0gPSBpblQxID8gVGVhbUlELlRlYW0xIDogVGVhbUlELlRlYW0yOwogICAgY29uc3Qgc2NvcmluZ1RlYW1OdW0gPSBvcHBvc2luZ1RlYW0oZGVzdHJveWVkVGVhbU51bSk7CgogICAgaWYgKGlzUm91bmRMaXZlKCkpIHsKICAgICAgICBjb25zdCB2ZWhpY2xlT2JqSWQgPSBnZXRPYmpJZChldmVudFZlaGljbGUpOwogICAgICAgIC8vIE5PVEU6IHZlaGljbGVUb1Nsb3QgY2FuIGJlIGNsZWFyZWQgYnkgdGhlIHNwYXduZXIgcG9sbCBsb29wICgxcyB0aWNrKSBiZWZvcmUgdGhpcyBydW5zLgogICAgICAgIC8vIElmIHRoYXQgaGFwcGVucywgdGhlIGNhbXBlZCBsb2cgbWF5IGJlIHNraXBwZWQgZm9yIHRoYXQgZGVzdHJ1Y3Rpb24uCiAgICAgICAgY29uc3Qgc2xvdEluZGV4ID0gU3RhdGUudmVoaWNsZXMudmVoaWNsZVRvU2xvdFt2ZWhpY2xlT2JqSWRdOwogICAgICAgIGxldCB3YXNTcGF3bkNhbXBlZCA9IGZhbHNlOwogICAgICAgIGlmIChzbG90SW5kZXggIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb25zdCBzbG90ID0gU3RhdGUudmVoaWNsZXMuc2xvdHNbc2xvdEluZGV4XTsKICAgICAgICAgICAgaWYgKHNsb3QpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHNwYXduZXJQb3MgPSBzbG90LnNwYXduUG9zOwogICAgICAgICAgICAgICAgY29uc3QgZGVhdGhQb3MgPSBtb2QuR2V0VmVoaWNsZVN0YXRlKGV2ZW50VmVoaWNsZSwgbW9kLlZlaGljbGVTdGF0ZVZlY3Rvci5WZWhpY2xlUG9zaXRpb24pOwogICAgICAgICAgICAgICAgY29uc3QgZmFsbGJhY2tQb3MgPSBtb2QuR2V0T2JqZWN0UG9zaXRpb24oZXZlbnRWZWhpY2xlKTsKICAgICAgICAgICAgICAgIGxldCByZXNvbHZlZFBvcyA9IGRlYXRoUG9zOwogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIG1vZC5YQ29tcG9uZW50T2YoZGVhdGhQb3MpID09PSAwICYmCiAgICAgICAgICAgICAgICAgICAgbW9kLllDb21wb25lbnRPZihkZWF0aFBvcykgPT09IDAgJiYKICAgICAgICAgICAgICAgICAgICBtb2QuWkNvbXBvbmVudE9mKGRlYXRoUG9zKSA9PT0gMAogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRQb3MgPSBmYWxsYmFja1BvczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IGQgPSBtb2QuRGlzdGFuY2VCZXR3ZWVuKHJlc29sdmVkUG9zLCBzcGF3bmVyUG9zKTsKICAgICAgICAgICAgICAgIGlmIChkIDw9IFZFSElDTEVfQ0FNUEVEX0RJU1RBTkNFX01FVEVSUykgewogICAgICAgICAgICAgICAgICAgIHdhc1NwYXduQ2FtcGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZWFtTmFtZUtleSA9IGdldFRlYW1OYW1lS2V5KGRlc3Ryb3llZFRlYW1OdW0pOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHggPSBNYXRoLmZsb29yKG1vZC5YQ29tcG9uZW50T2YocmVzb2x2ZWRQb3MpKTsKICAgICAgICAgICAgICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy52ZWhpY2xlQ2FtcGVkSW5NYWluQmFzZSwgdGVhbU5hbWVLZXksIHgpLAogICAgICAgICAgICAgICAgICAgICAgICB0cnVlCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCF3YXNTcGF3bkNhbXBlZCkgewogICAgICAgICAgICBpZiAoc2NvcmluZ1RlYW1OdW0gPT09IFRlYW1JRC5UZWFtMSkgewogICAgICAgICAgICAgICAgU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscyA9IFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgKyAxOwogICAgICAgICAgICB9IGVsc2UgaWYgKHNjb3JpbmdUZWFtTnVtID09PSBUZWFtSUQuVGVhbTIpIHsKICAgICAgICAgICAgICAgIFN0YXRlLnNjb3Jlcy50MlJvdW5kS2lsbHMgPSBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzICsgMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gVXBkYXRlIHJvdW5kIGtpbGxzIEhVRCBpbW1lZGlhdGVseS4KICAgICAgICAgICAgc3luY1JvdW5kS2lsbHNIdWQoKTsKCiAgICAgICAgICAgIC8vIEVuZCB0aGUgcm91bmQgaW1tZWRpYXRlbHkgaWYgYSB0ZWFtIHJlYWNoZXMgdGhlIGNvbmZpZ3VyZWQgcm91bmQta2lsbHMgdGFyZ2V0LgogICAgICAgICAgICBpZiAoU3RhdGUuc2NvcmVzLnQxUm91bmRLaWxscyA+PSBTdGF0ZS5yb3VuZC5raWxsc1RhcmdldCB8fCBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzID49IFN0YXRlLnJvdW5kLmtpbGxzVGFyZ2V0KSB7CiAgICAgICAgICAgICAgICBlbmRSb3VuZCh1bmRlZmluZWQsIGdldFJlbWFpbmluZ1NlY29uZHMoKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChzY29yaW5nVGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSB7CiAgICAgICAgICAgICAgICBTdGF0ZS5zY29yZXMudDFUb3RhbEtpbGxzID0gTWF0aC5mbG9vcihTdGF0ZS5zY29yZXMudDFUb3RhbEtpbGxzKSArIDE7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2NvcmluZ1RlYW1OdW0gPT09IFRlYW1JRC5UZWFtMikgewogICAgICAgICAgICAgICAgU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscyA9IE1hdGguZmxvb3IoU3RhdGUuc2NvcmVzLnQyVG90YWxLaWxscykgKyAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBVcGRhdGUgdG9wIEhVRCBraWxscyBjb3VudGVycy4KICAgICAgICAgICAgc3luY0tpbGxzSHVkRnJvbVRyYWNrZWRUb3RhbHMoZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgbW9kLlNldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTEsIGFycmF5UmVtb3ZlVmVoaWNsZShtb2QuR2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMSksIGV2ZW50VmVoaWNsZSkpOwogICAgICAgIG1vZC5TZXRWYXJpYWJsZShyZWdWZWhpY2xlc1RlYW0yLCBhcnJheVJlbW92ZVZlaGljbGUobW9kLkdldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTIpLCBldmVudFZlaGljbGUpKTsKCiAgICAgICAgY29uc3Qgb3duZXIgPSBwb3BMYXN0RHJpdmVyKGV2ZW50VmVoaWNsZSk7CgogICAgICAgIGF3YWl0IG1vZC5XYWl0KDMuMCk7CgogICAgICAgIGlmICghd2FzU3Bhd25DYW1wZWQpIHsKICAgICAgICAgICAgY29uc3Qgcm91bmRLaWxscyA9IChzY29yaW5nVGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSA/IFN0YXRlLnNjb3Jlcy50MVJvdW5kS2lsbHMgOiBTdGF0ZS5zY29yZXMudDJSb3VuZEtpbGxzOwogICAgICAgICAgICBjb25zdCB0ZWFtTmFtZUtleSA9IChzY29yaW5nVGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSA/IGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMSkgOiBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTIpOwogICAgICAgICAgICBjb25zdCBvd25lck5hbWVPcktleSA9IG93bmVyID8gb3duZXIgOiBtb2Quc3RyaW5na2V5cy50d2wuc3lzdGVtLnVuYXNzaWduZWQ7CgogICAgICAgICAgICBzZW5kSGlnaGxpZ2h0ZWRXb3JsZExvZ01lc3NhZ2UoCiAgICAgICAgICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMucG9pbnRBd2FyZGVkV2l0aE93bmVyLCB0ZWFtTmFtZUtleSwgb3duZXJOYW1lT3JLZXksIE1hdGguZmxvb3Iocm91bmRLaWxscykpLAogICAgICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgICAgIG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMSkKICAgICAgICAgICAgKTsKICAgICAgICAgICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgICAgICAgICAgbW9kLk1lc3NhZ2UobW9kLnN0cmluZ2tleXMudHdsLm1lc3NhZ2VzLnBvaW50QXdhcmRlZFdpdGhPd25lciwgdGVhbU5hbWVLZXksIG93bmVyTmFtZU9yS2V5LCBNYXRoLmZsb29yKHJvdW5kS2lsbHMpKSwKICAgICAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgICAgICBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTIpCiAgICAgICAgICAgICk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm47CiAgICB9CgogICAgLy8gUm91bmQgaXMgbm90IGxpdmU6IGNsZWFuIHVwIHJlZ2lzdHJhdGlvbiwgYnV0IGRvIG5vdCBhd2FyZCBwb2ludHMgb3IgaW5jcmVtZW50IGNvdW50ZXJzLgogICAgbW9kLlNldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTEsIGFycmF5UmVtb3ZlVmVoaWNsZShtb2QuR2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMSksIGV2ZW50VmVoaWNsZSkpOwogICAgbW9kLlNldFZhcmlhYmxlKHJlZ1ZlaGljbGVzVGVhbTIsIGFycmF5UmVtb3ZlVmVoaWNsZShtb2QuR2V0VmFyaWFibGUocmVnVmVoaWNsZXNUZWFtMiksIGV2ZW50VmVoaWNsZSkpOwoKICAgIGNvbnN0IG93bmVyID0gcG9wTGFzdERyaXZlcihldmVudFZlaGljbGUpOwoKICAgIGF3YWl0IG1vZC5XYWl0KDMuMCk7CgogICAgY29uc3QgZGVzdHJveWVkVGVhbU5hbWVLZXkgPSAoZGVzdHJveWVkVGVhbU51bSA9PT0gVGVhbUlELlRlYW0xKSA/IGdldFRlYW1OYW1lS2V5KFRlYW1JRC5UZWFtMSkgOiBnZXRUZWFtTmFtZUtleShUZWFtSUQuVGVhbTIpOwogICAgY29uc3Qgb3duZXJOYW1lT3JLZXkgPSBvd25lciA/IG93bmVyIDogbW9kLnN0cmluZ2tleXMudHdsLnN5c3RlbS51bmFzc2lnbmVkOwoKICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZSgKICAgICAgICBtb2QuTWVzc2FnZShtb2Quc3RyaW5na2V5cy50d2wubWVzc2FnZXMudmVoaWNsZURlc3Ryb3llZE5vdExpdmUsIG93bmVyTmFtZU9yS2V5LCBkZXN0cm95ZWRUZWFtTmFtZUtleSksCiAgICAgICAgdHJ1ZSwKICAgICAgICBtb2QuR2V0VGVhbShUZWFtSUQuVGVhbTEpCiAgICApOwogICAgc2VuZEhpZ2hsaWdodGVkV29ybGRMb2dNZXNzYWdlKAogICAgICAgIG1vZC5NZXNzYWdlKG1vZC5zdHJpbmdrZXlzLnR3bC5tZXNzYWdlcy52ZWhpY2xlRGVzdHJveWVkTm90TGl2ZSwgb3duZXJOYW1lT3JLZXksIGRlc3Ryb3llZFRlYW1OYW1lS2V5KSwKICAgICAgICB0cnVlLAogICAgICAgIG1vZC5HZXRUZWFtKFRlYW1JRC5UZWFtMikKICAgICk7Cn0KCi8vI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLSBFeHBvcnRlZCBFdmVudCBIYW5kbGVycyAoc2luZ2xlIGV4cG9ydHMpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCi8vI3JlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLSBNYWluIEJhc2UgLSBFbnRlci9FeGl0IFRyaWdnZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgpleHBvcnQgZnVuY3Rpb24gT25QbGF5ZXJFbnRlckFyZWFUcmlnZ2VyKGV2ZW50UGxheWVyOiBtb2QuUGxheWVyLCBldmVudEFyZWFUcmlnZ2VyOiBtb2QuQXJlYVRyaWdnZXIpIHsKICAgIGlmICghZXZlbnRQbGF5ZXIpIHJldHVybjsKCiAgICBpZiAoSXNQbGF5ZXJJbk93bk1haW5CYXNlKGV2ZW50UGxheWVyLCBldmVudEFyZWFUcmlnZ2VyKSkgewogICAgICAgIC8vIHRyYWNrIHBlci1wbGF5ZXIgbWFpbiBiYXNlIHN0YXRlIGZvciBVSSBkaXNwbGF5IChhdXRob3JpdGF0aXZlIGdhdGluZyBjb21lcyBsYXRlcikuCiAgICAgICAgU3RhdGUucGxheWVycy5pbk1haW5CYXNlQnlQaWRbbW9kLkdldE9iaklkKGV2ZW50UGxheWVyKV0gPSB0cnVlOwogICAgICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yQWxsVmlzaWJsZVZpZXdlcnMoKTsKICAgICAgICBCcm9hZGNhc3RNYWluQmFzZUV2ZW50KG1vZC5NZXNzYWdlKFNUUl9FTlRFUkVEX01BSU5fQkFTRSwgZXZlbnRQbGF5ZXIpKTsKICAgICAgICBSZXN0b2NrR2FkZ2V0QW1tbyhldmVudFBsYXllciwgUkVTVE9DS19NQUdfQU1NT19FTlRFUik7CiAgICAgICAgTm90aWZ5QW1tb1Jlc3RvY2tlZChldmVudFBsYXllcik7CiAgICB9Cn0KCmV4cG9ydCBmdW5jdGlvbiBPblBsYXllckV4aXRBcmVhVHJpZ2dlcihldmVudFBsYXllcjogbW9kLlBsYXllciwgZXZlbnRBcmVhVHJpZ2dlcjogbW9kLkFyZWFUcmlnZ2VyKSB7CiAgICBpZiAoIWV2ZW50UGxheWVyKSByZXR1cm47CgogICAgaWYgKCFpc1BsYXllckRlcGxveWVkKGV2ZW50UGxheWVyKSkgcmV0dXJuOwoKICAgIGlmIChJc1BsYXllckluT3duTWFpbkJhc2UoZXZlbnRQbGF5ZXIsIGV2ZW50QXJlYVRyaWdnZXIpKSB7CiAgICAgICAgU3RhdGUucGxheWVycy5pbk1haW5CYXNlQnlQaWRbbW9kLkdldE9iaklkKGV2ZW50UGxheWVyKV0gPSBmYWxzZTsKICAgICAgICAvLyBQcmUtcm91bmQgZ2F0aW5nOjogaWYgdGhlIHJvdW5kIGlzIE5PVCBhY3RpdmUsIGxlYXZpbmcgdGhlIG1haW4gYmFzZSBmb3JjZXMgdGhlIHBsYXllciBiYWNrIHRvIE5PVCBSRUFEWS4KICAgICAgICBpZiAoIWlzUm91bmRMaXZlKCkpIHsKICAgICAgICAgICAgU3RhdGUucGxheWVycy5yZWFkeUJ5UGlkW21vZC5HZXRPYmpJZChldmVudFBsYXllcildID0gZmFsc2U7CiAgICAgICAgICAgIC8vIEtlZXAgdGhlIEhVRCAiWCAvIFkgUExBWUVSUyBSRUFEWSIgbGluZSBpbiBzeW5jIHdoZW4gbGVhdmluZyBtYWluIGJhc2UgZm9yY2VzIE5PVCBSRUFEWS4KICAgICAgICAgICAgdXBkYXRlUGxheWVyc1JlYWR5SHVkVGV4dEZvckFsbFBsYXllcnMoKTsKICAgICAgICAgICAgaWYgKFN0YXRlLnJvdW5kLmNvdW50ZG93bi5pc1JlcXVlc3RlZCkgewogICAgICAgICAgICAgICAgY2FuY2VsUHJlZ2FtZUNvdW50ZG93bigpOwogICAgICAgICAgICAgICAgdm9pZCBzaG93T3ZlckxpbmVNZXNzYWdlRm9yQWxsUGxheWVycyhldmVudFBsYXllcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gUGxheWVyLW9ubHkgd2FybmluZzogdGhleSB3ZXJlIHJlYWR5LCBidXQgbGVmdCBtYWluIGJhc2UgYmVmb3JlIHRoZSByb3VuZCB3ZW50IGxpdmUuCiAgICAgICAgICAgIC8vIFRoaXMgaXMgaW50ZW50aW9uYWxseSBub3QgYnJvYWRjYXN0IGdsb2JhbGx5OyBpdCBpcyBhY3Rpb25hYmxlIGd1aWRhbmNlIGZvciB0aGUgaW5kaXZpZHVhbCBwbGF5ZXIuCiAgICAgICAgICAgIHNlbmRIaWdobGlnaHRlZFdvcmxkTG9nTWVzc2FnZShtb2QuTWVzc2FnZShTVFJfUkVBRFlVUF9SRVRVUk5fVE9fQkFTRV9OT1RfTElWRSwgTWF0aC5mbG9vcihTdGF0ZS5yb3VuZC5jdXJyZW50KSksIGZhbHNlLCBldmVudFBsYXllcik7CiAgICAgICAgfQogICAgICAgIHJlbmRlclJlYWR5RGlhbG9nRm9yQWxsVmlzaWJsZVZpZXdlcnMoKTsKICAgICAgICBCcm9hZGNhc3RNYWluQmFzZUV2ZW50KG1vZC5NZXNzYWdlKFNUUl9FWElURURfTUFJTl9CQVNFLCBldmVudFBsYXllcikpOwogICAgICAgIFJlc3RvY2tHYWRnZXRBbW1vKGV2ZW50UGxheWVyLCBSRVNUT0NLX01BR19BTU1PX0VYSVQpOwogICAgICAgIE5vdGlmeUFtbW9SZXN0b2NrZWQoZXZlbnRQbGF5ZXIpOwogICAgfQp9CgovLyNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0gTWFpbiBCYXNlIC0gRW50ZXIvRXhpdCBUcmlnZ2VycyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKLy8gRU9GIHZlcnNpb246IDAuMjU5IHwgRGF0ZTogMDEuMDMuMjYgfCBUaW1lOiAyMTo0NiBVVEMK","compiled":""},"attachmentType":2,"errors":[]},{"id":"f0022aff-50a7-438b-a825-31f3cde558e6","version":"345","filename":"Strings.json","isProcessable":false,"processingStatus":2,"attachmentData":{"original":"eyJ0d2wiOnsic3lzdGVtIjp7ImdlbmVyaWNDb3VudGVyIjoiezB9Iiwic2xhc2giOiIvIiwidW5rbm93blBsYXllciI6IlVua25vd24iLCJ1bmFzc2lnbmVkIjoiVW5hc3NpZ25lZCJ9LCJodWQiOnsiYnJhbmRpbmciOnsidGl0bGUiOiJ0ZWFtd2FyZmFyZSAuIG5ldCB8IFRXTCBUYW5rcyAodjAuMjU5KSIsInN1YnRpdGxlIjoiRXhwZXJpZW5jZSBDb2RlOiBaTUM1UCJ9LCJyb3VuZFRleHQiOiJST1VORCIsImhlbHBUZXh0IjoiUmVhZHkgdXAhIChUcmlwbGUgdGFwIHlvdXIgaW50ZXJhY3Qga2V5YmluZCB0byBzaG93IFJlYWR5IERpYWxvZyBhbmQgTWF0Y2ggU2V0dGluZ3MpIiwibGFiZWxzIjp7InRvdGFsS2lsbHMiOiJUb3RhbCBLaWxscyIsInJvdW5kS2lsbHMiOiJSb3VuZCBLaWxscyIsInJvdW5kV2lucyI6IlJvdW5kIFdpbnMifSwicm91bmRTdGF0ZUZvcm1hdCI6InswfSB7MX0gezJ9Iiwicm91bmRTdGF0ZUxpdmUiOiJMSVZFIiwicm91bmRTdGF0ZU5vdFJlYWR5IjoiTk9UIFJFQURZIiwicm91bmRTdGF0ZUdhbWVPdmVyIjoiR0FNRSBPVkVSIiwicm91bmRSZWNvcmRGb3JtYXQiOiJ7MH0gLSB7MX0gLSB7Mn0iLCJyb3VuZExpdmVIZWxwRm9ybWF0IjoiRmlyc3QgdG8gezB9IFZlaGljbGUgS2lsbHMgV2lucyB0aGUgUm91bmQiLCJwbGF5ZXJzUmVhZHlGb3JtYXQiOiJ7MH0gLyB7MX0gUExBWUVSUyBSRUFEWSIsImNsb2NrIjp7ImRpZ2l0IjoiezB9IiwiY29sb24iOiI6In19LCJyb3VuZEVuZCI6eyJkcmF3IjoiRFJBVyIsInJvdW5kTnVtYmVyIjoiUk9VTkQgezB9In0sIm92ZXJMaW5lIjp7InRpdGxlIjoiezB9IElTIE9WRVIgVEhFIExJTkUhIiwic3VidGl0bGUiOiJFdmVyeW9uZSBtdXN0IHJldHVybiB0byB0aGVpciBtYWluIGJhc2UgYW5kIHJlYWR5IGJhY2sgdXAifSwidGVhbXMiOnsiV0VTVCI6IldFU1QiLCJFQVNUIjoiRUFTVCIsIk5PUlRIIjoiTk9SVEgiLCJTT1VUSCI6IlNPVVRIIn0sIm1hcHMiOnsiYmxhY2t3ZWxsRmllbGRzIjoiQmxhY2t3ZWxsIEZpZWxkcyIsImRlZmVuc2VOZXh1cyI6IkRlZmVuc2UgTmV4dXMiLCJnb2xmQ291cnNlIjoiR29sZiBDb3Vyc2UiLCJtaXJha1ZhbGxleSI6Ik1pcmFrIFZhbGxleSIsIm9wZXJhdGlvbkZpcmVzdG9ybSI6Ik9wZXJhdGlvbiBGaXJlc3Rvcm0iLCJsaWJlcmF0aW9uUGVhayI6IkxpYmVyYXRpb24gUGVhayIsIm1hbmhhdHRhbkJyaWRnZSI6Ik1hbmhhdHRhbiBCcmlkZ2UiLCJhcmVhMjJCIjoiQXJlYSAyMkIifSwibm90aWZpY2F0aW9ucyI6eyJhbW1vUmVzdG9ja2VkIjoiWW91ciBnYWRnZXQgYW1tbyBpcyByZXN0b2NrZWQiLCJlbnRlcmVkTWFpbkJhc2UiOiJ7MH0gZW50ZXJlZCB0aGVpciBtYWluIGJhc2UiLCJleGl0ZWRNYWluQmFzZSI6InswfSBleGl0ZWQgdGhlaXIgbWFpbiBiYXNlIiwicmVhZHl1cFJldHVyblRvQmFzZU5vdExpdmUiOiJSZXR1cm4gdG8gbWFpbiBiYXNlIGFuZCByZWFkeSBiYWNrIHVwIC0gUm91bmQgezB9IGlzIG5vdCBsaXZlISIsInJvdW5kRW5kVGllIjoiUm91bmQgZW5kZWQ6IFRpZSB7MH0tezF9LiIsInJvdW5kRW5kV2luIjoiezB9IHdpbnMgezF9LXsyfS4iLCJyb3VuZE92ZXJSZWRlcGxveWluZyI6IlJvdW5kIG92ZXIsIHJlZGVwbG95aW5nIHRvIHJlc2V0IGluIHswfXMuLi4iLCJyb3VuZFN0YXJ0ZWQiOiJSb3VuZCBzdGFydGVkLiIsInJvdW5kV2lucyI6IkN1cnJlbnQgcm91bmQgc2NvcmUgaXMgezB9LXsxfSIsInRlYW1Td2l0Y2giOiJZb3UgaGF2ZSBzd2l0Y2hlZCB0ZWFtcyEifSwicmVhZHlEaWFsb2ciOnsiaGVhZGVyIjoiRXZlcnlvbmUgb24gYm90aCB0ZWFtcyBuZWVkcyB0byBwcmVzcyAnUmVhZHknIGFuZCBzdGF5IGluc2lkZSB0aGVpciBtYWluIGJhc2UgdW50aWwgdGhlIHJvdW5kIHN0YXJ0cyIsImhlYWRlcjIiOiJPbmx5IHZlaGljbGUga2lsbHMgY291bnQhIFJlcGFpciB2ZWhpY2xlcyB3aXRoIHlvdXIgdG9yY2ggJiByZXN1cHBseSB2ZWhpY2xlIGFtbW8gd2l0aCBzdXBwbHkgY3JhdGVzIiwiaGVhZGVyMyI6IllvdXIgdmVoaWNsZSB3aWxsIHNsb3dseSB0YWtlIGRhbWFnZSBhbmQgYmxvdyB1cCBpZiBpdCdzID57MH1tIGZyb20gYW55IHBsYXllciIsIm1hcExhYmVsIjoiTWFwOiIsImJlc3RPZkxhYmVsIjoiQmVzdCBvZiB7MH0gUm91bmRzIiwiYmVzdE9mQ2hhbmdlZCI6InswfSBjaGFuZ2VkIGl0IHRvIGJlc3Qgb2YgezF9IHJvdW5kcyIsIm1hdGNodXBGb3JtYXQiOiJ7MH0gdnMgezF9IiwibWF0Y2h1cENoYW5nZWQiOiJ7MH0gY2hhbmdlZCBtYXRjaHVwIHRvIHsxfSB2cyB7Mn0iLCJtaW5QbGF5ZXJzVG9TdGFydEZvcm1hdCI6Ik1pbmltdW0gUGxheWVycyB0byBTdGFydDogezB9IiwidGFyZ2V0S2lsbHNUb1dpbkZvcm1hdCI6IlRhcmdldCBLaWxscyB0byB3aW4gUm91bmQ6IHswfSIsInBsYXllck5hbWVGb3JtYXQiOiJ7MH0iLCJzdGF0dXMiOnsicmVhZHkiOiJSRUFEWSIsIm5vdFJlYWR5IjoiTk9UIFJFQURZIn0sImJhc2VTdGF0dXMiOnsiaW4iOiJJTiBNQUlOIEJBU0UiLCJvdXQiOiJOT1QgSU4gTUFJTiBCQVNFIn0sImJ1dHRvbnMiOnsicmVhZHkiOiJSRUFEWSIsIm5vdFJlYWR5IjoiTk9UIFJFQURZIiwic3dhcFRlYW1zIjoiQ0hBTkdFIFRFQU1TIn19LCJhZG1pblBhbmVsIjp7ImFjY2Vzc2VkIjoiezB9IGFjY2Vzc2VkIHRoZSBBZG1pbiBQYW5lbCIsImFjdGlvblByZXNzZWQiOiJ7MH0gcHJlc3NlZCB7MX0gaW4gdGhlIGFkbWluIHBhbmVsIiwiYWN0aW9uQ291bnRGb3JtYXQiOiIoezB9KSIsImFjdGlvbkNvdW50VmljdG9yeUZvcm1hdCI6IkFkbWluIFBhbmVsIEJ1dHRvbnMgcHJlc3NlZCB7MH0gdGltZXMiLCJhY3Rpb25zIjp7InQxV2luc0luYyI6IlQxIFdpbnMgKyIsInQxV2luc0RlYyI6IlQxIFdpbnMgLSIsInQyV2luc0luYyI6IlQyIFdpbnMgKyIsInQyV2luc0RlYyI6IlQyIFdpbnMgLSIsInQxVG90YWxLaWxsc0luYyI6IlQxIFRvdGFsIEtpbGxzICsiLCJ0MVRvdGFsS2lsbHNEZWMiOiJUMSBUb3RhbCBLaWxscyAtIiwidDJUb3RhbEtpbGxzSW5jIjoiVDIgVG90YWwgS2lsbHMgKyIsInQyVG90YWxLaWxsc0RlYyI6IlQyIFRvdGFsIEtpbGxzIC0iLCJ0MVJvdW5kS2lsbHNJbmMiOiJUMSBSb3VuZCBLaWxscyArIiwidDFSb3VuZEtpbGxzRGVjIjoiVDEgUm91bmQgS2lsbHMgLSIsInQyUm91bmRLaWxsc0luYyI6IlQyIFJvdW5kIEtpbGxzICsiLCJ0MlJvdW5kS2lsbHNEZWMiOiJUMiBSb3VuZCBLaWxscyAtIiwidGFyZ2V0Um91bmRLaWxsc0luYyI6IlRhcmdldCBSb3VuZCBLaWxscyArIiwidGFyZ2V0Um91bmRLaWxsc0RlYyI6IlRhcmdldCBSb3VuZCBLaWxscyAtIiwidGllc0luYyI6IlRpZXMgKyIsInRpZXNEZWMiOiJUaWVzIC0iLCJjdXJyZW50Um91bmRJbmMiOiJDdXJyZW50IFJvdW5kICsiLCJjdXJyZW50Um91bmREZWMiOiJDdXJyZW50IFJvdW5kIC0iLCJjbG9ja1RpbWVJbmMiOiJDbG9jayBUaW1lICsiLCJjbG9ja1RpbWVEZWMiOiJDbG9jayBUaW1lIC0iLCJjbG9ja1Jlc2V0IjoiQ2xvY2sgUmVzZXQiLCJyb3VuZFN0YXJ0IjoiU3RhcnQgUm91bmQiLCJyb3VuZEVuZCI6IkVuZCBSb3VuZCIsInBvc2l0aW9uRGVidWciOiJUb2dnbGUgUG9zaXRpb24gRGVidWcifSwibGFiZWxzIjp7InQxUm91bmRLaWxscyI6IlQxIFJvdW5kIEtpbGxzIiwidDJSb3VuZEtpbGxzIjoiVDIgUm91bmQgS2lsbHMifSwiYnV0dG9ucyI6eyJwYW5lbCI6IkFkbWluIFBhbmVsIn0sInRlc3RlciI6eyJoZWFkZXIiOiJBRE1JTiBQQU5FTCIsImJ1dHRvbnMiOnsiY2xvY2tSZXNldCI6IlJlc2V0IENsb2NrIiwicm91bmRFbmQiOiJFbmQgUm91bmQiLCJyb3VuZFN0YXJ0IjoiU3RhcnQgUm91bmQiLCJwb3NpdGlvbkRlYnVnIjoiVG9nZ2xlIFBvc2l0aW9uIERlYnVnIn0sImxhYmVscyI6eyJjbG9ja1RpbWUiOiJDbG9jayBUaW1lIC0vKyAxbSIsImN1cnJlbnRSb3VuZCI6IkN1cnJlbnQgUm91bmQiLCJsZWZ0S2lsbHMiOiJUMSBUb3RhbCBLaWxscyIsImxlZnRXaW5zIjoiVDEgV2lucyIsInRpZXMiOiJUMSArIFQyIFJvdW5kIFRpZXMiLCJyaWdodEtpbGxzIjoiVDIgVG90YWwgS2lsbHMiLCJyaWdodFdpbnMiOiJUMiBXaW5zIiwicm91bmRLaWxsc1RhcmdldCI6IlRhcmdldCBSb3VuZCBLaWxscyJ9fX0sInRlYW1Td2l0Y2giOnsiYnV0dG9ucyI6eyJjYW5jZWwiOiJDTE9TRSJ9LCJkZWJ1Z1RpbWVMaW1pdCI6InswfSJ9LCJ1aSI6eyJwbHVzIjoiKyIsIm1pbnVzIjoiLSJ9LCJ2aWN0b3J5Ijp7ImRyYXdzIjoiRFJBV1MiLCJsb3NlcyI6IkxPU0VTIiwid2lucyI6IldJTlMhIiwicmVzdGFydEluRm9ybWF0IjoiTWFwIHdpbGwgcmVzdGFydC9yb3RhdGUgaW4gezB9cyIsInJvdW5kTG9zc2VzRm9ybWF0IjoiezB9IFJvdW5kIExvc3NlcyIsInJvdW5kVGllc0Zvcm1hdCI6InswfSBSb3VuZCBUaWVzIiwicm91bmRXaW5zRm9ybWF0IjoiezB9IFJvdW5kIFdpbnMiLCJyb3VuZHNTdW1tYXJ5Rm9ybWF0IjoiezB9IFJvdW5kcyBwbGF5ZWQgaW4gYSBiZXN0IG9mIHsxfSBSb3VuZHMgbWF0Y2h1cCIsInNjcmVlbnNob3RQcm9tcHQiOiJTY3JlZW5zaG90IHRoaXMgdG8gcmVjb3JkIG1hdGNoIHJlc3VsdHMiLCJ0ZWFtT3V0Y29tZUZvcm1hdCI6InswfSB7MX0iLCJ0b3RhbEtpbGxzRm9ybWF0IjoiezB9IFRvdGFsIEtpbGxzIiwidG90YWxNYXRjaFRpbWVMYWJlbCI6IlRvdGFsIE1hdGNoIHRpbWU6In0sImNvdW50ZG93biI6eyJmb3JtYXQiOiJ7MH0iLCJnbyI6IkdPISJ9LCJkZWJ1ZyI6eyJhZG1pblBvcyI6IkFETUlOIFBPUyBYOnswfSBZOnsxfSBaOnsyfSIsImFkbWluRmFjaW5nIjoiQURNSU4gRkFDSU5HIFg6ezB9IFk6ezF9IFo6ezJ9In0sIm1lc3NhZ2VzIjp7ImluaXQiOiJWZWhpY2xlIHNjb3JpbmcgaW5pdGlhbGl6ZWQuIiwidmVoaWNsZVNwYXduZWQiOiJWZWhpY2xlIHNwYXduZWQgZm9yIHswfSBhdCBYOnsxfS9aOnsyfSIsInBvaW50QXdhcmRlZFdpdGhPd25lciI6IisxIEtpbGwgZm9yIHswfSAtIHsxfSdzIHZlaGljbGUgd2FzIGRlc3Ryb3llZCEgKHsyfSBSb3VuZCBLaWxscykiLCJ2ZWhpY2xlRGVzdHJveWVkTm90TGl2ZSI6InswfSdzIHsxfSB2ZWhpY2xlIHdhcyBkZXN0cm95ZWQgLSBidXQgcm91bmQgd2FzIG5vdCBsaXZlIChubyBwb2ludHMgYXdhcmRlZCkiLCJ2ZWhpY2xlU3Bhd25SZXRyeSI6IlZlaGljbGUgc3Bhd24gYmxvY2tlZCBmb3IgezB9LiBSZXRyeWluZyBpbiB7MX1zLiIsInZlaGljbGVDYW1wZWRJbk1haW5CYXNlIjoiVmVoaWNsZSB3YXMgc3Bhd24gY2FtcGVkIGluIHswfSBNYWluIEJhc2UgYXQgWDp7MX0iLCJ2ZWhpY2xlUmVSZWdpc3RlcmVkIjoiVmVoaWNsZSByZS1yZWdpc3RlcmVkIGFnYWluLCBmb3IgezB9IGJ5IHsxfS4iLCJ2ZWhpY2xlU3RvbGVuUmVnaXN0ZXIiOiJWZWhpY2xlIHN0b2xlbiBhbmQgcmVnaXN0ZXJlZCBmb3IgezB9IGJ5IHsxfS4iLCJ2ZWhpY2xlUmVnaXN0ZXJlZE5ldyI6IlZlaGljbGUgcmVnaXN0ZXJlZCBmb3IgezB9IGJ5IHsxfSAoc3Bhd24gQXV0by1yZWdpc3RyYXRpb24gZmFpbGVkPyEpLiIsInZlaGljbGVSZXR1cm5lZCI6InswfSBoYXMgcmV0dXJuZWQgdG8gdGhlaXIgcmVnaXN0ZXJlZCB2ZWhpY2xlIGZvciB7MX0uIn19fQ==","compiled":""},"attachmentType":4,"errors":[]}]}